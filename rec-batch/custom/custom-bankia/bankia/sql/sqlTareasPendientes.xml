<!DOCTYPE properties SYSTEM "http://java.sun.com/dtd/properties.dtd">
<properties>


  <entry key="queryTareasPendientes">
    <![CDATA[
    select * from (
     SELECT   usu.usu_id,
         (SELECT COUNT (tareanotif0_.tar_id) AS col_0_0_
            FROM pfs01.tar_tareas_notificaciones tareanotif0_
           WHERE tareanotif0_.tar_id IN (
                    SELECT tareanotif1_.tar_id
                      FROM pfs01.tar_tareas_notificaciones tareanotif1_,
                           pfs01.cli_clientes cliente2_,
                           ${master.schema}.dd_est_estados_itinerarios ddestadoit3_,
                           pfs01.est_estados estados4_,
                           ${master.schema}.dd_est_estados_itinerarios ddestadoit7_,
                           pfs01.arq_arquetipos arquetipo9_,
                           ${master.schema}.dd_sta_subtipo_tarea_base subtipotar10_,
                           ${master.schema}.dd_tar_tipo_tarea_base tipotarea11_
                     WHERE tareanotif1_.cli_id = cliente2_.cli_id(+)
                       AND cliente2_.dd_est_id = ddestadoit3_.dd_est_id(+)
                       AND ddestadoit3_.dd_est_id = estados4_.dd_est_id(+)
                       AND tareanotif1_.dd_est_id = ddestadoit7_.dd_est_id
                       AND cliente2_.arq_id = arquetipo9_.arq_id
                       AND tareanotif1_.dd_sta_id = subtipotar10_.dd_sta_id
                       AND subtipotar10_.dd_tar_id = tipotarea11_.dd_tar_id
                       AND tareanotif1_.borrado = 0
                       AND ddestadoit3_.dd_est_codigo =
                                                    ddestadoit7_.dd_est_codigo
                       AND arquetipo9_.iti_id = estados4_.iti_id
                       AND (   tareanotif1_.tar_tarea_finalizada IS NULL
                            OR tareanotif1_.tar_tarea_finalizada = 0
                           )
                       AND tareanotif1_.dd_ein_id = 1
                       AND tipotarea11_.dd_tar_codigo = 1
                       AND CASE
                              WHEN subtipotar10_.dd_sta_gestor = 1
                                 THEN estados4_.pef_id_gestor
                              ELSE estados4_.pef_id_supervisor
                           END IN (SELECT pef_id
                                     FROM zon_pef_usu zpu
                                    WHERE zpu.usu_id = usu.usu_id))
              OR tareanotif0_.tar_id IN (
                    SELECT tareanotif13_.tar_id
                      FROM pfs01.tar_tareas_notificaciones tareanotif13_,
                           pfs01.exp_expedientes expediente14_,
                           ${master.schema}.dd_est_estados_itinerarios ddestadoit15_,
                           pfs01.est_estados estados16_,
                           ${master.schema}.dd_est_estados_itinerarios ddestadoit19_,
                           pfs01.arq_arquetipos arquetipo21_,
                           ${master.schema}.dd_ein_entidad_informacion tipoentida22_,
                           ${master.schema}.dd_sta_subtipo_tarea_base subtipotar23_,
                           ${master.schema}.dd_tar_tipo_tarea_base tipotarea24_,
                           pfs01.ofi_oficinas oficina27_,
                           pfs01.zon_zonificacion zona28_
                     WHERE tareanotif13_.exp_id = expediente14_.exp_id(+)
                       AND expediente14_.dd_est_id = ddestadoit15_.dd_est_id(+)
                       AND ddestadoit15_.dd_est_id = estados16_.dd_est_id(+)
                       AND tareanotif13_.dd_est_id = ddestadoit19_.dd_est_id
                       AND expediente14_.arq_id = arquetipo21_.arq_id
                       AND tareanotif13_.dd_ein_id = tipoentida22_.dd_ein_id
                       AND tareanotif13_.dd_sta_id = subtipotar23_.dd_sta_id
                       AND subtipotar23_.dd_tar_id = tipotarea24_.dd_tar_id
                       AND expediente14_.ofi_id = oficina27_.ofi_id
                       AND oficina27_.ofi_id = zona28_.ofi_id
                       AND tareanotif13_.borrado = 0
                       AND ddestadoit15_.dd_est_codigo =
                                                   ddestadoit19_.dd_est_codigo
                       AND arquetipo21_.iti_id = estados16_.iti_id
                       AND (   tareanotif13_.tar_tarea_finalizada IS NULL
                            OR tareanotif13_.tar_tarea_finalizada = 0
                           )
                       AND tipoentida22_.dd_ein_codigo = 2
                       AND tipotarea24_.dd_tar_codigo = 1
                       AND subtipotar23_.dd_sta_codigo <> 4
                       AND (zona28_.zon_cod LIKE '01%')
                       AND CASE
                              WHEN subtipotar23_.dd_sta_gestor = 1
                                 THEN estados16_.pef_id_gestor
                              ELSE estados16_.pef_id_supervisor
                           END IN (SELECT pef_id
                                     FROM zon_pef_usu zpu
                                    WHERE zpu.usu_id = usu.usu_id))
              OR tareanotif0_.tar_id IN (
                    SELECT tareanotif30_.tar_id
                      FROM pfs01.tar_tareas_notificaciones tareanotif30_,
                           pfs01.asu_asuntos asunto31_,
                           ${master.schema}.dd_ein_entidad_informacion tipoentida32_,
                           ${master.schema}.dd_sta_subtipo_tarea_base subtipotar33_,
                           ${master.schema}.dd_tar_tipo_tarea_base tipotarea34_,
                           pfs01.usd_usuarios_despachos gestordesp36_,
                           pfs01.usd_usuarios_despachos gestordesp37_
                     WHERE tareanotif30_.asu_id = asunto31_.asu_id(+)
                       AND tareanotif30_.dd_ein_id = tipoentida32_.dd_ein_id
                       AND tareanotif30_.dd_sta_id = subtipotar33_.dd_sta_id
                       AND subtipotar33_.dd_tar_id = tipotarea34_.dd_tar_id
                       AND asunto31_.gas_id = gestordesp36_.usd_id
                       AND asunto31_.sup_id = gestordesp37_.usd_id
                       AND tareanotif30_.borrado = 0
                       AND (   tareanotif30_.tar_tarea_finalizada IS NULL
                            OR tareanotif30_.tar_tarea_finalizada = 0
                           )
                       AND (tipoentida32_.dd_ein_codigo IN (3, 5))
                       AND tipotarea34_.dd_tar_codigo = 1
                       AND CASE
                              WHEN subtipotar33_.dd_sta_gestor = 1
                                 THEN gestordesp36_.usu_id
                              ELSE gestordesp37_.usu_id
                           END = usu.usu_id)) tareaspendientes,
         usu.usu_mail
    FROM ${master.schema}.usu_usuarios usu
    WHERE usu.usu_mail is not null
ORDER BY usu.usu_id
) where tareaspendientes>0
    ]]>
  </entry>
 
</properties>