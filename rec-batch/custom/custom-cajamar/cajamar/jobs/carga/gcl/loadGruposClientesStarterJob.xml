<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans" xmlns:p="http://www.springframework.org/schema/p" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
   xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.5.xsd" default-autowire="byName"
   default-merge="true">

   <bean id="batch.task.UnZipi64Support" abstract="true" class="es.pfsgroup.recovery.batch.tasks.Unzip64SupportTasklet"/>
   <bean id="batch.task.PFSDataLoader" abstract="true" class="es.pfsgroup.recovery.batch.tasks.PFSDataLoaderTasklet"/>

   <bean id="loadGruposClientesStarterJob" parent="batch.simpleJob" scope="prototype">
      <property name="steps">
         <list>
			</list>
	  </property>
	</bean>
<!--                                              FIN GCL                                                    -->

   
	<!-- No delimited reader -->
   <bean id="cargaGcl.grupos.itemReader" parent="batch.task.FlatFileItemReader" scope="prototype">
      <property name="bindings" value="fileSystemResource=txtFileGclGrupos" />
      <property name="recordSeparatorPolicy">
         <bean class="org.springframework.batch.item.file.separator.SimpleRecordSeparatorPolicy"/>
      </property>      
      <property name="lineTokenizer">
         <bean parent="batch.transform.FixedLengthTokenizer"
            p:columns="1-8,9-12,13-32,33-52,53-112"/>
      </property>
      <property name="fieldSetMapper">
         <bean parent="batch.mapper.PassThroughFieldSetMapper" />
      </property>
      <property name="message" value="cargaGcl.grupos.tokenizerError" />
      <property name="severidad" value="error" />
   </bean>

	<!-- Custom delimited writer -->
   <bean id="cargaGcl.grupos.itemWriter" parent="batch.task.FlatFileItemWriter" scope="prototype">
      <property name="bindings" value="fileSystemResource=csvFileGclGrupos" />
      <property name="fieldSetCreator">
         <bean parent="batch.mapper.PassThroughFieldSetMapper" />
      </property>
      <property name="lineAggregator">
         <bean parent="batch.transform.DelimitedLineAggregator" p:stringFields="3,4" />
      </property>
      <property name="message" value="cargaGcl.grupos.itemWriter" />
      <property name="severidad" value="error" />
      <property name="trim" value="true" />
   </bean>
   
   <!-- No delimited reader -->
   <bean id="cargaGcl.relaciones.itemReader" parent="batch.task.FlatFileItemReader" scope="prototype">
      <property name="bindings" value="fileSystemResource=txtFileGclRL" />
      <property name="recordSeparatorPolicy">
         <bean class="org.springframework.batch.item.file.separator.SimpleRecordSeparatorPolicy"/>
      </property>      
      <property name="lineTokenizer">
         <bean parent="batch.transform.FixedLengthTokenizer"
            p:columns="1-8,9-12,13-32,33-52,53-72,73-73"/>
      </property>
      <property name="fieldSetMapper">
         <bean parent="batch.mapper.PassThroughFieldSetMapper" />
      </property>
      <property name="message" value="cargaGcl.relaciones.tokenizerError" />
      <property name="severidad" value="error" />
   </bean>

	<!-- Custom delimited writer -->
   <bean id="cargaGcl.relaciones.itemWriter" parent="batch.task.FlatFileItemWriter" scope="prototype">
      <property name="bindings" value="fileSystemResource=csvFileGclRL" />
      <property name="fieldSetCreator">
         <bean parent="batch.mapper.PassThroughFieldSetMapper" />
      </property>
      <property name="lineAggregator">
         <bean parent="batch.transform.DelimitedLineAggregator" p:stringFields="4" />
      </property>
      <property name="message" value="cargaGcl.relaciones.itemWriter" />
      <property name="severidad" value="error" />
      <property name="trim" value="true" />
   </bean>

</beans>
