<beans xmlns="http://www.springframework.org/schema/beans" xmlns:p="http://www.springframework.org/schema/p" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.5.xsd"
    default-autowire="byName" default-merge="true">
    <bean id="validacionesGruposClientesJob" parent="batch.simpleJob" scope="prototype">
        <property name="steps">
            <list>
                <bean id="pasaje.contratos.valdidator" parent="batch.taskletStep" scope="prototype">
                    <property name="tasklet">
                        <bean parent="common.validator" scope="prototype">
                            <property name="validaciones">
                                <list>

                                    <ref bean="gcl-09.grupos.countValidator" />
                                    <ref bean="gcl-10.relaciones.countValidator"/>
                                    <ref bean="gcl-11.lastLoadDateValidator" />
                                    <ref bean="gcl-01.entityValidatorGrupos"/>
                                    <ref bean="gcl-05.entityValidatorRelaciones" />

				    <!-- <ref bean="gcl-02.loadDateValidatorGrupos"/> -->
				    <!-- <ref bean="gcl-06.loadDateValidatorRelaciones"/> -->
				    <ref bean="gcl-03.insertTipoGrupoValidator" />
				    <ref bean="gcl-03.tipoGrupoValidator"/>
				    <ref bean="gcl-04.gruposVaciosValidator"/>
				    <!-- <ref bean="gcl-07.personasValidator"/> -->
				    <ref bean="gcl-08.personasGruposValidator"/>

				    <!-- <ref bean="gcl-12.deleteDuplicatedPersonsAndGroups"/> -->
				    <ref bean="gcl-12.gruposRepetidosValidator"/>

				    <!-- <ref bean="gcl-13.deleteDuplicatedRelations" /> -->
				    <!-- <ref bean="gcl-13.personasEnMasDeUnGrupoValidator"/> -->

				    <ref bean="gcl-15.tipoRelacionGrupoValidator"/>
                                </list>
                            </property>
                        </bean>
                    </property>
                </bean>
            </list>
        </property>
    </bean>
    
    
    <bean id="gcl-09.grupos.countValidator" class="es.capgemini.pfs.batch.common.RecordCountValidatorTasklet" scope="prototype">
        <property name="dataSource" ref="entityDataSource" />
        <property name="tableName" value="TMP_GCL_GRUPOS_CLIENTES" />
        <property name="bindings" value="expectedRecords=grupos.rowcount" />
        <property name="message" value="gcl-09.grupos.countValidator" />
        <property name="severidad" value="error" />
    </bean>

	<bean id="gcl-10.relaciones.countValidator" class="es.capgemini.pfs.batch.common.RecordCountValidatorTasklet" scope="prototype">
        <property name="dataSource" ref="entityDataSource" />
        <property name="tableName" value="TMP_PER_GCL" />
        <property name="bindings" value="expectedRecords=relaciones.rowcount" />
        <property name="message" value="gcl-10.relaciones.countValidator" />
        <property name="severidad" value="error" />
    </bean>

 	<bean id="gcl-11.lastLoadDateValidator" class="es.capgemini.pfs.batch.load.LoadDateValidatorTasklet" scope="prototype">
        <property name="dataSource" ref="entityDataSource" />
        <property name="query">
            <bean parent="sql" p:key="gcl-11.lastLoadDateValidator" />
        </property>
        <property name="bindings" value="fileName=csvFileGclGrupos" />
        <property name="message" value="gcl-11.lastLoadDateValidator" />
        <property name="severidad" value="error" />
    </bean>

    <!-- valido que las entidades correspondan con la del archivo -->
    <bean id="gcl-01.entityValidatorGrupos" class="es.capgemini.pfs.batch.load.EntityValidatorTasklet" scope="prototype">
        <property name="dataSource" ref="entityDataSource" />
        <property name="query">
            <bean parent="sql" p:key="gcl-01.entityValidatorGrupos" />
        </property>
        <property name="bindings" value="entidad=entidad" />
        <property name="message" value="gcl-01.entityValidatorGrupos" />
        <property name="severidad" value="error" />
    </bean>
    
    <bean id="gcl-05.entityValidatorRelaciones" class="es.capgemini.pfs.batch.load.EntityValidatorTasklet" scope="prototype">
        <property name="dataSource" ref="entityDataSource" />
        <property name="query">
            <bean parent="sql" p:key="gcl-05.entityValidatorRelaciones" />
        </property>
        <property name="bindings" value="entidad=entidad" />
        <property name="message" value="gcl-05.entityValidatorRelaciones" />
        <property name="severidad" value="error" />
    </bean>

    <bean id="gcl-02.loadDateValidatorGrupos" class="es.capgemini.pfs.batch.load.LoadDateValidatorTasklet" scope="prototype">
        <property name="dataSource" ref="entityDataSource" />
        <property name="query">
            <bean parent="sql" p:key="gcl-02.loadDateValidatorGrupos" />
        </property>
        <property name="bindings" value="fileName=csvFileGclGrupos" />
        <property name="message" value="gcl-02.loadDateValidatorGrupos" />
        <property name="severidad" value="error" />
    </bean>

    <bean id="gcl-06.loadDateValidatorRelaciones" class="es.capgemini.pfs.batch.load.LoadDateValidatorTasklet" scope="prototype">
        <property name="dataSource" ref="entityDataSource" />
        <property name="query">
            <bean parent="sql" p:key="gcl-06.loadDateValidatorRelaciones" />
        </property>
        <property name="bindings" value="fileName=csvFileGclRL" />
        <property name="message" value="gcl-06.loadDateValidatorRelaciones" />
        <property name="severidad" value="error" />
    </bean>

    <bean id="gcl-03.insertTipoGrupoValidator" class="es.capgemini.pfs.batch.common.BatchValidatorExtendedTasklet" scope="prototype"> 
	<property name="dataSource" ref="entityDataSource" />
	<property name="query">
		<bean parent="sql" p:key="gcl-03.insertTipoGrupoValidator" />
	</property>
	<property name="expectedNumber" value="0" />
	<property name="message" value="gcl-03.insertTipoGrupoValidator" />
	<property name="severidad" value="error" />
	<property name="insercion" value="true" />
    </bean>
    <bean id="gcl-03.tipoGrupoValidator" class="es.capgemini.pfs.batch.common.BatchValidatorTasklet" scope="prototype">
        <property name="dataSource" ref="entityDataSource" />
        <property name="query">
            <bean parent="sql" p:key="gcl-03.tipoGrupoValidator" />
        </property>
        <property name="expectedNumber" value="0" />
        <property name="message" value="gcl-03.tipoGrupoValidator" />
        <property name="severidad" value="error" />
    </bean>

 	<bean id="gcl-04.gruposVaciosValidator" class="es.capgemini.pfs.batch.common.BatchValidatorTasklet" scope="prototype">
        <property name="dataSource" ref="entityDataSource" />
        <property name="query">
            <bean parent="sql" p:key="gcl-04.gruposVaciosValidator" />
        </property>
        <property name="expectedNumber" value="0" />
        <property name="message" value="gcl-04.gruposVaciosValidator" />
        <property name="severidad" value="info" />
    </bean>

	<bean id="gcl-07.personasValidator" class="es.capgemini.pfs.batch.common.BatchValidatorTasklet" scope="prototype">
        <property name="dataSource" ref="entityDataSource" />
        <property name="query">
            <bean parent="sql" p:key="gcl-07.personasValidator" />
        </property>
        <property name="expectedNumber" value="0" />
        <property name="message" value="gcl-07.personasValidator" />
        <property name="severidad" value="info" />
    </bean>

	<bean id="gcl-08.personasGruposValidator" class="es.capgemini.pfs.batch.common.BatchValidatorTasklet" scope="prototype">
        <property name="dataSource" ref="entityDataSource" />
        <property name="query">
            <bean parent="sql" p:key="gcl-08.personasGruposValidator" />
        </property>
        <property name="expectedNumber" value="0" />
        <property name="message" value="gcl-08.personasGruposValidator" />
        <property name="severidad" value="error" />
    </bean>

    <bean id="gcl-12.deleteDuplicatedPersonsAndGroups" class="es.capgemini.pfs.batch.common.BatchValidatorExtendedTasklet" scope="prototype"> 
	<property name="dataSource" ref="entityDataSource" />
	<property name="query">
		<bean parent="sql" p:key="gcl-12.deleteDuplicatedPersonsAndGroups" />
	</property>
	<property name="expectedNumber" value="0" />
	<property name="message" value="gcl-12.deleteDuplicatedPersonsAndGroups" />
	<property name="severidad" value="error" />
	<property name="insercion" value="true" />
    </bean>

    <bean id="gcl-12.gruposRepetidosValidator" class="es.capgemini.pfs.batch.common.BatchValidatorTasklet" scope="prototype">
        <property name="dataSource" ref="entityDataSource" />
        <property name="query">
            <bean parent="sql" p:key="gcl-12.gruposRepetidosValidator" />
        </property>
        <property name="expectedNumber" value="0" />
        <property name="message" value="gcl-12.gruposRepetidosValidator" />
        <property name="severidad" value="error" />
    </bean>
    
    <bean id="gcl-13.deleteDuplicatedRelations" class="es.capgemini.pfs.batch.common.BatchValidatorExtendedTasklet" scope="prototype"> 
	<property name="dataSource" ref="entityDataSource" />
	<property name="query">
		<bean parent="sql" p:key="gcl-13.deleteDuplicatedRelations" />
	</property>
	<property name="expectedNumber" value="0" />
	<property name="message" value="gcl-13.deleteDuplicatedRelations" />
	<property name="severidad" value="error" />
	<property name="insercion" value="true" />
    </bean>


     <bean id="gcl-13.personasEnMasDeUnGrupoValidator" class="es.capgemini.pfs.batch.common.BatchValidatorTasklet" scope="prototype">
        <property name="dataSource" ref="entityDataSource" />
        <property name="query">
            <bean parent="sql" p:key="gcl-13.personasEnMasDeUnGrupoValidator" />
        </property>
        <property name="expectedNumber" value="0" />
        <property name="message" value="gcl-13.personasEnMasDeUnGrupoValidator" />
        <property name="severidad" value="error" />
    </bean>

    <bean id="gcl-15.tipoRelacionGrupoValidator" class="es.capgemini.pfs.batch.common.BatchValidatorTasklet" scope="prototype">
        <property name="dataSource" ref="entityDataSource" />
        <property name="query">
            <bean parent="sql" p:key="gcl-15.tipoRelacionGrupoValidator" />
        </property>
        <property name="expectedNumber" value="0" />
        <property name="message" value="gcl-15.tipoRelacionGrupoValidator" />
        <property name="severidad" value="error" />
    </bean>

</beans>
