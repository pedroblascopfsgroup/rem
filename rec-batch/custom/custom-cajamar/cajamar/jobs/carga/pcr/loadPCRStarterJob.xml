<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans" xmlns:p="http://www.springframework.org/schema/p" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
   xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.5.xsd" default-autowire="byName"
   default-merge="true">

   <bean id="batch.task.UnZipi64Support" abstract="true" class="es.pfsgroup.recovery.batch.tasks.Unzip64SupportTasklet"/>

   <bean id="batch.task.PFSDataLoader" abstract="true" class="es.pfsgroup.recovery.batch.tasks.PFSDataLoaderTasklet"/>


   <bean id="loadPCRStarterJob" parent="batch.simpleJob" scope="prototype">
      <property name="steps">
         <list>
         </list>
      </property>
   </bean>
   
	<!-- No delimited reader -->
   <bean id="cargaContratos.itemReader" parent="batch.task.FlatFileItemReader" scope="prototype">
      <property name="bindings" value="fileSystemResource=txtFileContratos" />
      <property name="recordSeparatorPolicy">
         <bean class="org.springframework.batch.item.file.separator.SimpleRecordSeparatorPolicy"/>
      </property>      
      <property name="lineTokenizer">
         <bean parent="batch.transform.FixedLengthTokenizer"
		 	p:columns="1-8,9-12,13-16,17-22,23-32,33-36,37-50,51-64,65-72,73-86,87-94,95-96,97-98,99-106,107-114,115-128,129-130,131-138,
			139-1162,1163-1176,1177-1190,1191-1204,1205-1218,1219-1226,1227-1240,1241-1254,1255-1268,1269-1282,1283-1296,1297-1310,1311-1324,1325-1338,1339-1352,1353-1366,1367-1380,1381-1394,1395-1408,1409-1411,1412-1414,1415-1419,1420-1424,1425-1434,1435-1444,1445-1454,1455-1464,1465-1474,1475-1484,1485-1739,1740-1749,1750-1759,1760-1769,1770-1779,1780-1789,
			1790,1791,1792,1793,
			1794-1813,1814-1833,1834-1853,1854-1873,
			1874-1923,1924-1973,1974-2023,2024-2073,2074-2123,2124-2173,
                        2174-2223,2224-2273,2274-2323,2324-2373,2374-2423,2424-2473,2474-2523,2524-2573,2574-2623,2624-2673" />
		 <!--
            p:columns="1-8,9-12,13-16,17-22,23-32,33-36,37-50,51-64,65-72,73-86,87-94,95-96,97-98,99-106,107-114,115-128,129-130,131-138,139-1162,1163-1176,1177-1190,1191-1204,1205-1218,1219-1226" />
			-->
         <!--
            p:columns="1-8,9-12,13-16,17-22,23-32,33-36,37-46,47-56,57-64,65-74,75-82,83-92,93-107,108-362,363-372,373-382,383-392,393-402,403-404,405-412,413-420"
            /
         -->
         <!--
            p:columns="1-8, 9-12, 13-16, 17-36, 37-39, 40-51, 52-63, 64-71, 72-83, 84-91, 92-103, 104-118, 119-130, 131-142, 143-154, 155-166,
            167-186, 187-187, 188-199, 200-200, 201-208, 206-216, 217-246, 247-258, 259-266" />
         -->
      </property>
      <property name="fieldSetMapper">
         <bean parent="batch.mapper.PassThroughFieldSetMapper" />
      </property>
      <property name="message" value="cargaContratos.itemReader.tokenizerError" />
      <property name="severidad" value="error" />
   </bean>

	<!-- Custom delimited writer -->
   <bean id="cargaContratos.itemWriter" parent="batch.task.FlatFileItemWriter" scope="prototype">
      <property name="bindings" value="fileSystemResource=csvFileContratos" />
      <property name="fieldSetCreator">
         <bean parent="batch.mapper.PassThroughFieldSetMapper" />
      </property>
      <property name="lineAggregator">
         <bean parent="batch.transform.DelimitedLineAggregator" p:stringFields="1,24,37,38,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107" />
      </property>
      <property name="message" value="cargaContratos.itemWriter" />
      <property name="severidad" value="error" />
      <property name="trim" value="true" />
   </bean>
	<!-- No delimited reader -->
   <bean id="cargaPersonas.itemReader" parent="batch.task.FlatFileItemReader" scope="prototype">   
      <property name="bindings" value="fileSystemResource=txtFilePersonas" />
      <property name="recordSeparatorPolicy">
         <bean class="org.springframework.batch.item.file.separator.SimpleRecordSeparatorPolicy"/>
      </property>      
      <property name="lineTokenizer">
         <bean parent="batch.transform.FixedLengthTokenizer"
            p:columns="1-8,9-12,13-32,33-33,34-53,54-73,74-173,174-223,224-1247,1248-1347,1348-1447,1448-1497,1498-1505,1506-1525,1526-1545,1546-1565,1566-1585,1586-1685,1686-1705,1706-1725,1726-1739,1740-1753,1754-1758,1759-1764,1765-1778,1779-1792,1793-1806,1807-1820,1821-1910,1911-1913,1914-1916,1917-1917,1918-1922,1923-1927,1928-1932,1933-1937,1938-1942,1943-1947,1948-1951,1952-1957,1958-1963,1964-1979,1980-1981,1982-1991,1992-2001,2002-2011,2012-2021,2022-2031,2032-2041,2042-2051,2052-2061" />
            <!--
			p:columns="1-8, 9-12, 13-32, 33, 34-53, 54-73, 74-173, 
      			174-223, 224-1247, 1248-1347, 1348-1447, 1448-1497, 1498-1505, 1506-1517, 1518-1529, 1530-1541, 1542-1553, 1554-1653" />
      			-->
	  </property>
      <property name="fieldSetMapper">
         <bean parent="batch.mapper.PassThroughFieldSetMapper" />
      </property>
      <property name="message" value="cargaPersonas.itemReader.tokenizerError" />
      <property name="severidad" value="error" />
   </bean>

  	<!-- Custom delimited writer -->
   <bean id="cargaPersonas.itemWriter" parent="batch.task.FlatFileItemWriter" scope="prototype">
      <property name="bindings" value="fileSystemResource=csvFilePersonas" />
      <property name="fieldSetCreator">
         <bean parent="batch.mapper.PassThroughFieldSetMapper" />
      </property>
      <property name="lineAggregator">
         <bean parent="batch.transform.DelimitedLineAggregator" p:stringFields="4,5,6,7,8,9,10,11,13,14,15,16,17,18,19,28,29,30,31,42,43,44,45,46,47" />
      </property>
      <property name="message" value="cargaPersonas.itemWriter" />
      <property name="severidad" value="error" />
      <property name="trim" value="true" />
   </bean>
	<!-- No delimited reader -->
   <bean id="cargaRelacion.itemReader" parent="batch.task.FlatFileItemReader" scope="prototype">
      <property name="bindings" value="fileSystemResource=txtFileRelacion" />
      <property name="recordSeparatorPolicy">
         <bean class="org.springframework.batch.item.file.separator.SimpleRecordSeparatorPolicy"/>
      </property>      
      <property name="lineTokenizer">
         <bean parent="batch.transform.FixedLengthTokenizer" p:columns="1-8, 9-12, 13-16, 17-26, 27-46, 47-56, 57-60" />
      </property>
      <property name="fieldSetMapper">
         <bean parent="batch.mapper.PassThroughFieldSetMapper" />
      </property>
      <property name="message" value="cargaRelacion.itemReader.tokenizerError" />
      <property name="severidad" value="error" />
   </bean>
	
	<!-- Custom delimited writer -->
   <bean id="cargaRelacion.itemWriter" parent="batch.task.FlatFileItemWriter" scope="prototype">
      <property name="bindings" value="fileSystemResource=csvFileRelacion" />
      <property name="fieldSetCreator">
         <bean parent="batch.mapper.PassThroughFieldSetMapper" />
      </property>
      <property name="lineAggregator">
         <bean parent="batch.transform.DelimitedLineAggregator" p:stringFields="0,5" />
      </property>
      <property name="message" value="cargaRelacion.itemWriter" />
      <property name="severidad" value="error" />
      <property name="trim" value="true" />
   </bean>
	
	<!-- No delimited reader -->
   <bean id="cargaDirecciones.itemReader" parent="batch.task.FlatFileItemReader" scope="prototype">
      <property name="bindings" value="fileSystemResource=txtFileDirecciones" />
      <property name="recordSeparatorPolicy">
         <bean class="org.springframework.batch.item.file.separator.SimpleRecordSeparatorPolicy"/>
      </property>      
      <property name="lineTokenizer">
         <bean parent="batch.transform.FixedLengthTokenizer"
            p:columns="1-8,9-12,13-32,33-52,53-152,153-252,253-262,263-272,273-282,283-292,293-302,303-312,313-412,413-512,513-612,613-622,623-632,633-642,643-652" />
      </property>
      <property name="fieldSetMapper">
         <bean parent="batch.mapper.PassThroughFieldSetMapper" />
      </property>
      <property name="message" value="cargaDireccion.itemReader.tokenizerError" />
      <property name="severidad" value="error" />
   </bean>
	
	<!-- Custom delimited writer -->
   <bean id="cargaDirecciones.itemWriter" parent="batch.task.FlatFileItemWriter" scope="prototype">
      <property name="bindings" value="fileSystemResource=csvFileDirecciones" />
      <property name="fieldSetCreator">
         <bean parent="batch.mapper.PassThroughFieldSetMapper" />
      </property>
      <property name="lineAggregator">
         <bean parent="batch.transform.DelimitedLineAggregator" p:stringFields="4,5,6,7,8,9,10,12,13,14" />
      </property>
      <property name="message" value="cargaDireccion.itemWriter" />
      <property name="severidad" value="error" />
      <property name="trim" value="true" />
   </bean>
</beans>
