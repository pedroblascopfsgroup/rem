<beans xmlns="http://www.springframework.org/schema/beans" xmlns:p="http://www.springframework.org/schema/p" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.5.xsd"
    default-autowire="byName" default-merge="true">
    <bean id="validacionesPCRJob" parent="batch.simpleJob" scope="prototype">
        <property name="steps">
            <list>
                <bean id="pasaje.contratos.valdidator" parent="batch.taskletStep" scope="prototype">
                    <property name="tasklet">
                        <bean parent="common.validator" scope="prototype">
                            <property name="validaciones">
                                <list>
                                    <ref bean="carga.fechaExtraccion" />
						            <!-- Contratos -->
                                    <ref bean="cargaContrato.contractSumValidator" />
                                    <ref bean="cnt-00.countValidator" />
                                    <ref bean="cnt-01.entityValidator" />
                                    <ref bean="cnt-02.loadDateValidator" />
                                    <ref bean="cnt-03.movementValidator" />
                                    <ref bean="cnt-04.officeCodeValidator" />
                                    <!-- <ref bean="cnt-05.zonaCodeValidator" /> -->
                                    <ref bean="cnt-06.currencyCodeValidator" />
                                    <ref bean="cnt-07.productTypeCodeValidator" />
                                    <ref bean="cnt-08.contratoRelacionValidator" />
                                    <ref bean="cnt-09.movimientoPrevio" />
                                    <ref bean="cnt-10.fechaExtracionMenorHoy" />
                                    <!-- Comentado a pedido del cliente -->
                                    <!--  <ref bean="cnt-11.fechaPosVencida" /> -->
                                    <ref bean="cnt-12.activoPositvo" /> 
									                                   
                                    <ref bean="cnt-13.finalidadOficial" />
									<ref bean="cnt-14.finalidadContrato" />                                    
                                    <ref bean="cnt-15.garantia1" />                                    
                                    <ref bean="cnt-16.garantia2" />                                    
                                    <ref bean="cnt-17.catalogo1" />                                    
                                    <ref bean="cnt-18.catalogo2" />                                    
                                    <ref bean="cnt-19.catalogo3" />                                    
                                    <ref bean="cnt-20.catalogo4" />                                    
                                    <ref bean="cnt-21.extra3" />                                    
                                    <ref bean="cnt-22.extra4" />
                                    <ref bean="cnt-23.relacionesCatalogos" />
									
									       
                                    <!-- Personas -->
                                    <ref bean="per-00.validateCount" />
                                    <ref bean="per-01.entityValidator" />
                                    <ref bean="per-02.loadDateValidator" />
                                    <ref bean="per-03.personTypeValidator" />
                                    <ref bean="per-04.documentTypeValidator" />
                                    <ref bean="per-05.segmentValidator" />
                                    <ref bean="per-06.personaRelacionValidator" />
									                                    
                                    <ref bean="per-07.oficina" />                                    
                                    <ref bean="per-08.zona" />                                    
                                    <ref bean="per-09.tipoTelefono1" />                                    
                                    <ref bean="per-10.tipoTelefono2" />                                    
                                    <ref bean="per-11.tipoTelefono3" />                                    
                                    <ref bean="per-12.tipoTelefono4" />                                    
                                    <ref bean="per-13.tipoTelefono5" />                                    
                                    <ref bean="per-14.tipoTelefono6" />                                    
                                    <!-- <ref bean="per-15.perfilGestor" /> -->                                   
                                    <!-- <ref bean="per-16.usuarioGestor" /> -->                                    
                                    <!-- <ref bean="per-17.grupoGestor" /> -->                                    
                                    <ref bean="per-18.politica" />                                    
                                    <ref bean="per-19.ratingExterno" />                                    
                                    <ref bean="per-20.ratingAuxiliar" />                                    
                                    <ref bean="per-21.nacionalidad" />                                    
                                    <ref bean="per-22.paisNacimiento" />                                    
                                    <ref bean="per-23.sexo" />  
									                                
									<!-- Relaciones -->
                                    <ref bean="cnt-per-00.countValidator" />
                                    <ref bean="cnt-per-01.entityValidator" />
                                    <ref bean="cnt-per-02.loadDateValidator" />
                                    <ref bean="cnt-per-03.intervencionValidator" />
                                    <ref bean="cnt-per-04.integridadValidator" />
                                    <ref bean="cnt-per-05.integridadCodOficinaValidator" />
    								 <!-- Direcciones -->
                                    <ref bean="dir-01.entityValidator" />
                                    <ref bean="dir-00.countValidator" />
                                    <ref bean="dir-02.loadDateValidator" />
                                    <ref bean="dir-03.validarPersona" />
									 <!--  Validación de volumen de contratos  -->
                                    <ref bean="cargaContratos.volumenValidator" />
                                </list>
                            </property>
                        </bean>
                    </property>
                </bean>
            </list>
        </property>
    </bean>
    <bean id="carga.fechaExtraccion" class="es.capgemini.pfs.batch.common.NumericResultValidatorTasklet" scope="prototype">
        <property name="dataSource" ref="entityDataSource" />
        <property name="query">
            <bean parent="sql" p:key="pcr.fechaExtraccion" />
        </property>
        <property name="expectedNumber" value="0" />
        <property name="message" value="carga.fechaExtraccion" />
        <property name="severidad" value="error" />
    </bean>
    
    <bean id="cargaContrato.contractSumValidator" class="es.capgemini.pfs.batch.common.NumericResultValidatorTasklet" scope="prototype">
        <property name="dataSource" ref="entityDataSource" />
        <property name="query">
            <bean parent="sql" p:key="cargaContrato.contractSumValidator" />
        </property>
        <property name="bindings" value="expectedNumber=contratosSunPosVencida" />
        <property name="message" value="cargaContrato.contractSumValidator" />
        <property name="severidad" value="error" />
    </bean>
    
    <bean id="cnt-00.countValidator" class="es.capgemini.pfs.batch.common.RecordCountValidatorTasklet" scope="prototype">
        <property name="dataSource" ref="entityDataSource" />
        <property name="tableName" value="tmp_cnt_contratos" />
        <property name="bindings" value="expectedRecords=contratosRowCount" />
        <property name="message" value="cnt-00.countValidator" />
        <property name="severidad" value="error" />
    </bean>
    <!-- valido que las entidades correspondan con la del archivo -->
    <bean id="cnt-01.entityValidator" class="es.capgemini.pfs.batch.load.EntityValidatorTasklet" scope="prototype">
        <property name="dataSource" ref="entityDataSource" />
        <property name="query">
            <bean parent="sql" p:key="cnt-01.entityValidator" />
        </property>
        <property name="bindings" value="entidad=entidad" />
        <property name="message" value="cnt-01.entityValidator" />
        <property name="severidad" value="error" />
    </bean>
    
    <bean id="cnt-02.loadDateValidator" class="es.capgemini.pfs.batch.load.LoadDateValidatorTasklet" scope="prototype">
        <property name="dataSource" ref="entityDataSource" />
        <property name="query">
            <bean parent="sql" p:key="cnt-02.loadDateValidator" />
        </property>
        <property name="bindings" value="fileName=csvFileContratos" />
        <property name="message" value="cnt-02.loadDateValidator" />
        <property name="severidad" value="error" />
    </bean>
    
    <bean id="cnt-03.movementValidator" class="es.capgemini.pfs.batch.common.BatchValidatorTasklet" scope="prototype">
        <property name="dataSource" ref="entityDataSource" />
        <property name="query">
            <bean parent="sql" p:key="cnt-03.movementValidator" />
        </property>
        <property name="bindings" value="fileName=fileName" />
        <property name="expectedNumber" value="0" />
        <property name="message" value="cnt-03.movementValidator" />
        <property name="severidad" value="error" />
    </bean>
    
    <!-- Verifico las oficinas -->
    <bean id="cnt-04.officeCodeValidator" class="es.capgemini.pfs.batch.common.BatchValidatorTasklet" scope="prototype">
        <property name="dataSource" ref="entityDataSource" />
        <property name="query">
            <bean parent="sql" p:key="cnt-04.officeCodeValidator" />
        </property>
        <property name="expectedNumber" value="0" />
        <property name="message" value="cnt-04.officeCodeValidator" />
        <property name="severidad" value="error" />
    </bean>
   
    <!-- Verifico las zona -->
    <bean id="cnt-05.zonaCodeValidator" class="es.capgemini.pfs.batch.common.BatchValidatorTasklet" scope="prototype">
        <property name="dataSource" ref="entityDataSource" />
        <property name="query">
            <bean parent="sql" p:key="cnt-05.zonaCodeValidator" />
        </property>
        <property name="expectedNumber" value="0" />
        <property name="message" value="cnt-05.zonaCodeValidator" />
        <property name="severidad" value="error" />
    </bean>

    <!-- Verifico que los códigos de moneda existan -->
    <bean id="cnt-06.currencyCodeValidator" class="es.capgemini.pfs.batch.common.BatchValidatorTasklet" scope="prototype">
        <property name="dataSource" ref="entityDataSource" />
        <property name="query">
            <bean parent="sql" p:key="cnt-06.currencyCodeValidator" />
        </property>
        <property name="expectedNumber" value="0" />
        <property name="message" value="cnt-06.currencyCodeValidator" />
        <property name="severidad" value="error" />
    </bean>

     <!-- Verifico que los tipos de producto existan -->
    <bean id="cnt-07.productTypeCodeValidator" class="es.capgemini.pfs.batch.common.BatchValidatorTasklet" scope="prototype">
        <property name="dataSource" ref="entityDataSource" />
        <property name="query">
            <bean parent="sql" p:key="cnt-07.productTypeCodeValidator" />
        </property>
        <property name="expectedNumber" value="0" />
        <property name="message" value="cnt-07.productTypeCodeValidator" />
        <property name="severidad" value="error" />
    </bean>
    
    <!-- validación que verifica que un contrato cargado temporalmente exista en la tabla temporal de relaciones     -->
    <bean id="cnt-08.contratoRelacionValidator" class="es.capgemini.pfs.batch.common.BatchValidatorTasklet" scope="prototype">
        <property name="dataSource" ref="entityDataSource" />
        <property name="query">
            <bean parent="sql" p:key="cnt-08.contratoRelacionValidator" />
        </property>
        <property name="expectedNumber" value="0" />
        <property name="message" value="cnt-08.contratoRelacionValidator" />
        <property name="severidad" value="error" />
    </bean>    
    
    <bean id="cnt-09.movimientoPrevio" class="es.capgemini.pfs.batch.common.BatchValidatorTasklet" scope="prototype">
        <property name="dataSource" ref="entityDataSource" />
        <property name="query">
            <bean parent="sql" p:key="cnt-09.movimientoPrevio" />
        </property>
        <property name="expectedNumber" value="0" />
        <property name="message" value="cnt-09.movimientoPrevio" />
        <property name="severidad" value="error" />
        <property name="argumento" value="4" />
    </bean>
    
    <bean id="cnt-10.fechaExtracionMenorHoy" class="es.capgemini.pfs.batch.common.BatchValidatorTasklet" scope="prototype">
        <property name="dataSource" ref="entityDataSource" />
        <property name="query">
            <bean parent="sql" p:key="cnt-10.fechaExtracionMenorHoy" />
        </property>
        <property name="expectedNumber" value="0" />
        <property name="message" value="cnt-10.fechaExtracionMenorHoy" />
        <property name="severidad" value="error" />
    </bean>
    
    <bean id="cnt-11.fechaPosVencida" class="es.capgemini.pfs.batch.common.BatchValidatorTasklet" scope="prototype">
        <property name="dataSource" ref="entityDataSource" />
        <property name="query">
            <bean parent="sql" p:key="cnt-11.fechaPosVencida" />
        </property>
        <property name="expectedNumber" value="0" />
        <property name="message" value="cnt-11.fechaPosVencida" />
        <property name="severidad" value="error" />
    </bean>
    
    <bean id="cnt-12.activoPositvo" class="es.capgemini.pfs.batch.common.BatchValidatorTasklet" scope="prototype">
        <property name="dataSource" ref="entityDataSource" />
        <property name="query">
            <bean parent="sql" p:key="cnt-12.activoPositvo" />
        </property>
        <property name="expectedNumber" value="0" />
        <property name="message" value="cnt-12.activoPositvo" />
        <property name="severidad" value="error" />
    </bean> 
	
	<bean id="cnt-13.finalidadOficial" class="es.capgemini.pfs.batch.common.BatchValidatorTasklet" scope="prototype">
		<property name="dataSource" ref="entityDataSource" />
	        <property name="query">
	            <bean parent="sql" p:key="cnt-13.finalidadOficial" />
	        </property>
        	<property name="expectedNumber" value="0" />
	        <property name="message" value="cnt-13.finalidadOficial" />
	        <property name="severidad" value="error" />
	</bean>
	
	<bean id="cnt-14.finalidadContrato" class="es.capgemini.pfs.batch.common.BatchValidatorTasklet" scope="prototype">                                    
		<property name="dataSource" ref="entityDataSource" />
	        <property name="query">
	            <bean parent="sql" p:key="cnt-14.finalidadContrato" />
	        </property>
        	<property name="expectedNumber" value="0" />
	        <property name="message" value="cnt-14.finalidadContrato" />
	        <property name="severidad" value="error" />
	</bean>
	<bean id="cnt-15.garantia1" class="es.capgemini.pfs.batch.common.BatchValidatorTasklet" scope="prototype">                                    
		<property name="dataSource" ref="entityDataSource" />
	        <property name="query">
	            <bean parent="sql" p:key="cnt-15.garantia1" />
	        </property>
        	<property name="expectedNumber" value="0" />
	        <property name="message" value="cnt-15.garantia1" />
	        <property name="severidad" value="error" />
	</bean>
	<bean id="cnt-16.garantia2" class="es.capgemini.pfs.batch.common.BatchValidatorTasklet" scope="prototype">                                    
		<property name="dataSource" ref="entityDataSource" />
	        <property name="query">
	            <bean parent="sql" p:key="cnt-16.garantia2" />
	        </property>
        	<property name="expectedNumber" value="0" />
	        <property name="message" value="cnt-16.garantia2" />
	        <property name="severidad" value="error" />
	</bean>
	<bean id="cnt-17.catalogo1" class="es.capgemini.pfs.batch.common.BatchValidatorTasklet" scope="prototype">                                    
		<property name="dataSource" ref="entityDataSource" />
	        <property name="query">
	            <bean parent="sql" p:key="cnt-17.catalogo1" />
	        </property>
        	<property name="expectedNumber" value="0" />
	        <property name="message" value="cnt-17.catalogo1" />
	        <property name="severidad" value="error" />
	</bean>
	
	<bean id="cnt-18.catalogo2" class="es.capgemini.pfs.batch.common.BatchValidatorTasklet" scope="prototype">                                    
		<property name="dataSource" ref="entityDataSource" />
	        <property name="query">
	            <bean parent="sql" p:key="cnt-18.catalogo2" />
	        </property>
        	<property name="expectedNumber" value="0" />
	        <property name="message" value="cnt-18.catalogo2" />
	        <property name="severidad" value="error" />
	</bean>
	
	<bean id="cnt-19.catalogo3" class="es.capgemini.pfs.batch.common.BatchValidatorTasklet" scope="prototype">                                    
		<property name="dataSource" ref="entityDataSource" />
	        <property name="query">
	            <bean parent="sql" p:key="cnt-19.catalogo3" />
	        </property>
        	<property name="expectedNumber" value="0" />
	        <property name="message" value="cnt-19.catalogo3" />
	        <property name="severidad" value="error" />
	</bean>
	<bean id="cnt-20.catalogo4" class="es.capgemini.pfs.batch.common.BatchValidatorTasklet" scope="prototype">                                    
		<property name="dataSource" ref="entityDataSource" />
	        <property name="query">
	            <bean parent="sql" p:key="cnt-20.catalogo4" />
	        </property>
        	<property name="expectedNumber" value="0" />
	        <property name="message" value="cnt-20.catalogo4" />
	        <property name="severidad" value="error" />
	</bean>
	<bean id="cnt-21.extra3" class="es.capgemini.pfs.batch.common.BatchValidatorTasklet" scope="prototype">                                    
		<property name="dataSource" ref="entityDataSource" />
	        <property name="query">
	            <bean parent="sql" p:key="cnt-21.extra3" />
	        </property>
        	<property name="expectedNumber" value="0" />
	        <property name="message" value="cnt-21.extra3" />
	        <property name="severidad" value="error" />
	</bean>
	<bean id="cnt-22.extra4" class="es.capgemini.pfs.batch.common.BatchValidatorTasklet" scope="prototype">   
		<property name="dataSource" ref="entityDataSource" />
	        <property name="query">
	            <bean parent="sql" p:key="cnt-22.extra4" />
	        </property>
        	<property name="expectedNumber" value="0" />
	        <property name="message" value="cnt-22.extra4" />
	        <property name="severidad" value="error" />
	</bean>
	
	<bean id="cnt-23.relacionesCatalogos" class="es.capgemini.pfs.batch.common.BatchValidatorTasklet" scope="prototype">   
		<property name="dataSource" ref="entityDataSource" />
	        <property name="query">
	            <bean parent="sql" p:key="cnt-23.relacionesCatalogos" />
	        </property>
        	<property name="expectedNumber" value="0" />
	        <property name="message" value="cnt-23.relacionesCatalogos" />
	        <property name="severidad" value="error" />
	</bean>
	
	
  
	<!-- Validaciones de personas -->
	
	<!-- Se valida que la cantidad de registros insertados coincida con la que viene del semáforo -->
    <bean id="per-00.validateCount" class="es.capgemini.pfs.batch.common.RecordCountValidatorTasklet" scope="prototype">
        <property name="dataSource" ref="entityDataSource" />
        <property name="tableName" value="tmp_per_personas" />
        <property name="bindings" value="expectedRecords=personasRowCount" />
        <property name="message" value="per-00.validateCount" />
        <property name="severidad" value="error" />
    </bean>
  	
    <!-- Se valida que las entidades corresponden a la de la carga -->
    <bean id="per-01.entityValidator" class="es.capgemini.pfs.batch.load.EntityValidatorTasklet" scope="prototype">
        <property name="dataSource" ref="entityDataSource" />
        <property name="query">
            <bean parent="sql" p:key="per-01.entityValidator" />
        </property>
        <property name="bindings" value="entidad=entidad" />
        <property name="message" value="per-01.entityValidator" />
        <property name="severidad" value="error" />
    </bean>
    
  	<!-- Se valida que la fecha de extracción no sea diferente a la de la carga -->
    <bean id="per-02.loadDateValidator" class="es.capgemini.pfs.batch.load.LoadDateValidatorTasklet" scope="prototype">
        <property name="dataSource" ref="entityDataSource" />
        <property name="query">
            <bean parent="sql" p:key="per-02.loadDateValidator" />
        </property>
        <property name="bindings" value="fileName=csvFilePersonas" />
        <property name="message" value="per-02.loadDateValidator" />
        <property name="severidad" value="error" />
    </bean>
 
    <!-- Se verifica que el tipo de persona que viene en el fichero exista en el diccionario de datos para tipo de personas  -->
    <bean id="per-03.personTypeValidator" class="es.capgemini.pfs.batch.common.BatchValidatorTasklet" scope="prototype">
        <property name="dataSource" ref="entityDataSource" />
        <property name="query">
            <bean parent="sql" p:key="per-03.personTypeValidator" />
        </property>
        <property name="expectedNumber" value="0" />
        <property name="message" value="per-03.personTypeValidator" />
        <property name="severidad" value="error" />
    </bean>
    
    <!-- Se verifica que el tipo de documento que viene en el fichero exista en el diccionario de datos para tipo de documentos. -->
    <bean id="per-04.documentTypeValidator" class="es.capgemini.pfs.batch.common.BatchValidatorTasklet" scope="prototype">
        <property name="dataSource" ref="entityDataSource" />
        <property name="query">
            <bean parent="sql" p:key="per-04.documentTypeValidator" />
        </property>
        <property name="expectedNumber" value="0" />
        <property name="message" value="per-04.documentTypeValidator" />
        <property name="severidad" value="error" />
    </bean>
    
    <!-- Se verifica que el código de segmento que viene en el fichero exista en el diccionario de datos para tipo de segmentos. -->
    <bean id="per-05.segmentValidator" class="es.capgemini.pfs.batch.common.BatchValidatorTasklet" scope="prototype">
        <property name="dataSource" ref="entityDataSource" />
        <property name="query">
            <bean parent="sql" p:key="per-05.segmentValidator" />
        </property>
        <property name="expectedNumber" value="0" />
        <property name="message" value="per-05.segmentValidator" />
        <property name="severidad" value="error" />
    </bean>
        
	<!-- Se verifica que las personas tengan relación con los contratos cargados en el día  -->
    <bean id="per-06.personaRelacionValidator" class="es.capgemini.pfs.batch.common.BatchValidatorTasklet" scope="prototype">
        <property name="dataSource" ref="entityDataSource" />
        <property name="query">
            <bean parent="sql" p:key="per-06.personaRelacionValidator" />
        </property>
        <property name="expectedNumber" value="0" />
        <property name="message" value="per-06.personaRelacionValidator" />
        <property name="severidad" value="info" />
    </bean>
	
	<!-- Validacion Oficina -->
	<bean id="per-07.oficina" class="es.capgemini.pfs.batch.common.BatchValidatorTasklet" scope="prototype">                                    
		<property name="dataSource" ref="entityDataSource" />
	        <property name="query">
	            <bean parent="sql" p:key="per-07.oficina" />
	        </property>
        	<property name="expectedNumber" value="0" />
	        <property name="message" value="per-07.oficina" />
	        <property name="severidad" value="error" />
	</bean>
	<!-- Validacion Zona -->
	<bean id="per-08.zona" class="es.capgemini.pfs.batch.common.BatchValidatorTasklet" scope="prototype">                                    
		<property name="dataSource" ref="entityDataSource" />
	        <property name="query">
	            <bean parent="sql" p:key="per-08.zona" />
	        </property>
        	<property name="expectedNumber" value="0" />
	        <property name="message" value="per-08.zona" />
	        <property name="severidad" value="error" />
	</bean>
	<!-- Validacion Telefono 1 -->
	<bean id="per-09.tipoTelefono1" class="es.capgemini.pfs.batch.common.BatchValidatorTasklet" scope="prototype">                                    
		<property name="dataSource" ref="entityDataSource" />
	        <property name="query">
	            <bean parent="sql" p:key="per-09.tipoTelefono1" />
	        </property>
        	<property name="expectedNumber" value="0" />
	        <property name="message" value="per-09.tipoTelefono1" />
	        <property name="severidad" value="error" />
	</bean>
	<!-- Validacion Telefono 2 -->
	<bean id="per-10.tipoTelefono2" class="es.capgemini.pfs.batch.common.BatchValidatorTasklet" scope="prototype">                                    
		<property name="dataSource" ref="entityDataSource" />
	        <property name="query">
	            <bean parent="sql" p:key="per-10.tipoTelefono2" />
	        </property>
        	<property name="expectedNumber" value="0" />
	        <property name="message" value="per-10.tipoTelefono2" />
	        <property name="severidad" value="error" />
	</bean>
	<!-- Validacion Telefono 3 -->
	<bean id="per-11.tipoTelefono3" class="es.capgemini.pfs.batch.common.BatchValidatorTasklet" scope="prototype">                                    
		<property name="dataSource" ref="entityDataSource" />
	        <property name="query">
	            <bean parent="sql" p:key="per-11.tipoTelefono3" />
	        </property>
        	<property name="expectedNumber" value="0" />
	        <property name="message" value="per-11.tipoTelefono3" />
	        <property name="severidad" value="error" />
	</bean>
	<!-- Validacion Telefono 4 -->
	<bean id="per-12.tipoTelefono4" class="es.capgemini.pfs.batch.common.BatchValidatorTasklet" scope="prototype">                                    
		<property name="dataSource" ref="entityDataSource" />
	        <property name="query">
	            <bean parent="sql" p:key="per-12.tipoTelefono4" />
	        </property>
        	<property name="expectedNumber" value="0" />
	        <property name="message" value="per-12.tipoTelefono4" />
	        <property name="severidad" value="error" />
	</bean>
	<!-- Validacion Telefono 5 -->
	<bean id="per-13.tipoTelefono5" class="es.capgemini.pfs.batch.common.BatchValidatorTasklet" scope="prototype">                                    
		<property name="dataSource" ref="entityDataSource" />
	        <property name="query">
	            <bean parent="sql" p:key="per-13.tipoTelefono5" />
	        </property>
        	<property name="expectedNumber" value="0" />
	        <property name="message" value="per-13.tipoTelefono5" />
	        <property name="severidad" value="error" />
	</bean>
	<!-- Validacion Telefono 6 -->
	<bean id="per-14.tipoTelefono6" class="es.capgemini.pfs.batch.common.BatchValidatorTasklet" scope="prototype">                                    
		<property name="dataSource" ref="entityDataSource" />
	        <property name="query">
	            <bean parent="sql" p:key="per-14.tipoTelefono6" />
	        </property>
        	<property name="expectedNumber" value="0" />
	        <property name="message" value="per-14.tipoTelefono6" />
	        <property name="severidad" value="error" />
	</bean>
	<!-- Validacion Perfil Gestor -->
	<bean id="per-15.perfilGestor" class="es.capgemini.pfs.batch.common.BatchValidatorTasklet" scope="prototype">                                    
		<property name="dataSource" ref="entityDataSource" />
	        <property name="query">
	            <bean parent="sql" p:key="per-15.perfilGestor" />
	        </property>
        	<property name="expectedNumber" value="0" />
	        <property name="message" value="per-15.perfilGestor" />
	        <property name="severidad" value="error" />
	</bean>
	<!-- Validacion usuario -->
	<bean id="per-16.usuarioGestor" class="es.capgemini.pfs.batch.common.BatchValidatorTasklet" scope="prototype">                                    
		<property name="dataSource" ref="entityDataSource" />
	        <property name="query">
	            <bean parent="sql" p:key="per-16.usuarioGestor" />
	        </property>
        	<property name="expectedNumber" value="0" />
	        <property name="message" value="per-16.usuarioGestor" />
	        <property name="severidad" value="error" />
	</bean>
	<!-- Validacion Grupo Gestor -->
	<bean id="per-17.grupoGestor" class="es.capgemini.pfs.batch.common.BatchValidatorTasklet" scope="prototype">                                    
		<property name="dataSource" ref="entityDataSource" />
	        <property name="query">
	            <bean parent="sql" p:key="per-17.grupoGestor" />
	        </property>
        	<property name="expectedNumber" value="0" />
	        <property name="message" value="per-17.grupoGestor" />
	        <property name="severidad" value="error" />
	</bean>
	<!-- Validacion Politica -->
	<bean id="per-18.politica" class="es.capgemini.pfs.batch.common.BatchValidatorTasklet" scope="prototype">                                    
		<property name="dataSource" ref="entityDataSource" />
	        <property name="query">
	            <bean parent="sql" p:key="per-18.politica" />
	        </property>
        	<property name="expectedNumber" value="0" />
	        <property name="message" value="per-18.politica" />
	        <property name="severidad" value="error" />
	</bean>
	<!-- Validacion Rating externo -->
	<bean id="per-19.ratingExterno" class="es.capgemini.pfs.batch.common.BatchValidatorTasklet" scope="prototype">                                    
		<property name="dataSource" ref="entityDataSource" />
	        <property name="query">
	            <bean parent="sql" p:key="per-19.ratingExterno" />
	        </property>
        	<property name="expectedNumber" value="0" />
	        <property name="message" value="per-19.ratingExterno" />
	        <property name="severidad" value="error" />
	</bean>
	<!-- Validacion Rating auxiliar -->
	<bean id="per-20.ratingAuxiliar" class="es.capgemini.pfs.batch.common.BatchValidatorTasklet" scope="prototype">                                    
		<property name="dataSource" ref="entityDataSource" />
	        <property name="query">
	            <bean parent="sql" p:key="per-20.ratingAuxiliar" />
	        </property>
        	<property name="expectedNumber" value="0" />
	        <property name="message" value="per-20.ratingAuxiliar" />
	        <property name="severidad" value="error" />
	</bean>
	<!-- Validacion Nacionalidad -->
	<bean id="per-21.nacionalidad" class="es.capgemini.pfs.batch.common.BatchValidatorTasklet" scope="prototype">                                    
		<property name="dataSource" ref="entityDataSource" />
	        <property name="query">
	            <bean parent="sql" p:key="per-21.nacionalidad" />
	        </property>
        	<property name="expectedNumber" value="0" />
	        <property name="message" value="per-21.nacionalidad" />
	        <property name="severidad" value="error" />
	</bean>
	<!-- Validacion Pais nacimiento -->
	<bean id="per-22.paisNacimiento" class="es.capgemini.pfs.batch.common.BatchValidatorTasklet" scope="prototype">                                    
		<property name="dataSource" ref="entityDataSource" />
	        <property name="query">
	            <bean parent="sql" p:key="per-22.paisNacimiento" />
	        </property>
        	<property name="expectedNumber" value="0" />
	        <property name="message" value="per-22.paisNacimiento" />
	        <property name="severidad" value="error" />
	</bean>
	<!-- Validacion Sexo -->
	<bean id="per-23.sexo" class="es.capgemini.pfs.batch.common.BatchValidatorTasklet" scope="prototype">         
		<property name="dataSource" ref="entityDataSource" />
	        <property name="query">
	            <bean parent="sql" p:key="per-23.sexo" />
	        </property>
        	<property name="expectedNumber" value="0" />
	        <property name="message" value="per-23.sexo" />
	        <property name="severidad" value="error" />
	</bean>

  	<!--    validaciones pos carga temporal de RELACIONES     -->

	<!--   verifica que la cantidad de relaciones cargadas sea la misma que indica el archivo .sem   -->
    <bean id="cnt-per-00.countValidator" class="es.capgemini.pfs.batch.common.RecordCountValidatorTasklet" scope="prototype">
        <property name="dataSource" ref="entityDataSource" />
        <property name="tableName" value="tmp_cnt_per" />
        <property name="bindings" value="expectedRecords=relacionesRowCount" />
        <property name="message" value="cnt-per-00.countValidator" />
        <property name="severidad" value="error" />
    </bean>
    
    <!--   código de entidad correspondan con la del archivo   -->
    <bean id="cnt-per-01.entityValidator" class="es.capgemini.pfs.batch.load.EntityValidatorTasklet" scope="prototype">
        <property name="dataSource" ref="entityDataSource" />
        <property name="query">
            <bean parent="sql" p:key="cnt-per-01.entityValidator" />
        </property>
        <property name="bindings" value="entidad=entidad" />
        <property name="message" value="cnt-per-01.entityValidator" />
        <property name="severidad" value="error" />
    </bean>    
    
    <!--   fecha de extracción correcta   -->
    <bean id="cnt-per-02.loadDateValidator" class="es.capgemini.pfs.batch.load.LoadDateValidatorTasklet" scope="prototype">
        <property name="dataSource" ref="entityDataSource" />
        <property name="query">
            <bean parent="sql" p:key="cnt-per-02.loadDateValidator" />
        </property>
        <property name="bindings" value="fileName=csvFileRelacion" />
        <property name="message" value="cnt-per-02.loadDateValidator" />
        <property name="severidad" value="error" />
    </bean>    
    
    <!--   código de intervención corresponde con el de uno de la tabla de tipos de intervenciones   -->
    <bean id="cnt-per-03.intervencionValidator" class="es.capgemini.pfs.batch.common.BatchValidatorTasklet" scope="prototype">
        <property name="dataSource" ref="entityDataSource" />
        <property name="query">
            <bean parent="sql" p:key="cnt-per-03.intervencionValidator" />
        </property>
        <property name="expectedNumber" value="0" />
        <property name="message" value="cnt-per-03.intervencionValidator" />
        <property name="severidad" value="error" />
    </bean>
    
	<!--  verifica que los registros en la temporal de relaciones esten relacionados registros de la temp. de personas y contratos  -->
    <bean id="cnt-per-04.integridadValidator" class="es.capgemini.pfs.batch.common.BatchValidatorTasklet" scope="prototype">
        <property name="dataSource" ref="entityDataSource" />
        <property name="query">
            <bean parent="sql" p:key="cnt-per-04.integridadValidator" />
        </property>
        <property name="expectedNumber" value="0" />
        <property name="message" value="cnt-per-04.integridadValidator" />
        <property name="severidad" value="error" />
    </bean>

    <!-- verifica que los registros en la temporal de relaciones tenga correctamente cargado el código de oficina según la tabla temporal de contratos -->
    <bean id="cnt-per-05.integridadCodOficinaValidator" class="es.capgemini.pfs.batch.common.BatchValidatorTasklet" scope="prototype">
        <property name="dataSource" ref="entityDataSource" />
        <property name="query">
            <bean parent="sql" p:key="cnt-per-05.integridadCodOficinaValidator" />
        </property>
        <property name="expectedNumber" value="0" />
        <property name="message" value="cnt-per-05.integridadCodOficinaValidator" />
        <property name="severidad" value="error" />
    </bean>
			
	<!--    validaciones previas a la carga de DIRECCIONES a producción    -->
	<bean id="dir-00.countValidator" class="es.capgemini.pfs.batch.common.RecordCountValidatorTasklet" scope="prototype">
        <property name="dataSource" ref="entityDataSource" />
        <property name="tableName" value="tmp_direcciones" />
        <property name="bindings" value="expectedRecords=direccionesRowCount" />
        <property name="message" value="dir-00.countValidator" />
        <property name="severidad" value="info" />
    </bean>
   

	<!-- valido que las entidades correspondan con la del archivo -->
    <bean id="dir-01.entityValidator" class="es.capgemini.pfs.batch.load.EntityValidatorTasklet" scope="prototype">
        <property name="dataSource" ref="entityDataSource" />
        <property name="query">
            <bean parent="sql" p:key="dir-01.entityValidator" />
        </property>
        <property name="bindings" value="entidad=entidad" />
        <property name="message" value="dir-01.entityValidator" />
        <property name="severidad" value="info" />
    </bean>
	
  	<!-- Se valida que la fecha de extracción no sea diferente a la de la carga -->
    <bean id="dir-02.loadDateValidator" class="es.capgemini.pfs.batch.load.LoadDateValidatorTasklet" scope="prototype">
        <property name="dataSource" ref="entityDataSource" />
        <property name="query">
            <bean parent="sql" p:key="dir-02.loadDateValidator" />
        </property>
        <property name="bindings" value="fileName=csvFileDirecciones" />
        <property name="message" value="dir-02.loadDateValidator" />
        <property name="severidad" value="info" />
    </bean>
    
    <bean id="dir-03.validarPersona" class="es.capgemini.pfs.batch.common.BatchValidatorTasklet" scope="prototype">
        <property name="dataSource" ref="entityDataSource" />
        <property name="query">
            <bean parent="sql" p:key="dir-03.validarPersona" />
        </property>
        <property name="expectedNumber" value="0" />
        <property name="message" value="dir-03.validarPersona" />
        <property name="severidad" value="info" />
    </bean>
    
	<!--  Validación de volumen de contratos  -->
    <bean id="cargaContratos.volumenValidator" class="es.capgemini.pfs.batch.revisar.CargaVolumenContratosValidationTasklet" scope="prototype">
		<!--  Tolerancia en la diferencia de carga con respecto a la anterior, en %  -->
        <property name="bindings" value="fileName=fileName" />
        <property name="severidad" value="error" />
        <property name="mensajeFinal" value="cargaContrato.volumen.mensajeFinal" />
        <property name="mensajeActivoLineas" value="cargaContrato.volumen.mensajeActivoLineas" />
        <property name="mensajeActivoPosicionViva" value="cargaContrato.volumen.mensajeActivoPosicionViva" />
        <property name="mensajeActivoPosicionVencida" value="cargaContrato.volumen.mensajeActivoPosicionVencida" />
        <property name="mensajePasivoLineas" value="cargaContrato.volumen.mensajePasivoLineas" />
        <property name="mensajePasivoPosicionVencida" value="cargaContrato.volumen.mensajePasivoPosicionVencida" />
        <property name="mensajePasivoPosicionViva" value="cargaContrato.volumen.mensajePasivoPosicionViva" />     
    </bean>
</beans>
