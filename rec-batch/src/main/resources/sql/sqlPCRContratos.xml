<!DOCTYPE properties SYSTEM "http://java.sun.com/dtd/properties.dtd">
<properties>
    <entry key="pcr.insert.contratos">
    <![CDATA[
            insert into cnt_contratos(
                CNT_ID, CNT_FECHA_EXTRACCION,CNT_COD_ENTIDAD,OFI_ID,CNT_COD_OFICINA,
                CNT_COD_CENTRO,CNT_CONTRATO,DD_MON_ID,DD_TPE_ID,DD_TPR_ID,
                CNT_FECHA_CARGA,CNT_FICHERO_CARGA,USUARIOCREAR,FECHACREAR,
                ZON_ID,CNT_FECHA_CREACION,DD_EFC_ID,DD_EFC_ID_ANT, CNT_FECHA_ESC, CNT_FECHA_EFC, CNT_FECHA_EFC_ANT, dd_esc_id,
                
                CNT_LIMITE_INI,
                CNT_LIMITE_FIN,
				DD_FNO_ID,
				DD_FCN_ID,
				DD_GC1_ID,
				DD_GC2_ID,
				DD_CT1_ID,
				DD_CT2_ID,
				DD_CT3_ID,
				DD_CT4_ID,
				DD_CT5_ID,
				DD_CT6_ID,
				CNT_FECHA_CONSTITUCION,
				CNT_FECHA_VENC
                )
            select
                S_CNT_CONTRATOS.nextVal as CNT_ID, TMP_CNT_FECHA_EXTRACCION, TMP_CNT_COD_ENTIDAD,
                (select OFI_ID from ofi_oficinas where OFI_CODIGO = TMP_CNT_COD_OFICINA) as OFI_ID,
                TMP_CNT_COD_OFICINA,TMP_CNT_COD_CENTRO,TMP_CNT_CONTRATO,
                (select DD_MON_ID from dd_mon_monedas where DD_MON_CODIGO = TMP_CNT_MONEDA) monedaID,
                  (select tp.dd_tpe_id from dd_tpe_tipo_prod_entidad tp where trim(dd_tpe_codigo) = trim(TMP_CNT_TIPO_PRODUCTO)),
                  (select tp.dd_tpr_id from dd_tpe_tipo_prod_entidad tp where trim(dd_tpe_codigo) = trim(TMP_CNT_TIPO_PRODUCTO)),
                TMP_CNT_FECHA_CARGA,TMP_CNT_FICHERO_CARGA,'${PasajeAProducciónUser}',systimestamp,
                (select distinct z.zon_id
                   from zon_zonificacion z, ofi_oficinas o
                   where o.ofi_codigo = TMP_CNT_COD_OFICINA
                   and z.ofi_id = o.ofi_id),
                TMP_CNT_FECHA_CREA_CNT,
                (select def.DD_EFC_ID from dd_efc_estado_finan_cnt def where def.dd_efc_codigo = TMP_CNT_ESTADO_FINANCIERO ),
                (select def.DD_EFC_ID from dd_efc_estado_finan_cnt def where def.dd_efc_codigo = TMP_CNT_ESTADO_FINANCIERO_ANT ),
                tmp_fecha_estado_contrato, TMP_CNT_FECHA_ESTADO_FINANC, TMP_CNT_FECHA_ESTADO_FINAN_ANT,
                (select est.dd_esc_id from ${master.schema}.dd_esc_estado_cnt est where est.dd_esc_codigo = trim(TMP_ESTADO_CONTRATO) ),
                
                  TMP_CNT_LIMITE_INI,
				TMP_CNT_LIMITE_FIN,
				(select FNO.DD_FNO_ID from DD_FNO_FINALIDAD_OFICIAL FNO where tc.TMP_CNT_FINALIDAD_OFI is not null and  FNO.DD_FNO_CODIGO = TRIM(tc.TMP_CNT_FINALIDAD_OFI)),
				(select FCN.DD_FCN_ID from DD_FCN_FINALIDAD_CONTRATO FCN where tc.TMP_CNT_FINALIDAD_CON is not null and  FCN.DD_FCN_CODIGO = TRIM(tc.TMP_CNT_FINALIDAD_CON)),
				(select GCN.DD_GCN_ID from DD_GCN_GARANTIA_CONTRATO GCN where tc.TMP_CNT_GARANTIA_1 is not null and  GCN.DD_GCN_CODIGO = TRIM(tc.TMP_CNT_GARANTIA_1)),
				(select GCO.DD_GCO_ID from DD_GCO_GARANTIA_CONTABLE GCO where tc.TMP_CNT_GARANTIA_2 is not null and  GCO.DD_GCO_CODIGO = TRIM(tc.TMP_CNT_GARANTIA_2)),
                (SELECT ct1.DD_CT1_ID from DD_CT1_CATALOGO_1 ct1 where tc.TMP_CNT_CATALOGO_1 is not null and  ct1.DD_CT1_CODIGO = TRIM(tc.TMP_CNT_CATALOGO_1)),
                (SELECT ct2.DD_CT2_ID from DD_CT2_CATALOGO_2 ct2 JOIN DD_CT1_CATALOGO_1 ct1 ON ct2.dd_ct1_id = ct1.dd_ct1_id where tc.TMP_CNT_CATALOGO_2 is not null and ct2.DD_CT2_CODIGO = TRIM(tc.TMP_CNT_CATALOGO_2) and  ct1.DD_CT1_CODIGO = TRIM(tc.TMP_CNT_CATALOGO_1)),
                (SELECT ct3.DD_CT3_ID from DD_CT3_CATALOGO_3 ct3 JOIN DD_CT2_CATALOGO_2 ct2 ON ct3.dd_ct2_id = ct2.dd_ct2_id JOIN DD_CT1_CATALOGO_1 ct1 ON ct2.dd_ct1_id = ct1.dd_ct1_id where tc.TMP_CNT_CATALOGO_3 is not null and  ct3.DD_CT3_CODIGO = TRIM(tc.TMP_CNT_CATALOGO_3) and ct2.DD_CT2_CODIGO = TRIM(tc.TMP_CNT_CATALOGO_2) and  ct1.DD_CT1_CODIGO = TRIM(tc.TMP_CNT_CATALOGO_1)),
                (SELECT ct4.DD_CT4_ID from DD_CT4_CATALOGO_4 ct4 JOIN DD_CT3_CATALOGO_3 ct3 ON ct4.dd_ct3_id = ct3.dd_ct3_id JOIN DD_CT2_CATALOGO_2 ct2 ON ct3.dd_ct2_id = ct2.dd_ct2_id  JOIN DD_CT1_CATALOGO_1 ct1 ON ct2.dd_ct1_id = ct1.dd_ct1_id where tc.TMP_CNT_CATALOGO_4 is not null and ct4.DD_CT4_CODIGO = TRIM(tc.TMP_CNT_CATALOGO_4) and  ct3.DD_CT3_CODIGO = TRIM(tc.TMP_CNT_CATALOGO_3) and ct2.DD_CT2_CODIGO = TRIM(tc.TMP_CNT_CATALOGO_2) and  ct1.DD_CT1_CODIGO = TRIM(tc.TMP_CNT_CATALOGO_1)),
                (SELECT ct5.DD_CT5_ID from DD_CT5_CATALOGO_5 ct5 JOIN DD_CT4_CATALOGO_4 ct4 ON ct5.dd_ct4_id = ct4.dd_ct4_id JOIN DD_CT3_CATALOGO_3 ct3 ON ct4.dd_ct3_id = ct3.dd_ct3_id JOIN DD_CT2_CATALOGO_2 ct2 ON ct3.dd_ct2_id = ct2.dd_ct2_id  JOIN DD_CT1_CATALOGO_1 ct1 ON ct2.dd_ct1_id = ct1.dd_ct1_id where tc.TMP_CNT_CATALOGO_5 is not null and ct5.DD_CT5_CODIGO = TRIM(tc.TMP_CNT_CATALOGO_5) and ct4.DD_CT4_CODIGO = TRIM(tc.TMP_CNT_CATALOGO_4) and  ct3.DD_CT3_CODIGO = TRIM(tc.TMP_CNT_CATALOGO_3) and ct2.DD_CT2_CODIGO = TRIM(tc.TMP_CNT_CATALOGO_2) and  ct1.DD_CT1_CODIGO = TRIM(tc.TMP_CNT_CATALOGO_1)),
                (SELECT ct6.DD_CT6_ID from DD_CT6_CATALOGO_6 ct6 JOIN DD_CT5_CATALOGO_5 ct5 ON ct6.dd_ct5_id = ct5.dd_ct5_id JOIN DD_CT4_CATALOGO_4 ct4 ON ct5.dd_ct4_id = ct4.dd_ct4_id JOIN DD_CT3_CATALOGO_3 ct3 ON ct4.dd_ct3_id = ct3.dd_ct3_id JOIN DD_CT2_CATALOGO_2 ct2 ON ct3.dd_ct2_id = ct2.dd_ct2_id  JOIN DD_CT1_CATALOGO_1 ct1 ON ct2.dd_ct1_id = ct1.dd_ct1_id where tc.TMP_CNT_CATALOGO_6 is not null and  ct6.DD_CT6_CODIGO = TRIM(tc.TMP_CNT_CATALOGO_6) and ct5.DD_CT5_CODIGO = TRIM(tc.TMP_CNT_CATALOGO_5) and ct4.DD_CT4_CODIGO = TRIM(tc.TMP_CNT_CATALOGO_4) and  ct3.DD_CT3_CODIGO = TRIM(tc.TMP_CNT_CATALOGO_3) and ct2.DD_CT2_CODIGO = TRIM(tc.TMP_CNT_CATALOGO_2) and  ct1.DD_CT1_CODIGO = TRIM(tc.TMP_CNT_CATALOGO_1)),
				TMP_CNT_FECHA_CONSTITUCION,
				TMP_CNT_FECHA_VENC 
                
            from tmp_cnt_contratos tc
            where not exists (
                  select c.cnt_contrato
                  from cnt_contratos c
                  where c.cnt_contrato = tc.tmp_cnt_contrato
                  and c.CNT_COD_OFICINA = tc.TMP_CNT_COD_OFICINA
                  and c.borrado = 0 )
        ]]>
    </entry>
    <entry key="pcr.update.contratos">
  <!-- Agregar fix de oracle para que actualice el campo dd_esc_id  -->
    <![CDATA[
        UPDATE cnt_contratos c
        SET (c.fechamodificar, 
             c.cnt_fichero_carga, 
             c.cnt_fecha_esc, 
             DD_EFC_ID,
             DD_EFC_ID_ANT,
             c.cnt_fecha_efc,
             c.cnt_fecha_efc_ant,
             c.dd_esc_id,
             c.cnt_fecha_extraccion,
             dd_tpe_id,
             dd_tpr_id,
             
             CNT_LIMITE_INI,
             CNT_LIMITE_FIN,
			 DD_FNO_ID,
			 DD_FCN_ID,
			 DD_GC1_ID,
			 DD_GC2_ID,
			 DD_CT1_ID,
			 DD_CT2_ID,
			 DD_CT3_ID,
			 DD_CT4_ID,
			 DD_CT5_ID,
			 DD_CT6_ID,
			 CNT_FECHA_CONSTITUCION	,
			 CNT_FECHA_VENC
          
             ,CNT_COD_ENTIDAD
             ,CNT_COD_OFICINA
             ,CNT_COD_CENTRO
             ,CNT_CONTRATO
             ,DD_MON_ID
             ,CNT_FECHA_CARGA
             ,OFI_ID
             ,ZON_ID
             ,CNT_FECHA_CREACION
             )
           =(SELECT sysdate, 
                tc.tmp_cnt_fichero_carga,
                tc.tmp_fecha_estado_contrato,
                (select def.DD_EFC_ID from dd_efc_estado_finan_cnt def where def.dd_efc_codigo = TMP_CNT_ESTADO_FINANCIERO ),
                (select def.DD_EFC_ID from dd_efc_estado_finan_cnt def where def.dd_efc_codigo = TMP_CNT_ESTADO_FINANCIERO_ANT ), 
                tc.tmp_cnt_fecha_estado_financ,
                tc.TMP_CNT_FECHA_ESTADO_FINAN_ANT,
                (SELECT est.dd_esc_id FROM ${master.schema}.dd_esc_estado_cnt est WHERE est.dd_esc_codigo = TRIM(tc.tmp_estado_contrato)),
                tc.tmp_cnt_fecha_extraccion,
                (select tp.dd_tpe_id from dd_tpe_tipo_prod_entidad tp where trim(dd_tpe_codigo) = trim(TMP_CNT_TIPO_PRODUCTO)),
                (select tp.dd_tpr_id from dd_tpe_tipo_prod_entidad tp where trim(dd_tpe_codigo) = trim(TMP_CNT_TIPO_PRODUCTO)),
                
                tc.TMP_CNT_LIMITE_INI,
                tc.TMP_CNT_LIMITE_FIN,
				(SELECT fcn.DD_FNO_ID from DD_FNO_FINALIDAD_OFICIAL fcn where tc.TMP_CNT_FINALIDAD_OFI is not null and  fcn.DD_FNO_CODIGO  = TRIM(tc.TMP_CNT_FINALIDAD_OFI)),
				(SELECT fcn.dd_fcn_id from DD_FCN_FINALIDAD_CONTRATO fcn where TMP_CNT_FINALIDAD_OFI is not null and  fcn.DD_FCN_CODIGO  = TRIM(tc.TMP_CNT_FINALIDAD_CON)),
				(SELECT GCN.DD_GCN_ID from DD_GCN_GARANTIA_CONTRATO GCN where tc.TMP_CNT_GARANTIA_1 is not null and  GCN.DD_GCN_CODIGO = TRIM(tc.TMP_CNT_GARANTIA_1)),
				(SELECT GCO.DD_GCO_ID from DD_GCO_GARANTIA_CONTABLE GCO where tc.TMP_CNT_GARANTIA_2 is not null and  GCO.DD_GCO_CODIGO = TRIM(tc.TMP_CNT_GARANTIA_2)),
				(SELECT ct1.DD_CT1_ID from DD_CT1_CATALOGO_1 ct1 where tc.TMP_CNT_CATALOGO_1 is not null and  ct1.DD_CT1_CODIGO = TRIM(tc.TMP_CNT_CATALOGO_1)),
                (SELECT ct2.DD_CT2_ID from DD_CT2_CATALOGO_2 ct2 JOIN DD_CT1_CATALOGO_1 ct1 ON ct2.dd_ct1_id = ct1.dd_ct1_id where tc.TMP_CNT_CATALOGO_2 is not null and ct2.DD_CT2_CODIGO = TRIM(tc.TMP_CNT_CATALOGO_2) and  ct1.DD_CT1_CODIGO = TRIM(tc.TMP_CNT_CATALOGO_1)),
                (SELECT ct3.DD_CT3_ID from DD_CT3_CATALOGO_3 ct3 JOIN DD_CT2_CATALOGO_2 ct2 ON ct3.dd_ct2_id = ct2.dd_ct2_id JOIN DD_CT1_CATALOGO_1 ct1 ON ct2.dd_ct1_id = ct1.dd_ct1_id where tc.TMP_CNT_CATALOGO_3 is not null and  ct3.DD_CT3_CODIGO = TRIM(tc.TMP_CNT_CATALOGO_3) and ct2.DD_CT2_CODIGO = TRIM(tc.TMP_CNT_CATALOGO_2) and  ct1.DD_CT1_CODIGO = TRIM(tc.TMP_CNT_CATALOGO_1)),
                (SELECT ct4.DD_CT4_ID from DD_CT4_CATALOGO_4 ct4 JOIN DD_CT3_CATALOGO_3 ct3 ON ct4.dd_ct3_id = ct3.dd_ct3_id JOIN DD_CT2_CATALOGO_2 ct2 ON ct3.dd_ct2_id = ct2.dd_ct2_id  JOIN DD_CT1_CATALOGO_1 ct1 ON ct2.dd_ct1_id = ct1.dd_ct1_id where tc.TMP_CNT_CATALOGO_4 is not null and ct4.DD_CT4_CODIGO = TRIM(tc.TMP_CNT_CATALOGO_4) and  ct3.DD_CT3_CODIGO = TRIM(tc.TMP_CNT_CATALOGO_3) and ct2.DD_CT2_CODIGO = TRIM(tc.TMP_CNT_CATALOGO_2) and  ct1.DD_CT1_CODIGO = TRIM(tc.TMP_CNT_CATALOGO_1)),
                (SELECT ct5.DD_CT5_ID from DD_CT5_CATALOGO_5 ct5 JOIN DD_CT4_CATALOGO_4 ct4 ON ct5.dd_ct4_id = ct4.dd_ct4_id JOIN DD_CT3_CATALOGO_3 ct3 ON ct4.dd_ct3_id = ct3.dd_ct3_id JOIN DD_CT2_CATALOGO_2 ct2 ON ct3.dd_ct2_id = ct2.dd_ct2_id  JOIN DD_CT1_CATALOGO_1 ct1 ON ct2.dd_ct1_id = ct1.dd_ct1_id where tc.TMP_CNT_CATALOGO_5 is not null and ct5.DD_CT5_CODIGO = TRIM(tc.TMP_CNT_CATALOGO_5) and ct4.DD_CT4_CODIGO = TRIM(tc.TMP_CNT_CATALOGO_4) and  ct3.DD_CT3_CODIGO = TRIM(tc.TMP_CNT_CATALOGO_3) and ct2.DD_CT2_CODIGO = TRIM(tc.TMP_CNT_CATALOGO_2) and  ct1.DD_CT1_CODIGO = TRIM(tc.TMP_CNT_CATALOGO_1)),
                (SELECT ct6.DD_CT6_ID from DD_CT6_CATALOGO_6 ct6 JOIN DD_CT5_CATALOGO_5 ct5 ON ct6.dd_ct5_id = ct5.dd_ct5_id JOIN DD_CT4_CATALOGO_4 ct4 ON ct5.dd_ct4_id = ct4.dd_ct4_id JOIN DD_CT3_CATALOGO_3 ct3 ON ct4.dd_ct3_id = ct3.dd_ct3_id JOIN DD_CT2_CATALOGO_2 ct2 ON ct3.dd_ct2_id = ct2.dd_ct2_id  JOIN DD_CT1_CATALOGO_1 ct1 ON ct2.dd_ct1_id = ct1.dd_ct1_id where tc.TMP_CNT_CATALOGO_6 is not null and  ct6.DD_CT6_CODIGO = TRIM(tc.TMP_CNT_CATALOGO_6) and ct5.DD_CT5_CODIGO = TRIM(tc.TMP_CNT_CATALOGO_5) and ct4.DD_CT4_CODIGO = TRIM(tc.TMP_CNT_CATALOGO_4) and  ct3.DD_CT3_CODIGO = TRIM(tc.TMP_CNT_CATALOGO_3) and ct2.DD_CT2_CODIGO = TRIM(tc.TMP_CNT_CATALOGO_2) and  ct1.DD_CT1_CODIGO = TRIM(tc.TMP_CNT_CATALOGO_1)),
				tc.TMP_CNT_FECHA_CONSTITUCION,
				tc.TMP_CNT_FECHA_VENC
								
               ,TMP_CNT_COD_ENTIDAD
               ,TMP_CNT_COD_OFICINA
               ,TMP_CNT_COD_CENTRO
               ,TMP_CNT_CONTRATO
               ,(select DD_MON_ID from dd_mon_monedas where DD_MON_CODIGO = TMP_CNT_MONEDA) monedaID 
               ,TMP_CNT_FECHA_CARGA                          
               ,(select OFI_ID from ofi_oficinas where OFI_CODIGO = TMP_CNT_COD_OFICINA) as OFI_ID
               ,(select distinct z.zon_id from zon_zonificacion z, ofi_oficinas o where o.ofi_codigo = TMP_CNT_COD_OFICINA and z.ofi_id = o.ofi_id) as zon_id
               ,TMP_CNT_FECHA_CREA_CNT
                                       
             FROM tmp_cnt_contratos tc
             WHERE c.cnt_contrato = tc.tmp_cnt_contrato 
             AND  c.cnt_cod_oficina = tc.tmp_cnt_cod_oficina
             AND c.borrado = 0)
        WHERE c.cnt_fecha_extraccion  != (SELECT tc.tmp_cnt_fecha_extraccion FROM tmp_cnt_contratos tc WHERE rownum =1)
        AND (c.cnt_contrato, c.cnt_cod_oficina) IN (SELECT tmp_cnt_contrato, TMP_CNT_COD_OFICINA FROM tmp_cnt_contratos)
      ]]>
    </entry>
    <entry key="pcr.insert.movimientos">
    <![CDATA[       
                insert into mov_movimientos (
                    MOV_ID, 
                    CNT_ID,
                    MOV_POS_VIVA_NO_VENCIDA,
                    MOV_POS_VIVA_VENCIDA,
                    MOV_FECHA_POS_VENCIDA,
                    MOV_SALDO_DUDOSO,
                    MOV_FECHA_DUDOSO,
                    MOV_PROVISION,
                    MOV_INT_REMUNERATORIOS,
                    MOV_INT_MORATORIOS,
                    MOV_COMISIONES,
                    MOV_GASTOS,
                    MOV_FECHA_EXTRACCION,
                    MOV_FICHERO_CARGA,
                    MOV_FECHA_CARGA,
                    USUARIOCREAR,
                    FECHACREAR,
                    
                    MOV_RIESGO,
                    MOV_DEUDA_IRREGULAR,
                    MOV_DISPUESTO,
                    MOV_SALDO_PASIVO,
                    MOV_RIESGO_GARANT,
                    MOV_SALDO_EXCE,
                    MOV_LIMITE_DESC,
                    MOV_EXTRA_1,
                    MOV_EXTRA_2,
                    MOV_LTV_INI,
                    MOV_LTV_FIN,
                    DD_MX3_ID,
                    DD_MX4_ID,
                    MOV_EXTRA_5,
                    MOV_EXTRA_6
                                        
                    
                    )
                select s_mov_movimientos.nextval as mov_id,
                    (select c.cnt_id from cnt_contratos c where c.cnt_contrato = tmp_cnt_contrato and c.CNT_COD_OFICINA = TMP_CNT_COD_OFICINA) as CNT_ID,
                    TMP_CNT_POS_VIVA_NO_VENCIDA,
                    TMP_CNT_POS_VIVA_VENCIDA,
                    TMP_CNT_FECHA_POS_VENCIDA,
                    TMP_CNT_SALDO_DUDOSO,
                    TMP_CNT_FECHA_DUDOSO, 
                    NVL(TMP_CNT_PROVISION,0),
                    NVL(TMP_CNT_INT_REMUNERATORIOS,0),
                    NVL(TMP_CNT_INT_MORATORIOS,0),
                    NVL(TMP_CNT_COMISIONES,0),
                    NVL(TMP_CNT_GASTOS,0),
                    TMP_CNT_FECHA_EXTRACCION,
                    TMP_CNT_FICHERO_CARGA,
                    TMP_CNT_FECHA_CARGA,
                    '${PasajeAProducciónUser}',
                    FECHACREAR,
                    
                    NVL(TMP_CNT_RIESGO,0),
                    NVL(TMP_CNT_DEUDA_IRREGULAR,0),
                    NVL(TMP_CNT_DISPUESTO,0),
                    NVL(TMP_CNT_SALDO_PASIVO,0),
                    NVL(TMP_CNT_RIESGO_GARANT    ,0),
                    NVL(TMP_CNT_SALDO_EXCE ,0),
                    NVL(TMP_CNT_LIMITE_DESC    ,0),
                    NVL(TMP_CNT_EXTRA_1    ,0),
                    NVL(TMP_CNT_EXTRA_2 ,0),
                    NVL(TMP_CNT_LTV_INI    ,0),
                    NVL(TMP_CNT_LTV_FIN    ,0),
                    (select DD_MX3_ID from DD_MX3_MOVIMIENTO_EXTRA_3 where DD_MX3_CODIGO = TMP_CNT_EXTRA_3_CODIGO),
                    (select DD_MX4_ID from DD_MX4_MOVIMIENTO_EXTRA_4 where DD_MX4_CODIGO = TMP_CNT_EXTRA_4_CODIGO),
                    TMP_CNT_EXTRA_5    ,
                    TMP_CNT_EXTRA_6   
                    
                    
                from tmp_cnt_contratos
        ]]>
    </entry>
    <entry key="pcr.analize.contratos">
      <![CDATA[
        ANALYZE TABLE cnt_contratos ${sql.analyze}
         ]]>
    </entry>
    <entry key="pcr.analize.movimientos">
      <![CDATA[
        ANALYZE TABLE mov_movimientos ${sql.analyze}
         ]]>
    </entry>
    <entry key="pcr.fechaExtraccion">
    <![CDATA[SELECT COUNT (*)
              FROM tmp_cnt_per, tmp_cnt_contratos, tmp_per_personas, tmp_direcciones
             WHERE tmp_cnt_per_contrato = tmp_cnt_contrato
               AND tmp_cnt_per_cod_entidad = tmp_cnt_cod_entidad
               AND tmp_cnt_per_cod_oficina = tmp_cnt_cod_oficina
               AND tmp_cnt_per_cod_cliente = tmp_per_cod_cliente_entidad
               AND tmp_dir_cod_cliente_entidad = tmp_per_cod_cliente_entidad
               AND (   tmp_cnt_per_fecha_extraccion != tmp_cnt_fecha_extraccion
                    OR tmp_cnt_per_fecha_extraccion != tmp_per_fecha_extraccion
                    OR tmp_cnt_per_fecha_extraccion != tmp_dir_fecha_extraccion
                    OR tmp_per_fecha_extraccion != tmp_cnt_fecha_extraccion
                    OR tmp_per_fecha_extraccion != tmp_dir_fecha_extraccion
                    OR tmp_dir_fecha_extraccion != tmp_cnt_fecha_extraccion
                   )
        ]]>
    </entry>
    <entry key="cargaContrato.contractSumValidator">select sum(TMP_CNT_POS_VIVA_NO_VENCIDA) from tmp_cnt_contratos</entry>
    <entry key="cnt-01.entityValidator">
      <![CDATA[
      SELECT tmp_cnt_cod_entidad AS ERROR_FIELD,
      (tmp_cnt_cod_entidad ||'-'|| tmp_cnt_cod_oficina ||'-'|| tmp_cnt_contrato) AS ENTITY_CODE      
      FROM tmp_cnt_contratos WHERE tmp_cnt_cod_entidad <> ?
      ]]>
    </entry>
   
    <entry key="cnt-02.loadDateValidator">
      <![CDATA[
         SELECT TMP_CNT_FECHA_EXTRACCION AS ERROR_FIELD,
        (TMP_CNT_COD_ENTIDAD ||'-'|| TMP_CNT_COD_OFICINA ||'-'|| TMP_CNT_CONTRATO) AS ENTITY_CODE
         from TMP_CNT_CONTRATOS where TMP_CNT_FECHA_EXTRACCION <> to_date(?,'YYYYMMDD')
         ]]>
    </entry>
    <entry key="cnt-03.movementValidator">
    <![CDATA[
      SELECT tc.tmp_cnt_fecha_extraccion AS ERROR_FIELD,
               (tc.tmp_cnt_cod_entidad || '-' || tc.tmp_cnt_cod_oficina || '-' || tc.tmp_cnt_contrato) AS ENTITY_CODE 
          FROM cnt_contratos c, tmp_cnt_contratos tc
          where c.cnt_contrato = tc.tmp_cnt_contrato
          and tc.TMP_CNT_COD_ENTIDAD = c.CNT_COD_ENTIDAD
          and tc.TMP_CNT_COD_OFICINA = c.CNT_COD_OFICINA
          and c.cnt_fecha_extraccion >= tc.tmp_cnt_fecha_extraccion          
        ]]>
    </entry>
    <entry key="cnt-04.officeCodeValidator">
      <![CDATA[
        SELECT TMP_CNT_COD_OFICINA AS ERROR_FIELD,
        (tmp_cnt_cod_entidad ||'-'|| tmp_cnt_cod_oficina ||'-'|| tmp_cnt_contrato) AS ENTITY_CODE 
        FROM tmp_cnt_contratos tc WHERE NOT EXISTS(SELECT * FROM ofi_oficinas o WHERE tc.TMP_CNT_COD_OFICINA = o.ofi_codigo)
         ]]>
    </entry>
    <entry key="cnt-05.zonaCodeValidator">
      <![CDATA[
        SELECT TMP_CNT_COD_CENTRO AS ERROR_FIELD,
        (tmp_cnt_cod_entidad ||'-'|| tmp_cnt_cod_oficina ||'-'|| tmp_cnt_contrato) AS ENTITY_CODE 
        FROM tmp_cnt_contratos tc WHERE NOT EXISTS(SELECT * FROM zon_zonificacion z WHERE tc.TMP_CNT_COD_CENTRO = z.zon_cod)
         ]]>
    </entry>
    <entry key="cnt-06.currencyCodeValidator">
      <![CDATA[
        SELECT TMP_CNT_MONEDA AS ERROR_FIELD,
        (tmp_cnt_cod_entidad ||'-'|| tmp_cnt_cod_oficina ||'-'|| tmp_cnt_contrato) AS ENTITY_CODE 
        FROM tmp_cnt_contratos tc 
        WHERE NOT EXISTS (SELECT * FROM dd_mon_monedas m WHERE tc.TMP_CNT_MONEDA = m.DD_MON_CODIGO) 
      ]]>
    </entry>
    <entry key="cnt-07.productTypeCodeValidator">
    <![CDATA[
      SELECT tmp_cnt_tipo_producto AS ERROR_FIELD,
           (tmp_cnt_cod_entidad ||'-'|| tmp_cnt_cod_oficina ||'-'|| tmp_cnt_contrato) AS ENTITY_CODE 
      FROM tmp_cnt_contratos tc 
      WHERE NOT EXISTS (SELECT * FROM dd_tpe_tipo_prod_entidad tpe where trim(tc.tmp_cnt_tipo_producto) = trim(tpe.DD_TPE_CODIGO))
      ]]>
    </entry>
    <entry key="cnt-08.contratoRelacionValidator">
      <![CDATA[
        SELECT 'No existe relacion' AS ERROR_FIELD,
        (tc.tmp_cnt_cod_entidad || '-' || tc.tmp_cnt_cod_oficina || '-' || tc.tmp_cnt_contrato) AS ENTITY_CODE 
        from tmp_cnt_contratos tc where not exists ( 
        	select * 
        	from tmp_cnt_per tcp 
        	where tc.TMP_CNT_CONTRATO = tcp.TMP_CNT_PER_CONTRATO
        	and tc.TMP_CNT_COD_ENTIDAD = tcp.TMP_CNT_PER_COD_ENTIDAD
        	and tc.TMP_CNT_COD_OFICINA = tcp.TMP_CNT_PER_COD_OFICINA
        )
        
        
        ]]>
    </entry>
    <entry key="cnt-09.movimientoPrevio">
    <![CDATA[
        SELECT cnt.cnt_id AS ERROR_FIELD,
        (CNT.CNT_COD_ENTIDAD ||'-'|| CNT.CNT_COD_OFICINA ||'-'|| CNT.CNT_CONTRATO) AS ENTITY_CODE
        FROM cnt_contratos cnt, ${master.schema}.DD_ESC_ESTADO_CNT ec
        WHERE (CNT.CNT_COD_ENTIDAD, CNT.CNT_COD_OFICINA, CNT.CNT_CONTRATO) not in 
        (select TMP.TMP_CNT_COD_ENTIDAD, TMP.TMP_CNT_COD_OFICINA, TMP.TMP_CNT_CONTRATO  from tmp_cnt_contratos tmp)
        AND CNT.BORRADO = 0
        AND CNT.DD_ESC_ID = ec.DD_ESC_ID
        AND ec.dd_esc_codigo = ?
     ]]>
    </entry>
    <entry key="cnt-10.fechaExtracionMenorHoy">
    <![CDATA[
        SELECT tc.tmp_cnt_fecha_extraccion AS ERROR_FIELD,
        (tc.tmp_cnt_cod_entidad ||'-'|| tc.tmp_cnt_cod_oficina ||'-'|| tc.tmp_cnt_contrato) AS ENTITY_CODE         
        FROM tmp_cnt_contratos tc
        WHERE tc.tmp_cnt_fecha_extraccion > ${sql.function.curdate}
     ]]>
    </entry>
    <entry key="cnt-11.fechaPosVencida">
    <![CDATA[
           SELECT tc.tmp_cnt_fecha_pos_vencida AS ERROR_FIELD,
      (tc.tmp_cnt_cod_entidad || '-' || tc.tmp_cnt_cod_oficina || '-' || tc.tmp_cnt_contrato) AS ENTITY_CODE         
			FROM tmp_cnt_contratos tc, cnt_contratos c, mov_movimientos m
			WHERE tc.tmp_cnt_contrato = c.cnt_contrato
			and tc.TMP_CNT_COD_ENTIDAD = c.CNT_COD_ENTIDAD
        	and tc.TMP_CNT_COD_OFICINA = c.CNT_COD_OFICINA
			AND c.cnt_id = m.cnt_id
			AND tc.tmp_cnt_fecha_pos_vencida < m.mov_fecha_pos_vencida
        ]]>
    </entry>
    <entry key="cnt-12.activoPositvo">
    <![CDATA[
      SELECT tmp_cnt.TMP_CNT_POS_VIVA_NO_VENCIDA AS ERROR_FIELD,
      (tmp_cnt.tmp_cnt_cod_entidad ||'-'|| tmp_cnt.tmp_cnt_cod_oficina ||'-'|| tmp_cnt.tmp_cnt_contrato) AS ENTITY_CODE  
      FROM tmp_cnt_contratos tmp_cnt,dd_tpe_tipo_prod_entidad tp
      WHERE TRIM(tp.dd_tpe_codigo) = TRIM(tmp_cnt.TMP_CNT_TIPO_PRODUCTO)
      AND tp.dd_tpe_activo=1
      AND tmp_cnt.TMP_CNT_POS_VIVA_VENCIDA < 0
    ]]>
    </entry>
	
	<entry key="cnt-13.finalidadOficial">
    <![CDATA[
			SELECT tmp_cnt.TMP_CNT_FINALIDAD_OFI AS ERROR_FIELD,
      (tmp_cnt.tmp_cnt_cod_entidad ||'-'|| tmp_cnt.tmp_cnt_cod_oficina ||'-'|| tmp_cnt.tmp_cnt_contrato) AS ENTITY_CODE  
      FROM tmp_cnt_contratos tmp_cnt
      WHERE tmp_cnt.TMP_CNT_FINALIDAD_OFI is not null and NOT EXISTS (
				SELECT * FROM DD_FNO_FINALIDAD_OFICIAL FNO
			WHERE tmp_cnt.TMP_CNT_FINALIDAD_OFI = FNO.DD_FNO_CODIGO)      
    ]]>
    </entry>


	<entry key="cnt-14.finalidadContrato">
    <![CDATA[
			SELECT tmp_cnt.TMP_CNT_FINALIDAD_CON AS ERROR_FIELD,
      (tmp_cnt.tmp_cnt_cod_entidad ||'-'|| tmp_cnt.tmp_cnt_cod_oficina ||'-'|| tmp_cnt.tmp_cnt_contrato) AS ENTITY_CODE  
      FROM tmp_cnt_contratos tmp_cnt
      WHERE tmp_cnt.TMP_CNT_FINALIDAD_CON is not null and  NOT EXISTS (
				SELECT * FROM DD_FCN_FINALIDAD_CONTRATO FCN
			WHERE tmp_cnt.TMP_CNT_FINALIDAD_CON = FCN.DD_FCN_CODIGO)      
    ]]>
    </entry>




	<entry key="cnt-15.garantia1">
    <![CDATA[
			SELECT tmp_cnt.TMP_CNT_GARANTIA_1 AS ERROR_FIELD,
      (tmp_cnt.tmp_cnt_cod_entidad ||'-'|| tmp_cnt.tmp_cnt_cod_oficina ||'-'|| tmp_cnt.tmp_cnt_contrato) AS ENTITY_CODE  
      FROM tmp_cnt_contratos tmp_cnt
      WHERE tmp_cnt.TMP_CNT_GARANTIA_1 is not null and NOT EXISTS (
				SELECT * FROM DD_GCN_GARANTIA_CONTRATO GCN
			WHERE tmp_cnt.TMP_CNT_GARANTIA_1 = GCN.DD_GCN_CODIGO)
			]]>
    </entry>

	<entry key="cnt-16.garantia2">
    <![CDATA[
			SELECT tmp_cnt.TMP_CNT_GARANTIA_2 AS ERROR_FIELD,
      (tmp_cnt.tmp_cnt_cod_entidad ||'-'|| tmp_cnt.tmp_cnt_cod_oficina ||'-'|| tmp_cnt.tmp_cnt_contrato) AS ENTITY_CODE  
      FROM tmp_cnt_contratos tmp_cnt
      WHERE tmp_cnt.TMP_CNT_GARANTIA_2 is not null and NOT EXISTS (
				SELECT * FROM DD_GCO_GARANTIA_CONTABLE GCO
			WHERE tmp_cnt.TMP_CNT_GARANTIA_2 = GCO.DD_GCO_CODIGO)
			]]>
    </entry>


	<entry key="cnt-17.catalogo1">
    <![CDATA[
		SELECT tmp_cnt.TMP_CNT_CATALOGO_1 AS ERROR_FIELD,
      (tmp_cnt.tmp_cnt_cod_entidad ||'-'|| tmp_cnt.tmp_cnt_cod_oficina ||'-'|| tmp_cnt.tmp_cnt_contrato) AS ENTITY_CODE  
      FROM tmp_cnt_contratos tmp_cnt
      WHERE tmp_cnt.TMP_CNT_CATALOGO_1 is not null and NOT EXISTS (
				SELECT * FROM DD_CT1_CATALOGO_1 CT1
			WHERE tmp_cnt.TMP_CNT_CATALOGO_1 = CT1.DD_CT1_CODIGO)
			]]>
    </entry>


	<entry key="cnt-18.catalogo2">
    <![CDATA[
      SELECT tmp_cnt.TMP_CNT_CATALOGO_2 AS ERROR_FIELD,
      (tmp_cnt.tmp_cnt_cod_entidad ||'-'|| tmp_cnt.tmp_cnt_cod_oficina ||'-'|| tmp_cnt.tmp_cnt_contrato) AS ENTITY_CODE  
      FROM tmp_cnt_contratos tmp_cnt
      WHERE tmp_cnt.TMP_CNT_CATALOGO_2 is not null and NOT EXISTS (
				SELECT * FROM DD_CT2_CATALOGO_2 CT2
			WHERE tmp_cnt.TMP_CNT_CATALOGO_2 = CT2.DD_CT2_CODIGO)
    ]]>
    </entry>


	<entry key="cnt-19.catalogo3">
    <![CDATA[
      SELECT tmp_cnt.TMP_CNT_CATALOGO_3 AS ERROR_FIELD,
      (tmp_cnt.tmp_cnt_cod_entidad ||'-'|| tmp_cnt.tmp_cnt_cod_oficina ||'-'|| tmp_cnt.tmp_cnt_contrato) AS ENTITY_CODE  
      FROM tmp_cnt_contratos tmp_cnt
      WHERE tmp_cnt.TMP_CNT_CATALOGO_3 is not null and NOT EXISTS (
				SELECT * FROM DD_CT3_CATALOGO_3 CT3
			WHERE tmp_cnt.TMP_CNT_CATALOGO_3 = CT3.DD_CT3_CODIGO)
    ]]>
    </entry>



	<entry key="cnt-20.catalogo4">
    <![CDATA[
      SELECT tmp_cnt.TMP_CNT_CATALOGO_4 AS ERROR_FIELD,
      (tmp_cnt.tmp_cnt_cod_entidad ||'-'|| tmp_cnt.tmp_cnt_cod_oficina ||'-'|| tmp_cnt.tmp_cnt_contrato) AS ENTITY_CODE  
      FROM tmp_cnt_contratos tmp_cnt
      WHERE tmp_cnt.TMP_CNT_CATALOGO_4 is not null and NOT EXISTS (
				SELECT * FROM DD_CT4_CATALOGO_4 CT4
			WHERE tmp_cnt.TMP_CNT_CATALOGO_4 = CT4.DD_CT4_CODIGO)
    ]]>
    </entry>

			

	<entry key="cnt-21.extra3">
    <![CDATA[
      SELECT tmp_cnt.TMP_CNT_EXTRA_3_CODIGO AS ERROR_FIELD,
      (tmp_cnt.tmp_cnt_cod_entidad ||'-'|| tmp_cnt.tmp_cnt_cod_oficina ||'-'|| tmp_cnt.tmp_cnt_contrato) AS ENTITY_CODE  
      FROM tmp_cnt_contratos tmp_cnt
      WHERE tmp_cnt.TMP_CNT_EXTRA_3_CODIGO is not null and NOT EXISTS (
				SELECT * FROM DD_MX3_MOVIMIENTO_EXTRA_3 MX3
			WHERE tmp_cnt.TMP_CNT_EXTRA_3_CODIGO = MX3.DD_MX3_CODIGO)
    ]]>
    </entry>

			

	<entry key="cnt-22.extra4">
    <![CDATA[
          SELECT tmp_cnt.TMP_CNT_EXTRA_4_CODIGO AS ERROR_FIELD,
      (tmp_cnt.tmp_cnt_cod_entidad ||'-'|| tmp_cnt.tmp_cnt_cod_oficina ||'-'|| tmp_cnt.tmp_cnt_contrato) AS ENTITY_CODE  
      FROM tmp_cnt_contratos tmp_cnt
      WHERE tmp_cnt.TMP_CNT_EXTRA_4_CODIGO is not null and NOT EXISTS (
				SELECT * FROM DD_MX4_MOVIMIENTO_EXTRA_4 MX4
			WHERE tmp_cnt.TMP_CNT_EXTRA_4_CODIGO = MX4.DD_MX4_CODIGO)
    ]]>
    </entry>
	
	<entry key="cnt-23.relacionesCatalogos">
    <![CDATA[
          select
			tmp_cnt.TMP_CNT_ID as ERROR_FIELD,
			(tmp_cnt.tmp_cnt_cod_entidad ||'-'|| tmp_cnt.tmp_cnt_cod_oficina ||'-'|| tmp_cnt.tmp_cnt_contrato) AS ENTITY_CODE
			 from tmp_cnt_contratos tmp_cnt 
			where tmp_cnt.TMP_CNT_ID not in
			(
			select 
			    tmp_cnt.TMP_CNT_ID
			    from tmp_cnt_contratos tmp_cnt,DD_CT1_CATALOGO_1 c1 
			    JOIN DD_CT2_CATALOGO_2 c2 ON c2.dd_ct1_id = c1.dd_ct1_id 
			    JOIN DD_CT3_CATALOGO_3 c3 ON c3.dd_ct2_id = c2.dd_ct2_id 
			    JOIN DD_CT4_CATALOGO_4 c4 ON c4.dd_ct3_id = c3.dd_ct3_id 
			    LEFT JOIN DD_CT5_CATALOGO_5 c5 ON c5.dd_ct4_id = c4.dd_ct4_id 
			    LEFT JOIN DD_CT6_CATALOGO_6 c6 ON c6.dd_ct5_id = c5.dd_ct5_id 
			    where c1.dd_ct1_codigo = tmp_cnt.TMP_CNT_CATALOGO_1
			        and c2.dd_ct2_codigo = tmp_cnt.TMP_CNT_CATALOGO_2
			        and c3.dd_ct3_codigo = tmp_cnt.TMP_CNT_CATALOGO_3
			        and c4.dd_ct4_codigo = tmp_cnt.TMP_CNT_CATALOGO_4
			        and c5.dd_ct5_codigo = tmp_cnt.TMP_CNT_CATALOGO_5
			        and c6.dd_ct6_codigo = tmp_cnt.TMP_CNT_CATALOGO_6
			        )
    ]]>
    </entry>
	
	
	           
</properties>