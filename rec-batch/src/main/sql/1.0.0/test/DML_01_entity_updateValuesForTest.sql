UPDATE CNT_CONTRATOS SET DD_PRO_ID = (SELECT MIN(DD_PRO_ID) FROM DD_PRO_PROPIETARIOS) WHERE BORRADO = 0 AND DD_PRO_ID IS NULL;

UPDATE CNT_CONTRATOS SET OFI_ID_ADMIN = OFI_ID WHERE OFI_ID_ADMIN IS NULL;

COMMIT;

UPDATE OFI_OFICINAS SET OFI_CODIGO_ENTIDAD_OFICINA = OFI_CODIGO  WHERE OFI_CODIGO_ENTIDAD_OFICINA IS NULL;

COMMIT;

INSERT INTO EXT_IAC_INFO_ADD_CONTRATO
SELECT S_EXT_IAC_INFO_ADD_CONTRATO.NEXTVAL, IFC.DD_IFC_ID, CNT_ID, '1234', 0, 'TEST', SYSDATE, NULL, NULL, NULL, NULL, 0
FROM CNT_CONTRATOS CNT
  JOIN EXT_DD_IFC_INFO_CONTRATO IFC ON IFC.DD_IFC_CODIGO = 'NUMERO_ESPEC'
WHERE NOT EXISTS (SELECT * FROM EXT_IAC_INFO_ADD_CONTRATO WHERE DD_IFC_ID = IFC.DD_IFC_ID AND CNT_ID = CNT.CNT_ID);

commit;

UPDATE PER_PERSONAS SET DD_PRO_ID = (SELECT MIN(DD_PRO_ID) FROM DD_PRO_PROPIETARIOS) WHERE DD_PRO_ID IS NULL;

commit;