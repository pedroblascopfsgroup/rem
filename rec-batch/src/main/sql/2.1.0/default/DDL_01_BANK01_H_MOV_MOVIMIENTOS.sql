BEGIN
  BEGIN
    EXECUTE IMMEDIATE 'DROP TABLE BANK01.H_MOV_MOVIMIENTOS';
  EXCEPTION WHEN OTHERS THEN
    SYS.DBMS_OUTPUT.PUT_LINE('La tabla no existía previamente.');
  END;

  EXECUTE IMMEDIATE 'CREATE TABLE BANK01.H_MOV_MOVIMIENTOS 
	(
	  CNT_ID NUMBER(16, 0) NOT NULL 
	, MOV_FECHA_EXTRACCION DATE NOT NULL 
	, MOV_ID NUMBER(16, 0) NOT NULL 
	, MOV_POS_VIVA_NO_VENCIDA NUMBER(14, 2) NOT NULL 
	, MOV_POS_VIVA_VENCIDA NUMBER(14, 2) NOT NULL 
	, MOV_FECHA_POS_VENCIDA DATE NOT NULL 
	, MOV_SALDO_DUDOSO NUMBER(14, 2) 
	, MOV_FECHA_DUDOSO DATE 
	, MOV_PROVISION NUMBER(14, 2) NOT NULL 
	, MOV_INT_REMUNERATORIOS NUMBER(14, 2) NOT NULL 
	, MOV_INT_MORATORIOS NUMBER(14, 2) NOT NULL 
	, MOV_COMISIONES NUMBER(14, 2) NOT NULL 
	, MOV_GASTOS NUMBER(14, 2) NOT NULL 
	, MOV_FICHERO_CARGA VARCHAR2(50 CHAR) NOT NULL 
	, MOV_FECHA_CARGA DATE NOT NULL 
	, DD_EFC_ID NUMBER(16, 0) NOT NULL 
	, CNT_FECHA_EFC DATE 
	, DD_EFC_ID_ANT NUMBER(16, 0) 
	, CNT_FECHA_EFC_ANT DATE 
	, DD_TPE_ID NUMBER(16, 0) NOT NULL 
	, DD_TPR_ID NUMBER(16, 0) NOT NULL 
	, CNT_COD_ENTIDAD NUMBER(4, 0) NOT NULL 
	, CNT_COD_CENTRO NUMBER(6, 0) NOT NULL 
	, DD_ESC_ID NUMBER(16, 0) 
	, CNT_FECHA_ESC DATE 
	, ZON_ID NUMBER(16, 0) NOT NULL 
	, VERSION NUMBER(*, 0) NOT NULL 
	, USUARIOCREAR VARCHAR2(10 CHAR) NOT NULL 
	, FECHACREAR TIMESTAMP(6) NOT NULL 
	, USUARIOMODIFICAR VARCHAR2(10 CHAR) 
	, FECHAMODIFICAR TIMESTAMP(6) 
	, USUARIOBORRAR VARCHAR2(10 CHAR) 
	, FECHABORRAR TIMESTAMP(6) 
	, BORRADO NUMBER(1, 0) NOT NULL 
	, FECHAHIST TIMESTAMP(6) NOT NULL 
	, USUARIOHIST VARCHAR2(10 CHAR) 
	, MOV_RIESGO NUMBER(14, 2) 
	, MOV_DEUDA_IRREGULAR NUMBER(14, 2) NOT NULL 
	, MOV_DISPUESTO NUMBER(14, 2) NOT NULL 
	, MOV_SALDO_PASIVO NUMBER(14, 2) NOT NULL 
	, MOV_RIESGO_GARANT NUMBER(14, 2) NOT NULL 
	, MOV_SALDO_EXCE NUMBER(14, 2) NOT NULL 
	, MOV_LIMITE_DESC NUMBER(14, 4) 
	, MOV_EXTRA_1 NUMBER(14, 2) 
	, MOV_EXTRA_2 NUMBER(14, 2) 
	, MOV_LTV_INI NUMBER(5, 0) NOT NULL 
	, MOV_LTV_FIN NUMBER(5, 0) NOT NULL 
	, DD_MX3_ID NUMBER(16, 0) 
	, DD_MX4_ID NUMBER(16, 0) 
	, MOV_EXTRA_5 DATE 
	, MOV_EXTRA_6 DATE 
	, CNT_LIMITE_INI NUMBER(14, 2) 
	, CNT_LIMITE_FIN NUMBER(14, 2) 
	, DD_FCN_ID NUMBER(16, 0) 
	, DD_FNO_ID NUMBER(16, 0) 
	, DD_GC1_ID NUMBER(16, 0) 
	, DD_GC2_ID NUMBER(16, 0) 
	, DD_CT1_ID NUMBER(16, 0) 
	, DD_CT2_ID NUMBER(16, 0) 
	, DD_CT3_ID NUMBER(16, 0) 
	, DD_CT4_ID NUMBER(16, 0) 
	, DD_CT5_ID NUMBER(16, 0) 
	, DD_CT6_ID NUMBER(16, 0) 
	, CNT_FECHA_CREACION DATE 
	, CNT_FECHA_CONSTITUCION DATE 
	, CNT_FECHA_VENC DATE 
	, MOV_DEUDA_EXIGIBLE NUMBER(14, 2) 
	, MOV_CAPITAL_FALLIDO NUMBER(16, 2) 
	, MOV_FECHA_DATO DATE NOT NULL 
	, MOV_IMPUESTOS NUMBER(14, 2) 
	, MOV_ENTREGAS_A_CUENTA NUMBER(14, 2) 
	, MOV_INTERESES_ENTREGAS NUMBER(14, 2) 
	, MOV_CUOTAS_VENCIDAS_IMPAGADAS NUMBER(14, 2) 
	, MOV_PENDIENTE_DESEMBOLSO NUMBER(14, 2) NOT NULL 
	, EXTRAFLOAT NUMBER(14, 2) 
	, MOV_PROVISION_PORCENTAJE NUMBER(5, 0) NOT NULL 
	, MOV_DOMICI_EXT_FECHA_RECIB_DEV DATE 
	, MOV_DOMICI_EXT_TOTAL_SALDO_DEV NUMBER(14, 2) 
	, MOV_CNT_FECHA_INI_EPI_IRREG DATE 
	, DD_MTR_ID NUMBER(16, 0) 
	, MOV_CONTRATO_ANTERIOR VARCHAR2(50 CHAR) 
	, MOV_SCORING VARCHAR2(10 CHAR) 
	, MOV_TRAMO_IRREGULARIDAD VARCHAR2(1 CHAR) 
	, CNT_COD_OFICINA NUMBER(11, 0) 
	, CNT_CONTRATO VARCHAR2(50 CHAR) 
	, CONSTRAINT PK_H_MOV_MOVIMIENTOS PRIMARY KEY (CNT_ID, MOV_FECHA_EXTRACCION) ENABLE 
	)
	PARTITION BY RANGE (MOV_FECHA_EXTRACCION) 
	(
	  PARTITION H_MOV_MOVIMIENTOS201401 VALUES LESS THAN (TO_DATE('' 2014-02-01 00:00:00'', ''SYYYY-MM-DD HH24:MI:SS'', ''NLS_CALENDAR=GREGORIAN'')) 
	, PARTITION H_MOV_MOVIMIENTOS201402 VALUES LESS THAN (TO_DATE('' 2014-03-01 00:00:00'', ''SYYYY-MM-DD HH24:MI:SS'', ''NLS_CALENDAR=GREGORIAN'')) 
	, PARTITION H_MOV_MOVIMIENTOS201403 VALUES LESS THAN (TO_DATE('' 2014-04-01 00:00:00'', ''SYYYY-MM-DD HH24:MI:SS'', ''NLS_CALENDAR=GREGORIAN'')) 
	, PARTITION H_MOV_MOVIMIENTOS201404 VALUES LESS THAN (TO_DATE('' 2014-05-01 00:00:00'', ''SYYYY-MM-DD HH24:MI:SS'', ''NLS_CALENDAR=GREGORIAN'')) 
	, PARTITION H_MOV_MOVIMIENTOS201405 VALUES LESS THAN (TO_DATE('' 2014-06-01 00:00:00'', ''SYYYY-MM-DD HH24:MI:SS'', ''NLS_CALENDAR=GREGORIAN'')) 
	, PARTITION H_MOV_MOVIMIENTOS201406 VALUES LESS THAN (TO_DATE('' 2014-07-01 00:00:00'', ''SYYYY-MM-DD HH24:MI:SS'', ''NLS_CALENDAR=GREGORIAN'')) 
	, PARTITION H_MOV_MOVIMIENTOS201407 VALUES LESS THAN (TO_DATE('' 2014-08-01 00:00:00'', ''SYYYY-MM-DD HH24:MI:SS'', ''NLS_CALENDAR=GREGORIAN'')) 
	, PARTITION H_MOV_MOVIMIENTOS201408 VALUES LESS THAN (TO_DATE('' 2014-09-01 00:00:00'', ''SYYYY-MM-DD HH24:MI:SS'', ''NLS_CALENDAR=GREGORIAN'')) 
	, PARTITION H_MOV_MOVIMIENTOS201409 VALUES LESS THAN (TO_DATE('' 2014-10-01 00:00:00'', ''SYYYY-MM-DD HH24:MI:SS'', ''NLS_CALENDAR=GREGORIAN'')) 
	, PARTITION H_MOV_MOVIMIENTOS201410 VALUES LESS THAN (TO_DATE('' 2014-11-01 00:00:00'', ''SYYYY-MM-DD HH24:MI:SS'', ''NLS_CALENDAR=GREGORIAN'')) 
	, PARTITION H_MOV_MOVIMIENTOS201411 VALUES LESS THAN (TO_DATE('' 2014-12-01 00:00:00'', ''SYYYY-MM-DD HH24:MI:SS'', ''NLS_CALENDAR=GREGORIAN'')) 
	, PARTITION H_MOV_MOVIMIENTOS201412 VALUES LESS THAN (TO_DATE('' 2015-01-01 00:00:00'', ''SYYYY-MM-DD HH24:MI:SS'', ''NLS_CALENDAR=GREGORIAN'')) 
	, PARTITION H_MOV_MOVIMIENTOS201501 VALUES LESS THAN (TO_DATE('' 2015-02-01 00:00:00'', ''SYYYY-MM-DD HH24:MI:SS'', ''NLS_CALENDAR=GREGORIAN'')) 
	, PARTITION H_MOV_MOVIMIENTOS201502 VALUES LESS THAN (TO_DATE('' 2015-03-01 00:00:00'', ''SYYYY-MM-DD HH24:MI:SS'', ''NLS_CALENDAR=GREGORIAN'')) 
	, PARTITION H_MOV_MOVIMIENTOS201503 VALUES LESS THAN (TO_DATE('' 2015-04-01 00:00:00'', ''SYYYY-MM-DD HH24:MI:SS'', ''NLS_CALENDAR=GREGORIAN'')) 
	, PARTITION H_MOV_MOVIMIENTOS201504 VALUES LESS THAN (TO_DATE('' 2015-05-01 00:00:00'', ''SYYYY-MM-DD HH24:MI:SS'', ''NLS_CALENDAR=GREGORIAN'')) 
	, PARTITION H_MOV_MOVIMIENTOS201505 VALUES LESS THAN (TO_DATE('' 2015-06-01 00:00:00'', ''SYYYY-MM-DD HH24:MI:SS'', ''NLS_CALENDAR=GREGORIAN'')) 
	, PARTITION H_MOV_MOVIMIENTOS201506 VALUES LESS THAN (TO_DATE('' 2015-07-01 00:00:00'', ''SYYYY-MM-DD HH24:MI:SS'', ''NLS_CALENDAR=GREGORIAN'')) 
	, PARTITION H_MOV_MOVIMIENTOS201507 VALUES LESS THAN (TO_DATE('' 2015-08-01 00:00:00'', ''SYYYY-MM-DD HH24:MI:SS'', ''NLS_CALENDAR=GREGORIAN'')) 
	, PARTITION H_MOV_MOVIMIENTOS201508 VALUES LESS THAN (TO_DATE('' 2015-09-01 00:00:00'', ''SYYYY-MM-DD HH24:MI:SS'', ''NLS_CALENDAR=GREGORIAN'')) 
	, PARTITION H_MOV_MOVIMIENTOS201509 VALUES LESS THAN (TO_DATE('' 2015-10-01 00:00:00'', ''SYYYY-MM-DD HH24:MI:SS'', ''NLS_CALENDAR=GREGORIAN'')) 
	, PARTITION H_MOV_MOVIMIENTOS201510 VALUES LESS THAN (TO_DATE('' 2015-11-01 00:00:00'', ''SYYYY-MM-DD HH24:MI:SS'', ''NLS_CALENDAR=GREGORIAN'')) 
	, PARTITION H_MOV_MOVIMIENTOS201511 VALUES LESS THAN (TO_DATE('' 2015-12-01 00:00:00'', ''SYYYY-MM-DD HH24:MI:SS'', ''NLS_CALENDAR=GREGORIAN'')) 
	, PARTITION H_MOV_MOVIMIENTOS201512 VALUES LESS THAN (TO_DATE('' 2016-01-01 00:00:00'', ''SYYYY-MM-DD HH24:MI:SS'', ''NLS_CALENDAR=GREGORIAN'')) 
	, PARTITION H_MOV_MOVIMIENTOS201601 VALUES LESS THAN (TO_DATE('' 2016-02-01 00:00:00'', ''SYYYY-MM-DD HH24:MI:SS'', ''NLS_CALENDAR=GREGORIAN'')) 
	, PARTITION H_MOV_MOVIMIENTOS201602 VALUES LESS THAN (TO_DATE('' 2016-03-01 00:00:00'', ''SYYYY-MM-DD HH24:MI:SS'', ''NLS_CALENDAR=GREGORIAN'')) 
	, PARTITION H_MOV_MOVIMIENTOS201603 VALUES LESS THAN (TO_DATE('' 2016-04-01 00:00:00'', ''SYYYY-MM-DD HH24:MI:SS'', ''NLS_CALENDAR=GREGORIAN'')) 
	, PARTITION H_MOV_MOVIMIENTOS201604 VALUES LESS THAN (TO_DATE('' 2016-05-01 00:00:00'', ''SYYYY-MM-DD HH24:MI:SS'', ''NLS_CALENDAR=GREGORIAN'')) 
	, PARTITION H_MOV_MOVIMIENTOS201605 VALUES LESS THAN (TO_DATE('' 2016-06-01 00:00:00'', ''SYYYY-MM-DD HH24:MI:SS'', ''NLS_CALENDAR=GREGORIAN'')) 
	, PARTITION H_MOV_MOVIMIENTOS201606 VALUES LESS THAN (TO_DATE('' 2016-07-01 00:00:00'', ''SYYYY-MM-DD HH24:MI:SS'', ''NLS_CALENDAR=GREGORIAN'')) 
	, PARTITION H_MOV_MOVIMIENTOS201607 VALUES LESS THAN (TO_DATE('' 2016-08-01 00:00:00'', ''SYYYY-MM-DD HH24:MI:SS'', ''NLS_CALENDAR=GREGORIAN'')) 
	, PARTITION H_MOV_MOVIMIENTOS201608 VALUES LESS THAN (TO_DATE('' 2016-09-01 00:00:00'', ''SYYYY-MM-DD HH24:MI:SS'', ''NLS_CALENDAR=GREGORIAN'')) 
	, PARTITION H_MOV_MOVIMIENTOS201609 VALUES LESS THAN (TO_DATE('' 2016-10-01 00:00:00'', ''SYYYY-MM-DD HH24:MI:SS'', ''NLS_CALENDAR=GREGORIAN'')) 
	, PARTITION H_MOV_MOVIMIENTOS201610 VALUES LESS THAN (TO_DATE('' 2016-11-01 00:00:00'', ''SYYYY-MM-DD HH24:MI:SS'', ''NLS_CALENDAR=GREGORIAN'')) 
	, PARTITION H_MOV_MOVIMIENTOS201611 VALUES LESS THAN (TO_DATE('' 2016-12-01 00:00:00'', ''SYYYY-MM-DD HH24:MI:SS'', ''NLS_CALENDAR=GREGORIAN'')) 
	, PARTITION H_MOV_MOVIMIENTOS201612 VALUES LESS THAN (TO_DATE('' 2050-12-31 00:00:00'', ''SYYYY-MM-DD HH24:MI:SS'', ''NLS_CALENDAR=GREGORIAN'')) 
	)';

  EXECUTE IMMEDIATE 'CREATE INDEX BANK01.IDX_H_MOV_FECHA_EXTRACCION ON BANK01.H_MOV_MOVIMIENTOS (MOV_FECHA_EXTRACCION ASC)';

  EXECUTE IMMEDIATE 'ALTER TABLE BANK01.H_MOV_MOVIMIENTOS ADD (DD_SCO_ID NUMBER(16,0))';
  EXECUTE IMMEDIATE 'ALTER TABLE BANK01.H_MOV_MOVIMIENTOS MODIFY (MOV_ENTREGAS_A_CUENTA NOT NULL ENABLE)';
  EXECUTE IMMEDIATE 'ALTER TABLE BANK01.H_MOV_MOVIMIENTOS MODIFY (MOV_FECHA_EXTRACCION NULL)';
  EXECUTE IMMEDIATE 'ALTER TABLE BANK01.H_MOV_MOVIMIENTOS MODIFY (MOV_FECHA_POS_VENCIDA NULL)';
  EXECUTE IMMEDIATE 'ALTER TABLE BANK01.H_MOV_MOVIMIENTOS MODIFY (MOV_INTERESES_ENTREGAS NOT NULL ENABLE)';
 
END;
/