/*
selects
*/
SELECT *
FROM BANkMASTER.JBPM_PROCESSINSTANCE 
WHERE PROCESSDEFINITION_ IN (
    SELECT ID_ FROM BANKMASTER.JBPM_PROCESSDEFINITION WHERE NAME_='recobro');
    
SELECT *
FROM BANKMASTER.JBPM_TOKEN 
WHERE PROCESSINSTANCE_ IN (
  SELECT ID_
    FROM BANkMASTER.JBPM_PROCESSINSTANCE 
    WHERE PROCESSDEFINITION_ IN (
      SELECT ID_ FROM BANKMASTER.JBPM_PROCESSDEFINITION WHERE NAME_='recobro'));
      
SELECT *
FROM BANKMASTER.JBPM_MODULEINSTANCE
WHERE PROCESSINSTANCE_ IN (
  SELECT ID_
    FROM BANkMASTER.JBPM_PROCESSINSTANCE 
    WHERE PROCESSDEFINITION_ IN (
      SELECT ID_ FROM BANKMASTER.JBPM_PROCESSDEFINITION WHERE NAME_='recobro'));
      
SELECT * 
FROM BANKMASTER.JBPM_TOKENVARIABLEMAP
WHERE CONTEXTINSTANCE_ IN (
  SELECT ID_
    FROM BANKMASTER.JBPM_MODULEINSTANCE
    WHERE PROCESSINSTANCE_ IN (
      SELECT ID_
        FROM BANkMASTER.JBPM_PROCESSINSTANCE 
        WHERE PROCESSDEFINITION_ IN (
          SELECT ID_ FROM BANKMASTER.JBPM_PROCESSDEFINITION WHERE NAME_='recobro')));


SELECT DISTINCT NAME_ FROM BANKMASTER.JBPM_VARIABLEINSTANCE
WHERE PROCESSINSTANCE_ IN (
  SELECT ID_
    FROM BANkMASTER.JBPM_PROCESSINSTANCE 
    WHERE PROCESSDEFINITION_ IN (
      SELECT ID_ FROM BANKMASTER.JBPM_PROCESSDEFINITION WHERE NAME_='recobro'));
      
SELECT *
FROM BANKMASTER.JBPM_JOB
WHERE PROCESSINSTANCE_ IN (
  SELECT ID_
    FROM BANkMASTER.JBPM_PROCESSINSTANCE 
    WHERE PROCESSDEFINITION_ IN (
      SELECT ID_ FROM BANKMASTER.JBPM_PROCESSDEFINITION WHERE NAME_='recobro'));
/*
deletes
*/
DELETE FROM BANKMASTER.JBPM_JOB
WHERE PROCESSINSTANCE_ IN (
  SELECT ID_
    FROM BANkMASTER.JBPM_PROCESSINSTANCE 
    WHERE PROCESSDEFINITION_ IN (
      SELECT ID_ FROM BANKMASTER.JBPM_PROCESSDEFINITION WHERE NAME_='recobro'));


DELETE FROM BANKMASTER.JBPM_VARIABLEINSTANCE 
WHERE PROCESSINSTANCE_ IN (
  SELECT ID_
    FROM BANkMASTER.JBPM_PROCESSINSTANCE 
    WHERE PROCESSDEFINITION_ IN (
      SELECT ID_ FROM BANKMASTER.JBPM_PROCESSDEFINITION WHERE NAME_='recobro'));

DELETE FROM BANKMASTER.JBPM_TOKENVARIABLEMAP
WHERE CONTEXTINSTANCE_ IN (
  SELECT ID_
    FROM BANKMASTER.JBPM_MODULEINSTANCE
    WHERE PROCESSINSTANCE_ IN (
      SELECT ID_
        FROM BANkMASTER.JBPM_PROCESSINSTANCE 
        WHERE PROCESSDEFINITION_ IN (
          SELECT ID_ FROM BANKMASTER.JBPM_PROCESSDEFINITION WHERE NAME_='recobro')));

DELETE FROM BANKMASTER.JBPM_MODULEINSTANCE
WHERE PROCESSINSTANCE_ IN (
  SELECT ID_
    FROM BANkMASTER.JBPM_PROCESSINSTANCE 
    WHERE PROCESSDEFINITION_ IN (
      SELECT ID_ FROM BANKMASTER.JBPM_PROCESSDEFINITION WHERE NAME_='recobro'));

UPDATE BANKMASTER.JBPM_PROCESSINSTANCE SET ROOTTOKEN_ = NULL
WHERE PROCESSDEFINITION_ IN (
    SELECT ID_ FROM BANKMASTER.JBPM_PROCESSDEFINITION WHERE NAME_='recobro');

DELETE FROM BANKMASTER.JBPM_TOKEN
WHERE PROCESSINSTANCE_ IN (
  SELECT ID_
    FROM BANkMASTER.JBPM_PROCESSINSTANCE 
    WHERE PROCESSDEFINITION_ IN (
      SELECT ID_ FROM BANKMASTER.JBPM_PROCESSDEFINITION WHERE NAME_='recobro'));

DELETE FROM BANKMASTER.JBPM_PROCESSINSTANCE
WHERE PROCESSDEFINITION_ IN (
    SELECT ID_ FROM BANKMASTER.JBPM_PROCESSDEFINITION WHERE NAME_='recobro');
    
UPDATE EXP_EXPEDIENTES SET EXP_PROCESS_BPM = NULL WHERE EXP_PROCESS_BPM IS NOT NULL
  AND EXP_ID IN (SELECT EXP_ID FROM EXP_EXPEDIENTES_REC);
  
UPDATE CRE_CICLO_RECOBRO_EXP SET CRE_PROCESS_BPM = NULL;  
  
COMMIT;  