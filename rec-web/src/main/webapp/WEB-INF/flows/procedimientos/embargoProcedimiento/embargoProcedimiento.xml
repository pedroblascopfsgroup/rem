<?xml version="1.0" encoding="UTF-8"?>
<flow xmlns="http://www.springframework.org/schema/webflow" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://www.springframework.org/schema/webflow http://www.springframework.org/schema/webflow/spring-webflow-2.0.xsd">
	
	<var name="dtoEmbargoProcedimiento" class="es.capgemini.pfs.embargoProcedimiento.dto.DtoEmbargoProcedimiento" />
	<var name="embargoProcedimiento" class="es.capgemini.pfs.embargoProcedimiento.model.EmbargoProcedimiento" />
	
	<input name="id" type="java.lang.Long"/>
	<input name="idProcedimiento" type="java.lang.Long"/>
	<input name="idEmbargo" type="java.lang.Long"/>
	
	
	<decision-state id="newOrEdit">
		<if test="idEmbargo!=null" then="buscar" else="crear"/>
	</decision-state>
	
	<action-state id="buscar">
	<evaluate expression="executor.execute('embargoProcedimientoManager.get', idEmbargo)" result="flowScope.embargoProcedimiento"/>
	<transition to="formulario" />
	</action-state>
	
	<action-state id="crear">
		<evaluate expression="executor.execute('embargoProcedimientoManager.getInstance',id)" result="flowScope.embargoProcedimiento" />
		<transition to="formulario" />
	</action-state>
	
	<view-state id="formulario" view="${view}" model="dtoEmbargoProcedimiento">
		<binder>
			<binding property="embargoProcedimiento.fechaAdjudicacion"/>
			<binding property="embargoProcedimiento.id"/>
			<binding property="embargoProcedimiento.fechaDecreto"/>
			<binding property="embargoProcedimiento.fechaRegistro"/>
			<binding property="embargoProcedimiento.fechaSolicitud"/>
			<binding property="embargoProcedimiento.fechaAval"/>
			<binding property="embargoProcedimiento.fechaTasacion"/>
			<binding property="embargoProcedimiento.importeValor"/>
			<binding property="embargoProcedimiento.importeAval"/>
			<binding property="embargoProcedimiento.importeTasacion"/>
			<binding property="embargoProcedimiento.importeAdjudicacion"/>
			<binding property="embargoProcedimiento.letra"/>
		</binder>
	<on-entry>
		<set name="dtoEmbargoProcedimiento.embargoProcedimiento" value="embargoProcedimiento" />
		
		<set name="flowScope.view" value="'procedimientos/embargoProcedimiento/embargoProcedimiento'" />
	</on-entry>
	<on-render>
	<set name="flowScope.view" value="'default'"/>
	</on-render>
	<transition on="update" to="update"/>
	<transition on="cancel" to="close" bind="false"/>
	

	</view-state>
	
	<action-state id="update">
    	<evaluate expression="executor.execute('embargoProcedimientoManager.createOrUpdate',dtoEmbargoProcedimiento,id,idProcedimiento)" />
		<transition to="close"></transition>
	</action-state>
	
	<end-state id="close" view="default" />
</flow>
