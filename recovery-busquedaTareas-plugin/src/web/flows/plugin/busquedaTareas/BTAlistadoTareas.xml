<?xml version="1.0" encoding="UTF-8"?>
<flow xmlns="http://www.springframework.org/schema/webflow" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://www.springframework.org/schema/webflow http://www.springframework.org/schema/webflow/spring-webflow-2.0.xsd">

	<input name="alerta" type="java.lang.Boolean"/>
	<input name="espera" type="java.lang.Boolean"/>
	<input name="dto" type="es.capgemini.pfs.tareaNotificacion.dto.DtoBuscarTareaNotificacion"/>
	<input name="titulo" type="java.lang.String"/>
	<input name="icon" type="java.lang.String"/>
	<input name="codigoGestorSupervisor" type="java.lang.String"/>
	<input name="codigoTipoTarea" type="java.lang.String"/>
	<input name="codigoTipoSubTarea" type="java.lang.String"/>
	<input name="fechaVencDesde" type="java.lang.String"/>
	<input name="fechaVencDesdeOp" type="java.lang.String"/>
	<input name="fechaVencHasta" type="java.lang.String"/>
	<input name="fechaVencHastaOp" type="java.lang.String"/>
	<input name="fechaInicioDesde" type="java.lang.String"/>
	<input name="fechaInicioDesdeOp" type="java.lang.String"/>
	<input name="fechaInicioHasta" type="java.lang.String"/>
	<input name="fechaInicioHastaOp" type="java.lang.String"/>
	<input name="isBusqueda" type="java.lang.Boolean"/>
	<input name="noGrouping" type="java.lang.Boolean"/>
	<input name="traerGestionVencidos" type="java.lang.Boolean"/>
	<input name="tituloAdicionalGrid" type="java.lang.String"/>
	
	<input name="comotipoTarea" type="java.lang.String"/>
	
	
	<action-state id="esMultiGestor">
		<evaluate expression="executor.execute('es.pfsgroup.recovery.ext.api.asunto.modeloMultiGestor')" result="flowScope.multiGestor" />
		<transition to="decisionMultigestor"/>
	</action-state>
    
	<decision-state id="decisionMultigestor">
		<if test="multiGestor" then="listadoMultiGestor" else="listadoMonogestor"/>
	</decision-state>
	
	
  	<end-state id="listadoMonogestor" view="plugin/busquedaTareas/BTAlistadoTareas">
		<on-entry>
			<evaluate expression="requestParameters.alerta" result="flowScope.alerta" />
			<evaluate expression="requestParameters.espera" result="flowScope.espera" />
			<evaluate expression="requestParameters.titulo" result="flowScope.titulo" />
			<evaluate expression="requestParameters.icon" result="flowScope.icon" />
			<evaluate expression="executor.execute('plugin.busquedaTareas.BTABusquedaTareaManager.getTiposUnnidadGestion')" result="flowScope.ugs"/>
			<evaluate expression="executor.execute('zonaManager.getNiveles')" result="flowScope.niveles" />
			<evaluate expression="executor.execute('ADMPerfilManager.buscaPerfilesNoBorrados')" result="flowScope.perfiles" />
			<evaluate expression="executor.execute('despachoExternoManager.getDespachosExternos')" result="flowScope.despachos" />
	    	<evaluate expression="executor.execute('plugin.busquedaTareas.web.buttons.left')" result="flowScope.buttonsLeft"/>
			<evaluate expression="executor.execute('plugin.busquedaTareas.web.buttons.right')" result="flowScope.buttonsRight"/>
			<evaluate expression="executor.execute('plugin.busquedaTareas.web.getTabs')" result="flowScope.tabs"/>
	    </on-entry>
  	</end-state>
  	
  	<end-state id="listadoMultiGestor" view="plugin/busquedaTareas/BTAlistadoTareasMultigestor">
		<on-entry>
			<evaluate expression="requestParameters.alerta" result="flowScope.alerta" />
			<evaluate expression="requestParameters.espera" result="flowScope.espera" />
			<evaluate expression="requestParameters.titulo" result="flowScope.titulo" />
			<evaluate expression="requestParameters.icon" result="flowScope.icon" />
			<evaluate expression="executor.execute('plugin.busquedaTareas.BTABusquedaTareaManager.getTiposUnnidadGestion')" result="flowScope.ugs"/>
			<evaluate expression="executor.execute('zonaManager.getNiveles')" result="flowScope.niveles" />
			<evaluate expression="executor.execute('ADMPerfilManager.buscaPerfilesNoBorrados')" result="flowScope.perfiles" />
			<evaluate expression="executor.execute('despachoExternoManager.getDespachosExternos')" result="flowScope.despachos" />
	    	<evaluate expression="executor.execute('plugin.busquedaTareas.web.buttons.left')" result="flowScope.buttonsLeft"/>
			<evaluate expression="executor.execute('plugin.busquedaTareas.web.buttons.right')" result="flowScope.buttonsRight"/>
			<evaluate expression="executor.execute('dictionaryManager.getList', 'EXTDDTipoGestor')" result="flowScope.tiposGestor"/>
			<evaluate expression="executor.execute('plugin.busquedaTareas.web.getTabs')" result="flowScope.tabs"/>
	    </on-entry>
  	</end-state>
  
</flow>