<?xml version="1.0" encoding="UTF-8"?>
<flow xmlns="http://www.springframework.org/schema/webflow"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://www.springframework.org/schema/webflow http://www.springframework.org/schema/webflow/spring-webflow-2.0.xsd">

	<input name="id" type="java.lang.Long"/>
	<input name="numTab" type="java.lang.Integer"/>

	<end-state id="listado" view="plugin/config/despachoExterno/consultarDespachoExterno">
		<secured attributes="ROLE_ADMIN" match="any" />
		<on-entry>
			<evaluate expression="executor.execute('usuarioManager.getUsuarioLogado').entidad.descripcion" result="flowScope.usuarioEntidad" />
			<evaluate expression="executor.execute('ADMDespachoExternoManager.getDespachoExterno',id)" result="flowScope.despacho"/>
			<evaluate expression="executor.execute('ADMDespachoExternoManager.getAmbitoGeograficoDespacho',id)" result="flowScope.ambitoGreograficoDespacho"/>
			<evaluate expression="executor.execute('admTipoDespachoExternoManager.getList')" result="flowScope.tiposDespachos" />
			<evaluate expression="executor.execute('ADMDespachoExternoManager.getGestoresDespacho',id)" result="flowScope.gestores" />
			<evaluate expression="executor.execute('ADMDespachoExternoManager.getSupervisoresDespacho',id)" result="flowScope.supervisores" />
			<evaluate expression="executor.execute('ADMDespachoExternoManager.dameGestorDefecto', id)" result="flowScope.gestorDefecto" />
			<evaluate expression="executor.execute('ADMUsuarioManager.getUsuariosNoExternos')" result="flowScope.totalSupervisores" />
			<evaluate expression="executor.execute('ADMUsuarioManager.getUsuariosExternos')" result="flowScope.totalGestores" />
			<evaluate expression="executor.execute('ADMDespachoExternoManager.getTipoVia')" result="flowScope.ddTipoVia" />
			<evaluate expression="executor.execute('plugin.recovery.coreextension.api.getListTipoGestor', despacho.tipoDespacho.codigo)" result="flowScope.tiposGestorPropiedad" />

			<evaluate expression="executor.execute('plugin.mejoras.web.procuradores.pluginProcuradoresIsInstall')" result="flowScope.moduloProcuradoresActivado" />
			<evaluate expression="executor.execute('parametrizacionManager.buscarParametroPorNombre', 'codigoTipoDespachoLetradoValido').valor" result="flowScope.codigoTipoDespachoLetradoValido" />
		</on-entry>
	</end-state >
</flow>