CREATE SEQUENCE S_EXT_DD_TII_TIPO_INFO_ITI
  START WITH 1
  MAXVALUE 999999999999999999999999999;

CREATE TABLE EXT_DD_TII_TIPO_INFO_ITI
(
  DD_TII_ID                 NUMBER(16)          NOT NULL,
  DD_TII_CODIGO             VARCHAR2(20 CHAR)   NOT NULL,
  DD_TII_DESCRIPCION        VARCHAR2(50 CHAR),
  DD_TII_DESCRIPCION_LARGA  VARCHAR2(250 CHAR),
  VERSION                   INTEGER             DEFAULT 0                     NOT NULL,
  USUARIOCREAR              VARCHAR2(10 CHAR)   NOT NULL,
  FECHACREAR                TIMESTAMP(6)        NOT NULL,
  USUARIOMODIFICAR          VARCHAR2(10 CHAR),
  FECHAMODIFICAR            TIMESTAMP(6),
  USUARIOBORRAR             VARCHAR2(10 CHAR),
  FECHABORRAR               TIMESTAMP(6),
  BORRADO                   NUMBER(1)           DEFAULT 0                     NOT NULL,
  CONSTRAINT PK_EXT_DD_TII_TIPO_INFO_ITI PRIMARY KEY (DD_TII_ID),
  CONSTRAINT UK_EXT_DD_TII_TIPO_INFO_ITI UNIQUE (DD_TII_CODIGO)
);

-- TABLA DE DIFERENTES MARCAS PARA UN ITINERARIO
--
CREATE SEQUENCE S_EXT_IAI_INFO_ADD_ITI
  START WITH 1
  MAXVALUE 999999999999999999999999999;

CREATE TABLE EXT_IAI_INFO_ADD_ITI
(
  IAI_ID            NUMBER(16)                  NOT NULL,
  DD_TII_ID         NUMBER(16)                  NOT NULL,
  ITI_ID            NUMBER(16)                  NOT NULL,
  IAI_VALUE            VARCHAR2(50 CHAR),
  VERSION           INTEGER                     DEFAULT 0                     NOT NULL,
  USUARIOCREAR      VARCHAR2(10 CHAR)           NOT NULL,
  FECHACREAR        TIMESTAMP(6)                NOT NULL,
  USUARIOMODIFICAR  VARCHAR2(10 CHAR),
  FECHAMODIFICAR    TIMESTAMP(6),
  USUARIOBORRAR     VARCHAR2(10 CHAR),
  FECHABORRAR       TIMESTAMP(6),
  BORRADO           NUMBER(1)                   DEFAULT 0                     NOT NULL,
  CONSTRAINT PK_EXT_IAI_INFO_ADD_ITI PRIMARY KEY (IAI_ID),
  CONSTRAINT UK_EXT_IAI_INFO_ADD_ITI UNIQUE (DD_TII_ID,ITI_ID),
  CONSTRAINT FK_EXT_IAI_GAE_DD_TII  FOREIGN KEY (DD_TII_ID) REFERENCES EXT_DD_TII_TIPO_INFO_ITI (DD_TII_ID),
  CONSTRAINT FK_EXT_IAI_ITI_ID  FOREIGN KEY (ITI_ID) REFERENCES ITI_ITINERARIOS (ITI_ID)
);

-- inserts
INSERT INTO EXT_DD_TII_TIPO_INFO_ITI (DD_TII_ID,DD_TII_CODIGO,DD_TII_DESCRIPCION,VERSION,USUARIOCREAR,FECHACREAR,BORRADO) 
    VALUES(S_EXT_DD_TII_TIPO_INFO_ITI.nextval,'ACU','Marca para acumulación de contratos',0,'DIA',SYSDATE,0);
    
--INSERT INTO EXT_IAI_INFO_ADD_ITI (IAI_ID,DD_TII_ID,ITI_ID,IAI_VALUE,VERSION,USUARIOCREAR,FECHACREAR,BORRADO) 
--    VALUES(S_EXT_IAI_INFO_ADD_ITI.nextval,(select dd_tii_id from GAE_DD_TII_TIPO_INFO_ITI where dd_tii_codigo = 'ACU'),
--       iti_id,'IEX',0,'DIA',SYSDATE,0);


CREATE SEQUENCE S_EXT_DD_IFC_INFO_CONTRATO
  START WITH 1
  MAXVALUE 999999999999999999999999999;
  
  
CREATE TABLE EXT_DD_IFC_INFO_CONTRATO
(
  DD_IFC_ID                 NUMBER(16)          NOT NULL,
  DD_IFC_CODIGO             VARCHAR2(20 CHAR)   NOT NULL,
  DD_IFC_DESCRIPCION        VARCHAR2(50 CHAR),
  DD_IFC_DESCRIPCION_LARGA  VARCHAR2(250 CHAR),
  VERSION                   INTEGER             DEFAULT 0                     NOT NULL,
  USUARIOCREAR              VARCHAR2(10 CHAR)   NOT NULL,
  FECHACREAR                TIMESTAMP(6)        NOT NULL,
  USUARIOMODIFICAR          VARCHAR2(10 CHAR),
  FECHAMODIFICAR            TIMESTAMP(6),
  USUARIOBORRAR             VARCHAR2(10 CHAR),
  FECHABORRAR               TIMESTAMP(6),
  BORRADO                   NUMBER(1)           DEFAULT 0                     NOT NULL,
  CONSTRAINT PK_EXT_DD_IFC_INFO_CONTRATO PRIMARY KEY (DD_IFC_ID)
);

CREATE SEQUENCE S_EXT_IAC_INFO_ADD_CONTRATO
  START WITH 1
  MAXVALUE 999999999999999999999999999;
  
CREATE TABLE EXT_IAC_INFO_ADD_CONTRATO
(
  IAC_ID    				NUMBER(16)          NOT NULL,
  DD_IFC_ID                 NUMBER(16)          NOT NULL,
  CNT_ID             		NUMBER(16)          NOT NULL,
  IAC_VALUE		        VARCHAR2(50 CHAR),
  VERSION                   INTEGER             DEFAULT 0                     NOT NULL,
  USUARIOCREAR              VARCHAR2(10 CHAR)   NOT NULL,
  FECHACREAR                TIMESTAMP(6)        NOT NULL,
  USUARIOMODIFICAR          VARCHAR2(10 CHAR),
  FECHAMODIFICAR            TIMESTAMP(6),
  USUARIOBORRAR             VARCHAR2(10 CHAR),
  FECHABORRAR               TIMESTAMP(6),
  BORRADO                   NUMBER(1)           DEFAULT 0                     NOT NULL,
  CONSTRAINT PK_EXT_IAC_INFO_ADD_CONTRATO PRIMARY KEY (IAC_ID),
  CONSTRAINT FK_EXT_IAC_DD_IFC_ID  FOREIGN KEY (DD_IFC_ID) REFERENCES EXT_DD_IFC_INFO_CONTRATO (DD_IFC_ID),
  CONSTRAINT FK_EXT_IAC_CNT_ID  FOREIGN KEY (CNT_ID) REFERENCES CNT_CONTRATOS (CNT_ID)
);

CREATE UNIQUE INDEX EXT_IAC_INFO_ADD_CONTRATO_IND1 ON EXT_IAC_INFO_ADD_CONTRATO
(CNT_ID,DD_IFC_ID,IAC_VALUE);