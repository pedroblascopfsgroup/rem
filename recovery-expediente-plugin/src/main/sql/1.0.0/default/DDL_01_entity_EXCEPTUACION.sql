

CREATE TABLE DD_MOE_MOTIVO_EXCEPTUACION
(
  DD_MOE_ID                 NUMBER(16)          NOT NULL,
  DD_MOE_CODIGO             VARCHAR2(50 CHAR)   NOT NULL,
  DD_MOE_DESCRIPCION        VARCHAR2(50 CHAR),
  DD_MOE_DESCRIPCION_LARGA  VARCHAR2(250 CHAR),
  VERSION                   INTEGER             DEFAULT 0                     NOT NULL,
  USUARIOCREAR              VARCHAR2(10 CHAR)   NOT NULL,
  FECHACREAR                TIMESTAMP(6)        NOT NULL,
  USUARIOMODIFICAR          VARCHAR2(10 CHAR),
  FECHAMODIFICAR            TIMESTAMP(6),
  USUARIOBORRAR             VARCHAR2(10 CHAR),
  FECHABORRAR               TIMESTAMP(6),
  BORRADO                   NUMBER(1)           DEFAULT 0                     NOT NULL
);



CREATE UNIQUE INDEX DD_MOE_MOTIVO_EXCEPTUACION_PK ON DD_MOE_MOTIVO_EXCEPTUACION
(DD_MOE_ID);


ALTER TABLE DD_MOE_MOTIVO_EXCEPTUACION ADD (
  CONSTRAINT DD_MOE_MOTIVO_EXCEPTUACION_PK
 PRIMARY KEY
 (DD_MOE_ID));
 
 

CREATE TABLE EXC_EXCEPTUACION
(
  EXC_ID           NUMBER(16),
  EXC_FECHA_HASTA  DATE,
  DD_MOE_ID        NUMBER(16),
  EXC_COMENTARIO   VARCHAR2(2000),
  VERSION                   INTEGER             DEFAULT 0                     NOT NULL,
  USUARIOCREAR              VARCHAR2(10 CHAR)   NOT NULL,
  FECHACREAR                TIMESTAMP(6)        NOT NULL,
  USUARIOMODIFICAR          VARCHAR2(10 CHAR),
  FECHAMODIFICAR            TIMESTAMP(6),
  USUARIOBORRAR             VARCHAR2(10 CHAR),
  FECHABORRAR               TIMESTAMP(6),
  BORRADO                   NUMBER(1)           DEFAULT 0                     NOT NULL
);


CREATE UNIQUE INDEX EXC_EXCEPTUACION_PK ON EXC_EXCEPTUACION
(EXC_ID);


ALTER TABLE EXC_EXCEPTUACION ADD (
  CONSTRAINT EXC_EXCEPTUACION_PK
 PRIMARY KEY
 (EXC_ID));

ALTER TABLE EXC_EXCEPTUACION ADD (
  CONSTRAINT EXC_MOE_FK 
 FOREIGN KEY (DD_MOE_ID) 
 REFERENCES DD_MOE_MOTIVO_EXCEPTUACION (DD_MOE_ID));



CREATE TABLE ECO_EXCEPTUACION_CONTRATO
(
  EXC_ID  NUMBER(16),
  CNT_ID  NUMBER(16)                            NOT NULL
);


CREATE UNIQUE INDEX ECO_EXCEPTUACION_CONTRATO_PK ON ECO_EXCEPTUACION_CONTRATO
(EXC_ID);


ALTER TABLE ECO_EXCEPTUACION_CONTRATO ADD (
  CONSTRAINT ECO_EXCEPTUACION_CONTRATO_PK
 PRIMARY KEY
 (EXC_ID));


ALTER TABLE ECO_EXCEPTUACION_CONTRATO ADD (
  CONSTRAINT ECO_CNT_FK
 FOREIGN KEY (CNT_ID) 
 REFERENCES CNT_CONTRATOS (CNT_ID),
  CONSTRAINT ECO_EXC_FK
 FOREIGN KEY (EXC_ID) 
 REFERENCES EXC_EXCEPTUACION (EXC_ID));

 

CREATE TABLE EPE_EXCEPTUACION_PERSONA
(
  EXC_ID  NUMBER(16),
  PER_ID  NUMBER(16)                            NOT NULL
);


CREATE UNIQUE INDEX EPE_EXCEPTUACION_PERSONA_PK ON EPE_EXCEPTUACION_PERSONA
(EXC_ID);


ALTER TABLE EPE_EXCEPTUACION_PERSONA ADD (
  CONSTRAINT EPE_EXCEPTUACION_PERSONA_PK
 PRIMARY KEY
 (EXC_ID));


ALTER TABLE EPE_EXCEPTUACION_PERSONA ADD (
  CONSTRAINT EPE_PER_FK
 FOREIGN KEY (PER_ID) 
 REFERENCES PER_PERSONAS (PER_ID),
  CONSTRAINT EPE_EXC_FK
 FOREIGN KEY (EXC_ID) 
 REFERENCES EXC_EXCEPTUACION (EXC_ID));
