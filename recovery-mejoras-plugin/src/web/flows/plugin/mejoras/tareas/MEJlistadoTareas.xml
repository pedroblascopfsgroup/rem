<?xml version="1.0" encoding="UTF-8"?>
<flow xmlns="http://www.springframework.org/schema/webflow" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.springframework.org/schema/webflow http://www.springframework.org/schema/webflow/spring-webflow-2.0.xsd">
    
	<input name="tipo_tarea" type="java.lang.Long"/>
	<input name="alerta" type="java.lang.Boolean"/>
	<input name="espera" type="java.lang.Boolean"/>
	<input name="dto" type="es.capgemini.pfs.tareaNotificacion.dto.DtoBuscarTareaNotificacion"/>
	<input name="titulo" type="java.lang.String"/>
	<input name="icon" type="java.lang.String"/>
	<input name="fechaVencDesde" type="java.lang.String"/>
	<input name="fechaVencDesdeOp" type="java.lang.String"/>
	<input name="fechaVencHasta" type="java.lang.String"/>
	<input name="fechaVencHastaOp" type="java.lang.String"/>
	<input name="fechaInicioDesde" type="java.lang.String"/>
	<input name="fechaInicioDesdeOp" type="java.lang.String"/>
	<input name="fechaInicioHasta" type="java.lang.String"/>
	<input name="fechaInicioHastaOp" type="java.lang.String"/>
	<input name="isBusqueda" type="java.lang.Boolean"/>
	<input name="noGrouping" type="java.lang.Boolean"/>
	<input name="traerGestionVencidos" type="java.lang.Boolean"/>
	<input name="tituloAdicionalGrid" type="java.lang.String"/>
	
	<action-state id="tienePluginProcurador">
		<evaluate expression="executor.execute('plugin.mejoras.web.procuradores.pluginProcuradoresIsInstall')" result="flowScope.tieneProcurador" />
		<transition to="decisionTieneProcurador"/>
	</action-state>
	
	<decision-state id="decisionTieneProcurador">
		<if test="tieneProcurador" then="moduloProcurador" else="listado"/>
	</decision-state>
	
	<action-state id="moduloProcurador">
		<evaluate expression="executor.execute('es.pfsgroup.plugin.recovery.procuradores.configuracion.api.activoDespachoIntegral')" result="flowScope.activoDespachoIntegral" />
		<transition to="listadoprocuradores"/>
	</action-state>
	
	<action-state id="listadoprocuradores">
		<evaluate expression="executor.execute('es.pfsgroup.plugin.recovery.procuradores.configuracion.api.activoCategorizacion')" result="flowScope.idCategorizacion" />
		<transition to="listado"/>
	</action-state>
	
	<!-- renderiza el formulario -->
    <end-state id="listado" view="plugin/mejoras/tareas/listadoTareas" >	
		<on-entry>
    		<evaluate expression="requestParameters.codigoTipoTarea" result="flowScope.codigoTipoTarea" />
			<evaluate expression="requestParameters.alerta" result="flowScope.alerta" />
			<evaluate expression="requestParameters.espera" result="flowScope.espera" />
			<evaluate expression="requestParameters.titulo" result="flowScope.titulo" />
			<evaluate expression="requestParameters.icon" result="flowScope.icon" />
			<evaluate expression="executor.execute('plugin.mejoras.web.tareas.buttons.tareasPendientes.left')" result="flowScope.buttonsLeftTarPte"/>
			<evaluate expression="executor.execute('plugin.mejoras.web.tareas.buttons.tareasPendientes.right')" result="flowScope.buttonsRightTarPte"/>
			<evaluate expression="executor.execute('plugin.mejoras.web.tareas.buttons.panelTareas.left')" result="flowScope.buttonsLeftTarPanel"/>
			<evaluate expression="executor.execute('plugin.mejoras.web.tareas.buttons.panelTareas.right')" result="flowScope.buttonsRightTarPanel"/>
			<evaluate expression="executor.execute('plugin.mejoras.web.tareas.buttons.tareasEspera.right')" result="flowScope.buttonsRightTarEspera"/>
			<evaluate expression="executor.execute('plugin.mejoras.web.tareas.buttons.tareasEspera.left')" result="flowScope.buttonsLeftTarEspera"/>
			<evaluate expression="executor.execute('plugin.mejoras.web.tareas.buttons.notificacion.right')" result="flowScope.buttonsRightNotificacion"/>
			<evaluate expression="executor.execute('plugin.mejoras.web.tareas.buttons.notificacion.left')" result="flowScope.buttonsLeftNotificacion"/>
			<evaluate expression="executor.execute('plugin.mejoras.web.tareas.buttons.alertas.right')" result="flowScope.buttonsRightAlertas"/>
			<evaluate expression="executor.execute('plugin.mejoras.web.tareas.buttons.alertas.left')" result="flowScope.buttonsLeftAlertas"/>			
			<evaluate expression="executor.execute('es.pfsgroup.recovery.ext.api.tareas.opciones.tieneOpcionBuzonOptimizado')" result="flowScope.buzonOptimizado" />
	    </on-entry>
		
    </end-state>   

    
</flow>