CREATE TABLE DD_EBC_ESTADO_BIEN_CNT
(
  DD_EBC_ID                 NUMBER(16)          			NOT NULL,
  DD_EBC_CODIGO             VARCHAR2(20 CHAR)   			NOT NULL,
  DD_EBC_DESCRIPCION        VARCHAR2(50 CHAR),
  DD_EBC_DESCRIPCION_LARGA  VARCHAR2(250 CHAR),
  VERSION                   INTEGER             DEFAULT 0   NOT NULL,
  USUARIOCREAR              VARCHAR2(10 CHAR)   			NOT NULL,
  FECHACREAR                TIMESTAMP(6)        			NOT NULL,
  USUARIOMODIFICAR          VARCHAR2(10 CHAR),
  FECHAMODIFICAR            TIMESTAMP(6),
  USUARIOBORRAR             VARCHAR2(10 CHAR),
  FECHABORRAR               TIMESTAMP(6),
  BORRADO                   NUMBER(1)           DEFAULT 0	NOT NULL,
  CONSTRAINT PK_DD_EBC_ESTADO_BIEN_CNT PRIMARY KEY (DD_EBC_ID)
);

CREATE SEQUENCE S_DD_EBC_ESTADO_BIEN_CNT;

INSERT INTO DD_EBC_ESTADO_BIEN_CNT(DD_EBC_ID,DD_EBC_CODIGO,DD_EBC_DESCRIPCION,DD_EBC_DESCRIPCION_LARGA,USUARIOCREAR,FECHACREAR) VALUES (S_DD_EBC_ESTADO_BIEN_CNT.NEXTVAL,1,'SOL','SOL','PFS',SYSDATE);
INSERT INTO DD_EBC_ESTADO_BIEN_CNT(DD_EBC_ID,DD_EBC_CODIGO,DD_EBC_DESCRIPCION,DD_EBC_DESCRIPCION_LARGA,USUARIOCREAR,FECHACREAR) VALUES (S_DD_EBC_ESTADO_BIEN_CNT.NEXTVAL,2,'ACT','ACT','PFS',SYSDATE);
INSERT INTO DD_EBC_ESTADO_BIEN_CNT(DD_EBC_ID,DD_EBC_CODIGO,DD_EBC_DESCRIPCION,DD_EBC_DESCRIPCION_LARGA,USUARIOCREAR,FECHACREAR) VALUES (S_DD_EBC_ESTADO_BIEN_CNT.NEXTVAL,3,'INA','INA','PFS',SYSDATE);


CREATE TABLE DD_TBC_TIPO_REL_BIEN_CNT
(
  DD_TBC_ID                 NUMBER(16)          			NOT NULL,
  DD_TBC_CODIGO             VARCHAR2(20 CHAR)   			NOT NULL,
  DD_TBC_DESCRIPCION        VARCHAR2(50 CHAR),
  DD_TBC_DESCRIPCION_LARGA  VARCHAR2(250 CHAR),
  VERSION                   INTEGER             DEFAULT 0   NOT NULL,
  USUARIOCREAR              VARCHAR2(10 CHAR)   			NOT NULL,
  FECHACREAR                TIMESTAMP(6)        			NOT NULL,
  USUARIOMODIFICAR          VARCHAR2(10 CHAR),
  FECHAMODIFICAR            TIMESTAMP(6),
  USUARIOBORRAR             VARCHAR2(10 CHAR),
  FECHABORRAR               TIMESTAMP(6),
  BORRADO                   NUMBER(1)           DEFAULT 0	NOT NULL,
  CONSTRAINT PK_DD_TBC_TIPO_REL_BIEN_CNT PRIMARY KEY (DD_TBC_ID)
);

CREATE SEQUENCE S_DD_TBC_TIPO_REL_BIEN_CNT;

INSERT INTO DD_TBC_TIPO_REL_BIEN_CNT(DD_TBC_ID,DD_TBC_CODIGO,DD_TBC_DESCRIPCION,DD_TBC_DESCRIPCION_LARGA,USUARIOCREAR,FECHACREAR) VALUES (S_DD_TBC_TIPO_REL_BIEN_CNT.NEXTVAL,1,'Gtia hipotecaria de','Gtia hipotecaria de','PFS',SYSDATE);
INSERT INTO DD_TBC_TIPO_REL_BIEN_CNT(DD_TBC_ID,DD_TBC_CODIGO,DD_TBC_DESCRIPCION,DD_TBC_DESCRIPCION_LARGA,USUARIOCREAR,FECHACREAR) VALUES (S_DD_TBC_TIPO_REL_BIEN_CNT.NEXTVAL,2,'Subdivision de','Subdivision de','PFS',SYSDATE);
INSERT INTO DD_TBC_TIPO_REL_BIEN_CNT(DD_TBC_ID,DD_TBC_CODIGO,DD_TBC_DESCRIPCION,DD_TBC_DESCRIPCION_LARGA,USUARIOCREAR,FECHACREAR) VALUES (S_DD_TBC_TIPO_REL_BIEN_CNT.NEXTVAL,3,'Aplica a','Aplica a','PFS',SYSDATE);
INSERT INTO DD_TBC_TIPO_REL_BIEN_CNT(DD_TBC_ID,DD_TBC_CODIGO,DD_TBC_DESCRIPCION,DD_TBC_DESCRIPCION_LARGA,USUARIOCREAR,FECHACREAR) VALUES (S_DD_TBC_TIPO_REL_BIEN_CNT.NEXTVAL,4,'Gtia dineraria de','Gtia dineraria de','PFS',SYSDATE);
INSERT INTO DD_TBC_TIPO_REL_BIEN_CNT(DD_TBC_ID,DD_TBC_CODIGO,DD_TBC_DESCRIPCION,DD_TBC_DESCRIPCION_LARGA,USUARIOCREAR,FECHACREAR) VALUES (S_DD_TBC_TIPO_REL_BIEN_CNT.NEXTVAL,5,'Gtia prendaria de','Gtia prendaria de','PFS',SYSDATE);
INSERT INTO DD_TBC_TIPO_REL_BIEN_CNT(DD_TBC_ID,DD_TBC_CODIGO,DD_TBC_DESCRIPCION,DD_TBC_DESCRIPCION_LARGA,USUARIOCREAR,FECHACREAR) VALUES (S_DD_TBC_TIPO_REL_BIEN_CNT.NEXTVAL,6,'Nomina','Nomina','PFS',SYSDATE);
INSERT INTO DD_TBC_TIPO_REL_BIEN_CNT(DD_TBC_ID,DD_TBC_CODIGO,DD_TBC_DESCRIPCION,DD_TBC_DESCRIPCION_LARGA,USUARIOCREAR,FECHACREAR) VALUES (S_DD_TBC_TIPO_REL_BIEN_CNT.NEXTVAL,7,'Destino inversion','Destino inversion','PFS',SYSDATE);
INSERT INTO DD_TBC_TIPO_REL_BIEN_CNT(DD_TBC_ID,DD_TBC_CODIGO,DD_TBC_DESCRIPCION,DD_TBC_DESCRIPCION_LARGA,USUARIOCREAR,FECHACREAR) VALUES (S_DD_TBC_TIPO_REL_BIEN_CNT.NEXTVAL,8,'Compra leasing','Compra leasing','PFS',SYSDATE);
INSERT INTO DD_TBC_TIPO_REL_BIEN_CNT(DD_TBC_ID,DD_TBC_CODIGO,DD_TBC_DESCRIPCION,DD_TBC_DESCRIPCION_LARGA,USUARIOCREAR,FECHACREAR) VALUES (S_DD_TBC_TIPO_REL_BIEN_CNT.NEXTVAL,9,'Esta asegurado por','Esta asegurado por','PFS',SYSDATE);


CREATE TABLE BIE_CNT
(
  BIE_CNT_ID           			NUMBER(16)         			 	NOT NULL,
  CNT_ID						NUMBER(16)						NOT NULL,
  BIE_ID               			NUMBER(16)						NOT NULL,
  DD_TBC_ID             		NUMBER(16),
  DD_EBC_ID             		NUMBER(16),
  BIE_CNT_IMPORTE_GARANTIZADO   NUMBER(16,2),
  BIE_CNT_FECHA_INICIO          TIMESTAMP(6),
  BIE_CNT_FECHA_CIERRE          TIMESTAMP(6),
  VERSION                   	INTEGER             DEFAULT 0   NOT NULL,
  USUARIOCREAR              	VARCHAR2(10 CHAR)   			NOT NULL,
  FECHACREAR                	TIMESTAMP(6)        			NOT NULL,
  USUARIOMODIFICAR          	VARCHAR2(10 CHAR),
  FECHAMODIFICAR            	TIMESTAMP(6),
  USUARIOBORRAR             	VARCHAR2(10 CHAR),
  FECHABORRAR               	TIMESTAMP(6),
  BORRADO                   	NUMBER(1)           DEFAULT 0	NOT NULL,
  CONSTRAINT PK_BIE_CNT PRIMARY KEY (BIE_CNT_ID)
);

CREATE SEQUENCE S_BIE_CNT;

ALTER TABLE BIE_CNT
   ADD CONSTRAINT FK_BIE_CNT_FK_DD_TBC_BIEN_CNT FOREIGN KEY (DD_TBC_ID)
      REFERENCES DD_TBC_TIPO_REL_BIEN_CNT (DD_TBC_ID);
      
ALTER TABLE BIE_CNT
   ADD CONSTRAINT FK_BIE_CNT_FK_DD_EBC_EST_BIEN FOREIGN KEY (DD_EBC_ID)
      REFERENCES DD_EBC_ESTADO_BIEN_CNT (DD_EBC_ID);
      
ALTER TABLE BIE_CNT
   ADD CONSTRAINT FK_BIE_CNT_FK_BIE_BIEN FOREIGN KEY (BIE_ID)
      REFERENCES BIE_BIEN (BIE_ID);      

ALTER TABLE BIE_CNT
   ADD CONSTRAINT FK_BIE_CNT_FK_CNT_CONTRATO FOREIGN KEY (CNT_ID)
      REFERENCES CNT_CONTRATOS (CNT_ID);      
      
-- diccionario con los distintos origenes de carga del bien 
     
CREATE TABLE DD_ORIGEN_BIEN
(
  DD_ORIGEN_ID           		NUMBER(16)          			NOT NULL,
  DD_ORIGEN_CODIGO             	VARCHAR2(20 CHAR)   			NOT NULL,
  DD_ORIGEN_DESCRIPCION        	VARCHAR2(50 CHAR),
  DD_ORIGEN_DESCRIPCION_LARGA  	VARCHAR2(250 CHAR),
  VERSION                   		INTEGER             DEFAULT 0   NOT NULL,
  USUARIOCREAR              		VARCHAR2(10 CHAR)   			NOT NULL,
  FECHACREAR                		TIMESTAMP(6)        			NOT NULL,
  USUARIOMODIFICAR          		VARCHAR2(10 CHAR),
  FECHAMODIFICAR            		TIMESTAMP(6),
  USUARIOBORRAR             		VARCHAR2(10 CHAR),
  FECHABORRAR               		TIMESTAMP(6),
  BORRADO                   		NUMBER(1)           DEFAULT 0	NOT NULL,
  CONSTRAINT PK_DD_ORIGEN_BIEN PRIMARY KEY (DD_ORIGEN_ID)
);      

CREATE SEQUENCE S_DD_ORIGEN_BIEN;

INSERT INTO DD_ORIGEN_BIEN (DD_ORIGEN_ID,DD_ORIGEN_CODIGO,DD_ORIGEN_DESCRIPCION,DD_ORIGEN_DESCRIPCION_LARGA,USUARIOCREAR,FECHACREAR) VALUES(S_DD_ORIGEN_BIEN.NEXTVAL,'1','Manual','Manual','PFS',SYSDATE);
INSERT INTO DD_ORIGEN_BIEN (DD_ORIGEN_ID,DD_ORIGEN_CODIGO,DD_ORIGEN_DESCRIPCION,DD_ORIGEN_DESCRIPCION_LARGA,USUARIOCREAR,FECHACREAR) VALUES(S_DD_ORIGEN_BIEN.NEXTVAL,'2','Automática','Automática','PFS',SYSDATE);

-- diccionarios para los tipos de cargas monetarias que puede tener un bien

CREATE TABLE DD_TPO_CARGA_BIEN
(
  DD_TPO_CARGA_ID           		NUMBER(16)          			NOT NULL,
  DD_TPO_CARGA_CODIGO             	VARCHAR2(20 CHAR)   			NOT NULL,
  DD_TPO_CARGA_DESCRIPCION        	VARCHAR2(50 CHAR),
  DD_TPO_CARGA_DESCRIPCION_LARGA  	VARCHAR2(250 CHAR),
  VERSION                   		INTEGER             DEFAULT 0   NOT NULL,
  USUARIOCREAR              		VARCHAR2(10 CHAR)   			NOT NULL,
  FECHACREAR                		TIMESTAMP(6)        			NOT NULL,
  USUARIOMODIFICAR          		VARCHAR2(10 CHAR),
  FECHAMODIFICAR            		TIMESTAMP(6),
  USUARIOBORRAR             		VARCHAR2(10 CHAR),
  FECHABORRAR               		TIMESTAMP(6),
  BORRADO                   		NUMBER(1)           DEFAULT 0	NOT NULL,
  CONSTRAINT PK_DD_TPO_CARGA_BIEN PRIMARY KEY (DD_TPO_CARGA_ID)
);  

CREATE SEQUENCE S_DD_TPO_CARGA_BIEN;

INSERT INTO DD_TPO_CARGA_BIEN(DD_TPO_CARGA_ID,DD_TPO_CARGA_CODIGO,DD_TPO_CARGA_DESCRIPCION,DD_TPO_CARGA_DESCRIPCION_LARGA,USUARIOCREAR,FECHACREAR) VALUES (S_DD_TPO_CARGA_BIEN.NEXTVAL,'E','Embargo','Embargo','PFS',SYSDATE);
INSERT INTO DD_TPO_CARGA_BIEN(DD_TPO_CARGA_ID,DD_TPO_CARGA_CODIGO,DD_TPO_CARGA_DESCRIPCION,DD_TPO_CARGA_DESCRIPCION_LARGA,USUARIOCREAR,FECHACREAR) VALUES (S_DD_TPO_CARGA_BIEN.NEXTVAL,'H','Hipotecaria','Hipotecaria','PFS',SYSDATE);
INSERT INTO DD_TPO_CARGA_BIEN(DD_TPO_CARGA_ID,DD_TPO_CARGA_CODIGO,DD_TPO_CARGA_DESCRIPCION,DD_TPO_CARGA_DESCRIPCION_LARGA,USUARIOCREAR,FECHACREAR) VALUES (S_DD_TPO_CARGA_BIEN.NEXTVAL,'I','I','','PFS',SYSDATE);
INSERT INTO DD_TPO_CARGA_BIEN(DD_TPO_CARGA_ID,DD_TPO_CARGA_CODIGO,DD_TPO_CARGA_DESCRIPCION,DD_TPO_CARGA_DESCRIPCION_LARGA,USUARIOCREAR,FECHACREAR) VALUES (S_DD_TPO_CARGA_BIEN.NEXTVAL,'L','Libre','Libre','PFS',SYSDATE);
INSERT INTO DD_TPO_CARGA_BIEN(DD_TPO_CARGA_ID,DD_TPO_CARGA_CODIGO,DD_TPO_CARGA_DESCRIPCION,DD_TPO_CARGA_DESCRIPCION_LARGA,USUARIOCREAR,FECHACREAR) VALUES (S_DD_TPO_CARGA_BIEN.NEXTVAL,'U','U','','PFS',SYSDATE);
INSERT INTO DD_TPO_CARGA_BIEN(DD_TPO_CARGA_ID,DD_TPO_CARGA_CODIGO,DD_TPO_CARGA_DESCRIPCION,DD_TPO_CARGA_DESCRIPCION_LARGA,USUARIOCREAR,FECHACREAR) VALUES (S_DD_TPO_CARGA_BIEN.NEXTVAL,'99999','SIN CARGA','SIN CARGA','PFS',SYSDATE);

-- INCLUIR NUEVOS CAMPOS EN LA TABLA DE BIENES     
      
ALTER TABLE BIE_BIEN ADD DD_ORIGEN_ID NUMBER(16) DEFAULT 1;
ALTER TABLE BIE_BIEN ADD BIE_MARCA_EXTERNOS NUMBER(1) DEFAULT 0;
-- ALTER TABLE BIE_BIEN ADD BIE_DESCRIPCION VARCHAR2(255 CHAR);
ALTER TABLE BIE_BIEN ADD DD_TPO_CARGA_ID NUMBER(16);
ALTER TABLE BIE_BIEN ADD BIE_CODIGO_INTERNO NUMBER(16);
ALTER TABLE BIE_PER ADD BIE_PER_PARTICIPACION NUMBER(16,2);

ALTER TABLE BIE_BIEN
   ADD CONSTRAINT FK_BIE_BIEN_FK_DD_CARGA_BIEN FOREIGN KEY (DD_TPO_CARGA_ID)
      REFERENCES DD_TPO_CARGA_BIEN (DD_TPO_CARGA_ID);      
      
ALTER TABLE BIE_BIEN
   ADD CONSTRAINT FK_BIE_BIEN_FK_DD_ORIGEN_BIEN FOREIGN KEY (DD_ORIGEN_ID)
      REFERENCES DD_ORIGEN_BIEN (DD_ORIGEN_ID);            

--ALTER TABLE BIE_BIEN
--   ADD CONSTRAINT UK_BIE_BIEN_ORIGENCODINTERNO UNIQUE (DD_ORIGEN_ID, BIE_CODIGO_INTERNO);
      
-- VALORACIONES PARA UN BIEN

CREATE TABLE BIE_VALORACIONES
(
  BIE_VAL_ID           				NUMBER(16)          			NOT NULL,
  BIE_ID             				NUMBER(16)			   			NOT NULL,
  BIE_FECHA_VALOR_SUBJETIVO        	TIMESTAMP(6),
  BIE_IMPORTE_VALOR_SUBJETIVO  		NUMBER(16,2),
  BIE_FECHA_VALOR_APRECIACION       TIMESTAMP(6),
  BIE_IMPORTE_VALOR_APRECIACION     NUMBER(16,2),
  BIE_FECHA_VALOR_TASACION          TIMESTAMP(6),
  BIE_IMPORTE_VALOR_TASACION        NUMBER(16,2),
  VERSION                   		INTEGER             DEFAULT 0   NOT NULL,
  USUARIOCREAR              		VARCHAR2(10 CHAR)   			NOT NULL,
  FECHACREAR                		TIMESTAMP(6)        			NOT NULL,
  USUARIOMODIFICAR          		VARCHAR2(10 CHAR),
  FECHAMODIFICAR            		TIMESTAMP(6),
  USUARIOBORRAR             		VARCHAR2(10 CHAR),
  FECHABORRAR               		TIMESTAMP(6),
  BORRADO                   		NUMBER(1)           DEFAULT 0	NOT NULL,
  CONSTRAINT PK_BIE_VALORACIONES PRIMARY KEY (BIE_VAL_ID)
);  

CREATE SEQUENCE S_BIE_VALORACIONES;

ALTER TABLE BIE_VALORACIONES
   ADD CONSTRAINT FK_BIE_VALO_FK_BIE_BIEN FOREIGN KEY (BIE_ID)
      REFERENCES BIE_BIEN (BIE_ID);      
      
-- DATOS REGISTRALES PARA EL BIEN

CREATE TABLE BIE_DATOS_REGISTRALES
(
  BIE_DREG_ID           			NUMBER(16)          			NOT NULL,
  BIE_ID             				NUMBER(16)			   			NOT NULL,
  BIE_DREG_REFERENCIA_CATASTRAL     VARCHAR2(50 CHAR),
  BIE_DREG_SUPERFICIE			  	NUMBER(16,2),
  BIE_DREG_SUPERFICIE_CONSTRUIDA    NUMBER(16,2),
  BIE_DREG_TOMO     				VARCHAR2(50 CHAR),
  BIE_DREG_LIBRO          			VARCHAR2(50 CHAR),
  BIE_DREG_FOLIO        			VARCHAR2(50 CHAR),
  BIE_DREG_INSCRIPCION              VARCHAR2(50 CHAR),
  BIE_DREG_FECHA_INSCRIPCION        TIMESTAMP(6),
  BIE_DREG_NUM_REGISTRO             VARCHAR2(50 CHAR),
  BIE_DREG_MUNICIPIO_LIBRO          VARCHAR2(50 CHAR),
  BIE_DREG_CODIGO_REGISTRO          VARCHAR2(50 CHAR),
  VERSION                   		INTEGER             DEFAULT 0   NOT NULL,
  USUARIOCREAR              		VARCHAR2(10 CHAR)   			NOT NULL,
  FECHACREAR                		TIMESTAMP(6)        			NOT NULL,
  USUARIOMODIFICAR          		VARCHAR2(10 CHAR),
  FECHAMODIFICAR            		TIMESTAMP(6),
  USUARIOBORRAR             		VARCHAR2(10 CHAR),
  FECHABORRAR               		TIMESTAMP(6),
  BORRADO                   		NUMBER(1)           DEFAULT 0	NOT NULL,
  CONSTRAINT PK_BIE_DATOS_REGISTRALES PRIMARY KEY (BIE_DREG_ID)
);  

CREATE SEQUENCE S_BIE_DATOS_REGISTRALES;

ALTER TABLE BIE_DATOS_REGISTRALES
   ADD CONSTRAINT FK_BIE_REGISTRAL_FK_BIE_BIEN FOREIGN KEY (BIE_ID)
      REFERENCES BIE_BIEN (BIE_ID);
      
-- TABLA PARA GUARDAR LAS DISTINTAS LOCCALIZACIONES DE UN MISMO BIEN.

CREATE TABLE BIE_LOCALIZACION
(
  BIE_LOC_ID           		NUMBER(16)          			NOT NULL,
  BIE_ID             		NUMBER(16)			   			NOT NULL,
  BIE_LOC_POBLACION     	VARCHAR2(250 CHAR),
  BIE_LOC_DIRECCION			VARCHAR2(250 CHAR),
  BIE_LOC_COD_POST    		VARCHAR2(250 CHAR),
  BIE_LOC_NUM_FINCA     	VARCHAR2(50 CHAR),
  VERSION                   INTEGER             DEFAULT 0   NOT NULL,
  USUARIOCREAR              VARCHAR2(10 CHAR)   			NOT NULL,
  FECHACREAR                TIMESTAMP(6)        			NOT NULL,
  USUARIOMODIFICAR          VARCHAR2(10 CHAR),
  FECHAMODIFICAR            TIMESTAMP(6),
  USUARIOBORRAR             VARCHAR2(10 CHAR),
  FECHABORRAR               TIMESTAMP(6),
  BORRADO                   NUMBER(1)           DEFAULT 0	NOT NULL,
  CONSTRAINT PK_BIE_LOCALIZACION PRIMARY KEY (BIE_LOC_ID)
);  

CREATE SEQUENCE S_BIE_LOCALIZACION;

ALTER TABLE BIE_LOCALIZACION
   ADD CONSTRAINT FK_BIE_LOC_FK_BIE_BIEN FOREIGN KEY (BIE_ID)
      REFERENCES BIE_BIEN (BIE_ID);

-- Nuevo campo ID en tabla BIE_PER
ALTER TABLE BIE_PER ADD USUARIOCREAR VARCHAR2(10 CHAR);
ALTER TABLE BIE_PER ADD FECHACREAR TIMESTAMP(6);
ALTER TABLE BIE_PER ADD USUARIOMODIFICAR VARCHAR2(10 CHAR);
ALTER TABLE BIE_PER ADD FECHAMODIFICAR TIMESTAMP(6);
ALTER TABLE BIE_PER ADD USUARIOBORRAR VARCHAR2(10 CHAR);
ALTER TABLE BIE_PER ADD FECHABORRAR TIMESTAMP(6);
ALTER TABLE BIE_PER ADD BORRADO NUMBER(1);
ALTER TABLE BIE_PER ADD BIE_PER_ID NUMBER(16);	
UPDATE BIE_PER SET BIE_PER_ID = BIE_ID + PER_ID; 

CREATE SEQUENCE S_BIE_PER
  START WITH 999999999
  MAXVALUE 999999999999999999999999999
  MINVALUE 1
  NOCYCLE
  CACHE 100
  NOORDER;

UPDATE BIE_PER SET BIE_PER_ID = S_BIE_PER.nextVal WHERE BIE_PER_ID IS NULL;
  
/* canarias */
UPDATE PFS01.BIE_BIEN SET DD_ORIGEN_ID=(SELECT DD_ORIGEN_ID FROM PFS01.DD_ORIGEN_BIEN WHERE LOWER(DD_ORIGEN_DESCRIPCION) LIKE '%manual%');
/* ciudad real */
UPDATE PFS02.BIE_BIEN SET DD_ORIGEN_ID=(SELECT DD_ORIGEN_ID FROM PFS02.DD_ORIGEN_BIEN WHERE LOWER(DD_ORIGEN_DESCRIPCION) LIKE '%automática%');
/* ciudad real */
INSERT INTO FUN_PEF (FP_ID, PEF_ID, USUARIOCREAR, FECHACREAR, FUN_ID)
 (SELECT S_FUN_PEF.NEXTVAL, PEF_ID, 'PFS', SYSDATE, 
    (SELECT FUN_ID FROM PFSMASTER.FUN_FUNCIONES WHERE FUN_DESCRIPCION = 'ESTRUCTURA_COMPLETA_BIENES')
  FROM PFS02.PEF_PERFILES);
  
ALTER TABLE BIE_BIEN ADD (DTYPE VARCHAR2 (20 CHAR) DEFAULT 'NMBBien' NOT NULL);

UPDATE PFS02.BIE_BIEN 
SET BIE_CODIGO_INTERNO = BIE_REFERENCIA_CATASTRAL 
WHERE   (USUARIOCREAR = 'DD' OR USUARIOCREAR = 'PFS') AND 
        BIE_ID NOT IN (10000000065710, 10000000043206, 10000000037754, 10000000065710);
        
-- SOLO INSERTAR UNA VEZ        
INSERT INTO PFSMASTER.FUN_FUNCIONES (FUN_ID,FUN_DESCRIPCION_LARGA,FUN_DESCRIPCION,VERSION,USUARIOCREAR,FECHACREAR,BORRADO) VALUES
	(PFSMASTER.S_FUN_FUNCIONES.nextval, 'Botón para generar el informe de situación contencioso', 'BOTON_SITUACION_CONTENCIOSO', 0, 'SAG', '31/08/2010', 0);
INSERT INTO PFSMASTER.FUN_FUNCIONES (FUN_ID,FUN_DESCRIPCION_LARGA,FUN_DESCRIPCION,VERSION,USUARIOCREAR,FECHACREAR,BORRADO) VALUES
	(PFSMASTER.S_FUN_FUNCIONES.nextval, 'Visión completa de los bienes', 'ESTRUCTURA_COMPLETA_BIENES', 0, 'SAG', '31/08/2010', 0);
INSERT INTO PFSMASTER.FUN_FUNCIONES (FUN_ID,FUN_DESCRIPCION_LARGA,FUN_DESCRIPCION,VERSION,USUARIOCREAR,FECHACREAR,BORRADO) VALUES
	(PFSMASTER.S_FUN_FUNCIONES.nextval, 'Permiso para marcar bienes automáticos', 'BOTON_MARCAR_BIENES_PARA_EXTERNOS', 0, 'SAG', '31/08/2010', 0);
INSERT INTO PFSMASTER.FUN_FUNCIONES (FUN_ID,FUN_DESCRIPCION_LARGA,FUN_DESCRIPCION,VERSION,USUARIOCREAR,FECHACREAR,BORRADO) VALUES
	(PFSMASTER.S_FUN_FUNCIONES.nextval, 'Permiso para ver la pestaña bienes en contratos', 'SECCION_BIENES_EN_CONTRATO', 0, 'SAG', '31/08/2010', 0);

	update pfs02.bie_bien set dd_origen_id = 1 where USUARIOCREAR != 'DD' and USUARIOCREAR != 'PFS'
