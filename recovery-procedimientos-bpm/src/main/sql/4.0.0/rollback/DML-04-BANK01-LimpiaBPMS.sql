DELETE
FROM tfi_tareas_form_items
WHERE tfi_id IN
  (SELECT tfi.tfi_id
  FROM tfi_tareas_form_items tfi
  INNER JOIN tap_tarea_procedimiento tap
  ON tap.tap_id        = tfi.tap_id
  WHERE tap.dd_tpo_id IN
    (SELECT DD_TPO_ID
    FROM DD_TPO_TIPO_PROCEDIMIENTO
    WHERE DD_TPO_CODIGO NOT IN ('P400','P401','P402','P403','P404','P405','P406','P407' ,'P408','P409','P410','P411','P412','P413','P414','P415','P416','P417','P418','P419')
    )
  );
DELETE
FROM DD_PTP_PLAZOS_TAREAS_PLAZAS
WHERE DD_PTP_id IN
  (SELECT PTP.DD_PTP_ID
  FROM DD_PTP_PLAZOS_TAREAS_PLAZAS PTP
  INNER JOIN tap_tarea_procedimiento tap
  ON tap.tap_id        = PTP.tap_id
  WHERE tap.dd_tpo_id IN
    (SELECT DD_TPO_ID
    FROM DD_TPO_TIPO_PROCEDIMIENTO
    WHERE DD_TPO_CODIGO NOT IN ('P400','P401','P402','P403','P404','P405','P406','P407' ,'P408','P409','P410','P411','P412','P413','P414','P415','P416','P417','P418','P419')
    )
  );
DELETE
FROM TEV_TAREA_EXTERNA_VALOR TEV
WHERE TEV.TEX_ID IN
  (SELECT TEX.TEX_ID
  FROM TEX_TAREA_EXTERNA TEX
  WHERE TEX.TAP_ID IN
    (SELECT TAP.TAP_ID
    FROM tap_tarea_procedimiento TAP
    WHERE dd_tpo_id IN
      (SELECT DD_TPO_ID
      FROM DD_TPO_TIPO_PROCEDIMIENTO
      WHERE DD_TPO_CODIGO NOT IN ('P400','P401','P402','P403','P404','P405','P406','P407' ,'P408','P409','P410','P411','P412','P413','P414','P415','P416','P417','P418','P419')
      )
    )
  );
DELETE
FROM TER_TAREA_EXTERNA_RECUPERACION TER
WHERE TER.TEX_ID IN
  (SELECT TEX.TEX_ID
  FROM TEX_TAREA_EXTERNA TEX
  WHERE TEX.TAP_ID IN
    (SELECT TAP.TAP_ID
    FROM tap_tarea_procedimiento TAP
    WHERE dd_tpo_id IN
      (SELECT DD_TPO_ID
      FROM DD_TPO_TIPO_PROCEDIMIENTO
      WHERE DD_TPO_CODIGO NOT IN ('P400','P401','P402','P403','P404','P405','P406','P407' ,'P408','P409','P410','P411','P412','P413','P414','P415','P416','P417','P418','P419')
      )
    )
  );
DELETE
FROM TEX_TAREA_EXTERNA TEX
WHERE TEX.TAP_ID IN
  (SELECT TAP.TAP_ID
  FROM tap_tarea_procedimiento TAP
  WHERE dd_tpo_id IN
    (SELECT DD_TPO_ID
    FROM DD_TPO_TIPO_PROCEDIMIENTO
    WHERE DD_TPO_CODIGO NOT IN ('P400','P401','P402','P403','P404','P405','P406','P407' ,'P408','P409','P410','P411','P412','P413','P414','P415','P416','P417','P418','P419')
    )
  );
DELETE
FROM tar_tareas_notificaciones
WHERE prc_id IN
  (SELECT prc_id
  FROM prc_procedimientos
  WHERE dd_tpo_id IN
    (SELECT dd_tpo_id
    FROM dd_tpo_tipo_procedimiento
    WHERE dd_tpo_id IN
      (SELECT DD_TPO_ID
      FROM DD_TPO_TIPO_PROCEDIMIENTO
      WHERE DD_TPO_CODIGO NOT IN ('P400','P401','P402','P403','P404','P405','P406','P407' ,'P408','P409','P410','P411','P412','P413','P414','P415','P416','P417','P418','P419')
      )
    )
  );
  
DELETE
FROM tap_tarea_procedimiento
WHERE dd_tpo_id IN
  (SELECT DD_TPO_ID
  FROM DD_TPO_TIPO_PROCEDIMIENTO
  WHERE DD_TPO_CODIGO NOT IN ('P400','P401','P402','P403','P404','P405','P406','P407' ,'P408','P409','P410','P411','P412','P413','P414','P415','P416','P417','P418','P419')
  );
  
DELETE FROM PRC_CEX;

DELETE FROM PRC_PER;

DELETE FROM PRD_PROCEDIMIENTOS_DERIVADOS;

DELETE FROM HAC_HISTORICO_ACCESOS WHERE PRC_ID IS NOT NULL;

DELETE FROM DPR_DECISIONES_PROCEDIMIENTOS;

DELETE FROM PRB_PRC_BIE;

DELETE
FROM DD_TPO_TIPO_PROCEDIMIENTO
WHERE DD_TPO_CODIGO NOT IN ('P400','P401','P402','P403','P404','P405','P406','P407' ,'P408','P409','P410','P411','P412','P413','P414','P415','P416','P417','P418','P419');
