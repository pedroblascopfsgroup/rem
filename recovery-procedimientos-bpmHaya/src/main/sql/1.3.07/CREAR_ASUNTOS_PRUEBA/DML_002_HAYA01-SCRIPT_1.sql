


/* UPDATEAMOS GESTORES Y LETRADOS */

/*20150303: ROBERTO*/
UPDATE  CNV_AUX_ALTA_PRC SET GESTOR='Letrado';
--UPDATE  CNV_AUX_ALTA_PRC SET GESTOR='Letrado' WHERE TIPO_PROCEDIMIENTO='HIPOTECARIO';
--UPDATE CNV_AUX_ALTA_PRC SET GESTOR='Gestor UCL' WHERE TIPO_PROCEDIMIENTO!='HIPOTECARIO';
--UPDATE  CNV_AUX_ALTA_PRC SET COD_LETRADO='A171573' WHERE TIPO_PROCEDIMIENTO='HIPOTECARIO';
--UPDATE CNV_AUX_ALTA_PRC SET COD_LETRADO='A118468' WHERE TIPO_PROCEDIMIENTO!='HIPOTECARIO';



truncate table CNV_TMP_PER_ID;

/*20150303: ROBERTO*/
INSERT INTO CNV_TMP_PER_ID (CODIGO_PERSONA, PER_ID)
   SELECT DISTINCT PRD.CODIGO_PERSONA, PER.PER_ID 
   FROM CNV_AUX_ALTA_PRC_PER PRD 
   --LEFT JOIN PER_PERSONAS PER ON (PRD.CODIGO_PERSONA = PER.PER_COD_CLIENTE_ENTIDAD);
   INNER JOIN PER_PERSONAS PER ON (PRD.CODIGO_PERSONA = PER.PER_COD_CLIENTE_ENTIDAD);
   





truncate table CNV_TMP_CNT_ID;

/*20150303: ROBERTO*/
INSERT INTO CNV_TMP_CNT_ID (
TIPO_PRODUCTO,
NUMERO_CONTRATO,
NUMERO_ESPEC,
CNT_ID)
    SELECT DISTINCT 
PRO.TIPO_PRODUCTO,
PRO.NUMERO_CONTRATO,
PRO.NUMERO_ESPEC, CNT.CNT_ID 
    FROM CNV_AUX_ALTA_PRC_CNT PRO
    --left join  CNT_CONTRATOS CNT ON (PRO.NUMERO_CONTRATO = SUBSTR(CNT.CNT_CONTRATO,18,10) AND PRO.TIPO_PRODUCTO = SUBSTR(CNT.CNT_CONTRATO,6,5) AND PRO.NUMERO_ESPEC = TO_NUMBER(SUBSTR(CNT.CNT_CONTRATO,28,15)));
    inner join  CNT_CONTRATOS CNT ON (PRO.NUMERO_CONTRATO = SUBSTR(CNT.CNT_CONTRATO,18,10) AND PRO.TIPO_PRODUCTO = SUBSTR(CNT.CNT_CONTRATO,6,5) AND PRO.NUMERO_ESPEC = TO_NUMBER(SUBSTR(CNT.CNT_CONTRATO,28,15)));

