
set verify off;

define MASTER_SCHEMA = BANKMASTER;

CREATE SEQUENCE S_RCF_DD_ECM_ESTADO_COMPONENT;

CREATE TABLE RCF_DD_ECM_ESTADO_COMPONENT (
   RCF_DD_ECM_ID                NUMBER(16)                      NOT NULL,        
   RCF_DD_ECM_CODIGO            VARCHAR2(20 CHAR)               NOT NULL,
   RCF_DD_ECM_DESCRIPCION       VARCHAR2(100 CHAR),
   RCF_DD_ECM_DESCRIPCION_LARGA VARCHAR2(250 CHAR),
   VERSION                      INTEGER               DEFAULT 0 NOT NULL,
   USUARIOCREAR                 VARCHAR2(10 CHAR)               NOT NULL,
   FECHACREAR                   TIMESTAMP(6)                    NOT NULL,
   USUARIOMODIFICAR             VARCHAR2(10 CHAR),
   FECHAMODIFICAR               TIMESTAMP(6),
   USUARIOBORRAR                VARCHAR2(10 CHAR),
   FECHABORRAR                  TIMESTAMP(6),
   BORRADO                      NUMBER(1)             DEFAULT 0 NOT NULL,
   CONSTRAINT PK_RCF_DD_ECM_ESTADO_COMPONENT PRIMARY KEY (RCF_DD_ECM_ID),
   CONSTRAINT UK_RCF_DD_ECM_ESTADO_COMPONENT UNIQUE (RCF_DD_ECM_CODIGO)
);

CREATE SEQUENCE S_RCF_CAR_CARTERA;

CREATE TABLE RCF_CAR_CARTERA (
    RCF_CAR_ID               NUMBER(16)                      NOT NULL,        
    RCF_CAR_NOMBRE           VARCHAR2(250 CHAR)               NOT NULL,
    RCF_CAR_DESCRIPCION      VARCHAR2(250 CHAR),
    RD_ID                    NUMBER(16)                      NOT NULL,
    RCF_DD_ECM_ID            NUMBER(16)                      NOT NULL,
    RCF_CAR_FECHA_ALTA       TIMESTAMP(6)                    NOT NULL,
    USU_ID                     NUMBER(16)                         NOT NULL,
    VERSION                  INTEGER               DEFAULT 0 NOT NULL,
    USUARIOCREAR             VARCHAR2(10 CHAR)               NOT NULL,
    FECHACREAR               TIMESTAMP(6)                    NOT NULL,
    USUARIOMODIFICAR         VARCHAR2(10 CHAR),
    FECHAMODIFICAR           TIMESTAMP(6),
    USUARIOBORRAR            VARCHAR2(10 CHAR),
    FECHABORRAR              TIMESTAMP(6),
    BORRADO                  NUMBER(1)           DEFAULT 0  NOT NULL,
    CONSTRAINT PK_RCF_CAR_CARTERA PRIMARY KEY (RCF_CAR_ID),
    CONSTRAINT UK_RCF_CAR_CARTERA UNIQUE (RCF_CAR_NOMBRE),
    CONSTRAINT FK_RCF_CAR_RULE FOREIGN KEY (RD_ID) REFERENCES RULE_DEFINITION (RD_ID),
    CONSTRAINT FK_RCF_CAR_RCF_DD_ECM_ID FOREIGN KEY (RCF_DD_ECM_ID) REFERENCES RCF_DD_ECM_ESTADO_COMPONENT (RCF_DD_ECM_ID),
    CONSTRAINT FK_RCF_CAR_USU FOREIGN KEY (USU_ID) REFERENCES &MASTER_SCHEMA..USU_USUARIOS (USU_ID)
 );

 -- TABLA DE MODELOS DE TRANSICIÓN ENTRE ESQUEMAS

CREATE SEQUENCE S_RCF_DD_MTR_MODELO_TRANSICION;

CREATE TABLE RCF_DD_MTR_MODELO_TRANSICION (
   RCF_DD_MTR_ID                NUMBER(16)                       NOT NULL,        
   RCF_DD_MTR_CODIGO            VARCHAR2(20 CHAR)                NOT NULL,
   RCF_DD_MTR_DESCRIPCION        VARCHAR2(100 CHAR),
   RCF_DD_MTR_DESCRIPCION_LARGA VARCHAR2(250 CHAR),
   VERSION                      INTEGER               DEFAULT 0  NOT NULL,
   USUARIOCREAR                 VARCHAR2(10 CHAR)                NOT NULL,
   FECHACREAR                   TIMESTAMP(6)                     NOT NULL,
   USUARIOMODIFICAR             VARCHAR2(10 CHAR),
   FECHAMODIFICAR               TIMESTAMP(6),
   USUARIOBORRAR                VARCHAR2(10 CHAR),
   FECHABORRAR                  TIMESTAMP(6),
   BORRADO                      NUMBER(1)           DEFAULT 0   NOT NULL,
   CONSTRAINT PK_RCF_DD_MTR_MOD_TRANSICION PRIMARY KEY (RCF_DD_MTR_ID),
   CONSTRAINT UK_RCF_DD_MTR_MOD_TRANSICION UNIQUE (RCF_DD_MTR_CODIGO)
);

-- TABLA DE ESTADO DEL ESQUEMA

CREATE SEQUENCE S_RCF_DD_EES_ESTADO_ESQUEMA;

CREATE TABLE RCF_DD_EES_ESTADO_ESQUEMA (
   RCF_DD_EES_ID                NUMBER(16)                      NOT NULL,        
   RCF_DD_EES_CODIGO            VARCHAR2(20 CHAR)               NOT NULL,
   RCF_DD_EES_DESCRIPCION       VARCHAR2(100 CHAR),
   RCF_DD_EES_DESCRIPCION_LARGA VARCHAR2(250 CHAR),
   VERSION                      INTEGER               DEFAULT 0 NOT NULL,
   USUARIOCREAR                 VARCHAR2(10 CHAR)               NOT NULL,
   FECHACREAR                   TIMESTAMP(6)                    NOT NULL,
   USUARIOMODIFICAR             VARCHAR2(10 CHAR),
   FECHAMODIFICAR               TIMESTAMP(6),
   USUARIOBORRAR                VARCHAR2(10 CHAR),
   FECHABORRAR                  TIMESTAMP(6),
   BORRADO                      NUMBER(1)             DEFAULT 0 NOT NULL,
   CONSTRAINT PK_RCF_DD_EES_ESTADO_ESQUEMA PRIMARY KEY (RCF_DD_EES_ID),
   CONSTRAINT UK_RCF_DD_EES_ESTADO_ESQUEMA UNIQUE (RCF_DD_EES_CODIGO)
);

-- TABLA DE ESQUEMA DE CARTERAS DE RECOBRO

CREATE SEQUENCE S_RCF_ESQ_ESQUEMA;

CREATE TABLE RCF_ESQ_ESQUEMA (
   RCF_ESQ_ID                   NUMBER(16)                      NOT NULL,        
   RCF_ESQ_NOMBRE               VARCHAR2(250 CHAR)               NOT NULL,
   RCF_ESQ_DESCRIPCION          VARCHAR2(250 CHAR),
   RCF_DD_EES_ID                NUMBER(16)                      NOT NULL,
   RCF_ESQ_FECHA_ALTA           TIMESTAMP(6)                    NOT NULL,                
   RCF_ESQ_FECHA_LIB            TIMESTAMP(6),
   RCF_ESQ_FECHA_FIN_TRANSICION TIMESTAMP(6),
   RCF_FECHA_DESACT             TIMESTAMP(6),
   RCF_ESQ_ID_ANTERIOR          NUMBER(16),
   RCF_ESQ_ID_SIGUIENTE         NUMBER(16),
   RCF_DD_MTR_ID                NUMBER(16),
   RCF_ESQ_PLAZO                INTEGER,
   USU_ID                        NUMBER(16)                        NOT NULL,
   RCF_ID_GRUPO_VERSION            NUMBER(16)                        NOT NULL,
   RCF_VERSION                    NUMBER(3)                        NOT NULL,
   RCF_MAJOR_RELEASE            NUMBER(3)                        NOT NULL,
   RCF_MINOR_RELEASE            NUMBER(3)                        NOT NULL,
   VERSION                      INTEGER               DEFAULT 0 NOT NULL,
   USUARIOCREAR                 VARCHAR2(10 CHAR)               NOT NULL,
   FECHACREAR                   TIMESTAMP(6)                    NOT NULL,
   USUARIOMODIFICAR             VARCHAR2(10 CHAR),
   FECHAMODIFICAR               TIMESTAMP(6),
   USUARIOBORRAR                VARCHAR2(10 CHAR),
   FECHABORRAR                  TIMESTAMP(6),
   BORRADO                      NUMBER(1)           DEFAULT 0   NOT NULL,
   CONSTRAINT PK_RCF_ESQ_ESQUEMA PRIMARY KEY (RCF_ESQ_ID),
   CONSTRAINT FK_RCF_ESQ_RCF_DD_EES FOREIGN KEY (RCF_DD_EES_ID) REFERENCES RCF_DD_EES_ESTADO_ESQUEMA (RCF_DD_EES_ID),
   CONSTRAINT FK_RCF_ESQ_MTR FOREIGN KEY (RCF_DD_MTR_ID) REFERENCES RCF_DD_MTR_MODELO_TRANSICION (RCF_DD_MTR_ID),
   CONSTRAINT FK_RCF_ESQ_USU FOREIGN KEY (USU_ID) REFERENCES &MASTER_SCHEMA..USU_USUARIOS (USU_ID)
 );
 
ALTER TABLE RCF_ESQ_ESQUEMA ADD(CONSTRAINT FK_RCF_ESQ_RCF_ID_ORIGEN 
 FOREIGN KEY (RCF_ESQ_ID_ANTERIOR) 
 REFERENCES RCF_ESQ_ESQUEMA (RCF_ESQ_ID));
 
ALTER TABLE RCF_ESQ_ESQUEMA ADD(CONSTRAINT FK_RCF_ESQ_RCF_ID_DESTINO 
 FOREIGN KEY (RCF_ESQ_ID_SIGUIENTE) 
 REFERENCES RCF_ESQ_ESQUEMA (RCF_ESQ_ID));
 
 -- TABLA DE RELACION DE ESQUEMAS CON CARTERAS
 
CREATE SEQUENCE S_RCF_DD_TGC_TIPO_GESTION_CART;

CREATE TABLE RCF_DD_TGC_TIPO_GESTION_CART (
    DD_TGC_ID                    NUMBER(16)                      NOT NULL,        
    DD_TGC_CODIGO                VARCHAR2(20 CHAR)               NOT NULL,
    DD_TGC_DESCRIPCION           VARCHAR2(100 CHAR),
    DD_TGC_DESCRIPCION_LARGA     VARCHAR2(250 CHAR),
    VERSION                      INTEGER             DEFAULT 0   NOT NULL,
    USUARIOCREAR                 VARCHAR2(10 CHAR)               NOT NULL,
    FECHACREAR                   TIMESTAMP(6)                    NOT NULL,
    USUARIOMODIFICAR             VARCHAR2(10 CHAR),
    FECHAMODIFICAR               TIMESTAMP(6),
    USUARIOBORRAR                VARCHAR2(10 CHAR),
    FECHABORRAR                  TIMESTAMP(6),
    BORRADO                      NUMBER(1)            DEFAULT 0   NOT NULL,
    CONSTRAINT PK_DD_TGC_TIPO_GESTION_CARTERA PRIMARY KEY (DD_TGC_ID),
    CONSTRAINT UK_DD_TGC_TIPO_GESTION_CARTERA UNIQUE (DD_TGC_CODIGO)
);

CREATE SEQUENCE S_RCF_DD_TCE_TIPO_CARTERA_ESQ;
 
CREATE TABLE RCF_DD_TCE_TIPO_CARTERA_ESQ (
    DD_TCE_ID                    NUMBER(16)                      NOT NULL,        
    DD_TCE_CODIGO                VARCHAR2(20 CHAR)               NOT NULL,
    DD_TCE_DESCRIPCION           VARCHAR2(100 CHAR),
    DD_TCE_DESCRIPCION_LARGA     VARCHAR2(250 CHAR),
    VERSION                      INTEGER             DEFAULT 0   NOT NULL,
    USUARIOCREAR                 VARCHAR2(10 CHAR)               NOT NULL,
    FECHACREAR                   TIMESTAMP(6)                    NOT NULL,
    USUARIOMODIFICAR             VARCHAR2(10 CHAR),
    FECHAMODIFICAR               TIMESTAMP(6),
    USUARIOBORRAR                VARCHAR2(10 CHAR),
    FECHABORRAR                  TIMESTAMP(6),
    BORRADO                      NUMBER(1)            DEFAULT 0   NOT NULL,
    CONSTRAINT PK_DD_TCE_TIPO_CARTERA_ESQUEMA PRIMARY KEY (DD_TCE_ID),
    CONSTRAINT UK_DD_TCE_TIPO_CARTERA_ESQUEMA UNIQUE (DD_TCE_CODIGO)
);

CREATE SEQUENCE S_RCF_DD_AER_AMBITO_EXP_REC;
 
CREATE TABLE RCF_DD_AER_AMBITO_EXP_REC (
    DD_AER_ID                    NUMBER(16)                      NOT NULL,        
    DD_AER_CODIGO                VARCHAR2(20 CHAR)               NOT NULL,
    DD_AER_DESCRIPCION           VARCHAR2(100 CHAR),
    DD_AER_DESCRIPCION_LARGA     VARCHAR2(250 CHAR),
    VERSION                      INTEGER             DEFAULT 0   NOT NULL,
    USUARIOCREAR                 VARCHAR2(10 CHAR)               NOT NULL,
    FECHACREAR                   TIMESTAMP(6)                    NOT NULL,
    USUARIOMODIFICAR             VARCHAR2(10 CHAR),
    FECHAMODIFICAR               TIMESTAMP(6),
    USUARIOBORRAR                VARCHAR2(10 CHAR),
    FECHABORRAR                  TIMESTAMP(6),
    BORRADO                      NUMBER(1)            DEFAULT 0   NOT NULL,
    CONSTRAINT PK_DD_AER_AMBITO_EXP_RECOBRO PRIMARY KEY (DD_AER_ID),
    CONSTRAINT UK_DD_AER_AMBITO_EXP_RECOBRO UNIQUE (DD_AER_CODIGO)
);

CREATE SEQUENCE S_RCF_ESC_ESQUEMA_CARTERAS;

CREATE TABLE RCF_ESC_ESQUEMA_CARTERAS (
   RCF_ESC_ID               NUMBER(16)                       NOT NULL,        
   RCF_ESQ_ID               NUMBER(16)                       NOT NULL,
   RCF_CAR_ID               NUMBER(16)                       NOT NULL,
   DD_TCE_ID                NUMBER(16)                       NOT NULL,
   RCF_ESC_PRIORIDAD        NUMBER(16)                       NOT NULL,
   DD_TGC_ID                NUMBER(16),
   DD_AER_ID                NUMBER(16),
   VERSION                  INTEGER                DEFAULT 0 NOT NULL,
   USUARIOCREAR             VARCHAR2(10 CHAR)                NOT NULL,
   FECHACREAR               TIMESTAMP(6)                     NOT NULL,
   USUARIOMODIFICAR         VARCHAR2(10 CHAR),
   FECHAMODIFICAR           TIMESTAMP(6),
   USUARIOBORRAR            VARCHAR2(10 CHAR),
   FECHABORRAR              TIMESTAMP(6),
   BORRADO                  NUMBER(1)              DEFAULT 0 NOT NULL,
   CONSTRAINT PK_RCF_ESC_ESQUEMA_CARTERAS PRIMARY KEY (RCF_ESC_ID),
   CONSTRAINT FK_RCF_ESC_RCF_CAR FOREIGN KEY (RCF_CAR_ID) REFERENCES RCF_CAR_CARTERA (RCF_CAR_ID),
   CONSTRAINT FK_RCF_ESC_RCF_ESQ FOREIGN KEY (RCF_ESQ_ID) REFERENCES RCF_ESQ_ESQUEMA (RCF_ESQ_ID),
   CONSTRAINT FK_RCF_ESC_TCE FOREIGN KEY (DD_TCE_ID) REFERENCES RCF_DD_TCE_TIPO_CARTERA_ESQ (DD_TCE_ID),
   CONSTRAINT FK_RCF_ESC_TGC FOREIGN KEY (DD_TGC_ID) REFERENCES RCF_DD_TGC_TIPO_GESTION_CART (DD_TGC_ID),
   CONSTRAINT FK_RCF_ESC_AER FOREIGN KEY (DD_AER_ID) REFERENCES RCF_DD_AER_AMBITO_EXP_REC (DD_AER_ID)
 );
 
 -- TABLA DE AGENCIAS
 
 CREATE SEQUENCE S_RCF_AGE_AGENCIAS;
 
 CREATE TABLE RCF_AGE_AGENCIAS (
    RCF_AGE_ID              NUMBER(16)                      NOT NULL,        
    RCF_AGE_CODIGO          VARCHAR2(10 CHAR)               NOT NULL,
    RCF_AGE_NOMBRE          VARCHAR2(100 CHAR)               NOT NULL,
    RCF_AGE_NIF             VARCHAR2(20 CHAR)               NOT NULL,
    RCF_AGE_CONTACTO_NOMBRE VARCHAR2(50 CHAR),
    RCF_AGE_CONTACTO_APE1   VARCHAR2(50 CHAR),
    RCF_AGE_CONTACTO_APE2   VARCHAR2(50 CHAR),
    RCF_AGE_CONTACTO_MAIL   VARCHAR2(50 CHAR),
    RCF_AGE_CONTACTO_TELF   VARCHAR2(20 CHAR),
    RCF_AGE_DEN_FISCAL      VARCHAR2(250 CHAR),
    DD_TVI_ID               NUMBER(16),
    RCF_AGE_NOMBRE_VIA      VARCHAR2(250 CHAR),
    RCF_AGE_NUMERO_VIA      VARCHAR2(10 CHAR),
    RCF_AGE_PUERTA_VIA      VARCHAR2(10 CHAR),
    RCF_AGE_COD_POSTAL      INTEGER,
    DD_PRV_ID               NUMBER(16),
    DD_LOC_ID_POB           NUMBER(16),
    DD_LOC_ID_MUNI          NUMBER(16),
    DD_CIC_ID               NUMBER(16),
    DES_ID                  NUMBER(16),
    USU_ID                  NUMBER(16),
    VERSION                 INTEGER             DEFAULT 0   NOT NULL,
    USUARIOCREAR            VARCHAR2(10 CHAR)               NOT NULL,
    FECHACREAR              TIMESTAMP(6)                    NOT NULL,
    USUARIOMODIFICAR        VARCHAR2(10 CHAR),
    FECHAMODIFICAR          TIMESTAMP(6),
    USUARIOBORRAR           VARCHAR2(10 CHAR),
    FECHABORRAR             TIMESTAMP(6),
    BORRADO                 NUMBER(1)             DEFAULT 0 NOT NULL,
    CONSTRAINT PK_RCF_AGE_ID PRIMARY KEY (RCF_AGE_ID),
    CONSTRAINT FK_RCF_AGE_DD_TVI FOREIGN KEY (DD_TVI_ID) REFERENCES &MASTER_SCHEMA..DD_TVI_TIPO_VIA (DD_TVI_ID),
    CONSTRAINT FK_RCF_AGE_DD_PRV_ID FOREIGN KEY (DD_PRV_ID) REFERENCES &MASTER_SCHEMA..DD_PRV_PROVINCIA (DD_PRV_ID),
    CONSTRAINT FK_RCF_AGE_DD_LOC_ID_POB FOREIGN KEY (DD_LOC_ID_POB) REFERENCES &MASTER_SCHEMA..DD_LOC_LOCALIDAD (DD_LOC_ID),
    CONSTRAINT FK_RCF_AGE_DD_LOC_ID_MUNI FOREIGN KEY (DD_LOC_ID_MUNI) REFERENCES &MASTER_SCHEMA..DD_LOC_LOCALIDAD (DD_LOC_ID),
    CONSTRAINT FK_RCF_AGE_DD_CIC_ID FOREIGN KEY (DD_CIC_ID) REFERENCES &MASTER_SCHEMA..DD_CIC_CODIGO_ISO_CIRBE (DD_CIC_ID),
    CONSTRAINT FK_RCF_AGE_USU FOREIGN KEY (USU_ID) REFERENCES &MASTER_SCHEMA..USU_USUARIOS (USU_ID),
    CONSTRAINT FK_RCF_AGE_DES FOREIGN KEY (DES_ID) REFERENCES DES_DESPACHO_EXTERNO (DES_ID)
 ); 
 
-- DICCIONARIO DE TIPOS DE SUBCARTERAS
CREATE SEQUENCE S_RCF_DD_TPR_TIPO_REPARTO_SUBC;

--RCF_DD_TSC_TIPO_SUBCART
CREATE TABLE RCF_DD_TPR_TIPO_REPARTO_SUBC (
   RCF_DD_TPR_ID                NUMBER(16)                      NOT NULL,        
   RCF_DD_TPR_CODIGO            VARCHAR2(20 CHAR)               NOT NULL,
   RCF_DD_TPR_DESCRIPCION       VARCHAR2(100 CHAR),
   RCF_DD_TPR_DESCRIPCION_LARGA    VARCHAR2(250 CHAR),
   VERSION                      INTEGER               DEFAULT 0 NOT NULL,
   USUARIOCREAR                 VARCHAR2(10 CHAR)               NOT NULL,
   FECHACREAR                   TIMESTAMP(6)                    NOT NULL,
   USUARIOMODIFICAR             VARCHAR2(10 CHAR),
   FECHAMODIFICAR               TIMESTAMP(6),
   USUARIOBORRAR                VARCHAR2(10 CHAR),
   FECHABORRAR                  TIMESTAMP(6),
   BORRADO                      NUMBER(1)           DEFAULT 0  NOT NULL,
   CONSTRAINT PK_RCF_DD_TPR_TIPO_REPA_SUBC PRIMARY KEY (RCF_DD_TPR_ID),
   CONSTRAINT UK_RCF_DD_TPR_TIPO_REPA_SUBC UNIQUE (RCF_DD_TPR_CODIGO)
);
 

--**************************************************
-- MODELOS DE FACTURACION
-- **************************************************

--CREATE SEQUENCE S_RCF_DD_TCB_TIPO_COBRO;

--CREATE TABLE RCF_DD_TCB_TIPO_COBRO(
--    RCF_DD_TCB_ID                              NUMBER(16)    NOT NULL,
--    RCF_DD_TCB_CODIGO                  VARCHAR2(20 CHAR)    NOT NULL,
--    RCF_DD_TCB_DESCRIPCION             VARCHAR2(50 CHAR),
--    RCF_DD_TCB_DESCRIPCION_LARGA   VARCHAR(250 CHAR),
--    RCF_DD_TCB_FACTURABLE          NUMBER(1),
--    VERSION                      INTEGER               DEFAULT 0 NOT NULL,
--   USUARIOCREAR                 VARCHAR2(10 CHAR)               NOT NULL,
--   FECHACREAR                   TIMESTAMP(6)                    NOT NULL,
--   USUARIOMODIFICAR             VARCHAR2(10 CHAR),
--   FECHAMODIFICAR               TIMESTAMP(6),
--   USUARIOBORRAR                VARCHAR2(10 CHAR),
--   FECHABORRAR                  TIMESTAMP(6),
--   BORRADO                      NUMBER(1)           DEFAULT 0  NOT NULL,
--   CONSTRAINT PK_RCF_DD_TCB_TIPO_COBRO PRIMARY KEY (RCF_DD_TCB_ID),
--   CONSTRAINT UK_RCF_DD_TCB_TIPO_COBRO UNIQUE (RCF_DD_TCB_CODIGO)
--);

CREATE SEQUENCE S_RCF_DD_COC_CONCEPTO_COBRO;

CREATE TABLE RCF_DD_COC_CONCEPTO_COBRO(
    RCF_DD_COC_ID                   NUMBER(16)            NOT NULL,
    RCF_DD_COC_CODIGO                  VARCHAR2(20 CHAR)    NOT NULL,
    RCF_DD_COC_DESCRIPCION           VARCHAR2(50 CHAR),
    RCF_DD_COC_DESCRIPCION_LARGA    VARCHAR2(250 CHAR),
    RCF_DD_COC_CPA_CONCEP_IMPORT    VARCHAR2(250 CHAR),
    VERSION                      INTEGER               DEFAULT 0 NOT NULL,
   USUARIOCREAR                 VARCHAR2(10 CHAR)               NOT NULL,
   FECHACREAR                   TIMESTAMP(6)                    NOT NULL,
   USUARIOMODIFICAR             VARCHAR2(10 CHAR),
   FECHAMODIFICAR               TIMESTAMP(6),
   USUARIOBORRAR                VARCHAR2(10 CHAR),
   FECHABORRAR                  TIMESTAMP(6),
   BORRADO                      NUMBER(1)           DEFAULT 0  NOT NULL,
   CONSTRAINT PK_RCF_DD_COC_CONCEPTO_COBRO PRIMARY KEY (RCF_DD_COC_ID),
   CONSTRAINT UK_RCF_DD_COC_CONCEPTO_COBRO UNIQUE ( RCF_DD_COC_CODIGO)
);

CREATE SEQUENCE S_RCF_DD_TCO_TIPO_CORRECTOR;

CREATE TABLE RCF_DD_TCO_TIPO_CORRECTOR(
    RCF_DD_TCO_ID                    NUMBER(16)            NOT NULL,
    RCF_DD_TCO_CODIGO                VARCHAR2(20 CHAR)    NOT NULL,
    RCF_DD_TCO_DESCRIPCION            VARCHAR2(50 CHAR)    NOT NULL,
    RCF_DD_TCO_DESCRIPCION_LARGA    VARCHAR2(250 CHAR)    NOT NULL,
    VERSION                      INTEGER               DEFAULT 0 NOT NULL,
       USUARIOCREAR                 VARCHAR2(10 CHAR)               NOT NULL,
       FECHACREAR                   TIMESTAMP(6)                    NOT NULL,
       USUARIOMODIFICAR             VARCHAR2(10 CHAR),
       FECHAMODIFICAR               TIMESTAMP(6),
       USUARIOBORRAR                VARCHAR2(10 CHAR),
       FECHABORRAR                  TIMESTAMP(6),
       BORRADO                      NUMBER(1)           DEFAULT 0  NOT NULL,
       CONSTRAINT PK_RCF_DD_TCO_TIPO_CORRECTOR PRIMARY KEY (RCF_DD_TCO_ID),
       CONSTRAINT UK_RCF_DD_TCO_TIPO_CORRECTOR UNIQUE (RCF_DD_TCO_CODIGO)
);

CREATE SEQUENCE S_RCF_MFA_MODELOS_FACTURACION;

CREATE TABLE RCF_MFA_MODELOS_FACTURACION (
       RCF_MFA_ID                   NUMBER(16)                         NOT NULL,
       RCF_MFA_NOMBRE               VARCHAR2(250 CHAR)               NOT NULL,
       RCF_MFA_DESCRIPCION          VARCHAR2(250 CHAR), 
       RCF_DD_TCO_ID                NUMBER(16),
       RCF_MFA_OBJETIVO_RECOBRO        FLOAT,
       RCF_DD_ECM_ID                 NUMBER(16)                         NOT NULL,
       USU_ID                         NUMBER(16)                         NOT NULL,
       VERSION                      INTEGER               DEFAULT 0 NOT NULL,
       USUARIOCREAR                 VARCHAR2(10 CHAR)               NOT NULL,
       FECHACREAR                   TIMESTAMP(6)                    NOT NULL,
       USUARIOMODIFICAR             VARCHAR2(10 CHAR),
       FECHAMODIFICAR               TIMESTAMP(6),
       USUARIOBORRAR                VARCHAR2(10 CHAR),
       FECHABORRAR                  TIMESTAMP(6),
       BORRADO                      NUMBER(1)           DEFAULT 0  NOT NULL,
    CONSTRAINT PK_RCF_MFA_MODELOS_FACTURACION PRIMARY KEY (RCF_MFA_ID),
    CONSTRAINT FK_RCF_MFA_TCO FOREIGN KEY (RCF_DD_TCO_ID) REFERENCES RCF_DD_TCO_TIPO_CORRECTOR (RCF_DD_TCO_ID),
    CONSTRAINT FK_RCF_DD_ECM_MFA FOREIGN KEY (RCF_DD_ECM_ID) REFERENCES RCF_DD_ECM_ESTADO_COMPONENT (RCF_DD_ECM_ID),
    CONSTRAINT FK_RCF_USU_MFA FOREIGN KEY (USU_ID) REFERENCES &MASTER_SCHEMA..USU_USUARIOS (USU_ID)
);

CREATE SEQUENCE S_RCF_COF_CORRECTOR_FACTURA;

CREATE TABLE RCF_COF_CORRECTOR_FACTURA (
    RCF_COF_ID                      NUMBER(16)                        NOT NULL,
       RCF_MFA_ID                     NUMBER(16)                        NOT NULL,
       RCF_COF_RANKING_POSICION     INTEGER,
       RCF_COF_OBJETIVO_INICIO         FLOAT, 
       RCF_COF_OBJETIVO_FIN         FLOAT,
       RCF_COF_COEFICIENTE          FLOAT,
       VERSION                      INTEGER               DEFAULT 0 NOT NULL,
       USUARIOCREAR                 VARCHAR2(10 CHAR)               NOT NULL,
       FECHACREAR                   TIMESTAMP(6)                    NOT NULL,
       USUARIOMODIFICAR             VARCHAR2(10 CHAR),
       FECHAMODIFICAR               TIMESTAMP(6),
       USUARIOBORRAR                VARCHAR2(10 CHAR),
       FECHABORRAR                  TIMESTAMP(6),
       BORRADO                      NUMBER(1)           DEFAULT 0  NOT NULL,
    CONSTRAINT PK_RCF_COF_CORRECTOR_FACTURA PRIMARY KEY (RCF_COF_ID),
    CONSTRAINT FK_RCF_COF_MFA FOREIGN KEY (RCF_MFA_ID) REFERENCES RCF_MFA_MODELOS_FACTURACION (RCF_MFA_ID)
);

CREATE SEQUENCE S_RCF_TRF_TRAMO_FACTURACION;

CREATE TABLE RCF_TRF_TRAMO_FACTURACION(
    RCF_TRF_ID                NUMBER(16)        NOT NULL,
    RCF_MFA_ID                NUMBER(16)        NOT NULL,
    RCF_TRF_DIAS               NUMBER(4)            NOT NULL,
    VERSION                      INTEGER               DEFAULT 0 NOT NULL,
   USUARIOCREAR                 VARCHAR2(10 CHAR)               NOT NULL,
   FECHACREAR                   TIMESTAMP(6)                    NOT NULL,
   USUARIOMODIFICAR             VARCHAR2(10 CHAR),
   FECHAMODIFICAR               TIMESTAMP(6),
   USUARIOBORRAR                VARCHAR2(10 CHAR),
   FECHABORRAR                  TIMESTAMP(6),
   BORRADO                      NUMBER(1)           DEFAULT 0  NOT NULL,
   CONSTRAINT PK_RCF_TRF_TRAMO_FACTURACION PRIMARY KEY (RCF_TRF_ID),
   CONSTRAINT FK_RCF_TRF_MFA FOREIGN KEY (RCF_MFA_ID) REFERENCES RCF_MFA_MODELOS_FACTURACION (RCF_MFA_ID)
);

CREATE SEQUENCE S_RCF_TCF_TIPO_COBRO_FACTURA;

CREATE TABLE RCF_TCF_TIPO_COBRO_FACTURA(
    RCF_TCF_ID                 NUMBER(16)        NOT NULL,
    RCF_MFA_ID                 NUMBER(16)        NOT NULL,
    DD_SCP_ID              NUMBER(16)        NOT NULL,
    VERSION                      INTEGER               DEFAULT 0 NOT NULL,
   USUARIOCREAR                 VARCHAR2(10 CHAR)               NOT NULL,
   FECHACREAR                   TIMESTAMP(6)                    NOT NULL,
   USUARIOMODIFICAR             VARCHAR2(10 CHAR),
   FECHAMODIFICAR               TIMESTAMP(6),
   USUARIOBORRAR                VARCHAR2(10 CHAR),
   FECHABORRAR                  TIMESTAMP(6),
   BORRADO                      NUMBER(1)           DEFAULT 0  NOT NULL,
   CONSTRAINT PK_RCF_TIPO_COBRO_FACTURACION PRIMARY KEY (RCF_TCF_ID),
   CONSTRAINT FK_RCF_TCF_MFA FOREIGN KEY (RCF_MFA_ID) REFERENCES RCF_MFA_MODELOS_FACTURACION (RCF_MFA_ID),
   CONSTRAINT FK_RCF_TCF_DD_SCP_ID FOREIGN KEY (DD_SCP_ID) REFERENCES DD_SCP_SUBTIPO_COBRO_PAGO (DD_SCP_ID)
   );
    
CREATE SEQUENCE  S_RCF_TCC_TARIFAS_CONCEP_COB;

CREATE TABLE RCF_TCC_TARIFAS_CONCEP_COBRO(
    RCF_TCC_ID                  NUMBER(16)   NOT NULL,
    RCF_TCF_ID                  NUMBER(16)    NOT NULL,
    RCF_DD_COC_ID               NUMBER(16)    NOT NULL,
    RCF_TCC_MIN                 NUMBER(16,2),
    RCF_TCC_MAX                 NUMBER(16,2),
    RCF_TCC_PORCENTAJE_DEFECTO    NUMBER(16,2),
    VERSION                     INTEGER               DEFAULT 0 NOT NULL,
   USUARIOCREAR                 VARCHAR2(10 CHAR)               NOT NULL,
   FECHACREAR                   TIMESTAMP(6)                    NOT NULL,
   USUARIOMODIFICAR             VARCHAR2(10 CHAR),
   FECHAMODIFICAR               TIMESTAMP(6),
   USUARIOBORRAR                VARCHAR2(10 CHAR),
   FECHABORRAR                  TIMESTAMP(6),
   BORRADO                      NUMBER(1)           DEFAULT 0  NOT NULL,
   CONSTRAINT PK_RCF_TCC_TARIFAS_CONCEP_CO PRIMARY KEY (RCF_TCC_ID),
   CONSTRAINT FK_RCF_TCC_TCF FOREIGN KEY (RCF_TCF_ID) REFERENCES RCF_TCF_TIPO_COBRO_FACTURA (RCF_TCF_ID),
   CONSTRAINT FK_RCF_TCC_DD_TTF FOREIGN KEY (RCF_DD_COC_ID) REFERENCES RCF_DD_COC_CONCEPTO_COBRO (RCF_DD_COC_ID)
   );

CREATE SEQUENCE S_RCF_TCT_TARIF_COBRO_TRAMO;

CREATE TABLE RCF_TCT_TARIF_COBRO_TRAMO(
    RCF_TCT_ID                 NUMBER(16)        NOT NULL,
    RCF_TRF_ID                 NUMBER(16)        NOT NULL,
    RCF_TCC_ID                 NUMBER(16)        NOT NULL,
    RCF_TCT_PORCENTAJE           NUMBER(16,2),
    VERSION                      INTEGER               DEFAULT 0 NOT NULL,
   USUARIOCREAR                 VARCHAR2(10 CHAR)               NOT NULL,
   FECHACREAR                   TIMESTAMP(6)                    NOT NULL,
   USUARIOMODIFICAR             VARCHAR2(10 CHAR),
   FECHAMODIFICAR               TIMESTAMP(6),
   USUARIOBORRAR                VARCHAR2(10 CHAR),
   FECHABORRAR                  TIMESTAMP(6),
   BORRADO                      NUMBER(1)           DEFAULT 0  NOT NULL,
   CONSTRAINT PK_RCF_TCT_TARIF_COBRO_TRAMO PRIMARY KEY (RCF_TCT_ID),
   CONSTRAINT FK_RCF_TCT_TRF FOREIGN KEY (RCF_TRF_ID) REFERENCES RCF_TRF_TRAMO_FACTURACION (RCF_TRF_ID),
   CONSTRAINT FK_RCF_TCT_TCC FOREIGN KEY (RCF_TCC_ID) REFERENCES RCF_TCC_TARIFAS_CONCEP_COBRO (RCF_TCC_ID)
   );
 
 -- MODELOS DE METAS VOLANTES
 -- TABLA DE TIPOS DE METAS VOLANTES
CREATE SEQUENCE S_RCF_DD_MET_META_VOLANTE;

CREATE TABLE RCF_DD_MET_META_VOLANTE (
    RCF_DD_MET_ID                NUMBER(16)                     NOT NULL,        
    RCF_DD_MET_ORDEN             NUMBER(8)                      NOT NULL,
    RCF_DD_MET_CODIGO            VARCHAR2(15 CHAR)              NOT NULL,
    RCF_DD_MET_DESCRIPCION       VARCHAR2(50 CHAR)              NOT NULL,
    RCF_DD_MET_DES_LARGA         VARCHAR2(250 CHAR),
   VERSION                  INTEGER               DEFAULT 0     NOT NULL,
   USUARIOCREAR             VARCHAR2(10 CHAR)               NOT NULL,
   FECHACREAR               TIMESTAMP(6)                    NOT NULL,
   USUARIOMODIFICAR         VARCHAR2(10 CHAR),
   FECHAMODIFICAR           TIMESTAMP(6),
   USUARIOBORRAR            VARCHAR2(10 CHAR),
   FECHABORRAR              TIMESTAMP(6),
   BORRADO                   NUMBER(1)           DEFAULT 0    NOT NULL,
   CONSTRAINT PK_RCF_DD_MET_META_VOLANTE PRIMARY KEY (RCF_DD_MET_ID ),
   CONSTRAINT UK_DD_MET_META_VOLANTE_COD UNIQUE (RCF_DD_MET_ORDEN)
 );
 
-- TABLA DE ITINERARIO DE METAS VOLANTES 
 CREATE SEQUENCE S_RCF_ITV_ITI_METAS_VOLANTES;

CREATE TABLE RCF_ITV_ITI_METAS_VOLANTES (
    RCF_ITV_ID                        NUMBER(16)                     NOT NULL,        
    RCF_ITV_NOMBRE                    VARCHAR2(250 CHAR)                NOT NULL,
    RCF_ITV_FECHA_ALTA                TIMESTAMP(6)                    NOT NULL,
    RCF_ITV_PLAZO_MAX                NUMBER(8)              DEFAULT 0  NOT NULL,
    RCF_ITV_NO_GEST                 NUMBER(8)              DEFAULT 0  NOT NULL,
    RCF_DD_ECM_ID                    NUMBER(16)                          NOT NULL,    
    USU_ID                            NUMBER(16)                          NOT NULL,
    RCF_ITV_PORCENTAJE_CBR_PARCIAl     NUMBER(16,2),
    VERSION                          INTEGER               DEFAULT 0     NOT NULL,
   USUARIOCREAR                     VARCHAR2(10 CHAR)               NOT NULL,
   FECHACREAR                       TIMESTAMP(6)                    NOT NULL,
   USUARIOMODIFICAR                 VARCHAR2(10 CHAR),
   FECHAMODIFICAR                   TIMESTAMP(6),
   USUARIOBORRAR                    VARCHAR2(10 CHAR),
   FECHABORRAR                      TIMESTAMP(6),
   BORRADO                           NUMBER(1)           DEFAULT 0    NOT NULL,
   CONSTRAINT PK_ITV_ITI_METAS_VOLANTES PRIMARY KEY (RCF_ITV_ID),
   CONSTRAINT FK_RCF_DD_ECM_ITV FOREIGN KEY (RCF_DD_ECM_ID) REFERENCES RCF_DD_ECM_ESTADO_COMPONENT (RCF_DD_ECM_ID),
   CONSTRAINT FK_RCF_USU_ITV FOREIGN KEY (USU_ID) REFERENCES &MASTER_SCHEMA..USU_USUARIOS (USU_ID)
 );
 
 -- TABLA DE METAS VOLANTES
CREATE SEQUENCE S_RCF_MVL_META_VOLANTE;

CREATE TABLE RCF_MVL_META_VOLANTE (
    RCF_MVL_ID                NUMBER(16)                     NOT NULL,        
    RCF_MVL_ORDEN             NUMBER(8)                      NOT NULL,
    RCF_MVL_DIAS_ENT          NUMBER(8),
    RCF_MVL_BLOQUEO              NUMBER(1),
    RCF_DD_MET_ID          NUMBER(16)                        NOT NULL,
    RCF_ITV_ID               NUMBER(16)                        NOT NULL,    
   VERSION                  INTEGER               DEFAULT 0     NOT NULL,
   USUARIOCREAR             VARCHAR2(10 CHAR)               NOT NULL,
   FECHACREAR               TIMESTAMP(6)                    NOT NULL,
   USUARIOMODIFICAR         VARCHAR2(10 CHAR),
   FECHAMODIFICAR           TIMESTAMP(6),
   USUARIOBORRAR            VARCHAR2(10 CHAR),
   FECHABORRAR              TIMESTAMP(6),
   BORRADO                   NUMBER(1)           DEFAULT 0    NOT NULL,
   CONSTRAINT PK_RCF_MVL_META_VOLANTE PRIMARY KEY (RCF_MVL_ID ),
   CONSTRAINT FK_RCF_MVL_META_ITV FOREIGN KEY (RCF_ITV_ID) REFERENCES RCF_ITV_ITI_METAS_VOLANTES (RCF_ITV_ID),
   CONSTRAINT FK_RCF_MVL_META_DD_MET_ID FOREIGN KEY (RCF_DD_MET_ID) REFERENCES RCF_DD_MET_META_VOLANTE (RCF_DD_MET_ID),
   CONSTRAINT UK_MVL_META_VOLANTE UNIQUE ( RCF_ITV_ID,RCF_DD_MET_ID)
 );
 
-- TABLAS POLITICA DE ACUERDOS

CREATE SEQUENCE S_RCF_POA_POLITICA_ACUERDOS;

CREATE TABLE RCF_POA_POLITICA_ACUERDOS (
   RCF_POA_ID               NUMBER(16)                             NOT NULL,        
   RCF_POA_CODIGO            VARCHAR2(20 CHAR)                    NOT NULL,
   RCF_POA_NOMBRE            VARCHAR2(250 CHAR)                    NOT NULL,
   RCF_DD_ECM_ID            NUMBER(16)                            NOT NULL,
   USU_ID                    NUMBER(16)                            NOT NULL,
   VERSION                  INTEGER               DEFAULT 0     NOT NULL,
   USUARIOCREAR             VARCHAR2(10 CHAR)                   NOT NULL,
   FECHACREAR               TIMESTAMP(6)                        NOT NULL,
   USUARIOMODIFICAR         VARCHAR2(10 CHAR),
   FECHAMODIFICAR           TIMESTAMP(6),
   USUARIOBORRAR            VARCHAR2(10 CHAR),
   FECHABORRAR              TIMESTAMP(6),
   BORRADO                  NUMBER(1)            DEFAULT 0        NOT NULL,
   CONSTRAINT PK_RCF_POA_POLITICA_ACUERDOS PRIMARY KEY (RCF_POA_ID),
   CONSTRAINT FK_RCF_DD_ECM_POA FOREIGN KEY (RCF_DD_ECM_ID) REFERENCES RCF_DD_ECM_ESTADO_COMPONENT (RCF_DD_ECM_ID),
   CONSTRAINT FK_RCF_USU_POA FOREIGN KEY (USU_ID) REFERENCES &MASTER_SCHEMA..USU_USUARIOS (USU_ID)
 );

CREATE SEQUENCE S_RCF_TPP_TIPO_PALANCA;

CREATE TABLE RCF_TPP_TIPO_PALANCA (
   RCF_TPP_ID                  NUMBER(16)                             NOT NULL,        
   RCF_TPP_CODIGO            VARCHAR(15)                            NOT NULL ,   
   RCF_TPP_DESCRIPCION        VARCHAR(50),
   RCF_TPP_DESCRIPCION_LARGA     VARCHAR(250),
   VERSION                  INTEGER               DEFAULT 0     NOT NULL,
   USUARIOCREAR             VARCHAR2(10 CHAR)                   NOT NULL,
   FECHACREAR               TIMESTAMP(6)                        NOT NULL,
   USUARIOMODIFICAR         VARCHAR2(10 CHAR),
   FECHAMODIFICAR           TIMESTAMP(6),
   USUARIOBORRAR            VARCHAR2(10 CHAR),
   FECHABORRAR              TIMESTAMP(6),
   BORRADO                   NUMBER(1)            DEFAULT 0        NOT NULL,
   CONSTRAINT PK_RCF_TPP_TIPO_PALANCA PRIMARY KEY (RCF_TPP_ID ),
   CONSTRAINT UK_RCF_TPP_TIPO_PALANCA_COD UNIQUE (RCF_TPP_CODIGO)
 );

CREATE SEQUENCE S_RCF_STP_SUBTIPO_PALANCA;

CREATE TABLE RCF_STP_SUBTIPO_PALANCA (
   RCF_STP_ID                NUMBER(16)                         NOT NULL,        
   RCF_TPP_ID                NUMBER(16)                         NOT NULL,
   RCF_STP_CODIGO            VARCHAR(15)                        NOT NULL,
   RCF_STP_DESCRIPCION       VARCHAR(50),
   RCF_STP_DESCRIPCION_LARGA VARCHAR(250),
   VERSION                   INTEGER               DEFAULT 0    NOT NULL,
   USUARIOCREAR              VARCHAR2(10 CHAR)                  NOT NULL,
   FECHACREAR                TIMESTAMP(6)                       NOT NULL,
   USUARIOMODIFICAR          VARCHAR2(10 CHAR),
   FECHAMODIFICAR            TIMESTAMP(6),
   USUARIOBORRAR             VARCHAR2(10 CHAR),
   FECHABORRAR               TIMESTAMP(6),
   BORRADO                   NUMBER(1)            DEFAULT 0     NOT NULL,
   CONSTRAINT PK_RCF_STP_SUBTIPO_PALANCA PRIMARY KEY (RCF_STP_ID ),
   CONSTRAINT UK_RCF_STP_SUBTIPO_PALANCA_COD UNIQUE (RCF_STP_CODIGO),
   CONSTRAINT FK_RCF_STP_TPP FOREIGN KEY (RCF_TPP_ID) REFERENCES RCF_TPP_TIPO_PALANCA (RCF_TPP_ID)
 );
 
CREATE SEQUENCE S_RCF_PAA_POL_ACUER_PALANCAS;

CREATE TABLE RCF_PAA_POL_ACUERDOS_PALANCAS (
   RCF_PAA_ID               NUMBER(16)                         NOT NULL,        
   RCF_POA_ID               NUMBER(16)                         NOT NULL,
   RCF_STP_ID               NUMBER(16)                         NOT NULL,
   RCF_PAA_PRIORIDAD        INTEGER                            NOT NULL,
   DD_SIN_ID                NUMBER(16),    
   VERSION                  INTEGER               DEFAULT 0    NOT NULL,
   USUARIOCREAR             VARCHAR2(10 CHAR)                  NOT NULL,
   FECHACREAR               TIMESTAMP(6)                       NOT NULL,
   USUARIOMODIFICAR         VARCHAR2(10 CHAR),
   FECHAMODIFICAR           TIMESTAMP(6),
   USUARIOBORRAR            VARCHAR2(10 CHAR),
   FECHABORRAR              TIMESTAMP(6),
   BORRADO                   NUMBER(1)            DEFAULT 0    NOT NULL,
   CONSTRAINT PK_RCF_PAA_POL_ACUER_PALANCAS PRIMARY KEY (RCF_PAA_ID),
   CONSTRAINT FK_RCF_POL_STP FOREIGN KEY (RCF_STP_ID) REFERENCES RCF_STP_SUBTIPO_PALANCA (RCF_STP_ID)
 );

-- MODELOS DE RANKING
 
 CREATE SEQUENCE S_RCF_DD_VAR_VARIABLES_RANKING;
  
 CREATE TABLE RCF_DD_VAR_VARIABLES_RANKING (
   RCF_DD_VAR_ID                NUMBER(16)                         NOT NULL,        
   RCF_DD_VAR_CODIGO            VARCHAR2(15 CHAR)                  NOT NULL,
   RCF_DD_VAR_DESCRIPCION       VARCHAR2(50 CHAR)                  NOT NULL,
   RCF_DD_VAR_DESCRIPCION_LARGA    VARCHAR2(250 CHAR),
   VERSION                      INTEGER             DEFAULT 0    NOT NULL,
   USUARIOCREAR                 VARCHAR2(10 CHAR)               NOT NULL,
   FECHACREAR                   TIMESTAMP(6)                    NOT NULL,
   USUARIOMODIFICAR             VARCHAR2(10 CHAR),
   FECHAMODIFICAR               TIMESTAMP(6),
   USUARIOBORRAR                VARCHAR2(10 CHAR),
   FECHABORRAR                  TIMESTAMP(6),
   BORRADO                      NUMBER(1)           DEFAULT 0   NOT NULL,
   CONSTRAINT PK_RCF_DD_VAR_VARS_RANKING PRIMARY KEY (RCF_DD_VAR_ID ),
   CONSTRAINT UK_DD_VAR UNIQUE (RCF_DD_VAR_CODIGO)
 );
 
 CREATE SEQUENCE S_RCF_MOR_MODELO_RANKING;
 
 CREATE TABLE RCF_MOR_MODELO_RANKING (
    RCF_MOR_ID                  NUMBER(16)                      NOT NULL,        
    RCF_MOR_NOMBRE              VARCHAR2(250 CHAR)              NOT NULL,
    RCF_DD_ECM_ID                NUMBER(16)                        NOT NULL,
    USU_ID                        NUMBER(16)                        NOT NULL,
    VERSION                     INTEGER             DEFAULT 0   NOT NULL,
    USUARIOCREAR                VARCHAR2(10 CHAR)               NOT NULL,
    FECHACREAR                  TIMESTAMP(6)                    NOT NULL,
    USUARIOMODIFICAR            VARCHAR2(10 CHAR),
    FECHAMODIFICAR              TIMESTAMP(6),
    USUARIOBORRAR               VARCHAR2(10 CHAR),
    FECHABORRAR                 TIMESTAMP(6),
    BORRADO                     NUMBER(1)           DEFAULT 0   NOT NULL,
    CONSTRAINT PK_RCF_MOR_MODELO_RANKING PRIMARY KEY (RCF_MOR_ID),
    CONSTRAINT FK_RCF_DD_ECM_MOR FOREIGN KEY (RCF_DD_ECM_ID) REFERENCES RCF_DD_ECM_ESTADO_COMPONENT (RCF_DD_ECM_ID),
    CONSTRAINT FK_RCF_USU_MOR FOREIGN KEY (USU_ID) REFERENCES &MASTER_SCHEMA..USU_USUARIOS (USU_ID)
 );  
 
 CREATE SEQUENCE S_RCF_MRV_MODELO_RANKING_VARS;
 
 CREATE TABLE RCF_MRV_MODELO_RANKING_VARS (
    RCF_MRV_ID                  NUMBER(16)                         NOT NULL,
    RCF_MOR_ID                  NUMBER(16)                         NOT NULL,        
    RCF_DD_VAR_ID               INTEGER                            NOT NULL,
    RCF_MRV_COEFICIENTE            NUMBER(16,2),    
    VERSION                     INTEGER             DEFAULT 0   NOT NULL,
    USUARIOCREAR                VARCHAR2(10 CHAR)               NOT NULL,
    FECHACREAR                  TIMESTAMP(6)                    NOT NULL,
    USUARIOMODIFICAR            VARCHAR2(10 CHAR),
    FECHAMODIFICAR              TIMESTAMP(6),
    USUARIOBORRAR               VARCHAR2(10 CHAR),
    FECHABORRAR                 TIMESTAMP(6),
    BORRADO                     NUMBER(1)           DEFAULT 0   NOT NULL,
   CONSTRAINT PK_RCF_MRV_MODELO_RANKING_VARS PRIMARY KEY (RCF_MRV_ID),
   CONSTRAINT FK_RCF_MRV_MOR FOREIGN KEY (RCF_MOR_ID) REFERENCES RCF_MOR_MODELO_RANKING (RCF_MOR_ID),
   CONSTRAINT FK_RCF_MRV_VAR FOREIGN KEY (RCF_DD_VAR_ID) REFERENCES RCF_DD_VAR_VARIABLES_RANKING (RCF_DD_VAR_ID)
);  
 
-- TABLA SUBCARTERAS
 
 CREATE SEQUENCE S_RCF_SCA_SUBCARTERA;
 
 CREATE TABLE RCF_SCA_SUBCARTERA (
    RCF_SCA_ID              NUMBER(16)                     NOT NULL,        
    RCF_ESC_ID              NUMBER(16)                     NOT NULL,
    RCF_SCA_NOMBRE          VARCHAR2(250 CHAR)              NOT NULL,
    RCF_SCA_PARTICION       INTEGER                        NOT NULL,
    RCF_DD_TPR_ID           NUMBER(16)                     NOT NULL,
    RCF_ITV_ID              NUMBER(16),
    RCF_MFA_ID              NUMBER(16),
    RCF_POA_ID                NUMBER(16),
    RCF_MOR_ID                NUMBER(16),
    VERSION                 INTEGER             DEFAULT 0   NOT NULL,
    USUARIOCREAR            VARCHAR2(10 CHAR)               NOT NULL,
    FECHACREAR              TIMESTAMP(6)                    NOT NULL,
    USUARIOMODIFICAR        VARCHAR2(10 CHAR),
    FECHAMODIFICAR          TIMESTAMP(6),
    USUARIOBORRAR           VARCHAR2(10 CHAR),
    FECHABORRAR             TIMESTAMP(6),
    BORRADO                 NUMBER(1)           DEFAULT 0   NOT NULL,
    CONSTRAINT PK_RCF_SCA_SUBCARTERA PRIMARY KEY (RCF_SCA_ID),
    CONSTRAINT FK_RCF_SCA_ESC FOREIGN KEY (RCF_ESC_ID) REFERENCES RCF_ESC_ESQUEMA_CARTERAS (RCF_ESC_ID),
    CONSTRAINT FK_RCF_SCA_TPR FOREIGN KEY (RCF_DD_TPR_ID) REFERENCES RCF_DD_TPR_TIPO_REPARTO_SUBC (RCF_DD_TPR_ID),
    CONSTRAINT FK_RCF_SCA_MFA FOREIGN KEY (RCF_MFA_ID) REFERENCES RCF_MFA_MODELOS_FACTURACION (RCF_MFA_ID),
    CONSTRAINT FK_RCF_SCA_ITV FOREIGN KEY (RCF_ITV_ID) REFERENCES RCF_ITV_ITI_METAS_VOLANTES (RCF_ITV_ID),
    CONSTRAINT FK_RCF_SCA_POA FOREIGN KEY (RCF_POA_ID) REFERENCES RCF_POA_POLITICA_ACUERDOS (RCF_POA_ID),
    CONSTRAINT FK_RCF_SCA_MOR FOREIGN KEY (RCF_MOR_ID) REFERENCES RCF_MOR_MODELO_RANKING (RCF_MOR_ID)
 ); 
 
-- TABLA INTERMEDIA AGENCIAS-SUBCARTERAS
 
CREATE SEQUENCE S_RCF_SUA_SUBCARTERA_AGENCIAS;

CREATE TABLE RCF_SUA_SUBCARTERA_AGENCIAS (
   RCF_SUA_ID               NUMBER(16)                      NOT NULL,  
   RCF_AGE_ID               NUMBER(16)                      NOT NULL,        
   RCF_SCA_ID               NUMBER(16)                      NOT NULL,
   RCF_SUA_COEFICIENTE      INTEGER,
   VERSION                  INTEGER               DEFAULT 0 NOT NULL,
   USUARIOCREAR             VARCHAR2(10 CHAR)               NOT NULL,
   FECHACREAR               TIMESTAMP(6)                    NOT NULL,
   USUARIOMODIFICAR         VARCHAR2(10 CHAR),
   FECHAMODIFICAR           TIMESTAMP(6),
   USUARIOBORRAR            VARCHAR2(10 CHAR),
   FECHABORRAR              TIMESTAMP(6),
   BORRADO                   NUMBER(1)           DEFAULT 0    NOT NULL,
   CONSTRAINT PK_RCF_SUA_SUBCARTERA_AGENCIAS PRIMARY KEY (RCF_SUA_ID),   
   CONSTRAINT FK_RCF_SUA_AGE FOREIGN KEY (RCF_AGE_ID) REFERENCES RCF_AGE_AGENCIAS (RCF_AGE_ID),
   CONSTRAINT FK_RCF_SUA_SCA FOREIGN KEY (RCF_SCA_ID) REFERENCES RCF_SCA_SUBCARTERA (RCF_SCA_ID)
 );
 
 /*Comentado para poder insertar agencias borradas
  * CONSTRAINT UK_RCF_SUA_SUBCARTERA_AGENCIAS UNIQUE  (RCF_AGE_ID,RCF_SCA_ID ),
  * 
  */
 
CREATE SEQUENCE S_RCF_SUR_SUBCARTERA_RANKING;

CREATE TABLE RCF_SUR_SUBCARTERA_RANKING (
   RCF_SUR_ID               NUMBER(16)                      NOT NULL,  
   RCF_SCA_ID               NUMBER(16)                      NOT NULL,
   RCF_SUR_POSICION         INTEGER                         NOT NULL,
   RCF_SUR_PORCENTAJE        NUMBER(16),
   VERSION                  INTEGER               DEFAULT 0 NOT NULL,
   USUARIOCREAR             VARCHAR2(10 CHAR)               NOT NULL,
   FECHACREAR               TIMESTAMP(6)                    NOT NULL,
   USUARIOMODIFICAR         VARCHAR2(10 CHAR),
   FECHAMODIFICAR           TIMESTAMP(6),
   USUARIOBORRAR            VARCHAR2(10 CHAR),
   FECHABORRAR              TIMESTAMP(6),
   BORRADO                  NUMBER(1)           DEFAULT 0   NOT NULL,
   CONSTRAINT PK_RCF_SUR_SUBCARTERA_RANKING PRIMARY KEY ( RCF_SUR_ID ),
   CONSTRAINT FK_RCF_SUR_SUBCARTERA_RANKING FOREIGN KEY (RCF_SCA_ID) REFERENCES RCF_SCA_SUBCARTERA (RCF_SCA_ID)
 );

-- PROCESO DE FACTURACION
 
CREATE SEQUENCE S_RCF_DD_EPF_ESTADO_PROC_FAC;

CREATE TABLE RCF_DD_EPF_ESTADO_PROC_FAC (
    RCF_DD_EPF_ID                NUMBER(16)    NOT NULL,
    RCF_DD_EPF_CODIGO            VARCHAR2(20 CHAR)    NOT NULL,
    RCF_DD_EPF_DESCRIPCION       VARCHAR2(50 CHAR),
    RCF_DD_EPF_DESCRIPCION_LARGA VARCHAR(250 CHAR),
    VERSION                      INTEGER               DEFAULT 0 NOT NULL,
    USUARIOCREAR                 VARCHAR2(10 CHAR)               NOT NULL,
    FECHACREAR                   TIMESTAMP(6)                    NOT NULL,
    USUARIOMODIFICAR             VARCHAR2(10 CHAR),
    FECHAMODIFICAR               TIMESTAMP(6),
    USUARIOBORRAR                VARCHAR2(10 CHAR),
    FECHABORRAR                  TIMESTAMP(6),
    BORRADO                      NUMBER(1)           DEFAULT 0  NOT NULL,
    CONSTRAINT PK_RCF_DD_EPF_ESTADO_PROC_FAC PRIMARY KEY (RCF_DD_EPF_ID),
    CONSTRAINT UK_RCF_DD_EPF_ESTADO_PROC_FAC UNIQUE (RCF_DD_EPF_CODIGO)
);

CREATE SEQUENCE S_REA_RECOBRO_ADJUNTOS;

CREATE TABLE REA_RECOBRO_ADJUNTOS (
    REA_ID                NUMBER(16)            NOT NULL,
    REA_FILENAME        VARCHAR2 (250),
    REA_CONTENT_TYPE    VARCHAR2 (100),
    REA_LENGTH            NUMBER(16),
    REA_FILE            BLOB                 NOT NULL,
    REA_TIPO            VARCHAR2 (100),
    VERSION                 INTEGER                DEFAULT 0 NOT NULL,
    USUARIOCREAR            VARCHAR2(10 CHAR)     NOT NULL,
    FECHACREAR              TIMESTAMP(6)          NOT NULL,
    USUARIOMODIFICAR        VARCHAR2(10 CHAR),
    FECHAMODIFICAR          TIMESTAMP(6),
    USUARIOBORRAR           VARCHAR2(10 CHAR),
    FECHABORRAR             TIMESTAMP(6),
    BORRADO                 NUMBER(1)          DEFAULT 0  NOT NULL,
    CONSTRAINT PK_REA_RECOBRO_ADJUNTOS PRIMARY KEY (REA_ID)    
);

CREATE SEQUENCE S_PRF_PROCESO_FACTURACION;

CREATE TABLE PRF_PROCESO_FACTURACION (
    PRF_ID              NUMBER(16)            NOT NULL,
    PRF_NOMBRE          VARCHAR2 (250),
    PRF_FECHA_DESDE     TIMESTAMP(6)           NOT NULL,
    PRF_FECHA_HASTA     TIMESTAMP(6),
    USU_ID_CREAR        NUMBER(16)            NOT NULL,
    USU_ID_LIBERAR      NUMBER(16)  ,
    USU_ID_CANCELAR     NUMBER(16) ,
    PRF_FECHA_CREAR        TIMESTAMP(6),
    PRF_FECHA_LIBERAR    TIMESTAMP(6),
    PRF_FECHA_CANCELAR    TIMESTAMP(6),
    REA_ID                NUMBER(16),
    RCF_DD_EPF_ID       NUMBER(16)            NOT NULL,
    PRF_ERROR_BATCH     VARCHAR2(1024 CHAR),
    VERSION             INTEGER                DEFAULT 0 NOT NULL,
    USUARIOCREAR        VARCHAR2(10 CHAR)     NOT NULL,
    FECHACREAR          TIMESTAMP(6)          NOT NULL,
    USUARIOMODIFICAR    VARCHAR2(10 CHAR),
    FECHAMODIFICAR      TIMESTAMP(6),
    USUARIOBORRAR       VARCHAR2(10 CHAR),
    FECHABORRAR         TIMESTAMP(6),
    BORRADO             NUMBER(1)          DEFAULT 0  NOT NULL,
    CONSTRAINT PK_PRF_PROCESO_FACTURACION PRIMARY KEY (PRF_ID),
    CONSTRAINT FK_PRF_REA FOREIGN KEY (REA_ID) REFERENCES REA_RECOBRO_ADJUNTOS (REA_ID),
    CONSTRAINT FK_PRF_RPF FOREIGN KEY (RCF_DD_EPF_ID) REFERENCES RCF_DD_EPF_ESTADO_PROC_FAC (RCF_DD_EPF_ID)    
);

CREATE SEQUENCE S_PFS_PROC_FAC_SUBCARTERA;

CREATE TABLE PFS_PROC_FAC_SUBCARTERA (
    PFS_ID                    NUMBER(16)            NOT NULL,
    PRF_ID                    NUMBER(16)            NOT NULL,
    RCF_SCA_ID                NUMBER(16)            NOT NULL,
    RCF_MFA_ID_ORIGINAL        NUMBER(16)            NOT NULL,
    RCF_MFA_ID_ACTUAL        NUMBER(16),
    RCF_TOTAL_COBROS        NUMBER(16,2),
    RCF_TOTAL_FACTURABLE    NUMBER(16,2),
    VERSION                 INTEGER                DEFAULT 0 NOT NULL,
    USUARIOCREAR            VARCHAR2(10 CHAR)     NOT NULL,
    FECHACREAR              TIMESTAMP(6)          NOT NULL,
    USUARIOMODIFICAR        VARCHAR2(10 CHAR),
    FECHAMODIFICAR          TIMESTAMP(6),
    USUARIOBORRAR           VARCHAR2(10 CHAR),
    FECHABORRAR             TIMESTAMP(6),
    BORRADO                 NUMBER(1)          DEFAULT 0  NOT NULL,
    CONSTRAINT PK_PFS_PROC_FAC_SUBCARTERA PRIMARY KEY (PFS_ID),
    CONSTRAINT FK_PFS_PRF FOREIGN KEY (PRF_ID) REFERENCES PRF_PROCESO_FACTURACION (PRF_ID),
    CONSTRAINT FK_PFS_SCA FOREIGN KEY (RCF_SCA_ID) REFERENCES RCF_SCA_SUBCARTERA (RCF_SCA_ID),
    CONSTRAINT FK_PFS_MFA_ORIGINAL FOREIGN KEY (RCF_MFA_ID_ORIGINAL) REFERENCES RCF_MFA_MODELOS_FACTURACION (RCF_MFA_ID),
    CONSTRAINT FK_PFS_MFA_ACTUAL FOREIGN KEY (RCF_MFA_ID_ACTUAL) REFERENCES RCF_MFA_MODELOS_FACTURACION (RCF_MFA_ID)
);

CREATE SEQUENCE S_RDF_RECOBRO_DETALLE_FACTURA;

CREATE TABLE RDF_RECOBRO_DETALLE_FACTURA (
    RDF_ID                  NUMBER(16)          NOT NULL,
    PFS_ID                  NUMBER(16)          NOT NULL,
    CPA_ID                  NUMBER(16)          NOT NULL,
    CNT_ID                  NUMBER(16)          NOT NULL,
    EXP_ID                  NUMBER(16)          NOT NULL,
    RDF_FECHA_COBRO         TIMESTAMP(6)        NOT NULL,
    RDF_PORCENTAJE          NUMBER(16,2),
    RDF_IMPORTE_A_PAGAR     NUMBER(16,2)         NOT NULL,
    VERSION                 INTEGER             DEFAULT 0 NOT NULL,
    USUARIOCREAR            VARCHAR2(10 CHAR)   NOT NULL,
    FECHACREAR              TIMESTAMP(6)        NOT NULL,
    USUARIOMODIFICAR        VARCHAR2(10 CHAR),
    FECHAMODIFICAR          TIMESTAMP(6),
    USUARIOBORRAR           VARCHAR2(10 CHAR),
    FECHABORRAR             TIMESTAMP(6),
    BORRADO                 NUMBER(1)              DEFAULT 0  NOT NULL,
    CONSTRAINT PK_RDF_RECOBRO_DETALLE_FACTURA PRIMARY KEY (RDF_ID),
    CONSTRAINT FK_RDF_PFS FOREIGN KEY (PFS_ID) REFERENCES PFS_PROC_FAC_SUBCARTERA (PFS_ID),
    CONSTRAINT FK_RDF_CPA FOREIGN KEY (CPA_ID) REFERENCES CPA_COBROS_PAGOS (CPA_ID),
    CONSTRAINT FK_RDF_CNT FOREIGN KEY (CNT_ID) REFERENCES CNT_CONTRATOS (CNT_ID),
    CONSTRAINT FK_RDF_EXP FOREIGN KEY (EXP_ID) REFERENCES EXP_EXPEDIENTES (EXP_ID)
);

--DD estados simulación esquema
CREATE SEQUENCE S_RCF_DD_ESI_ESTADO_SIMULACION;

CREATE TABLE RCF_DD_ESI_ESTADO_SIMULACION
(
  RCF_DD_ESI_ID                 NUMBER(16)      NOT NULL,
  RCF_DD_ESI_CODIGO             VARCHAR2(20 CHAR) NOT NULL,
  RCF_DD_ESI_DESCRIPCION        VARCHAR2(100 CHAR),
  RCF_DD_ESI_DESCRIPCION_LARGA  VARCHAR2(250 CHAR),
  VERSION                       INTEGER         DEFAULT 0                     NOT NULL,
  USUARIOCREAR                  VARCHAR2(10 CHAR) NOT NULL,
  FECHACREAR                    TIMESTAMP(6)    NOT NULL,
  USUARIOMODIFICAR              VARCHAR2(10 CHAR),
  FECHAMODIFICAR                TIMESTAMP(6),
  USUARIOBORRAR                 VARCHAR2(10 CHAR),
  FECHABORRAR                   TIMESTAMP(6),
  BORRADO                       NUMBER(1)       DEFAULT 0                     NOT NULL,
   CONSTRAINT PK_RCF_DD_ESI_ESTADO_SIMU PRIMARY KEY (RCF_DD_ESI_ID ),
   CONSTRAINT UK_DD_ESI UNIQUE (RCF_DD_ESI_CODIGO)
);

CREATE SEQUENCE S_RCF_ESS_ESQUEMA_SIMULACION;

CREATE TABLE RCF_ESS_ESQUEMA_SIMULACION (
   RCF_ESS_ID                   NUMBER(16)                       NOT NULL,        
   RCF_ESQ_ID                   NUMBER(16)                       NOT NULL,
   RCF_DD_ESI_ID                   NUMBER(16)                       NOT NULL,
   RCF_ESS_FECHA_PETICION       TIMESTAMP(6),
   RCF_ESS_FECHA_RESULTADO      TIMESTAMP(6),
   REA_ID_RESUMEN                 NUMBER(16),
   REA_ID_DETALLE                 NUMBER(16),
   VERSION                      INTEGER                DEFAULT 0 NOT NULL,
   USUARIOCREAR                 VARCHAR2(10 CHAR)                NOT NULL,
   FECHACREAR                   TIMESTAMP(6)                     NOT NULL,
   USUARIOMODIFICAR             VARCHAR2(10 CHAR),
   FECHAMODIFICAR               TIMESTAMP(6),
   USUARIOBORRAR                VARCHAR2(10 CHAR),
   FECHABORRAR                  TIMESTAMP(6),
   BORRADO                      NUMBER(1)           DEFAULT 0     NOT NULL,
   CONSTRAINT PK_RCF_ESS_ESQUEMA_SIMULACION PRIMARY KEY (RCF_ESS_ID),
   CONSTRAINT FK_RCF_ESS_RCF_ESQ FOREIGN KEY (RCF_ESQ_ID) REFERENCES RCF_ESQ_ESQUEMA (RCF_ESQ_ID),
   CONSTRAINT FK_RCF_ESS_RCF_DD_ESI FOREIGN KEY (RCF_DD_ESI_ID) REFERENCES RCF_DD_ESI_ESTADO_SIMULACION (RCF_DD_ESI_ID),
   CONSTRAINT FK_RCF_ESS_REA_RESUMEN FOREIGN KEY (REA_ID_RESUMEN) REFERENCES REA_RECOBRO_ADJUNTOS (REA_ID),
   CONSTRAINT FK_RCF_ESS_REA_DETALLE FOREIGN KEY (REA_ID_DETALLE) REFERENCES REA_RECOBRO_ADJUNTOS (REA_ID)
 );
