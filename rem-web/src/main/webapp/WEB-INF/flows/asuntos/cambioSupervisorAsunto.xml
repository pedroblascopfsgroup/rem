<?xml version="1.0" encoding="UTF-8"?>
<flow xmlns="http://www.springframework.org/schema/webflow" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.springframework.org/schema/webflow http://www.springframework.org/schema/webflow/spring-webflow-2.0.xsd">

	<var name="dtoAsunto" class="es.capgemini.pfs.asunto.dto.DtoAsunto"/>
	
	<input name="idAsunto" type="java.lang.Long"/>
	<input name="cambioSupervisor" type="java.lang.Boolean"/>
	<input name="temporal" type="java.lang.Boolean"/>
		 	 
	<view-state id="formulario" view="asuntos/altaAsuntos">
    	<on-entry>
    		<evaluate expression="executor.execute('asuntosManager.get',idAsunto)" result="flowScope.asuntoEditar"></evaluate>
    		<evaluate expression="executor.execute('despachoExternoManager.getDespachosExternos')" result="flowScope.despachos" />
			<evaluate expression="executor.execute('zonaManager.getNiveles')" result="flowScope.niveles" />
			<evaluate expression="executor.execute('usuarioManager.getZonasUsuarioLogado')" result="flowScope.zonas" />
         
    	</on-entry>
        <transition on="saveAsunto" to="saveAsunto"/>
	</view-state> 	
	
    <end-state id="saveAsunto" view="default">
      <on-entry>    
        <evaluate expression="binder.bindAndValidate(flowRequestContext,dtoAsunto)" />
        <evaluate expression="executor.execute('asuntosManager.cambiarSupervisor',dtoAsunto,temporal)" result="flowScope.id"/>
      </on-entry>
    </end-state>
	
	
</flow>