<?xml version="1.0" encoding="UTF-8"?>
<flow xmlns="http://www.springframework.org/schema/webflow" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.springframework.org/schema/webflow http://www.springframework.org/schema/webflow/spring-webflow-2.0.xsd">

	<var name="dtoFicha" class="es.capgemini.pfs.asunto.dto.FichaAceptacionDto"/>
	<input name="id" type="java.lang.Long"/>

    <view-state id="formulario" view="asuntos/editarFichaAceptacionAsunto">
    	<on-entry>
    		<evaluate expression="executor.execute('asuntosManager.get',id)" result="flowScope.asunto" />
    		<evaluate expression="requestParameters.accion" result="flowScope.accion"></evaluate>
    	</on-entry>
    	<transition on="guardarFicha" to="guardarFicha"/>
	</view-state> 	

	<end-state id="guardarFicha" view="asuntos/returnJSON">
	  <on-entry>	
		<evaluate expression="binder.bindAndValidate(flowRequestContext,dtoFicha)" />
		<evaluate expression="executor.execute('asuntosManager.guardarFichaAceptacion',dtoFicha)" result="flowScope.id"/>
	  </on-entry>
	</end-state>
	
</flow>