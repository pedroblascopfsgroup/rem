set verify off;

define MASTER_SCHEMA = &Introduce_el_master_schema;

--
-- SCRIPT DE GENERACIÓN DEL MODELO DEL BATCH DE RECOBRO PARA EL MASTER SCHEMA
--

--OBSOLETO Tipo de expediente: Se usa el campo DD_TPX_ID (no definido aquí)
--ALTER TABLE EXP_EXPEDIENTES ADD DD_TPE_ID NUMBER(16) DEFAULT 1 NOT NULL;

--ALTER TABLE EXP_EXPEDIENTES ADD CONSTRAINT FK_EXP_EXPE_FK_DD_TPE_ID FOREIGN KEY (DD_TPE_ID) REFERENCES &MASTER_SCHEMA..DD_TPE_TIPO_EXPEDIENTE (DD_TPE_ID);

-- Tablas de interfaces de entrada/salida del batch
CREATE TABLE BATCH_RCF_ENTRADA (
RCF_ESQ_ID          		NUMBER(16) NOT NULL,
RCF_ESQ_PLAZO				INTEGER,
RCF_ESQ_FECHA_LIB			TIMESTAMP(6),
RCF_ESQ_BORRADO        		NUMBER(1) NOT NULL,
RCF_DD_EES_ID				NUMBER(16) NOT NULL,
RCF_DD_EES_CODIGO           VARCHAR2(20 CHAR) NOT NULL,
RCF_DD_EES_BORRADO     		NUMBER(1) NOT NULL,
RCF_DD_MTR_ID				NUMBER(16) NOT NULL,
RCF_DD_MTR_CODIGO           VARCHAR2(20 CHAR) NOT NULL,
RCF_DD_MTR_BORRADO     		NUMBER(1) NOT NULL,
RCF_CAR_ID					NUMBER(16) NOT NULL,
RCF_CAR_NOMBRE				VARCHAR2(50 CHAR) NOT NULL,
RCF_CAR_BORRADO        		NUMBER(1) NOT NULL,
RCF_DD_ECA_ID				NUMBER(16) NOT NULL,
RCF_DD_ECA_CODIGO           VARCHAR2(20 CHAR) NOT NULL,
RCF_DD_ECA_BORRADO     		NUMBER(1) NOT NULL,
RD_ID						NUMBER(16) NOT NULL,
RD_NAME						VARCHAR2(250 CHAR) NOT NULL,
RD_DEFINITION				VARCHAR2(4000 CHAR) NOT NULL,
RD_BORRADO					NUMBER(1) NOT NULL,
RCF_AGE_ID					NUMBER(16) NOT NULL,
RCF_AGE_NOMBRE				VARCHAR2(50 CHAR) NOT NULL,
RCF_AGE_CODIGO				VARCHAR2(10 CHAR) NOT NULL,
RCF_AGE_BORRADO        		NUMBER(1) NOT NULL,
RCF_ESC_ID					NUMBER(16) NOT NULL,
RCF_ESC_PRIORIDAD			NUMBER(16) NOT NULL,
RCF_ESC_BORRADO        		NUMBER(1) NOT NULL,
RCF_DD_TCE_ID               NUMBER(16) NOT NULL,        
RCF_DD_TCE_CODIGO           VARCHAR2(20 CHAR) NOT NULL,
RCF_DD_TCE_BORRADO     		NUMBER(1) NOT NULL,
RCF_DD_TGC_ID               NUMBER(16),        
RCF_DD_TGC_CODIGO           VARCHAR2(20 CHAR),
RCF_DD_TGC_BORRADO     		NUMBER(1),
RCF_DD_AER_ID               NUMBER(16),        
RCF_DD_AER_CODIGO           VARCHAR2(20 CHAR),
RCF_DD_AER_BORRADO     		NUMBER(1),
RCF_SCA_ID					NUMBER(16) NOT NULL,
RCF_SCA_NOMBRE				VARCHAR2(50 CHAR) NOT NULL,
RCF_SCA_PARTICION			INTEGER    NOT NULL,
RCF_SCA_BORRADO        		NUMBER(1) NOT NULL,
RCF_DD_TPR_ID               NUMBER(16) NOT NULL,        
RCF_DD_TPR_CODIGO           VARCHAR2(20 CHAR) NOT NULL,
RCF_DD_TPR_BORRADO     		NUMBER(1) NOT NULL,
RCF_ITV_ID                	NUMBER(16) NOT NULL,        
RCF_ITV_NOMBRE           	VARCHAR2(50 CHAR) NOT NULL,
RCF_ITV_FECHA_ALTA        	TIMESTAMP(6) NOT NULL,
RCF_ITV_PLAZO_MAX	       	NUMBER(8) DEFAULT 0 NOT NULL,
RCF_ITV_NO_GEST		 		NUMBER(8) DEFAULT 0 NOT NULL,
RCF_ITV_BORRADO        		NUMBER(1) NOT NULL,
RCF_MFA_ID               	NUMBER(16) NOT NULL,        
RCF_MFA_NOMBRE            	VARCHAR2(50 CHAR) NOT NULL,
RCF_MFA_BORRADO        		NUMBER(1) NOT NULL,
RCF_POA_ID 		           	NUMBER(16) NOT NULL,        
RCF_POA_CODIGO            	VARCHAR2(20 CHAR) NOT NULL,
RCF_POA_BORRADO        		NUMBER(1) NOT NULL,
RCF_MOR_ID                	NUMBER(16) NOT NULL,
RCF_MOR_NOMBRE              VARCHAR2(100 CHAR) NOT NULL,
RCF_MOR_BORRADO             NUMBER(1) NOT NULL,
RCF_SUA_ID					NUMBER(16),
RCF_SUA_COEFICIENTE			NUMBER(16,2),
RCF_SUA_BORRADO				NUMBER(1),
RCF_SUR_ID					NUMBER(16),
RCF_SUR_POSICION			NUMBER(16),
RCF_SUR_PORCENTAJE			NUMBER(16,2),
RCF_SUR_BORRADO				NUMBER(1)
);

CREATE TABLE BATCH_DATOS_EXCEPTUADOS (
PER_ID				NUMBER(16),
CNT_ID				NUMBER(16),
DD_MOB_ID			NUMBER(16) NOT NULL,
DD_MOB_CODIGO		VARCHAR2(50 CHAR) NOT NULL,
DD_MOB_BORRADO		NUMBER(1)  NOT NULL,
EXC_ID        NUMBER(16) NOT NULL
);

CREATE TABLE BATCH_DATOS_ENTRADA (
EXP_ID                    NUMBER(16) NOT NULL,
ARQ_ID                    NUMBER(16) NOT NULL,
EXP_PROCESS_BPM           NUMBER(16) NOT NULL,
EXP_MARCADO_BPM           NUMBER(1)  NOT NULL,
EXP_BORRADO               NUMBER(1)  NOT NULL,
DD_TPE_ID                 NUMBER(16) NOT NULL,
DD_TPE_CODIGO             VARCHAR2(50 CHAR) NOT NULL,
DD_TPE_BORRADO            NUMBER(1)  NOT NULL,
DD_EEX_ID                 NUMBER(16) NOT NULL,
DD_EEX_CODIGO             VARCHAR2(50 CHAR) NOT NULL,
DD_EEX_BORRADO            NUMBER(1)  NOT NULL,
RCF_ESQ_ID                NUMBER(16) NOT NULL,
RCF_CAR_ID                NUMBER(16) NOT NULL,
RCF_AGE_ID                NUMBER(16) NOT NULL,
RCF_SCA_ID                NUMBER(16) NOT NULL
);

CREATE TABLE BATCH_DATOS_EXP (
			EXP_ID                    NUMBER(16) NOT NULL,
			ARQ_ID                    NUMBER(16) NOT NULL,
			EXP_BORRADO               NUMBER(1)  NOT NULL,
			DD_TPE_CODIGO             VARCHAR2(50 CHAR) NOT NULL,
			DD_EEX_CODIGO             VARCHAR2(50 CHAR) NOT NULL,
			RCF_ESQ_ID                NUMBER(16) NOT NULL,
			RCF_AGE_ID      		      NUMBER(16) NOT NULL,
      RCF_SCA_ID      		      NUMBER(16) NOT NULL,
      EXP_MARCADO_BPM			      NUMBER(1),
      EXP_MANUAL    			      NUMBER(1)
);

CREATE TABLE BATCH_DATOS_EXP_MANUAL (
			EXP_ID                    NUMBER(16) NOT NULL,
			ARQ_ID                    NUMBER(16) NOT NULL,
			EXP_BORRADO               NUMBER(1)  NOT NULL,
			DD_TPE_CODIGO             VARCHAR2(50 CHAR) NOT NULL,
			DD_EEX_CODIGO             VARCHAR2(50 CHAR) NOT NULL,
			RCF_ESQ_ID                NUMBER(16) NOT NULL,
			RCF_AGE_ID      		      NUMBER(16) NOT NULL,
      RCF_SCA_ID      		      NUMBER(16) NOT NULL,
      EXP_MARCADO_BPM			      NUMBER(1),
      EXP_MANUAL    			      NUMBER(1)
);

CREATE TABLE BATCH_DATOS_CNT (
				CNT_ID NUMBER(16) NOT NULL,
        OFI_ID NUMBER(16,2) NOT NULL,
				CNT_RIESGO NUMBER(14,2) NOT NULL
);

CREATE TABLE BATCH_DATOS_PER (
    PER_ID  NUMBER(16) NOT NULL,
		PER_NOMBRE VARCHAR2(100 CHAR) NOT NULL,
		PER_APELLIDO1 VARCHAR2(100 CHAR) NOT NULL,
		PER_APELLIDO2 VARCHAR2(100 CHAR) NOT NULL,
    PER_DEUDA_IRREGULAR NUMBER(14,2),
    PER_RIESGO_DIRECTO NUMBER(14, 2),
    PER_RIESGO_INDIRECTO NUMBER(14,2)
);

CREATE TABLE BATCH_DATOS_GCL (
  GCL_ID NUMBER(16) NOT NULL,
  PER_ID NUMBER(16) NOT NULL
);

CREATE TABLE BATCH_DATOS_PER_EXP (
				EXP_ID NUMBER(16) NOT NULL,
				PER_ID NUMBER(16) NOT NULL
);

CREATE TABLE BATCH_DATOS_CNT_EXP (
				EXP_ID NUMBER(16) NOT NULL,
				CNT_ID NUMBER(16) NOT NULL
);

CREATE TABLE BATCH_DATOS_CNT_PER (
				CNT_ID NUMBER(16) NOT NULL,
				PER_ID NUMBER(16) NOT NULL,
				CNT_PER_TIN	VARCHAR(10 CHAR) NOT NULL,
				CNT_PER_OIN NUMBER(2) NOT NULL
);

CREATE TABLE BATCH_DATOS_CLI (
				CLI_ID NUMBER(16) NOT NULL,
				PER_ID NUMBER(16) NOT NULL
);

CREATE TABLE BATCH_DATOS_SALIDA (
EXP_ID				NUMBER(16) NOT NULL,
EXP_DESCRIPCION		VARCHAR2(310 CHAR),
EXP_MANUAL			NUMBER(1) NOT NULL,
DD_AEX_CODIGO			VARCHAR2(10 CHAR) NOT NULL,
DD_EEX_ID			NUMBER(16),
DD_EST_ID			NUMBER(16),
EXP_FECHA_EST_ID	TIMESTAMP(6) NOT NULL,
OFI_ID				NUMBER(16) NOT NULL,
CNT_ID				NUMBER(16) NOT NULL,
PER_ID				NUMBER(16) NOT NULL,
ARQ_ID				NUMBER(16) NOT NULL,
CEX_PASE			NUMBER(1),
PEX_PASE			NUMBER(1) 
);



-- Arquetipo de recobro de la persona
create table ARP_ARQ_RECOBRO_PERSONA (
  ARP_ID NUMBER(16)
  , PER_ID NUMBER(16)
  , ARQ_ID NUMBER(16)
  , ARQ_NAME VARCHAR2(100 CHAR)
  , ARQ_PRIO NUMBER(16)
  , ARQ_DATE TIMESTAMP(6)
  , VERSION NUMBER(1) DEFAULT 0
	, USUARIOCREAR VARCHAR2(10 CHAR) NOT NULL
	, FECHACREAR TIMESTAMP DEFAULT SYSDATE NOT NULL
	, USUARIOMODIFICAR VARCHAR2(10 CHAR)
	, FECHAMODIFICAR TIMESTAMP (6)
	, USUARIOBORRAR VARCHAR2(10 CHAR)
	, FECHABORRAR TIMESTAMP (6)
  , BORRADO NUMBER(1) DEFAULT 0 NOT NULL
);

CREATE SEQUENCE  S_ARP_ARQ_RECOBRO_PERSONA  INCREMENT BY 1 START WITH 1;

-- Proceso de marcado de expedientes
CREATE TABLE TMP_REC_EXP_ACTIVOS (
  EXP_ID          NUMBER(16) NOT NULL,
  ARQ_ID          NUMBER(16) NOT NULL,
	RCF_ESQ_ID      NUMBER(16) NOT NULL,
	RCF_AGE_ID      NUMBER(16) NOT NULL
);

CREATE TABLE TMP_REC_EXP_EXTINCION (
        EXP_ID          NUMBER(16) NOT NULL,
				ARQ_ID          NUMBER(16) NOT NULL,
				RCF_ESQ_ID      NUMBER(16) NOT NULL,
				RCF_AGE_ID      NUMBER(16) NOT NULL
);

CREATE TABLE TMP_REC_EXP_EXTINCION_RU (
  EXP_ID NUMBER(16) NOT NULL
);

CREATE TABLE TMP_REC_EXP_EXTINCION_RA (
  EXP_ID NUMBER(16) NOT NULL,
  RCF_AGE_ID NUMBER(16) NOT NULL,
  ARQ_ID NUMBER(16) NOT NULL
);


-- Proceso de limpieza de expedientes
CREATE TABLE TMP_REC_EXP_SIN_PERSONAS (
  EXP_ID NUMBER(16) NOT NULL
);

CREATE TABLE TMP_REC_EXP_SIN_CONTRATOS (
  EXP_ID NUMBER(16) NOT NULL
);

CREATE TABLE TMP_REC_EXP_SIN_RIESGOS (
  EXP_ID NUMBER(16) NOT NULL
);

CREATE TABLE TMP_REC_EXP_CANCELADOS (
  EXP_ID NUMBER(16) NOT NULL
);


-- Proceso de revisión de expedientes activos
CREATE TABLE TMP_REC_EXP_MARCADO_RA (
  EXP_ID NUMBER(16) NOT NULL,
  RCF_AGE_ID NUMBER(16) NOT NULL,
  ARQ_ID NUMBER(16) NOT NULL
);

CREATE TABLE TMP_REC_EXP_DESNORMALIZADO (
  EXP_ID NUMBER(16) NOT NULL,
  PER_ID NUMBER(16) NOT NULL,
  CNT_ID NUMBER(16) NOT NULL,
  ARQ_ID NUMBER(16) NOT NULL,
  RCF_AGE_ID NUMBER(16) NOT NULL,
  RCF_SCA_ID NUMBER(16) NOT NULL
);

-- Proceso de rearquetipación de expedientes
CREATE VIEW TMP_REC_PER_DATA_RULE_ENGINE AS
  SELECT * FROM DATA_RULE_ENGINE
  WHERE PER_ID IN (
    SELECT DISTINCT(PER_ID) FROM TMP_REC_EXP_DESNORMALIZADO
);

CREATE TABLE TMP_REC_EXP_DESNORMALIZADO_ARQ (
  EXP_ID NUMBER(16) NOT NULL,
  PER_ID NUMBER(16) NOT NULL,
  RCF_AGE_ID NUMBER(16) NOT NULL,
  RCF_SCA_ID NUMBER(16) NOT NULL,
  ARQ_ID_OLD NUMBER(16) NOT NULL,
  ARQ_ID_NEW NUMBER(16)
);

CREATE TABLE TMP_REC_EXP_REARQUETIPADO (
  EXP_ID NUMBER(16) NOT NULL,
  RCF_AGE_ID NUMBER(16) NOT NULL,
  RCF_SCA_ID NUMBER(16) NOT NULL,
  ARQ_ID_OLD NUMBER(16) NOT NULL,
  ARQ_ID_NEW NUMBER(16)
);

CREATE TABLE TMP_REC_EXP_ASIG_CARTERA (
  EXP_ID NUMBER(16) NOT NULL,
  ARQ_ID_NEW NUMBER(16) NOT NULL
);

CREATE TABLE TMP_REC_EXP_ROTACION (
  EXP_ID NUMBER(16) NOT NULL,
  RCF_AGE_ID NUMBER(16) NOT NULL,
  RCF_SCA_ID NUMBER(16) NOT NULL,
  ARQ_ID_NEW NUMBER(16) NOT NULL
);

-- Proceso de arquetipado
CREATE TABLE TMP_REC_CNT_LIBRES (
  CNT_ID NUMBER(16) NOT NULL,
  PER_ID NUMBER(16) NOT NULL
);

CREATE VIEW TMP_REC_DATA_RULE_ENGINE AS
  SELECT *
  FROM DATA_RULE_ENGINE
  WHERE PER_ID IN (
    SELECT DISTINCT(PER_ID) FROM TMP_REC_CNT_LIBRES
);

CREATE TABLE TMP_REC_CNT_LIBRES_PER_ARQ (
  PER_ID NUMBER(16) NOT NULL,
  ARQ_ID NUMBER(16) NOT NULL
);

CREATE TABLE TMP_REC_CNT_LIBRES_DES_ARQ (
  CNT_ID NUMBER(16) NOT NULL,
  PER_ID NUMBER(16) NOT NULL,
  ARQ_ID NUMBER(16)
);

CREATE TABLE TMP_REC_NUEVOS_CLI (
  CNT_ID NUMBER(16) NOT NULL,
  PER_ID NUMBER(16) NOT NULL,
  ARQ_ID NUMBER(16)
);

CREATE TABLE TMP_REC_CNT_LIBRES_DES_ARQ_REC (
  CNT_ID NUMBER(16) NOT NULL,
  PER_ID NUMBER(16) NOT NULL,
  ARQ_ID NUMBER(16) NOT NULL,
  MOV_RIESGO NUMBER(14,2) NOT NULL
);

CREATE TABLE TMP_REC_CNT_LIBRES_ARQ_REC (
  CNT_ID NUMBER(16) NOT NULL,
  PER_ID NUMBER(16) NOT NULL,
  ARQ_ID NUMBER(16) NOT NULL,
  MOV_RIESGO NUMBER(14,2) NOT NULL
);

CREATE TABLE TMP_REC_CNT_LIBRES_DES_ARQ_ORD (
  CNT_ID          	NUMBER(16) NOT NULL,
	PER_ID          	NUMBER(16) NOT NULL,
	ARQ_ID            	NUMBER(16) NOT NULL,
	MOV_RIESGO          NUMBER(14,2) NOT NULL
);

CREATE TABLE TMP_REC_CNT_LIBRES_ARQ_REC_PRI (
  CNT_ID          NUMBER(16) NOT NULL,
  PER_ID          NUMBER(16) NOT NULL,
  ARQ_ID	    NUMBER(16) NOT NULL,
  MOV_RIESGO	    NUMBER(14,2) NOT NULL
);

-- Proceso de generación de expedientes
CREATE TABLE TMP_REC_CNT_LIBRES_ARQ_REC_EXT (
  ORD_ID						NUMBER(16) NOT NULL,
	CNT_ID          			NUMBER(16) NOT NULL,
	PER_ID          			NUMBER(16) NOT NULL,
	ARQ_ID	    				NUMBER(16) NOT NULL,
	OFI_ID	    				NUMBER(16) NOT NULL,
	MOV_RIESGO	    			NUMBER(14,2) NOT NULL,
	PER_NOMBRE 					VARCHAR2(100 char) NOT NULL,
	PER_APELLIDO1				VARCHAR2(100 char),
	PER_APELLIDO2				VARCHAR2(100 char),
	DD_TIN_CODIGO    			VARCHAR2(8 char) NOT NULL,
	CPE_ORDEN	    			INTEGER NOT NULL,  
	RCF_DD_AER_CODIGO          	VARCHAR2(20 CHAR)
);

-- Proceso de reparto
CREATE TABLE TMP_REC_EXP_REPARTO_CAR (
	EXP_ID          NUMBER(16) NOT NULL,
	CAR_ID          NUMBER(16) NOT NULL
);

CREATE TABLE TMP_REC_EXP_REPARTO_CAR_VRE (
	EXP_ID          NUMBER(16) NOT NULL,
	CAR_ID          NUMBER(16) NOT NULL,
	RCF_SCA_ID      NUMBER(16),
	VRE			    NUMBER(16,2) NOT NULL
);

CREATE TABLE TMP_REC_EXP_REPARTO_SUB (
	EXP_ID          NUMBER(16) NOT NULL,
	CAR_ID          NUMBER(16) NOT NULL,
	RCF_SCA_ID      NUMBER(16) NOT NULL,
	RCF_AGE_ID_OLD  NUMBER(16),
	VRE			    NUMBER(16,2) NOT NULL
);

CREATE TABLE TMP_REC_EXP_REPARTO_AGENCIAS (
	EXP_ID          NUMBER(16) NOT NULL,
	CAR_ID          NUMBER(16) NOT NULL,
	RCF_SCA_ID      NUMBER(16) NOT NULL,
	RCF_AGE_ID	    NUMBER(16) NOT NULL,
	VRE			    NUMBER(16,2) NOT NULL
);

-- Proceso persistencia previo envío
CREATE TABLE TMP_REC_EXP_AGE_MAR (
	RCF_AGE_ID   	NUMBER(16) NOT NULL,
	RCF_SCA_ID   	NUMBER(16) NOT NULL, 
	EXP_ID      	NUMBER(16) NOT NULL,
	PER_ID      	NUMBER(16) NOT NULL
);

CREATE TABLE TMP_REC_EXP_AGE_PER_EXC (
	RCF_AGE_ID   	NUMBER(16) NOT NULL, 
	RCF_SCA_ID   	NUMBER(16) NOT NULL,	
	EXP_ID      	NUMBER(16) NOT NULL,
	PER_ID      	NUMBER(16) NOT NULL
);

CREATE TABLE TMP_REC_EXP_AGE_MAR_EXC (
	RCF_AGE_ID   	NUMBER(16) NOT NULL,
	RCF_SCA_ID   	NUMBER(16) NOT NULL, 
	EXP_ID      	NUMBER(16) NOT NULL,
	PER_ID      	NUMBER(16) NOT NULL
);

CREATE TABLE TMP_REC_EXP_AGE_MAR_GES (
	RCF_AGE_ID   	NUMBER(16) NOT NULL, 
	RCF_SCA_ID   	NUMBER(16) NOT NULL,
	EXP_ID      	NUMBER(16) NOT NULL,
	PER_ID      	NUMBER(16) NOT NULL,
	GES_ID      	INTEGER NOT NULL
);

CREATE TABLE TMP_REC_EXP_AGE_CNT (
	RCF_AGE_ID   	NUMBER(16) NOT NULL, 
	RCF_SCA_ID   	NUMBER(16) NOT NULL,
	EXP_ID      	NUMBER(16) NOT NULL,
	PER_ID      	NUMBER(16) NOT NULL,
	CNT_ID      	NUMBER(16) NOT NULL,
	GES_ID      	INTEGER NOT NULL
);

CREATE TABLE TMP_REC_EXP_AGE_CNT_EXC (
	RCF_AGE_ID   	NUMBER(16) NOT NULL, 
	RCF_SCA_ID   	NUMBER(16) NOT NULL,
	EXP_ID      	NUMBER(16) NOT NULL,
	PER_ID      	NUMBER(16) NOT NULL,
	CNT_ID      	NUMBER(16) NOT NULL,
	GES_ID      	INTEGER NOT NULL
);

CREATE TABLE TMP_REC_CONTRATOS_CONS_BAJA (
	EXP_ID          NUMBER(16) NOT NULL,
	CNT_ID          NUMBER(16) NOT NULL,
    RCF_AGE_ID      NUMBER(16) NOT NULL
);

CREATE TABLE TMP_REC_CONTRATOS_BAJA (
	CNT_ID          NUMBER(17) NOT NULL,
    RCF_AGE_ID      NUMBER(16) NOT NULL
);

CREATE TABLE TMP_REC_CONTRATOS_BAJA_MOT (
	CNT_ID          NUMBER(17) NOT NULL,
    RCF_AGE_ID      NUMBER(16) NOT NULL,
	DD_MOB_ID       NUMBER(16) DEFAULT 2 NOT NULL
);

CREATE TABLE TMP_REC_FICHERO_CONTRATOS (
	RCF_AGE_ID      			NUMBER(16) NOT NULL,
	RCF_SCA_ID   				NUMBER(16) NOT NULL,
	CNT_ENV_ID      			NUMBER(22) NOT NULL,
	CNT_COD_PROPIETARIO			NUMBER(5) NOT NULL,
	DD_TPR_CODIGO				VARCHAR2(5 CHAR) NOT NULL,
	CNT_CONTRATO				NUMBER(17) NOT NULL
);


-- Tablas para ficheros de envío agencias
CREATE TABLE REC_FICHERO_CONTRATOS (
	RCF_AGE_ID      			NUMBER(16) NOT NULL,
  RCF_SCA_ID      			NUMBER(16) NOT NULL,
	ID_ENVIO      			NUMBER(24) NOT NULL,
	ID_EXPEDIENTE          			NUMBER(16) NOT NULL,
  ID_CARTERA          NUMBER(16) NOT NULL,
	CARTERA_EXPEDIENTE			VARCHAR2(255 CHAR) NOT NULL,
	CODIGO_ENTIDAD 			NUMBER(27) NOT NULL,
	COD_ENTIDAD_OFI_ADMIN	NUMBER(5) NOT NULL,
	COD_OFI_ADMIN			NUMBER(4) NOT NULL,
	DIR_OFI_ADMIN			VARCHAR2(255 CHAR) NOT NULL,
	CODIGO_PROPIETARIO			NUMBER(5) NOT NULL,
	TIPO_PRODUCTO				VARCHAR2(5 CHAR) NOT NULL,
	NUMERO_CONTRATO				NUMBER(17) NOT NULL,
	NUMERO_ESPEC			NUMBER(15) NOT NULL,
	IBAN_CONTRATO					VARCHAR2(24 CHAR),
	CNT_DOMICILIACION		VARCHAR2(20 CHAR),
	IBAN_CNT_DOMICILIACION			VARCHAR2(24 CHAR),
  CD_SITUACION_CONTABLE     VARCHAR2(3 CHAR) NOT NULL,
	SITUACION_CONTABLE				VARCHAR2(25 CHAR) NOT NULL,
	POS_VIVA_NO_VENCIDA		NUMBER(14,2) NOT NULL,
	POS_VIVA_VENCIDA		NUMBER(14,2) NOT NULL,
	INT_ORDIN_DEVEN		NUMBER(14,2) NOT NULL,
	INT_MORAT_DEVEN			NUMBER(14,2) NOT NULL,
	COMISIONES				NUMBER(14,2) NOT NULL,
	GASTOS					NUMBER(14,2) NOT NULL,
	IMPUESTOS				NUMBER(14,2),
	ENTREGAS				NUMBER(14,2) NOT NULL,
	INT_ENTREGAS			NUMBER(14,2) NOT NULL,
	DEUDA_IRREGULAR			NUMBER(14,2) NOT NULL,
	LIMITE_INICIAL			NUMBER(14,2) NOT NULL,
	LIMITE_ACTUAL			NUMBER(14,2) NOT NULL,
	FECHA_CREACION			TIMESTAMP NOT NULL,
	FECHA_INI_IRREGU		TIMESTAMP,
	FECHA_POS_VENCIDA		TIMESTAMP NOT NULL,
  CD_PRODUCTO_COMERCIAL VARCHAR2(5 CHAR) NOT NULL,
	CATALOGO1	VARCHAR2(1024 CHAR) NOT NULL,
  CD_PRODUCTO_URSUS VARCHAR2(5 CHAR) NOT NULL,
	CATALOGO2	VARCHAR2(1024 CHAR) NOT NULL,
	CATALOGO3	VARCHAR2(1024 CHAR) NOT NULL,
	CATALOGO4	VARCHAR2(1024 CHAR) NOT NULL,
	CATALOGO5	VARCHAR2(1024 CHAR) NOT NULL,
	CATALOGO6	VARCHAR2(1024 CHAR) NOT NULL,
  CD_GARANTIA1    NUMBER(4),
	GARANTIA1			VARCHAR2(255 CHAR),
  CD_GARANTIA2    NUMBER(4),
	GARANTIA2			VARCHAR2(255 CHAR),
	CONTACTO_ENTIDAD_NOMBRE	VARCHAR2(255 CHAR),
	CONTACTO_ENTIDAD_TEL	VARCHAR2(25 CHAR),
	CONTACTO_ENTIDAD_EMAIL	VARCHAR2(255 CHAR),
	SITUACION_GESTION			VARCHAR2(50 CHAR),
	CUOTA_IMPORTE			NUMBER(14,2),
	CUOTA_PERIODICIDAD		NUMBER(3),
  CD_FINALIDAD      VARCHAR2(4 CHAR),
	DESC_OFICIAL_FINALIDAD		VARCHAR2(255 CHAR),
	FECHA_VENCIMIENTO				TIMESTAMP NOT NULL,
  CD_SISTEMA_AMORTIZACION VARCHAR2(4 CHAR),
	SISTEMA_AMORTIZACION	VARCHAR2(255 CHAR),
	TIPO_INTERES	NUMBER(7,5) NOT NULL,
  FECHA_MAX_COBRO_PARCIAL TIMESTAMP,
  FECHA_MAX_REGULARIZACION TIMESTAMP NOT NULL,
	FECHA_EXTRA1			TIMESTAMP,
	FECHA_EXTRA2			TIMESTAMP,
	FECHA_EXTRA3			TIMESTAMP,
	FECHA_EXTRA4			TIMESTAMP,
	FECHA_EXTRA5			TIMESTAMP,
	FECHA_EXTRA6			TIMESTAMP,
	FECHA_EXTRA7			TIMESTAMP,
	FECHA_EXTRA8			TIMESTAMP,
	FECHA_EXTRA9			TIMESTAMP,
	FECHA_EXTRA10			TIMESTAMP,
	NUMERO_EXTRA1			NUMBER(14,2),
	NUMERO_EXTRA2			NUMBER(14,2),
	NUMERO_EXTRA3			NUMBER(14,2),
	NUMERO_EXTRA4			NUMBER(14,2),
	NUMERO_EXTRA5			NUMBER(14,2),
	NUMERO_EXTRA6			NUMBER(14,2),
	NUMERO_EXTRA7			NUMBER(14,2),
	NUMERO_EXTRA8			NUMBER(14,2),
	NUMERO_EXTRA9			NUMBER(14,2),
	NUMERO_EXTRA10			NUMBER(14,2),
	LCHAR_EXTRA1			VARCHAR2(250 CHAR),
	LCHAR_EXTRA2			VARCHAR2(250 CHAR),
	LCHAR_EXTRA3			VARCHAR2(250 CHAR),
	LCHAR_EXTRA4			VARCHAR2(250 CHAR),
	LCHAR_EXTRA5			VARCHAR2(250 CHAR),
	LCHAR_EXTRA6			VARCHAR2(250 CHAR),
	LCHAR_EXTRA7			VARCHAR2(250 CHAR),
	LCHAR_EXTRA8			VARCHAR2(250 CHAR),
	LCHAR_EXTRA9			VARCHAR2(250 CHAR),
	LCHAR_EXTRA10			VARCHAR2(250 CHAR)
);

CREATE TABLE REC_FICHERO_PERSONAS (
	RCF_AGE_ID				NUMBER(16) NOT NULL,
	CODIGO_PROPIETARIO	NUMBER(5) NOT NULL,
	CODIGO_PERSONA				NUMBER(16) NOT NULL,
	TIPO_PERSONA			NUMBER(1) NOT NULL,
	TIPO_DOCUMENTO		VARCHAR2(20 CHAR) NOT NULL,
  DS_TIPO_DOCUMENTO  VARCHAR2(20 CHAR) NOT NULL,
	NIF_CIF_PASAP_NIE				VARCHAR2(20 CHAR) NOT NULL,
	NOMBRE				VARCHAR2(100 CHAR) NOT NULL,
	APELLIDO1			VARCHAR2(100 CHAR),
	APELLIDO2			VARCHAR2(100 CHAR),
  CD_SEGMENTO_CLIENTE_1 VARCHAR2(10 CHAR) NOT NULL,
	SEGMENTO_CLIENTE_1		VARCHAR2(255 CHAR) NOT NULL,
	FECHA_CONSTITUCION		TIMESTAMP(6),
	FECHA_NACIMIENTO		TIMESTAMP(6),
  CD_NACIONALIDAD   VARCHAR2(3 CHAR),
	NACIONALIDAD	VARCHAR2(255 CHAR),
	SEXO	VARCHAR2(255 CHAR),
	CORREO_ELECTRONICO				VARCHAR2(255 CHAR),
	SALDO_PASIVO			NUMBER(14,2) NOT NULL,
	RIESGO_DIRECTO				NUMBER(14,2) NOT NULL,
	RIESGO_INDIRECTO			NUMBER(14,2) NOT NULL,
	RIESGO_DIRECTO_REGULAR		NUMBER(14,2) NOT NULL,
	RIESGO_INDIRECTO_IRREGULAR		NUMBER(14,2) NOT NULL,
	RIESG_DIRECT_IRREG_GRUPO		NUMBER(14,2),
	RIESG_INDIRECT_IRREG_GRUPO		NUMBER(14,2),
	ULTIMA_ACTUACION		VARCHAR2(1024 CHAR) NOT NULL,
	GESTION_COMPARTIDA		VARCHAR2(2 CHAR) NOT NULL,
	FECHA_EXTRA1			TIMESTAMP(6),
	FECHA_EXTRA2			TIMESTAMP(6),
	FECHA_EXTRA3			TIMESTAMP(6),
	FECHA_EXTRA4			TIMESTAMP(6),
	FECHA_EXTRA5			TIMESTAMP(6),
	NUMERO_EXTRA1				NUMBER(14,2),
	NUMERO_EXTRA2				NUMBER(14,2),
  NUMERO_EXTRA3				NUMBER(14,2),
  NUMERO_EXTRA4				NUMBER(14,2),
  NUMERO_EXTRA5				NUMBER(14,2),
	LCHAR_EXTRA1			VARCHAR2(250 CHAR),
	LCHAR_EXTRA2			VARCHAR2(250 CHAR),
	LCHAR_EXTRA3			VARCHAR2(250 CHAR),
	LCHAR_EXTRA4			VARCHAR2(250 CHAR),
	LCHAR_EXTRA5      VARCHAR2(250 CHAR)
);

CREATE TABLE REC_FICHERO_CONTRATOS_PERSONAS (
	RCF_AGE_ID				NUMBER(16) NOT NULL,
	ID_ENVIO			NUMBER(24) NOT NULL,
	CODIGO_PROPIETARIO	NUMBER(5) NOT NULL,
	CODIGO_PERSONA				NUMBER(16) NOT NULL,
  CD_TIPO_INTERVENCION  VARCHAR2(10 CHAR) NOT NULL,
	TIPO_INTERVENCION	VARCHAR2(255 CHAR) NOT NULL,
	ORDEN				NUMBER(4) NOT NULL,
	FECHA_EXTRA1			TIMESTAMP(6),
	FECHA_EXTRA2			TIMESTAMP(6),
	FECHA_EXTRA3			TIMESTAMP(6),
	FECHA_EXTRA4			TIMESTAMP(6),
	FECHA_EXTRA5			TIMESTAMP(6),
	NUMERO_EXTRA1				NUMBER(14,2),
	NUMERO_EXTRA2				NUMBER(14,2),
  NUMERO_EXTRA3				NUMBER(14,2),
  NUMERO_EXTRA4				NUMBER(14,2),
  NUMERO_EXTRA5				NUMBER(14,2),
	LCHAR_EXTRA1			VARCHAR2(250 CHAR),
	LCHAR_EXTRA2			VARCHAR2(250 CHAR),
	LCHAR_EXTRA3			VARCHAR2(250 CHAR),
	LCHAR_EXTRA4			VARCHAR2(250 CHAR),
	LCHAR_EXTRA5      VARCHAR2(250 CHAR)
);

CREATE TABLE REC_FICHERO_CONTRATOS_BAJAS (
	RCF_AGE_ID				NUMBER(16) NOT NULL,
	ID_ENVIO      			NUMBER(24) NOT NULL, 
	FECHA_BAJA			TIMESTAMP(6) NOT NULL,
	MOTIVO_BAJA	VARCHAR2(10 CHAR) NOT NULL,
	FECHA_EXTRA1			TIMESTAMP(6),
	FECHA_EXTRA2			TIMESTAMP(6),
	FECHA_EXTRA3			TIMESTAMP(6),
	FECHA_EXTRA4			TIMESTAMP(6),
	FECHA_EXTRA5			TIMESTAMP(6),
	NUMERO_EXTRA1				NUMBER(14,2),
	NUMERO_EXTRA2				NUMBER(14,2),
  NUMERO_EXTRA3				NUMBER(14,2),
  NUMERO_EXTRA4				NUMBER(14,2),
  NUMERO_EXTRA5				NUMBER(14,2),
	LCHAR_EXTRA1			VARCHAR2(250 CHAR),
	LCHAR_EXTRA2			VARCHAR2(250 CHAR),
	LCHAR_EXTRA3			VARCHAR2(250 CHAR),
	LCHAR_EXTRA4			VARCHAR2(250 CHAR),
	LCHAR_EXTRA5      VARCHAR2(250 CHAR)
);

CREATE TABLE REC_FICHERO_PERSONAS_PALANCAS (
	RCF_AGE_ID				NUMBER(16) NOT NULL,
	CODIGO_PROPIETARIO	NUMBER(5) NOT NULL,
	CODIGO_PERSONA				NUMBER(16) NOT NULL,
	ID_EXPEDIENTE				NUMBER(16) NOT NULL,
	ID_PALANCA_PERMITIDA				NUMBER(16) NOT NULL,
	CD_TIPO_PALANCA	VARCHAR2(20 CHAR) NOT NULL,
  TIPO_PALANCA	VARCHAR2(255 CHAR) NOT NULL,
	CD_SUBITPO_PALANCA	VARCHAR2(20 CHAR),
  SUBITPO_PALANCA	VARCHAR2(255 CHAR),
	PALANCA_DELEGADA			NUMBER(1) NOT NULL,
	PRIORIDAD_PALANCA			NUMBER(2) NOT NULL,
	FECHA_EXTRA1			TIMESTAMP(6),
	FECHA_EXTRA2			TIMESTAMP(6),
	FECHA_EXTRA3			TIMESTAMP(6),
	FECHA_EXTRA4			TIMESTAMP(6),
	FECHA_EXTRA5			TIMESTAMP(6),
	NUMERO_EXTRA1				NUMBER(14,2),
	NUMERO_EXTRA2				NUMBER(14,2),
  NUMERO_EXTRA3				NUMBER(14,2),
  NUMERO_EXTRA4				NUMBER(14,2),
  NUMERO_EXTRA5				NUMBER(14,2),
	LCHAR_EXTRA1			VARCHAR2(250 CHAR),
	LCHAR_EXTRA2			VARCHAR2(250 CHAR),
	LCHAR_EXTRA3			VARCHAR2(250 CHAR),
	LCHAR_EXTRA4			VARCHAR2(250 CHAR),
	LCHAR_EXTRA5      VARCHAR2(250 CHAR)
);

CREATE TABLE REC_FICHERO_DIRECCIONES (
	RCF_AGE_ID				NUMBER(16) NOT NULL,
	CODIGO_PROPIETARIO	NUMBER(5) NOT NULL,
	CODIGO_PERSONA				NUMBER(16) NOT NULL,
	CODIGO_DIRECCION				NUMBER(16) NOT NULL,
  CD_TIPO_VIA        VARCHAR2(100 CHAR) NOT NULL,
  TIPO_VIA        VARCHAR2(100 CHAR) NOT NULL,
	NOMBRE_VIA			VARCHAR2(100 CHAR) NOT NULL,
	NUM_DOMICILIO				VARCHAR2(10 CHAR),
	PORTAL			VARCHAR2(10 CHAR),
	PISO			VARCHAR2(10 CHAR),
	ESCALERA				VARCHAR2(10 CHAR),
	PUERTA			VARCHAR2(10 CHAR),
	CODIGO_POSTAL		VARCHAR2(10 CHAR) NOT NULL,
	CD_PROVINCIA			VARCHAR2(100 CHAR) NOT NULL,
  PROVINCIA			VARCHAR2(100 CHAR) NOT NULL,
  CD_POBLACION			VARCHAR2(100 CHAR) NOT NULL,
	POBLACION			VARCHAR2(100 CHAR) NOT NULL,
  CD_MUNICIPIO			VARCHAR2(100 CHAR) NOT NULL,
	MUNICIPIO			VARCHAR2(100 CHAR) NOT NULL,
	DIRECCION_PRINCIPAL			NUMBER(1),
  CD_ESTADO_DIRECCION				VARCHAR2(5 CHAR),
	ESTADO_DIRECCION				VARCHAR2(50 CHAR),
	CD_TIPO_DIRECCION				VARCHAR2(10 CHAR),
  TIPO_DIRECCION				VARCHAR2(50 CHAR),
	DIRECCION_BLOQUEADA			NUMBER(1),
	FECHA_EXTRA1			TIMESTAMP(6),
	FECHA_EXTRA2			TIMESTAMP(6),
	FECHA_EXTRA3			TIMESTAMP(6),
	FECHA_EXTRA4			TIMESTAMP(6),
	FECHA_EXTRA5			TIMESTAMP(6),
	NUMERO_EXTRA1				NUMBER(14,2),
	NUMERO_EXTRA2				NUMBER(14,2),
  NUMERO_EXTRA3				NUMBER(14,2),
  NUMERO_EXTRA4				NUMBER(14,2),
  NUMERO_EXTRA5				NUMBER(14,2),
	LCHAR_EXTRA1			VARCHAR2(250 CHAR),
	LCHAR_EXTRA2			VARCHAR2(250 CHAR),
	LCHAR_EXTRA3			VARCHAR2(250 CHAR),
	LCHAR_EXTRA4			VARCHAR2(250 CHAR),
	LCHAR_EXTRA5      VARCHAR2(250 CHAR)
);

CREATE TABLE REC_FICHERO_RECIBOS (
	RCF_AGE_ID				NUMBER(16) NOT NULL,
	ID_RECIBO				NUMBER(16) NOT NULL,
	ID_ENVIO				NUMBER(24) NOT NULL,
	CODIGO_RECIBO				NUMBER(20),
	FECHA_VENCIMIENTO		TIMESTAMP(6) NOT NULL,
	FECHA_FACTURACION		TIMESTAMP(6),
	CD_TIPO_DE_RECIBO	VARCHAR2(4 CHAR),
  TIPO_DE_RECIBO	VARCHAR2(100 CHAR),
	TIPO_INTERES	VARCHAR2(255 CHAR),
  CD_SITUACION_RECIBO VARCHAR2(4 CHAR),
  SITUACION_RECIBO VARCHAR2(255 CHAR),
	IMPORTE_RECIBO				NUMBER(14,2) NOT NULL,
	IMPORTE_IMPAGADO_RECIBO		NUMBER(14,2) NOT NULL,
	CAPITAL				NUMBER(14,2) NOT NULL,
	INT_ORDIN_DEVEN		NUMBER(14,2) NOT NULL,
	INT_MORAT_DEVEN		NUMBER(14,2) NOT NULL,
	COMISIONES			NUMBER(14,2) NOT NULL,
	GASTOS_NO_COBRADOS				NUMBER(14,2) NOT NULL,
	IMPUESTOS			NUMBER(14,2),
	FECHA_EXTRA1			TIMESTAMP(6),
	FECHA_EXTRA2			TIMESTAMP(6),
	FECHA_EXTRA3			TIMESTAMP(6),
	FECHA_EXTRA4			TIMESTAMP(6),
	FECHA_EXTRA5			TIMESTAMP(6),
	NUMERO_EXTRA1				NUMBER(14,2),
	NUMERO_EXTRA2				NUMBER(14,2),
  NUMERO_EXTRA3				NUMBER(14,2),
  NUMERO_EXTRA4				NUMBER(14,2),
  NUMERO_EXTRA5				NUMBER(14,2),
	LCHAR_EXTRA1			VARCHAR2(250 CHAR),
	LCHAR_EXTRA2			VARCHAR2(250 CHAR),
	LCHAR_EXTRA3			VARCHAR2(250 CHAR),
	LCHAR_EXTRA4			VARCHAR2(250 CHAR),
	LCHAR_EXTRA5      VARCHAR2(250 CHAR)
);

CREATE TABLE REC_FICHERO_TELEFONOS (
	RCF_AGE_ID				NUMBER(16) NOT NULL,
	CODIGO_PROPIETARIO	NUMBER(5) NOT NULL,
	CODIGO_PERSONA				NUMBER(16) NOT NULL,
	TELEFONO			VARCHAR2(20 CHAR) NOT NULL,
	CD_TIPO_TELEFONO		VARCHAR2(10 CHAR),
  TIPO_TELEFONO		VARCHAR2(100 CHAR),
	TELEFONO_BLOQUEADO			NUMBER(1) NOT NULL,
	ULTIMO_CONTACTO		NUMBER(1) NOT NULL,
	ORIGEN_TELEFONO				VARCHAR2(10 CHAR),
	BBDD_ORIGEN_TELEFONO			VARCHAR2(50 CHAR),
	FECHA_EXP_VIGENCIA_TEL		TIMESTAMP(6),
	FECHA_EXTRA1			TIMESTAMP(6),
	FECHA_EXTRA2			TIMESTAMP(6),
	FECHA_EXTRA3			TIMESTAMP(6),
	FECHA_EXTRA4			TIMESTAMP(6),
	FECHA_EXTRA5			TIMESTAMP(6),
	NUMERO_EXTRA1				NUMBER(14,2),
	NUMERO_EXTRA2				NUMBER(14,2),
  NUMERO_EXTRA3				NUMBER(14,2),
  NUMERO_EXTRA4				NUMBER(14,2),
  NUMERO_EXTRA5				NUMBER(14,2),
	LCHAR_EXTRA1			VARCHAR2(250 CHAR),
	LCHAR_EXTRA2			VARCHAR2(250 CHAR),
	LCHAR_EXTRA3			VARCHAR2(250 CHAR),
	LCHAR_EXTRA4			VARCHAR2(250 CHAR),
	LCHAR_EXTRA5      VARCHAR2(250 CHAR)
);

