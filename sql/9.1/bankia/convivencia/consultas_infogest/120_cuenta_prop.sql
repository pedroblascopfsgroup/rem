delete from  MINIREC.RCV_GEST_CUENTA_PROP;
commit;

INSERT INTO MINIREC.RCV_GEST_CUENTA_PROP
SELECT DISTINCT
  CNT.CNT_ID                       ID_CUENTA_RCV 
  ,DECODE(PAS.DD_PAS_CODIGO,'BANKIA','00000','SAREB','05074','00000')        ENTIDAD
  ,SUBSTR(CNT_CONTRATO,6,5)        CLASE_P_P
  ,SUBSTR(CNT.CNT_CONTRATO,11,17)  NUM_CUENTA
  ,CONCAT('00',SUBSTR(CNT.CNT_CONTRATO,28,15)) NUMERO_ESPEC
  ,A.ID_PROPUESTA_RCV  
  ,NULL                            TIPO_RELACION
FROM MINIREC.RCV_GEST_PROPUESTA A
    ,bank01.EXT_IAC_INFO_ADD_CONTRATO EXT 
    ,bank01.CNT_CONTRATOS             CNT
    ,bank01.CEX_CONTRATOS_EXPEDIENTE  CNX
    ,bank01.PRC_CEX                   CEX
    ,bank01.ASU_ASUNTOS               ASU
    ,bank01.DD_PAS_PROPIEDAD_ASUNTO   PAS 
WHERE A.ID_ASUNTO_RCV = ASU.ASU_ID
AND ASU.DD_PAS_ID = PAS.DD_PAS_ID
AND A.ID_PROPUESTA_RCV = CEX.PRC_ID
AND CEX.CEX_ID = CNX.CEX_ID
AND CNX.CNT_ID = CNT.CNT_ID
AND EXT.CNT_ID      = CNT.CNT_ID
AND EXT.DD_IFC_ID IN (SELECT DD.DD_IFC_ID FROM BANK01.EXT_DD_IFC_INFO_CONTRATO DD WHERE DD.DD_IFC_CODIGO = 'NUMERO_ESPEC');
COMMIT;
