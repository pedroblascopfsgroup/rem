--/*
--##########################################
--## AUTOR=Joaquín Sánchez Valverde
--## FECHA_CREACION=20160510
--## ARTEFACTO=online
--## VERSION_ARTEFACTO=9.2.3
--## INCIDENCIA_LINK=CMREC-3065_050516 ZON USUARIO
--## PRODUCTO=NO
--## Finalidad: DML que crea el despacho apoderado y los apoderados, son usuarios sin acceso a recovery
--##           
--## INSTRUCCIONES: solo se debe ejecutar para Cajamar val02
--## VERSIONES:
--##        0.1 Versión inicial
--##########################################
--*/
WHENEVER SQLERROR EXIT SQL.SQLCODE;
SET SERVEROUTPUT ON;
SET DEFINE OFF;

DECLARE
	V_MSQL VARCHAR2(32000 CHAR); -- Sentencia a ejecutar    
    V_ESQUEMA VARCHAR2(25 CHAR):= '#ESQUEMA#'; --'CM01'; -- Configuracion Esquema
    V_ESQUEMA_M VARCHAR2(25 CHAR):= '#ESQUEMA_MASTER#'; --'CMMASTER';--'#ESQUEMA_MASTER#'; -- Configuracion Esquema Master
	V_USUARIO_EJECUTA VARCHAR2(25 CHAR):= 'CMREC-3065_050516'; -- Usuario que EJECUTA el paquete.
    V_SQL VARCHAR2(4000 CHAR); -- Vble. para consulta que valida la existencia de una tabla.
    V_NUM_TABLAS NUMBER(16); -- Vble. para validar la existencia de una tabla.  
    ERR_NUM NUMBER(25);  -- Vble. auxiliar para registrar errores en el script.
    ERR_MSG VARCHAR2(1024 CHAR); -- Vble. auxiliar para registrar errores en el script.
    ERR_BUCLE VARCHAR2(1024 CHAR); -- Vble. auxiliar para registrar errores en el bucle donde estamos.

	V_TAREA VARCHAR2(1024 CHAR); -- Vble. descripcion de lo que hace el proceso
	V_CLAVE VARCHAR2(50 CHAR):='1234'; -- Vble. clave que se le asigna de inicio
    --Valores a insertar
/*
1.- USU_USERNAME LDAP
2.- ENTIDAD A LA QUE PERTENECE EL USUARIO
3.- NOMBRE
4.- APELLIDO 1
5.-	APELLIDO 2
6.- MAIL
7.- usu_externo
8.- usu_grupo
9.- NUM_CEMTRO
10.-PER_PERFIL
*/
    TYPE T_TIPO_DATO IS TABLE OF VARCHAR2(350);
    TYPE T_ARRAY_DATO IS TABLE OF T_TIPO_DATO;
    V_TIPO_DATO T_ARRAY_DATO := T_ARRAY_DATO(  
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','00240024000','CON_CONSULTA'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058130004','GES_RIESGOS'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058130104','GES_RIESGOS'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058130204','GES_RIESGOS'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058130304','GES_RIESGOS'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058130404','GES_RIESGOS'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058130504','GES_RIESGOS'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058130604','GES_RIESGOS'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058130704','GES_RIESGOS'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058130804','GES_RIESGOS'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058130904','GES_RIESGOS'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058131004','GES_RIESGOS'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058131104','GES_RIESGOS'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058131204','GES_RIESGOS'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058131304','GES_RIESGOS'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058131404','GES_RIESGOS'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058131504','GES_RIESGOS'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058131704','GES_RIESGOS'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058131804','GES_RIESGOS'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058610004','GES_RIESGOS'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058610104','GES_RIESGOS'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058610204','GES_RIESGOS'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058610304','GES_RIESGOS'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058610404','GES_RIESGOS'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058610504','GES_RIESGOS'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058610604','GES_RIESGOS'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058610704','GES_RIESGOS'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058610904','GES_RIESGOS'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058611004','GES_RIESGOS'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058611104','GES_RIESGOS'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058611204','GES_RIESGOS'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058611304','GES_RIESGOS'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058611404','GES_RIESGOS'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058611504','GES_RIESGOS'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058611604','GES_RIESGOS'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058611704','GES_RIESGOS'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058611804','GES_RIESGOS'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058611904','GES_RIESGOS'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058612004','GES_RIESGOS'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058612104','GES_RIESGOS'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058612204','GES_RIESGOS'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058612304','GES_RIESGOS'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058612404','GES_RIESGOS'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058612504','GES_RIESGOS'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058612604','GES_RIESGOS'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058612704','GES_RIESGOS'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058612904','GES_RIESGOS'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058613004','GES_RIESGOS'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058613104','GES_RIESGOS'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058613304','GES_RIESGOS'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058613404','GES_RIESGOS'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058613504','GES_RIESGOS'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058613604','GES_RIESGOS'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058613804','GES_RIESGOS'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058613904','GES_RIESGOS'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058614004','GES_RIESGOS'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058614104','GES_RIESGOS'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058614204','GES_RIESGOS'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058614304','GES_RIESGOS'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058614404','GES_RIESGOS'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058614504','GES_RIESGOS'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058614604','GES_RIESGOS'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058614804','GES_RIESGOS'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058614904','GES_RIESGOS'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058615004','GES_RIESGOS'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058130004','GEST_INTERNO'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058130104','GEST_INTERNO'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058130204','GEST_INTERNO'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058130304','GEST_INTERNO'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058130404','GEST_INTERNO'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058130504','GEST_INTERNO'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058130604','GEST_INTERNO'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058130704','GEST_INTERNO'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058130804','GEST_INTERNO'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058130904','GEST_INTERNO'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058131004','GEST_INTERNO'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058131104','GEST_INTERNO'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058131204','GEST_INTERNO'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058131304','GEST_INTERNO'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058131404','GEST_INTERNO'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058131504','GEST_INTERNO'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058131704','GEST_INTERNO'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058131804','GEST_INTERNO'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058610004','GEST_INTERNO'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058610104','GEST_INTERNO'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058610204','GEST_INTERNO'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058610304','GEST_INTERNO'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058610404','GEST_INTERNO'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058610504','GEST_INTERNO'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058610604','GEST_INTERNO'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058610704','GEST_INTERNO'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058610904','GEST_INTERNO'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058611004','GEST_INTERNO'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058611104','GEST_INTERNO'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058611204','GEST_INTERNO'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058611304','GEST_INTERNO'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058611404','GEST_INTERNO'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058611504','GEST_INTERNO'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058611604','GEST_INTERNO'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058611704','GEST_INTERNO'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058611804','GEST_INTERNO'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058611904','GEST_INTERNO'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058612004','GEST_INTERNO'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058612104','GEST_INTERNO'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058612204','GEST_INTERNO'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058612304','GEST_INTERNO'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058612404','GEST_INTERNO'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058612504','GEST_INTERNO'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058612604','GEST_INTERNO'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058612704','GEST_INTERNO'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058612904','GEST_INTERNO'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058613004','GEST_INTERNO'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058613104','GEST_INTERNO'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058613304','GEST_INTERNO'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058613404','GEST_INTERNO'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058613504','GEST_INTERNO'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058613604','GEST_INTERNO'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058613804','GEST_INTERNO'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058613904','GEST_INTERNO'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058614004','GEST_INTERNO'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058614104','GEST_INTERNO'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058614204','GEST_INTERNO'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058614304','GEST_INTERNO'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058614404','GEST_INTERNO'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058614504','GEST_INTERNO'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058614604','GEST_INTERNO'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058614804','GEST_INTERNO'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058614904','GEST_INTERNO'),
		T_TIPO_DATO('ajd55157','AGUSTIN MARTIN','JIMENEZ','DE LA CRUZ','agustinmartin@cajamar.com',0,0,'CAJAMAR','03058615004','GEST_INTERNO')
    ); 
    V_TMP_TIPO_DATO T_TIPO_DATO;
	
		
BEGIN
	
	V_TAREA :='Zonificamos los usuarios y se crean si no existencia';
	
	DBMS_OUTPUT.PUT_LINE('[INICIO] Comenzando -----------' || V_TAREA || '----------');  

	DBMS_OUTPUT.PUT_LINE('[INICIO-PROCEDIMIENTO] -----------' || V_USUARIO_EJECUTA || '---------- - PROCEDIMIENTO');  
	ERR_BUCLE :='ZONIFICACION';

	V_MSQL := 'SELECT COUNT(1) FROM '||V_ESQUEMA_M||'.USU_USUARIOS USU WHERE USU.USUARIOCREAR = ''' || V_USUARIO_EJECUTA || ''' ';
	DBMS_OUTPUT.PUT_LINE(V_MSQL);
	EXECUTE IMMEDIATE V_MSQL INTO V_NUM_TABLAS;
	IF V_NUM_TABLAS < 1 THEN
		V_MSQL := 'SELECT COUNT(1) FROM '||V_ESQUEMA||'.ZON_PEF_USU ZPU WHERE ZPU.USUARIOCREAR = ''' || V_USUARIO_EJECUTA || ''' ';
		DBMS_OUTPUT.PUT_LINE(V_MSQL);
		EXECUTE IMMEDIATE V_MSQL INTO V_NUM_TABLAS;	
			V_MSQL := 'SELECT COUNT(1) FROM '||V_ESQUEMA_M||'.USU_USUARIOS USU WHERE USU.USU_USERNAME= ''ajd55157'' ';
			DBMS_OUTPUT.PUT_LINE(V_MSQL);
			EXECUTE IMMEDIATE V_MSQL INTO V_NUM_TABLAS;
			IF V_NUM_TABLAS < 1 THEN				
				DBMS_OUTPUT.PUT_LINE('Creado el USUARIO adjunto correctamente.');		
			ELSE
			--limpiamos
				V_MSQL := 'DELETE FROM '||V_ESQUEMA||'.ZON_PEF_USU ZPU WHERE ZPU.USU_ID = (SELECT USU.USU_ID FROM '||V_ESQUEMA_M||'.USU_USUARIOS USU WHERE USU.USU_USERNAME = ''ajd55157'') ';
				--DBMS_OUTPUT.PUT_LINE(V_MSQL);
				EXECUTE IMMEDIATE V_MSQL;
				DBMS_OUTPUT.PUT_LINE('Linpiamos la zonificacion de ajd55157 correctamente.');		
			END IF;	

			FOR I IN V_TIPO_DATO.FIRST .. V_TIPO_DATO.LAST LOOP	
				V_TMP_TIPO_DATO := V_TIPO_DATO(I);
				DBMS_OUTPUT.PUT_LINE('[INICIO] FOR '||I||'----------------------------------------------------------------- correctamente.');  
			
				V_MSQL := 'SELECT COUNT(1) FROM '||V_ESQUEMA||'.ZON_ZONIFICACION ZON WHERE ZON.ZON_NUM_CENTRO = ''' || V_TMP_TIPO_DATO(9) || ''' ';
				DBMS_OUTPUT.PUT_LINE(V_MSQL);
				EXECUTE IMMEDIATE V_MSQL INTO V_NUM_TABLAS;
				IF V_NUM_TABLAS >= 1 THEN				
					DBMS_OUTPUT.PUT_LINE('El usuario :'|| V_TMP_TIPO_DATO(1) ||' a la zona: ' ||V_TMP_TIPO_DATO(9)|| 'con perfil' || V_TMP_TIPO_DATO(10) );
					V_MSQL := 'INSERT INTO '||V_ESQUEMA||'.ZON_PEF_USU ZPU (ZPU.ZPU_ID,ZPU.ZON_ID,ZPU.USU_ID,ZPU.PEF_ID,ZPU.USUARIOCREAR,ZPU.FECHACREAR) VALUES ('
						|| V_ESQUEMA||'.S_ZON_PEF_USU.NEXTVAL,'
						|| '(SELECT MAX(ZON.ZON_ID) FROM '||V_ESQUEMA||'.ZON_ZONIFICACION ZON WHERE ZON.ZON_NUM_CENTRO ='''||V_TMP_TIPO_DATO(9)|| '''),'
						|| '(SELECT USU.USU_ID FROM '||V_ESQUEMA_M||'.USU_USUARIOS USU WHERE USU.USU_USERNAME = ''' || V_TMP_TIPO_DATO(1) || '''),'
						|| '(SELECT PEF.PEF_ID FROM '||V_ESQUEMA||'.PEF_PERFILES PEF WHERE PEF.PEF_CODIGO = UPPER(''' || V_TMP_TIPO_DATO(10) || ''')) ,'
						|| '''' || V_USUARIO_EJECUTA || ''', SYSDATE )';
				
					--DBMS_OUTPUT.PUT_LINE(V_MSQL);	
					EXECUTE IMMEDIATE V_MSQL;
					DBMS_OUTPUT.PUT_LINE('Configurado el USUARIO '||V_TMP_TIPO_DATO(1)||' correctamente.');		
				
				ELSE
					DBMS_OUTPUT.PUT_LINE('El  Zona/Oficina ' || V_TMP_TIPO_DATO(9) || ' NO EXISTE.	');
				END IF;		
		
				DBMS_OUTPUT.PUT_LINE('[FIN] FOR '||I||'----------------------------------------------------------------- correctamente.');  
			END LOOP; 
  
			COMMIT;		
			DBMS_OUTPUT.PUT_LINE('[FIN PROCEDIMIENTO]******** ' || V_USUARIO_EJECUTA || ' ********'); 	
		ELSE 
			DBMS_OUTPUT.PUT_LINE('El  Procedimiento ' || V_USUARIO_EJECUTA || ' ya se ejecuto, NO se ejecutara de nuevo otra vez.');				
		END IF;	 			
	
	
	EXCEPTION
  WHEN OTHERS THEN
    ERR_NUM := SQLCODE;
    ERR_MSG := SQLERRM;
	DBMS_OUTPUT.put_line('[ERROR PROCEDIMIENTO]-----------' || V_USUARIO_EJECUTA || '-----------');
	DBMS_OUTPUT.put_line('[ERROR] Se ha producido un error en la ejecución del bucle:'||ERR_BUCLE);
    DBMS_OUTPUT.put_line('[ERROR] Se ha producido un error en la ejecución:'||TO_CHAR(ERR_NUM));
    DBMS_OUTPUT.put_line('[FIN PROCEDIMIENTO]-------------' || V_USUARIO_EJECUTA || '-----------'); 
    DBMS_OUTPUT.put_line(ERR_MSG);
    ROLLBACK;
    RAISE;   
    
END;
/

EXIT;
