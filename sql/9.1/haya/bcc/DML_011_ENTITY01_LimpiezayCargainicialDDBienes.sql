--/*
--##########################################
--## AUTOR=JAVIER DIAZ RAMOS
--## FECHA_CREACION=20150726
--## ARTEFACTO=batch
--## VERSION_ARTEFACTO=9.2
--## INCIDENCIA_LINK=CMREC-440
--## PRODUCTO=NO
--## 
--## Finalidad: Inserción de datos de Diccionarios BIENES Cajamar , esquema #ESQUEMA#.
--## INSTRUCCIONES:  Configurar las variables necesarias en el principio del DECLARE
--## VERSIONES:
--##        0.1 Versión inicial
--##########################################
--*/
WHENEVER SQLERROR EXIT SQL.SQLCODE;
SET SERVEROUTPUT ON;
DECLARE

 
   TYPE T_TIPO_BIEN IS TABLE OF VARCHAR2(150);
   TYPE T_ARRAY_BIEN IS TABLE OF T_TIPO_BIEN;
   
      TYPE T_TIPO_INMUEBLE IS TABLE OF VARCHAR2(150);
   TYPE T_ARRAY_INMUEBLE IS TABLE OF T_TIPO_INMUEBLE;
   
      TYPE T_TIPO_REL_BIEN_CNT IS TABLE OF VARCHAR2(150);
   TYPE T_ARRAY_REL_BIEN_CNT IS TABLE OF T_TIPO_REL_BIEN_CNT;
   
   
	
  -- Configuracion Esquemas
   V_ESQUEMA VARCHAR(25) := '#ESQUEMA#';
   V_ESQUEMA_M VARCHAR(25) := '#ESQUEMA_MASTER#';
   V_TipoContrado VARCHAR(50) := 'BNKContrato';

   V_USUARIO_CREAR VARCHAR2(10) := 'INICIAL';
   
   -- Configuracion Entidad
   V_ENTIDAD VARCHAR2(255) := 'CAJAMAR-CDD';
   V_WORKING_CODE VARCHAR2(255) := '3058';

						   
	
	 V_TIPO_BIEN T_ARRAY_BIEN := T_ARRAY_BIEN(									
												T_TIPO_BIEN('1','PISO VIVIENDA TERMINADA   ','PISO VIVIENDA TERMINADA   '),
												T_TIPO_BIEN('2','PISO VIVIENDA NO TERMINADA   ','PISO VIVIENDA NO TERMINADA   '),
												T_TIPO_BIEN('3','PISO OFICINA   ','PISO OFICINA   '),
												T_TIPO_BIEN('4','CHALET ADOSADO   ','CHALET ADOSADO   '),
												T_TIPO_BIEN('5','CHALET UNIFAMILIAR   ','CHALET UNIFAMILIAR   '),
												T_TIPO_BIEN('6','CASA RURAL   ','CASA RURAL   '),
												T_TIPO_BIEN('7','APARTAMENTO   ','APARTAMENTO   '),
												T_TIPO_BIEN('8','EDIFICIO DE APARTAMENTOS   ','EDIFICIO DE APARTAMENTOS   '),
												T_TIPO_BIEN('9','TRASTERO   ','TRASTERO   '),
												T_TIPO_BIEN('10','VIVIENDA CON GARAJE VINCULADO   ','VIVIENDA CON GARAJE VINCULADO   '),
												T_TIPO_BIEN('11','PLAZA DE GARAJE INDEPENDIENTE   ','PLAZA DE GARAJE INDEPENDIENTE   '),
												T_TIPO_BIEN('12','OFICINAS - NO VIVIENDAS   ','OFICINAS - NO VIVIENDAS   '),
												T_TIPO_BIEN('13','LOCAL POLIVALENTE   ','LOCAL POLIVALENTE   '),
												T_TIPO_BIEN('14','LOCAL NO POLIVALENTE   ','LOCAL NO POLIVALENTE   '),
												T_TIPO_BIEN('15','FABRICA   ','FABRICA   '),
												T_TIPO_BIEN('16','NAVE POLIVALENTE   ','NAVE POLIVALENTE   '),
												T_TIPO_BIEN('17','NAVE NO POLIVALENTE   ','NAVE NO POLIVALENTE   '),
												T_TIPO_BIEN('18','OTRA FINCA RUSTICA SECANO   ','OTRA FINCA RUSTICA SECANO   '),
												T_TIPO_BIEN('19','OTRA FINCA RUSTICA REGADIO   ','OTRA FINCA RUSTICA REGADIO   '),
												T_TIPO_BIEN('20','FINCA RUSTICA EXPL. GANADERA   ','FINCA RUSTICA EXPL. GANADERA   '),
												T_TIPO_BIEN('21','FINCA RUSTICA - URBANIZABLE   ','FINCA RUSTICA - URBANIZABLE   '),
												T_TIPO_BIEN('22','TERRENO RECALIFICADO   ','TERRENO RECALIFICADO   '),
												T_TIPO_BIEN('23','SUELO URBANIZABLE   ','SUELO URBANIZABLE   '),
												T_TIPO_BIEN('24','SUELO NO URBANIZABLE   ','SUELO NO URBANIZABLE   '),
												T_TIPO_BIEN('25','SOLARES   ','SOLARES   '),
												T_TIPO_BIEN('26','LOCAL NO POLIVALENTE   ','LOCAL NO POLIVALENTE   '),
												T_TIPO_BIEN('27','EMBARCACIONES USO LUCRATIVO   ','EMBARCACIONES USO LUCRATIVO   '),
												T_TIPO_BIEN('28','EMBARCACIONES DE RECREO   ','EMBARCACIONES DE RECREO   '),
												T_TIPO_BIEN('29','INST. FINCAS RUSTICAS (INVERSIONES NO PERMANENTES)   ','INST. FINCAS RUSTICAS (INVERSIONES NO PERMANENTES)   '),
												T_TIPO_BIEN('30','MAQUINARIA INDUSTRIAL   ','MAQUINARIA INDUSTRIAL   '),
												T_TIPO_BIEN('31','COCHES   ','COCHES   '),
												T_TIPO_BIEN('32','MOTOS   ','MOTOS   '),
												T_TIPO_BIEN('33','TAXI   ','TAXI   '),
												T_TIPO_BIEN('34','CAMION, CAMIONETA   ','CAMION, CAMIONETA   '),
												T_TIPO_BIEN('35','ROULOTTE, REMOLQUE   ','ROULOTTE, REMOLQUE   '),
												T_TIPO_BIEN('36','OTROS VEHICULOS   ','OTROS VEHICULOS   '),
												T_TIPO_BIEN('37','PATENTES   ','PATENTES   '),
												T_TIPO_BIEN('38','MARCAS   ','MARCAS   '),
												T_TIPO_BIEN('39','PROPIEDAD INTELECTUAL INDUSTRIAL   ','PROPIEDAD INTELECTUAL INDUSTRIAL   '),
												T_TIPO_BIEN('40','EXISTENCIAS   ','EXISTENCIAS   '),
												T_TIPO_BIEN('41','DEPOSITOS DINERARIOS O  C','DEPOSITOS DINERARIOS O  C'),
												T_TIPO_BIEN('42','DEUDA PUBLICA: VALORES EMITIDOS POR EL ESTADO, BANCO DE ESPANA, CE   ','DEUDA PUBLICA: VALORES EMITIDOS POR EL ESTADO, BANCO DE ESPANA, CE   '),
												T_TIPO_BIEN('43','DEUDA PUBLICA: VALORES EMITIDOS POR COMUNIDADES AUTONOMAS AUTORIZADAS   ','DEUDA PUBLICA: VALORES EMITIDOS POR COMUNIDADES AUTONOMAS AUTORIZADAS   '),
												T_TIPO_BIEN('44','OTROS TITULOS EMITIDOS POR ADMINISTRACIONES TERRITORIALES NO AUTORIZADAS   ','OTROS TITULOS EMITIDOS POR ADMINISTRACIONES TERRITORIALES NO AUTORIZADAS   '),
												T_TIPO_BIEN('45','OTROS VALORES EMITIDOS POR ADMINISTRACIONES DE PAISES DISTINTOS DE  L','OTROS VALORES EMITIDOS POR ADMINISTRACIONES DE PAISES DISTINTOS DE  L'),
												T_TIPO_BIEN('46','VALORES DE RENTA FIJA EMITIDOS POR ENTIDADES DE CREDITO   ','VALORES DE RENTA FIJA EMITIDOS POR ENTIDADES DE CREDITO   '),
												T_TIPO_BIEN('47','VALORES DE RENTA FIJA EMITIDOS POR EMISORES DE RECONOCIDA SOLVENCIA  (','VALORES DE RENTA FIJA EMITIDOS POR EMISORES DE RECONOCIDA SOLVENCIA  ('),
												T_TIPO_BIEN('48','VALORES DE RENTA FIJA EMITIDOS POR EMISORES QUE NO TIENEN RECONOCIDA SU SOLVENCIA   ','VALORES DE RENTA FIJA EMITIDOS POR EMISORES QUE NO TIENEN RECONOCIDA SU SOLVENCIA   '),
												T_TIPO_BIEN('49','VALORES DE RENTA VARIABLE CON COTIZACION   ','VALORES DE RENTA VARIABLE CON COTIZACION   '),
												T_TIPO_BIEN('50','VALORES DE RENTA VARIABLE SIN COTIZACION   ','VALORES DE RENTA VARIABLE SIN COTIZACION   '),
												T_TIPO_BIEN('51','PARTICIPACIONES EN FIAMM   ','PARTICIPACIONES EN FIAMM   '),
												T_TIPO_BIEN('52','PARTICIPACIONES EN OTROS FONDOS DE INVERSION   ','PARTICIPACIONES EN OTROS FONDOS DE INVERSION   '),
												T_TIPO_BIEN('53','PROPIEDAD DE AGUA   ','PROPIEDAD DE AGUA   '),
												T_TIPO_BIEN('54','DERECHOS DE EXPLOTACION   ','DERECHOS DE EXPLOTACION   '),
												T_TIPO_BIEN('55','SEMOVIENTE   ','SEMOVIENTE   '),
												T_TIPO_BIEN('56','OBRAS DE ARTE   ','OBRAS DE ARTE   '),
												T_TIPO_BIEN('57','METALES PRECIOSOS   ','METALES PRECIOSOS   '),
												T_TIPO_BIEN('58','MUEBLES   ','MUEBLES   '),
												T_TIPO_BIEN('59','EQUIPO DEPORTIVO   ','EQUIPO DEPORTIVO   '),
												T_TIPO_BIEN('60','ELECTRODOMESTICOS   ','ELECTRODOMESTICOS   '),
												T_TIPO_BIEN('61','BIENES CONSUMO   ','BIENES CONSUMO   '),
												T_TIPO_BIEN('62','DERECHO DE CONCESION MARITIMA   ','DERECHO DE CONCESION MARITIMA   '),
												T_TIPO_BIEN('63','DERECHO DE CONCESION ADMINISTRATIVA   ','DERECHO DE CONCESION ADMINISTRATIVA   '),
												T_TIPO_BIEN('64','DERECHO DE SUPERFCIE O VUELO   ','DERECHO DE SUPERFCIE O VUELO   '),
												T_TIPO_BIEN('65','DEPOSITO EN PROPIA ENTIDAD   ','DEPOSITO EN PROPIA ENTIDAD   '),
												T_TIPO_BIEN('66','LOFT   ','LOFT   '),
												T_TIPO_BIEN('67','GARAJE CON TRASTERO VINCULADO   ','GARAJE CON TRASTERO VINCULADO   '),
												T_TIPO_BIEN('68','VIVIENDA CON TRASTERO VINCULADO   ','VIVIENDA CON TRASTERO VINCULADO   '),
												T_TIPO_BIEN('69','VIVIENDA CON GARAJE Y TRASTERO VINCULADOS   ','VIVIENDA CON GARAJE Y TRASTERO VINCULADOS   '),
												T_TIPO_BIEN('70','TERRENO INDUSTRIAL   ','TERRENO INDUSTRIAL   '),
												T_TIPO_BIEN('71','SUELO URBANO   ','SUELO URBANO   '),
												T_TIPO_BIEN('72','FINCA RUSTICA INVERNADERO   ','FINCA RUSTICA INVERNADERO   '),
												T_TIPO_BIEN('76','HOTEL   ','HOTEL   '),
												T_TIPO_BIEN('77','EDIFICIO DE USO RESIDENCIAL 1ª RESIDENCIA   ','EDIFICIO DE USO RESIDENCIAL 1ª RESIDENCIA   '),
												T_TIPO_BIEN('78','EDIFICIO DE USO RESIDENCIAL 2ª RESIDENCIA   ','EDIFICIO DE USO RESIDENCIAL 2ª RESIDENCIA   '),
												T_TIPO_BIEN('79','EDIFICIO DE OFICINAS POLIVALENTE   ','EDIFICIO DE OFICINAS POLIVALENTE   '),
												T_TIPO_BIEN('80','EDIFICIO DE GARAJES   ','EDIFICIO DE GARAJES   '),
												T_TIPO_BIEN('81','EDIFICIO NO POLIVALENTE   ','EDIFICIO NO POLIVALENTE   '),
												T_TIPO_BIEN('82','EDIFICIO DE USO COMERCIAL POLIVALENTE   ','EDIFICIO DE USO COMERCIAL POLIVALENTE   ')
                                   );
								   
								 
  V_TIPO_INMUEBLE T_ARRAY_INMUEBLE := T_ARRAY_INMUEBLE(									
												T_TIPO_INMUEBLE('SOL','SOLAR','SOLAR'),
												T_TIPO_INMUEBLE('VIV','VIVIENDA','VIVIENDA'),
												T_TIPO_INMUEBLE('CON','CONCESION ADMINISTRATIVA','CONCESION ADMINISTRATIVA'),
												T_TIPO_INMUEBLE('INF','BUSQUEDA INFO. PATRIMONIAL','BUSQUEDA INFO. PATRIMONIAL'),
												T_TIPO_INMUEBLE('DER','DERECHO DE CREDITO','DERECHO DE CREDITO'),
												T_TIPO_INMUEBLE('CAS','CASA','CASA'),
												T_TIPO_INMUEBLE('ART','OBRA DE ARTE','OBRA DE ARTE'),
												T_TIPO_INMUEBLE('JOY','JOYAS','JOYAS'),
												T_TIPO_INMUEBLE('MAQ','MAQUINARIA','MAQUINARIA'),
												T_TIPO_INMUEBLE('MOB','MOBILIARIO','MOBILIARIO'),
												T_TIPO_INMUEBLE('SEM','SEMOVIENTE','SEMOVIENTE'),
												T_TIPO_INMUEBLE('CTA','CUENTA BANCARIA','CUENTA BANCARIA'),
												T_TIPO_INMUEBLE('PEN','PENSION','PENSION'),
												T_TIPO_INMUEBLE('REN','RENTA','RENTA'),
												T_TIPO_INMUEBLE('SUE','SUELDO','SUELDO'),
												T_TIPO_INMUEBLE('DCO','DERECHOS DE COBRO','DERECHOS DE COBRO'),
												T_TIPO_INMUEBLE('COM','LOCAL COMERCIAL','LOCAL COMERCIAL'),
												T_TIPO_INMUEBLE('NAV','NAVE INDUSTRIAL','NAVE INDUSTRIAL'),
												T_TIPO_INMUEBLE('PAR','PARCELA','PARCELA'),
												T_TIPO_INMUEBLE('PSO','PISO','PISO'),
												T_TIPO_INMUEBLE('GAR','PLAZA DE GARAGE','PLAZA DE GARAGE'),
												T_TIPO_INMUEBLE('RUS','FINCA RUSTICA','FINCA RUSTICA'),
												T_TIPO_INMUEBLE('TRA','TRASTERO','TRASTERO'),
												T_TIPO_INMUEBLE('URB','FINCA URBANA','FINCA URBANA'),
												T_TIPO_INMUEBLE('DTR','DERECHOS DE TRASPASO','DERECHOS DE TRASPASO'),
												T_TIPO_INMUEBLE('VAL','VALORES','VALORES'),
												T_TIPO_INMUEBLE('AVI','AVION','AVION'),
												T_TIPO_INMUEBLE('BAR','BARCO','BARCO'),
												T_TIPO_INMUEBLE('AUT','AUTOBUS','AUTOBUS'),
												T_TIPO_INMUEBLE('CAM','CAMION','CAMION'),
												T_TIPO_INMUEBLE('TUR','TURISMO','TURISMO'),
												T_TIPO_INMUEBLE('MOT','MOTO','MOTO'),
												T_TIPO_INMUEBLE('VAG','VEHICULO AGRICOLA','VEHICULO AGRICOLA'),
												T_TIPO_INMUEBLE('EXI','EXISTENCIAS','EXISTENCIAS'),
												T_TIPO_INMUEBLE('DPR','DERECHOS DE PROPIEDAD','DERECHOS DE PROPIEDAD'),
												T_TIPO_INMUEBLE('OTI','OTROS','OTROS'),
												T_TIPO_INMUEBLE('SAL','SALDO BANCARIO','SALDO BANCARIO')
                                   );		

  
  V_TIPO_REL_BIEN_CNT T_ARRAY_REL_BIEN_CNT := T_ARRAY_REL_BIEN_CNT(									
												T_TIPO_REL_BIEN_CNT('000','SIN VALORES','SIN VALORES')
												
                                   );									   
								   
								   

--##########################################
--## FIN Configuraciones a rellenar
--##########################################
--*/  
   
   V_MSQL VARCHAR(5000);
   V_EXIST NUMBER(10);

   V_ENTIDAD_ID NUMBER(16);
   V_PEF_ID NUMBER;
  
   V_TMP_TIPO_BIEN T_TIPO_BIEN; 
   
   V_TMP_TIPO_INMUEBLE T_TIPO_INMUEBLE; 
   
    V_TMP_TIPO_REL_BIEN_CNT T_TIPO_REL_BIEN_CNT;
   
   err_num NUMBER;
   err_msg VARCHAR2(255);
BEGIN


 EXECUTE IMMEDIATE('ALTER TABLE ' || V_ESQUEMA || '.BIE_BIEN_ENTIDAD DISABLE CONSTRAINTS BIE_BIEN_ENT_IBFK_1');   	
 DBMS_OUTPUT.PUT_LINE('ALTER TABLE BIE_BIEN_ENTIDAD DISABLE CONSTRAINTS BIE_BIEN_ENT_IBFK_1'); 


			DBMS_OUTPUT.PUT_LINE('Se borra DD_TBI_TIPO_BIEN - TIPO BIEN');
	    execute immediate('DELETE FROM ' || V_ESQUEMA || '.DD_TBI_TIPO_BIEN');
		
			DBMS_OUTPUT.PUT_LINE('Se borra DD_TPN_TIPO_INMUEBLE - TIPO INMUEBLE');
	    execute immediate('DELETE FROM ' || V_ESQUEMA || '.DD_TPN_TIPO_INMUEBLE');
		
				DBMS_OUTPUT.PUT_LINE('Se borra DD_TBC_TIPO_REL_BIEN_CNT - RELACION BIEN CNT');
	    execute immediate('DELETE FROM ' || V_ESQUEMA || '.DD_TBC_TIPO_REL_BIEN_CNT');
		
		
		
		
		/*
			DBMS_OUTPUT.PUT_LINE('Se borra DD_TPB_TIPO_PROD_BANCARIO - TIPO PRODUCTO B');
	    execute immediate('DELETE FROM ' || V_ESQUEMA || '.DD_TPB_TIPO_PROD_BANCARIO');
		
		DBMS_OUTPUT.PUT_LINE('Se borra DD_ECV_ESTADO_CICLO_VIDA - EDO CICLO VIDA RELACION');
	    execute immediate('DELETE FROM ' || V_ESQUEMA || '.DD_ECV_ESTADO_CICLO_VIDA');
		*/
		
    
    SELECT count(*) INTO V_ENTIDAD_ID
    FROM all_sequences
    WHERE sequence_name = 'S_DD_TBI_TIPO_BIEN' and sequence_owner=V_ESQUEMA;
    if V_ENTIDAD_ID is not null and V_ENTIDAD_ID = 1 then    
	    EXECUTE IMMEDIATE('DROP SEQUENCE '|| V_ESQUEMA || '.S_DD_TBI_TIPO_BIEN');
	end if;
	
	SELECT count(*) INTO V_ENTIDAD_ID
    FROM all_sequences
    WHERE sequence_name = 'S_DD_TPN_TIPO_INMUEBLE' and sequence_owner=V_ESQUEMA;
    if V_ENTIDAD_ID is not null and V_ENTIDAD_ID = 1 then    
	    EXECUTE IMMEDIATE('DROP SEQUENCE '|| V_ESQUEMA || '.S_DD_TPN_TIPO_INMUEBLE');
	end if;
	
	SELECT count(*) INTO V_ENTIDAD_ID
    FROM all_sequences
    WHERE sequence_name = 'S_DD_TBC_TIPO_REL_BIEN_CNT' and sequence_owner=V_ESQUEMA;
    if V_ENTIDAD_ID is not null and V_ENTIDAD_ID = 1 then    
	    EXECUTE IMMEDIATE('DROP SEQUENCE '|| V_ESQUEMA || '.S_DD_TBC_TIPO_REL_BIEN_CNT');
	end if;
	
	
	/*
	
	SELECT count(*) INTO V_ENTIDAD_ID
    FROM all_sequences
    WHERE sequence_name = 'S_DD_TPB_TIPO_PROD_BANCARIO' and sequence_owner=V_ESQUEMA;
    if V_ENTIDAD_ID is not null and V_ENTIDAD_ID = 1 then    
	    EXECUTE IMMEDIATE('DROP SEQUENCE '|| V_ESQUEMA || '.S_DD_TPB_TIPO_PROD_BANCARIO');
	end if;
	
	SELECT count(*) INTO V_ENTIDAD_ID
    FROM all_sequences
    WHERE sequence_name = 'S_DD_ECV_ESTADO_CICLO_VIDA' and sequence_owner=V_ESQUEMA;
    if V_ENTIDAD_ID is not null and V_ENTIDAD_ID = 1 then    
	    EXECUTE IMMEDIATE('DROP SEQUENCE '|| V_ESQUEMA || '.S_DD_ECV_ESTADO_CICLO_VIDA');
	end if;
	*/
	  EXECUTE IMMEDIATE('CREATE SEQUENCE '|| V_ESQUEMA || '.S_DD_TBI_TIPO_BIEN
      START WITH 1
      MAXVALUE 999999999999999999999999999
      MINVALUE 1
      NOCYCLE
      CACHE 20
      NOORDER');
	  
	    EXECUTE IMMEDIATE('CREATE SEQUENCE '|| V_ESQUEMA || '.S_DD_TPN_TIPO_INMUEBLE
      START WITH 1
      MAXVALUE 999999999999999999999999999
      MINVALUE 1
      NOCYCLE
      CACHE 20
      NOORDER');
	  
	    EXECUTE IMMEDIATE('CREATE SEQUENCE '|| V_ESQUEMA || '.S_DD_TBC_TIPO_REL_BIEN_CNT
      START WITH 1
      MAXVALUE 999999999999999999999999999
      MINVALUE 1
      NOCYCLE
      CACHE 20
      NOORDER');
	  /*
	    EXECUTE IMMEDIATE('CREATE SEQUENCE '|| V_ESQUEMA || '.S_DD_TPB_TIPO_PROD_BANCARIO
      START WITH 1
      MAXVALUE 999999999999999999999999999
      MINVALUE 1
      NOCYCLE
      CACHE 20
      NOORDER');
	  
	   EXECUTE IMMEDIATE('CREATE SEQUENCE '|| V_ESQUEMA || '.S_DD_ECV_ESTADO_CICLO_VIDA
      START WITH 1
      MAXVALUE 999999999999999999999999999
      MINVALUE 1
      NOCYCLE
      CACHE 20
      NOORDER');
	  */
	 
   DBMS_OUTPUT.PUT_LINE('Creando DD_TBI_TIPO_BIEN......');
   FOR I IN V_TIPO_BIEN.FIRST .. V_TIPO_BIEN.LAST
   LOOP
      V_MSQL := 'SELECT '||V_ESQUEMA||'.S_DD_TBI_TIPO_BIEN.NEXTVAL FROM DUAL';
      EXECUTE IMMEDIATE V_MSQL INTO V_ENTIDAD_ID;
      V_TMP_TIPO_BIEN := V_TIPO_BIEN(I);
      DBMS_OUTPUT.PUT_LINE('Creando Tipo TIPO BIEN: '||V_TMP_TIPO_BIEN(1));   

      V_MSQL := 'INSERT INTO '||V_ESQUEMA||'.DD_TBI_TIPO_BIEN (DD_TBI_ID, DD_TBI_CODIGO, DD_TBI_DESCRIPCION,' ||
        'DD_TBI_DESCRIPCION_LARGA, VERSION, USUARIOCREAR, FECHACREAR, BORRADO) ' ||
                 ' VALUES ('||  V_ENTIDAD_ID || ','''||V_TMP_TIPO_BIEN(1)||''','''||SUBSTR(V_TMP_TIPO_BIEN(2),1,50)||''','''
         ||RTRIM(V_TMP_TIPO_BIEN(3))||''','
         || '0,'''||V_USUARIO_CREAR||''',SYSDATE,0)';
      --DBMS_OUTPUT.PUT_LINE(V_MSQL);
      EXECUTE IMMEDIATE V_MSQL;
   END LOOP;
    COMMIT;
   V_TMP_TIPO_BIEN:= NULL;
   V_TIPO_BIEN:= NULL;
  
     DBMS_OUTPUT.PUT_LINE('Creando DD_TPN_TIPO_INMUEBLE......');
   FOR I IN V_TIPO_INMUEBLE.FIRST .. V_TIPO_INMUEBLE.LAST
   LOOP
      V_MSQL := 'SELECT '||V_ESQUEMA||'.S_DD_TPN_TIPO_INMUEBLE.NEXTVAL FROM DUAL';
      EXECUTE IMMEDIATE V_MSQL INTO V_ENTIDAD_ID;
      V_TMP_TIPO_INMUEBLE := V_TIPO_INMUEBLE(I);
      DBMS_OUTPUT.PUT_LINE('Creando TIPO INMMUEBLE: '||V_TMP_TIPO_INMUEBLE(1));   

      V_MSQL := 'INSERT INTO '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE (DD_TPN_ID, DD_TPN_CODIGO, DD_TPN_DESCRIPCION,' ||
        'DD_TPN_DESCRIPCION_LARGA, VERSION, USUARIOCREAR, FECHACREAR, BORRADO) ' ||
                 ' VALUES ('||  V_ENTIDAD_ID || ','''||V_TMP_TIPO_INMUEBLE(1)||''','''||V_TMP_TIPO_INMUEBLE(2)||''','''
         ||V_TMP_TIPO_INMUEBLE(3)||''','
         || '0,'''||V_USUARIO_CREAR||''',SYSDATE,0)';
      --DBMS_OUTPUT.PUT_LINE(V_MSQL);
      EXECUTE IMMEDIATE V_MSQL;
   END LOOP; 
    COMMIT;
   V_TMP_TIPO_INMUEBLE:= NULL;
   V_TIPO_INMUEBLE:= NULL;
    
    DBMS_OUTPUT.PUT_LINE('Creando DD_TBC_TIPO_REL_BIEN_CNT......');
   FOR I IN V_TIPO_REL_BIEN_CNT.FIRST .. V_TIPO_REL_BIEN_CNT.LAST
   LOOP
      V_MSQL := 'SELECT '||V_ESQUEMA||'.S_DD_TBC_TIPO_REL_BIEN_CNT.NEXTVAL FROM DUAL';
      EXECUTE IMMEDIATE V_MSQL INTO V_ENTIDAD_ID;
      V_TMP_TIPO_REL_BIEN_CNT := V_TIPO_REL_BIEN_CNT(I);
      DBMS_OUTPUT.PUT_LINE('Creando RELACION BIEN CNT: '||V_TMP_TIPO_REL_BIEN_CNT(1));   

      V_MSQL := 'INSERT INTO '||V_ESQUEMA||'.DD_TBC_TIPO_REL_BIEN_CNT (DD_TBC_ID, DD_TBC_CODIGO, DD_TBC_DESCRIPCION,' ||
        'DD_TBC_DESCRIPCION_LARGA, VERSION, USUARIOCREAR, FECHACREAR, BORRADO) ' ||
                 ' VALUES ('||  V_ENTIDAD_ID || ','''||V_TMP_TIPO_REL_BIEN_CNT(1)||''','''||V_TMP_TIPO_REL_BIEN_CNT(2)||''','''
         ||V_TMP_TIPO_REL_BIEN_CNT(3)||''','
         || '0,'''||V_USUARIO_CREAR||''',SYSDATE,0)';
      --DBMS_OUTPUT.PUT_LINE(V_MSQL);
      EXECUTE IMMEDIATE V_MSQL;
   END LOOP; --LOOP ESTADO CICLO VIDA RELACION
    COMMIT;
   V_TMP_TIPO_REL_BIEN_CNT:= NULL;
   V_TIPO_REL_BIEN_CNT:= NULL;

   
   
   
    EXECUTE IMMEDIATE('ALTER TABLE ' || V_ESQUEMA || '.BIE_BIEN_ENTIDAD ENABLE CONSTRAINTS BIE_BIEN_ENT_IBFK_1');   	
 DBMS_OUTPUT.PUT_LINE('ALTER TABLE BIE_BIEN_ENTIDAD ENABLE CONSTRAINTS BIE_BIEN_ENT_IBFK_1'); 
   
   DBMS_OUTPUT.PUT_LINE('Script ejecutado correctamente'); 

EXCEPTION

WHEN OTHERS THEN  
  err_num := SQLCODE;
  err_msg := SQLERRM;

  DBMS_OUTPUT.put_line('Error:'||TO_CHAR(err_num));
  DBMS_OUTPUT.put_line(err_msg);
  
  ROLLBACK;
  RAISE;
END;
/
EXIT;

