--Truncado de tablas TDX
TRUNCATE TABLE MINIREC.VAL_PRE_JUDICIAL;

--Generacion de las tablas TDX
INSERT INTO VAL_PRE_JUDICIAL(
ID_ASUNTO_HRE
,NUM_CUENTA
,ID_USUARIO_HAYA
,FC_ALTA_PRECONTENCIOSO
)
SELECT 
ASU.ASU_ID AS ID_ASUNTO_HRE
,CNT.CNT_CONTRATO AS NUM_CUENTA
,USU.USU_USERNAME AS ID_USUARIO_HAYA
,PCO.FECHACREAR AS FC_ALTA_PRECONTENCIOSO
FROM HAYA01.ASU_ASUNTOS ASU
INNER JOIN HAYA01.PRC_PROCEDIMIENTOS PRC ON PRC.ASU_ID = ASU.ASU_ID
INNER JOIN HAYA01.CEX_CONTRATOS_EXPEDIENTE CEX ON CEX.EXP_ID = ASU.EXP_ID
INNER JOIN HAYA01.CNT_CONTRATOS CNT ON CNT.CNT_ID = CEX.CNT_ID
INNER JOIN HAYA01.DD_TAC_TIPO_ACTUACION TAC ON  TAC.DD_TAC_ID=PRC.DD_TAC_ID
INNER JOIN HAYA01.PCO_PRC_PROCEDIMIENTOS PCO ON PCO.PRC_ID=PRC.PRC_ID
INNER JOIN HAYA01.GAA_GESTOR_ADICIONAL_ASUNTO GAA ON GAA.ASU_ID = ASU.ASU_ID
INNER JOIN HAYAMASTER.DD_TGE_TIPO_GESTOR TGE ON GAA.DD_TGE_ID=TGE.DD_TGE_ID
INNER JOIN HAYA01.USD_USUARIOS_DESPACHOS USD ON USD.USD_ID=GAA.USD_ID
INNER JOIN HAYAMASTER.USU_USUARIOS USU ON USU.USU_ID=USD.USU_ID
WHERE  TAC.DD_TAC_CODIGO LIKE 'PCO'
AND TGE.DD_TGE_CODIGO LIKE 'PREDOC'

;