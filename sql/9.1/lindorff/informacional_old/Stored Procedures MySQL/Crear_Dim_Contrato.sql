-- --------------------------------------------------------------------------------
-- Routine DDL
-- Note: comments before and after the routine body will not be stored by the server
-- --------------------------------------------------------------------------------
DELIMITER $$

CREATE DEFINER=`lindorff`@`62.15.160.2` PROCEDURE `Crear_Dim_Contrato`(OUT o_error_status varchar(500))
MY_BLOCK_DIM_CNT: BEGIN

-- ===============================================================================================
-- Autor: Gonzalo Martín, PFS Group
-- Fecha creación: Septiembre 2013
-- Responsable última modificación: Gonzalo Martín, PFS Group
-- Fecha última modificación: 10/12/2013
-- Motivos del cambio: SP Lindorff v0
-- Cliente: Recovery BI Lindorff  
--
-- Descripción: Procedimiento almancenado que crea las tablas de la dimensión Contrato.
-- ===============================================================================================

-- --------------------------------------------------------------------------------
-- DEFINICIÓN DE LOS HANDLER DE ERROR
-- --------------------------------------------------------------------------------
DECLARE EXIT handler for 1062 set o_error_status := 'Error 1062: La tabla ya existe';
DECLARE EXIT handler for 1048 set o_error_status := 'Error 1048: Has intentado insertar un valor nulo'; 
DECLARE EXIT handler for 1318 set o_error_status := 'Error 1318: Número de parámetros incorrecto'; 

-- --------------------------------------------------------------------------------
-- DEFINICIÓN DEL HANDLER GENÉRICO DE ERROR
-- --------------------------------------------------------------------------------
DECLARE EXIT handler for sqlexception set o_error_status:= 'Se ha producido un error en el proceso';


  CREATE TABLE IF NOT EXISTS DIM_CONTRATO_ESTADO_FINANCIERO (
  `ESTADO_FINANCIERO_CONTRATO_ID` DECIMAL(16,0) NOT NULL ,
  `ESTADO_FINANCIERO_CONTRATO_DESC` VARCHAR(50) NULL ,
  `ESTADO_FINANCIERO_CONTRATO_DESC_ALT` VARCHAR(250) NULL ,
  `ESTADO_FINANCIERO_CONTRATO_AGRUPADO_ID` DECIMAL(16,0) NULL ,
  PRIMARY KEY (`ESTADO_FINANCIERO_CONTRATO_ID`));
  

  CREATE TABLE IF NOT EXISTS DIM_CONTRATO_ESTADO_FINANCIERO_AGRUPADO (
  `ESTADO_FINANCIERO_CONTRATO_AGRUPADO_ID` DECIMAL(16,0) NOT NULL ,
  `ESTADO_FINANCIERO_CONTRATO_AGRUPADO_DESC` VARCHAR(50) NULL ,
  PRIMARY KEY (`ESTADO_FINANCIERO_CONTRATO_AGRUPADO_ID`));
  
           
  CREATE TABLE IF NOT EXISTS DIM_CONTRATO_ESTADO_FINANCIERO_ANTERIOR (
  `ESTADO_FINANCIERO_ANTERIOR_ID` DECIMAL(16,0) NOT NULL ,
  `ESTADO_FINANCIERO_ANTERIOR_DESC` VARCHAR(50) NULL ,
  `ESTADO_FINANCIERO_ANTERIOR_DESC_ALT` VARCHAR(250) NULL ,
  `ESTADO_FINANCIERO_ANTERIOR_AGRUPADO_ID` DECIMAL(16,0) NULL ,
  PRIMARY KEY (`ESTADO_FINANCIERO_ANTERIOR_ID`));
   
   
  CREATE TABLE IF NOT EXISTS DIM_CONTRATO_ESTADO_FINANCIERO_ANTERIOR_AGRUPADO  (
  `ESTADO_FINANCIERO_ANTERIOR_AGRUPADO_ID` DECIMAL(16,0) NOT NULL ,
  `ESTADO_FINANCIERO_ANTERIOR_AGRUPADO_DESC` VARCHAR(50) NULL ,
  PRIMARY KEY (`ESTADO_FINANCIERO_ANTERIOR_AGRUPADO_ID`));
  
  CREATE TABLE IF NOT EXISTS DIM_CONTRATO_ESTADO_CONTRATO( 
  `ESTADO_CONTRATO_ID` DECIMAL(16,0) NOT NULL ,
  `ESTADO_CONTRATO_DESC` VARCHAR(50) NULL ,
  `ESTADO_CONTRATO_DESC_ALT` VARCHAR(250) NULL ,
  PRIMARY KEY (`ESTADO_CONTRATO_ID`));
    
  CREATE TABLE IF NOT EXISTS DIM_CONTRATO_TIPO_PRODUCTO( 
  `TIPO_PRODUCTO_ID` DECIMAL(16,0) NOT NULL ,
  `TIPO_PRODUCTO_DESC` VARCHAR(50) NULL ,
  `TIPO_PRODUCTO_DESC_ALT` VARCHAR(250) NULL ,
  PRIMARY KEY (`TIPO_PRODUCTO_ID`));
 
    
   CREATE TABLE IF NOT EXISTS DIM_CONTRATO_PRODUCTO( 
  `PRODUCTO_ID` DECIMAL(16,0) NOT NULL ,
  `PRODUCTO_DESC` VARCHAR(50) NULL ,
  `PRODUCTO_DESC_ALT` VARCHAR(250) NULL ,
  `TIPO_PRODUCTO_ID` DECIMAL(16,0) NULL ,
  PRIMARY KEY (`PRODUCTO_ID`));
 

  CREATE TABLE IF NOT EXISTS DIM_CONTRATO_FINALIDAD_CONTRATO( 
  `FINALIDAD_CONTRATO_ID` DECIMAL(16,0) NOT NULL ,
  `FINALIDAD_CONTRATO_DESC` VARCHAR(50) NULL ,
  `FINALIDAD_CONTRATO_DESC_ALT` VARCHAR(250) NULL ,
  PRIMARY KEY (`FINALIDAD_CONTRATO_ID`));
  

  CREATE TABLE IF NOT EXISTS DIM_CONTRATO_FINALIDAD_OFICIAL( 
  `FINALIDAD_OFICIAL_ID` DECIMAL(16,0) NOT NULL ,
  `FINALIDAD_OFICIAL_DESC` VARCHAR(50) NULL ,
  `FINALIDAD_OFICIAL_DESC_ALT` VARCHAR(250) NULL ,
  PRIMARY KEY (`FINALIDAD_OFICIAL_ID`));
  
  
  CREATE TABLE IF NOT EXISTS DIM_CONTRATO_GARANTIA_CONTABLE( 
  `GARANTIA_CONTABLE_ID` DECIMAL(16,0) NOT NULL ,
  `GARANTIA_CONTABLE_DESC` VARCHAR(50) NULL ,
  `GARANTIA_CONTABLE_DESC_ALT` VARCHAR(250) NULL ,
  PRIMARY KEY (`GARANTIA_CONTABLE_ID`));
  
      
  CREATE TABLE IF NOT EXISTS DIM_CONTRATO_GARANTIA_CONTRATO( 
  `GARANTIA_CONTRATO_ID` DECIMAL(16,0) NOT NULL ,
  `GARANTIA_CONTRATO_DESC` VARCHAR(50) NULL ,
  `GARANTIA_CONTRATO_DESC_ALT` VARCHAR(250) NULL ,
  `GARANTIA_CONTRATO_AGRUPADO_ID` DECIMAL(16,0) NULL ,
  PRIMARY KEY (`GARANTIA_CONTRATO_ID`));
  
    
 CREATE TABLE IF NOT EXISTS DIM_CONTRATO_MONEDA( 
  `MONEDA_ID` DECIMAL(16,0) NOT NULL ,
  `MONEDA_DESC` VARCHAR(50) NULL ,
  `MONEDA_DESC_ALT` VARCHAR(250) NULL ,
  PRIMARY KEY (`MONEDA_ID`));
  

  CREATE TABLE IF NOT EXISTS DIM_CONTRATO_ZONA( 
  `ZONA_CONTRATO_ID` DECIMAL(16,0) NOT NULL ,
  `ZONA_CONTRATO_DESC` VARCHAR(50) NULL ,
  `ZONA_CONTRATO_DESC_ALT` VARCHAR(250) NULL ,
  `NIVEL_CONTRATO_ID` DECIMAL(16,0) NULL ,
  `OFICINA_CONTRATO_ID` DECIMAL(16,0) NULL ,
  PRIMARY KEY (`ZONA_CONTRATO_ID`));
  
    
  CREATE TABLE IF NOT EXISTS DIM_CONTRATO_NIVEL( 
  `NIVEL_CONTRATO_ID` DECIMAL(16,0) NOT NULL ,
  `NIVEL_CONTRATO_DESC` VARCHAR(50) NULL ,
  `NIVEL_CONTRATO_DESC_ALT` VARCHAR(250) NULL ,
  PRIMARY KEY (`NIVEL_CONTRATO_ID`));
  
  
  CREATE TABLE IF NOT EXISTS DIM_CONTRATO_OFICINA( 
  `OFICINA_CONTRATO_ID` DECIMAL(16,0) NOT NULL ,
  `OFICINA_CONTRATO_DESC` VARCHAR(50) NULL ,
  `OFICINA_CONTRATO_DESC_ALT` VARCHAR(250) NULL ,
  `PROVINCIA_CONTRATO_ID` DECIMAL(16,0) NULL ,
  PRIMARY KEY (`OFICINA_CONTRATO_ID`));
  
    
  CREATE TABLE IF NOT EXISTS DIM_CONTRATO_PROVINCIA( 
  `PROVINCIA_CONTRATO_ID` DECIMAL(16,0) NOT NULL ,
  `PROVINCIA_CONTRATO_DESC` VARCHAR(50) NULL ,
  `PROVINCIA_CONTRATO_DESC_ALT` VARCHAR(250) NULL ,
  PRIMARY KEY (`PROVINCIA_CONTRATO_ID`));
  
    
  CREATE TABLE IF NOT EXISTS DIM_CONTRATO_CATALOGO_DETALLE_6( 
  `CATALOGO_DETALLE_6_ID` DECIMAL(16,0) NOT NULL ,
  `CATALOGO_DETALLE_6_DESC` VARCHAR(50) NULL ,
  `CATALOGO_DETALLE_6_DESC_ALT` VARCHAR(250) NULL ,
  `CATALOGO_DETALLE_5_ID` DECIMAL(16,0) NULL ,
  PRIMARY KEY (`CATALOGO_DETALLE_6_ID`));
  
  
  CREATE TABLE IF NOT EXISTS DIM_CONTRATO_CATALOGO_DETALLE_5( 
  `CATALOGO_DETALLE_5_ID` DECIMAL(16,0) NOT NULL ,
  `CATALOGO_DETALLE_5_DESC` VARCHAR(50) NULL ,
  `CATALOGO_DETALLE_5_DESC_ALT` VARCHAR(250) NULL ,
  `CATALOGO_DETALLE_4_ID` DECIMAL(16,0) NULL ,
  PRIMARY KEY (`CATALOGO_DETALLE_5_ID`));

  
  CREATE TABLE IF NOT EXISTS DIM_CONTRATO_CATALOGO_DETALLE_4( 
  `CATALOGO_DETALLE_4_ID` DECIMAL(16,0) NOT NULL ,
  `CATALOGO_DETALLE_4_DESC` VARCHAR(50) NULL ,
  `CATALOGO_DETALLE_4_DESC_ALT` VARCHAR(250) NULL ,
  `CATALOGO_DETALLE_3_ID` DECIMAL(16,0) NULL ,
  PRIMARY KEY (`CATALOGO_DETALLE_4_ID`));
  
  
  CREATE TABLE IF NOT EXISTS DIM_CONTRATO_CATALOGO_DETALLE_3( 
  `CATALOGO_DETALLE_3_ID` DECIMAL(16,0) NOT NULL ,
  `CATALOGO_DETALLE_3_DESC` VARCHAR(50) NULL ,
  `CATALOGO_DETALLE_3_DESC_ALT` VARCHAR(250) NULL ,
  `CATALOGO_DETALLE_2_ID` DECIMAL(16,0) NULL ,
  PRIMARY KEY (`CATALOGO_DETALLE_3_ID`));

  
  CREATE TABLE IF NOT EXISTS DIM_CONTRATO_CATALOGO_DETALLE_2( 
  `CATALOGO_DETALLE_2_ID` DECIMAL(16,0) NOT NULL ,
  `CATALOGO_DETALLE_2_DESC` VARCHAR(50) NULL ,
  `CATALOGO_DETALLE_2_DESC_ALT` VARCHAR(250) NULL ,
  `CATALOGO_DETALLE_1_ID` DECIMAL(16,0) NULL ,
  PRIMARY KEY (`CATALOGO_DETALLE_2_ID`));
  
  
  CREATE TABLE IF NOT EXISTS DIM_CONTRATO_CATALOGO_DETALLE_1( 
  `CATALOGO_DETALLE_1_ID` DECIMAL(16,0) NOT NULL ,
  `CATALOGO_DETALLE_1_DESC` VARCHAR(50) NULL ,
  `CATALOGO_DETALLE_1_DESC_ALT` VARCHAR(250) NULL ,
  PRIMARY KEY (`CATALOGO_DETALLE_1_ID`));
  
    
  -- Heredado del Titular del contrato  
  CREATE TABLE IF NOT EXISTS DIM_CONTRATO_NACIONALIDAD_TITULAR (
  `NACIONALIDAD_TITULAR_ID` DECIMAL(16,0) NOT NULL ,
  `NACIONALIDAD_TITULAR_DESC` VARCHAR(50) NULL ,
  `NACIONALIDAD_TITULAR_DESC_ALT` VARCHAR(250) NULL ,
  PRIMARY KEY (`NACIONALIDAD_TITULAR_ID`));
 
    
  CREATE TABLE IF NOT EXISTS DIM_CONTRATO_POLITICA_TITULAR(
  `POLITICA_TITULAR_ID` DECIMAL(16,0) NOT NULL ,
  `POLITICA_TITULAR_DESC` VARCHAR(50) NULL ,
  `POLITICA_TITULAR_DESC_ALT` VARCHAR(250) NULL ,
  PRIMARY KEY (`POLITICA_TITULAR_ID`));  
  
  
  CREATE TABLE IF NOT EXISTS DIM_CONTRATO_SEGMENTO_TITULAR(
  `SEGMENTO_TITULAR_ID` DECIMAL(16,0) NOT NULL ,
  `SEGMENTO_TITULAR_DESC` VARCHAR(50) NULL ,
  `SEGMENTO_TITULAR_DESC_ALT` VARCHAR(250) NULL ,
  `SEGMENTO_TITULAR_AGRUPADO_ID` DECIMAL(16,0) NULL ,
  PRIMARY KEY (`SEGMENTO_TITULAR_ID`));
  
    
  CREATE TABLE IF NOT EXISTS DIM_CONTRATO_SEXO_TITULAR( 
  `SEXO_TITULAR_ID` DECIMAL(16,0) NOT NULL ,
  `SEXO_TITULAR_DESC` VARCHAR(50) NULL ,
  PRIMARY KEY (`SEXO_TITULAR_ID`));
  
  
  CREATE TABLE IF NOT EXISTS DIM_CONTRATO_SITUACION( 
  `SITUACION_CONTRATO_ID` DECIMAL(16,0) NOT NULL ,
  `SITUACION_CONTRATO_DESC` VARCHAR(50) NULL ,
  PRIMARY KEY (`SITUACION_CONTRATO_ID`)); 
  
  
  CREATE TABLE IF NOT EXISTS DIM_CONTRATO_SITUACION_DETALLE( 
  `SITUACION_CONTRATO_DETALLE_ID` DECIMAL(16,0) NOT NULL ,
  `SITUACION_CONTRATO_DETALLE_DESC` VARCHAR(50) NULL ,
  `SITUACION_CONTRATO_ID` DECIMAL(16,0) NULL ,
  PRIMARY KEY (`SITUACION_CONTRATO_DETALLE_ID`)); 
   
    
  CREATE TABLE IF NOT EXISTS DIM_CONTRATO_SITUACION_ANTERIOR( 
  `SITUACION_ANTERIOR_CONTRATO_ID` DECIMAL(16,0) NOT NULL ,
  `SITUACION_ANTERIOR_CONTRATO_DESC` VARCHAR(50) NULL ,
  PRIMARY KEY (`SITUACION_ANTERIOR_CONTRATO_ID`)); 
  
    
  CREATE TABLE IF NOT EXISTS DIM_CONTRATO_SITUACION_ANTERIOR_DETALLE( 
  `SITUACION_ANTERIOR_CONTRATO_DETALLE_ID` DECIMAL(16,0) NOT NULL ,
  `SITUACION_ANTERIOR_CONTRATO_DETALLE_DESC` VARCHAR(50) NULL ,
  `SITUACION_ANTERIOR_CONTRATO_ID` DECIMAL(16,0) NULL ,
  PRIMARY KEY (`SITUACION_ANTERIOR_CONTRATO_DETALLE_ID`)); 
  
    
  CREATE TABLE IF NOT EXISTS DIM_CONTRATO_SITUACION_RESPECTO_PERIODO_ANT( 
  `SITUACION_RESPECTO_PERIODO_ANT_ID` DECIMAL(16,0) NOT NULL ,
  `SITUACION_RESPECTO_PERIODO_ANT_DESC` VARCHAR(50) NULL ,
  PRIMARY KEY (`SITUACION_RESPECTO_PERIODO_ANT_ID`)); 
  
    
  CREATE TABLE IF NOT EXISTS DIM_CONTRATO_TIPO_PERSONA_TITULAR(
  `TIPO_PERSONA_TITULAR_ID` DECIMAL(16,0) NOT NULL ,
  `TIPO_PERSONA_TITULAR_DESC` VARCHAR(50) NULL ,
  `TIPO_PERSONA_TITULAR_DESC_ALT` VARCHAR(250) NULL ,
  PRIMARY KEY (`TIPO_PERSONA_TITULAR_ID`));
 
    
  CREATE TABLE IF NOT EXISTS DIM_CONTRATO_JUDICIALIZADO( 
  `CONTRATO_JUDICIALIZADO_ID` DECIMAL(16,0) NOT NULL ,
  `CONTRATO_JUDICIALIZADO_DESC` VARCHAR(50) NULL ,
  PRIMARY KEY (`CONTRATO_JUDICIALIZADO_ID`));
  
   
  CREATE TABLE IF NOT EXISTS DIM_CONTRATO_ESTADO_JUDICIALIZADO( 
  `CONTRATO_ESTADO_JUDICIALIZADO_ID` DECIMAL(16,0) NOT NULL ,
  `CONTRATO_ESTADO_JUDICIALIZADO_DESC` VARCHAR(50) NULL ,
  PRIMARY KEY (`CONTRATO_ESTADO_JUDICIALIZADO_ID`));
  
  
  CREATE TABLE IF NOT EXISTS DIM_CONTRATO_ESTADO_INSINUACION_CONTRATO(
  `ESTADO_INSINUACION_CONTRATO_ID` DECIMAL(16,0) NOT NULL ,
  `ESTADO_INSINUACION_CONTRATO_DESC` VARCHAR(50) NULL ,
  `ESTADO_INSINUACION_CONTRATO_DESC_ALT` VARCHAR(250) NULL ,
  PRIMARY KEY (`ESTADO_INSINUACION_CONTRATO_ID`)); 
  
  
  CREATE TABLE IF NOT EXISTS DIM_CONTRATO_CEDENTE( 
  `CEDENTE_CONTRATO_ID` DECIMAL(16,0) NOT NULL ,
  `CEDENTE_CONTRATO_DESC` VARCHAR(50) NULL ,
  PRIMARY KEY (`CEDENTE_CONTRATO_ID`));
  
  
  CREATE TABLE IF NOT EXISTS DIM_CONTRATO_PROPIETARIO( 
  `PROPIETARIO_CONTRATO_ID` DECIMAL(16,0) NOT NULL ,
  `PROPIETARIO_CONTRATO_DESC` VARCHAR(50) NULL ,
  PRIMARY KEY (`PROPIETARIO_CONTRATO_ID`));
  
  
  CREATE TABLE IF NOT EXISTS DIM_CONTRATO_CARTERA( 
  `CARTERA_CONTRATO_ID` DECIMAL(16,0) NOT NULL ,
  `CARTERA_CONTRATO_DESC` VARCHAR(50) NULL ,
  `TIPO_CARTERA_CONTRATO_ID` DECIMAL(16,0) NOT NULL ,
  PRIMARY KEY (`CARTERA_CONTRATO_ID`));

  
  CREATE TABLE IF NOT EXISTS DIM_CONTRATO_TIPO_CARTERA( 
  `TIPO_CARTERA_CONTRATO_ID` DECIMAL(16,0) NOT NULL ,
  `TIPO_CARTERA_CONTRATO_DESC` VARCHAR(50) NULL ,
  PRIMARY KEY (`TIPO_CARTERA_CONTRATO_ID`));
  
  
  CREATE TABLE IF NOT EXISTS DIM_CONTRATO_TRAMO_IRREGULARIDAD_DIAS (
  `TRAMO_IRREGULARIDAD_DIAS_ID` DECIMAL(16,0) NOT NULL ,
  `TRAMO_IRREGULARIDAD_DIAS_DESC` VARCHAR(50) NULL ,
  PRIMARY KEY (`TRAMO_IRREGULARIDAD_DIAS_ID`));
  
  
  CREATE TABLE IF NOT EXISTS DIM_CONTRATO_TRAMO_IRREGULARIDAD_DIAS_PERIODO_ANT (
  `TRAMO_IRREGULARIDAD_DIAS_PERIODO_ANT_ID` DECIMAL(16,0) NOT NULL ,
  `TRAMO_IRREGULARIDAD_DIAS_PERIODO_ANT_DESC` VARCHAR(50) NULL ,
  PRIMARY KEY (`TRAMO_IRREGULARIDAD_DIAS_PERIODO_ANT_ID`));
  
    
  CREATE TABLE IF NOT EXISTS DIM_CONTRATO_TRAMO_IRREGULARIDAD_FASES (
  `TRAMO_IRREGULARIDAD_FASES_ID` DECIMAL(16,0) NOT NULL ,
  `TRAMO_IRREGULARIDAD_FASES_DESC` VARCHAR(50) NULL ,
  `TRAMO_IRREGULARIDAD_FASES_AGRUPADO_ID` DECIMAL(16,0) NOT NULL ,
  PRIMARY KEY (`TRAMO_IRREGULARIDAD_FASES_ID`)); 

  
  CREATE TABLE IF NOT EXISTS DIM_CONTRATO_TRAMO_IRREGULARIDAD_FASES_PERIODO_ANT (
  `TRAMO_IRREGULARIDAD_FASES_PERIODO_ANT_ID` DECIMAL(16,0) NOT NULL ,
  `TRAMO_IRREGULARIDAD_FASES_PERIODO_ANT_DESC` VARCHAR(50) NULL ,
  `TRAMO_IRREGULARIDAD_FASES_AGRUPADO_PERIODO_ANT_ID` DECIMAL(16,0) NOT NULL ,
  PRIMARY KEY (`TRAMO_IRREGULARIDAD_FASES_PERIODO_ANT_ID`)); 

  
  CREATE TABLE IF NOT EXISTS DIM_CONTRATO_TRAMO_IRREGULARIDAD_FASES_AGRUPADO (
  `TRAMO_IRREGULARIDAD_FASES_AGRUPADO_ID` DECIMAL(16,0) NOT NULL ,
  `TRAMO_IRREGULARIDAD_FASES_AGRUPADO_DESC` VARCHAR(50) NULL ,
  PRIMARY KEY (`TRAMO_IRREGULARIDAD_FASES_AGRUPADO_ID`)); 
 
    
  CREATE TABLE IF NOT EXISTS DIM_CONTRATO_TRAMO_IRREGULARIDAD_FASES_AGRUPADO_PERIODO_ANT (
  `TRAMO_IRREGULARIDAD_FASES_AGRUPADO_PERIODO_ANT_ID` DECIMAL(16,0) NOT NULL ,
  `TRAMO_IRREGULARIDAD_FASES_AGRUPADO_PERIODO_ANT_DESC` VARCHAR(50) NULL ,
  PRIMARY KEY (`TRAMO_IRREGULARIDAD_FASES_AGRUPADO_PERIODO_ANT_ID`)); 

  
  CREATE TABLE IF NOT EXISTS DIM_CONTRATO_TRAMO_DIAS_EN_GESTION_A_COBRO (
  `TRAMO_DIAS_EN_GESTION_A_COBRO_ID` DECIMAL(16,0) NOT NULL ,
  `TRAMO_DIAS_EN_GESTION_A_COBRO_DESC` VARCHAR(50) NULL ,
  PRIMARY KEY (`TRAMO_DIAS_EN_GESTION_A_COBRO_ID`)); 

  
  CREATE TABLE IF NOT EXISTS DIM_CONTRATO_TRAMO_DIAS_IRREGULAR_A_COBRO (
  `TRAMO_DIAS_IRREGULAR_A_COBRO_ID` DECIMAL(16,0) NOT NULL ,
  `TRAMO_DIAS_IRREGULAR_A_COBRO_DESC` VARCHAR(50) NULL ,
  PRIMARY KEY (`TRAMO_DIAS_IRREGULAR_A_COBRO_ID`)); 
  
    
  CREATE TABLE IF NOT EXISTS DIM_CONTRATO_GARANTIA_CONTRATO_AGRUPADO( 
  `GARANTIA_CONTRATO_AGRUPADO_ID` DECIMAL(16,0) NOT NULL ,
  `GARANTIA_CONTRATO_AGRUPADO_DESC` VARCHAR(50) NULL ,
  PRIMARY KEY (`GARANTIA_CONTRATO_AGRUPADO_ID`));
 
      
  CREATE TABLE IF NOT EXISTS DIM_CONTRATO_SEGMENTO_TITULAR_AGRUPADO(
  `SEGMENTO_TITULAR_AGRUPADO_ID` DECIMAL(16,0) NOT NULL ,
  `SEGMENTO_TITULAR_AGRUPADO_DESC` VARCHAR(50) NULL ,
  PRIMARY KEY (`SEGMENTO_TITULAR_AGRUPADO_ID`));
  
   
  CREATE TABLE IF NOT EXISTS DIM_CONTRATO_RESULTADO_ACTUACION(
  `RESULTADO_ACTUACION_CONTRATO_ID` DECIMAL(16,0) NOT NULL ,
  `RESULTADO_ACTUACION_CONTRATO_DESC` VARCHAR(50) NULL ,
  PRIMARY KEY (`RESULTADO_ACTUACION_CONTRATO_ID`));
 
    
  CREATE TABLE IF NOT EXISTS DIM_CONTRATO_EN_GESTION_RECOBRO( 
  `EN_GESTION_RECOBRO_ID` DECIMAL(16,0) NOT NULL ,
  `EN_GESTION_RECOBRO_DESC` VARCHAR(50) NULL ,
  PRIMARY KEY (`EN_GESTION_RECOBRO_ID`));
 
    
  CREATE TABLE IF NOT EXISTS DIM_CONTRATO_EN_IRREGULAR( 
  `CONTRATO_EN_IRREGULAR_ID` DECIMAL(16,0) NOT NULL ,
  `CONTRATO_EN_IRREGULAR_DESC` VARCHAR(50) NULL ,
  PRIMARY KEY (`CONTRATO_EN_IRREGULAR_ID`));
  
    
  CREATE TABLE IF NOT EXISTS DIM_CONTRATO_MODELO_RECOBRO( 
  `MODELO_RECOBRO_CONTRATO_ID` DECIMAL(16,0) NOT NULL ,
  `MODELO_RECOBRO_CONTRATO_ALT` VARCHAR(50) NULL ,
  `MODELO_RECOBRO_CONTRATO_DESC_ALT` VARCHAR(250) NULL ,
  PRIMARY KEY (`MODELO_RECOBRO_CONTRATO_ID`));
  
  
  CREATE TABLE IF NOT EXISTS DIM_CONTRATO_PROVEEDOR_RECOBRO (
  `PROVEEDOR_RECOBRO_CONTRATO_ID` DECIMAL(16,0) NOT NULL ,
  `PROVEEDOR_RECOBRO_CONTRATO_DESC` VARCHAR(50) NULL ,
  `PROVEEDOR_RECOBRO_CONTRATO_DESC_ALT` VARCHAR(250) NULL ,
  PRIMARY KEY (`PROVEEDOR_RECOBRO_CONTRATO_ID`));
 
  
  CREATE TABLE IF NOT EXISTS DIM_CONTRATO_CON_DPS( 
  `CONTRATO_CON_DPS_ID` DECIMAL(16,0) NOT NULL ,
  `CONTRATO_CON_DPS_DESC` VARCHAR(50) NULL ,
  PRIMARY KEY (`CONTRATO_CON_DPS_ID`));
 
    
  CREATE TABLE IF NOT EXISTS DIM_CONTRATO_CON_CONTACTO_UTIL( 
  `CONTRATO_CON_CONTACTO_UTIL_ID` DECIMAL(16,0) NOT NULL ,
  `CONTRATO_CON_CONTACTO_UTIL_DESC` VARCHAR(50) NULL ,
  PRIMARY KEY (`CONTRATO_CON_CONTACTO_UTIL_ID`));
  
    
  CREATE TABLE IF NOT EXISTS DIM_CONTRATO_CON_ACTUACION_RECOBRO( 
  `CONTRATO_CON_ACTUACION_RECOBRO_ID` DECIMAL(16,0) NOT NULL ,
  `CONTRATO_CON_ACTUACION_RECOBRO_DESC` VARCHAR(50) NULL ,
  PRIMARY KEY (`CONTRATO_CON_ACTUACION_RECOBRO_ID`));

  
  CREATE TABLE IF NOT EXISTS DIM_CONTRATO_ESTADO_FINANCIERO_INICIO_CAMPANA_RECOBRO (
  `ESTADO_FINANCIERO_CONTRATO_INICIO_CAMPANA_RECOBRO_ID` DECIMAL(16,0) NOT NULL ,
  `ESTADO_FINANCIERO_CONTRATO_INICIO_CAMPANA_RECOBRO_DESC` VARCHAR(50) NULL ,
  `ESTADO_FINANCIERO_CONTRATO_INICIO_CAMPANA_RECOBRO_DESC_ALT` VARCHAR(250) NULL ,
  PRIMARY KEY (`ESTADO_FINANCIERO_CONTRATO_INICIO_CAMPANA_RECOBRO_ID`));
  
   
  CREATE TABLE IF NOT EXISTS DIM_CONTRATO_ESTADO_FINANCIERO_ANTERIOR_INICIO_CAMPANA_RECOBRO (
  `ESTADO_FINANCIERO_ANTERIOR_INICIO_CAMPANA_RECOBRO_ID` DECIMAL(16,0) NOT NULL ,
  `ESTADO_FINANCIERO_ANTERIOR_INICIO_CAMPANA_RECOBRO_DESC` VARCHAR(50) NULL ,
  `ESTADO_FINANCIERO_ANTERIOR_INICIO_CAMPANA_RECOBRO_DESC_ALT` VARCHAR(250) NULL ,
  PRIMARY KEY (`ESTADO_FINANCIERO_ANTERIOR_INICIO_CAMPANA_RECOBRO_ID`));
  
    
  CREATE TABLE IF NOT EXISTS DIM_CONTRATO_EN_GESTION_RECOBRO_INICIO_CAMPANA_RECOBRO( 
  `EN_GESTION_RECOBRO_INICIO_CAMPANA_RECOBRO_ID` DECIMAL(16,0) NOT NULL ,
  `EN_GESTION_RECOBRO_INICIO_CAMPANA_RECOBRO_DESC` VARCHAR(50) NULL ,
  PRIMARY KEY (`EN_GESTION_RECOBRO_INICIO_CAMPANA_RECOBRO_ID`));
 
    
  CREATE TABLE IF NOT EXISTS DIM_CONTRATO_EN_IRREGULAR_INICIO_CAMPANA_RECOBRO( 
  `CONTRATO_EN_IRREGULAR_INICIO_CAMPANA_RECOBRO_ID` DECIMAL(16,0) NOT NULL ,
  `CONTRATO_EN_IRREGULAR_INICIO_CAMPANA_RECOBRO_DESC` VARCHAR(50) NULL ,
  PRIMARY KEY (`CONTRATO_EN_IRREGULAR_INICIO_CAMPANA_RECOBRO_ID`));

    
  CREATE TABLE IF NOT EXISTS DIM_CONTRATO_MODELO_RECOBRO_INICIO_CAMPANA_RECOBRO( 
  `MODELO_RECOBRO_CONTRATO_INICIO_CAMPANA_RECOBRO_ID` DECIMAL(16,0) NOT NULL ,
  `MODELO_RECOBRO_CONTRATO_INICIO_CAMPANA_RECOBRO_DESC` VARCHAR(50) NULL ,
  `MODELO_RECOBRO_CONTRATO_INICIO_CAMPANA_RECOBRO_DESC_ALT` VARCHAR(250) NULL ,
  PRIMARY KEY (`MODELO_RECOBRO_CONTRATO_INICIO_CAMPANA_RECOBRO_ID`));
 
  
  CREATE TABLE IF NOT EXISTS DIM_CONTRATO_PROVEEDOR_RECOBRO_INICIO_CAMPANA_RECOBRO (
  `PROVEEDOR_RECOBRO_CONTRATO_INICIO_CAMPANA_RECOBRO_ID` DECIMAL(16,0) NOT NULL ,
  `PROVEEDOR_RECOBRO_CONTRATO_INICIO_CAMPANA_RECOBRO_DESC` VARCHAR(50) NULL ,
  `PROVEEDOR_RECOBRO_CONTRATO_INICIO_CAMPANA_RECOBRO_DESC_ALT` VARCHAR(250) NULL ,
  PRIMARY KEY (`PROVEEDOR_RECOBRO_CONTRATO_INICIO_CAMPANA_RECOBRO_ID`));
  
  
  CREATE TABLE IF NOT EXISTS DIM_CONTRATO_TRAMO_IRREGULARIDAD_DIAS_INICIO_CAMPANA_RECOBRO (
  `TRAMO_IRREGULARIDAD_DIAS_INICIO_CAMPANA_RECOBRO_ID` DECIMAL(16,0) NOT NULL ,
  `TRAMO_IRREGULARIDAD_DIAS_INICIO_CAMPANA_RECOBRO_DESC` VARCHAR(50) NULL ,
  PRIMARY KEY (`TRAMO_IRREGULARIDAD_DIAS_INICIO_CAMPANA_RECOBRO_ID`));
         
         
  CREATE TABLE IF NOT EXISTS DIM_CONTRATO_TRAMO_IRREGULARIDAD_FASES_INICIO_CAMPANA_RECOBRO (
  `TRAMO_IRREGULARIDAD_FASES_INICIO_CAMPANA_RECOBRO_ID` DECIMAL(16,0) NOT NULL ,
  `TRAMO_IRREGULARIDAD_FASES_INICIO_CAMPANA_RECOBRO_DESC` VARCHAR(50) NULL ,
  `TRAMO_IRREGULARIDAD_FASES_AGRUPADO_INICIO_CAMPANA_RECOBRO_ID` DECIMAL(16,0) NOT NULL ,
  PRIMARY KEY (`TRAMO_IRREGULARIDAD_FASES_INICIO_CAMPANA_RECOBRO_ID`)); 
         

  CREATE TABLE IF NOT EXISTS DIM_CONTRATO_TRAMO_IRREG_FASES_AGRUPADO_INICIO_CAMPANA_RECOBRO (
  `TRAMO_IRREGULARIDAD_FASES_AGRUPADO_INICIO_CAMPANA_RECOBRO_ID` DECIMAL(16,0) NOT NULL ,
  `TRAMO_IRREGULARIDAD_FASES_AGRUPADO_INICIO_CAMPANA_RECOBRO_DESC` VARCHAR(50) NULL ,
  PRIMARY KEY (`TRAMO_IRREGULARIDAD_FASES_AGRUPADO_INICIO_CAMPANA_RECOBRO_ID`)); 
         
  
  CREATE TABLE IF NOT EXISTS DIM_CONTRATO_EN_GESTION_ESPECIALIZADA( 
  `EN_GESTION_ESPECIALIZADA_ID` DECIMAL(16,0) NOT NULL ,
  `EN_GESTION_ESPECIALIZADA_DESC` VARCHAR(50) NULL ,
  PRIMARY KEY (`EN_GESTION_ESPECIALIZADA_ID`));
        
  
  CREATE TABLE IF NOT EXISTS DIM_CONTRATO_CON_PREVISION( 
  `CONTRATO_CON_PREVISION_ID` DECIMAL(16,0) NOT NULL ,
  `CONTRATO_CON_PREVISION_DESC` VARCHAR(50) NULL ,
  PRIMARY KEY (`CONTRATO_CON_PREVISION_ID`));
        
  
  CREATE TABLE IF NOT EXISTS DIM_CONTRATO_CON_PREVISION_REVISADA( 
  `CONTRATO_CON_PREVISION_REVISADA_ID` DECIMAL(16,0) NOT NULL ,
  `CONTRATO_CON_PREVISION_REVISADA_DESC` VARCHAR(50) NULL ,
  PRIMARY KEY (`CONTRATO_CON_PREVISION_REVISADA_ID`));
       
  
  CREATE TABLE IF NOT EXISTS DIM_CONTRATO_TIPO_PREVISION( 
  `TIPO_PREVISION_ID` DECIMAL(16,0) NOT NULL ,
  `TIPO_PREVISION_DESC` VARCHAR(50) NULL ,
  PRIMARY KEY (`TIPO_PREVISION_ID`));
       
  
  CREATE TABLE IF NOT EXISTS DIM_CONTRATO_PREVISION_SITUACION_INICIAL( 
  `PREVISION_SITUACION_INICIAL_ID` DECIMAL(16,0) NOT NULL ,
  `PREVISION_SITUACION_INICIAL_DESC` VARCHAR(50) NULL ,
  PRIMARY KEY (`PREVISION_SITUACION_INICIAL_ID`));
      

  CREATE TABLE IF NOT EXISTS DIM_CONTRATO_PREVISION_SITUACION_AUTOMATICO( 
  `PREVISION_SITUACION_AUTOMATICO_ID` DECIMAL(16,0) NOT NULL ,
  `PREVISION_SITUACION_AUTOMATICO_DESC` VARCHAR(50) NULL ,
  PRIMARY KEY (`PREVISION_SITUACION_AUTOMATICO_ID`));
     
 
  CREATE TABLE IF NOT EXISTS DIM_CONTRATO_PREVISION_SITUACION_MANUAL( 
  `PREVISION_SITUACION_MANUAL_ID` DECIMAL(16,0) NOT NULL ,
  `PREVISION_SITUACION_MANUAL_DESC` VARCHAR(50) NULL ,
  PRIMARY KEY (`PREVISION_SITUACION_MANUAL_ID`));
    
  
  CREATE TABLE IF NOT EXISTS DIM_CONTRATO_PREVISION_SITUACION_FINAL( 
  `PREVISION_SITUACION_FINAL_ID` DECIMAL(16,0) NOT NULL ,
  `PREVISION_SITUACION_FINAL_DESC` VARCHAR(50) NULL ,
  PRIMARY KEY (`PREVISION_SITUACION_FINAL_ID`));
   
  
  CREATE TABLE IF NOT EXISTS DIM_CONTRATO_MOTIVO_PREVISION( 
  `MOTIVO_PREVISION_ID` DECIMAL(16,0) NOT NULL ,
  `MOTIVO_PREVISION_DESC` VARCHAR(50) NULL ,
  PRIMARY KEY (`MOTIVO_PREVISION_ID`));
  
  
  CREATE TABLE IF NOT EXISTS DIM_CONTRATO_SITUACION_ESPECIALIZADA( 
  `SITUACION_ESPECIALIZADA_ID` DECIMAL(16,0) NOT NULL ,
  `SITUACION_ESPECIALIZADA_DESC` VARCHAR(50) NULL ,
  PRIMARY KEY (`SITUACION_ESPECIALIZADA_ID`));
 
  
  CREATE TABLE IF NOT EXISTS DIM_CONTRATO_GESTOR_ESPECIALIZADA( 
  `GESTOR_ESPECIALIZADA_ID` DECIMAL(16,0) NOT NULL ,
  `GESTOR_ESPECIALIZADA_DESC` VARCHAR(50) NULL ,
  PRIMARY KEY (`GESTOR_ESPECIALIZADA_ID`));


  CREATE TABLE IF NOT EXISTS DIM_CONTRATO_SUPERVISOR_N1_ESPECIALIZADA( 
  `SUPERVISOR_N1_ESPECIALIZADA_ID` DECIMAL(16,0) NOT NULL ,
  `SUPERVISOR_N1_ESPECIALIZADA_DESC` VARCHAR(50) NULL ,
  PRIMARY KEY (`SUPERVISOR_N1_ESPECIALIZADA_ID`));
  
  
  CREATE TABLE IF NOT EXISTS DIM_CONTRATO_SUPERVISOR_N2_ESPECIALIZADA( 
  `SUPERVISOR_N2_ESPECIALIZADA_ID` DECIMAL(16,0) NOT NULL ,
  `SUPERVISOR_N2_ESPECIALIZADA_DESC` VARCHAR(50) NULL ,
  PRIMARY KEY (`SUPERVISOR_N2_ESPECIALIZADA_ID`));


  CREATE TABLE IF NOT EXISTS DIM_CONTRATO_SUPERVISOR_N3_ESPECIALIZADA( 
  `SUPERVISOR_N3_ESPECIALIZADA_ID` DECIMAL(16,0) NOT NULL ,
  `SUPERVISOR_N3_ESPECIALIZADA_DESC` VARCHAR(50) NULL ,
  PRIMARY KEY (`SUPERVISOR_N3_ESPECIALIZADA_ID`));
  

  CREATE TABLE IF NOT EXISTS DIM_CONTRATO_EN_CARTERA_ESTUDIO( 
  `EN_CARTERA_ESTUDIO_ID` DECIMAL(16,0) NOT NULL ,
  `EN_CARTERA_ESTUDIO_DESC` VARCHAR(50) NULL ,
  PRIMARY KEY (`EN_CARTERA_ESTUDIO_ID`));
  
 
  CREATE TABLE IF NOT EXISTS DIM_CONTRATO_MODELO_GESTION_CARTERA( 
  `MODELO_GESTION_CARTERA_ID` DECIMAL(16,0) NOT NULL ,
  `MODELO_GESTION_CARTERA_DESC` VARCHAR(50) NULL ,
  PRIMARY KEY (`MODELO_GESTION_CARTERA_ID`));

 
  CREATE TABLE IF NOT EXISTS DIM_CONTRATO_UNIDAD_GESTION_CARTERA( 
  `UNIDAD_GESTION_CARTERA_ID` DECIMAL(16,0) NOT NULL ,
  `UNIDAD_GESTION_CARTERA_DESC` VARCHAR(50) NULL ,
  PRIMARY KEY (`UNIDAD_GESTION_CARTERA_ID`));
  
  
  CREATE TABLE IF NOT EXISTS DIM_CONTRATO_CON_CAPITAL_FALLIDO( 
  `CONTRATO_CON_CAPITAL_FALLIDO_ID` DECIMAL(16,0) NOT NULL ,
  `CONTRATO_CON_CAPITAL_FALLIDO_DESC` VARCHAR(50) NULL ,
  PRIMARY KEY (`CONTRATO_CON_CAPITAL_FALLIDO_ID`)); 
  

  CREATE TABLE IF NOT EXISTS DIM_CONTRATO( 
  `CONTRATO_ID` DECIMAL(16,0) NOT NULL ,
  `CONTRATO_COD_ENTIDAD` VARCHAR(50) NULL ,
  `CONTRATO_COD_OFICINA` VARCHAR(50) NULL ,
  `CONTRATO_COD_CENTRO` VARCHAR(50) NULL ,
  `CONTRATO_COD_CONTRATO` VARCHAR(50) NULL ,
  `CCC_LITIGIO` VARCHAR(250) NULL ,
  `NUC_LITIGIO` VARCHAR(250) NULL ,
  `IBAN_RIESGO` VARCHAR(250) NULL ,
  `TIPO_PRODUCTO_ID` DECIMAL(16,0)  NULL ,
  `PRODUCTO_ID` DECIMAL(16,0) NOT NULL ,
  `FINALIDAD_CONTRATO_ID` DECIMAL(16,0) NULL ,
  `FINALIDAD_OFICIAL_ID` DECIMAL(16,0) NULL ,
  `GARANTIA_CONTABLE_ID` DECIMAL(16,0) NULL ,
  `GARANTIA_CONTRATO_ID` DECIMAL(16,0) NULL ,
  `MONEDA_ID` DECIMAL(16,0) NULL ,
  `ZONA_CONTRATO_ID` DECIMAL(16,0) NULL ,
  `OFICINA_CONTRATO_ID` DECIMAL(16,0) NULL ,
  `CATALOGO_DETALLE_6_ID` DECIMAL(16,0) NULL ,
  -- Titular Contrato
  `NACIONALIDAD_TITULAR_ID` DECIMAL(16,0) NULL ,
  `POLITICA_TITULAR_ID` DECIMAL(16,0) NULL ,
  `SEGMENTO_TITULAR_ID` DECIMAL(16,0) NULL ,
  `SEXO_TITULAR_ID` DECIMAL(16,0) NULL ,
  `TIPO_PERSONA_TITULAR_ID` DECIMAL(16,0) NULL ,
  `CARTERA_CONTRATO_ID` DECIMAL(16,0) NULL ,
  `CEDENTE_CONTRATO_ID` DECIMAL(16,0) NOT NULL ,
  `PROPIETARIO_CONTRATO_ID` DECIMAL(16,0) NOT NULL ,
  PRIMARY KEY (`CONTRATO_ID`));
  
  
END MY_BLOCK_DIM_CNT
