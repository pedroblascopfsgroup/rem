    
--/*
--##########################################
--## AUTOR=JOSE VILLEL
--## FECHA_CREACION=20150625
--## ARTEFACTO=online
--## VERSION_ARTEFACTO=9.1
--## INCIDENCIA_LINK=FASE_1409
--## PRODUCTO=SI
--## Finalidad: DML
--##           
--## INSTRUCCIONES: Configurar las variables necesarias en el principio del DECLARE
--## VERSIONES:
--##        0.1 Versión inicial
--##########################################
--*/

--Para permitir la visualización de texto en un bloque PL/SQL utilizando DBMS_OUTPUT.PUT_LINE

WHENEVER SQLERROR EXIT SQL.SQLCODE;
SET SERVEROUTPUT ON;
SET DEFINE OFF;

DECLARE
    V_MSQL VARCHAR2(32000 CHAR); -- Sentencia a ejecutar.     
    V_ESQUEMA VARCHAR2(25 CHAR):= '#ESQUEMA#'; -- Configuracion Esquema.
    V_ESQUEMA_M VARCHAR2(25 CHAR):= '#ESQUEMA_MASTER#'; -- Configuracion Esquema Master.
    V_SQL VARCHAR2(4000 CHAR); -- Vble. para consulta que valida la existencia de una tabla.
    V_NUM_TABLAS NUMBER(16); -- Vble. para validar la existencia de una tabla.   
    ERR_NUM NUMBER(25);  -- Vble. auxiliar para registrar errores en el script.
    ERR_MSG VARCHAR2(1024 CHAR); -- Vble. auxiliar para registrar errores en el script.
	
    V_TEXT1 VARCHAR2(2400 CHAR); -- Vble. auxiliar
    V_ENTIDAD_ID NUMBER(16);

BEGIN


DBMS_OUTPUT.PUT_LINE('[INICIO]');

--/**
-- * MIGRACION DE VALORES DEL DICCIONARIO DD_TPN_TIPO_INMUEBLE A LOS VALORES REQUERIDOS POR UVEM.
-- * SE MODIFICAN LAS TABLAS BIE_ADICIONAL Y BIE_BIEN_ENTIDAD.
-- * SE MODIFICA EL CAMPO BORRADO A 1 DE TODOS LOS VALORES DEL DICCIONARIO QUE NO PROCEDEN.
-- */
execute immediate 'UPDATE ' ||
                  '( SELECT BIE_ADI.DD_TPN_ID, BIE_ADI.USUARIOMODIFICAR, BIE_ADI.FECHAMODIFICAR  FROM '||V_ESQUEMA||'.BIE_ADICIONAL BIE_ADI INNER JOIN DD_TPN_TIPO_INMUEBLE TPN ON BIE_ADI.DD_TPN_ID = TPN.DD_TPN_ID ' ||
                  ' WHERE TPN.DD_TPN_CODIGO IN (''AD'',''AI'',''AL'',''AP'',''CD'',''CH'',''CO'',''CU'',''DO'',''DU'',''ES'',''GA'',''GJ'',''HO'',''ID'',''LO'',''NC'',''ND'',''NO'',''NU'',''NV'',''OF'',''OT'',''PI'',''RE'',''RM'',''RR'',''RS'',''RT'',''RX'',''SP'',''TR'',''UN'',''UP'')) ' ||
                  ' SET USUARIOMODIFICAR = ''FASE1409'', FECHAMODIFICAR=SYSDATE, ' || 
                  ' DD_TPN_ID = ' ||
                  '   CASE'|| 
                        ' WHEN DD_TPN_ID = (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO =  ''AD'') THEN (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO = ''IN01'')' || 
                        ' WHEN DD_TPN_ID = (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO =  ''AI'') THEN (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO = ''IN02'')' ||
                        ' WHEN DD_TPN_ID = (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO =  ''AL'') THEN (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO = ''CO03'')' ||
                        ' WHEN DD_TPN_ID = (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO =  ''AP'') THEN (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO = ''OT01'')' ||
                        ' WHEN DD_TPN_ID = (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO =  ''CD'') THEN (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO = ''VI04'')' ||
                        ' WHEN DD_TPN_ID = (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO =  ''CH'') THEN (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO = ''VI03'')' ||
                        ' WHEN DD_TPN_ID = (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO =  ''CO'') THEN (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO = ''CO01'')' ||
                        ' WHEN DD_TPN_ID = (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO =  ''CU'') THEN (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO = ''VI05'')' ||
                        ' WHEN DD_TPN_ID = (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO =  ''DO'') THEN (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO = ''ED05'')' ||
                        ' WHEN DD_TPN_ID = (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO =  ''DU'') THEN (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO = ''VI02'')' ||
                        ' WHEN DD_TPN_ID = (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO =  ''ES'') THEN (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO = ''ED01'')' ||
                        ' WHEN DD_TPN_ID = (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO =  ''GA'') THEN (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO = ''OT02'')' ||
                        ' WHEN DD_TPN_ID = (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO =  ''GJ'') THEN (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO = ''OT02'')' ||
                        ' WHEN DD_TPN_ID = (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO =  ''HO'') THEN (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO = ''ED06'')' ||
                        ' WHEN DD_TPN_ID = (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO =  ''ID'') THEN (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO = ''IN00'')' ||
                        ' WHEN DD_TPN_ID = (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO =  ''LO'') THEN (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO = ''CO01'')' ||
                        ' WHEN DD_TPN_ID = (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO =  ''NC'') THEN (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO = ''SU04'')' ||
                        ' WHEN DD_TPN_ID = (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO =  ''ND'') THEN (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO = ''IN03'')' ||
                        ' WHEN DD_TPN_ID = (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO =  ''NO'') THEN (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO = ''SU01'')' ||
                        ' WHEN DD_TPN_ID = (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO =  ''NU'') THEN (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO = ''SU01'')' ||
                        ' WHEN DD_TPN_ID = (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO =  ''NV'') THEN (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO = ''IN04'')' ||
                        ' WHEN DD_TPN_ID = (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO =  ''OF'') THEN (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO = ''CO02'')' ||
                        ' WHEN DD_TPN_ID = (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO =  ''OT'') THEN (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO = ''OT05'')' ||
                        ' WHEN DD_TPN_ID = (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO =  ''PI'') THEN (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO = ''VI01'')' ||
                        ' WHEN DD_TPN_ID = (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO =  ''RE'') THEN (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO = ''ED01'')' ||
                        ' WHEN DD_TPN_ID = (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO =  ''RM'') THEN (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO = ''ED05'')' ||
                        ' WHEN DD_TPN_ID = (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO =  ''RR'') THEN (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO = ''SU01'')' ||
                        ' WHEN DD_TPN_ID = (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO =  ''RS'') THEN (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO = ''SU01'')' ||
                        ' WHEN DD_TPN_ID = (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO =  ''RT'') THEN (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO = ''OT04'')' ||
                        ' WHEN DD_TPN_ID = (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO =  ''RX'') THEN (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO = ''SU01'')' ||
                        ' WHEN DD_TPN_ID = (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO =  ''SP'') THEN (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO = ''SU04'')' ||
                        ' WHEN DD_TPN_ID = (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO =  ''TR'') THEN (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO = ''OT03'')' ||
                        ' WHEN DD_TPN_ID = (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO =  ''UN'') THEN (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO = ''SU02'')' ||
                        ' WHEN DD_TPN_ID = (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO =  ''UP'') THEN (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO = ''SU03'')' ||
                    ' END ';						
						DBMS_OUTPUT.PUT_LINE('[TOTAL REGISTROS ACTUALIZADOS EN BIE_ADICIONAL '|| sql%rowcount  || ']');
            

execute immediate 'UPDATE ' ||
                  '( SELECT BIE_ENT.DD_TPN_ID, BIE_ENT.USUARIOMODIFICAR, BIE_ENT.FECHAMODIFICAR  FROM '||V_ESQUEMA||'.BIE_BIEN_ENTIDAD BIE_ENT INNER JOIN DD_TPN_TIPO_INMUEBLE TPN ON BIE_ENT.DD_TPN_ID = TPN.DD_TPN_ID ' ||
                  ' WHERE TPN.DD_TPN_CODIGO IN (''AD'',''AI'',''AL'',''AP'',''CD'',''CH'',''CO'',''CU'',''DO'',''DU'',''ES'',''GA'',''GJ'',''HO'',''ID'',''LO'',''NC'',''ND'',''NO'',''NU'',''NV'',''OF'',''OT'',''PI'',''RE'',''RM'',''RR'',''RS'',''RT'',''RX'',''SP'',''TR'',''UN'',''UP'')) ' ||
                  ' SET USUARIOMODIFICAR = ''FASE1409'', FECHAMODIFICAR=SYSDATE, ' || 
                  ' DD_TPN_ID = ' ||
                  '   CASE'|| 
                        ' WHEN DD_TPN_ID = (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO =  ''AD'') THEN (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO = ''IN01'')' || 
                        ' WHEN DD_TPN_ID = (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO =  ''AI'') THEN (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO = ''IN02'')' ||
                        ' WHEN DD_TPN_ID = (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO =  ''AL'') THEN (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO = ''CO03'')' ||
                        ' WHEN DD_TPN_ID = (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO =  ''AP'') THEN (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO = ''OT01'')' ||
                        ' WHEN DD_TPN_ID = (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO =  ''CD'') THEN (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO = ''VI04'')' ||
                        ' WHEN DD_TPN_ID = (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO =  ''CH'') THEN (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO = ''VI03'')' ||
                        ' WHEN DD_TPN_ID = (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO =  ''CO'') THEN (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO = ''CO01'')' ||
                        ' WHEN DD_TPN_ID = (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO =  ''CU'') THEN (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO = ''VI05'')' ||
                        ' WHEN DD_TPN_ID = (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO =  ''DO'') THEN (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO = ''ED05'')' ||
                        ' WHEN DD_TPN_ID = (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO =  ''DU'') THEN (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO = ''VI02'')' ||
                        ' WHEN DD_TPN_ID = (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO =  ''ES'') THEN (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO = ''ED01'')' ||
                        ' WHEN DD_TPN_ID = (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO =  ''GA'') THEN (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO = ''OT02'')' ||
                        ' WHEN DD_TPN_ID = (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO =  ''GJ'') THEN (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO = ''OT02'')' ||
                        ' WHEN DD_TPN_ID = (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO =  ''HO'') THEN (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO = ''ED06'')' ||
                        ' WHEN DD_TPN_ID = (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO =  ''ID'') THEN (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO = ''IN00'')' ||
                        ' WHEN DD_TPN_ID = (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO =  ''LO'') THEN (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO = ''CO01'')' ||
                        ' WHEN DD_TPN_ID = (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO =  ''NC'') THEN (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO = ''SU04'')' ||
                        ' WHEN DD_TPN_ID = (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO =  ''ND'') THEN (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO = ''IN03'')' ||
                        ' WHEN DD_TPN_ID = (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO =  ''NO'') THEN (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO = ''SU01'')' ||
                        ' WHEN DD_TPN_ID = (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO =  ''NU'') THEN (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO = ''SU01'')' ||
                        ' WHEN DD_TPN_ID = (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO =  ''NV'') THEN (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO = ''IN04'')' ||
                        ' WHEN DD_TPN_ID = (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO =  ''OF'') THEN (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO = ''CO02'')' ||
                        ' WHEN DD_TPN_ID = (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO =  ''OT'') THEN (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO = ''OT05'')' ||
                        ' WHEN DD_TPN_ID = (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO =  ''PI'') THEN (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO = ''VI01'')' ||
                        ' WHEN DD_TPN_ID = (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO =  ''RE'') THEN (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO = ''ED01'')' ||
                        ' WHEN DD_TPN_ID = (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO =  ''RM'') THEN (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO = ''ED05'')' ||
                        ' WHEN DD_TPN_ID = (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO =  ''RR'') THEN (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO = ''SU01'')' ||
                        ' WHEN DD_TPN_ID = (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO =  ''RS'') THEN (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO = ''SU01'')' ||
                        ' WHEN DD_TPN_ID = (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO =  ''RT'') THEN (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO = ''OT04'')' ||
                        ' WHEN DD_TPN_ID = (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO =  ''RX'') THEN (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO = ''SU01'')' ||
                        ' WHEN DD_TPN_ID = (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO =  ''SP'') THEN (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO = ''SU04'')' ||
                        ' WHEN DD_TPN_ID = (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO =  ''TR'') THEN (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO = ''OT03'')' ||
                        ' WHEN DD_TPN_ID = (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO =  ''UN'') THEN (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO = ''SU02'')' ||
                        ' WHEN DD_TPN_ID = (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO =  ''UP'') THEN (SELECT DD_TPN_ID FROM '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE WHERE DD_TPN_CODIGO = ''SU03'')' ||
                    ' END ';		
						
						DBMS_OUTPUT.PUT_LINE('[TOTAL REGISTROS ACTUALIZADOS EN BIE_BIEN_ENTIDAD '|| sql%rowcount  || ']');
						
execute immediate 'UPDATE '||V_ESQUEMA||'.DD_TPN_TIPO_INMUEBLE SET USUARIOMODIFICAR = ''FASE1409'', FECHAMODIFICAR=SYSDATE, BORRADO = 1 WHERE DD_TPN_CODIGO IN (''AD'',''AI'',''AL'',''AP'',''CD'',''CH'',''CO'',''CU'',''DO'',''DU'',''ES'',''GA'',''GJ'',
''HO'',''ID'',''LO'',''NC'',''ND'',''NO'',''NU'',''NV'',''OF'',''OT'',''PI'',''RE'',''RM'',''RR'',''RS'',''RT'',''RX'',''SP'',''TR'',''UN'',''UP'')';
						
						DBMS_OUTPUT.PUT_LINE('[TOTAL REGISTROS ACTUALIZADOS EN DD_TPN_TIPO_INMUEBLE '|| sql%rowcount  || ']');

COMMIT;

DBMS_OUTPUT.PUT_LINE('[FIN]');



EXCEPTION
     WHEN OTHERS THEN
          err_num := SQLCODE;
          err_msg := SQLERRM;

          DBMS_OUTPUT.put_line('[ERROR] Se ha producido un error en la ejecuciÃ³n:'||TO_CHAR(err_num));
          DBMS_OUTPUT.put_line('-----------------------------------------------------------'); 
          DBMS_OUTPUT.put_line(err_msg);

          ROLLBACK;
          RAISE;          

END;

/

EXIT

