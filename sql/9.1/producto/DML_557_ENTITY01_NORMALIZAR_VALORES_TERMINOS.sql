--/*
--##########################################
--## AUTOR=JAVIER RUIZ
--## FECHA_CREACION=20160201
--## ARTEFACTO=producto
--## VERSION_ARTEFACTO=9.1
--## INCIDENCIA_LINK=CMREC-1856
--## PRODUCTO=SI
--##
--## Finalidad: DML Para hacer completamente dinámico los campos de los términos (Soluciones a propuestas)
--##           
--## INSTRUCCIONES: Configurar las variables necesarias en el principio del DECLARE
--## VERSIONES:
--##        0.1 Versión inicial
--##########################################
--*/

--Para permitir la visualización de texto en un bloque PL/SQL utilizando DBMS_OUTPUT.PUT_LINE

WHENEVER SQLERROR EXIT SQL.SQLCODE;
SET SERVEROUTPUT ON;
SET DEFINE OFF;

DECLARE

    V_MSQL VARCHAR2(32000 CHAR); -- Sentencia a ejecutar    
    V_ESQUEMA VARCHAR2(25 CHAR):= '#ESQUEMA#'; -- Configuracion Esquema
    V_ESQUEMA_M VARCHAR2(25 CHAR):= '#ESQUEMA_MASTER#'; -- Configuracion Esquema Master
    V_TS_INDEX VARCHAR2(25 CHAR):= '#TABLESPACE_INDEX#'; -- Configuracion Indice
    V_SQL VARCHAR2(4000 CHAR); -- Vble. para consulta que valida la existencia de una tabla.
    V_NUM_TABLAS NUMBER(16); -- Vble. para validar la existencia de una tabla.  
    ERR_NUM NUMBER(25);  -- Vble. auxiliar para registrar errores en el script.
    ERR_MSG VARCHAR2(1024 CHAR); -- Vble. auxiliar para registrar errores en el script.

    V_TEXT1 VARCHAR2(2400 CHAR); -- Vble. auxiliar
    V_CMP_ID NUMBER(16,0);
    
BEGIN

    -- ******** Actualizar la tabla ACU_CAMPOS_TIPO_ACUERDO *******
    DBMS_OUTPUT.PUT_LINE('******** Alterar la tabla ACU_CAMPOS_TIPO_ACUERDO *******'); 
    DBMS_OUTPUT.PUT_LINE('[INFO] '||V_ESQUEMA||'.ACU_CAMPOS_TIPO_ACUERDO... Comprobaciones previas'); 
    
    -- Comprobamos si existe la tabla   
    V_SQL := 'SELECT COUNT(1) FROM ALL_TABLES WHERE TABLE_NAME = ''ACU_CAMPOS_TIPO_ACUERDO'' and owner = '''||V_ESQUEMA||'''';
    EXECUTE IMMEDIATE V_SQL INTO V_NUM_TABLAS;
    -- Si NO existe la tabla no hacemos nada
    IF V_NUM_TABLAS = 0 THEN 
            DBMS_OUTPUT.PUT_LINE('[INFO] '||V_ESQUEMA||'.ACU_CAMPOS_TIPO_ACUERDO... Tabla NO existe, imposible continuar');    
    ELSE
    	-- Comprobamos que se han creado previamente los 3 campos para hacerlo dinámico
    	V_SQL := 'SELECT COUNT(1) FROM ALL_TAB_COLUMNS WHERE TABLE_NAME=''ACU_CAMPOS_TIPO_ACUERDO'' AND COLUMN_NAME IN (''CMP_LABEL'',''CMP_TIPO_CAMPO'',''CMP_VALORES_COMBO'')';
    	EXECUTE IMMEDIATE V_SQL INTO V_NUM_TABLAS;
    	IF V_NUM_TABLAS = 3 THEN
	    	 -- Actualizamos los campos de la tabla
	    	V_MSQL := 'UPDATE '|| V_ESQUEMA || '.ACU_CAMPOS_TIPO_ACUERDO SET CMP_LABEL = ''Cargas posteriores'', CMP_TIPO_CAMPO = ''number'' WHERE CMP_NOMBRE_CAMPO = ''cargasPosteriores''';
			EXECUTE IMMEDIATE V_MSQL;
	    	
	    	V_MSQL := 'UPDATE '|| V_ESQUEMA || '.ACU_CAMPOS_TIPO_ACUERDO SET CMP_LABEL = ''Cód. persona afectada'', CMP_TIPO_CAMPO = ''number'' WHERE CMP_NOMBRE_CAMPO = ''codigoPersonaAfectada''';
			EXECUTE IMMEDIATE V_MSQL;
	    	
	    	V_MSQL := 'UPDATE '|| V_ESQUEMA || '.ACU_CAMPOS_TIPO_ACUERDO SET CMP_LABEL = ''Comisiones'', CMP_TIPO_CAMPO = ''number'' WHERE CMP_NOMBRE_CAMPO = ''comision''';
	    	EXECUTE IMMEDIATE V_MSQL;
	    
	    	V_MSQL := 'UPDATE '|| V_ESQUEMA || '.ACU_CAMPOS_TIPO_ACUERDO SET CMP_LABEL = ''Fecha pago'', CMP_TIPO_CAMPO = ''fecha'' WHERE CMP_NOMBRE_CAMPO = ''fechaPago''';
	    	EXECUTE IMMEDIATE V_MSQL;
	    
	    	V_MSQL := 'UPDATE '|| V_ESQUEMA || '.ACU_CAMPOS_TIPO_ACUERDO SET CMP_LABEL = ''Fecha'', CMP_TIPO_CAMPO = ''fecha'' WHERE CMP_NOMBRE_CAMPO = ''fechaPlanPago''';
	    	EXECUTE IMMEDIATE V_MSQL;
	    
	    	V_MSQL := 'UPDATE '|| V_ESQUEMA || '.ACU_CAMPOS_TIPO_ACUERDO SET CMP_LABEL = ''Fecha Sol. Prevista'', CMP_TIPO_CAMPO = ''fecha'' WHERE CMP_NOMBRE_CAMPO = ''fechaSolucionPrevista''';
	    	EXECUTE IMMEDIATE V_MSQL;
	    
	    	V_MSQL := 'UPDATE '|| V_ESQUEMA || '.ACU_CAMPOS_TIPO_ACUERDO SET CMP_LABEL = ''Frecuencia'', CMP_TIPO_CAMPO = ''combobox'' , CMP_VALORES_COMBO = ''ANY,ANUAL;SEI,SEMESTRAL;TRI,TRIMESTRAL;BI,BIMESTRAL;MES,MENSUAL;SEM,SEMANAL;UNI,UNICO'' WHERE CMP_NOMBRE_CAMPO = ''frecuenciaPlanpago''';
	    	EXECUTE IMMEDIATE V_MSQL;
	    
	    	V_MSQL := 'UPDATE '|| V_ESQUEMA || '.ACU_CAMPOS_TIPO_ACUERDO SET CMP_LABEL = ''Gastos'', CMP_TIPO_CAMPO = ''number'' WHERE CMP_NOMBRE_CAMPO = ''gastos''';
	    	EXECUTE IMMEDIATE V_MSQL;
	    
	    	V_MSQL := 'UPDATE '|| V_ESQUEMA || '.ACU_CAMPOS_TIPO_ACUERDO SET CMP_LABEL = ''Importe cesión'', CMP_TIPO_CAMPO = ''number'' WHERE CMP_NOMBRE_CAMPO = ''importeCesion''';
	    	EXECUTE IMMEDIATE V_MSQL;
	    
	    	V_MSQL := 'UPDATE '|| V_ESQUEMA || '.ACU_CAMPOS_TIPO_ACUERDO SET CMP_LABEL = ''Importe no vencido'', CMP_TIPO_CAMPO = ''number'' WHERE CMP_NOMBRE_CAMPO = ''importeNoVencido''';
	    	EXECUTE IMMEDIATE V_MSQL;
	    
	    	V_MSQL := 'UPDATE '|| V_ESQUEMA || '.ACU_CAMPOS_TIPO_ACUERDO SET CMP_LABEL = ''Importe cesión'', CMP_TIPO_CAMPO = ''number'' WHERE CMP_NOMBRE_CAMPO = ''importePlanpago''';
	    	EXECUTE IMMEDIATE V_MSQL;
	    
	    	V_MSQL := 'UPDATE '|| V_ESQUEMA || '.ACU_CAMPOS_TIPO_ACUERDO SET CMP_LABEL = ''Importe a pagar'', CMP_TIPO_CAMPO = ''number'' WHERE CMP_NOMBRE_CAMPO = ''importeQuita''';
	    	EXECUTE IMMEDIATE V_MSQL;
	    
	    	V_MSQL := 'UPDATE '|| V_ESQUEMA || '.ACU_CAMPOS_TIPO_ACUERDO SET CMP_LABEL = ''Importe vencido'', CMP_TIPO_CAMPO = ''number'' WHERE CMP_NOMBRE_CAMPO = ''importeVencido''';
	    	EXECUTE IMMEDIATE V_MSQL;
	    
	    	V_MSQL := 'UPDATE '|| V_ESQUEMA || '.ACU_CAMPOS_TIPO_ACUERDO SET CMP_LABEL = ''Importe intereses moratorios'', CMP_TIPO_CAMPO = ''number'' WHERE CMP_NOMBRE_CAMPO = ''interesesMoratorios''';
	    	EXECUTE IMMEDIATE V_MSQL;
	    
	    	V_MSQL := 'UPDATE '|| V_ESQUEMA || '.ACU_CAMPOS_TIPO_ACUERDO SET CMP_LABEL = ''Importe intereses ordinarios'', CMP_TIPO_CAMPO = ''number'' WHERE CMP_NOMBRE_CAMPO = ''interesesOrdinarios''';
	    	EXECUTE IMMEDIATE V_MSQL;
	    
	    	V_MSQL := 'UPDATE '|| V_ESQUEMA || '.ACU_CAMPOS_TIPO_ACUERDO SET CMP_LABEL = ''Liquidez aportada'', CMP_TIPO_CAMPO = ''number'' WHERE CMP_NOMBRE_CAMPO = ''liquidez''';
	    	EXECUTE IMMEDIATE V_MSQL;
	    
	    	V_MSQL := 'UPDATE '|| V_ESQUEMA || '.ACU_CAMPOS_TIPO_ACUERDO SET CMP_LABEL = ''Nombre cesionario'', CMP_TIPO_CAMPO = ''text'' WHERE CMP_NOMBRE_CAMPO = ''nombreCesionario''';
	    	EXECUTE IMMEDIATE V_MSQL;
	    
	    	V_MSQL := 'UPDATE '|| V_ESQUEMA || '.ACU_CAMPOS_TIPO_ACUERDO SET CMP_LABEL = ''Nº contrato descuento'', CMP_TIPO_CAMPO = ''number'' WHERE CMP_NOMBRE_CAMPO = ''numContratoDescuento''';
	    	EXECUTE IMMEDIATE V_MSQL;
	    
	    	V_MSQL := 'UPDATE '|| V_ESQUEMA || '.ACU_CAMPOS_TIPO_ACUERDO SET CMP_LABEL = ''Nº Contrato ptmo. promotor'', CMP_TIPO_CAMPO = ''number'' WHERE CMP_NOMBRE_CAMPO = ''numeroContratoPtmoPromotor''';
	    	EXECUTE IMMEDIATE V_MSQL;
	    
	    	V_MSQL := 'UPDATE '|| V_ESQUEMA || '.ACU_CAMPOS_TIPO_ACUERDO SET CMP_LABEL = ''Plazos pago previo formalización'', CMP_TIPO_CAMPO = ''number'' WHERE CMP_NOMBRE_CAMPO = ''numeroPagosPlanpago''';
	    	EXECUTE IMMEDIATE V_MSQL;
	    
	    	V_MSQL := 'UPDATE '|| V_ESQUEMA || '.ACU_CAMPOS_TIPO_ACUERDO SET CMP_LABEL = ''% Quita'', CMP_TIPO_CAMPO = ''number'' WHERE CMP_NOMBRE_CAMPO = ''porcentajeQuita''';
	    	EXECUTE IMMEDIATE V_MSQL;
	    
	    	V_MSQL := 'UPDATE '|| V_ESQUEMA || '.ACU_CAMPOS_TIPO_ACUERDO SET CMP_LABEL = ''Relacion cesionario / Titular'', CMP_TIPO_CAMPO = ''text'' WHERE CMP_NOMBRE_CAMPO = ''relacionCesionarioTitular''';
	    	EXECUTE IMMEDIATE V_MSQL;
	    
	    	V_MSQL := 'UPDATE '|| V_ESQUEMA || '.ACU_CAMPOS_TIPO_ACUERDO SET CMP_LABEL = ''Solicitar alquiler'', CMP_TIPO_CAMPO = ''combobox'', CMP_VALORES_COMBO = ''1,Si;0,No'' WHERE CMP_NOMBRE_CAMPO = ''solicitarAlquiler''';
	    	EXECUTE IMMEDIATE V_MSQL;
	    
	    	V_MSQL := 'UPDATE '|| V_ESQUEMA || '.ACU_CAMPOS_TIPO_ACUERDO SET CMP_LABEL = ''Solvencia cesionario'', CMP_TIPO_CAMPO = ''number'' WHERE CMP_NOMBRE_CAMPO = ''solvenciaCesionario''';
	    	EXECUTE IMMEDIATE V_MSQL;
	    
	    	V_MSQL := 'UPDATE '|| V_ESQUEMA || '.ACU_CAMPOS_TIPO_ACUERDO SET CMP_LABEL = ''Tasación'', CMP_TIPO_CAMPO = ''number'' WHERE CMP_NOMBRE_CAMPO = ''tasacion''';
	    	EXECUTE IMMEDIATE V_MSQL;
	    
			DBMS_OUTPUT.PUT_LINE('[INFO] Campos dinámicos actualizados ....');
		ELSE
			DBMS_OUTPUT.PUT_LINE('[INFO] No existen los campo necesarios, ejecute previamente el script: 9.1/producto/DDL_352_ENTITY01_NORMALIZAR_VALORES_TERMINOS.sql');
		END IF;
		
	END IF;
		
	-- Traspasar valores ACU_OPERACIONES_TERMINOS A LA TABLA ACU_VALORES_TERMINOS
	
	V_SQL := 'SELECT COUNT(1) FROM ALL_TABLES WHERE (TABLE_NAME = ''ACU_OPERACIONES_TERMINOS'' OR TABLE_NAME = ''ACU_VALORES_TERMINOS'') and owner = '''||V_ESQUEMA||'''';
	EXECUTE IMMEDIATE V_SQL INTO V_NUM_TABLAS;
	IF V_NUM_TABLAS = 2 THEN
		DBMS_OUTPUT.PUT_LINE('[INFO] Migrando resgistros de ACU_OPERACIONES_TERMINOS a ACU_VALORES_TERMINOS');

		-- Traspaso del campo pagoPrevioFormalizacion
		V_SQL := 'SELECT COUNT(1) FROM '|| V_ESQUEMA || '.ACU_CAMPOS_TIPO_ACUERDO CMP WHERE CMP.CMP_NOMBRE_CAMPO = ''pagoPrevioFormalizacion'' AND BORRADO = 0';
		EXECUTE IMMEDIATE V_SQL INTO V_NUM_TABLAS;
		IF V_NUM_TABLAS = 1 THEN
			V_SQL := 'SELECT CMP.CMP_ID FROM '|| V_ESQUEMA || '.ACU_CAMPOS_TIPO_ACUERDO CMP WHERE CMP.CMP_NOMBRE_CAMPO = ''pagoPrevioFormalizacion'' AND BORRADO = 0';
			EXECUTE IMMEDIATE V_SQL INTO V_CMP_ID;
		
			V_MSQL := 'MERGE INTO '|| V_ESQUEMA || '.ACU_VALORES_TERMINOS DEST
						USING 
							(SELECT 
							OP.TEA_ID TEA_ID,
							'|| V_CMP_ID ||' CMP_ID,
							OP.OP_IMP_PAG_PREV_FORM AVT_VALOR,
							0 VERSION , ''DML-557'' USUARIOCREAR, 
							SYSDATE FECHACREAR, 0 BORRADO
							FROM '|| V_ESQUEMA || '.ACU_OPERACIONES_TERMINOS OP
							WHERE BORRADO = 0 AND NOT OP_IMP_PAG_PREV_FORM IS NULL) ORI
						ON (DEST.TEA_ID = ORI.TEA_ID AND DEST.CMP_ID = ORI.CMP_ID)
						WHEN MATCHED THEN
						  UPDATE SET DEST.AVT_VALOR = ORI.AVT_VALOR, 
						             DEST.USUARIOMODIFICAR = ORI.USUARIOCREAR, 
						             DEST.FECHAMODIFICAR = ORI.FECHACREAR
						WHEN NOT MATCHED THEN
						  INSERT (DEST.AVT_ID, DEST.TEA_ID, DEST.CMP_ID, DEST.AVT_VALOR, DEST.VERSION, DEST.USUARIOCREAR, DEST.FECHACREAR, DEST.BORRADO)
						  VALUES ('|| V_ESQUEMA || '.S_ACU_VALORES_TERMINOS.NEXTVAL, ORI.TEA_ID, ORI.CMP_ID, ORI.AVT_VALOR, ORI.VERSION, ORI.USUARIOCREAR, ORI.FECHACREAR, ORI.BORRADO)';

			EXECUTE IMMEDIATE V_MSQL;
		END IF;
		DBMS_OUTPUT.PUT_LINE('[INFO] Campo ''pagoPrevioFormalizacion'' traspasado.....');
		
		-- Traspaso del campo plazosPagosPrevioFormalizacion
		V_SQL := 'SELECT COUNT(1) FROM '|| V_ESQUEMA || '.ACU_CAMPOS_TIPO_ACUERDO CMP WHERE CMP.CMP_NOMBRE_CAMPO = ''plazosPagosPrevioFormalizacion'' AND BORRADO = 0';
		EXECUTE IMMEDIATE V_SQL INTO V_NUM_TABLAS;
		IF V_NUM_TABLAS = 1 THEN
			V_SQL := 'SELECT CMP.CMP_ID FROM '|| V_ESQUEMA || '.ACU_CAMPOS_TIPO_ACUERDO CMP WHERE CMP.CMP_NOMBRE_CAMPO = ''plazosPagosPrevioFormalizacion'' AND BORRADO = 0';
			EXECUTE IMMEDIATE V_SQL INTO V_CMP_ID;
		
			V_MSQL := 'MERGE INTO '|| V_ESQUEMA || '.ACU_VALORES_TERMINOS DEST
						USING 
							(SELECT 
							OP.TEA_ID TEA_ID,
							'|| V_CMP_ID ||' CMP_ID,
							OP.OP_PLZ_PAG_PREV_FORM AVT_VALOR,
							0 VERSION , ''DML-557'' USUARIOCREAR, 
							SYSDATE FECHACREAR, 0 BORRADO
							FROM '|| V_ESQUEMA || '.ACU_OPERACIONES_TERMINOS OP
							WHERE BORRADO = 0 AND NOT OP_PLZ_PAG_PREV_FORM IS NULL) ORI
						ON (DEST.TEA_ID = ORI.TEA_ID AND DEST.CMP_ID = ORI.CMP_ID)
						WHEN MATCHED THEN
						  UPDATE SET DEST.AVT_VALOR = ORI.AVT_VALOR, 
						             DEST.USUARIOMODIFICAR = ORI.USUARIOCREAR, 
						             DEST.FECHAMODIFICAR = ORI.FECHACREAR
						WHEN NOT MATCHED THEN
						  INSERT (DEST.AVT_ID, DEST.TEA_ID, DEST.CMP_ID, DEST.AVT_VALOR, DEST.VERSION, DEST.USUARIOCREAR, DEST.FECHACREAR, DEST.BORRADO)
						  VALUES ('|| V_ESQUEMA || '.S_ACU_VALORES_TERMINOS.NEXTVAL, ORI.TEA_ID, ORI.CMP_ID, ORI.AVT_VALOR, ORI.VERSION, ORI.USUARIOCREAR, ORI.FECHACREAR, ORI.BORRADO)';
						
			EXECUTE IMMEDIATE V_MSQL;
		END IF;
		DBMS_OUTPUT.PUT_LINE('[INFO] Campo ''plazosPagosPrevioFormalizacion'' traspasado.....');		
		
		-- Traspaso del campo carencia
		V_SQL := 'SELECT COUNT(1) FROM '|| V_ESQUEMA || '.ACU_CAMPOS_TIPO_ACUERDO CMP WHERE CMP.CMP_NOMBRE_CAMPO = ''carencia'' AND BORRADO = 0';
		EXECUTE IMMEDIATE V_SQL INTO V_NUM_TABLAS;
		IF V_NUM_TABLAS = 1 THEN
			V_SQL := 'SELECT CMP.CMP_ID FROM '|| V_ESQUEMA || '.ACU_CAMPOS_TIPO_ACUERDO CMP WHERE CMP.CMP_NOMBRE_CAMPO = ''carencia'' AND BORRADO = 0';
			EXECUTE IMMEDIATE V_SQL INTO V_CMP_ID;
		
			V_MSQL := 'MERGE INTO '|| V_ESQUEMA || '.ACU_VALORES_TERMINOS DEST
						USING 
							(SELECT 
							OP.TEA_ID TEA_ID,
							'|| V_CMP_ID ||' CMP_ID,
							OP.OP_CARENCIA AVT_VALOR,
							0 VERSION , ''DML-557'' USUARIOCREAR, 
							SYSDATE FECHACREAR, 0 BORRADO
							FROM '|| V_ESQUEMA || '.ACU_OPERACIONES_TERMINOS OP
							WHERE BORRADO = 0 AND NOT OP_CARENCIA IS NULL) ORI
						ON (DEST.TEA_ID = ORI.TEA_ID AND DEST.CMP_ID = ORI.CMP_ID)
						WHEN MATCHED THEN
						  UPDATE SET DEST.AVT_VALOR = ORI.AVT_VALOR, 
						             DEST.USUARIOMODIFICAR = ORI.USUARIOCREAR, 
						             DEST.FECHAMODIFICAR = ORI.FECHACREAR
						WHEN NOT MATCHED THEN
						  INSERT (DEST.AVT_ID, DEST.TEA_ID, DEST.CMP_ID, DEST.AVT_VALOR, DEST.VERSION, DEST.USUARIOCREAR, DEST.FECHACREAR, DEST.BORRADO)
						  VALUES ('|| V_ESQUEMA || '.S_ACU_VALORES_TERMINOS.NEXTVAL, ORI.TEA_ID, ORI.CMP_ID, ORI.AVT_VALOR, ORI.VERSION, ORI.USUARIOCREAR, ORI.FECHACREAR, ORI.BORRADO)';
						
			EXECUTE IMMEDIATE V_MSQL;
		END IF;
		DBMS_OUTPUT.PUT_LINE('[INFO] Campo ''carencia'' traspasado.....');		
		
		-- Traspaso del campo cuotaAsumible
		V_SQL := 'SELECT COUNT(1) FROM '|| V_ESQUEMA || '.ACU_CAMPOS_TIPO_ACUERDO CMP WHERE CMP.CMP_NOMBRE_CAMPO = ''cuotaAsumible'' AND BORRADO = 0';		
		EXECUTE IMMEDIATE V_SQL INTO V_NUM_TABLAS;
		IF V_NUM_TABLAS = 1 THEN
			V_SQL := 'SELECT CMP.CMP_ID FROM '|| V_ESQUEMA || '.ACU_CAMPOS_TIPO_ACUERDO CMP WHERE CMP.CMP_NOMBRE_CAMPO = ''cuotaAsumible'' AND BORRADO = 0';
			EXECUTE IMMEDIATE V_SQL INTO V_CMP_ID;
		
			V_MSQL := 'MERGE INTO '|| V_ESQUEMA || '.ACU_VALORES_TERMINOS DEST
						USING 
							(SELECT 
							OP.TEA_ID TEA_ID,
							'|| V_CMP_ID ||' CMP_ID,
							OP.OP_CUOTA_ASUMIBLE AVT_VALOR,
							0 VERSION , ''DML-557'' USUARIOCREAR, 
							SYSDATE FECHACREAR, 0 BORRADO
							FROM '|| V_ESQUEMA || '.ACU_OPERACIONES_TERMINOS OP
							WHERE BORRADO = 0 AND NOT OP_CUOTA_ASUMIBLE IS NULL) ORI
						ON (DEST.TEA_ID = ORI.TEA_ID AND DEST.CMP_ID = ORI.CMP_ID)
						WHEN MATCHED THEN
						  UPDATE SET DEST.AVT_VALOR = ORI.AVT_VALOR, 
						             DEST.USUARIOMODIFICAR = ORI.USUARIOCREAR, 
						             DEST.FECHAMODIFICAR = ORI.FECHACREAR
						WHEN NOT MATCHED THEN
						  INSERT (DEST.AVT_ID, DEST.TEA_ID, DEST.CMP_ID, DEST.AVT_VALOR, DEST.VERSION, DEST.USUARIOCREAR, DEST.FECHACREAR, DEST.BORRADO)
						  VALUES ('|| V_ESQUEMA || '.S_ACU_VALORES_TERMINOS.NEXTVAL, ORI.TEA_ID, ORI.CMP_ID, ORI.AVT_VALOR, ORI.VERSION, ORI.USUARIOCREAR, ORI.FECHACREAR, ORI.BORRADO)';
						
						
			EXECUTE IMMEDIATE V_MSQL;
		END IF;
		DBMS_OUTPUT.PUT_LINE('[INFO] Campo ''cuotaAsumible'' traspasado.....');		
		
		-- Traspaso del campo cargasPosteriores
		V_SQL := 'SELECT COUNT(1) FROM '|| V_ESQUEMA || '.ACU_CAMPOS_TIPO_ACUERDO CMP WHERE CMP.CMP_NOMBRE_CAMPO = ''cargasPosteriores'' AND BORRADO = 0';		
		EXECUTE IMMEDIATE V_SQL INTO V_NUM_TABLAS;
		IF V_NUM_TABLAS = 1 THEN
			V_SQL := 'SELECT CMP.CMP_ID FROM '|| V_ESQUEMA || '.ACU_CAMPOS_TIPO_ACUERDO CMP WHERE CMP.CMP_NOMBRE_CAMPO = ''cargasPosteriores'' AND BORRADO = 0';
			EXECUTE IMMEDIATE V_SQL INTO V_CMP_ID;
		
			V_MSQL := 'MERGE INTO '|| V_ESQUEMA || '.ACU_VALORES_TERMINOS DEST
						USING 
							(SELECT 
							OP.TEA_ID TEA_ID,
							'|| V_CMP_ID ||' CMP_ID,
							OP.OP_CARGAS_POSTERIORES AVT_VALOR,
							0 VERSION , ''DML-557'' USUARIOCREAR, 
							SYSDATE FECHACREAR, 0 BORRADO
							FROM '|| V_ESQUEMA || '.ACU_OPERACIONES_TERMINOS OP
							WHERE BORRADO = 0 AND NOT OP_CARGAS_POSTERIORES IS NULL) ORI
						ON (DEST.TEA_ID = ORI.TEA_ID AND DEST.CMP_ID = ORI.CMP_ID)
						WHEN MATCHED THEN
						  UPDATE SET DEST.AVT_VALOR = ORI.AVT_VALOR, 
						             DEST.USUARIOMODIFICAR = ORI.USUARIOCREAR, 
						             DEST.FECHAMODIFICAR = ORI.FECHACREAR
						WHEN NOT MATCHED THEN
						  INSERT (DEST.AVT_ID, DEST.TEA_ID, DEST.CMP_ID, DEST.AVT_VALOR, DEST.VERSION, DEST.USUARIOCREAR, DEST.FECHACREAR, DEST.BORRADO)
						  VALUES ('|| V_ESQUEMA || '.S_ACU_VALORES_TERMINOS.NEXTVAL, ORI.TEA_ID, ORI.CMP_ID, ORI.AVT_VALOR, ORI.VERSION, ORI.USUARIOCREAR, ORI.FECHACREAR, ORI.BORRADO)';
						
			EXECUTE IMMEDIATE V_MSQL;
		END IF;
		DBMS_OUTPUT.PUT_LINE('[INFO] Campo ''cargasPosteriores'' traspasado.....');		
		
		-- Traspaso del campo garantiasExtras
		V_SQL := 'SELECT COUNT(1) FROM '|| V_ESQUEMA || '.ACU_CAMPOS_TIPO_ACUERDO CMP WHERE CMP.CMP_NOMBRE_CAMPO = ''garantiasExtras'' AND BORRADO = 0';		
		EXECUTE IMMEDIATE V_SQL INTO V_NUM_TABLAS;
		IF V_NUM_TABLAS = 1 THEN
			V_SQL := 'SELECT CMP.CMP_ID FROM '|| V_ESQUEMA || '.ACU_CAMPOS_TIPO_ACUERDO CMP WHERE CMP.CMP_NOMBRE_CAMPO = ''garantiasExtras'' AND BORRADO = 0';
			EXECUTE IMMEDIATE V_SQL INTO V_CMP_ID;
		
			V_MSQL := 'MERGE INTO '|| V_ESQUEMA || '.ACU_VALORES_TERMINOS DEST
						USING 
							(SELECT 
							OP.TEA_ID TEA_ID,
							'|| V_CMP_ID ||' CMP_ID,
							OP.OP_GARANTIAS_EXTRAS AVT_VALOR,
							0 VERSION , ''DML-557'' USUARIOCREAR, 
							SYSDATE FECHACREAR, 0 BORRADO
							FROM '|| V_ESQUEMA || '.ACU_OPERACIONES_TERMINOS OP
							WHERE BORRADO = 0 AND NOT OP_GARANTIAS_EXTRAS IS NULL) ORI
						ON (DEST.TEA_ID = ORI.TEA_ID AND DEST.CMP_ID = ORI.CMP_ID)
						WHEN MATCHED THEN
						  UPDATE SET DEST.AVT_VALOR = ORI.AVT_VALOR, 
						             DEST.USUARIOMODIFICAR = ORI.USUARIOCREAR, 
						             DEST.FECHAMODIFICAR = ORI.FECHACREAR
						WHEN NOT MATCHED THEN
						  INSERT (DEST.AVT_ID, DEST.TEA_ID, DEST.CMP_ID, DEST.AVT_VALOR, DEST.VERSION, DEST.USUARIOCREAR, DEST.FECHACREAR, DEST.BORRADO)
						  VALUES ('|| V_ESQUEMA || '.S_ACU_VALORES_TERMINOS.NEXTVAL, ORI.TEA_ID, ORI.CMP_ID, ORI.AVT_VALOR, ORI.VERSION, ORI.USUARIOCREAR, ORI.FECHACREAR, ORI.BORRADO)';
						
			EXECUTE IMMEDIATE V_MSQL;
		END IF;
		DBMS_OUTPUT.PUT_LINE('[INFO] Campo ''garantiasExtras'' traspasado.....');		
		
		-- Traspaso del campo numExpediente
		V_SQL := 'SELECT COUNT(1) FROM '|| V_ESQUEMA || '.ACU_CAMPOS_TIPO_ACUERDO CMP WHERE CMP.CMP_NOMBRE_CAMPO = ''numExpediente'' AND BORRADO = 0';
		EXECUTE IMMEDIATE V_SQL INTO V_NUM_TABLAS;
		IF V_NUM_TABLAS = 1 THEN
			V_SQL := 'SELECT CMP.CMP_ID FROM '|| V_ESQUEMA || '.ACU_CAMPOS_TIPO_ACUERDO CMP WHERE CMP.CMP_NOMBRE_CAMPO = ''numExpediente'' AND BORRADO = 0';
			EXECUTE IMMEDIATE V_SQL INTO V_CMP_ID;
		
			V_MSQL := 'MERGE INTO '|| V_ESQUEMA || '.ACU_VALORES_TERMINOS DEST
						USING 
							(SELECT 
							OP.TEA_ID TEA_ID,
							'|| V_CMP_ID ||' CMP_ID,
							OP.OP_NUM_EXPEDIENTE AVT_VALOR,
							0 VERSION , ''DML-557'' USUARIOCREAR, 
							SYSDATE FECHACREAR, 0 BORRADO
							FROM '|| V_ESQUEMA || '.ACU_OPERACIONES_TERMINOS OP
							WHERE BORRADO = 0 AND NOT OP_NUM_EXPEDIENTE IS NULL) ORI
						ON (DEST.TEA_ID = ORI.TEA_ID AND DEST.CMP_ID = ORI.CMP_ID)
						WHEN MATCHED THEN
						  UPDATE SET DEST.AVT_VALOR = ORI.AVT_VALOR, 
						             DEST.USUARIOMODIFICAR = ORI.USUARIOCREAR, 
						             DEST.FECHAMODIFICAR = ORI.FECHACREAR
						WHEN NOT MATCHED THEN
						  INSERT (DEST.AVT_ID, DEST.TEA_ID, DEST.CMP_ID, DEST.AVT_VALOR, DEST.VERSION, DEST.USUARIOCREAR, DEST.FECHACREAR, DEST.BORRADO)
						  VALUES ('|| V_ESQUEMA || '.S_ACU_VALORES_TERMINOS.NEXTVAL, ORI.TEA_ID, ORI.CMP_ID, ORI.AVT_VALOR, ORI.VERSION, ORI.USUARIOCREAR, ORI.FECHACREAR, ORI.BORRADO)';
						
			EXECUTE IMMEDIATE V_MSQL;
		END IF;
		DBMS_OUTPUT.PUT_LINE('[INFO] Campo ''numExpediente'' traspasado.....');		
		
		-- Traspaso del campo solicitarAlquiler
		V_SQL := 'SELECT COUNT(1) FROM '|| V_ESQUEMA || '.ACU_CAMPOS_TIPO_ACUERDO CMP WHERE CMP.CMP_NOMBRE_CAMPO = ''solicitarAlquiler'' AND BORRADO = 0';
		EXECUTE IMMEDIATE V_SQL INTO V_NUM_TABLAS;
		IF V_NUM_TABLAS = 1 THEN
			V_SQL := 'SELECT CMP.CMP_ID FROM '|| V_ESQUEMA || '.ACU_CAMPOS_TIPO_ACUERDO CMP WHERE CMP.CMP_NOMBRE_CAMPO = ''solicitarAlquiler'' AND BORRADO = 0';
			EXECUTE IMMEDIATE V_SQL INTO V_CMP_ID;
		
			V_MSQL := 'MERGE INTO '|| V_ESQUEMA || '.ACU_VALORES_TERMINOS DEST
						USING 
							(SELECT 
							OP.TEA_ID TEA_ID,
							'|| V_CMP_ID ||' CMP_ID,
							OP.OP_SOLICITAR_ALQUILER AVT_VALOR,
							0 VERSION , ''DML-557'' USUARIOCREAR, 
							SYSDATE FECHACREAR, 0 BORRADO
							FROM '|| V_ESQUEMA || '.ACU_OPERACIONES_TERMINOS OP
							WHERE BORRADO = 0 AND NOT OP_SOLICITAR_ALQUILER IS NULL) ORI
						ON (DEST.TEA_ID = ORI.TEA_ID AND DEST.CMP_ID = ORI.CMP_ID)
						WHEN MATCHED THEN
						  UPDATE SET DEST.AVT_VALOR = ORI.AVT_VALOR, 
						             DEST.USUARIOMODIFICAR = ORI.USUARIOCREAR, 
						             DEST.FECHAMODIFICAR = ORI.FECHACREAR
						WHEN NOT MATCHED THEN
						  INSERT (DEST.AVT_ID, DEST.TEA_ID, DEST.CMP_ID, DEST.AVT_VALOR, DEST.VERSION, DEST.USUARIOCREAR, DEST.FECHACREAR, DEST.BORRADO)
						  VALUES ('|| V_ESQUEMA || '.S_ACU_VALORES_TERMINOS.NEXTVAL, ORI.TEA_ID, ORI.CMP_ID, ORI.AVT_VALOR, ORI.VERSION, ORI.USUARIOCREAR, ORI.FECHACREAR, ORI.BORRADO)';
						
			DBMS_OUTPUT.PUT_LINE(V_MSQL);						  
			EXECUTE IMMEDIATE V_MSQL;
		END IF;
		DBMS_OUTPUT.PUT_LINE('[INFO] Campo ''solicitarAlquiler'' traspasado.....');		
		
		-- Traspaso del campo liquidez
		V_SQL := 'SELECT COUNT(1) FROM '|| V_ESQUEMA || '.ACU_CAMPOS_TIPO_ACUERDO CMP WHERE CMP.CMP_NOMBRE_CAMPO = ''liquidez'' AND BORRADO = 0';
		EXECUTE IMMEDIATE V_SQL INTO V_NUM_TABLAS;
		IF V_NUM_TABLAS = 1 THEN
			V_SQL := 'SELECT CMP.CMP_ID FROM '|| V_ESQUEMA || '.ACU_CAMPOS_TIPO_ACUERDO CMP WHERE CMP.CMP_NOMBRE_CAMPO = ''liquidez'' AND BORRADO = 0';
			EXECUTE IMMEDIATE V_SQL INTO V_CMP_ID;
		
			V_MSQL := 'MERGE INTO '|| V_ESQUEMA || '.ACU_VALORES_TERMINOS DEST
						USING 
							(SELECT 
							OP.TEA_ID TEA_ID,
							'|| V_CMP_ID ||' CMP_ID,
							OP.OP_LIQUIDEZ AVT_VALOR,
							0 VERSION , ''DML-557'' USUARIOCREAR, 
							SYSDATE FECHACREAR, 0 BORRADO
							FROM '|| V_ESQUEMA || '.ACU_OPERACIONES_TERMINOS OP
							WHERE BORRADO = 0 AND NOT OP_LIQUIDEZ IS NULL) ORI
						ON (DEST.TEA_ID = ORI.TEA_ID AND DEST.CMP_ID = ORI.CMP_ID)
						WHEN MATCHED THEN
						  UPDATE SET DEST.AVT_VALOR = ORI.AVT_VALOR, 
						             DEST.USUARIOMODIFICAR = ORI.USUARIOCREAR, 
						             DEST.FECHAMODIFICAR = ORI.FECHACREAR
						WHEN NOT MATCHED THEN
						  INSERT (DEST.AVT_ID, DEST.TEA_ID, DEST.CMP_ID, DEST.AVT_VALOR, DEST.VERSION, DEST.USUARIOCREAR, DEST.FECHACREAR, DEST.BORRADO)
						  VALUES ('|| V_ESQUEMA || '.S_ACU_VALORES_TERMINOS.NEXTVAL, ORI.TEA_ID, ORI.CMP_ID, ORI.AVT_VALOR, ORI.VERSION, ORI.USUARIOCREAR, ORI.FECHACREAR, ORI.BORRADO)';
						
			EXECUTE IMMEDIATE V_MSQL;
		END IF;
		DBMS_OUTPUT.PUT_LINE('[INFO] Campo ''liquidez'' traspasado.....');		
		
		-- Traspaso del campo tasacion
		V_SQL := 'SELECT COUNT(1) FROM '|| V_ESQUEMA || '.ACU_CAMPOS_TIPO_ACUERDO CMP WHERE CMP.CMP_NOMBRE_CAMPO = ''tasacion'' AND BORRADO = 0';
		EXECUTE IMMEDIATE V_SQL INTO V_NUM_TABLAS;
		IF V_NUM_TABLAS = 1 THEN
			V_SQL := 'SELECT CMP.CMP_ID FROM '|| V_ESQUEMA || '.ACU_CAMPOS_TIPO_ACUERDO CMP WHERE CMP.CMP_NOMBRE_CAMPO = ''tasacion'' AND BORRADO = 0';
			EXECUTE IMMEDIATE V_SQL INTO V_CMP_ID;
		
			V_MSQL := 'MERGE INTO '|| V_ESQUEMA || '.ACU_VALORES_TERMINOS DEST
						USING 
							(SELECT 
							OP.TEA_ID TEA_ID,
							'|| V_CMP_ID ||' CMP_ID,
							OP.OP_TASACION AVT_VALOR,
							0 VERSION , ''DML-557'' USUARIOCREAR, 
							SYSDATE FECHACREAR, 0 BORRADO
							FROM '|| V_ESQUEMA || '.ACU_OPERACIONES_TERMINOS OP
							WHERE BORRADO = 0 AND NOT OP_TASACION IS NULL) ORI
						ON (DEST.TEA_ID = ORI.TEA_ID AND DEST.CMP_ID = ORI.CMP_ID)
						WHEN MATCHED THEN
						  UPDATE SET DEST.AVT_VALOR = ORI.AVT_VALOR, 
						             DEST.USUARIOMODIFICAR = ORI.USUARIOCREAR, 
						             DEST.FECHAMODIFICAR = ORI.FECHACREAR
						WHEN NOT MATCHED THEN
						  INSERT (DEST.AVT_ID, DEST.TEA_ID, DEST.CMP_ID, DEST.AVT_VALOR, DEST.VERSION, DEST.USUARIOCREAR, DEST.FECHACREAR, DEST.BORRADO)
						  VALUES ('|| V_ESQUEMA || '.S_ACU_VALORES_TERMINOS.NEXTVAL, ORI.TEA_ID, ORI.CMP_ID, ORI.AVT_VALOR, ORI.VERSION, ORI.USUARIOCREAR, ORI.FECHACREAR, ORI.BORRADO)';
						
			EXECUTE IMMEDIATE V_MSQL;
		END IF;
		DBMS_OUTPUT.PUT_LINE('[INFO] Campo ''tasacion'' traspasado.....');		
		
		-- Traspaso del campo importeQuita
		V_SQL := 'SELECT COUNT(1) FROM '|| V_ESQUEMA || '.ACU_CAMPOS_TIPO_ACUERDO CMP WHERE CMP.CMP_NOMBRE_CAMPO = ''importeQuita'' AND BORRADO = 0';
		EXECUTE IMMEDIATE V_SQL INTO V_NUM_TABLAS;
		IF V_NUM_TABLAS = 1 THEN
			V_SQL := 'SELECT CMP.CMP_ID FROM '|| V_ESQUEMA || '.ACU_CAMPOS_TIPO_ACUERDO CMP WHERE CMP.CMP_NOMBRE_CAMPO = ''importeQuita'' AND BORRADO = 0';
			EXECUTE IMMEDIATE V_SQL INTO V_CMP_ID;
		
			V_MSQL := 'MERGE INTO '|| V_ESQUEMA || '.ACU_VALORES_TERMINOS DEST
						USING 
							(SELECT 
							OP.TEA_ID TEA_ID,
							'|| V_CMP_ID ||' CMP_ID,
							OP.OP_IMPORTE_PAGAR_QUITA AVT_VALOR,
							0 VERSION , ''DML-557'' USUARIOCREAR, 
							SYSDATE FECHACREAR, 0 BORRADO
							FROM '|| V_ESQUEMA || '.ACU_OPERACIONES_TERMINOS OP
							WHERE BORRADO = 0 AND NOT OP_IMPORTE_PAGAR_QUITA IS NULL) ORI
						ON (DEST.TEA_ID = ORI.TEA_ID AND DEST.CMP_ID = ORI.CMP_ID)
						WHEN MATCHED THEN
						  UPDATE SET DEST.AVT_VALOR = ORI.AVT_VALOR, 
						             DEST.USUARIOMODIFICAR = ORI.USUARIOCREAR, 
						             DEST.FECHAMODIFICAR = ORI.FECHACREAR
						WHEN NOT MATCHED THEN
						  INSERT (DEST.AVT_ID, DEST.TEA_ID, DEST.CMP_ID, DEST.AVT_VALOR, DEST.VERSION, DEST.USUARIOCREAR, DEST.FECHACREAR, DEST.BORRADO)
						  VALUES ('|| V_ESQUEMA || '.S_ACU_VALORES_TERMINOS.NEXTVAL, ORI.TEA_ID, ORI.CMP_ID, ORI.AVT_VALOR, ORI.VERSION, ORI.USUARIOCREAR, ORI.FECHACREAR, ORI.BORRADO)';
						
			EXECUTE IMMEDIATE V_MSQL;
		END IF;
		DBMS_OUTPUT.PUT_LINE('[INFO] Campo ''importeQuita'' traspasado.....');		
		
		-- Traspaso del campo porcentajeQuita
		V_SQL := 'SELECT COUNT(1) FROM '|| V_ESQUEMA || '.ACU_CAMPOS_TIPO_ACUERDO CMP WHERE CMP.CMP_NOMBRE_CAMPO = ''porcentajeQuita'' AND BORRADO = 0';
		EXECUTE IMMEDIATE V_SQL INTO V_NUM_TABLAS;
		IF V_NUM_TABLAS = 1 THEN
			V_SQL := 'SELECT CMP.CMP_ID FROM '|| V_ESQUEMA || '.ACU_CAMPOS_TIPO_ACUERDO CMP WHERE CMP.CMP_NOMBRE_CAMPO = ''porcentajeQuita'' AND BORRADO = 0';
			EXECUTE IMMEDIATE V_SQL INTO V_CMP_ID;
		
			V_MSQL := 'MERGE INTO '|| V_ESQUEMA || '.ACU_VALORES_TERMINOS DEST
						USING 
							(SELECT 
							OP.TEA_ID TEA_ID,
							'|| V_CMP_ID ||' CMP_ID,
							OP.OP_PORCENTAJE_QUITA AVT_VALOR,
							0 VERSION , ''DML-557'' USUARIOCREAR, 
							SYSDATE FECHACREAR, 0 BORRADO
							FROM '|| V_ESQUEMA || '.ACU_OPERACIONES_TERMINOS OP
							WHERE BORRADO = 0 AND NOT OP_PORCENTAJE_QUITA IS NULL) ORI
						ON (DEST.TEA_ID = ORI.TEA_ID AND DEST.CMP_ID = ORI.CMP_ID)
						WHEN MATCHED THEN
						  UPDATE SET DEST.AVT_VALOR = ORI.AVT_VALOR, 
						             DEST.USUARIOMODIFICAR = ORI.USUARIOCREAR, 
						             DEST.FECHAMODIFICAR = ORI.FECHACREAR
						WHEN NOT MATCHED THEN
						  INSERT (DEST.AVT_ID, DEST.TEA_ID, DEST.CMP_ID, DEST.AVT_VALOR, DEST.VERSION, DEST.USUARIOCREAR, DEST.FECHACREAR, DEST.BORRADO)
						  VALUES ('|| V_ESQUEMA || '.S_ACU_VALORES_TERMINOS.NEXTVAL, ORI.TEA_ID, ORI.CMP_ID, ORI.AVT_VALOR, ORI.VERSION, ORI.USUARIOCREAR, ORI.FECHACREAR, ORI.BORRADO)';
						
			EXECUTE IMMEDIATE V_MSQL;
		END IF;
		DBMS_OUTPUT.PUT_LINE('[INFO] Campo ''porcentajeQuita'' traspasado.....');		
		
		-- Traspaso del campo importeVencido
		V_SQL := 'SELECT COUNT(1) FROM '|| V_ESQUEMA || '.ACU_CAMPOS_TIPO_ACUERDO CMP WHERE CMP.CMP_NOMBRE_CAMPO = ''importeVencido'' AND BORRADO = 0';
		EXECUTE IMMEDIATE V_SQL INTO V_NUM_TABLAS;
		IF V_NUM_TABLAS = 1 THEN
			V_SQL := 'SELECT CMP.CMP_ID FROM '|| V_ESQUEMA || '.ACU_CAMPOS_TIPO_ACUERDO CMP WHERE CMP.CMP_NOMBRE_CAMPO = ''importeVencido'' AND BORRADO = 0';
			EXECUTE IMMEDIATE V_SQL INTO V_CMP_ID;
		
			V_MSQL := 'MERGE INTO '|| V_ESQUEMA || '.ACU_VALORES_TERMINOS DEST
						USING 
							(SELECT 
							OP.TEA_ID TEA_ID,
							'|| V_CMP_ID ||' CMP_ID,
							OP.OP_IMPORTE_VENCIDO AVT_VALOR,
							0 VERSION , ''DML-557'' USUARIOCREAR, 
							SYSDATE FECHACREAR, 0 BORRADO
							FROM '|| V_ESQUEMA || '.ACU_OPERACIONES_TERMINOS OP
							WHERE BORRADO = 0 AND NOT OP_IMPORTE_VENCIDO IS NULL) ORI
						ON (DEST.TEA_ID = ORI.TEA_ID AND DEST.CMP_ID = ORI.CMP_ID)
						WHEN MATCHED THEN
						  UPDATE SET DEST.AVT_VALOR = ORI.AVT_VALOR, 
						             DEST.USUARIOMODIFICAR = ORI.USUARIOCREAR, 
						             DEST.FECHAMODIFICAR = ORI.FECHACREAR
						WHEN NOT MATCHED THEN
						  INSERT (DEST.AVT_ID, DEST.TEA_ID, DEST.CMP_ID, DEST.AVT_VALOR, DEST.VERSION, DEST.USUARIOCREAR, DEST.FECHACREAR, DEST.BORRADO)
						  VALUES ('|| V_ESQUEMA || '.S_ACU_VALORES_TERMINOS.NEXTVAL, ORI.TEA_ID, ORI.CMP_ID, ORI.AVT_VALOR, ORI.VERSION, ORI.USUARIOCREAR, ORI.FECHACREAR, ORI.BORRADO)';
						
			EXECUTE IMMEDIATE V_MSQL;
		END IF;
		DBMS_OUTPUT.PUT_LINE('[INFO] Campo ''importeVencido'' traspasado.....');		
		
		-- Traspaso del campo importeNoVencido
		V_SQL := 'SELECT COUNT(1) FROM '|| V_ESQUEMA || '.ACU_CAMPOS_TIPO_ACUERDO CMP WHERE CMP.CMP_NOMBRE_CAMPO = ''importeNoVencido'' AND BORRADO = 0';
		EXECUTE IMMEDIATE V_SQL INTO V_NUM_TABLAS;
		IF V_NUM_TABLAS = 1 THEN
			V_SQL := 'SELECT CMP.CMP_ID FROM '|| V_ESQUEMA || '.ACU_CAMPOS_TIPO_ACUERDO CMP WHERE CMP.CMP_NOMBRE_CAMPO = ''importeNoVencido'' AND BORRADO = 0';
			EXECUTE IMMEDIATE V_SQL INTO V_CMP_ID;
		
			V_MSQL := 'MERGE INTO '|| V_ESQUEMA || '.ACU_VALORES_TERMINOS DEST
						USING 
							(SELECT 
							OP.TEA_ID TEA_ID,
							'|| V_CMP_ID ||' CMP_ID,
							OP.OP_IMPORTE_NO_VENCIDO AVT_VALOR,
							0 VERSION , ''DML-557'' USUARIOCREAR, 
							SYSDATE FECHACREAR, 0 BORRADO
							FROM '|| V_ESQUEMA || '.ACU_OPERACIONES_TERMINOS OP
							WHERE BORRADO = 0 AND NOT OP_IMPORTE_NO_VENCIDO IS NULL) ORI
						ON (DEST.TEA_ID = ORI.TEA_ID AND DEST.CMP_ID = ORI.CMP_ID)
						WHEN MATCHED THEN
						  UPDATE SET DEST.AVT_VALOR = ORI.AVT_VALOR, 
						             DEST.USUARIOMODIFICAR = ORI.USUARIOCREAR, 
						             DEST.FECHAMODIFICAR = ORI.FECHACREAR
						WHEN NOT MATCHED THEN
						  INSERT (DEST.AVT_ID, DEST.TEA_ID, DEST.CMP_ID, DEST.AVT_VALOR, DEST.VERSION, DEST.USUARIOCREAR, DEST.FECHACREAR, DEST.BORRADO)
						  VALUES ('|| V_ESQUEMA || '.S_ACU_VALORES_TERMINOS.NEXTVAL, ORI.TEA_ID, ORI.CMP_ID, ORI.AVT_VALOR, ORI.VERSION, ORI.USUARIOCREAR, ORI.FECHACREAR, ORI.BORRADO)';
						
			EXECUTE IMMEDIATE V_MSQL;
		END IF;
		DBMS_OUTPUT.PUT_LINE('[INFO] Campo ''importeNoVencido'' traspasado.....');		
		
		-- Traspaso del campo interesesMoratorios
		V_SQL := 'SELECT COUNT(1) FROM '|| V_ESQUEMA || '.ACU_CAMPOS_TIPO_ACUERDO CMP WHERE CMP.CMP_NOMBRE_CAMPO = ''interesesMoratorios'' AND BORRADO = 0';		
		EXECUTE IMMEDIATE V_SQL INTO V_NUM_TABLAS;
		IF V_NUM_TABLAS = 1 THEN
			V_SQL := 'SELECT CMP.CMP_ID FROM '|| V_ESQUEMA || '.ACU_CAMPOS_TIPO_ACUERDO CMP WHERE CMP.CMP_NOMBRE_CAMPO = ''interesesMoratorios'' AND BORRADO = 0';
			EXECUTE IMMEDIATE V_SQL INTO V_CMP_ID;
		
			V_MSQL := 'MERGE INTO '|| V_ESQUEMA || '.ACU_VALORES_TERMINOS DEST
						USING 
							(SELECT 
							OP.TEA_ID TEA_ID,
							'|| V_CMP_ID ||' CMP_ID,
							OP.OP_IMP_INTERESES_MORATORIOS AVT_VALOR,
							0 VERSION , ''DML-557'' USUARIOCREAR, 
							SYSDATE FECHACREAR, 0 BORRADO
							FROM '|| V_ESQUEMA || '.ACU_OPERACIONES_TERMINOS OP
							WHERE BORRADO = 0 AND NOT OP_IMP_INTERESES_MORATORIOS IS NULL) ORI
						ON (DEST.TEA_ID = ORI.TEA_ID AND DEST.CMP_ID = ORI.CMP_ID)
						WHEN MATCHED THEN
						  UPDATE SET DEST.AVT_VALOR = ORI.AVT_VALOR, 
						             DEST.USUARIOMODIFICAR = ORI.USUARIOCREAR, 
						             DEST.FECHAMODIFICAR = ORI.FECHACREAR
						WHEN NOT MATCHED THEN
						  INSERT (DEST.AVT_ID, DEST.TEA_ID, DEST.CMP_ID, DEST.AVT_VALOR, DEST.VERSION, DEST.USUARIOCREAR, DEST.FECHACREAR, DEST.BORRADO)
						  VALUES ('|| V_ESQUEMA || '.S_ACU_VALORES_TERMINOS.NEXTVAL, ORI.TEA_ID, ORI.CMP_ID, ORI.AVT_VALOR, ORI.VERSION, ORI.USUARIOCREAR, ORI.FECHACREAR, ORI.BORRADO)';
						
			EXECUTE IMMEDIATE V_MSQL;
		END IF;
		DBMS_OUTPUT.PUT_LINE('[INFO] Campo ''interesesMoratorios'' traspasado.....');		
		
		-- Traspaso del campo interesesOrdinarios
		V_SQL := 'SELECT COUNT(1) FROM '|| V_ESQUEMA || '.ACU_CAMPOS_TIPO_ACUERDO CMP WHERE CMP.CMP_NOMBRE_CAMPO = ''interesesOrdinarios'' AND BORRADO = 0';		
		EXECUTE IMMEDIATE V_SQL INTO V_NUM_TABLAS;
		IF V_NUM_TABLAS = 1 THEN
			V_SQL := 'SELECT CMP.CMP_ID FROM '|| V_ESQUEMA || '.ACU_CAMPOS_TIPO_ACUERDO CMP WHERE CMP.CMP_NOMBRE_CAMPO = ''interesesOrdinarios'' AND BORRADO = 0';
			EXECUTE IMMEDIATE V_SQL INTO V_CMP_ID;
		
			V_MSQL := 'MERGE INTO '|| V_ESQUEMA || '.ACU_VALORES_TERMINOS DEST
						USING 
							(SELECT 
							OP.TEA_ID TEA_ID,
							'|| V_CMP_ID ||' CMP_ID,
							OP.OP_IMP_INTERESES_ORDINARIOS AVT_VALOR,
							0 VERSION , ''DML-557'' USUARIOCREAR, 
							SYSDATE FECHACREAR, 0 BORRADO
							FROM '|| V_ESQUEMA || '.ACU_OPERACIONES_TERMINOS OP
							WHERE BORRADO = 0 AND NOT OP_IMP_INTERESES_ORDINARIOS IS NULL) ORI
						ON (DEST.TEA_ID = ORI.TEA_ID AND DEST.CMP_ID = ORI.CMP_ID)
						WHEN MATCHED THEN
						  UPDATE SET DEST.AVT_VALOR = ORI.AVT_VALOR, 
						             DEST.USUARIOMODIFICAR = ORI.USUARIOCREAR, 
						             DEST.FECHAMODIFICAR = ORI.FECHACREAR
						WHEN NOT MATCHED THEN
						  INSERT (DEST.AVT_ID, DEST.TEA_ID, DEST.CMP_ID, DEST.AVT_VALOR, DEST.VERSION, DEST.USUARIOCREAR, DEST.FECHACREAR, DEST.BORRADO)
						  VALUES ('|| V_ESQUEMA || '.S_ACU_VALORES_TERMINOS.NEXTVAL, ORI.TEA_ID, ORI.CMP_ID, ORI.AVT_VALOR, ORI.VERSION, ORI.USUARIOCREAR, ORI.FECHACREAR, ORI.BORRADO)';
						
			EXECUTE IMMEDIATE V_MSQL;
		END IF;
		DBMS_OUTPUT.PUT_LINE('[INFO] Campo ''interesesOrdinarios'' traspasado.....');		
		
		-- Traspaso del campo comision
		V_SQL := 'SELECT COUNT(1) FROM '|| V_ESQUEMA || '.ACU_CAMPOS_TIPO_ACUERDO CMP WHERE CMP.CMP_NOMBRE_CAMPO = ''comision'' AND BORRADO = 0';
		EXECUTE IMMEDIATE V_SQL INTO V_NUM_TABLAS;
		IF V_NUM_TABLAS = 1 THEN
			V_SQL := 'SELECT CMP.CMP_ID FROM '|| V_ESQUEMA || '.ACU_CAMPOS_TIPO_ACUERDO CMP WHERE CMP.CMP_NOMBRE_CAMPO = ''comision'' AND BORRADO = 0';
			EXECUTE IMMEDIATE V_SQL INTO V_CMP_ID;
		
			V_MSQL := 'MERGE INTO '|| V_ESQUEMA || '.ACU_VALORES_TERMINOS DEST
						USING 
							(SELECT 
							OP.TEA_ID TEA_ID,
							'|| V_CMP_ID ||' CMP_ID,
							OP.OP_COMISION AVT_VALOR,
							0 VERSION , ''DML-557'' USUARIOCREAR, 
							SYSDATE FECHACREAR, 0 BORRADO
							FROM '|| V_ESQUEMA || '.ACU_OPERACIONES_TERMINOS OP
							WHERE BORRADO = 0 AND NOT OP_COMISION IS NULL) ORI
						ON (DEST.TEA_ID = ORI.TEA_ID AND DEST.CMP_ID = ORI.CMP_ID)
						WHEN MATCHED THEN
						  UPDATE SET DEST.AVT_VALOR = ORI.AVT_VALOR, 
						             DEST.USUARIOMODIFICAR = ORI.USUARIOCREAR, 
						             DEST.FECHAMODIFICAR = ORI.FECHACREAR
						WHEN NOT MATCHED THEN
						  INSERT (DEST.AVT_ID, DEST.TEA_ID, DEST.CMP_ID, DEST.AVT_VALOR, DEST.VERSION, DEST.USUARIOCREAR, DEST.FECHACREAR, DEST.BORRADO)
						  VALUES ('|| V_ESQUEMA || '.S_ACU_VALORES_TERMINOS.NEXTVAL, ORI.TEA_ID, ORI.CMP_ID, ORI.AVT_VALOR, ORI.VERSION, ORI.USUARIOCREAR, ORI.FECHACREAR, ORI.BORRADO)';
						
			EXECUTE IMMEDIATE V_MSQL;
		END IF;
		DBMS_OUTPUT.PUT_LINE('[INFO] Campo ''comision'' traspasado.....');		
		
		-- Traspaso del campo gastos
		V_SQL := 'SELECT COUNT(1) FROM '|| V_ESQUEMA || '.ACU_CAMPOS_TIPO_ACUERDO CMP WHERE CMP.CMP_NOMBRE_CAMPO = ''gastos'' AND BORRADO = 0';
		EXECUTE IMMEDIATE V_SQL INTO V_NUM_TABLAS;
		IF V_NUM_TABLAS = 1 THEN
			V_SQL := 'SELECT CMP.CMP_ID FROM '|| V_ESQUEMA || '.ACU_CAMPOS_TIPO_ACUERDO CMP WHERE CMP.CMP_NOMBRE_CAMPO = ''gastos'' AND BORRADO = 0';
			EXECUTE IMMEDIATE V_SQL INTO V_CMP_ID;
		
			V_MSQL := 'MERGE INTO '|| V_ESQUEMA || '.ACU_VALORES_TERMINOS DEST
						USING 
							(SELECT 
							OP.TEA_ID TEA_ID,
							'|| V_CMP_ID ||' CMP_ID,
							OP.OP_GASTOS AVT_VALOR,
							0 VERSION , ''DML-557'' USUARIOCREAR, 
							SYSDATE FECHACREAR, 0 BORRADO
							FROM '|| V_ESQUEMA || '.ACU_OPERACIONES_TERMINOS OP
							WHERE BORRADO = 0 AND NOT OP_GASTOS IS NULL) ORI
						ON (DEST.TEA_ID = ORI.TEA_ID AND DEST.CMP_ID = ORI.CMP_ID)
						WHEN MATCHED THEN
						  UPDATE SET DEST.AVT_VALOR = ORI.AVT_VALOR, 
						             DEST.USUARIOMODIFICAR = ORI.USUARIOCREAR, 
						             DEST.FECHAMODIFICAR = ORI.FECHACREAR
						WHEN NOT MATCHED THEN
						  INSERT (DEST.AVT_ID, DEST.TEA_ID, DEST.CMP_ID, DEST.AVT_VALOR, DEST.VERSION, DEST.USUARIOCREAR, DEST.FECHACREAR, DEST.BORRADO)
						  VALUES ('|| V_ESQUEMA || '.S_ACU_VALORES_TERMINOS.NEXTVAL, ORI.TEA_ID, ORI.CMP_ID, ORI.AVT_VALOR, ORI.VERSION, ORI.USUARIOCREAR, ORI.FECHACREAR, ORI.BORRADO)';
							
			EXECUTE IMMEDIATE V_MSQL;
		END IF;
		DBMS_OUTPUT.PUT_LINE('[INFO] Campo ''gastos'' traspasado.....');		
		
		-- Traspaso del campo nombreCesionario
		V_SQL := 'SELECT COUNT(1) FROM '|| V_ESQUEMA || '.ACU_CAMPOS_TIPO_ACUERDO CMP WHERE CMP.CMP_NOMBRE_CAMPO = ''nombreCesionario'' AND BORRADO = 0';		
		EXECUTE IMMEDIATE V_SQL INTO V_NUM_TABLAS;
		IF V_NUM_TABLAS = 1 THEN
			V_SQL := 'SELECT CMP.CMP_ID FROM '|| V_ESQUEMA || '.ACU_CAMPOS_TIPO_ACUERDO CMP WHERE CMP.CMP_NOMBRE_CAMPO = ''nombreCesionario'' AND BORRADO = 0';
			EXECUTE IMMEDIATE V_SQL INTO V_CMP_ID;
		
			V_MSQL := 'MERGE INTO '|| V_ESQUEMA || '.ACU_VALORES_TERMINOS DEST
						USING 
							(SELECT 
							OP.TEA_ID TEA_ID,
							'|| V_CMP_ID ||' CMP_ID,
							OP.OP_NOM_CESIONARIO AVT_VALOR,
							0 VERSION , ''DML-557'' USUARIOCREAR, 
							SYSDATE FECHACREAR, 0 BORRADO
							FROM '|| V_ESQUEMA || '.ACU_OPERACIONES_TERMINOS OP
							WHERE BORRADO = 0 AND NOT OP_NOM_CESIONARIO IS NULL) ORI
						ON (DEST.TEA_ID = ORI.TEA_ID AND DEST.CMP_ID = ORI.CMP_ID)
						WHEN MATCHED THEN
						  UPDATE SET DEST.AVT_VALOR = ORI.AVT_VALOR, 
						             DEST.USUARIOMODIFICAR = ORI.USUARIOCREAR, 
						             DEST.FECHAMODIFICAR = ORI.FECHACREAR
						WHEN NOT MATCHED THEN
						  INSERT (DEST.AVT_ID, DEST.TEA_ID, DEST.CMP_ID, DEST.AVT_VALOR, DEST.VERSION, DEST.USUARIOCREAR, DEST.FECHACREAR, DEST.BORRADO)
						  VALUES ('|| V_ESQUEMA || '.S_ACU_VALORES_TERMINOS.NEXTVAL, ORI.TEA_ID, ORI.CMP_ID, ORI.AVT_VALOR, ORI.VERSION, ORI.USUARIOCREAR, ORI.FECHACREAR, ORI.BORRADO)';						
			EXECUTE IMMEDIATE V_MSQL;
		END IF;
		DBMS_OUTPUT.PUT_LINE('[INFO] Campo ''nombreCesionario'' traspasado.....');		
		
		-- Traspaso del campo relacionCesionarioTitular
		V_SQL := 'SELECT COUNT(1) FROM '|| V_ESQUEMA || '.ACU_CAMPOS_TIPO_ACUERDO CMP WHERE CMP.CMP_NOMBRE_CAMPO = ''relacionCesionarioTitular'' AND BORRADO = 0';		
		EXECUTE IMMEDIATE V_SQL INTO V_NUM_TABLAS;
		IF V_NUM_TABLAS = 1 THEN
			V_SQL := 'SELECT CMP.CMP_ID FROM '|| V_ESQUEMA || '.ACU_CAMPOS_TIPO_ACUERDO CMP WHERE CMP.CMP_NOMBRE_CAMPO = ''relacionCesionarioTitular'' AND BORRADO = 0';
			EXECUTE IMMEDIATE V_SQL INTO V_CMP_ID;
		
			V_MSQL := 'MERGE INTO '|| V_ESQUEMA || '.ACU_VALORES_TERMINOS DEST
						USING 
							(SELECT 
							OP.TEA_ID TEA_ID,
							'|| V_CMP_ID ||' CMP_ID,
							OP.OP_REL_CES_TIT AVT_VALOR,
							0 VERSION , ''DML-557'' USUARIOCREAR, 
							SYSDATE FECHACREAR, 0 BORRADO
							FROM '|| V_ESQUEMA || '.ACU_OPERACIONES_TERMINOS OP
							WHERE BORRADO = 0 AND NOT OP_REL_CES_TIT IS NULL) ORI
						ON (DEST.TEA_ID = ORI.TEA_ID AND DEST.CMP_ID = ORI.CMP_ID)
						WHEN MATCHED THEN
						  UPDATE SET DEST.AVT_VALOR = ORI.AVT_VALOR, 
						             DEST.USUARIOMODIFICAR = ORI.USUARIOCREAR, 
						             DEST.FECHAMODIFICAR = ORI.FECHACREAR
						WHEN NOT MATCHED THEN
						  INSERT (DEST.AVT_ID, DEST.TEA_ID, DEST.CMP_ID, DEST.AVT_VALOR, DEST.VERSION, DEST.USUARIOCREAR, DEST.FECHACREAR, DEST.BORRADO)
						  VALUES ('|| V_ESQUEMA || '.S_ACU_VALORES_TERMINOS.NEXTVAL, ORI.TEA_ID, ORI.CMP_ID, ORI.AVT_VALOR, ORI.VERSION, ORI.USUARIOCREAR, ORI.FECHACREAR, ORI.BORRADO)';						
						
			EXECUTE IMMEDIATE V_MSQL;
		END IF;
		DBMS_OUTPUT.PUT_LINE('[INFO] Campo ''relacionCesionarioTitular'' traspasado.....');		
		
		-- Traspaso del campo solvenciaCesionario
		V_SQL := 'SELECT COUNT(1) FROM '|| V_ESQUEMA || '.ACU_CAMPOS_TIPO_ACUERDO CMP WHERE CMP.CMP_NOMBRE_CAMPO = ''solvenciaCesionario'' AND BORRADO = 0';		
		EXECUTE IMMEDIATE V_SQL INTO V_NUM_TABLAS;
		IF V_NUM_TABLAS = 1 THEN
			V_SQL := 'SELECT CMP.CMP_ID FROM '|| V_ESQUEMA || '.ACU_CAMPOS_TIPO_ACUERDO CMP WHERE CMP.CMP_NOMBRE_CAMPO = ''solvenciaCesionario'' AND BORRADO = 0';
			EXECUTE IMMEDIATE V_SQL INTO V_CMP_ID;
		
			V_MSQL := 'MERGE INTO '|| V_ESQUEMA || '.ACU_VALORES_TERMINOS DEST
						USING 
							(SELECT 
							OP.TEA_ID TEA_ID,
							'|| V_CMP_ID ||' CMP_ID,
							OP.OP_SOLVENCIA_CESIONARIO AVT_VALOR,
							0 VERSION , ''DML-557'' USUARIOCREAR, 
							SYSDATE FECHACREAR, 0 BORRADO
							FROM '|| V_ESQUEMA || '.ACU_OPERACIONES_TERMINOS OP
							WHERE BORRADO = 0 AND NOT OP_SOLVENCIA_CESIONARIO IS NULL) ORI
						ON (DEST.TEA_ID = ORI.TEA_ID AND DEST.CMP_ID = ORI.CMP_ID)
						WHEN MATCHED THEN
						  UPDATE SET DEST.AVT_VALOR = ORI.AVT_VALOR, 
						             DEST.USUARIOMODIFICAR = ORI.USUARIOCREAR, 
						             DEST.FECHAMODIFICAR = ORI.FECHACREAR
						WHEN NOT MATCHED THEN
						  INSERT (DEST.AVT_ID, DEST.TEA_ID, DEST.CMP_ID, DEST.AVT_VALOR, DEST.VERSION, DEST.USUARIOCREAR, DEST.FECHACREAR, DEST.BORRADO)
						  VALUES ('|| V_ESQUEMA || '.S_ACU_VALORES_TERMINOS.NEXTVAL, ORI.TEA_ID, ORI.CMP_ID, ORI.AVT_VALOR, ORI.VERSION, ORI.USUARIOCREAR, ORI.FECHACREAR, ORI.BORRADO)';						
			
						
			EXECUTE IMMEDIATE V_MSQL;
		END IF;
		DBMS_OUTPUT.PUT_LINE('[INFO] Campo ''solvenciaCesionario'' traspasado.....');		
		
		-- Traspaso del campo importeCesion
		V_SQL := 'SELECT COUNT(1) FROM '|| V_ESQUEMA || '.ACU_CAMPOS_TIPO_ACUERDO CMP WHERE CMP.CMP_NOMBRE_CAMPO = ''importeCesion'' AND BORRADO = 0';		
		EXECUTE IMMEDIATE V_SQL INTO V_NUM_TABLAS;
		IF V_NUM_TABLAS = 1 THEN
			V_SQL := 'SELECT CMP.CMP_ID FROM '|| V_ESQUEMA || '.ACU_CAMPOS_TIPO_ACUERDO CMP WHERE CMP.CMP_NOMBRE_CAMPO = ''importeCesion'' AND BORRADO = 0';
			EXECUTE IMMEDIATE V_SQL INTO V_CMP_ID;
		
			V_MSQL := 'MERGE INTO '|| V_ESQUEMA || '.ACU_VALORES_TERMINOS DEST
						USING 
							(SELECT 
							OP.TEA_ID TEA_ID,
							'|| V_CMP_ID ||' CMP_ID,
							OP.OP_IMPORTE_CESION AVT_VALOR,
							0 VERSION , ''DML-557'' USUARIOCREAR, 
							SYSDATE FECHACREAR, 0 BORRADO
							FROM '|| V_ESQUEMA || '.ACU_OPERACIONES_TERMINOS OP
							WHERE BORRADO = 0 AND NOT OP_IMPORTE_CESION IS NULL) ORI
						ON (DEST.TEA_ID = ORI.TEA_ID AND DEST.CMP_ID = ORI.CMP_ID)
						WHEN MATCHED THEN
						  UPDATE SET DEST.AVT_VALOR = ORI.AVT_VALOR, 
						             DEST.USUARIOMODIFICAR = ORI.USUARIOCREAR, 
						             DEST.FECHAMODIFICAR = ORI.FECHACREAR
						WHEN NOT MATCHED THEN
						  INSERT (DEST.AVT_ID, DEST.TEA_ID, DEST.CMP_ID, DEST.AVT_VALOR, DEST.VERSION, DEST.USUARIOCREAR, DEST.FECHACREAR, DEST.BORRADO)
						  VALUES ('|| V_ESQUEMA || '.S_ACU_VALORES_TERMINOS.NEXTVAL, ORI.TEA_ID, ORI.CMP_ID, ORI.AVT_VALOR, ORI.VERSION, ORI.USUARIOCREAR, ORI.FECHACREAR, ORI.BORRADO)';						
						
			EXECUTE IMMEDIATE V_MSQL;
		END IF;
		DBMS_OUTPUT.PUT_LINE('[INFO] Campo ''importeCesion'' traspasado.....');		
		
		-- Traspaso del campo fechaPago
		V_SQL := 'SELECT COUNT(1) FROM '|| V_ESQUEMA || '.ACU_CAMPOS_TIPO_ACUERDO CMP WHERE CMP.CMP_NOMBRE_CAMPO = ''fechaPago'' AND BORRADO = 0';
		EXECUTE IMMEDIATE V_SQL INTO V_NUM_TABLAS;
		IF V_NUM_TABLAS = 1 THEN
			V_SQL := 'SELECT CMP.CMP_ID FROM '|| V_ESQUEMA || '.ACU_CAMPOS_TIPO_ACUERDO CMP WHERE CMP.CMP_NOMBRE_CAMPO = ''fechaPago'' AND BORRADO = 0';
			EXECUTE IMMEDIATE V_SQL INTO V_CMP_ID;
		
			V_MSQL := 'MERGE INTO '|| V_ESQUEMA || '.ACU_VALORES_TERMINOS DEST
						USING 
							(SELECT 
							OP.TEA_ID TEA_ID,
							'|| V_CMP_ID ||' CMP_ID,
							TO_CHAR(OP.OP_FECHA_PAGO,''DD/MM/YYYY'') AVT_VALOR,
							0 VERSION , ''DML-557'' USUARIOCREAR, 
							SYSDATE FECHACREAR, 0 BORRADO
							FROM '|| V_ESQUEMA || '.ACU_OPERACIONES_TERMINOS OP
							WHERE BORRADO = 0 AND NOT OP_FECHA_PAGO IS NULL) ORI
						ON (DEST.TEA_ID = ORI.TEA_ID AND DEST.CMP_ID = ORI.CMP_ID)
						WHEN MATCHED THEN
						  UPDATE SET DEST.AVT_VALOR = ORI.AVT_VALOR, 
						             DEST.USUARIOMODIFICAR = ORI.USUARIOCREAR, 
						             DEST.FECHAMODIFICAR = ORI.FECHACREAR
						WHEN NOT MATCHED THEN
						  INSERT (DEST.AVT_ID, DEST.TEA_ID, DEST.CMP_ID, DEST.AVT_VALOR, DEST.VERSION, DEST.USUARIOCREAR, DEST.FECHACREAR, DEST.BORRADO)
						  VALUES ('|| V_ESQUEMA || '.S_ACU_VALORES_TERMINOS.NEXTVAL, ORI.TEA_ID, ORI.CMP_ID, ORI.AVT_VALOR, ORI.VERSION, ORI.USUARIOCREAR, ORI.FECHACREAR, ORI.BORRADO)';						
						
			EXECUTE IMMEDIATE V_MSQL;
		END IF;
		DBMS_OUTPUT.PUT_LINE('[INFO] Campo ''fechaPago'' traspasado.....');		
		
		-- Traspaso del campo fechaPlanPago
		V_SQL := 'SELECT COUNT(1) FROM '|| V_ESQUEMA || '.ACU_CAMPOS_TIPO_ACUERDO CMP WHERE CMP.CMP_NOMBRE_CAMPO = ''fechaPlanPago'' AND BORRADO = 0';
		EXECUTE IMMEDIATE V_SQL INTO V_NUM_TABLAS;
		IF V_NUM_TABLAS = 1 THEN
			V_SQL := 'SELECT CMP.CMP_ID FROM '|| V_ESQUEMA || '.ACU_CAMPOS_TIPO_ACUERDO CMP WHERE CMP.CMP_NOMBRE_CAMPO = ''fechaPlanPago'' AND BORRADO = 0';
			EXECUTE IMMEDIATE V_SQL INTO V_CMP_ID;
		
			V_MSQL := 'MERGE INTO '|| V_ESQUEMA || '.ACU_VALORES_TERMINOS DEST
						USING 
							(SELECT 
							OP.TEA_ID TEA_ID,
							'|| V_CMP_ID ||' CMP_ID,
							TO_CHAR(OP.OP_PLAN_PGS_FECHA,''DD/MM/YYYY'') AVT_VALOR,
							0 VERSION , ''DML-557'' USUARIOCREAR, 
							SYSDATE FECHACREAR, 0 BORRADO
							FROM '|| V_ESQUEMA || '.ACU_OPERACIONES_TERMINOS OP
							WHERE BORRADO = 0 AND NOT OP_PLAN_PGS_FECHA IS NULL) ORI
						ON (DEST.TEA_ID = ORI.TEA_ID AND DEST.CMP_ID = ORI.CMP_ID)
						WHEN MATCHED THEN
						  UPDATE SET DEST.AVT_VALOR = ORI.AVT_VALOR, 
						             DEST.USUARIOMODIFICAR = ORI.USUARIOCREAR, 
						             DEST.FECHAMODIFICAR = ORI.FECHACREAR
						WHEN NOT MATCHED THEN
						  INSERT (DEST.AVT_ID, DEST.TEA_ID, DEST.CMP_ID, DEST.AVT_VALOR, DEST.VERSION, DEST.USUARIOCREAR, DEST.FECHACREAR, DEST.BORRADO)
						  VALUES ('|| V_ESQUEMA || '.S_ACU_VALORES_TERMINOS.NEXTVAL, ORI.TEA_ID, ORI.CMP_ID, ORI.AVT_VALOR, ORI.VERSION, ORI.USUARIOCREAR, ORI.FECHACREAR, ORI.BORRADO)';						
						
			EXECUTE IMMEDIATE V_MSQL;
		END IF;
		DBMS_OUTPUT.PUT_LINE('[INFO] Campo ''fechaPlanPago'' traspasado.....');		
		
		-- Traspaso del campo frecuenciaPlanpago
		V_SQL := 'SELECT COUNT(1) FROM '|| V_ESQUEMA || '.ACU_CAMPOS_TIPO_ACUERDO CMP WHERE CMP.CMP_NOMBRE_CAMPO = ''frecuenciaPlanpago'' AND BORRADO = 0';		
		EXECUTE IMMEDIATE V_SQL INTO V_NUM_TABLAS;
		IF V_NUM_TABLAS = 1 THEN
			V_SQL := 'SELECT CMP.CMP_ID FROM '|| V_ESQUEMA || '.ACU_CAMPOS_TIPO_ACUERDO CMP WHERE CMP.CMP_NOMBRE_CAMPO = ''frecuenciaPlanpago'' AND BORRADO = 0';
			EXECUTE IMMEDIATE V_SQL INTO V_CMP_ID;
		
			V_MSQL := 'MERGE INTO '|| V_ESQUEMA || '.ACU_VALORES_TERMINOS DEST
						USING 
							(SELECT 
							OP.TEA_ID TEA_ID,
							'|| V_CMP_ID ||' CMP_ID,
							OP.OP_PLAN_PGS_FRECUENCIA AVT_VALOR,
							0 VERSION , ''DML-557'' USUARIOCREAR, 
							SYSDATE FECHACREAR, 0 BORRADO
							FROM '|| V_ESQUEMA || '.ACU_OPERACIONES_TERMINOS OP
							WHERE BORRADO = 0 AND NOT OP_PLAN_PGS_FRECUENCIA IS NULL) ORI
						ON (DEST.TEA_ID = ORI.TEA_ID AND DEST.CMP_ID = ORI.CMP_ID)
						WHEN MATCHED THEN
						  UPDATE SET DEST.AVT_VALOR = ORI.AVT_VALOR, 
						             DEST.USUARIOMODIFICAR = ORI.USUARIOCREAR, 
						             DEST.FECHAMODIFICAR = ORI.FECHACREAR
						WHEN NOT MATCHED THEN
						  INSERT (DEST.AVT_ID, DEST.TEA_ID, DEST.CMP_ID, DEST.AVT_VALOR, DEST.VERSION, DEST.USUARIOCREAR, DEST.FECHACREAR, DEST.BORRADO)
						  VALUES ('|| V_ESQUEMA || '.S_ACU_VALORES_TERMINOS.NEXTVAL, ORI.TEA_ID, ORI.CMP_ID, ORI.AVT_VALOR, ORI.VERSION, ORI.USUARIOCREAR, ORI.FECHACREAR, ORI.BORRADO)';						
						
			EXECUTE IMMEDIATE V_MSQL;
		END IF;
		DBMS_OUTPUT.PUT_LINE('[INFO] Campo ''frecuenciaPlanpago'' traspasado.....');		
		
		-- Traspaso del campo numeroPagosPlanpago
		V_SQL := 'SELECT COUNT(1) FROM '|| V_ESQUEMA || '.ACU_CAMPOS_TIPO_ACUERDO CMP WHERE CMP.CMP_NOMBRE_CAMPO = ''numeroPagosPlanpago'' AND BORRADO = 0';
		EXECUTE IMMEDIATE V_SQL INTO V_NUM_TABLAS;
		IF V_NUM_TABLAS = 1 THEN
			V_SQL := 'SELECT CMP.CMP_ID FROM '|| V_ESQUEMA || '.ACU_CAMPOS_TIPO_ACUERDO CMP WHERE CMP.CMP_NOMBRE_CAMPO = ''numeroPagosPlanpago'' AND BORRADO = 0';
			EXECUTE IMMEDIATE V_SQL INTO V_CMP_ID;
		
			V_MSQL := 'MERGE INTO '|| V_ESQUEMA || '.ACU_VALORES_TERMINOS DEST
						USING 
							(SELECT 
							OP.TEA_ID TEA_ID,
							'|| V_CMP_ID ||' CMP_ID,
							OP.OP_PLAN_PGS_NUM_PAGOS AVT_VALOR,
							0 VERSION , ''DML-557'' USUARIOCREAR, 
							SYSDATE FECHACREAR, 0 BORRADO
							FROM '|| V_ESQUEMA || '.ACU_OPERACIONES_TERMINOS OP
							WHERE BORRADO = 0 AND NOT OP_PLAN_PGS_NUM_PAGOS IS NULL) ORI
						ON (DEST.TEA_ID = ORI.TEA_ID AND DEST.CMP_ID = ORI.CMP_ID)
						WHEN MATCHED THEN
						  UPDATE SET DEST.AVT_VALOR = ORI.AVT_VALOR, 
						             DEST.USUARIOMODIFICAR = ORI.USUARIOCREAR, 
						             DEST.FECHAMODIFICAR = ORI.FECHACREAR
						WHEN NOT MATCHED THEN
						  INSERT (DEST.AVT_ID, DEST.TEA_ID, DEST.CMP_ID, DEST.AVT_VALOR, DEST.VERSION, DEST.USUARIOCREAR, DEST.FECHACREAR, DEST.BORRADO)
						  VALUES ('|| V_ESQUEMA || '.S_ACU_VALORES_TERMINOS.NEXTVAL, ORI.TEA_ID, ORI.CMP_ID, ORI.AVT_VALOR, ORI.VERSION, ORI.USUARIOCREAR, ORI.FECHACREAR, ORI.BORRADO)';						
						
			EXECUTE IMMEDIATE V_MSQL;
		END IF;
		DBMS_OUTPUT.PUT_LINE('[INFO] Campo ''numeroPagosPlanpago'' traspasado.....');		
		
		-- Traspaso del campo importePlanpago
		V_SQL := 'SELECT COUNT(1) FROM '|| V_ESQUEMA || '.ACU_CAMPOS_TIPO_ACUERDO CMP WHERE CMP.CMP_NOMBRE_CAMPO = ''importePlanpago'' AND BORRADO = 0';		
		EXECUTE IMMEDIATE V_SQL INTO V_NUM_TABLAS;
		IF V_NUM_TABLAS = 1 THEN
			V_SQL := 'SELECT CMP.CMP_ID FROM '|| V_ESQUEMA || '.ACU_CAMPOS_TIPO_ACUERDO CMP WHERE CMP.CMP_NOMBRE_CAMPO = ''importePlanpago'' AND BORRADO = 0';
			EXECUTE IMMEDIATE V_SQL INTO V_CMP_ID;
		
			V_MSQL := 'MERGE INTO '|| V_ESQUEMA || '.ACU_VALORES_TERMINOS DEST
						USING 
							(SELECT 
							OP.TEA_ID TEA_ID,
							'|| V_CMP_ID ||' CMP_ID,
							OP.OP_PLAN_PGS_IMPORTE AVT_VALOR,
							0 VERSION , ''DML-557'' USUARIOCREAR, 
							SYSDATE FECHACREAR, 0 BORRADO
							FROM '|| V_ESQUEMA || '.ACU_OPERACIONES_TERMINOS OP
							WHERE BORRADO = 0 AND NOT OP_PLAN_PGS_IMPORTE IS NULL) ORI
						ON (DEST.TEA_ID = ORI.TEA_ID AND DEST.CMP_ID = ORI.CMP_ID)
						WHEN MATCHED THEN
						  UPDATE SET DEST.AVT_VALOR = ORI.AVT_VALOR, 
						             DEST.USUARIOMODIFICAR = ORI.USUARIOCREAR, 
						             DEST.FECHAMODIFICAR = ORI.FECHACREAR
						WHEN NOT MATCHED THEN
						  INSERT (DEST.AVT_ID, DEST.TEA_ID, DEST.CMP_ID, DEST.AVT_VALOR, DEST.VERSION, DEST.USUARIOCREAR, DEST.FECHACREAR, DEST.BORRADO)
						  VALUES ('|| V_ESQUEMA || '.S_ACU_VALORES_TERMINOS.NEXTVAL, ORI.TEA_ID, ORI.CMP_ID, ORI.AVT_VALOR, ORI.VERSION, ORI.USUARIOCREAR, ORI.FECHACREAR, ORI.BORRADO)';						
						
			EXECUTE IMMEDIATE V_MSQL;
		END IF;
		DBMS_OUTPUT.PUT_LINE('[INFO] Campo ''importePlanpago'' traspasado.....');		
		
		-- Traspaso del campo analisiSolvencia
		V_SQL := 'SELECT COUNT(1) FROM '|| V_ESQUEMA || '.ACU_CAMPOS_TIPO_ACUERDO CMP WHERE CMP.CMP_NOMBRE_CAMPO = ''analisiSolvencia'' AND BORRADO = 0';
		EXECUTE IMMEDIATE V_SQL INTO V_NUM_TABLAS;
		IF V_NUM_TABLAS = 1 THEN
			V_SQL := 'SELECT CMP.CMP_ID FROM '|| V_ESQUEMA || '.ACU_CAMPOS_TIPO_ACUERDO CMP WHERE CMP.CMP_NOMBRE_CAMPO = ''analisiSolvencia'' AND BORRADO = 0';
			EXECUTE IMMEDIATE V_SQL INTO V_CMP_ID;
		
			V_MSQL := 'MERGE INTO '|| V_ESQUEMA || '.ACU_VALORES_TERMINOS DEST
						USING 
							(SELECT 
							OP.TEA_ID TEA_ID,
							'|| V_CMP_ID ||' CMP_ID,
							OP.OP_ANALISIS_SOLVENCIA AVT_VALOR,
							0 VERSION , ''DML-557'' USUARIOCREAR, 
							SYSDATE FECHACREAR, 0 BORRADO
							FROM '|| V_ESQUEMA || '.ACU_OPERACIONES_TERMINOS OP
							WHERE BORRADO = 0 AND NOT OP_ANALISIS_SOLVENCIA IS NULL) ORI
						ON (DEST.TEA_ID = ORI.TEA_ID AND DEST.CMP_ID = ORI.CMP_ID)
						WHEN MATCHED THEN
						  UPDATE SET DEST.AVT_VALOR = ORI.AVT_VALOR, 
						             DEST.USUARIOMODIFICAR = ORI.USUARIOCREAR, 
						             DEST.FECHAMODIFICAR = ORI.FECHACREAR
						WHEN NOT MATCHED THEN
						  INSERT (DEST.AVT_ID, DEST.TEA_ID, DEST.CMP_ID, DEST.AVT_VALOR, DEST.VERSION, DEST.USUARIOCREAR, DEST.FECHACREAR, DEST.BORRADO)
						  VALUES ('|| V_ESQUEMA || '.S_ACU_VALORES_TERMINOS.NEXTVAL, ORI.TEA_ID, ORI.CMP_ID, ORI.AVT_VALOR, ORI.VERSION, ORI.USUARIOCREAR, ORI.FECHACREAR, ORI.BORRADO)';						
							
			EXECUTE IMMEDIATE V_MSQL;
		END IF;
		DBMS_OUTPUT.PUT_LINE('[INFO] Campo ''analisiSolvencia'' traspasado.....');		
		
		-- Traspaso del campo descripcionAcuerdo
		V_SQL := 'SELECT COUNT(1) FROM '|| V_ESQUEMA || '.ACU_CAMPOS_TIPO_ACUERDO CMP WHERE CMP.CMP_NOMBRE_CAMPO = ''descripcionAcuerdo'' AND BORRADO = 0';		
		EXECUTE IMMEDIATE V_SQL INTO V_NUM_TABLAS;
		IF V_NUM_TABLAS = 1 THEN
			V_SQL := 'SELECT CMP.CMP_ID FROM '|| V_ESQUEMA || '.ACU_CAMPOS_TIPO_ACUERDO CMP WHERE CMP.CMP_NOMBRE_CAMPO = ''descripcionAcuerdo'' AND BORRADO = 0';
			EXECUTE IMMEDIATE V_SQL INTO V_CMP_ID;
		
			V_MSQL := 'MERGE INTO '|| V_ESQUEMA || '.ACU_VALORES_TERMINOS DEST
						USING 
							(SELECT 
							OP.TEA_ID TEA_ID,
							'|| V_CMP_ID ||' CMP_ID,
							OP.OP_DESC_ACUERDO AVT_VALOR,
							0 VERSION , ''DML-557'' USUARIOCREAR, 
							SYSDATE FECHACREAR, 0 BORRADO
							FROM '|| V_ESQUEMA || '.ACU_OPERACIONES_TERMINOS OP
							WHERE BORRADO = 0 AND NOT OP_DESC_ACUERDO IS NULL) ORI
						ON (DEST.TEA_ID = ORI.TEA_ID AND DEST.CMP_ID = ORI.CMP_ID)
						WHEN MATCHED THEN
						  UPDATE SET DEST.AVT_VALOR = ORI.AVT_VALOR, 
						             DEST.USUARIOMODIFICAR = ORI.USUARIOCREAR, 
						             DEST.FECHAMODIFICAR = ORI.FECHACREAR
						WHEN NOT MATCHED THEN
						  INSERT (DEST.AVT_ID, DEST.TEA_ID, DEST.CMP_ID, DEST.AVT_VALOR, DEST.VERSION, DEST.USUARIOCREAR, DEST.FECHACREAR, DEST.BORRADO)
						  VALUES ('|| V_ESQUEMA || '.S_ACU_VALORES_TERMINOS.NEXTVAL, ORI.TEA_ID, ORI.CMP_ID, ORI.AVT_VALOR, ORI.VERSION, ORI.USUARIOCREAR, ORI.FECHACREAR, ORI.BORRADO)';						
						
			EXECUTE IMMEDIATE V_MSQL;
		END IF;
		DBMS_OUTPUT.PUT_LINE('[INFO] Campo ''descripcionAcuerdo'' traspasado.....');		
		
		-- Traspaso del campo fechaSolucionPrevista
		V_SQL := 'SELECT COUNT(1) FROM '|| V_ESQUEMA || '.ACU_CAMPOS_TIPO_ACUERDO CMP WHERE CMP.CMP_NOMBRE_CAMPO = ''fechaSolucionPrevista'' AND BORRADO = 0';		
		EXECUTE IMMEDIATE V_SQL INTO V_NUM_TABLAS;
		IF V_NUM_TABLAS = 1 THEN
			V_SQL := 'SELECT CMP.CMP_ID FROM '|| V_ESQUEMA || '.ACU_CAMPOS_TIPO_ACUERDO CMP WHERE CMP.CMP_NOMBRE_CAMPO = ''fechaSolucionPrevista'' AND BORRADO = 0';
			EXECUTE IMMEDIATE V_SQL INTO V_CMP_ID;
		
			V_MSQL := 'MERGE INTO '|| V_ESQUEMA || '.ACU_VALORES_TERMINOS DEST
						USING 
							(SELECT 
							OP.TEA_ID TEA_ID,
							'|| V_CMP_ID ||' CMP_ID,
							TO_CHAR(OP.OP_FECHA_SOL_PREVISTA,''DD/MM/YYYY'') AVT_VALOR,
							0 VERSION , ''DML-557'' USUARIOCREAR, 
							SYSDATE FECHACREAR, 0 BORRADO
							FROM '|| V_ESQUEMA || '.ACU_OPERACIONES_TERMINOS OP
							WHERE BORRADO = 0 AND NOT OP_FECHA_SOL_PREVISTA IS NULL) ORI
						ON (DEST.TEA_ID = ORI.TEA_ID AND DEST.CMP_ID = ORI.CMP_ID)
						WHEN MATCHED THEN
						  UPDATE SET DEST.AVT_VALOR = ORI.AVT_VALOR, 
						             DEST.USUARIOMODIFICAR = ORI.USUARIOCREAR, 
						             DEST.FECHAMODIFICAR = ORI.FECHACREAR
						WHEN NOT MATCHED THEN
						  INSERT (DEST.AVT_ID, DEST.TEA_ID, DEST.CMP_ID, DEST.AVT_VALOR, DEST.VERSION, DEST.USUARIOCREAR, DEST.FECHACREAR, DEST.BORRADO)
						  VALUES ('|| V_ESQUEMA || '.S_ACU_VALORES_TERMINOS.NEXTVAL, ORI.TEA_ID, ORI.CMP_ID, ORI.AVT_VALOR, ORI.VERSION, ORI.USUARIOCREAR, ORI.FECHACREAR, ORI.BORRADO)';						
						
			EXECUTE IMMEDIATE V_MSQL;
		END IF;
		DBMS_OUTPUT.PUT_LINE('[INFO] Campo ''fechaSolucionPrevista'' traspasado.....');		
		
		-- Traspaso del campo numContratoDescuento
		V_SQL := 'SELECT COUNT(1) FROM '|| V_ESQUEMA || '.ACU_CAMPOS_TIPO_ACUERDO CMP WHERE CMP.CMP_NOMBRE_CAMPO = ''numContratoDescuento'' AND BORRADO = 0';		
		EXECUTE IMMEDIATE V_SQL INTO V_NUM_TABLAS;
		IF V_NUM_TABLAS = 1 THEN
			V_SQL := 'SELECT CMP.CMP_ID FROM '|| V_ESQUEMA || '.ACU_CAMPOS_TIPO_ACUERDO CMP WHERE CMP.CMP_NOMBRE_CAMPO = ''numContratoDescuento'' AND BORRADO = 0';
			EXECUTE IMMEDIATE V_SQL INTO V_CMP_ID;
			
			V_MSQL := 'MERGE INTO '|| V_ESQUEMA || '.ACU_VALORES_TERMINOS DEST
						USING 
							(SELECT 
							OP.TEA_ID TEA_ID,
							'|| V_CMP_ID ||' CMP_ID,
							OP.OP_NUM_CONTRATO_DESCUENTO AVT_VALOR,
							0 VERSION , ''DML-557'' USUARIOCREAR, 
							SYSDATE FECHACREAR, 0 BORRADO
							FROM '|| V_ESQUEMA || '.ACU_OPERACIONES_TERMINOS OP
							WHERE BORRADO = 0 AND NOT OP_NUM_CONTRATO_DESCUENTO IS NULL) ORI
						ON (DEST.TEA_ID = ORI.TEA_ID AND DEST.CMP_ID = ORI.CMP_ID)
						WHEN MATCHED THEN
						  UPDATE SET DEST.AVT_VALOR = ORI.AVT_VALOR, 
						             DEST.USUARIOMODIFICAR = ORI.USUARIOCREAR, 
						             DEST.FECHAMODIFICAR = ORI.FECHACREAR
						WHEN NOT MATCHED THEN
						  INSERT (DEST.AVT_ID, DEST.TEA_ID, DEST.CMP_ID, DEST.AVT_VALOR, DEST.VERSION, DEST.USUARIOCREAR, DEST.FECHACREAR, DEST.BORRADO)
						  VALUES ('|| V_ESQUEMA || '.S_ACU_VALORES_TERMINOS.NEXTVAL, ORI.TEA_ID, ORI.CMP_ID, ORI.AVT_VALOR, ORI.VERSION, ORI.USUARIOCREAR, ORI.FECHACREAR, ORI.BORRADO)';						
						
			EXECUTE IMMEDIATE V_MSQL;
		END IF;
		DBMS_OUTPUT.PUT_LINE('[INFO] Campo ''numContratoDescuento'' traspasado.....');		
		
		-- Traspaso del campo numeroContratoPtmoPromotor
		V_SQL := 'SELECT COUNT(1) FROM '|| V_ESQUEMA || '.ACU_CAMPOS_TIPO_ACUERDO CMP WHERE CMP.CMP_NOMBRE_CAMPO = ''numeroContratoPtmoPromotor'' AND BORRADO = 0';		
		EXECUTE IMMEDIATE V_SQL INTO V_NUM_TABLAS;
		IF V_NUM_TABLAS = 1 THEN
			V_SQL := 'SELECT CMP.CMP_ID FROM '|| V_ESQUEMA || '.ACU_CAMPOS_TIPO_ACUERDO CMP WHERE CMP.CMP_NOMBRE_CAMPO = ''numeroContratoPtmoPromotor'' AND BORRADO = 0';
			EXECUTE IMMEDIATE V_SQL INTO V_CMP_ID;
		
			V_MSQL := 'MERGE INTO '|| V_ESQUEMA || '.ACU_VALORES_TERMINOS DEST
						USING 
							(SELECT 
							OP.TEA_ID TEA_ID,
							'|| V_CMP_ID ||' CMP_ID,
							OP.OP_NUM_CONTRATO_PTMO_PROMOTOR AVT_VALOR,
							0 VERSION , ''DML-557'' USUARIOCREAR, 
							SYSDATE FECHACREAR, 0 BORRADO
							FROM '|| V_ESQUEMA || '.ACU_OPERACIONES_TERMINOS OP
							WHERE BORRADO = 0 AND NOT OP_NUM_CONTRATO_PTMO_PROMOTOR IS NULL) ORI
						ON (DEST.TEA_ID = ORI.TEA_ID AND DEST.CMP_ID = ORI.CMP_ID)
						WHEN MATCHED THEN
						  UPDATE SET DEST.AVT_VALOR = ORI.AVT_VALOR, 
						             DEST.USUARIOMODIFICAR = ORI.USUARIOCREAR, 
						             DEST.FECHAMODIFICAR = ORI.FECHACREAR
						WHEN NOT MATCHED THEN
						  INSERT (DEST.AVT_ID, DEST.TEA_ID, DEST.CMP_ID, DEST.AVT_VALOR, DEST.VERSION, DEST.USUARIOCREAR, DEST.FECHACREAR, DEST.BORRADO)
						  VALUES ('|| V_ESQUEMA || '.S_ACU_VALORES_TERMINOS.NEXTVAL, ORI.TEA_ID, ORI.CMP_ID, ORI.AVT_VALOR, ORI.VERSION, ORI.USUARIOCREAR, ORI.FECHACREAR, ORI.BORRADO)';						
						
			EXECUTE IMMEDIATE V_MSQL;
		END IF;
		DBMS_OUTPUT.PUT_LINE('[INFO] Campo ''numeroContratoPtmoPromotor'' traspasado.....');		
		
		-- Traspaso del campo codigoPersonaAfectada
		V_SQL := 'SELECT COUNT(1) FROM '|| V_ESQUEMA || '.ACU_CAMPOS_TIPO_ACUERDO CMP WHERE CMP.CMP_NOMBRE_CAMPO = ''codigoPersonaAfectada'' AND BORRADO = 0';		
		EXECUTE IMMEDIATE V_SQL INTO V_NUM_TABLAS;
		IF V_NUM_TABLAS = 1 THEN
			V_SQL := 'SELECT CMP.CMP_ID FROM '|| V_ESQUEMA || '.ACU_CAMPOS_TIPO_ACUERDO CMP WHERE CMP.CMP_NOMBRE_CAMPO = ''codigoPersonaAfectada'' AND BORRADO = 0';
			EXECUTE IMMEDIATE V_SQL INTO V_CMP_ID;
		
			V_MSQL := 'MERGE INTO '|| V_ESQUEMA || '.ACU_VALORES_TERMINOS DEST
						USING 
							(SELECT 
							OP.TEA_ID TEA_ID,
							'|| V_CMP_ID ||' CMP_ID,
							OP.OP_COD_PERSONA_AFECTADA AVT_VALOR,
							0 VERSION , ''DML-557'' USUARIOCREAR, 
							SYSDATE FECHACREAR, 0 BORRADO
							FROM '|| V_ESQUEMA || '.ACU_OPERACIONES_TERMINOS OP
							WHERE BORRADO = 0 AND NOT OP_COD_PERSONA_AFECTADA IS NULL) ORI
						ON (DEST.TEA_ID = ORI.TEA_ID AND DEST.CMP_ID = ORI.CMP_ID)
						WHEN MATCHED THEN
						  UPDATE SET DEST.AVT_VALOR = ORI.AVT_VALOR, 
						             DEST.USUARIOMODIFICAR = ORI.USUARIOCREAR, 
						             DEST.FECHAMODIFICAR = ORI.FECHACREAR
						WHEN NOT MATCHED THEN
						  INSERT (DEST.AVT_ID, DEST.TEA_ID, DEST.CMP_ID, DEST.AVT_VALOR, DEST.VERSION, DEST.USUARIOCREAR, DEST.FECHACREAR, DEST.BORRADO)
						  VALUES ('|| V_ESQUEMA || '.S_ACU_VALORES_TERMINOS.NEXTVAL, ORI.TEA_ID, ORI.CMP_ID, ORI.AVT_VALOR, ORI.VERSION, ORI.USUARIOCREAR, ORI.FECHACREAR, ORI.BORRADO)';						
						
			EXECUTE IMMEDIATE V_MSQL;
		END IF;
		DBMS_OUTPUT.PUT_LINE('[INFO] Campo ''codigoPersonaAfectada'' traspasado.....');		

	ELSE
		DBMS_OUTPUT.PUT_LINE('[INFO] Falta la tabla ACU_OPERACIONES_TERMINOS o ACU_VALORES_TERMINOS, ambas son necesarias');
    END IF;
    
    COMMIT;
    
EXCEPTION
  WHEN OTHERS THEN
    ERR_NUM := SQLCODE;
    ERR_MSG := SQLERRM;
    DBMS_OUTPUT.put_line('[ERROR] Se ha producido un error en la ejecución:'||TO_CHAR(ERR_NUM));
    DBMS_OUTPUT.put_line('-----------------------------------------------------------'); 
    DBMS_OUTPUT.put_line(ERR_MSG);
    ROLLBACK;
    RAISE;   
END;
/
EXIT;
