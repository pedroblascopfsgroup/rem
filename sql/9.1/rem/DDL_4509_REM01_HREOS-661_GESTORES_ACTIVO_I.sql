--/*
--#########################################
--## AUTOR=DAVID GONZALEZ
--## FECHA_CREACION=20160706
--## ARTEFACTO=batch
--## VERSION_ARTEFACTO=0.1
--## INCIDENCIA_LINK=HREOS-661
--## PRODUCTO=NO
--## 
--## Finalidad: Volcado de Excel de Gestores a tabla temporal TMP_GESTORES_PROVINCIAS.
--##			
--## INSTRUCCIONES:  
--## VERSIONES:
--##        0.1 Versión inicial
--#########################################
----*/


WHENEVER SQLERROR EXIT SQL.SQLCODE;
SET SERVEROUTPUT ON; 
SET DEFINE OFF;


DECLARE

	V_MSQL VARCHAR2(32000 CHAR); 
	V_ESQUEMA VARCHAR2(25 CHAR):= '#ESQUEMA#'; 
	V_ESQUEMA_M VARCHAR2(25 CHAR):= '#ESQUEMA_MASTER#';
	V_SQL VARCHAR2(4000 CHAR);
	V_NUM NUMBER(16);
	ERR_NUM NUMBER(25);  
	ERR_MSG VARCHAR2(1024 CHAR); 

BEGIN	
	
	DBMS_OUTPUT.PUT_LINE('[INFO] INICIO DEL PROCESO.');
	
	V_MSQL := '
	SELECT COUNT(1) FROM ALL_TABLES WHERE TABLE_NAME = ''TMP_GESTORES_PROVINCIAS'' AND OWNER = '''||V_ESQUEMA||'''
	'
	;
	EXECUTE IMMEDIATE V_MSQL INTO V_NUM;
	
	IF V_NUM != 0 THEN
	
		DBMS_OUTPUT.PUT_LINE('[INFO] LA TABLA TMP_GESTORES_PROVINCIAS YA EXISTE. SE BORRARÁ Y SE CREARÁ DE NUEVO.');
		
		EXECUTE IMMEDIATE '
		DROP TABLE '||V_ESQUEMA||'.TMP_GESTORES_PROVINCIAS PURGE
		'
		;
		
	ELSE
	
		DBMS_OUTPUT.PUT_LINE('[INFO] LA TABLA TMP_GESTORES_PROVINCIAS NO EXISTE. SE CREARÁ.');
		
	END IF;
	
	EXECUTE IMMEDIATE '
	CREATE TABLE TMP_GESTORES_PROVINCIAS AS (

	SELECT ''1'' AS COD_PROVINCIA, USU_ID, USU_USERNAME AS USUARIO_GESTION_ACTIVOS, USU_NOMBRE||'' ''||USU_APELLIDO1||'' ''||USU_APELLIDO2 AS NOMBRE_GESTION_ACTIVOS 
	FROM '||V_ESQUEMA_M||'.USU_USUARIOS WHERE UPPER(USU_NOMBRE) LIKE ''%HECTOR%'' AND UPPER(USU_APELLIDO1) LIKE ''%GIMENEZ%''
	UNION ALL
	SELECT ''2'' AS COD_PROVINCIA, USU_ID, USU_USERNAME AS USUARIO_GESTION_ACTIVOS, USU_NOMBRE||'' ''||USU_APELLIDO1||'' ''||USU_APELLIDO2 AS NOMBRE_GESTION_ACTIVOS 
	FROM '||V_ESQUEMA_M||'.USU_USUARIOS WHERE UPPER(USU_NOMBRE) LIKE ''%CARMEN%'' AND UPPER(USU_APELLIDO1) LIKE ''%KUHNEL%''
	UNION ALL
	SELECT ''3'' AS COD_PROVINCIA, USU_ID, USU_USERNAME AS USUARIO_GESTION_ACTIVOS, USU_NOMBRE||'' ''||USU_APELLIDO1||'' ''||USU_APELLIDO2 AS NOMBRE_GESTION_ACTIVOS 
	FROM '||V_ESQUEMA_M||'.USU_USUARIOS WHERE UPPER(USU_NOMBRE) LIKE ''%RAFA%'' AND UPPER(USU_APELLIDO1) LIKE ''%DOMINGUEZ%''
	UNION ALL
	SELECT ''4'' AS COD_PROVINCIA, USU_ID, USU_USERNAME AS USUARIO_GESTION_ACTIVOS, USU_NOMBRE||'' ''||USU_APELLIDO1||'' ''||USU_APELLIDO2 AS NOMBRE_GESTION_ACTIVOS 
	FROM '||V_ESQUEMA_M||'.USU_USUARIOS WHERE UPPER(USU_NOMBRE) LIKE ''%ANTONIO%'' AND UPPER(USU_APELLIDO1) LIKE ''%RUIZ%''
	UNION ALL
	SELECT ''5'' AS COD_PROVINCIA, USU_ID, USU_USERNAME AS USUARIO_GESTION_ACTIVOS, USU_NOMBRE||'' ''||USU_APELLIDO1||'' ''||USU_APELLIDO2 AS NOMBRE_GESTION_ACTIVOS 
	FROM '||V_ESQUEMA_M||'.USU_USUARIOS WHERE UPPER(USU_NOMBRE) LIKE ''%IRENE%'' AND UPPER(USU_APELLIDO1) LIKE ''%TAVERA%''
	UNION ALL
	SELECT ''6'' AS COD_PROVINCIA, USU_ID, USU_USERNAME AS USUARIO_GESTION_ACTIVOS, USU_NOMBRE||'' ''||USU_APELLIDO1||'' ''||USU_APELLIDO2 AS NOMBRE_GESTION_ACTIVOS 
	FROM '||V_ESQUEMA_M||'.USU_USUARIOS WHERE UPPER(USU_NOMBRE) LIKE ''%ANTONIO%'' AND UPPER(USU_APELLIDO1) LIKE ''%RUIZ%''
	UNION ALL
	SELECT ''7'' AS COD_PROVINCIA, USU_ID, USU_USERNAME AS USUARIO_GESTION_ACTIVOS, USU_NOMBRE||'' ''||USU_APELLIDO1||'' ''||USU_APELLIDO2 AS NOMBRE_GESTION_ACTIVOS 
	FROM '||V_ESQUEMA_M||'.USU_USUARIOS WHERE UPPER(USU_NOMBRE) LIKE ''%SARA%'' AND UPPER(USU_APELLIDO1) LIKE ''%ARAGÓN%''
	UNION ALL
	SELECT ''8'' AS COD_PROVINCIA, USU_ID, USU_USERNAME AS USUARIO_GESTION_ACTIVOS, USU_NOMBRE||'' ''||USU_APELLIDO1||'' ''||USU_APELLIDO2 AS NOMBRE_GESTION_ACTIVOS 
	FROM '||V_ESQUEMA_M||'.USU_USUARIOS WHERE UPPER(USU_NOMBRE) LIKE ''%JOSE%'' AND UPPER(USU_APELLIDO1) LIKE ''%PELAZ%''
	UNION ALL
	SELECT ''9'' AS COD_PROVINCIA, USU_ID, USU_USERNAME AS USUARIO_GESTION_ACTIVOS, USU_NOMBRE||'' ''||USU_APELLIDO1||'' ''||USU_APELLIDO2 AS NOMBRE_GESTION_ACTIVOS 
	FROM '||V_ESQUEMA_M||'.USU_USUARIOS WHERE UPPER(USU_NOMBRE) LIKE ''%HECTOR%'' AND UPPER(USU_APELLIDO1) LIKE ''%GIMENEZ%''
	UNION ALL
	SELECT ''10'' AS COD_PROVINCIA, USU_ID, USU_USERNAME AS USUARIO_GESTION_ACTIVOS, USU_NOMBRE||'' ''||USU_APELLIDO1||'' ''||USU_APELLIDO2 AS NOMBRE_GESTION_ACTIVOS 
	FROM '||V_ESQUEMA_M||'.USU_USUARIOS WHERE UPPER(USU_NOMBRE) LIKE ''%ANTONIO%'' AND UPPER(USU_APELLIDO1) LIKE ''%RUIZ%''
	UNION ALL
	SELECT ''11'' AS COD_PROVINCIA, USU_ID, USU_USERNAME AS USUARIO_GESTION_ACTIVOS, USU_NOMBRE||'' ''||USU_APELLIDO1||'' ''||USU_APELLIDO2 AS NOMBRE_GESTION_ACTIVOS 
	FROM '||V_ESQUEMA_M||'.USU_USUARIOS WHERE UPPER(USU_NOMBRE) LIKE ''%ANTONIO%'' AND UPPER(USU_APELLIDO1) LIKE ''%RUIZ%''
	UNION ALL
	SELECT ''12'' AS COD_PROVINCIA, USU_ID, USU_USERNAME AS USUARIO_GESTION_ACTIVOS, USU_NOMBRE||'' ''||USU_APELLIDO1||'' ''||USU_APELLIDO2 AS NOMBRE_GESTION_ACTIVOS 
	FROM '||V_ESQUEMA_M||'.USU_USUARIOS WHERE UPPER(USU_NOMBRE) LIKE ''%JOSE%'' AND UPPER(USU_APELLIDO1) LIKE ''%LENGUA%''
	UNION ALL
	SELECT ''13'' AS COD_PROVINCIA, USU_ID, USU_USERNAME AS USUARIO_GESTION_ACTIVOS, USU_NOMBRE||'' ''||USU_APELLIDO1||'' ''||USU_APELLIDO2 AS NOMBRE_GESTION_ACTIVOS 
	FROM '||V_ESQUEMA_M||'.USU_USUARIOS WHERE UPPER(USU_NOMBRE) LIKE ''%ANTONIO%'' AND UPPER(USU_APELLIDO1) LIKE ''%RUIZ%''
	UNION ALL
	SELECT ''14'' AS COD_PROVINCIA, USU_ID, USU_USERNAME AS USUARIO_GESTION_ACTIVOS, USU_NOMBRE||'' ''||USU_APELLIDO1||'' ''||USU_APELLIDO2 AS NOMBRE_GESTION_ACTIVOS 
	FROM '||V_ESQUEMA_M||'.USU_USUARIOS WHERE UPPER(USU_NOMBRE) LIKE ''%ANTONIO%'' AND UPPER(USU_APELLIDO1) LIKE ''%RUIZ%''
	UNION ALL
	SELECT ''15'' AS COD_PROVINCIA, USU_ID, USU_USERNAME AS USUARIO_GESTION_ACTIVOS, USU_NOMBRE||'' ''||USU_APELLIDO1||'' ''||USU_APELLIDO2 AS NOMBRE_GESTION_ACTIVOS 
	FROM '||V_ESQUEMA_M||'.USU_USUARIOS WHERE UPPER(USU_NOMBRE) LIKE ''%HECTOR%'' AND UPPER(USU_APELLIDO1) LIKE ''%GIMENEZ%''
	UNION ALL
	SELECT ''16'' AS COD_PROVINCIA, USU_ID, USU_USERNAME AS USUARIO_GESTION_ACTIVOS, USU_NOMBRE||'' ''||USU_APELLIDO1||'' ''||USU_APELLIDO2 AS NOMBRE_GESTION_ACTIVOS 
	FROM '||V_ESQUEMA_M||'.USU_USUARIOS WHERE UPPER(USU_NOMBRE) LIKE ''%NATALIA%'' AND UPPER(USU_APELLIDO1) LIKE ''%HORCAJO%''
	UNION ALL
	SELECT ''17'' AS COD_PROVINCIA, USU_ID, USU_USERNAME AS USUARIO_GESTION_ACTIVOS, USU_NOMBRE||'' ''||USU_APELLIDO1||'' ''||USU_APELLIDO2 AS NOMBRE_GESTION_ACTIVOS 
	FROM '||V_ESQUEMA_M||'.USU_USUARIOS WHERE UPPER(USU_NOMBRE) LIKE ''%JOSÉ%'' AND UPPER(USU_APELLIDO1) LIKE ''%BERENGUER%''
	UNION ALL
	SELECT ''18'' AS COD_PROVINCIA, USU_ID, USU_USERNAME AS USUARIO_GESTION_ACTIVOS, USU_NOMBRE||'' ''||USU_APELLIDO1||'' ''||USU_APELLIDO2 AS NOMBRE_GESTION_ACTIVOS 
	FROM '||V_ESQUEMA_M||'.USU_USUARIOS WHERE UPPER(USU_NOMBRE) LIKE ''%ANTONIO%'' AND UPPER(USU_APELLIDO1) LIKE ''%RUIZ%''
	UNION ALL
	SELECT ''19'' AS COD_PROVINCIA, USU_ID, USU_USERNAME AS USUARIO_GESTION_ACTIVOS, USU_NOMBRE||'' ''||USU_APELLIDO1||'' ''||USU_APELLIDO2 AS NOMBRE_GESTION_ACTIVOS 
	FROM '||V_ESQUEMA_M||'.USU_USUARIOS WHERE UPPER(USU_NOMBRE) LIKE ''%CARMEN%'' AND UPPER(USU_APELLIDO1) LIKE ''%KUHNEL%''
	UNION ALL
	SELECT ''20'' AS COD_PROVINCIA, USU_ID, USU_USERNAME AS USUARIO_GESTION_ACTIVOS, USU_NOMBRE||'' ''||USU_APELLIDO1||'' ''||USU_APELLIDO2 AS NOMBRE_GESTION_ACTIVOS 
	FROM '||V_ESQUEMA_M||'.USU_USUARIOS WHERE UPPER(USU_NOMBRE) LIKE ''%HECTOR%'' AND UPPER(USU_APELLIDO1) LIKE ''%GIMENEZ%''
	UNION ALL
	SELECT ''21'' AS COD_PROVINCIA, USU_ID, USU_USERNAME AS USUARIO_GESTION_ACTIVOS, USU_NOMBRE||'' ''||USU_APELLIDO1||'' ''||USU_APELLIDO2 AS NOMBRE_GESTION_ACTIVOS 
	FROM '||V_ESQUEMA_M||'.USU_USUARIOS WHERE UPPER(USU_NOMBRE) LIKE ''%ANTONIO%'' AND UPPER(USU_APELLIDO1) LIKE ''%RUIZ%''
	UNION ALL
	SELECT ''22'' AS COD_PROVINCIA, USU_ID, USU_USERNAME AS USUARIO_GESTION_ACTIVOS, USU_NOMBRE||'' ''||USU_APELLIDO1||'' ''||USU_APELLIDO2 AS NOMBRE_GESTION_ACTIVOS 
	FROM '||V_ESQUEMA_M||'.USU_USUARIOS WHERE UPPER(USU_NOMBRE) LIKE ''%HECTOR%'' AND UPPER(USU_APELLIDO1) LIKE ''%GIMENEZ%''
	UNION ALL
	SELECT ''23'' AS COD_PROVINCIA, USU_ID, USU_USERNAME AS USUARIO_GESTION_ACTIVOS, USU_NOMBRE||'' ''||USU_APELLIDO1||'' ''||USU_APELLIDO2 AS NOMBRE_GESTION_ACTIVOS 
	FROM '||V_ESQUEMA_M||'.USU_USUARIOS WHERE UPPER(USU_NOMBRE) LIKE ''%ANTONIO%'' AND UPPER(USU_APELLIDO1) LIKE ''%RUIZ%''
	UNION ALL
	SELECT ''24'' AS COD_PROVINCIA, USU_ID, USU_USERNAME AS USUARIO_GESTION_ACTIVOS, USU_NOMBRE||'' ''||USU_APELLIDO1||'' ''||USU_APELLIDO2 AS NOMBRE_GESTION_ACTIVOS 
	FROM '||V_ESQUEMA_M||'.USU_USUARIOS WHERE UPPER(USU_NOMBRE) LIKE ''%HECTOR%'' AND UPPER(USU_APELLIDO1) LIKE ''%GIMENEZ%''
	UNION ALL
	SELECT ''25'' AS COD_PROVINCIA, USU_ID, USU_USERNAME AS USUARIO_GESTION_ACTIVOS, USU_NOMBRE||'' ''||USU_APELLIDO1||'' ''||USU_APELLIDO2 AS NOMBRE_GESTION_ACTIVOS 
	FROM '||V_ESQUEMA_M||'.USU_USUARIOS WHERE UPPER(USU_NOMBRE) LIKE ''%JOSÉ%'' AND UPPER(USU_APELLIDO1) LIKE ''%BERENGUER%''
	UNION ALL
	SELECT ''26'' AS COD_PROVINCIA, USU_ID, USU_USERNAME AS USUARIO_GESTION_ACTIVOS, USU_NOMBRE||'' ''||USU_APELLIDO1||'' ''||USU_APELLIDO2 AS NOMBRE_GESTION_ACTIVOS 
	FROM '||V_ESQUEMA_M||'.USU_USUARIOS WHERE UPPER(USU_NOMBRE) LIKE ''%HECTOR%'' AND UPPER(USU_APELLIDO1) LIKE ''%GIMENEZ%''
	UNION ALL
	SELECT ''27'' AS COD_PROVINCIA, USU_ID, USU_USERNAME AS USUARIO_GESTION_ACTIVOS, USU_NOMBRE||'' ''||USU_APELLIDO1||'' ''||USU_APELLIDO2 AS NOMBRE_GESTION_ACTIVOS 
	FROM '||V_ESQUEMA_M||'.USU_USUARIOS WHERE UPPER(USU_NOMBRE) LIKE ''%HECTOR%'' AND UPPER(USU_APELLIDO1) LIKE ''%GIMENEZ%''
	UNION ALL
	SELECT ''28'' AS COD_PROVINCIA, USU_ID, USU_USERNAME AS USUARIO_GESTION_ACTIVOS, USU_NOMBRE||'' ''||USU_APELLIDO1||'' ''||USU_APELLIDO2 AS NOMBRE_GESTION_ACTIVOS 
	FROM '||V_ESQUEMA_M||'.USU_USUARIOS WHERE UPPER(USU_NOMBRE) LIKE ''%IRENE%'' AND UPPER(USU_APELLIDO1) LIKE ''%TAVERA%''
	UNION ALL
	SELECT ''29'' AS COD_PROVINCIA, USU_ID, USU_USERNAME AS USUARIO_GESTION_ACTIVOS, USU_NOMBRE||'' ''||USU_APELLIDO1||'' ''||USU_APELLIDO2 AS NOMBRE_GESTION_ACTIVOS 
	FROM '||V_ESQUEMA_M||'.USU_USUARIOS WHERE UPPER(USU_NOMBRE) LIKE ''%ANTONIO%'' AND UPPER(USU_APELLIDO1) LIKE ''%RUIZ%''
	UNION ALL
	SELECT ''30'' AS COD_PROVINCIA, USU_ID, USU_USERNAME AS USUARIO_GESTION_ACTIVOS, USU_NOMBRE||'' ''||USU_APELLIDO1||'' ''||USU_APELLIDO2 AS NOMBRE_GESTION_ACTIVOS 
	FROM '||V_ESQUEMA_M||'.USU_USUARIOS WHERE UPPER(USU_NOMBRE) LIKE ''%CARMEN%'' AND UPPER(USU_APELLIDO1) LIKE ''%KUHNEL%''
	UNION ALL
	SELECT ''31'' AS COD_PROVINCIA, USU_ID, USU_USERNAME AS USUARIO_GESTION_ACTIVOS, USU_NOMBRE||'' ''||USU_APELLIDO1||'' ''||USU_APELLIDO2 AS NOMBRE_GESTION_ACTIVOS 
	FROM '||V_ESQUEMA_M||'.USU_USUARIOS WHERE UPPER(USU_NOMBRE) LIKE ''%HECTOR%'' AND UPPER(USU_APELLIDO1) LIKE ''%GIMENEZ%''
	UNION ALL
	SELECT ''32'' AS COD_PROVINCIA, USU_ID, USU_USERNAME AS USUARIO_GESTION_ACTIVOS, USU_NOMBRE||'' ''||USU_APELLIDO1||'' ''||USU_APELLIDO2 AS NOMBRE_GESTION_ACTIVOS 
	FROM '||V_ESQUEMA_M||'.USU_USUARIOS WHERE UPPER(USU_NOMBRE) LIKE ''%HECTOR%'' AND UPPER(USU_APELLIDO1) LIKE ''%GIMENEZ%''
	UNION ALL
	SELECT ''33'' AS COD_PROVINCIA, USU_ID, USU_USERNAME AS USUARIO_GESTION_ACTIVOS, USU_NOMBRE||'' ''||USU_APELLIDO1||'' ''||USU_APELLIDO2 AS NOMBRE_GESTION_ACTIVOS 
	FROM '||V_ESQUEMA_M||'.USU_USUARIOS WHERE UPPER(USU_NOMBRE) LIKE ''%HECTOR%'' AND UPPER(USU_APELLIDO1) LIKE ''%GIMENEZ%''
	UNION ALL
	SELECT ''34'' AS COD_PROVINCIA, USU_ID, USU_USERNAME AS USUARIO_GESTION_ACTIVOS, USU_NOMBRE||'' ''||USU_APELLIDO1||'' ''||USU_APELLIDO2 AS NOMBRE_GESTION_ACTIVOS 
	FROM '||V_ESQUEMA_M||'.USU_USUARIOS WHERE UPPER(USU_NOMBRE) LIKE ''%HECTOR%'' AND UPPER(USU_APELLIDO1) LIKE ''%GIMENEZ%''
	UNION ALL
	SELECT ''35'' AS COD_PROVINCIA, USU_ID, USU_USERNAME AS USUARIO_GESTION_ACTIVOS, USU_NOMBRE||'' ''||USU_APELLIDO1||'' ''||USU_APELLIDO2 AS NOMBRE_GESTION_ACTIVOS 
	FROM '||V_ESQUEMA_M||'.USU_USUARIOS WHERE UPPER(USU_NOMBRE) LIKE ''%CARMEN%'' AND UPPER(USU_APELLIDO1) LIKE ''%KUHNEL%''
	UNION ALL
	SELECT ''36'' AS COD_PROVINCIA, USU_ID, USU_USERNAME AS USUARIO_GESTION_ACTIVOS, USU_NOMBRE||'' ''||USU_APELLIDO1||'' ''||USU_APELLIDO2 AS NOMBRE_GESTION_ACTIVOS 
	FROM '||V_ESQUEMA_M||'.USU_USUARIOS WHERE UPPER(USU_NOMBRE) LIKE ''%HECTOR%'' AND UPPER(USU_APELLIDO1) LIKE ''%GIMENEZ%''
	UNION ALL
	SELECT ''37'' AS COD_PROVINCIA, USU_ID, USU_USERNAME AS USUARIO_GESTION_ACTIVOS, USU_NOMBRE||'' ''||USU_APELLIDO1||'' ''||USU_APELLIDO2 AS NOMBRE_GESTION_ACTIVOS 
	FROM '||V_ESQUEMA_M||'.USU_USUARIOS WHERE UPPER(USU_NOMBRE) LIKE ''%HECTOR%'' AND UPPER(USU_APELLIDO1) LIKE ''%GIMENEZ%''
	UNION ALL
	SELECT ''38'' AS COD_PROVINCIA, USU_ID, USU_USERNAME AS USUARIO_GESTION_ACTIVOS, USU_NOMBRE||'' ''||USU_APELLIDO1||'' ''||USU_APELLIDO2 AS NOMBRE_GESTION_ACTIVOS 
	FROM '||V_ESQUEMA_M||'.USU_USUARIOS WHERE UPPER(USU_NOMBRE) LIKE ''%NATALIA%'' AND UPPER(USU_APELLIDO1) LIKE ''%HORCAJO%''
	UNION ALL
	SELECT ''39'' AS COD_PROVINCIA, USU_ID, USU_USERNAME AS USUARIO_GESTION_ACTIVOS, USU_NOMBRE||'' ''||USU_APELLIDO1||'' ''||USU_APELLIDO2 AS NOMBRE_GESTION_ACTIVOS 
	FROM '||V_ESQUEMA_M||'.USU_USUARIOS WHERE UPPER(USU_NOMBRE) LIKE ''%HECTOR%'' AND UPPER(USU_APELLIDO1) LIKE ''%GIMENEZ%''
	UNION ALL
	SELECT ''40'' AS COD_PROVINCIA, USU_ID, USU_USERNAME AS USUARIO_GESTION_ACTIVOS, USU_NOMBRE||'' ''||USU_APELLIDO1||'' ''||USU_APELLIDO2 AS NOMBRE_GESTION_ACTIVOS 
	FROM '||V_ESQUEMA_M||'.USU_USUARIOS WHERE UPPER(USU_NOMBRE) LIKE ''%GABRIELA%'' AND UPPER(USU_APELLIDO1) LIKE ''%MORENO%''
	UNION ALL
	SELECT ''41'' AS COD_PROVINCIA, USU_ID, USU_USERNAME AS USUARIO_GESTION_ACTIVOS, USU_NOMBRE||'' ''||USU_APELLIDO1||'' ''||USU_APELLIDO2 AS NOMBRE_GESTION_ACTIVOS 
	FROM '||V_ESQUEMA_M||'.USU_USUARIOS WHERE UPPER(USU_NOMBRE) LIKE ''%ANTONIO%'' AND UPPER(USU_APELLIDO1) LIKE ''%RUIZ%''
	UNION ALL
	SELECT ''42'' AS COD_PROVINCIA, USU_ID, USU_USERNAME AS USUARIO_GESTION_ACTIVOS, USU_NOMBRE||'' ''||USU_APELLIDO1||'' ''||USU_APELLIDO2 AS NOMBRE_GESTION_ACTIVOS 
	FROM '||V_ESQUEMA_M||'.USU_USUARIOS WHERE UPPER(USU_NOMBRE) LIKE ''%HECTOR%'' AND UPPER(USU_APELLIDO1) LIKE ''%GIMENEZ%''
	UNION ALL
	SELECT ''43'' AS COD_PROVINCIA, USU_ID, USU_USERNAME AS USUARIO_GESTION_ACTIVOS, USU_NOMBRE||'' ''||USU_APELLIDO1||'' ''||USU_APELLIDO2 AS NOMBRE_GESTION_ACTIVOS 
	FROM '||V_ESQUEMA_M||'.USU_USUARIOS WHERE UPPER(USU_NOMBRE) LIKE ''%BELEN%'' AND UPPER(USU_APELLIDO1) LIKE ''%BAVIERA%''
	UNION ALL
	SELECT ''44'' AS COD_PROVINCIA, USU_ID, USU_USERNAME AS USUARIO_GESTION_ACTIVOS, USU_NOMBRE||'' ''||USU_APELLIDO1||'' ''||USU_APELLIDO2 AS NOMBRE_GESTION_ACTIVOS 
	FROM '||V_ESQUEMA_M||'.USU_USUARIOS WHERE UPPER(USU_NOMBRE) LIKE ''%HECTOR%'' AND UPPER(USU_APELLIDO1) LIKE ''%GIMENEZ%''
	UNION ALL
	SELECT ''45'' AS COD_PROVINCIA, USU_ID, USU_USERNAME AS USUARIO_GESTION_ACTIVOS, USU_NOMBRE||'' ''||USU_APELLIDO1||'' ''||USU_APELLIDO2 AS NOMBRE_GESTION_ACTIVOS 
	FROM '||V_ESQUEMA_M||'.USU_USUARIOS WHERE UPPER(USU_NOMBRE) LIKE ''%NATALIA%'' AND UPPER(USU_APELLIDO1) LIKE ''%HORCAJO%''
	UNION ALL
	SELECT ''46'' AS COD_PROVINCIA, USU_ID, USU_USERNAME AS USUARIO_GESTION_ACTIVOS, USU_NOMBRE||'' ''||USU_APELLIDO1||'' ''||USU_APELLIDO2 AS NOMBRE_GESTION_ACTIVOS 
	FROM '||V_ESQUEMA_M||'.USU_USUARIOS WHERE UPPER(USU_NOMBRE) LIKE ''%NURIA%'' AND UPPER(USU_APELLIDO1) LIKE ''%DE LA OSSA%''
	UNION ALL
	SELECT ''47'' AS COD_PROVINCIA, USU_ID, USU_USERNAME AS USUARIO_GESTION_ACTIVOS, USU_NOMBRE||'' ''||USU_APELLIDO1||'' ''||USU_APELLIDO2 AS NOMBRE_GESTION_ACTIVOS 
	FROM '||V_ESQUEMA_M||'.USU_USUARIOS WHERE UPPER(USU_NOMBRE) LIKE ''%HECTOR%'' AND UPPER(USU_APELLIDO1) LIKE ''%GIMENEZ%''
	UNION ALL
	SELECT ''48'' AS COD_PROVINCIA, USU_ID, USU_USERNAME AS USUARIO_GESTION_ACTIVOS, USU_NOMBRE||'' ''||USU_APELLIDO1||'' ''||USU_APELLIDO2 AS NOMBRE_GESTION_ACTIVOS 
	FROM '||V_ESQUEMA_M||'.USU_USUARIOS WHERE UPPER(USU_NOMBRE) LIKE ''%HECTOR%'' AND UPPER(USU_APELLIDO1) LIKE ''%GIMENEZ%''
	UNION ALL
	SELECT ''49'' AS COD_PROVINCIA, USU_ID, USU_USERNAME AS USUARIO_GESTION_ACTIVOS, USU_NOMBRE||'' ''||USU_APELLIDO1||'' ''||USU_APELLIDO2 AS NOMBRE_GESTION_ACTIVOS 
	FROM '||V_ESQUEMA_M||'.USU_USUARIOS WHERE UPPER(USU_NOMBRE) LIKE ''%HECTOR%'' AND UPPER(USU_APELLIDO1) LIKE ''%GIMENEZ%''
	UNION ALL
	SELECT ''50'' AS COD_PROVINCIA, USU_ID, USU_USERNAME AS USUARIO_GESTION_ACTIVOS, USU_NOMBRE||'' ''||USU_APELLIDO1||'' ''||USU_APELLIDO2 AS NOMBRE_GESTION_ACTIVOS 
	FROM '||V_ESQUEMA_M||'.USU_USUARIOS WHERE UPPER(USU_NOMBRE) LIKE ''%HECTOR%'' AND UPPER(USU_APELLIDO1) LIKE ''%GIMENEZ%''
	UNION ALL
	SELECT ''51'' AS COD_PROVINCIA, USU_ID, USU_USERNAME AS USUARIO_GESTION_ACTIVOS, USU_NOMBRE||'' ''||USU_APELLIDO1||'' ''||USU_APELLIDO2 AS NOMBRE_GESTION_ACTIVOS 
	FROM '||V_ESQUEMA_M||'.USU_USUARIOS WHERE UPPER(USU_NOMBRE) LIKE ''%NATALIA%'' AND UPPER(USU_APELLIDO1) LIKE ''%HORCAJO%''
	UNION ALL
	SELECT ''52'' AS COD_PROVINCIA, USU_ID, USU_USERNAME AS USUARIO_GESTION_ACTIVOS, USU_NOMBRE||'' ''||USU_APELLIDO1||'' ''||USU_APELLIDO2 AS NOMBRE_GESTION_ACTIVOS 
	FROM '||V_ESQUEMA_M||'.USU_USUARIOS WHERE UPPER(USU_NOMBRE) LIKE ''%NATALIA%'' AND UPPER(USU_APELLIDO1) LIKE ''%HORCAJO%''

	)
	'
	;
	
	V_MSQL := '
	SELECT COUNT(1) FROM ALL_TABLES WHERE TABLE_NAME = ''TMP_GESTORES_PROVINCIAS'' AND OWNER = '''||V_ESQUEMA||'''
	'
	;
	EXECUTE IMMEDIATE V_MSQL INTO V_NUM;
	
	IF V_NUM != 0 THEN
	
		DBMS_OUTPUT.PUT_LINE('[INFO] TABLA TMP_GESTORES_PROVINCIAS CREADA.');
		
	ELSE
	
		DBMS_OUTPUT.PUT_LINE('[INFO] NO SE HA CREADO LA TABLA TMP_GESTORES_PROVINCIAS.');
		
	END IF;
	
	COMMIT;

         
EXCEPTION

   WHEN OTHERS THEN
   
        err_num := SQLCODE;
        err_msg := SQLERRM;

        DBMS_OUTPUT.put_line('[ERROR] Se ha producido un error en la ejecución:'||TO_CHAR(err_num));
        DBMS_OUTPUT.put_line('-----------------------------------------------------------'); 
        DBMS_OUTPUT.put_line(err_msg);

        ROLLBACK;
        RAISE;          

END;
/

EXIT
