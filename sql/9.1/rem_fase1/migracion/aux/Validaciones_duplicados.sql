----------------
--VALIDACIONES-- --JUSTO DESPUES DE CARGAR TABLAS MIG
----------------

--MIG_ACA_CABECERA

--ACT_NUMERO_ACTIVO DUPLICADOS

SELECT ACT_NUMERO_ACTIVO, COUNT(1) FROM MIG_ACA_CABECERA GROUP BY ACT_NUMERO_ACTIVO HAVING COUNT(ACT_NUMERO_ACTIVO) > 1;

SELECT * FROM MIG_ACA_CABECERA WHERE ACT_NUMERO_ACTIVO IN (
  SELECT ACT_NUMERO_ACTIVO FROM (
    SELECT ACT_NUMERO_ACTIVO, COUNT(1) FROM MIG_ACA_CABECERA GROUP BY ACT_NUMERO_ACTIVO HAVING COUNT(ACT_NUMERO_ACTIVO) > 1
    )
  )
;

--MIG_ATI_TITULO

--ACT_NUMERO_ACTIVO DUPLICADOS

SELECT ACT_NUMERO_ACTIVO, COUNT(1) FROM MIG_ATI_TITULO GROUP BY ACT_NUMERO_ACTIVO HAVING COUNT(ACT_NUMERO_ACTIVO) > 1;

SELECT * FROM MIG_ATI_TITULO WHERE ACT_NUMERO_ACTIVO IN (
  SELECT ACT_NUMERO_ACTIVO FROM (
    SELECT ACT_NUMERO_ACTIVO, COUNT(1) FROM MIG_ATI_TITULO GROUP BY ACT_NUMERO_ACTIVO HAVING COUNT(ACT_NUMERO_ACTIVO) > 1
    )
  )
;

--MIG_ADA_DATOS_ADI

--ACT_NUMERO_ACTIVO DUPLICADOS

SELECT ACT_NUMERO_ACTIVO, COUNT(1) FROM MIG_ADA_DATOS_ADI GROUP BY ACT_NUMERO_ACTIVO HAVING COUNT(ACT_NUMERO_ACTIVO) > 1;

SELECT * FROM MIG_ADA_DATOS_ADI WHERE ACT_NUMERO_ACTIVO IN (
  SELECT ACT_NUMERO_ACTIVO FROM (
    SELECT ACT_NUMERO_ACTIVO, COUNT(1) FROM MIG_ADA_DATOS_ADI GROUP BY ACT_NUMERO_ACTIVO HAVING COUNT(ACT_NUMERO_ACTIVO) > 1
    )
  )
;

--MIG_APL_PLANDINVENTAS

--ACT_NUMERO_ACTIVO DUPLICADOS

SELECT ACT_NUMERO_ACTIVO, COUNT(1) FROM MIG_APL_PLANDINVENTAS GROUP BY ACT_NUMERO_ACTIVO HAVING COUNT(ACT_NUMERO_ACTIVO) > 1;

SELECT * FROM MIG_APL_PLANDINVENTAS WHERE ACT_NUMERO_ACTIVO IN (
  SELECT ACT_NUMERO_ACTIVO FROM (
    SELECT ACT_NUMERO_ACTIVO, COUNT(1) FROM MIG_APL_PLANDINVENTAS GROUP BY ACT_NUMERO_ACTIVO HAVING COUNT(ACT_NUMERO_ACTIVO) > 1
    )
  )
;

--MIG_ADJ_JUDICIAL

--ACT_NUMERO_ACTIVO DUPLICADOS

SELECT ACT_NUMERO_ACTIVO, COUNT(1) FROM MIG_ADJ_JUDICIAL GROUP BY ACT_NUMERO_ACTIVO HAVING COUNT(ACT_NUMERO_ACTIVO) > 1;

SELECT * FROM MIG_ADJ_JUDICIAL WHERE ACT_NUMERO_ACTIVO IN (
  SELECT ACT_NUMERO_ACTIVO FROM (
    SELECT ACT_NUMERO_ACTIVO, COUNT(1) FROM MIG_ADJ_JUDICIAL GROUP BY ACT_NUMERO_ACTIVO HAVING COUNT(ACT_NUMERO_ACTIVO) > 1
    )
  )
;

--MIG_ADJ_NO_JUDICIAL

--ACT_NUMERO_ACTIVO DUPLICADOS

SELECT ACT_NUMERO_ACTIVO, COUNT(1) FROM MIG_ADJ_NO_JUDICIAL GROUP BY ACT_NUMERO_ACTIVO HAVING COUNT(ACT_NUMERO_ACTIVO) > 1;

SELECT * FROM MIG_ADJ_NO_JUDICIAL WHERE ACT_NUMERO_ACTIVO IN (
  SELECT ACT_NUMERO_ACTIVO FROM (
    SELECT ACT_NUMERO_ACTIVO, COUNT(1) FROM MIG_ADJ_NO_JUDICIAL GROUP BY ACT_NUMERO_ACTIVO HAVING COUNT(ACT_NUMERO_ACTIVO) > 1
    )
  )
;

--MIG_AAG_AGRUPACIONES

--AGR_UVEM DUPLICADOS

SELECT AGR_UVEM, COUNT(1) FROM MIG_AAG_AGRUPACIONES GROUP BY AGR_UVEM HAVING COUNT(AGR_UVEM) > 1;

SELECT * FROM MIG_AAG_AGRUPACIONES WHERE AGR_UVEM IN (
  SELECT AGR_UVEM FROM (
    SELECT AGR_UVEM, COUNT(1) FROM MIG_AAG_AGRUPACIONES GROUP BY AGR_UVEM HAVING COUNT(AGR_UVEM) > 1
    )
  )
;

--MIG_ACA_CALIDADES_ACTIVO

--ACT_NUMERO_ACTIVO DUPLICADOS

SELECT ACT_NUMERO_ACTIVO, COUNT(1) FROM MIG_ACA_CALIDADES_ACTIVO GROUP BY ACT_NUMERO_ACTIVO HAVING COUNT(ACT_NUMERO_ACTIVO) > 1;

SELECT * FROM MIG_ACA_CALIDADES_ACTIVO WHERE ACT_NUMERO_ACTIVO IN (
  SELECT ACT_NUMERO_ACTIVO FROM (
    SELECT ACT_NUMERO_ACTIVO, COUNT(1) FROM MIG_ACA_CALIDADES_ACTIVO GROUP BY ACT_NUMERO_ACTIVO HAVING COUNT(ACT_NUMERO_ACTIVO) > 1
    )
  )
;

--MIG_AIA_INFOCOMERCIAL_ACTIVO

--ACT_NUMERO_ACTIVO DUPLICADOS

SELECT ACT_NUMERO_ACTIVO, COUNT(1) FROM MIG_AIA_INFOCOMERCIAL_ACTIVO GROUP BY ACT_NUMERO_ACTIVO HAVING COUNT(ACT_NUMERO_ACTIVO) > 1;

SELECT * FROM MIG_AIA_INFOCOMERCIAL_ACTIVO WHERE ACT_NUMERO_ACTIVO IN (
  SELECT ACT_NUMERO_ACTIVO FROM (
    SELECT ACT_NUMERO_ACTIVO, COUNT(1) FROM MIG_AIA_INFOCOMERCIAL_ACTIVO GROUP BY ACT_NUMERO_ACTIVO HAVING COUNT(ACT_NUMERO_ACTIVO) > 1
    )
  )
;

--MIG_ALA_LLAVES_ACTIVO

--ACT_NUMERO_ACTIVO DUPLICADOS

SELECT ACT_NUMERO_ACTIVO, COUNT(1) FROM MIG_ALA_LLAVES_ACTIVO GROUP BY ACT_NUMERO_ACTIVO HAVING COUNT(ACT_NUMERO_ACTIVO) > 1;

SELECT * FROM MIG_ALA_LLAVES_ACTIVO WHERE ACT_NUMERO_ACTIVO IN (
  SELECT ACT_NUMERO_ACTIVO FROM (
    SELECT ACT_NUMERO_ACTIVO, COUNT(1) FROM MIG_ALA_LLAVES_ACTIVO GROUP BY ACT_NUMERO_ACTIVO HAVING COUNT(ACT_NUMERO_ACTIVO) > 1
    )
  )
;

--MIG_APA_PROP_ACTIVO

--ACT_NUMERO_ACTIVO DUPLICADOS

SELECT ACT_NUMERO_ACTIVO, COUNT(1) FROM MIG_APA_PROP_ACTIVO GROUP BY ACT_NUMERO_ACTIVO HAVING COUNT(ACT_NUMERO_ACTIVO) > 1;

SELECT * FROM MIG_APA_PROP_ACTIVO WHERE ACT_NUMERO_ACTIVO IN (
  SELECT ACT_NUMERO_ACTIVO FROM (
    SELECT ACT_NUMERO_ACTIVO, COUNT(1) FROM MIG_APA_PROP_ACTIVO GROUP BY ACT_NUMERO_ACTIVO HAVING COUNT(ACT_NUMERO_ACTIVO) > 1
    )
  )
;

--MIG_APC_PROP_CABECERA

--PRO_CODIGO_UVEM DUPLICADOS

SELECT PRO_CODIGO_UVEM, COUNT(1) FROM MIG_APC_PROP_CABECERA GROUP BY PRO_CODIGO_UVEM HAVING COUNT(PRO_CODIGO_UVEM) > 1;

SELECT * FROM MIG_APC_PRECIO WHERE PRO_CODIGO_UVEM IN (
  SELECT MIG_APC_PROP_CABECERA FROM (
    SELECT PRO_CODIGO_UVEM, COUNT(1) FROM MIG_APC_PROP_CABECERA GROUP BY PRO_CODIGO_UVEM HAVING COUNT(PRO_CODIGO_UVEM) > 1
    )
  )
;

--MIG_APR_PROVEEDORES

--PVE_COD_UVEM DUPLICADOS

SELECT PVE_COD_UVEM, COUNT(1) FROM MIG_APR_PROVEEDORES GROUP BY PVE_COD_UVEM HAVING COUNT(PVE_COD_UVEM) > 1;

SELECT * FROM MIG_APC_PRECIO WHERE PVE_COD_UVEM IN (
  SELECT MIG_APR_PROVEEDORES FROM (
    SELECT PVE_COD_UVEM, COUNT(1) FROM MIG_APR_PROVEEDORES GROUP BY PVE_COD_UVEM HAVING COUNT(PVE_COD_UVEM) > 1
    )
  )
;

--MIG_ASA_SUBDIVISIONES_AGRUP

--AGR_UVEM-SDV_COD_UVEM DUPLICADOS

SELECT AGR_UVEM||SDV_COD_UVEM||TIPO_SUBDIVISION UNICO, COUNT(1) FROM MIG_ASA_SUBDIVISIONES_AGRUP GROUP BY AGR_UVEM||SDV_COD_UVEM||TIPO_SUBDIVISION HAVING COUNT(AGR_UVEM||SDV_COD_UVEM||TIPO_SUBDIVISION) > 1;

SELECT * FROM MIG_ASA_SUBDIVISIONES_AGRUP WHERE PVE_COD_UVEM IN (
  SELECT MIG_ASA_SUBDIVISIONES_AGRUP FROM (
    SELECT AGR_UVEM||SDV_COD_UVEM||TIPO_SUBDIVISION UNICO, COUNT(1) FROM MIG_ASA_SUBDIVISIONES_AGRUP GROUP BY AGR_UVEM||SDV_COD_UVEM||TIPO_SUBDIVISION HAVING COUNT(AGR_UVEM||SDV_COD_UVEM||TIPO_SUBDIVISION) > 1
    )
  )
;

--MIG_ATA_TASACIONES_ACTIVO

--ACT_NUMERO_ACTIVO-TAS_CODIGO_TASA_UVEM DUPLICADOS

SELECT ACT_NUMERO_ACTIVO||TAS_CODIGO_TASA_UVEM, COUNT(1) FROM MIG_ATA_TASACIONES_ACTIVO GROUP BY ACT_NUMERO_ACTIVO||TAS_CODIGO_TASA_UVEM HAVING COUNT(ACT_NUMERO_ACTIVO||TAS_CODIGO_TASA_UVEM) > 1;

SELECT * FROM MIG_ATA_TASACIONES_ACTIVO WHERE PVE_COD_UVEM IN (
  SELECT ACT_NUMERO_ACTIVO||TAS_CODIGO_TASA_UVEM FROM (
    SELECT ACT_NUMERO_ACTIVO||TAS_CODIGO_TASA_UVEM, COUNT(1) FROM MIG_ATA_TASACIONES_ACTIVO GROUP BY ACT_NUMERO_ACTIVO||TAS_CODIGO_TASA_UVEM HAVING COUNT(ACT_NUMERO_ACTIVO||TAS_CODIGO_TASA_UVEM) > 1
    )
  )
;

--MIG_CPC_PROP_CABECERA

--CPR_COD_COM_PROP_UVEM DUPLICADOS

SELECT CPR_COD_COM_PROP_UVEM, COUNT(1) FROM MIG_CPC_PROP_CABECERA GROUP BY CPR_COD_COM_PROP_UVEM HAVING COUNT(CPR_COD_COM_PROP_UVEM) > 1;

SELECT * FROM MIG_CPC_PROP_CABECERA WHERE CPR_COD_COM_PROP_UVEM IN (
  SELECT CPR_COD_COM_PROP_UVEM FROM (
    SELECT CPR_COD_COM_PROP_UVEM, COUNT(1) FROM MIG_CPC_PROP_CABECERA GROUP BY CPR_COD_COM_PROP_UVEM HAVING COUNT(CPR_COD_COM_PROP_UVEM) > 1
    )
  )
;

--MIG_CPC_PROP_CUOTAS

--CPR_COD_COM_PROP_UVEM DUPLICADOS

SELECT CCP_COD_CUOTA_UVEM, COUNT(1) FROM MIG_CPC_PROP_CUOTAS GROUP BY CCP_COD_CUOTA_UVEM HAVING COUNT(CCP_COD_CUOTA_UVEM) > 1;

SELECT * FROM MIG_CPC_PROP_CUOTAS WHERE CCP_COD_CUOTA_UVEM IN (
  SELECT CCP_COD_CUOTA_UVEM FROM (
    SELECT CCP_COD_CUOTA_UVEM, COUNT(1) FROM MIG_CPC_PROP_CUOTAS GROUP BY CCP_COD_CUOTA_UVEM HAVING COUNT(CCP_COD_CUOTA_UVEM) > 1
    )
  )
;
