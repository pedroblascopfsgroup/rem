############################################
### VALIDACIÓNES DE DATOS PARA MIGRACIÓN ###
############################################

	-------- INFORME VALORES DICCIONARIOS INCORRECTOS ---------
	
	SELECT DECODE(COUNT(DISTINCT VALOR),0,1,COUNT(DISTINCT VALOR)) CODIGOS_INCORRECTOS, COUNT(CLAVE) TOTAL_INCORRECTOS, CAMPO_ORIGEN, DICCIONARIO, FICHERO_ORIGEN 
	FROM DD_COD_NOT_EXISTS 
	GROUP BY CAMPO_ORIGEN, DICCIONARIO, FICHERO_ORIGEN 
	ORDER BY CODIGOS_INCORRECTOS DESC;


	-------- RECUENTO DE ACTIVOS SIN INFOCOMERCIAL_ACTIVO ---------
	
	SELECT COUNT (ACT.ACT_NUM_ACTIVO) ACTIVOS_SIN_ICO FROM ACT_ACTIVO ACT
	WHERE NOT EXISTS(
	SELECT 1 FROM MIG_AIA_INFOCOMERCIAL_ACTIVO MIG
	WHERE ACT.ACT_NUM_ACTIVO = MIG.ACT_NUMERO_ACTIVO);


  -------- RECUENTO DE PROPIETARIOS-ACTIVO SIN INFORMAR TIPO GRADO PROPIEDAD PERO CON VALOR EN PORCENTAGE DE PROPIEDAD ---------

	SELECT COUNT(1) FROM ACT_PAC_PROPIETARIO_ACTIVO
	WHERE DD_TGP_ID IS NULL
	AND PAC_PORC_PROPIEDAD != 0;


  -------- ACTIVOS CON ENTIDAD PROPIETARIA UVEM QUE NO TRAEN INFORMADO ACTIVO NUMERO UVEM ---------

	SELECT COUNT(1) FROM ACT_ACTIVO
	WHERE DD_CRA_ID = (SELECT DD_CRA_ID FROM DD_CRA_CARTERA WHERE DD_CRA_CODIGO LIKE '02')
	AND ACT_NUM_ACTIVO_UVEM IS NULL;


  -------- ACTIVOS INFORMADOS EN ADJUDICACION JUDICIAL + NO JUDICIAL SEA IGUAL QUE EL TOTAL DE ACTIVOS ---------

	WITH UNO AS (
		SELECT COUNT(ACT_NUMERO_ACTIVO) COUNTER
		FROM MIG_ADJ_JUDICIAL
	),
	DOS AS (
		SELECT COUNT(ACT_NUMERO_ACTIVO) COUNTER
		FROM MIG_ADJ_NO_JUDICIAL
	)
	SELECT UNO.COUNTER+DOS.COUNTER FROM UNO JOIN DOS ON 1=1
	;
	
	SELECT COUNT(ACT_NUMERO_ACTIVO)
	FROM MIG_ACA_CABECERA;
