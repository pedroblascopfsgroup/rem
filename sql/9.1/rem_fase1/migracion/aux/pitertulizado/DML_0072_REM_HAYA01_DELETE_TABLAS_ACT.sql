--/*
--#########################################
--## AUTOR=David González
--## FECHA_CREACION=20160304
--## ARTEFACTO=batch
--## VERSION_ARTEFACTO=0.1
--## INCIDENCIA_LINK=HREOS-166
--## PRODUCTO=NO
--## 
--## Finalidad: Borrar el contenido de las tablas afectadas por la migración en REM, también se borran sus registros de la RSR_REGISTRO_SQLS
--##			
--## INSTRUCCIONES:  
--## VERSIONES:
--##        0.1 Versión inicial
--#########################################
--*/

--Para permitir la visualización de texto en un bloque PL/SQL utilizando DBMS_OUTPUT.PUT_LINE

WHENEVER SQLERROR EXIT SQL.SQLCODE;
SET SERVEROUTPUT ON;
SET DEFINE OFF;

DECLARE

V_ESQUEMA VARCHAR2(10 CHAR) := '#ESQUEMA#';
V_ESQUEMA_MASTER VARCHAR2(15 CHAR) := '#ESQUEMA_MASTER#';

BEGIN

EXECUTE IMMEDIATE 'delete from '||V_ESQUEMA||'.GAH_GESTOR_ACTIVO_HISTORICO';
EXECUTE IMMEDIATE 'delete from '||V_ESQUEMA||'.GAC_GESTOR_ADD_ACTIVO';
EXECUTE IMMEDIATE 'delete from '||V_ESQUEMA||'.GEE_GESTOR_ENTIDAD';
EXECUTE IMMEDIATE 'delete from '||V_ESQUEMA||'.GEH_GESTOR_ENTIDAD_HIST';
EXECUTE IMMEDIATE 'delete from '||V_ESQUEMA||'.TAC_TAREAS_ACTIVOS';
EXECUTE IMMEDIATE 'delete from '||V_ESQUEMA||'.ACT_AOB_ACTIVO_OBS';
EXECUTE IMMEDIATE 'delete from '||V_ESQUEMA||'.ACT_ADO_ADMISION_DOCUMENTO';
commit;
EXECUTE IMMEDIATE 'delete from '||V_ESQUEMA||'.ACT_INP_INC_PRESUPUESTO';
EXECUTE IMMEDIATE 'delete from '||V_ESQUEMA||'.ACT_PTO_PRESUPUESTO';
EXECUTE IMMEDIATE 'delete from '||V_ESQUEMA||'.ACT_TBJ';
EXECUTE IMMEDIATE 'delete from '||V_ESQUEMA||'.ACT_ADT_ADJUNTO_TRABAJO';
commit;
EXECUTE IMMEDIATE 'delete from '||V_ESQUEMA||'.ACT_TBO_TRABAJO_OBS';
EXECUTE IMMEDIATE 'delete from '||V_ESQUEMA||'.ACT_RPV_RECARGOS_PROVEEDOR';
EXECUTE IMMEDIATE 'delete from '||V_ESQUEMA||'.ACT_TCT_TRABAJO_CFGTARIFA';
EXECUTE IMMEDIATE 'delete from '||V_ESQUEMA||'.ACT_PRT_PRESUPUESTO_TRABAJO';
EXECUTE IMMEDIATE 'delete from '||V_ESQUEMA||'.ACT_TBJ_TRABAJO';
commit;
EXECUTE IMMEDIATE 'delete from '||V_ESQUEMA||'.ACT_TRA_TRAMITE';
--EXECUTE IMMEDIATE 'delete from '||V_ESQUEMA||'.ACT_GES_DISTRIBUCION';
EXECUTE IMMEDIATE 'delete from '||V_ESQUEMA||'.ACT_ETP_ENTIDAD_PROVEEDOR';
commit;
EXECUTE IMMEDIATE 'delete from '||V_ESQUEMA||'.ACT_PVC_PROVEEDOR_CONTACTO WHERE USUARIOCREAR=''MIG''';
EXECUTE IMMEDIATE 'delete from '||V_ESQUEMA||'.ACT_PVE_PROVEEDOR WHERE USUARIOCREAR=''MIG''';
EXECUTE IMMEDIATE 'delete from '||V_ESQUEMA||'.ACT_TAS_TASACION';
EXECUTE IMMEDIATE 'delete from '||V_ESQUEMA||'.ACT_CRG_CARGAS';
EXECUTE IMMEDIATE 'delete from '||V_ESQUEMA||'.ACT_ADA_ADJUNTO_ACTIVO';
EXECUTE IMMEDIATE 'delete from '||V_ESQUEMA||'.ACT_TIT_TITULO';
EXECUTE IMMEDIATE 'delete from '||V_ESQUEMA||'.ACT_PDV_PLAN_DIN_VENTAS';
commit;
EXECUTE IMMEDIATE 'delete from '||V_ESQUEMA||'.ACT_AJD_ADJJUDICIAL';
EXECUTE IMMEDIATE 'delete from '||V_ESQUEMA||'.ACT_ADN_ADJNOJUDICIAL';
EXECUTE IMMEDIATE 'delete from '||V_ESQUEMA||'.ACT_ADM_INF_ADMINISTRATIVA';
EXECUTE IMMEDIATE 'delete from '||V_ESQUEMA||'.ACT_SPS_SIT_POSESORIA';
EXECUTE IMMEDIATE 'delete from '||V_ESQUEMA||'.ACT_REG_INFO_REGISTRAL';
commit;
EXECUTE IMMEDIATE 'delete from '||V_ESQUEMA||'.ACT_LOC_LOCALIZACION';
EXECUTE IMMEDIATE 'delete from '||V_ESQUEMA||'.ACT_CPR_COM_PROPIETARIOS';
EXECUTE IMMEDIATE 'delete from '||V_ESQUEMA||'.ACT_MLV_MOVIMIENTO_LLAVE';
EXECUTE IMMEDIATE 'delete from '||V_ESQUEMA||'.ACT_PAC_PROPIETARIO_ACTIVO';
EXECUTE IMMEDIATE 'delete from '||V_ESQUEMA||'.ACT_PRO_PROPIETARIO';
commit;
EXECUTE IMMEDIATE 'delete from '||V_ESQUEMA||'.ACT_SDV_SUBDIVISION_ACTIVO';
EXECUTE IMMEDIATE 'delete from '||V_ESQUEMA||'.ACT_CAT_CATASTRO';
EXECUTE IMMEDIATE 'delete from '||V_ESQUEMA||'.ACT_LLV_LLAVE';
EXECUTE IMMEDIATE 'delete from '||V_ESQUEMA||'.ACT_VAL_VALORACIONES';
EXECUTE IMMEDIATE 'delete from '||V_ESQUEMA||'.ACT_EDI_EDIFICIO';
commit;
EXECUTE IMMEDIATE 'delete from '||V_ESQUEMA||'.ACT_LCO_LOCAL_COMERCIAL';
EXECUTE IMMEDIATE 'delete from '||V_ESQUEMA||'.ACT_APR_PLAZA_APARCAMIENTO';
EXECUTE IMMEDIATE 'delete from '||V_ESQUEMA||'.ACT_CRI_CARPINTERIA_INT';
EXECUTE IMMEDIATE 'delete from '||V_ESQUEMA||'.ACT_CRE_CARPINTERIA_EXT';
EXECUTE IMMEDIATE 'delete from '||V_ESQUEMA||'.ACT_PRV_PARAMENTO_VERTICAL';
commit;
EXECUTE IMMEDIATE 'delete from '||V_ESQUEMA||'.ACT_SOL_SOLADO';
EXECUTE IMMEDIATE 'delete from '||V_ESQUEMA||'.ACT_INF_INFRAESTRUCTURA';
EXECUTE IMMEDIATE 'delete from '||V_ESQUEMA||'.ACT_ZCO_ZONA_COMUN';
EXECUTE IMMEDIATE 'delete from '||V_ESQUEMA||'.ACT_INS_INSTALACION';
EXECUTE IMMEDIATE 'delete from '||V_ESQUEMA||'.ACT_BNY_BANYO';
commit;
EXECUTE IMMEDIATE 'delete from '||V_ESQUEMA||'.ACT_COC_COCINA';
EXECUTE IMMEDIATE 'delete from '||V_ESQUEMA||'.ACT_DIS_DISTRIBUCION';
EXECUTE IMMEDIATE 'delete from '||V_ESQUEMA||'.ACT_AGO_AGRUPACION_OBS';
EXECUTE IMMEDIATE 'delete from '||V_ESQUEMA||'.ACT_AGA_AGRUPACION_ACTIVO';
EXECUTE IMMEDIATE 'delete from '||V_ESQUEMA||'.ACT_ONV_OBRA_NUEVA';
EXECUTE IMMEDIATE 'delete from '||V_ESQUEMA||'.ACT_AAH_AGRUP_ACTIVO_HIST';
commit;
EXECUTE IMMEDIATE 'delete from '||V_ESQUEMA||'.ACT_RES_RESTRINGIDA';
EXECUTE IMMEDIATE 'delete from '||V_ESQUEMA||'.ACT_AGR_AGRUPACION';
EXECUTE IMMEDIATE 'delete from '||V_ESQUEMA||'.ACT_VIV_VIVIENDA';
EXECUTE IMMEDIATE 'delete from '||V_ESQUEMA||'.ACT_ICO_INFO_COMERCIAL';
commit;
EXECUTE IMMEDIATE 'delete from '||V_ESQUEMA||'.ACT_ACTIVO';
commit;


EXECUTE IMMEDIATE 'delete from '||V_ESQUEMA||'.bie_car_cargas';
commit;

EXECUTE IMMEDIATE 'delete from '||V_ESQUEMA||'.bie_adicional';
commit;

EXECUTE IMMEDIATE 'delete from '||V_ESQUEMA||'.bie_adj_adjudicacion';
commit;

EXECUTE IMMEDIATE 'delete from '||V_ESQUEMA||'.bie_anc_analisis_contratos';
commit;

EXECUTE IMMEDIATE 'delete from '||V_ESQUEMA||'.bie_bien_entidad';
commit;

EXECUTE IMMEDIATE 'delete from '||V_ESQUEMA||'.bie_datos_registrales';
commit;

EXECUTE IMMEDIATE 'delete from '||V_ESQUEMA||'.bie_localizacion';
commit;

EXECUTE IMMEDIATE 'delete from '||V_ESQUEMA||'.bie_sui_subasta_instrucciones';
commit;

EXECUTE IMMEDIATE 'delete from '||V_ESQUEMA||'.bie_valoraciones';
commit;

EXECUTE IMMEDIATE 'delete from '||V_ESQUEMA||'.lob_lote_bien';
EXECUTE IMMEDIATE 'delete from '||V_ESQUEMA||'.emp_nmbembargos_procedimientos';
commit;

EXECUTE IMMEDIATE 'delete from '||V_ESQUEMA||'.bie_bien';
commit;

EXECUTE IMMEDIATE 
'delete from '||V_ESQUEMA||'.RSR_REGISTRO_SQLS 
WHERE RSR_INCIDENCIA_LINK IN (''HREOS-67B'',''HREOS-166'')
OR RSR_NOMBRE_SCRIPT IN (
''DDL_0078_REM_HAYA01_SP_AGA_ASIGNA_GESTOR_ACTIVO.sql'',
''DDL_0077_REM_HAYA01_GES_DISTRIBUCION.sql'',
''DDL_0076_REM_HAYA01_INFO_TABLE.sql'',
''DDL_0075_REM_HAYA01_RESET_SEQUENCES.sql'',
''DDL_0074_REM_HAYA01_TBJ_NOT_EXISTS.sql'',
''DDL_0073_REM_HAYA01_PVE_NOT_EXISTS.sql'',
''DDL_0072_REM_HAYA01_AGR_NOT_EXISTS.sql'',
''DDL_0071_REM_HAYA01_PRO_NOT_EXISTS.sql'',
''DDL_0070_REM_HAYA01_CPR_NOT_EXISTS.sql'',
''DDL_0069_REM_HAYA01_ACT_NOT_EXISTS.sql'',
''DDL_0068_REM_HAYA01_DD_COD_NOT_EXISTS.sql'',
''DML_0072_REM_HAYA01_INSERT_GES_DISTRIBUCION.sql'',
''DML_0071_REM_HAYA01_INSERT_DD_TVP_05.sql''
)
';
commit;

 EXCEPTION

    WHEN OTHERS THEN
        DBMS_OUTPUT.put_line('[ERROR] Se ha producido un error en la ejecucion:'||TO_CHAR(SQLCODE));
        DBMS_OUTPUT.put_line('-----------------------------------------------------------');
        DBMS_OUTPUT.put_line(SQLERRM);
        ROLLBACK;
        RAISE;
END;
/

EXIT;

