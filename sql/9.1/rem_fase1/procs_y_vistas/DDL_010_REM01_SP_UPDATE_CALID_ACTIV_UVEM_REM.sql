--/*
--##########################################
--## AUTOR=JAVIER DIAZ
--## FECHA_CREACION=20160627
--## ARTEFACTO=online
--## VERSION_ARTEFACTO=9.1
--## INCIDENCIA_LINK=0
--## PRODUCTO=NO
--## Finalidad: Procedimiento que actualiza información de los activos a partir de un fichero proveniente de UVEM- 
--##			tabla APR_AUX_DATOS_ACTIVO, con datos procedentes de UVEM. CALIDADES-ACTIVOS
--##           
--## INSTRUCCIONES: Configurar las variables necesarias en el principio del DECLARE
--## VERSIONES:
--##        0.1 Versión inicial
--##########################################
--*/

--Para permitir la visualización de texto en un bloque PL/SQL utilizando DBMS_OUTPUT.PUT_LINE

WHENEVER SQLERROR EXIT SQL.SQLCODE;
SET SERVEROUTPUT ON; 
SET DEFINE OFF;

create or replace PROCEDURE SP_UPDATE_CALID_ACTIV_UVEM_REM (P_TEXTO OUT VARCHAR2,
P_CRI_NEW OUT VARCHAR2,
P_CRI_MODIF OUT VARCHAR2,
P_CRE_NEW OUT VARCHAR2,
P_CRE_MODIF OUT VARCHAR2,
P_PRV_NEW OUT VARCHAR2,
P_PRV_MODIF OUT VARCHAR2,
P_SOL_NEW OUT VARCHAR2,
P_SOL_MODIF OUT VARCHAR2,
P_INF_NEW OUT VARCHAR2,
P_INF_MODIF OUT VARCHAR2,
P_ZCO_NEW OUT VARCHAR2,
P_ZCO_MODIF OUT VARCHAR2,
P_INS_NEW OUT VARCHAR2,
P_INS_MODIF OUT VARCHAR2,
P_BNY_NEW OUT VARCHAR2,
P_BNY_MODIF OUT VARCHAR2,
P_COC_NEW OUT VARCHAR2,
P_COC_MODIF OUT VARCHAR2

) AS
--V0.1 Versión  hito : 1.0.8-rem

V_ESQUEMA VARCHAR2(15 CHAR) := '#ESQUEMA#';
V_ESQUEMA_MASTER VARCHAR2(15 CHAR) := '#ESQUEMA_MASTER#';
 err_num NUMBER;
 err_msg VARCHAR2(2048);
 
   MODIF_CRI NUMBER(10,0) := 0;
   NEW_CRI NUMBER(10,0) := 0;
   MODIF_CRE NUMBER(10,0) := 0;
   NEW_CRE NUMBER(10,0) := 0;
   MODIF_PRV NUMBER(10,0) := 0;
   NEW_PRV NUMBER(10,0) := 0;
   MODIF_SOL NUMBER(10,0) := 0;
   NEW_SOL NUMBER(10,0) := 0;
   MODIF_INF NUMBER(10,0) := 0;
   NEW_INF  NUMBER(10,0) := 0;
   MODIF_ZCO NUMBER(10,0) := 0;
   NEW_ZCO NUMBER(10,0) := 0;
   MODIF_INS NUMBER(10,0) := 0;
   NEW_INS NUMBER(10,0) := 0;
   MODIF_BNY NUMBER(10,0) := 0;
   NEW_BNY NUMBER(10,0) := 0;
   MODIF_COC NUMBER(10,0) := 0;
   NEW_COC NUMBER(10,0) := 0;

   R_CRI NUMBER(10,0) := 0;
   R_CRE NUMBER(10,0) := 0;
   R_PRV NUMBER(10,0) := 0;
   R_SOL NUMBER(10,0) := 0;
   R_INF NUMBER(10,0) := 0;
   R_ZCO NUMBER(10,0) := 0;
   R_INS NUMBER(10,0) := 0;
   R_BNY NUMBER(10,0) := 0;
   R_COC NUMBER(10,0) := 0;
 
   CAL_ROWID ROWID;

      V_MSQL_CRI VARCHAR2(8500 CHAR);
      V_MSQL_CRE VARCHAR2(8500 CHAR);
      V_MSQL_PRV VARCHAR2(8500 CHAR);
      V_MSQL_SOL VARCHAR2(8500 CHAR);
      V_MSQL_INF VARCHAR2(8500 CHAR);
      V_MSQL_ZCO VARCHAR2(8500 CHAR);
      V_MSQL_INS VARCHAR2(8500 CHAR);
      V_MSQL_BNY VARCHAR2(8500 CHAR);
      V_MSQL_COC VARCHAR2(8500 CHAR);
      V_CRI_INS VARCHAR2(8500 CHAR);
      V_CRE_INS VARCHAR2(8500 CHAR);
      V_PRV_INS VARCHAR2(8500 CHAR);
      V_SOL_INS VARCHAR2(8500 CHAR);
      V_INF_INS VARCHAR2(8500 CHAR);
      V_ZCO_INS VARCHAR2(8500 CHAR);
      V_INS_INS VARCHAR2(8500 CHAR);
      V_BNY_INS VARCHAR2(8500 CHAR);
      V_COC_INS VARCHAR2(8500 CHAR);
      
      REG_CRI VARCHAR2(4000 CHAR);
      REG_CRE  VARCHAR2(4000 CHAR);
      REG_PRV VARCHAR2(4000 CHAR);
      REG_SOL VARCHAR2(4000 CHAR);
      REG_INF VARCHAR2(4000 CHAR);
      REG_ZCO VARCHAR2(4000 CHAR);
      REG_INS VARCHAR2(4000 CHAR);
      REG_BNY VARCHAR2(4000 CHAR);
      REG_COC VARCHAR2(4000 CHAR);
      
      ACTIVOS_CON_CAMBIOS CLOB;
   
ACT_NUMERO_ACTIVO NUMBER(17);

CRI_PTA_ENT_NORMAL NUMBER(1);
CRI_PTA_ENT_BLINDADA NUMBER(1);

  CRI_PTA_ENT_ACORAZADA NUMBER(1);
  CRI_PTA_PASO_MACIZAS NUMBER(1);
  CRI_PTA_PASO_HUECAS NUMBER(1);
  CRI_PTA_PASO_LACADAS NUMBER(1);
  CRI_ARMARIOS_EMPOTRADOS NUMBER(1);
  CRI_CRP_INT_OTROS VARCHAR2(250 CHAR);
  CRE_VTNAS_HIERRO NUMBER(1);
  CRE_VTNAS_ALU_ANODIZADO NUMBER(1);
  CRE_VTNAS_ALU_LACADO NUMBER(1);
  CRE_VTNAS_PVC NUMBER(1);
  CRE_VTNAS_MADERA NUMBER(1);
  CRE_PERS_PLASTICO NUMBER(1);
  CRE_PERS_ALU NUMBER(1);
  CRE_VTNAS_CORREDERAS NUMBER(1);
  CRE_VTNAS_ABATIBLES NUMBER(1);
  CRE_VTNAS_OSCILOBAT NUMBER(1);
  CRE_DOBLE_CRISTAL NUMBER(1);
  CRE_EST_DOBLE_CRISTAL NUMBER(1);
  CRE_CRP_EXT_OTROS VARCHAR2(250 CHAR);
  PRV_HUMEDAD_PARED NUMBER(1);
  PRV_HUMEDAD_TECHO NUMBER(1);
  PRV_GRIETA_PARED NUMBER(1);
  PRV_GRIETA_TECHO NUMBER(1);
  PRV_GOTELE NUMBER(1);
  PRV_PLASTICA_LISA NUMBER(1);
  PRV_PAPEL_PINTADO NUMBER(1); 
  PRV_PINTURA_LISA_TECHO NUMBER(1);
  PRV_PINTURA_LISA_TECHO_EST NUMBER(1);
  PRV_MOLDURA_ESCAYOLA NUMBER(1);
  PRV_MOLDURA_ESCAYOLA_EST NUMBER(1);
  PRV_PARAMENTOS_OTROS VARCHAR2(250 CHAR);
  SOL_TARIMA_FLOTANTE NUMBER(1);
  SOL_PARQUE NUMBER(1);
  SOL_MARMOL NUMBER(1);
  SOL_PLAQUETA NUMBER(1);
  SOL_SOLADO_OTROS VARCHAR2(250 CHAR);
  INF_OCIO NUMBER(1);
  INF_HOTELES NUMBER(1);
  INF_HOTELES_DESC VARCHAR2(250 CHAR);
  INF_TEATROS NUMBER(1);
  INF_TEATROS_DESC VARCHAR2(250 CHAR);
  INF_SALAS_CINE NUMBER(1);
  INF_SALAS_CINE_DESC VARCHAR2(250 CHAR);
  INF_INST_DEPORT NUMBER(1);
  INF_INST_DEPORT_DESC VARCHAR2(250 CHAR);
  INF_CENTROS_COMERC NUMBER(1);
  INF_CENTROS_COMERC_DESC VARCHAR2(250 CHAR);
  INF_OCIO_OTROS VARCHAR2(250 CHAR);
  INF_CENTROS_EDU NUMBER(1);
  INF_ESCUELAS_INF NUMBER(1);
  INF_ESCUELAS_INF_DESC VARCHAR2(250 CHAR);
  INF_COLEGIOS NUMBER(1);
  INF_COLEGIOS_DESC VARCHAR2(250 CHAR);
  INF_INSTITUTOS NUMBER(1);
  INF_INSTITUTOS_DESC VARCHAR2(250 CHAR);
  INF_UNIVERSIDADES NUMBER(1);
  INF_UNIVERSIDADES_DESC VARCHAR2(250 CHAR);
  INF_CENTROS_EDU_OTROS VARCHAR2(250 CHAR);
  INF_CENTROS_SANIT NUMBER(1);
  INF_CENTROS_SALUD NUMBER(1);
  INF_CENTROS_SALUD_DESC VARCHAR2(250 CHAR);
  INF_CLINICAS NUMBER(1);
  INF_CLINICAS_DESC VARCHAR2(250 CHAR);
  INF_HOSPITALES NUMBER(1);
  INF_HOSPITALES_DESC VARCHAR2(250 CHAR);
  INF_CENTROS_SANIT_OTROS VARCHAR2(250 CHAR);
  INF_PARKING_SUP_SUF NUMBER(1);
  INF_COMUNICACIONES NUMBER(1);
  INF_FACIL_ACCESO NUMBER(1);
  INF_FACIL_ACCESO_DESC VARCHAR2(250 CHAR);
  INF_LINEAS_BUS NUMBER(1);
  INF_LINEAS_BUS_DESC VARCHAR2(250 CHAR);
  INF_METRO NUMBER(1);
  INF_METRO_DESC VARCHAR2(250 CHAR);
  INF_EST_TREN NUMBER(1);
  INF_EST_TREN_DESC VARCHAR2(250 CHAR);
  INF_COMUNICACIONES_OTRO VARCHAR2(250 CHAR);
  ZCO_ZONAS_COMUNES NUMBER(1);
  ZCO_JARDINES NUMBER(1);
  ZCO_PISCINA NUMBER(1);
  ZCO_INST_DEP NUMBER(1);
  ZCO_PADEL NUMBER(1);
  ZCO_TENIS NUMBER(1);
  ZCO_PISTA_POLIDEP NUMBER(1);
  ZCO_OTROS VARCHAR2(250 CHAR);
  ZCO_ZONA_INFANTIL NUMBER(1);
  ZCO_CONSERJE_VIGILANCIA NUMBER(1);
  ZCO_GIMNASIO NUMBER(1);
  ZCO_ZONA_COMUN_OTROS VARCHAR2(250 CHAR);
  INS_ELECTR NUMBER(1);
  INS_ELECTR_CON_CONTADOR NUMBER(1);
  INS_ELECTR_BUEN_ESTADO NUMBER(1);
  INS_ELECTR_DEFECTUOSA_ANTIGUA NUMBER(1);
  INS_AGUA NUMBER(1);
  INS_AGUA_CON_CONTADOR NUMBER(1);
  INS_AGUA_BUEN_ESTADO NUMBER(1);
  INS_AGUA_DEFECTUOSA_ANTIGUA NUMBER(1);
  INS_AGUA_CALIENTE_CENTRAL NUMBER(1);
  INS_AGUA_CALIENTE_GAS_NATURAL NUMBER(1);
  INS_GAS NUMBER(1);
  INS_GAS_CON_CONTADOR NUMBER(1);
  INS_GAS_INST_BUEN_ESTADO NUMBER(1);
  INS_GAS_DEFECTUOSA_ANTIGUA NUMBER(1);
  INS_CALEF NUMBER(1);
  INS_CALEF_CENTRAL NUMBER(1);
  INS_CALEF_GAS_NATURAL NUMBER(1);
  INS_CALEF_RADIADORES_ALU NUMBER(1);
  INS_CALEF_PREINSTALACION NUMBER(1);
  INS_AIRE NUMBER(1);
  INS_AIRE_PREINSTALACION NUMBER(1);
  INS_AIRE_INSTALACION NUMBER(1);
  INS_AIRE_FRIO_CALOR NUMBER(1);
  INS_INST_OTROS VARCHAR2(250 CHAR);
  BNY_DUCHA_BANYERA NUMBER(1);
  BNY_DUCHA NUMBER(1);
  BNY_BANYERA NUMBER(1);
  BNY_BANYERA_HIDROMASAJE NUMBER(1);
  BNY_COLUMNA_HIDROMASAJE NUMBER(1);
  BNY_ALICATADO_MARMOL NUMBER(1);
  BNY_ALICATADO_GRANITO NUMBER(1);
  BNY_ALICATADO_AZULEJO NUMBER(1);
  BNY_ENCIMERA NUMBER(1);
  BNY_MARMOL NUMBER(1);
  BNY_GRANITO NUMBER(1);
  BNY_OTRO_MATERIAL NUMBER(1);
  BNY_SANITARIOS NUMBER(1);
  BNY_SANITARIOS_EST NUMBER(1);
  BNY_SUELOS NUMBER(1); 
  BNY_GRIFO_MONOMANDO NUMBER(1);
  BNY_GRIFO_MONOMANDO_EST NUMBER(1);
  BNY_BANYO_OTROS VARCHAR2(250 CHAR);
  COC_AMUEBLADA NUMBER(1);
  COC_AMUEBLADA_EST NUMBER(1);
  COC_ENCIMERA NUMBER(1);
  COC_ENCI_GRANITO NUMBER(1);
  COC_ENCI_MARMOL NUMBER(1);
  COC_ENCI_OTRO_MATERIAL NUMBER(1);
  COC_VITRO NUMBER(1);
  COC_LAVADORA NUMBER(1);
  COC_FRIGORIFICO NUMBER(1);
  COC_LAVAVAJILLAS NUMBER(1);
  COC_MICROONDAS NUMBER(1);
  COC_HORNO NUMBER(1);
  COC_SUELOS NUMBER(1);
  COC_AZULEJOS NUMBER(1);
  COC_AZULEJOS_EST NUMBER(1);
  COC_GRIFOS_MONOMANDO NUMBER(1);
  COC_GRIFOS_MONOMANDO_EST NUMBER(1);
  COC_COCINA_OTROS VARCHAR2(250 CHAR);

  ICO_ACT_DIST NUMBER(16);
INFO_ICO_ID NUMBER(16);
CRI_ICO_ID NUMBER(16);
CRE_ICO_ID NUMBER(16);
PRV_ICO_ID NUMBER(16);
SOL_ICO_ID NUMBER(16);
INF_ICO_ID NUMBER(16);
ZCO_ICO_ID NUMBER(16);
INS_ICO_ID NUMBER(16);
BNY_ICO_ID NUMBER(16);
COC_ICO_ID NUMBER(16);



CURSOR SEQ_CALIDADES
    IS
   SELECT
CAL.ROWID CAL_ROWID,   
CAL.ACT_NUMERO_ACTIVO,   
INFO.ICO_ID INFO_ICO_ID,
CRI.ICO_ID CRI_ICO_ID,
CRE.ICO_ID CRE_ICO_ID,
PRV.ICO_ID PRV_ICO_ID,
SOL.ICO_ID SOL_ICO_ID,
INF.ICO_ID INF_ICO_ID,
ZCO.ICO_ID ZCO_ICO_ID,
INS.ICO_ID INS_ICO_ID,
BNY.ICO_ID BNY_ICO_ID,
COC.ICO_ID COC_ICO_ID,
CAL.CRI_PTA_ENT_NORMAL,
  CAL.CRI_PTA_ENT_BLINDADA,
  CAL.CRI_PTA_ENT_ACORAZADA,
  CAL.CRI_PTA_PASO_MACIZAS,
  CAL.CRI_PTA_PASO_HUECAS,
  CAL.CRI_PTA_PASO_LACADAS,
  CAL.CRI_ARMARIOS_EMPOTRADOS,
  CAL.CRI_CRP_INT_OTROS,
  CAL.CRE_VTNAS_HIERRO,
  CAL.CRE_VTNAS_ALU_ANODIZADO,
  CAL.CRE_VTNAS_ALU_LACADO,
  CAL.CRE_VTNAS_PVC,
  CAL.CRE_VTNAS_MADERA,
  CAL.CRE_PERS_PLASTICO,
  CAL.CRE_PERS_ALU,
  CAL.CRE_VTNAS_CORREDERAS,
  CAL.CRE_VTNAS_ABATIBLES,
  CAL.CRE_VTNAS_OSCILOBAT,
  CAL.CRE_DOBLE_CRISTAL,
  CAL.CRE_EST_DOBLE_CRISTAL,
  CAL.CRE_CRP_EXT_OTROS,
  CAL.PRV_HUMEDAD_PARED,
  CAL.PRV_HUMEDAD_TECHO,
  CAL.PRV_GRIETA_PARED,
  CAL.PRV_GRIETA_TECHO,
  CAL.PRV_GOTELE,
  CAL.PRV_PLASTICA_LISA,
  CAL.PRV_PAPEL_PINTADO,
  CAL.PRV_PINTURA_LISA_TECHO,
  CAL.PRV_PINTURA_LISA_TECHO_EST,
  CAL.PRV_MOLDURA_ESCAYOLA,
  CAL.PRV_MOLDURA_ESCAYOLA_EST,
  CAL.PRV_PARAMENTOS_OTROS,
  CAL.SOL_TARIMA_FLOTANTE,
  CAL.SOL_PARQUE,
  CAL.SOL_MARMOL,
  CAL.SOL_PLAQUETA,
  CAL.SOL_SOLADO_OTROS,
  CAL.INF_OCIO,
  CAL.INF_HOTELES,
  CAL.INF_HOTELES_DESC,
  CAL.INF_TEATROS,
  CAL.INF_TEATROS_DESC,
  CAL.INF_SALAS_CINE,
  CAL.INF_SALAS_CINE_DESC,
  CAL.INF_INST_DEPORT,
  CAL.INF_INST_DEPORT_DESC,
  CAL.INF_CENTROS_COMERC,
  CAL.INF_CENTROS_COMERC_DESC,
  CAL.INF_OCIO_OTROS,
  CAL.INF_CENTROS_EDU,
  CAL.INF_ESCUELAS_INF,
  CAL.INF_ESCUELAS_INF_DESC,
  CAL.INF_COLEGIOS,
  CAL.INF_COLEGIOS_DESC,
  CAL.INF_INSTITUTOS,
  CAL.INF_INSTITUTOS_DESC,
  CAL.INF_UNIVERSIDADES,
  CAL.INF_UNIVERSIDADES_DESC,
  CAL.INF_CENTROS_EDU_OTROS,
  CAL.INF_CENTROS_SANIT,
  CAL.INF_CENTROS_SALUD,
  CAL.INF_CENTROS_SALUD_DESC,
  CAL.INF_CLINICAS,
  CAL.INF_CLINICAS_DESC,
  CAL.INF_HOSPITALES,
  CAL.INF_HOSPITALES_DESC,
  CAL.INF_CENTROS_SANIT_OTROS,
  CAL.INF_PARKING_SUP_SUF,
  CAL.INF_COMUNICACIONES,
  CAL.INF_FACIL_ACCESO,
  CAL.INF_FACIL_ACCESO_DESC,
  CAL.INF_LINEAS_BUS,
  CAL.INF_LINEAS_BUS_DESC,
  CAL.INF_METRO,
  CAL.INF_METRO_DESC,
  CAL.INF_EST_TREN,
  CAL.INF_EST_TREN_DESC,
  CAL.INF_COMUNICACIONES_OTRO,
  CAL.ZCO_ZONAS_COMUNES,
  CAL.ZCO_JARDINES,
  CAL.ZCO_PISCINA,
  CAL.ZCO_INST_DEP,
  CAL.ZCO_PADEL,
  CAL.ZCO_TENIS,
  CAL.ZCO_PISTA_POLIDEP,
  CAL.ZCO_OTROS,
  CAL.ZCO_ZONA_INFANTIL,
  CAL.ZCO_CONSERJE_VIGILANCIA,
  CAL.ZCO_GIMNASIO,
  CAL.ZCO_ZONA_COMUN_OTROS,
  CAL.INS_ELECTR,
  CAL.INS_ELECTR_CON_CONTADOR,
  CAL.INS_ELECTR_BUEN_ESTADO,
  CAL.INS_ELECTR_DEFECTUOSA_ANTIGUA,
  CAL.INS_AGUA,
  CAL.INS_AGUA_CON_CONTADOR,
  CAL.INS_AGUA_BUEN_ESTADO,
  CAL.INS_AGUA_DEFECTUOSA_ANTIGUA,
  CAL.INS_AGUA_CALIENTE_CENTRAL,
  CAL.INS_AGUA_CALIENTE_GAS_NATURAL,
  CAL.INS_GAS,
  CAL.INS_GAS_CON_CONTADOR,
  CAL.INS_GAS_INST_BUEN_ESTADO,
  CAL.INS_GAS_DEFECTUOSA_ANTIGUA,
  CAL.INS_CALEF,
  CAL.INS_CALEF_CENTRAL,
  CAL.INS_CALEF_GAS_NATURAL,
  CAL.INS_CALEF_RADIADORES_ALU,
  CAL.INS_CALEF_PREINSTALACION,
  CAL.INS_AIRE,
  CAL.INS_AIRE_PREINSTALACION,
  CAL.INS_AIRE_INSTALACION,
  CAL.INS_AIRE_FRIO_CALOR,
  CAL.INS_INST_OTROS,
  CAL.BNY_DUCHA_BANYERA,
  CAL.BNY_DUCHA,
  CAL.BNY_BANYERA,
  CAL.BNY_BANYERA_HIDROMASAJE,
  CAL.BNY_COLUMNA_HIDROMASAJE,
  CAL.BNY_ALICATADO_MARMOL,
  CAL.BNY_ALICATADO_GRANITO,
  CAL.BNY_ALICATADO_AZULEJO,
  CAL.BNY_ENCIMERA,
  CAL.BNY_MARMOL,
  CAL.BNY_GRANITO,
  CAL.BNY_OTRO_MATERIAL,
  CAL.BNY_SANITARIOS,
  CAL.BNY_SANITARIOS_EST,
  CAL.BNY_SUELOS,
  CAL.BNY_GRIFO_MONOMANDO,
  CAL.BNY_GRIFO_MONOMANDO_EST,
  CAL.BNY_BANYO_OTROS,
  CAL.COC_AMUEBLADA,
  CAL.COC_AMUEBLADA_EST,
  CAL.COC_ENCIMERA,
  CAL.COC_ENCI_GRANITO,
  CAL.COC_ENCI_MARMOL,
  CAL.COC_ENCI_OTRO_MATERIAL,
  CAL.COC_VITRO,
  CAL.COC_LAVADORA,
  CAL.COC_FRIGORIFICO,
  CAL.COC_LAVAVAJILLAS,
  CAL.COC_MICROONDAS,
  CAL.COC_HORNO,
  CAL.COC_SUELOS,
  CAL.COC_AZULEJOS,
  CAL.COC_AZULEJOS_EST,
  CAL.COC_GRIFOS_MONOMANDO,
  CAL.COC_GRIFOS_MONOMANDO_EST,
  CAL.COC_COCINA_OTROS
FROM 
REM01.APR_AUX_DATOS_ACTIVO DAT,
REM01.APR_AUX_CALIDADES_ACTIVOS CAL,
REM01.ACT_ACTIVO ACT,
REM01.ACT_ICO_INFO_COMERCIAL INFO,
REM01.ACT_CRI_CARPINTERIA_INT CRI,
REM01.ACT_CRE_CARPINTERIA_EXT CRE,
REM01.ACT_PRV_PARAMENTO_VERTICAL PRV,
REM01.ACT_SOL_SOLADO SOL,
REM01.ACT_INF_INFRAESTRUCTURA INF,
REM01.ACT_ZCO_ZONA_COMUN ZCO,
REM01.ACT_INS_INSTALACION INS,
REM01.ACT_BNY_BANYO BNY,
REM01.ACT_COC_COCINA COC
WHERE 
 DAT.ACT_NUMERO_ACTIVO = CAL.ACT_NUMERO_ACTIVO
AND ACT.ACT_NUM_ACTIVO = DAT.ACT_NUMERO_ACTIVO
AND INFO.ACT_ID = ACT.ACT_ID
AND CRI.ICO_ID (+) = INFO.ICO_ID 
AND CRE.ICO_ID (+) = INFO.ICO_ID 
AND PRV.ICO_ID (+) = INFO.ICO_ID 
AND SOL.ICO_ID (+) = INFO.ICO_ID 
AND INF.ICO_ID (+) = INFO.ICO_ID 
AND ZCO.ICO_ID (+) = INFO.ICO_ID 
AND INS.ICO_ID (+) = INFO.ICO_ID 
AND BNY.ICO_ID (+) = INFO.ICO_ID
AND COC.ICO_ID (+) = INFO.ICO_ID

;





BEGIN

/******************TABLA TEMPORAL CON LOS ACTIVOS A ACTUALIZAR********************/


ACTIVOS_CON_CAMBIOS :='
INSERT INTO '||V_ESQUEMA||'.APR_AUX_UPDATE_ACTIVOS (ACT_NUMERO_ACTIVO,TABLA)
SELECT ACT_NUMERO_ACTIVO, ''ACT_CRI_CARPINTERIA_INT''  FROM (
SELECT 
   CAL.ACT_NUMERO_ACTIVO,
  ACR.DD_ACR_ID,
  CAL.CRI_PTA_ENT_NORMAL,
  CAL.CRI_PTA_ENT_BLINDADA,
  CAL.CRI_PTA_ENT_ACORAZADA,
  CAL.CRI_PTA_PASO_MACIZAS,
  CAL.CRI_PTA_PASO_HUECAS,
  CAL.CRI_PTA_PASO_LACADAS,
  CAL.CRI_ARMARIOS_EMPOTRADOS,
  CAL.CRI_CRP_INT_OTROS
  FROM    
   '||V_ESQUEMA||'.APR_AUX_CALIDADES_ACTIVOS CAL,
  '||V_ESQUEMA||'.ACT_ACTIVO ACT,
  '||V_ESQUEMA||'.ACT_ICO_INFO_COMERCIAL INFO,
'||V_ESQUEMA||'.ACT_CRI_CARPINTERIA_INT CRI,
'||V_ESQUEMA||'.DD_ACR_ACABADO_CARPINTERIA ACR
WHERE 
CAL.ACT_NUMERO_ACTIVO = ACT.ACT_NUM_ACTIVO 
AND INFO.ACT_ID = ACT.ACT_ID
AND INFO.ICO_ID = CRI.ICO_ID 
AND CAL.TIPO_ACABADO_CARPINTERIA   =  ACR.DD_ACR_CODIGO (+)
MINUS
SELECT 
CAL.ACT_NUMERO_ACTIVO,
CRI.DD_ACR_ID,
CRI.CRI_PTA_ENT_NORMAL,
CRI.CRI_PTA_ENT_BLINDADA,
CRI.CRI_PTA_ENT_ACORAZADA,
CRI.CRI_PTA_PASO_MACIZAS,
CRI.CRI_PTA_PASO_HUECAS,
CRI.CRI_PTA_PASO_LACADAS,
CRI.CRI_ARMARIOS_EMPOTRADOS,
CRI.CRI_CRP_INT_OTROS
  FROM    
   '||V_ESQUEMA||'.APR_AUX_CALIDADES_ACTIVOS CAL,
  '||V_ESQUEMA||'.ACT_ACTIVO ACT,
  '||V_ESQUEMA||'.ACT_ICO_INFO_COMERCIAL INFO,
'||V_ESQUEMA||'.ACT_CRI_CARPINTERIA_INT CRI
WHERE 
CAL.ACT_NUMERO_ACTIVO = ACT.ACT_NUM_ACTIVO 
AND INFO.ACT_ID = ACT.ACT_ID
AND INFO.ICO_ID = CRI.ICO_ID 
)
UNION ALL
SELECT ACT_NUMERO_ACTIVO, ''ACT_CRE_CARPINTERIA_EXT'' FROM (
SELECT 
CAL.ACT_NUMERO_ACTIVO,
CAL.CRE_VTNAS_HIERRO,
CAL.CRE_VTNAS_ALU_ANODIZADO,
CAL.CRE_VTNAS_ALU_LACADO,
CAL.CRE_VTNAS_PVC,
CAL.CRE_VTNAS_MADERA,
CAL.CRE_PERS_PLASTICO,
CAL.CRE_PERS_ALU,
CAL.CRE_VTNAS_CORREDERAS,
CAL.CRE_VTNAS_ABATIBLES,
CAL.CRE_VTNAS_OSCILOBAT,
CAL.CRE_DOBLE_CRISTAL,
CAL.CRE_EST_DOBLE_CRISTAL,
CAL.CRE_CRP_EXT_OTROS
  FROM    
   '||V_ESQUEMA||'.APR_AUX_CALIDADES_ACTIVOS CAL,
  '||V_ESQUEMA||'.ACT_ACTIVO ACT,
  '||V_ESQUEMA||'.ACT_ICO_INFO_COMERCIAL INFO,
'||V_ESQUEMA||'.ACT_CRE_CARPINTERIA_EXT CRE
WHERE 
CAL.ACT_NUMERO_ACTIVO = ACT.ACT_NUM_ACTIVO 
AND INFO.ACT_ID = ACT.ACT_ID
AND INFO.ICO_ID = CRE.ICO_ID 
MINUS
SELECT 
CAL.ACT_NUMERO_ACTIVO,
CRE.CRE_VTNAS_HIERRO,
CRE.CRE_VTNAS_ALU_ANODIZADO,
CRE.CRE_VTNAS_ALU_LACADO,
CRE.CRE_VTNAS_PVC,
CRE.CRE_VTNAS_MADERA,
CRE.CRE_PERS_PLASTICO,
CRE.CRE_PERS_ALU,
CRE.CRE_VTNAS_CORREDERAS,
CRE.CRE_VTNAS_ABATIBLES,
CRE.CRE_VTNAS_OSCILOBAT,
CRE.CRE_DOBLE_CRISTAL,
CRE.CRE_EST_DOBLE_CRISTAL,
CRE.CRE_CRP_EXT_OTROS
  FROM    
   '||V_ESQUEMA||'.APR_AUX_CALIDADES_ACTIVOS CAL,
  '||V_ESQUEMA||'.ACT_ACTIVO ACT,
  '||V_ESQUEMA||'.ACT_ICO_INFO_COMERCIAL INFO,
'||V_ESQUEMA||'.ACT_CRE_CARPINTERIA_EXT CRE
WHERE 
CAL.ACT_NUMERO_ACTIVO = ACT.ACT_NUM_ACTIVO 
AND INFO.ACT_ID = ACT.ACT_ID
AND INFO.ICO_ID = CRE.ICO_ID 
)
UNION ALL
SELECT ACT_NUMERO_ACTIVO, ''ACT_PRV_PARAMENTO_VERTICAL'' FROM (
SELECT 
CAL.ACT_NUMERO_ACTIVO,
CAL.PRV_HUMEDAD_PARED,
CAL.PRV_HUMEDAD_TECHO,
CAL.PRV_GRIETA_PARED,
CAL.PRV_GRIETA_TECHO,
CAL.PRV_GOTELE,
CAL.PRV_PLASTICA_LISA,
CAL.PRV_PAPEL_PINTADO,
CAL.PRV_PINTURA_LISA_TECHO,
CAL.PRV_PINTURA_LISA_TECHO_EST,
CAL.PRV_MOLDURA_ESCAYOLA,
CAL.PRV_MOLDURA_ESCAYOLA_EST,
CAL.PRV_PARAMENTOS_OTROS
  FROM    
   '||V_ESQUEMA||'.APR_AUX_CALIDADES_ACTIVOS CAL,
  '||V_ESQUEMA||'.ACT_ACTIVO ACT,
  '||V_ESQUEMA||'.ACT_ICO_INFO_COMERCIAL INFO,
  '||V_ESQUEMA||'.ACT_PRV_PARAMENTO_VERTICAL PRV
WHERE 
CAL.ACT_NUMERO_ACTIVO = ACT.ACT_NUM_ACTIVO 
AND INFO.ACT_ID = ACT.ACT_ID
AND INFO.ICO_ID = PRV.ICO_ID 
MINUS
SELECT 
CAL.ACT_NUMERO_ACTIVO,
PRV.PRV_HUMEDAD_PARED,
PRV.PRV_HUMEDAD_TECHO,
PRV.PRV_GRIETA_PARED,
PRV.PRV_GRIETA_TECHO,
PRV.PRV_GOTELE,
PRV.PRV_PLASTICA_LISA,
PRV.PRV_PAPEL_PINTADO,
PRV.PRV_PINTURA_LISA_TECHO,
PRV.PRV_PINTURA_LISA_TECHO_EST,
PRV.PRV_MOLDURA_ESCAYOLA,
PRV.PRV_MOLDURA_ESCAYOLA_EST,
PRV.PRV_PARAMENTOS_OTROS
  FROM    
   '||V_ESQUEMA||'.APR_AUX_CALIDADES_ACTIVOS CAL,
  '||V_ESQUEMA||'.ACT_ACTIVO ACT,
  '||V_ESQUEMA||'.ACT_ICO_INFO_COMERCIAL INFO,
  '||V_ESQUEMA||'.ACT_PRV_PARAMENTO_VERTICAL PRV
WHERE 
CAL.ACT_NUMERO_ACTIVO = ACT.ACT_NUM_ACTIVO 
AND INFO.ACT_ID = ACT.ACT_ID
AND INFO.ICO_ID = PRV.ICO_ID 
)
UNION ALL
SELECT ACT_NUMERO_ACTIVO, ''ACT_SOL_SOLADO'' FROM (
SELECT 
CAL.ACT_NUMERO_ACTIVO,
CAL.SOL_TARIMA_FLOTANTE,
CAL.SOL_PARQUE,
CAL.SOL_MARMOL,
CAL.SOL_PLAQUETA,
CAL.SOL_SOLADO_OTROS
  FROM    
   '||V_ESQUEMA||'.APR_AUX_CALIDADES_ACTIVOS CAL,
  '||V_ESQUEMA||'.ACT_ACTIVO ACT,
  '||V_ESQUEMA||'.ACT_ICO_INFO_COMERCIAL INFO,
  '||V_ESQUEMA||'.ACT_SOL_SOLADO SOL
WHERE 
CAL.ACT_NUMERO_ACTIVO = ACT.ACT_NUM_ACTIVO 
AND INFO.ACT_ID = ACT.ACT_ID
AND INFO.ICO_ID = SOL.ICO_ID 
MINUS
SELECT 
CAL.ACT_NUMERO_ACTIVO,
SOL.SOL_TARIMA_FLOTANTE,
SOL.SOL_PARQUE,
SOL.SOL_MARMOL,
SOL.SOL_PLAQUETA,
SOL.SOL_SOLADO_OTROS
  FROM    
   '||V_ESQUEMA||'.APR_AUX_CALIDADES_ACTIVOS CAL,
  '||V_ESQUEMA||'.ACT_ACTIVO ACT,
  '||V_ESQUEMA||'.ACT_ICO_INFO_COMERCIAL INFO,
  '||V_ESQUEMA||'.ACT_SOL_SOLADO SOL
WHERE 
CAL.ACT_NUMERO_ACTIVO = ACT.ACT_NUM_ACTIVO 
AND INFO.ACT_ID = ACT.ACT_ID
AND INFO.ICO_ID = SOL.ICO_ID 
)
UNION ALL
SELECT ACT_NUMERO_ACTIVO, ''ACT_INF_INFRAESTRUCTURA'' FROM (
SELECT 
CAL.ACT_NUMERO_ACTIVO,
CAL.INF_OCIO,
CAL.INF_HOTELES,
CAL.INF_HOTELES_DESC,
CAL.INF_TEATROS,
CAL.INF_TEATROS_DESC,
CAL.INF_SALAS_CINE,
CAL.INF_SALAS_CINE_DESC,
CAL.INF_INST_DEPORT,
CAL.INF_INST_DEPORT_DESC,
CAL.INF_CENTROS_COMERC,
CAL.INF_CENTROS_COMERC_DESC,
CAL.INF_OCIO_OTROS,
CAL.INF_CENTROS_EDU,
CAL.INF_ESCUELAS_INF,
CAL.INF_ESCUELAS_INF_DESC,
CAL.INF_COLEGIOS,
CAL.INF_COLEGIOS_DESC,
CAL.INF_INSTITUTOS,
CAL.INF_INSTITUTOS_DESC,
CAL.INF_UNIVERSIDADES,
CAL.INF_UNIVERSIDADES_DESC,
CAL.INF_CENTROS_EDU_OTROS,
CAL.INF_CENTROS_SANIT,
CAL.INF_CENTROS_SALUD,
CAL.INF_CENTROS_SALUD_DESC,
CAL.INF_CLINICAS,
CAL.INF_CLINICAS_DESC,
CAL.INF_HOSPITALES,
CAL.INF_HOSPITALES_DESC,
CAL.INF_CENTROS_SANIT_OTROS,
CAL.INF_PARKING_SUP_SUF,
CAL.INF_COMUNICACIONES,
CAL.INF_FACIL_ACCESO,
CAL.INF_FACIL_ACCESO_DESC,
CAL.INF_LINEAS_BUS,
CAL.INF_LINEAS_BUS_DESC,
CAL.INF_METRO,
CAL.INF_METRO_DESC,
CAL.INF_EST_TREN,
CAL.INF_EST_TREN_DESC,
CAL.INF_COMUNICACIONES_OTRO
  FROM    
   '||V_ESQUEMA||'.APR_AUX_CALIDADES_ACTIVOS CAL,
  '||V_ESQUEMA||'.ACT_ACTIVO ACT,
  '||V_ESQUEMA||'.ACT_ICO_INFO_COMERCIAL INFO,
  '||V_ESQUEMA||'.ACT_INF_INFRAESTRUCTURA INF
WHERE 
CAL.ACT_NUMERO_ACTIVO = ACT.ACT_NUM_ACTIVO 
AND INFO.ACT_ID = ACT.ACT_ID
AND INFO.ICO_ID = INF.ICO_ID 
MINUS
SELECT 
CAL.ACT_NUMERO_ACTIVO,
INF.INF_OCIO,
INF.INF_HOTELES,
INF.INF_HOTELES_DESC,
INF.INF_TEATROS,
INF.INF_TEATROS_DESC,
INF.INF_SALAS_CINE,
INF.INF_SALAS_CINE_DESC,
INF.INF_INST_DEPORT,
INF.INF_INST_DEPORT_DESC,
INF.INF_CENTROS_COMERC,
INF.INF_CENTROS_COMERC_DESC,
INF.INF_OCIO_OTROS,
INF.INF_CENTROS_EDU,
INF.INF_ESCUELAS_INF,
INF.INF_ESCUELAS_INF_DESC,
INF.INF_COLEGIOS,
INF.INF_COLEGIOS_DESC,
INF.INF_INSTITUTOS,
INF.INF_INSTITUTOS_DESC,
INF.INF_UNIVERSIDADES,
INF.INF_UNIVERSIDADES_DESC,
INF.INF_CENTROS_EDU_OTROS,
INF.INF_CENTROS_SANIT,
INF.INF_CENTROS_SALUD,
INF.INF_CENTROS_SALUD_DESC,
INF.INF_CLINICAS,
INF.INF_CLINICAS_DESC,
INF.INF_HOSPITALES,
INF.INF_HOSPITALES_DESC,
INF.INF_CENTROS_SANIT_OTROS,
INF.INF_PARKING_SUP_SUF,
INF.INF_COMUNICACIONES,
INF.INF_FACIL_ACCESO,
INF.INF_FACIL_ACCESO_DESC,
INF.INF_LINEAS_BUS,
INF.INF_LINEAS_BUS_DESC,
INF.INF_METRO,
INF.INF_METRO_DESC,
INF.INF_EST_TREN,
INF.INF_EST_TREN_DESC,
INF.INF_COMUNICACIONES_OTRO
  FROM    
   '||V_ESQUEMA||'.APR_AUX_CALIDADES_ACTIVOS CAL,
  '||V_ESQUEMA||'.ACT_ACTIVO ACT,
  '||V_ESQUEMA||'.ACT_ICO_INFO_COMERCIAL INFO,
  '||V_ESQUEMA||'.ACT_INF_INFRAESTRUCTURA INF
WHERE 
CAL.ACT_NUMERO_ACTIVO = ACT.ACT_NUM_ACTIVO 
AND INFO.ACT_ID = ACT.ACT_ID
AND INFO.ICO_ID = INF.ICO_ID 
)
UNION ALL
SELECT ACT_NUMERO_ACTIVO, ''ACT_ZCO_ZONA_COMUN'' FROM (
SELECT 
CAL.ACT_NUMERO_ACTIVO,
CAL.ZCO_ZONAS_COMUNES,
CAL.ZCO_JARDINES,
CAL.ZCO_PISCINA,
CAL.ZCO_INST_DEP,
CAL.ZCO_PADEL,
CAL.ZCO_TENIS,
CAL.ZCO_PISTA_POLIDEP,
CAL.ZCO_OTROS,
CAL.ZCO_ZONA_INFANTIL,
CAL.ZCO_CONSERJE_VIGILANCIA,
CAL.ZCO_GIMNASIO,
CAL.ZCO_ZONA_COMUN_OTROS
  FROM    
   '||V_ESQUEMA||'.APR_AUX_CALIDADES_ACTIVOS CAL,
  '||V_ESQUEMA||'.ACT_ACTIVO ACT,
  '||V_ESQUEMA||'.ACT_ICO_INFO_COMERCIAL INFO,
  '||V_ESQUEMA||'.ACT_ZCO_ZONA_COMUN ZCO
WHERE 
CAL.ACT_NUMERO_ACTIVO = ACT.ACT_NUM_ACTIVO 
AND INFO.ACT_ID = ACT.ACT_ID
AND INFO.ICO_ID = ZCO.ICO_ID 
MINUS
SELECT 
CAL.ACT_NUMERO_ACTIVO,
ZCO.ZCO_ZONAS_COMUNES,
ZCO.ZCO_JARDINES,
ZCO.ZCO_PISCINA,
ZCO.ZCO_INST_DEP,
ZCO.ZCO_PADEL,
ZCO.ZCO_TENIS,
ZCO.ZCO_PISTA_POLIDEP,
ZCO.ZCO_OTROS,
ZCO.ZCO_ZONA_INFANTIL,
ZCO.ZCO_CONSERJE_VIGILANCIA,
ZCO.ZCO_GIMNASIO,
ZCO.ZCO_ZONA_COMUN_OTROS
  FROM    
   '||V_ESQUEMA||'.APR_AUX_CALIDADES_ACTIVOS CAL,
  '||V_ESQUEMA||'.ACT_ACTIVO ACT,
  '||V_ESQUEMA||'.ACT_ICO_INFO_COMERCIAL INFO,
  '||V_ESQUEMA||'.ACT_ZCO_ZONA_COMUN ZCO
WHERE 
CAL.ACT_NUMERO_ACTIVO = ACT.ACT_NUM_ACTIVO 
AND INFO.ACT_ID = ACT.ACT_ID
AND INFO.ICO_ID = ZCO.ICO_ID 
)
UNION ALL
SELECT ACT_NUMERO_ACTIVO, ''ACT_INS_INSTALACION'' FROM (
SELECT 
CAL.ACT_NUMERO_ACTIVO,
CAL.INS_ELECTR,
CAL.INS_ELECTR_CON_CONTADOR,
CAL.INS_ELECTR_BUEN_ESTADO,
CAL.INS_ELECTR_DEFECTUOSA_ANTIGUA,
CAL.INS_AGUA,
CAL.INS_AGUA_CON_CONTADOR,
CAL.INS_AGUA_BUEN_ESTADO,
CAL.INS_AGUA_DEFECTUOSA_ANTIGUA,
CAL.INS_AGUA_CALIENTE_CENTRAL,
CAL.INS_AGUA_CALIENTE_GAS_NATURAL,
CAL.INS_GAS,
CAL.INS_GAS_CON_CONTADOR,
CAL.INS_GAS_INST_BUEN_ESTADO,
CAL.INS_GAS_DEFECTUOSA_ANTIGUA,
CAL.INS_CALEF,
CAL.INS_CALEF_CENTRAL,
CAL.INS_CALEF_GAS_NATURAL,
CAL.INS_CALEF_RADIADORES_ALU,
CAL.INS_CALEF_PREINSTALACION,
CAL.INS_AIRE,
CAL.INS_AIRE_PREINSTALACION,
CAL.INS_AIRE_INSTALACION,
CAL.INS_AIRE_FRIO_CALOR,
CAL.INS_INST_OTROS
  FROM    
   '||V_ESQUEMA||'.APR_AUX_CALIDADES_ACTIVOS CAL,
  '||V_ESQUEMA||'.ACT_ACTIVO ACT,
  '||V_ESQUEMA||'.ACT_ICO_INFO_COMERCIAL INFO,
  '||V_ESQUEMA||'.ACT_INS_INSTALACION INS
WHERE 
CAL.ACT_NUMERO_ACTIVO = ACT.ACT_NUM_ACTIVO 
AND INFO.ACT_ID = ACT.ACT_ID
AND INFO.ICO_ID = INS.ICO_ID 
MINUS
SELECT 
CAL.ACT_NUMERO_ACTIVO,
INS.INS_ELECTR,
INS.INS_ELECTR_CON_CONTADOR,
INS.INS_ELECTR_BUEN_ESTADO,
INS.INS_ELECTR_DEFECTUOSA_ANTIGUA,
INS.INS_AGUA,
INS.INS_AGUA_CON_CONTADOR,
INS.INS_AGUA_BUEN_ESTADO,
INS.INS_AGUA_DEFECTUOSA_ANTIGUA,
INS.INS_AGUA_CALIENTE_CENTRAL,
INS.INS_AGUA_CALIENTE_GAS_NATURAL,
INS.INS_GAS,
INS.INS_GAS_CON_CONTADOR,
INS.INS_GAS_INST_BUEN_ESTADO,
INS.INS_GAS_DEFECTUOSA_ANTIGUA,
INS.INS_CALEF,
INS.INS_CALEF_CENTRAL,
INS.INS_CALEF_GAS_NATURAL,
INS.INS_CALEF_RADIADORES_ALU,
INS.INS_CALEF_PREINSTALACION,
INS.INS_AIRE,
INS.INS_AIRE_PREINSTALACION,
INS.INS_AIRE_INSTALACION,
INS.INS_AIRE_FRIO_CALOR,
INS.INS_INST_OTROS
  FROM    
   '||V_ESQUEMA||'.APR_AUX_CALIDADES_ACTIVOS CAL,
  '||V_ESQUEMA||'.ACT_ACTIVO ACT,
  '||V_ESQUEMA||'.ACT_ICO_INFO_COMERCIAL INFO,
  '||V_ESQUEMA||'.ACT_INS_INSTALACION INS
WHERE 
CAL.ACT_NUMERO_ACTIVO = ACT.ACT_NUM_ACTIVO 
AND INFO.ACT_ID = ACT.ACT_ID
AND INFO.ICO_ID = INS.ICO_ID 
)
UNION ALL
SELECT ACT_NUMERO_ACTIVO, ''ACT_BNY_BANYO'' FROM (
SELECT 
CAL.ACT_NUMERO_ACTIVO,
CAL.BNY_DUCHA_BANYERA,
CAL.BNY_DUCHA,
CAL.BNY_BANYERA,
CAL.BNY_BANYERA_HIDROMASAJE,
CAL.BNY_COLUMNA_HIDROMASAJE,
CAL.BNY_ALICATADO_MARMOL,
CAL.BNY_ALICATADO_GRANITO,
CAL.BNY_ALICATADO_AZULEJO,
CAL.BNY_ENCIMERA,
CAL.BNY_MARMOL,
CAL.BNY_GRANITO,
CAL.BNY_OTRO_MATERIAL,
CAL.BNY_SANITARIOS,
CAL.BNY_SANITARIOS_EST,
CAL.BNY_SUELOS,
CAL.BNY_GRIFO_MONOMANDO,
CAL.BNY_GRIFO_MONOMANDO_EST,
CAL.BNY_BANYO_OTROS
  FROM    
   '||V_ESQUEMA||'.APR_AUX_CALIDADES_ACTIVOS CAL,
  '||V_ESQUEMA||'.ACT_ACTIVO ACT,
  '||V_ESQUEMA||'.ACT_ICO_INFO_COMERCIAL INFO,
  '||V_ESQUEMA||'.ACT_BNY_BANYO BNY
WHERE 
CAL.ACT_NUMERO_ACTIVO = ACT.ACT_NUM_ACTIVO 
AND INFO.ACT_ID = ACT.ACT_ID
AND INFO.ICO_ID = BNY.ICO_ID 
MINUS
SELECT 
CAL.ACT_NUMERO_ACTIVO,
BNY.BNY_DUCHA_BANYERA,
BNY.BNY_DUCHA,
BNY.BNY_BANYERA,
BNY.BNY_BANYERA_HIDROMASAJE,
BNY.BNY_COLUMNA_HIDROMASAJE,
BNY.BNY_ALICATADO_MARMOL,
BNY.BNY_ALICATADO_GRANITO,
BNY.BNY_ALICATADO_AZULEJO,
BNY.BNY_ENCIMERA,
BNY.BNY_MARMOL,
BNY.BNY_GRANITO,
BNY.BNY_OTRO_MATERIAL,
BNY.BNY_SANITARIOS,
BNY.BNY_SANITARIOS_EST,
BNY.BNY_SUELOS,
BNY.BNY_GRIFO_MONOMANDO,
BNY.BNY_GRIFO_MONOMANDO_EST,
BNY.BNY_BANYO_OTROS
  FROM    
   '||V_ESQUEMA||'.APR_AUX_CALIDADES_ACTIVOS CAL,
  '||V_ESQUEMA||'.ACT_ACTIVO ACT,
  '||V_ESQUEMA||'.ACT_ICO_INFO_COMERCIAL INFO,
  '||V_ESQUEMA||'.ACT_BNY_BANYO BNY
WHERE 
CAL.ACT_NUMERO_ACTIVO = ACT.ACT_NUM_ACTIVO 
AND INFO.ACT_ID = ACT.ACT_ID
AND INFO.ICO_ID = BNY.ICO_ID 
)
UNION ALL
SELECT ACT_NUMERO_ACTIVO, ''ACT_COC_COCINA'' FROM (
SELECT 
CAL.ACT_NUMERO_ACTIVO,
CAL.COC_AMUEBLADA,
CAL.COC_AMUEBLADA_EST,
CAL.COC_ENCIMERA,
CAL.COC_ENCI_GRANITO,
CAL.COC_ENCI_MARMOL,
CAL.COC_ENCI_OTRO_MATERIAL,
CAL.COC_VITRO,
CAL.COC_LAVADORA,
CAL.COC_FRIGORIFICO,
CAL.COC_LAVAVAJILLAS,
CAL.COC_MICROONDAS,
CAL.COC_HORNO,
CAL.COC_SUELOS,
CAL.COC_AZULEJOS,
CAL.COC_AZULEJOS_EST,
CAL.COC_GRIFOS_MONOMANDO,
CAL.COC_GRIFOS_MONOMANDO_EST,
CAL.COC_COCINA_OTROS
  FROM    
   '||V_ESQUEMA||'.APR_AUX_CALIDADES_ACTIVOS CAL,
  '||V_ESQUEMA||'.ACT_ACTIVO ACT,
  '||V_ESQUEMA||'.ACT_ICO_INFO_COMERCIAL INFO,
  '||V_ESQUEMA||'.ACT_COC_COCINA COC
WHERE 
CAL.ACT_NUMERO_ACTIVO = ACT.ACT_NUM_ACTIVO 
AND INFO.ACT_ID = ACT.ACT_ID
AND INFO.ICO_ID = COC.ICO_ID 
MINUS
SELECT 
CAL.ACT_NUMERO_ACTIVO,
COC.COC_AMUEBLADA,
COC.COC_AMUEBLADA_EST,
COC.COC_ENCIMERA,
COC.COC_ENCI_GRANITO,
COC.COC_ENCI_MARMOL,
COC.COC_ENCI_OTRO_MATERIAL,
COC.COC_VITRO,
COC.COC_LAVADORA,
COC.COC_FRIGORIFICO,
COC.COC_LAVAVAJILLAS,
COC.COC_MICROONDAS,
COC.COC_HORNO,
COC.COC_SUELOS,
COC.COC_AZULEJOS,
COC.COC_AZULEJOS_EST,
COC.COC_GRIFOS_MONOMANDO,
COC.COC_GRIFOS_MONOMANDO_EST,
COC.COC_COCINA_OTROS
  FROM    
   '||V_ESQUEMA||'.APR_AUX_CALIDADES_ACTIVOS CAL,
  '||V_ESQUEMA||'.ACT_ACTIVO ACT,
  '||V_ESQUEMA||'.ACT_ICO_INFO_COMERCIAL INFO,
  '||V_ESQUEMA||'.ACT_COC_COCINA COC
WHERE 
CAL.ACT_NUMERO_ACTIVO = ACT.ACT_NUM_ACTIVO 
AND INFO.ACT_ID = ACT.ACT_ID
AND INFO.ICO_ID = COC.ICO_ID 
)'
;

COMMIT;
/************************FIN DE LLENADO DE TABLA TEMPORAL DE ACTIVOS CON CAMBIOS DESDE FICHERO*********************/

--DBMS_OUTPUT.PUT_LINE(ACTIVOS_CON_CAMBIOS);

EXECUTE IMMEDIATE ACTIVOS_CON_CAMBIOS;

OPEN SEQ_CALIDADES;
    FETCH SEQ_CALIDADES INTO
    CAL_ROWID,
    ACT_NUMERO_ACTIVO,
    INFO_ICO_ID,
CRI_ICO_ID,
CRE_ICO_ID,
PRV_ICO_ID,
SOL_ICO_ID,
INF_ICO_ID,
ZCO_ICO_ID,
INS_ICO_ID,
BNY_ICO_ID,
COC_ICO_ID,
CRI_PTA_ENT_NORMAL,
  CRI_PTA_ENT_BLINDADA,
  CRI_PTA_ENT_ACORAZADA,
  CRI_PTA_PASO_MACIZAS,
  CRI_PTA_PASO_HUECAS,
  CRI_PTA_PASO_LACADAS,
  CRI_ARMARIOS_EMPOTRADOS,
  CRI_CRP_INT_OTROS,
  CRE_VTNAS_HIERRO,
  CRE_VTNAS_ALU_ANODIZADO,
  CRE_VTNAS_ALU_LACADO,
  CRE_VTNAS_PVC,
  CRE_VTNAS_MADERA,
  CRE_PERS_PLASTICO,
  CRE_PERS_ALU,
  CRE_VTNAS_CORREDERAS,
  CRE_VTNAS_ABATIBLES,
  CRE_VTNAS_OSCILOBAT,
  CRE_DOBLE_CRISTAL,
  CRE_EST_DOBLE_CRISTAL,
  CRE_CRP_EXT_OTROS,
  PRV_HUMEDAD_PARED,
  PRV_HUMEDAD_TECHO,
  PRV_GRIETA_PARED,
  PRV_GRIETA_TECHO,
  PRV_GOTELE,
  PRV_PLASTICA_LISA,
  PRV_PAPEL_PINTADO,
  PRV_PINTURA_LISA_TECHO,
  PRV_PINTURA_LISA_TECHO_EST,
  PRV_MOLDURA_ESCAYOLA,
  PRV_MOLDURA_ESCAYOLA_EST,
  PRV_PARAMENTOS_OTROS,
  SOL_TARIMA_FLOTANTE,
  SOL_PARQUE,
  SOL_MARMOL,
  SOL_PLAQUETA,
  SOL_SOLADO_OTROS,
  INF_OCIO,
  INF_HOTELES,
  INF_HOTELES_DESC,
  INF_TEATROS,
  INF_TEATROS_DESC,
  INF_SALAS_CINE,
  INF_SALAS_CINE_DESC,
  INF_INST_DEPORT,
  INF_INST_DEPORT_DESC,
  INF_CENTROS_COMERC,
  INF_CENTROS_COMERC_DESC,
  INF_OCIO_OTROS,
  INF_CENTROS_EDU,
  INF_ESCUELAS_INF,
  INF_ESCUELAS_INF_DESC,
  INF_COLEGIOS,
  INF_COLEGIOS_DESC,
  INF_INSTITUTOS,
  INF_INSTITUTOS_DESC,
  INF_UNIVERSIDADES,
  INF_UNIVERSIDADES_DESC,
  INF_CENTROS_EDU_OTROS,
  INF_CENTROS_SANIT,
  INF_CENTROS_SALUD,
  INF_CENTROS_SALUD_DESC,
  INF_CLINICAS,
  INF_CLINICAS_DESC,
  INF_HOSPITALES,
  INF_HOSPITALES_DESC,
  INF_CENTROS_SANIT_OTROS,
  INF_PARKING_SUP_SUF,
  INF_COMUNICACIONES,
  INF_FACIL_ACCESO,
  INF_FACIL_ACCESO_DESC,
  INF_LINEAS_BUS,
  INF_LINEAS_BUS_DESC,
  INF_METRO,
  INF_METRO_DESC,
  INF_EST_TREN,
  INF_EST_TREN_DESC,
  INF_COMUNICACIONES_OTRO,
  ZCO_ZONAS_COMUNES,
  ZCO_JARDINES,
  ZCO_PISCINA,
  ZCO_INST_DEP,
  ZCO_PADEL,
  ZCO_TENIS,
  ZCO_PISTA_POLIDEP,
  ZCO_OTROS,
  ZCO_ZONA_INFANTIL,
  ZCO_CONSERJE_VIGILANCIA,
  ZCO_GIMNASIO,
  ZCO_ZONA_COMUN_OTROS,
  INS_ELECTR,
  INS_ELECTR_CON_CONTADOR,
  INS_ELECTR_BUEN_ESTADO,
  INS_ELECTR_DEFECTUOSA_ANTIGUA,
  INS_AGUA,
  INS_AGUA_CON_CONTADOR,
  INS_AGUA_BUEN_ESTADO,
  INS_AGUA_DEFECTUOSA_ANTIGUA,
  INS_AGUA_CALIENTE_CENTRAL,
  INS_AGUA_CALIENTE_GAS_NATURAL,
  INS_GAS,
  INS_GAS_CON_CONTADOR,
  INS_GAS_INST_BUEN_ESTADO,
  INS_GAS_DEFECTUOSA_ANTIGUA,
  INS_CALEF,
  INS_CALEF_CENTRAL,
  INS_CALEF_GAS_NATURAL,
  INS_CALEF_RADIADORES_ALU,
  INS_CALEF_PREINSTALACION,
  INS_AIRE,
  INS_AIRE_PREINSTALACION,
  INS_AIRE_INSTALACION,
  INS_AIRE_FRIO_CALOR,
  INS_INST_OTROS,
  BNY_DUCHA_BANYERA,
  BNY_DUCHA,
  BNY_BANYERA,
  BNY_BANYERA_HIDROMASAJE,
  BNY_COLUMNA_HIDROMASAJE,
  BNY_ALICATADO_MARMOL,
  BNY_ALICATADO_GRANITO,
  BNY_ALICATADO_AZULEJO,
  BNY_ENCIMERA,
  BNY_MARMOL,
  BNY_GRANITO,
  BNY_OTRO_MATERIAL,
  BNY_SANITARIOS,
  BNY_SANITARIOS_EST,
  BNY_SUELOS,
  BNY_GRIFO_MONOMANDO,
  BNY_GRIFO_MONOMANDO_EST,
  BNY_BANYO_OTROS,
  COC_AMUEBLADA,
  COC_AMUEBLADA_EST,
  COC_ENCIMERA,
  COC_ENCI_GRANITO,
  COC_ENCI_MARMOL,
  COC_ENCI_OTRO_MATERIAL,
  COC_VITRO,
  COC_LAVADORA,
  COC_FRIGORIFICO,
  COC_LAVAVAJILLAS,
  COC_MICROONDAS,
  COC_HORNO,
  COC_SUELOS,
  COC_AZULEJOS,
  COC_AZULEJOS_EST,
  COC_GRIFOS_MONOMANDO,
  COC_GRIFOS_MONOMANDO_EST,
  COC_COCINA_OTROS
    ;
    WHILE SEQ_CALIDADES%found
    LOOP
    
 P_TEXTO := 'INFO: EL PROCESO DE ACTUALIZACIÓN DE CALIDADES-ACTIVOS HA FINALIZADO CORRECTAMENTE';

 --DBMS_OUTPUT.PUT_LINE(INFO_ICO_ID);
 
IF CRI_ICO_ID IS NULL THEN
 
--DBMS_OUTPUT.PUT_LINE('INSERTAMOS LOS DATOS CALIDADES EN LA TABLA ACT_CRI_CARPINTERIA_INT, ICO -> '||INFO_ICO_ID||'');

 ---- INSERTAMOS EN ACT_CRI_CARPINTERIA_INT - CALIDADES ACTIVO 

V_CRI_INS := 'INSERT INTO '||V_ESQUEMA||'.ACT_CRI_CARPINTERIA_INT (
CRI_ID,
ICO_ID,
DD_ACR_ID,
CRI_PTA_ENT_NORMAL,
CRI_PTA_ENT_BLINDADA,
CRI_PTA_ENT_ACORAZADA,
CRI_PTA_PASO_MACIZAS,
CRI_PTA_PASO_HUECAS,
CRI_PTA_PASO_LACADAS,
CRI_ARMARIOS_EMPOTRADOS,
CRI_CRP_INT_OTROS,
 USUARIOCREAR, 
 FECHACREAR )
  VALUES ('||V_ESQUEMA||'.S_ACT_CRI_CARPINTERIA_INT.NEXTVAL,

(SELECT INFO.ICO_ID FROM '||V_ESQUEMA||'.APR_AUX_DATOS_ACTIVO DAT,
'||V_ESQUEMA||'.APR_AUX_CALIDADES_ACTIVOS CAL,
'||V_ESQUEMA||'.ACT_ACTIVO ACT,
'||V_ESQUEMA||'.ACT_ICO_INFO_COMERCIAL INFO
WHERE CAL.ACT_NUMERO_ACTIVO = DAT.ACT_NUMERO_ACTIVO
AND DAT.ACT_NUMERO_ACTIVO = ACT.ACT_NUM_ACTIVO
AND ACT.ACT_ID = INFO.ACT_ID
AND DAT.ACT_NUMERO_ACTIVO = '||ACT_NUMERO_ACTIVO||'),

(SELECT ACR.DD_ACR_ID FROM '||V_ESQUEMA||'.APR_AUX_CALIDADES_ACTIVOS CAL,
    '||V_ESQUEMA||'.DD_ACR_ACABADO_CARPINTERIA ACR
WHERE CAL.TIPO_ACABADO_CARPINTERIA   =  ACR.DD_ACR_CODIGO
AND   CAL.ACT_NUMERO_ACTIVO = '||ACT_NUMERO_ACTIVO||'),

'''||CRI_PTA_ENT_NORMAL||''',
'''||CRI_PTA_ENT_BLINDADA||''',
'''||CRI_PTA_ENT_ACORAZADA||''',
'''||CRI_PTA_PASO_MACIZAS||''',
'''||CRI_PTA_PASO_HUECAS||''',
'''||CRI_PTA_PASO_LACADAS||''',
'''||CRI_ARMARIOS_EMPOTRADOS||''',
'''||REPLACE(CRI_CRP_INT_OTROS,'''','''''')||''',
   ''ACT_UVEM'',
   SYSDATE
   )';

--DBMS_OUTPUT.PUT_LINE(V_CRI_INS);

  EXECUTE IMMEDIATE V_CRI_INS;
  
  NEW_CRI := NEW_CRI + 1;

ELSE 

--DBMS_OUTPUT.PUT_LINE('ACTUALIZAMOS EN LA TABLA ACT_CRI_CARPINTERIA_INT, CON ICO  -> '||INFO_ICO_ID||'');



---------COMPROBAMOS LAS FILAS CON DATOS NUEVOS PROVENIENTES DEL FICHERO PARA ACTUALIZAR SÓLO ESOS REGISTROS----------

REG_CRI := 'SELECT COUNT(1) FROM '||V_ESQUEMA||'.APR_AUX_UPDATE_ACTIVOS
WHERE ACT_NUMERO_ACTIVO = '||ACT_NUMERO_ACTIVO||'
AND TABLA = ''ACT_CRI_CARPINTERIA_INT''
';

  
  --DBMS_OUTPUT.PUT_LINE(REG_CRI);
  
  EXECUTE IMMEDIATE REG_CRI INTO R_CRI;

  IF R_CRI > 0 THEN



---ACTUALIZAMOS ACT_CRI_CARPINTERIA_INT - CALIDADES ACTIVO

V_MSQL_CRI := 'UPDATE '||V_ESQUEMA||'.ACT_CRI_CARPINTERIA_INT
  SET
      DD_ACR_ID = (SELECT ACR.DD_ACR_ID FROM '||V_ESQUEMA||'.APR_AUX_CALIDADES_ACTIVOS CAL,
    '||V_ESQUEMA||'.DD_ACR_ACABADO_CARPINTERIA ACR
WHERE CAL.TIPO_ACABADO_CARPINTERIA   =  ACR.DD_ACR_CODIGO
AND   CAL.ACT_NUMERO_ACTIVO = '||ACT_NUMERO_ACTIVO||'),
      CRI_PTA_ENT_NORMAL = '''||CRI_PTA_ENT_NORMAL||''',
      CRI_PTA_ENT_BLINDADA  = '''||CRI_PTA_ENT_BLINDADA||''',
      CRI_PTA_ENT_ACORAZADA = '''||CRI_PTA_ENT_ACORAZADA||''',
      CRI_PTA_PASO_MACIZAS = '''||CRI_PTA_PASO_MACIZAS||''',
      CRI_PTA_PASO_HUECAS = '''||CRI_PTA_PASO_HUECAS||''',
      CRI_PTA_PASO_LACADAS = '''||CRI_PTA_PASO_LACADAS||''',
      CRI_ARMARIOS_EMPOTRADOS = '''||CRI_ARMARIOS_EMPOTRADOS||''',
      CRI_CRP_INT_OTROS = '''||REPLACE(CRI_CRP_INT_OTROS,'''','''''')||''',
      USUARIOMODIFICAR = ''ACT_UVEM'',
      FECHAMODIFICAR =  SYSDATE
 WHERE ICO_ID = '||INFO_ICO_ID||'';

--DBMS_OUTPUT.PUT_LINE(V_MSQL_CRI);

    EXECUTE IMMEDIATE V_MSQL_CRI;

    
    MODIF_CRI := MODIF_CRI + 1;
    
   END IF;

END IF;



IF CRE_ICO_ID IS NULL THEN

--DBMS_OUTPUT.PUT_LINE('INSERTAMOS LOS DATOS CALIDADES EN LA TABLA ACT_CRE_CARPINTERIA_EXT, ICO -> '||INFO_ICO_ID||'');

 ---- INSERTAMOS EN ACT_CRE_CARPINTERIA_EXT - CALIDADES ACTIVO 

V_CRE_INS := 'INSERT INTO '||V_ESQUEMA||'.ACT_CRE_CARPINTERIA_EXT (
CRE_ID,
ICO_ID,
CRE_VTNAS_HIERRO,
CRE_VTNAS_ALU_ANODIZADO,
CRE_VTNAS_ALU_LACADO,
CRE_VTNAS_PVC,
CRE_VTNAS_MADERA,
CRE_PERS_PLASTICO,
CRE_PERS_ALU,
CRE_VTNAS_CORREDERAS,
CRE_VTNAS_ABATIBLES,
CRE_VTNAS_OSCILOBAT,
CRE_DOBLE_CRISTAL,
CRE_EST_DOBLE_CRISTAL,
CRE_CRP_EXT_OTROS,
USUARIOCREAR, 
 FECHACREAR )
  VALUES ('||V_ESQUEMA||'.S_ACT_CRE_CARPINTERIA_EXT.NEXTVAL,

(SELECT INFO.ICO_ID FROM '||V_ESQUEMA||'.APR_AUX_DATOS_ACTIVO DAT,
'||V_ESQUEMA||'.APR_AUX_CALIDADES_ACTIVOS CAL,
'||V_ESQUEMA||'.ACT_ACTIVO ACT,
'||V_ESQUEMA||'.ACT_ICO_INFO_COMERCIAL INFO
WHERE CAL.ACT_NUMERO_ACTIVO = DAT.ACT_NUMERO_ACTIVO
AND DAT.ACT_NUMERO_ACTIVO = ACT.ACT_NUM_ACTIVO
AND ACT.ACT_ID = INFO.ACT_ID
AND DAT.ACT_NUMERO_ACTIVO = '||ACT_NUMERO_ACTIVO||'),
'''||CRE_VTNAS_HIERRO||''',
'''||CRE_VTNAS_ALU_ANODIZADO||''',
'''||CRE_VTNAS_ALU_LACADO||''',
'''||CRE_VTNAS_PVC||''',
'''||CRE_VTNAS_MADERA||''',
'''||CRE_PERS_PLASTICO||''',
'''||CRE_PERS_ALU||''',
'''||CRE_VTNAS_CORREDERAS||''',
'''||CRE_VTNAS_ABATIBLES||''',
'''||CRE_VTNAS_OSCILOBAT||''',
'''||CRE_DOBLE_CRISTAL||''',
'''||CRE_EST_DOBLE_CRISTAL||''',
'''||REPLACE(CRE_CRP_EXT_OTROS,'''','''''')||''',
   ''ACT_UVEM'',
   SYSDATE
   )';

--DBMS_OUTPUT.PUT_LINE(V_CRE_INS);

  EXECUTE IMMEDIATE V_CRE_INS;
  
  NEW_CRE := NEW_CRE + 1;
 
ELSE

--DBMS_OUTPUT.PUT_LINE('ACTUALIZAMOS EN LA TABLA ACT_CRE_CARPINTERIA_EXT, CON ICO  -> '||INFO_ICO_ID||'');

---------COMPROBAMOS LAS FILAS CON DATOS NUEVOS PROVENIENTES DEL FICHERO PARA ACTUALIZAR SÓLO ESOS REGISTROS----------


  
REG_CRE := 'SELECT COUNT(1) FROM '||V_ESQUEMA||'.APR_AUX_UPDATE_ACTIVOS
WHERE ACT_NUMERO_ACTIVO = '||ACT_NUMERO_ACTIVO||'
AND TABLA = ''ACT_CRE_CARPINTERIA_EXT''
';
  
  EXECUTE IMMEDIATE REG_CRE INTO R_CRE;

  IF R_CRE > 0 THEN



---ACTUALIZAMOS ACT_CRE_CARPINTERIA_EXT - CALIDADES ACTIVO    
    
V_MSQL_CRE := 'UPDATE '||V_ESQUEMA||'.ACT_CRE_CARPINTERIA_EXT
  SET 
      CRE_VTNAS_HIERRO = '''||CRE_VTNAS_HIERRO||''',
      CRE_VTNAS_ALU_ANODIZADO = '''||CRE_VTNAS_ALU_ANODIZADO||''',
      CRE_VTNAS_ALU_LACADO = '''||CRE_VTNAS_ALU_LACADO||''',
      CRE_VTNAS_PVC = '''||CRE_VTNAS_PVC||''',
      CRE_VTNAS_MADERA = '''||CRE_VTNAS_MADERA||''',
      CRE_PERS_PLASTICO = '''||CRE_PERS_PLASTICO||''',
      CRE_PERS_ALU = '''||CRE_PERS_ALU||''',
      CRE_VTNAS_CORREDERAS = '''||CRE_VTNAS_CORREDERAS||''',
      CRE_VTNAS_ABATIBLES = '''||CRE_VTNAS_ABATIBLES||''',
      CRE_VTNAS_OSCILOBAT = '''||CRE_VTNAS_OSCILOBAT||''',
      CRE_DOBLE_CRISTAL = '''||CRE_DOBLE_CRISTAL||''',
      CRE_EST_DOBLE_CRISTAL = '''||CRE_EST_DOBLE_CRISTAL||''',
      CRE_CRP_EXT_OTROS = '''||REPLACE(CRE_CRP_EXT_OTROS,'''','''''')||''',
      USUARIOMODIFICAR = ''ACT_UVEM'',
      FECHAMODIFICAR =  SYSDATE
 WHERE ICO_ID = '||INFO_ICO_ID||'';

--DBMS_OUTPUT.PUT_LINE(V_MSQL_CRE);

    EXECUTE IMMEDIATE V_MSQL_CRE;
    
     MODIF_CRE := MODIF_CRE + 1;
     
     END IF;
  
END IF;




IF PRV_ICO_ID IS NULL THEN

--DBMS_OUTPUT.PUT_LINE('INSERTAMOS LOS DATOS CALIDADES EN LA TABLA ACT_PRV_PARAMENTO_VERTICAL, ICO -> '||INFO_ICO_ID||'');

 ---- INSERTAMOS EN ACT_PRV_PARAMENTO_VERTICAL - CALIDADES ACTIVO 

V_PRV_INS := 'INSERT INTO '||V_ESQUEMA||'.ACT_PRV_PARAMENTO_VERTICAL (
PRV_ID,
ICO_ID,
PRV_HUMEDAD_PARED,
PRV_HUMEDAD_TECHO,
PRV_GRIETA_PARED,
PRV_GRIETA_TECHO,
PRV_GOTELE,
PRV_PLASTICA_LISA,
PRV_PAPEL_PINTADO,
PRV_PINTURA_LISA_TECHO,
PRV_PINTURA_LISA_TECHO_EST,
PRV_MOLDURA_ESCAYOLA,
PRV_MOLDURA_ESCAYOLA_EST,
PRV_PARAMENTOS_OTROS,
USUARIOCREAR, 
 FECHACREAR )
  VALUES ('||V_ESQUEMA||'.S_ACT_PRV_PARAMENTO_VERTICAL.NEXTVAL,

(SELECT INFO.ICO_ID FROM '||V_ESQUEMA||'.APR_AUX_DATOS_ACTIVO DAT,
'||V_ESQUEMA||'.APR_AUX_CALIDADES_ACTIVOS CAL,
'||V_ESQUEMA||'.ACT_ACTIVO ACT,
'||V_ESQUEMA||'.ACT_ICO_INFO_COMERCIAL INFO
WHERE CAL.ACT_NUMERO_ACTIVO = DAT.ACT_NUMERO_ACTIVO
AND DAT.ACT_NUMERO_ACTIVO = ACT.ACT_NUM_ACTIVO
AND ACT.ACT_ID = INFO.ACT_ID
AND DAT.ACT_NUMERO_ACTIVO = '||ACT_NUMERO_ACTIVO||'),
'''||PRV_HUMEDAD_PARED||''',
'''||PRV_HUMEDAD_TECHO||''',
'''||PRV_GRIETA_PARED||''',
'''||PRV_GRIETA_TECHO||''',
'''||PRV_GOTELE||''',
'''||PRV_PLASTICA_LISA||''',
'''||PRV_PAPEL_PINTADO||''',
'''||PRV_PINTURA_LISA_TECHO||''',
'''||PRV_PINTURA_LISA_TECHO_EST||''',
'''||PRV_MOLDURA_ESCAYOLA||''',
'''||PRV_MOLDURA_ESCAYOLA_EST||''',
'''||REPLACE(PRV_PARAMENTOS_OTROS,'''','''''')||''',
   ''ACT_UVEM'',
   SYSDATE
   )';

--DBMS_OUTPUT.PUT_LINE(V_PRV_INS);

  EXECUTE IMMEDIATE V_PRV_INS;
  
  NEW_PRV := NEW_PRV + 1;

ELSE

---------COMPROBAMOS LAS FILAS CON DATOS NUEVOS PROVENIENTES DEL FICHERO PARA ACTUALIZAR SÓLO ESOS REGISTROS----------

REG_PRV := 'SELECT COUNT(1) FROM '||V_ESQUEMA||'.APR_AUX_UPDATE_ACTIVOS
WHERE ACT_NUMERO_ACTIVO = '||ACT_NUMERO_ACTIVO||'
AND TABLA = ''ACT_PRV_PARAMENTO_VERTICAL''
';
  
  EXECUTE IMMEDIATE REG_PRV INTO R_PRV;

  IF R_PRV > 0 THEN

---ACTUALIZAMOS ACT_PRV_PARAMENTO_VERTICAL - CALIDADES ACTIVO    
    
V_MSQL_PRV := 'UPDATE '||V_ESQUEMA||'.ACT_PRV_PARAMENTO_VERTICAL
  SET 
      PRV_HUMEDAD_PARED = '''||PRV_HUMEDAD_PARED||''',
      PRV_HUMEDAD_TECHO = '''||PRV_HUMEDAD_TECHO||''',
      PRV_GRIETA_PARED = '''||PRV_GRIETA_PARED||''',
      PRV_GRIETA_TECHO = '''||PRV_GRIETA_TECHO||''',
      PRV_GOTELE = '''||PRV_GOTELE||''',
      PRV_PLASTICA_LISA = '''||PRV_PLASTICA_LISA||''',
      PRV_PAPEL_PINTADO = '''||PRV_PAPEL_PINTADO||''',
      PRV_PINTURA_LISA_TECHO = '''||PRV_PINTURA_LISA_TECHO||''',
      PRV_PINTURA_LISA_TECHO_EST = '''||PRV_PINTURA_LISA_TECHO_EST||''',
      PRV_MOLDURA_ESCAYOLA = '''||PRV_MOLDURA_ESCAYOLA||''',
      PRV_MOLDURA_ESCAYOLA_EST = '''||PRV_MOLDURA_ESCAYOLA_EST||''',
      PRV_PARAMENTOS_OTROS = '''||REPLACE(PRV_PARAMENTOS_OTROS,'''','''''')||''',
      USUARIOMODIFICAR = ''ACT_UVEM'',
      FECHAMODIFICAR =  SYSDATE
 WHERE ICO_ID = '||INFO_ICO_ID||'';

--DBMS_OUTPUT.PUT_LINE(V_MSQL_PRV);

    EXECUTE IMMEDIATE V_MSQL_PRV;
    
    MODIF_PRV := MODIF_PRV + 1;
    
    END IF;

END IF;



IF SOL_ICO_ID IS NULL THEN

---- INSERTAMOS EN ACT_SOL_SOLADO - CALIDADES ACTIVO 

V_SOL_INS := 'INSERT INTO '||V_ESQUEMA||'.ACT_SOL_SOLADO (
SOL_ID,
ICO_ID,
SOL_TARIMA_FLOTANTE,
SOL_PARQUE,
SOL_MARMOL,
SOL_PLAQUETA,
SOL_SOLADO_OTROS,
USUARIOCREAR, 
 FECHACREAR )
  VALUES ('||V_ESQUEMA||'.S_ACT_SOL_SOLADO.NEXTVAL,

(SELECT INFO.ICO_ID FROM '||V_ESQUEMA||'.APR_AUX_DATOS_ACTIVO DAT,
'||V_ESQUEMA||'.APR_AUX_CALIDADES_ACTIVOS CAL,
'||V_ESQUEMA||'.ACT_ACTIVO ACT,
'||V_ESQUEMA||'.ACT_ICO_INFO_COMERCIAL INFO
WHERE CAL.ACT_NUMERO_ACTIVO = DAT.ACT_NUMERO_ACTIVO
AND DAT.ACT_NUMERO_ACTIVO = ACT.ACT_NUM_ACTIVO
AND ACT.ACT_ID = INFO.ACT_ID
AND DAT.ACT_NUMERO_ACTIVO = '||ACT_NUMERO_ACTIVO||'),
'''||SOL_TARIMA_FLOTANTE||''',
'''||SOL_PARQUE||''',
'''||SOL_MARMOL||''',
'''||SOL_PLAQUETA||''',
'''||REPLACE(SOL_SOLADO_OTROS,'''','''''')||''',
   ''ACT_UVEM'',
   SYSDATE
   )';

--DBMS_OUTPUT.PUT_LINE(V_SOL_INS);

  EXECUTE IMMEDIATE V_SOL_INS;
  
      NEW_SOL := NEW_SOL + 1;

ELSE


---------COMPROBAMOS LAS FILAS CON DATOS NUEVOS PROVENIENTES DEL FICHERO PARA ACTUALIZAR SÓLO ESOS REGISTROS----------

REG_SOL := 'SELECT COUNT(1) FROM '||V_ESQUEMA||'.APR_AUX_UPDATE_ACTIVOS
WHERE ACT_NUMERO_ACTIVO = '||ACT_NUMERO_ACTIVO||'
AND TABLA = ''ACT_SOL_SOLADO''
';
  
  EXECUTE IMMEDIATE REG_SOL INTO R_SOL;

  IF R_SOL > 0 THEN

 ---ACTUALIZAMOS ACT_SOL_SOLADO - CALIDADES ACTIVO    
    
V_MSQL_SOL := 'UPDATE '||V_ESQUEMA||'.ACT_SOL_SOLADO
  SET 
      SOL_TARIMA_FLOTANTE = '''||SOL_TARIMA_FLOTANTE||''',
      SOL_PARQUE = '''||SOL_PARQUE||''',
      SOL_MARMOL = '''||SOL_MARMOL||''',
      SOL_PLAQUETA = '''||SOL_PLAQUETA||''',
      SOL_SOLADO_OTROS = '''||REPLACE(SOL_SOLADO_OTROS,'''','''''')||''',
      USUARIOMODIFICAR = ''ACT_UVEM'',
      FECHAMODIFICAR =  SYSDATE
 WHERE ICO_ID = '||INFO_ICO_ID||'';


--DBMS_OUTPUT.PUT_LINE(V_MSQL_SOL);

    EXECUTE IMMEDIATE V_MSQL_SOL;
    
     MODIF_SOL := MODIF_SOL + 1;
     
     END IF;

END IF;

IF INF_ICO_ID IS NULL THEN

---- INSERTAMOS EN ACT_INF_INFRAESTRUCTURA - CALIDADES ACTIVO 

V_INF_INS := 'INSERT INTO '||V_ESQUEMA||'.ACT_INF_INFRAESTRUCTURA (
INF_ID,
ICO_ID,
INF_OCIO,
INF_HOTELES,
INF_HOTELES_DESC,
INF_TEATROS,
INF_TEATROS_DESC,
INF_SALAS_CINE,
INF_SALAS_CINE_DESC,
INF_INST_DEPORT,
INF_INST_DEPORT_DESC,
INF_CENTROS_COMERC,
INF_CENTROS_COMERC_DESC,
INF_OCIO_OTROS,
INF_CENTROS_EDU,
INF_ESCUELAS_INF,
INF_ESCUELAS_INF_DESC,
INF_COLEGIOS,
INF_COLEGIOS_DESC,
INF_INSTITUTOS,
INF_INSTITUTOS_DESC,
INF_UNIVERSIDADES,
INF_UNIVERSIDADES_DESC,
INF_CENTROS_EDU_OTROS,
INF_CENTROS_SANIT,
INF_CENTROS_SALUD,
INF_CENTROS_SALUD_DESC,
INF_CLINICAS,
INF_CLINICAS_DESC,
INF_HOSPITALES,
INF_HOSPITALES_DESC,
INF_CENTROS_SANIT_OTROS,
INF_PARKING_SUP_SUF,
INF_COMUNICACIONES,
INF_FACIL_ACCESO,
INF_FACIL_ACCESO_DESC,
INF_LINEAS_BUS,
INF_LINEAS_BUS_DESC,
INF_METRO,
INF_METRO_DESC,
INF_EST_TREN,
INF_EST_TREN_DESC,
INF_COMUNICACIONES_OTRO,
USUARIOCREAR, 
 FECHACREAR )
  VALUES ('||V_ESQUEMA||'.S_ACT_INF_INFRAESTRUCTURA.NEXTVAL,

(SELECT INFO.ICO_ID FROM '||V_ESQUEMA||'.APR_AUX_DATOS_ACTIVO DAT,
'||V_ESQUEMA||'.APR_AUX_CALIDADES_ACTIVOS CAL,
'||V_ESQUEMA||'.ACT_ACTIVO ACT,
'||V_ESQUEMA||'.ACT_ICO_INFO_COMERCIAL INFO
WHERE CAL.ACT_NUMERO_ACTIVO = DAT.ACT_NUMERO_ACTIVO
AND DAT.ACT_NUMERO_ACTIVO = ACT.ACT_NUM_ACTIVO
AND ACT.ACT_ID = INFO.ACT_ID
AND DAT.ACT_NUMERO_ACTIVO = '||ACT_NUMERO_ACTIVO||'),
'''||INF_OCIO||''',
'''||INF_HOTELES||''',
'''||REPLACE(INF_HOTELES_DESC,'''','''''')||''',
'''||INF_TEATROS||''',
'''||REPLACE(INF_TEATROS_DESC,'''','''''')||''',
'''||INF_SALAS_CINE||''',
'''||REPLACE(INF_SALAS_CINE_DESC,'''','''''')||''',
'''||INF_INST_DEPORT||''',
'''||REPLACE(INF_INST_DEPORT_DESC,'''','''''')||''',
'''||INF_CENTROS_COMERC||''',
'''||REPLACE(INF_CENTROS_COMERC_DESC,'''','''''')||''',
'''||REPLACE(INF_OCIO_OTROS,'''','''''')||''',
'''||INF_CENTROS_EDU||''',
'''||INF_ESCUELAS_INF||''',
'''||REPLACE(INF_ESCUELAS_INF_DESC,'''','''''')||''',
'''||INF_COLEGIOS||''',
'''||REPLACE(INF_COLEGIOS_DESC,'''','''''')||''',
'''||INF_INSTITUTOS||''',
'''||REPLACE(INF_INSTITUTOS_DESC,'''','''''')||''',
'''||INF_UNIVERSIDADES||''',
'''||REPLACE(INF_UNIVERSIDADES_DESC,'''','''''')||''',
'''||REPLACE(INF_CENTROS_EDU_OTROS,'''','''''')||''',
'''||INF_CENTROS_SANIT||''',
'''||INF_CENTROS_SALUD||''',
'''||REPLACE(INF_CENTROS_SALUD_DESC,'''','''''')||''',
'''||INF_CLINICAS||''',
'''||REPLACE(INF_CLINICAS_DESC,'''','''''')||''',
'''||INF_HOSPITALES||''',
'''||REPLACE(INF_HOSPITALES_DESC,'''','''''')||''',
'''||REPLACE(INF_CENTROS_SANIT_OTROS,'''','''''')||''',
'''||INF_PARKING_SUP_SUF||''',
'''||INF_COMUNICACIONES||''',
'''||INF_FACIL_ACCESO||''',
'''||REPLACE(INF_FACIL_ACCESO_DESC,'''','''''')||''',
'''||INF_LINEAS_BUS||''',
'''||REPLACE(INF_LINEAS_BUS_DESC,'''','''''')||''',
'''||INF_METRO||''',
'''||REPLACE(INF_METRO_DESC,'''','''''')||''',
'''||INF_EST_TREN||''',
'''||REPLACE(INF_EST_TREN_DESC,'''','''''')||''',
'''||REPLACE(INF_COMUNICACIONES_OTRO,'''','''''')||''',
   ''ACT_UVEM'',
   SYSDATE
   )';

--DBMS_OUTPUT.PUT_LINE(V_INF_INS);

  EXECUTE IMMEDIATE V_INF_INS;
  
  NEW_INF := NEW_INF + 1;
 
 ELSE 
 
 ---------COMPROBAMOS LAS FILAS CON DATOS NUEVOS PROVENIENTES DEL FICHERO PARA ACTUALIZAR SÓLO ESOS REGISTROS----------

REG_INF := 'SELECT COUNT(1) FROM '||V_ESQUEMA||'.APR_AUX_UPDATE_ACTIVOS
WHERE ACT_NUMERO_ACTIVO = '||ACT_NUMERO_ACTIVO||'
AND TABLA = ''ACT_INF_INFRAESTRUCTURA''
';
  
   
  
  EXECUTE IMMEDIATE REG_INF INTO R_INF;

  IF R_INF > 0 THEN
 
 ---ACTUALIZAMOS ACT_INF_INFRAESTRUCTURA - CALIDADES ACTIVO    
    
V_MSQL_INF := 'UPDATE '||V_ESQUEMA||'.ACT_INF_INFRAESTRUCTURA
  SET 
      INF_OCIO = '''||INF_OCIO||''',
      INF_HOTELES = '''||INF_HOTELES||''',
      INF_HOTELES_DESC = '''||REPLACE(INF_HOTELES_DESC,'''','''''')||''',
      INF_TEATROS = '''||INF_TEATROS||''',
      INF_TEATROS_DESC = '''||REPLACE(INF_TEATROS_DESC,'''','''''')||''',
      INF_SALAS_CINE = '''||INF_SALAS_CINE||''',
      INF_SALAS_CINE_DESC = '''||REPLACE(INF_SALAS_CINE_DESC,'''','''''')||''',
      INF_INST_DEPORT = '''||INF_INST_DEPORT||''',
      INF_INST_DEPORT_DESC = '''||REPLACE(INF_INST_DEPORT_DESC,'''','''''')||''',
      INF_CENTROS_COMERC = '''||INF_CENTROS_COMERC||''',
      INF_CENTROS_COMERC_DESC = '''||REPLACE(INF_CENTROS_COMERC_DESC,'''','''''')||''',
      INF_OCIO_OTROS = '''||REPLACE(INF_OCIO_OTROS,'''','''''')||''',
      INF_CENTROS_EDU = '''||INF_CENTROS_EDU||''',
      INF_ESCUELAS_INF = '''||INF_ESCUELAS_INF||''',
      INF_ESCUELAS_INF_DESC = '''||REPLACE(INF_ESCUELAS_INF_DESC,'''','''''')||''',
      INF_COLEGIOS = '''||INF_COLEGIOS||''',
      INF_COLEGIOS_DESC = '''||REPLACE(INF_COLEGIOS_DESC,'''','''''')||''',
      INF_INSTITUTOS = '''||INF_INSTITUTOS||''',
      INF_INSTITUTOS_DESC = '''||REPLACE(INF_INSTITUTOS_DESC,'''','''''')||''',
      INF_UNIVERSIDADES = '''||INF_UNIVERSIDADES||''',
      INF_UNIVERSIDADES_DESC = '''||REPLACE(INF_UNIVERSIDADES_DESC,'''','''''')||''',
      INF_CENTROS_EDU_OTROS = '''||REPLACE(INF_CENTROS_EDU_OTROS,'''','''''')||''',
      INF_CENTROS_SANIT = '''||INF_CENTROS_SANIT||''',
      INF_CENTROS_SALUD = '''||INF_CENTROS_SALUD||''',
      INF_CENTROS_SALUD_DESC = '''||REPLACE(INF_CENTROS_SALUD_DESC,'''','''''')||''',
      INF_CLINICAS = '''||INF_CLINICAS||''',
      INF_CLINICAS_DESC = '''||REPLACE(INF_CLINICAS_DESC,'''','''''')||''',
      INF_HOSPITALES = '''||INF_HOSPITALES||''',
      INF_HOSPITALES_DESC = '''||REPLACE(INF_HOSPITALES_DESC,'''','''''')||''',
      INF_CENTROS_SANIT_OTROS = '''||REPLACE(INF_CENTROS_SANIT_OTROS,'''','''''')||''',
      INF_PARKING_SUP_SUF = '''||INF_PARKING_SUP_SUF||''',
      INF_COMUNICACIONES = '''||INF_COMUNICACIONES||''',
      INF_FACIL_ACCESO = '''||INF_FACIL_ACCESO||''',
      INF_FACIL_ACCESO_DESC = '''||REPLACE(INF_FACIL_ACCESO_DESC,'''','''''')||''',
      INF_LINEAS_BUS = '''||INF_LINEAS_BUS||''',
      INF_LINEAS_BUS_DESC = '''||REPLACE(INF_LINEAS_BUS_DESC,'''','''''')||''',
      INF_METRO = '''||INF_METRO||''',
      INF_METRO_DESC = '''||REPLACE(INF_METRO_DESC,'''','''''')||''',
      INF_EST_TREN = '''||INF_EST_TREN||''',
      INF_EST_TREN_DESC = '''||REPLACE(INF_EST_TREN_DESC,'''','''''')||''',
      INF_COMUNICACIONES_OTRO  = '''||REPLACE(INF_COMUNICACIONES_OTRO,'''','''''')||''',
      USUARIOMODIFICAR = ''ACT_UVEM'',
      FECHAMODIFICAR =  SYSDATE
 WHERE ICO_ID = '||INFO_ICO_ID||'';



--DBMS_OUTPUT.PUT_LINE(V_MSQL_INF);

    EXECUTE IMMEDIATE V_MSQL_INF;
    
    MODIF_INF := MODIF_INF + 1;
    
    END IF;

END IF;

IF ZCO_ICO_ID IS NULL THEN

 ---- INSERTAMOS EN ACT_ZCO_ZONA_COMUN - CALIDADES ACTIVO 

V_ZCO_INS := 'INSERT INTO '||V_ESQUEMA||'.ACT_ZCO_ZONA_COMUN (
ZCO_ID,
ICO_ID,
ZCO_ZONAS_COMUNES,
ZCO_JARDINES,
ZCO_PISCINA,
ZCO_INST_DEP,
ZCO_PADEL,
ZCO_TENIS,
ZCO_PISTA_POLIDEP,
ZCO_OTROS,
ZCO_ZONA_INFANTIL,
ZCO_CONSERJE_VIGILANCIA,
ZCO_GIMNASIO,
ZCO_ZONA_COMUN_OTROS,
USUARIOCREAR, 
 FECHACREAR )
  VALUES ('||V_ESQUEMA||'.S_ACT_ZCO_ZONA_COMUN.NEXTVAL,

(SELECT INFO.ICO_ID FROM '||V_ESQUEMA||'.APR_AUX_DATOS_ACTIVO DAT,
'||V_ESQUEMA||'.APR_AUX_CALIDADES_ACTIVOS CAL,
'||V_ESQUEMA||'.ACT_ACTIVO ACT,
'||V_ESQUEMA||'.ACT_ICO_INFO_COMERCIAL INFO
WHERE CAL.ACT_NUMERO_ACTIVO = DAT.ACT_NUMERO_ACTIVO
AND DAT.ACT_NUMERO_ACTIVO = ACT.ACT_NUM_ACTIVO
AND ACT.ACT_ID = INFO.ACT_ID
AND DAT.ACT_NUMERO_ACTIVO = '||ACT_NUMERO_ACTIVO||'),
'''||ZCO_ZONAS_COMUNES||''',
'''||ZCO_JARDINES||''',
'''||ZCO_PISCINA||''',
'''||ZCO_INST_DEP||''',
'''||ZCO_PADEL||''',
'''||ZCO_TENIS||''',
'''||ZCO_PISTA_POLIDEP||''',
'''||REPLACE(ZCO_OTROS,'''','''''')||''',
'''||ZCO_ZONA_INFANTIL||''',
'''||ZCO_CONSERJE_VIGILANCIA||''',
'''||ZCO_GIMNASIO||''',
'''||REPLACE(ZCO_ZONA_COMUN_OTROS,'''','''''')||''',
   ''ACT_UVEM'',
   SYSDATE
   )';

--DBMS_OUTPUT.PUT_LINE(V_ZCO_INS);

  EXECUTE IMMEDIATE V_ZCO_INS;
 
  NEW_ZCO := NEW_ZCO + 1;
 
 ELSE
 
 ---------COMPROBAMOS LAS FILAS CON DATOS NUEVOS PROVENIENTES DEL FICHERO PARA ACTUALIZAR SÓLO ESOS REGISTROS----------

REG_ZCO := 'SELECT COUNT(1) FROM '||V_ESQUEMA||'.APR_AUX_UPDATE_ACTIVOS
WHERE ACT_NUMERO_ACTIVO = '||ACT_NUMERO_ACTIVO||'
AND TABLA = ''ACT_ZCO_ZONA_COMUN''
';
  
  EXECUTE IMMEDIATE REG_ZCO INTO R_ZCO;

  IF R_ZCO > 0 THEN
 
  ---ACTUALIZAMOS ACT_ZCO_ZONA_COMUN - CALIDADES ACTIVO    
    
V_MSQL_ZCO := 'UPDATE '||V_ESQUEMA||'.ACT_ZCO_ZONA_COMUN
  SET 
      ZCO_ZONAS_COMUNES = '''||ZCO_ZONAS_COMUNES||''',
      ZCO_JARDINES = '''||ZCO_JARDINES||''',
      ZCO_PISCINA = '''||ZCO_PISCINA||''',
      ZCO_INST_DEP = '''||ZCO_INST_DEP||''',
      ZCO_PADEL = '''||ZCO_PADEL||''',
      ZCO_TENIS = '''||ZCO_TENIS||''',
      ZCO_PISTA_POLIDEP = '''||ZCO_PISTA_POLIDEP||''',
      ZCO_OTROS = '''||REPLACE(ZCO_OTROS,'''','''''')||''',
      ZCO_ZONA_INFANTIL = '''||ZCO_ZONA_INFANTIL||''',
      ZCO_CONSERJE_VIGILANCIA = '''||ZCO_CONSERJE_VIGILANCIA||''',
      ZCO_GIMNASIO = '''||ZCO_GIMNASIO||''',
      ZCO_ZONA_COMUN_OTROS = '''||REPLACE(ZCO_ZONA_COMUN_OTROS,'''','''''')||''',
      USUARIOMODIFICAR = ''ACT_UVEM'',
      FECHAMODIFICAR =  SYSDATE
 WHERE ICO_ID = '||INFO_ICO_ID||'';


--DBMS_OUTPUT.PUT_LINE(V_MSQL_ZCO);

    EXECUTE IMMEDIATE V_MSQL_ZCO;
    
    MODIF_ZCO := MODIF_ZCO + 1;
    
    END IF;
 
 END IF;
 
 IF INS_ICO_ID IS NULL THEN
 
 ---- INSERTAMOS EN ACT_INS_INSTALACION - CALIDADES ACTIVO 

V_INS_INS := 'INSERT INTO '||V_ESQUEMA||'.ACT_INS_INSTALACION (
INS_ID,
ICO_ID,
INS_ELECTR,
INS_ELECTR_CON_CONTADOR,
INS_ELECTR_BUEN_ESTADO,
INS_ELECTR_DEFECTUOSA_ANTIGUA,
INS_AGUA,
INS_AGUA_CON_CONTADOR,
INS_AGUA_BUEN_ESTADO,
INS_AGUA_DEFECTUOSA_ANTIGUA,
INS_AGUA_CALIENTE_CENTRAL,
INS_AGUA_CALIENTE_GAS_NATURAL,
INS_GAS,
INS_GAS_CON_CONTADOR,
INS_GAS_INST_BUEN_ESTADO,
INS_GAS_DEFECTUOSA_ANTIGUA,
INS_CALEF,
INS_CALEF_CENTRAL,
INS_CALEF_GAS_NATURAL,
INS_CALEF_RADIADORES_ALU,
INS_CALEF_PREINSTALACION,
INS_AIRE,
INS_AIRE_PREINSTALACION,
INS_AIRE_INSTALACION,
INS_AIRE_FRIO_CALOR,
INS_INST_OTROS,
USUARIOCREAR, 
 FECHACREAR )
  VALUES ('||V_ESQUEMA||'.S_ACT_INS_INSTALACION.NEXTVAL,

(SELECT INFO.ICO_ID FROM '||V_ESQUEMA||'.APR_AUX_DATOS_ACTIVO DAT,
'||V_ESQUEMA||'.APR_AUX_CALIDADES_ACTIVOS CAL,
'||V_ESQUEMA||'.ACT_ACTIVO ACT,
'||V_ESQUEMA||'.ACT_ICO_INFO_COMERCIAL INFO
WHERE CAL.ACT_NUMERO_ACTIVO = DAT.ACT_NUMERO_ACTIVO
AND DAT.ACT_NUMERO_ACTIVO = ACT.ACT_NUM_ACTIVO
AND ACT.ACT_ID = INFO.ACT_ID
AND DAT.ACT_NUMERO_ACTIVO = '||ACT_NUMERO_ACTIVO||'),

'''||INS_ELECTR||''',
'''||INS_ELECTR_CON_CONTADOR||''',
'''||INS_ELECTR_BUEN_ESTADO||''',
'''||INS_ELECTR_DEFECTUOSA_ANTIGUA||''',
'''||INS_AGUA||''',
'''||INS_AGUA_CON_CONTADOR||''',
'''||INS_AGUA_BUEN_ESTADO||''',
'''||INS_AGUA_DEFECTUOSA_ANTIGUA||''',
'''||INS_AGUA_CALIENTE_CENTRAL||''',
'''||INS_AGUA_CALIENTE_GAS_NATURAL||''',
'''||INS_GAS||''',
'''||INS_GAS_CON_CONTADOR||''',
'''||INS_GAS_INST_BUEN_ESTADO||''',
'''||INS_GAS_DEFECTUOSA_ANTIGUA||''',
'''||INS_CALEF||''',
'''||INS_CALEF_CENTRAL||''',
'''||INS_CALEF_GAS_NATURAL||''',
'''||INS_CALEF_RADIADORES_ALU||''',
'''||INS_CALEF_PREINSTALACION||''',
'''||INS_AIRE||''',
'''||INS_AIRE_PREINSTALACION||''',
'''||INS_AIRE_INSTALACION||''',
'''||INS_AIRE_FRIO_CALOR||''',
'''||REPLACE(INS_INST_OTROS,'''','''''')||''',
   ''ACT_UVEM'',
   SYSDATE
   )';

--DBMS_OUTPUT.PUT_LINE(V_INS_INS);

  EXECUTE IMMEDIATE V_INS_INS;
  
  NEW_INS := NEW_INS + 1;
 
 ELSE
 
 ---------COMPROBAMOS LAS FILAS CON DATOS NUEVOS PROVENIENTES DEL FICHERO PARA ACTUALIZAR SÓLO ESOS REGISTROS----------

REG_INS := 'SELECT COUNT(1) FROM '||V_ESQUEMA||'.APR_AUX_UPDATE_ACTIVOS
WHERE ACT_NUMERO_ACTIVO = '||ACT_NUMERO_ACTIVO||'
AND TABLA = ''ACT_INS_INSTALACION''
';
  
  EXECUTE IMMEDIATE REG_INS INTO R_INS;

  IF R_INS > 0 THEN
 
  ---ACTUALIZAMOS  ACT_INS_INSTALACION  - CALIDADES ACTIVO    
    
V_MSQL_INS := 'UPDATE '||V_ESQUEMA||'.ACT_INS_INSTALACION
  SET 
      INS_ELECTR = '''||INS_ELECTR||''',
      INS_ELECTR_CON_CONTADOR = '''||INS_ELECTR_CON_CONTADOR||''',
      INS_ELECTR_BUEN_ESTADO = '''||INS_ELECTR_BUEN_ESTADO||''',
      INS_ELECTR_DEFECTUOSA_ANTIGUA = '''||INS_ELECTR_DEFECTUOSA_ANTIGUA||''',
      INS_AGUA = '''||INS_AGUA||''',
      INS_AGUA_CON_CONTADOR = '''||INS_AGUA_CON_CONTADOR||''',
      INS_AGUA_BUEN_ESTADO = '''||INS_AGUA_BUEN_ESTADO||''',
      INS_AGUA_DEFECTUOSA_ANTIGUA = '''||INS_AGUA_DEFECTUOSA_ANTIGUA||''',
      INS_AGUA_CALIENTE_CENTRAL = '''||INS_AGUA_CALIENTE_CENTRAL||''',
      INS_AGUA_CALIENTE_GAS_NATURAL = '''||INS_AGUA_CALIENTE_GAS_NATURAL||''',
      INS_GAS = '''||INS_GAS||''',
      INS_GAS_CON_CONTADOR = '''||INS_GAS_CON_CONTADOR||''',
      INS_GAS_INST_BUEN_ESTADO = '''||INS_GAS_INST_BUEN_ESTADO||''',
      INS_GAS_DEFECTUOSA_ANTIGUA = '''||INS_GAS_DEFECTUOSA_ANTIGUA||''',
      INS_CALEF = '''||INS_CALEF||''',
      INS_CALEF_CENTRAL = '''||INS_CALEF_CENTRAL||''',
      INS_CALEF_GAS_NATURAL = '''||INS_CALEF_GAS_NATURAL||''',
      INS_CALEF_RADIADORES_ALU = '''||INS_CALEF_RADIADORES_ALU||''',
      INS_CALEF_PREINSTALACION = '''||INS_CALEF_PREINSTALACION||''',
      INS_AIRE = '''||INS_AIRE||''',
      INS_AIRE_PREINSTALACION = '''||INS_AIRE_PREINSTALACION||''',
      INS_AIRE_INSTALACION = '''||INS_AIRE_INSTALACION||''',
      INS_AIRE_FRIO_CALOR = '''||INS_AIRE_FRIO_CALOR||''',
      INS_INST_OTROS = '''||REPLACE(INS_INST_OTROS,'''','''''')||''',
      USUARIOMODIFICAR = ''ACT_UVEM'',
      FECHAMODIFICAR =  SYSDATE
 WHERE ICO_ID = '||INFO_ICO_ID||'';


--DBMS_OUTPUT.PUT_LINE(V_MSQL_INS);

    EXECUTE IMMEDIATE V_MSQL_INS;
    
    MODIF_INS := MODIF_INS + 1;
    
    END IF;
    
END IF;

 IF BNY_ICO_ID IS NULL THEN
 
 ---- INSERTAMOS EN ACT_BNY_BANYO  - CALIDADES ACTIVO 

V_BNY_INS := 'INSERT INTO '||V_ESQUEMA||'.ACT_BNY_BANYO (
BNY_ID,
ICO_ID,
BNY_DUCHA_BANYERA,
BNY_DUCHA,
BNY_BANYERA,
BNY_BANYERA_HIDROMASAJE,
BNY_COLUMNA_HIDROMASAJE,
BNY_ALICATADO_MARMOL,
BNY_ALICATADO_GRANITO,
BNY_ALICATADO_AZULEJO,
BNY_ENCIMERA,
BNY_MARMOL,
BNY_GRANITO,
BNY_OTRO_MATERIAL,
BNY_SANITARIOS,
BNY_SANITARIOS_EST,
BNY_SUELOS,
BNY_GRIFO_MONOMANDO,
BNY_GRIFO_MONOMANDO_EST,
BNY_BANYO_OTROS,
USUARIOCREAR, 
 FECHACREAR )
  VALUES ('||V_ESQUEMA||'.S_ACT_BNY_BANYO.NEXTVAL,

(SELECT INFO.ICO_ID FROM '||V_ESQUEMA||'.APR_AUX_DATOS_ACTIVO DAT,
'||V_ESQUEMA||'.APR_AUX_CALIDADES_ACTIVOS CAL,
'||V_ESQUEMA||'.ACT_ACTIVO ACT,
'||V_ESQUEMA||'.ACT_ICO_INFO_COMERCIAL INFO
WHERE CAL.ACT_NUMERO_ACTIVO = DAT.ACT_NUMERO_ACTIVO
AND DAT.ACT_NUMERO_ACTIVO = ACT.ACT_NUM_ACTIVO
AND ACT.ACT_ID = INFO.ACT_ID
AND DAT.ACT_NUMERO_ACTIVO = '||ACT_NUMERO_ACTIVO||'),

'''||BNY_DUCHA_BANYERA||''',
'''||BNY_DUCHA||''',
'''||BNY_BANYERA||''',
'''||BNY_BANYERA_HIDROMASAJE||''',
'''||BNY_COLUMNA_HIDROMASAJE||''',
'''||BNY_ALICATADO_MARMOL||''',
'''||BNY_ALICATADO_GRANITO||''',
'''||BNY_ALICATADO_AZULEJO||''',
'''||BNY_ENCIMERA||''',
'''||BNY_MARMOL||''',
'''||BNY_GRANITO||''',
'''||BNY_OTRO_MATERIAL||''',
'''||BNY_SANITARIOS||''',
'''||BNY_SANITARIOS_EST||''',
'''||BNY_SUELOS||''',
'''||BNY_GRIFO_MONOMANDO||''',
'''||BNY_GRIFO_MONOMANDO_EST||''',
'''||REPLACE(BNY_BANYO_OTROS,'''','''''')||''',
   ''ACT_UVEM'',
   SYSDATE
   )';

--DBMS_OUTPUT.PUT_LINE(V_BNY_INS);

   EXECUTE IMMEDIATE V_BNY_INS;

NEW_BNY := NEW_BNY + 1;
  
  ELSE
  
  ---------COMPROBAMOS LAS FILAS CON DATOS NUEVOS PROVENIENTES DEL FICHERO PARA ACTUALIZAR SÓLO ESOS REGISTROS----------


  
  REG_BNY := 'SELECT COUNT(1) FROM '||V_ESQUEMA||'.APR_AUX_UPDATE_ACTIVOS
WHERE ACT_NUMERO_ACTIVO = '||ACT_NUMERO_ACTIVO||'
AND TABLA = ''ACT_BNY_BANYO''
';
  
  EXECUTE IMMEDIATE REG_BNY INTO R_BNY;

  IF R_BNY > 0 THEN
  
   ---ACTUALIZAMOS ACT_BNY_BANYO   - CALIDADES ACTIVO    
    
V_MSQL_BNY := 'UPDATE '||V_ESQUEMA||'.ACT_BNY_BANYO
  SET 
      BNY_DUCHA_BANYERA = '''||BNY_DUCHA_BANYERA||''',
      BNY_DUCHA = '''||BNY_DUCHA||''',
      BNY_BANYERA = '''||BNY_BANYERA||''',
      BNY_BANYERA_HIDROMASAJE = '''||BNY_BANYERA_HIDROMASAJE||''',
      BNY_COLUMNA_HIDROMASAJE = '''||BNY_COLUMNA_HIDROMASAJE||''',
      BNY_ALICATADO_MARMOL = '''||BNY_ALICATADO_MARMOL||''',
      BNY_ALICATADO_GRANITO = '''||BNY_ALICATADO_GRANITO||''',
      BNY_ALICATADO_AZULEJO = '''||BNY_ALICATADO_AZULEJO||''',
      BNY_ENCIMERA = '''||BNY_ENCIMERA||''',
      BNY_MARMOL = '''||BNY_MARMOL||''',
      BNY_GRANITO = '''||BNY_GRANITO||''',
      BNY_OTRO_MATERIAL = '''||BNY_OTRO_MATERIAL||''',
      BNY_SANITARIOS = '''||BNY_SANITARIOS||''',
      BNY_SANITARIOS_EST = '''||BNY_SANITARIOS_EST||''',
      BNY_SUELOS = '''||BNY_SUELOS||''',
      BNY_GRIFO_MONOMANDO = '''||BNY_GRIFO_MONOMANDO||''',
      BNY_GRIFO_MONOMANDO_EST = '''||BNY_GRIFO_MONOMANDO_EST||''',
      BNY_BANYO_OTROS = '''||REPLACE(BNY_BANYO_OTROS,'''','''''')||''',
      USUARIOMODIFICAR = ''ACT_UVEM'',
      FECHAMODIFICAR =  SYSDATE
 WHERE ICO_ID = '||INFO_ICO_ID||'';

--DBMS_OUTPUT.PUT_LINE(V_MSQL_BNY);

    EXECUTE IMMEDIATE V_MSQL_BNY;
    
    MODIF_BNY := MODIF_BNY + 1;
    
    END IF;
  
  END IF;

 IF COC_ICO_ID IS NULL THEN

---- INSERTAMOS EN ACT_COC_COCINA   - CALIDADES ACTIVO 

V_COC_INS := 'INSERT INTO '||V_ESQUEMA||'.ACT_COC_COCINA (
COC_ID,
ICO_ID,
COC_AMUEBLADA,
COC_AMUEBLADA_EST,
COC_ENCIMERA,
COC_ENCI_GRANITO,
COC_ENCI_MARMOL,
COC_ENCI_OTRO_MATERIAL,
COC_VITRO,
COC_LAVADORA,
COC_FRIGORIFICO,
COC_LAVAVAJILLAS,
COC_MICROONDAS,
COC_HORNO,
COC_SUELOS,
COC_AZULEJOS,
COC_AZULEJOS_EST,
COC_GRIFOS_MONOMANDO,
COC_GRIFOS_MONOMANDO_EST,
COC_COCINA_OTROS,
USUARIOCREAR, 
 FECHACREAR )
  VALUES ('||V_ESQUEMA||'.S_ACT_COC_COCINA.NEXTVAL,

(SELECT INFO.ICO_ID FROM '||V_ESQUEMA||'.APR_AUX_DATOS_ACTIVO DAT,
'||V_ESQUEMA||'.APR_AUX_CALIDADES_ACTIVOS CAL,
'||V_ESQUEMA||'.ACT_ACTIVO ACT,
'||V_ESQUEMA||'.ACT_ICO_INFO_COMERCIAL INFO
WHERE CAL.ACT_NUMERO_ACTIVO = DAT.ACT_NUMERO_ACTIVO
AND DAT.ACT_NUMERO_ACTIVO = ACT.ACT_NUM_ACTIVO
AND ACT.ACT_ID = INFO.ACT_ID
AND DAT.ACT_NUMERO_ACTIVO = '||ACT_NUMERO_ACTIVO||'),
'''||COC_AMUEBLADA||''',
'''||COC_AMUEBLADA_EST||''',
'''||COC_ENCIMERA||''',
'''||COC_ENCI_GRANITO||''',
'''||COC_ENCI_MARMOL||''',
'''||COC_ENCI_OTRO_MATERIAL||''',
'''||COC_VITRO||''',
'''||COC_LAVADORA||''',
'''||COC_FRIGORIFICO||''',
'''||COC_LAVAVAJILLAS||''',
'''||COC_MICROONDAS||''',
'''||COC_HORNO||''',
'''||COC_SUELOS||''',
'''||COC_AZULEJOS||''',
'''||COC_AZULEJOS_EST||''',
'''||COC_GRIFOS_MONOMANDO||''',
'''||COC_GRIFOS_MONOMANDO_EST||''',
'''||REPLACE(COC_COCINA_OTROS,'''','''''')||''',
   ''ACT_UVEM'',
   SYSDATE
   )';
   
   --DBMS_OUTPUT.PUT_LINE(V_COC_INS);
   
   EXECUTE IMMEDIATE V_COC_INS;
   
       NEW_COC := NEW_COC + 1;

ELSE

---------COMPROBAMOS LAS FILAS CON DATOS NUEVOS PROVENIENTES DEL FICHERO PARA ACTUALIZAR SÓLO ESOS REGISTROS----------

REG_COC := 'SELECT COUNT(1) FROM '||V_ESQUEMA||'.APR_AUX_UPDATE_ACTIVOS
WHERE ACT_NUMERO_ACTIVO = '||ACT_NUMERO_ACTIVO||'
AND TABLA = ''ACT_COC_COCINA''
';
  
  EXECUTE IMMEDIATE REG_COC INTO R_COC;

  IF R_COC > 0 THEN

 ---ACTUALIZAMOS ACT_COC_COCINA   - CALIDADES ACTIVO    
    
V_MSQL_COC := 'UPDATE '||V_ESQUEMA||'.ACT_COC_COCINA
  SET 
      COC_AMUEBLADA = '''||COC_AMUEBLADA||''',
      COC_AMUEBLADA_EST = '''||COC_AMUEBLADA_EST||''',
      COC_ENCIMERA = '''||COC_ENCIMERA||''',
      COC_ENCI_GRANITO = '''||COC_ENCI_GRANITO||''',
      COC_ENCI_MARMOL = '''||COC_ENCI_MARMOL||''',
      COC_ENCI_OTRO_MATERIAL = '''||COC_ENCI_OTRO_MATERIAL||''',
      COC_VITRO = '''||COC_VITRO||''',
      COC_LAVADORA = '''||COC_LAVADORA||''',
      COC_FRIGORIFICO = '''||COC_FRIGORIFICO||''',
      COC_LAVAVAJILLAS = '''||COC_LAVAVAJILLAS||''',
      COC_MICROONDAS = '''||COC_MICROONDAS||''',
      COC_HORNO = '''||COC_HORNO||''',
      COC_SUELOS = '''||COC_SUELOS||''',
      COC_AZULEJOS = '''||COC_AZULEJOS||''',
      COC_AZULEJOS_EST = '''||COC_AZULEJOS_EST||''',
      COC_GRIFOS_MONOMANDO = '''||COC_GRIFOS_MONOMANDO||''',
      COC_GRIFOS_MONOMANDO_EST = '''||COC_GRIFOS_MONOMANDO_EST||''',
      COC_COCINA_OTROS = '''||REPLACE(COC_COCINA_OTROS,'''','''''')||''',
      USUARIOMODIFICAR = ''ACT_UVEM'',
      FECHAMODIFICAR =  SYSDATE
 WHERE ICO_ID = '||INFO_ICO_ID||'';


   --DBMS_OUTPUT.PUT_LINE(V_MSQL_COC);

    EXECUTE IMMEDIATE V_MSQL_COC;
    
        MODIF_COC := MODIF_COC + 1;
        
        END IF;
    
 END IF;





FETCH SEQ_CALIDADES INTO
CAL_ROWID,
ACT_NUMERO_ACTIVO,
   INFO_ICO_ID,
CRI_ICO_ID,
CRE_ICO_ID,
PRV_ICO_ID,
SOL_ICO_ID,
INF_ICO_ID,
ZCO_ICO_ID,
INS_ICO_ID,
BNY_ICO_ID,
COC_ICO_ID,
CRI_PTA_ENT_NORMAL,
  CRI_PTA_ENT_BLINDADA,
  CRI_PTA_ENT_ACORAZADA,
  CRI_PTA_PASO_MACIZAS,
  CRI_PTA_PASO_HUECAS,
  CRI_PTA_PASO_LACADAS,
  CRI_ARMARIOS_EMPOTRADOS,
  CRI_CRP_INT_OTROS,
  CRE_VTNAS_HIERRO,
  CRE_VTNAS_ALU_ANODIZADO,
  CRE_VTNAS_ALU_LACADO,
  CRE_VTNAS_PVC,
  CRE_VTNAS_MADERA,
  CRE_PERS_PLASTICO,
  CRE_PERS_ALU,
  CRE_VTNAS_CORREDERAS,
  CRE_VTNAS_ABATIBLES,
  CRE_VTNAS_OSCILOBAT,
  CRE_DOBLE_CRISTAL,
  CRE_EST_DOBLE_CRISTAL,
  CRE_CRP_EXT_OTROS,
  PRV_HUMEDAD_PARED,
  PRV_HUMEDAD_TECHO,
  PRV_GRIETA_PARED,
  PRV_GRIETA_TECHO,
  PRV_GOTELE,
  PRV_PLASTICA_LISA,
  PRV_PAPEL_PINTADO,
  PRV_PINTURA_LISA_TECHO,
  PRV_PINTURA_LISA_TECHO_EST,
  PRV_MOLDURA_ESCAYOLA,
  PRV_MOLDURA_ESCAYOLA_EST,
  PRV_PARAMENTOS_OTROS,
  SOL_TARIMA_FLOTANTE,
  SOL_PARQUE,
  SOL_MARMOL,
  SOL_PLAQUETA,
  SOL_SOLADO_OTROS,
  INF_OCIO,
  INF_HOTELES,
  INF_HOTELES_DESC,
  INF_TEATROS,
  INF_TEATROS_DESC,
  INF_SALAS_CINE,
  INF_SALAS_CINE_DESC,
  INF_INST_DEPORT,
  INF_INST_DEPORT_DESC,
  INF_CENTROS_COMERC,
  INF_CENTROS_COMERC_DESC,
  INF_OCIO_OTROS,
  INF_CENTROS_EDU,
  INF_ESCUELAS_INF,
  INF_ESCUELAS_INF_DESC,
  INF_COLEGIOS,
  INF_COLEGIOS_DESC,
  INF_INSTITUTOS,
  INF_INSTITUTOS_DESC,
  INF_UNIVERSIDADES,
  INF_UNIVERSIDADES_DESC,
  INF_CENTROS_EDU_OTROS,
  INF_CENTROS_SANIT,
  INF_CENTROS_SALUD,
  INF_CENTROS_SALUD_DESC,
  INF_CLINICAS,
  INF_CLINICAS_DESC,
  INF_HOSPITALES,
  INF_HOSPITALES_DESC,
  INF_CENTROS_SANIT_OTROS,
  INF_PARKING_SUP_SUF,
  INF_COMUNICACIONES,
  INF_FACIL_ACCESO,
  INF_FACIL_ACCESO_DESC,
  INF_LINEAS_BUS,
  INF_LINEAS_BUS_DESC,
  INF_METRO,
  INF_METRO_DESC,
  INF_EST_TREN,
  INF_EST_TREN_DESC,
  INF_COMUNICACIONES_OTRO,
  ZCO_ZONAS_COMUNES,
  ZCO_JARDINES,
  ZCO_PISCINA,
  ZCO_INST_DEP,
  ZCO_PADEL,
  ZCO_TENIS,
  ZCO_PISTA_POLIDEP,
  ZCO_OTROS,
  ZCO_ZONA_INFANTIL,
  ZCO_CONSERJE_VIGILANCIA,
  ZCO_GIMNASIO,
  ZCO_ZONA_COMUN_OTROS,
  INS_ELECTR,
  INS_ELECTR_CON_CONTADOR,
  INS_ELECTR_BUEN_ESTADO,
  INS_ELECTR_DEFECTUOSA_ANTIGUA,
  INS_AGUA,
  INS_AGUA_CON_CONTADOR,
  INS_AGUA_BUEN_ESTADO,
  INS_AGUA_DEFECTUOSA_ANTIGUA,
  INS_AGUA_CALIENTE_CENTRAL,
  INS_AGUA_CALIENTE_GAS_NATURAL,
  INS_GAS,
  INS_GAS_CON_CONTADOR,
  INS_GAS_INST_BUEN_ESTADO,
  INS_GAS_DEFECTUOSA_ANTIGUA,
  INS_CALEF,
  INS_CALEF_CENTRAL,
  INS_CALEF_GAS_NATURAL,
  INS_CALEF_RADIADORES_ALU,
  INS_CALEF_PREINSTALACION,
  INS_AIRE,
  INS_AIRE_PREINSTALACION,
  INS_AIRE_INSTALACION,
  INS_AIRE_FRIO_CALOR,
  INS_INST_OTROS,
  BNY_DUCHA_BANYERA,
  BNY_DUCHA,
  BNY_BANYERA,
  BNY_BANYERA_HIDROMASAJE,
  BNY_COLUMNA_HIDROMASAJE,
  BNY_ALICATADO_MARMOL,
  BNY_ALICATADO_GRANITO,
  BNY_ALICATADO_AZULEJO,
  BNY_ENCIMERA,
  BNY_MARMOL,
  BNY_GRANITO,
  BNY_OTRO_MATERIAL,
  BNY_SANITARIOS,
  BNY_SANITARIOS_EST,
  BNY_SUELOS,
  BNY_GRIFO_MONOMANDO,
  BNY_GRIFO_MONOMANDO_EST,
  BNY_BANYO_OTROS,
  COC_AMUEBLADA,
  COC_AMUEBLADA_EST,
  COC_ENCIMERA,
  COC_ENCI_GRANITO,
  COC_ENCI_MARMOL,
  COC_ENCI_OTRO_MATERIAL,
  COC_VITRO,
  COC_LAVADORA,
  COC_FRIGORIFICO,
  COC_LAVAVAJILLAS,
  COC_MICROONDAS,
  COC_HORNO,
  COC_SUELOS,
  COC_AZULEJOS,
  COC_AZULEJOS_EST,
  COC_GRIFOS_MONOMANDO,
  COC_GRIFOS_MONOMANDO_EST,
  COC_COCINA_OTROS
;
    END LOOP;
    CLOSE SEQ_CALIDADES;
    
COMMIT;


  
  
  
  
  

            DBMS_OUTPUT.PUT_LINE('REGISTROS INSERTADOS EN ACT_CRI_CARPINTERIA_INT : '||NEW_CRI||'');
            
           P_CRI_NEW := 'REGISTROS INSERTADOS EN ACT_CRI_CARPINTERIA_INT : '||NEW_CRI||'';

              DBMS_OUTPUT.PUT_LINE('REGISTROS ACTUALIZADOS EN  ACT_CRI_CARPINTERIA_INT : '||MODIF_CRI||'');
              
              P_CRI_MODIF := 'REGISTROS ACTUALIZADOS EN  ACT_CRI_CARPINTERIA_INT : '||MODIF_CRI||'';

              DBMS_OUTPUT.PUT_LINE('REGISTROS INSERTADOS EN ACT_CRE_CARPINTERIA_EXT : '||NEW_CRE||'');
              
              P_CRE_NEW := 'REGISTROS INSERTADOS EN ACT_CRE_CARPINTERIA_EXT : '||NEW_CRE||'';

              DBMS_OUTPUT.PUT_LINE('REGISTROS ACTUALIZADOS EN ACT_CRE_CARPINTERIA_EXT  : '||MODIF_CRE||'');
              
              P_CRE_MODIF := 'REGISTROS ACTUALIZADOS EN ACT_CRE_CARPINTERIA_EXT  : '||MODIF_CRE||'';
              
              DBMS_OUTPUT.PUT_LINE('REGISTROS INSERTADOS EN ACT_PRV_PARAMENTO_VERTICAL : '||NEW_PRV||'');
              
             P_PRV_NEW := 'REGISTROS INSERTADOS EN ACT_PRV_PARAMENTO_VERTICAL : '||NEW_PRV||'';

              DBMS_OUTPUT.PUT_LINE('REGISTROS ACTUALIZADOS EN ACT_PRV_PARAMENTO_VERTICAL  : '||MODIF_PRV||'');
              
             P_PRV_MODIF := 'REGISTROS ACTUALIZADOS EN ACT_PRV_PARAMENTO_VERTICAL  : '||MODIF_PRV||'';
              
             DBMS_OUTPUT.PUT_LINE('REGISTROS INSERTADOS EN ACT_SOL_SOLADO : '||NEW_SOL||'');
             
           P_SOL_NEW := 'REGISTROS INSERTADOS EN ACT_SOL_SOLADO : '||NEW_SOL||'';

              DBMS_OUTPUT.PUT_LINE('REGISTROS ACTUALIZADOS EN ACT_SOL_SOLADO  : '||MODIF_SOL||'');
              
           P_SOL_MODIF := 'REGISTROS ACTUALIZADOS EN ACT_SOL_SOLADO  : '||MODIF_SOL||'';
                            
             DBMS_OUTPUT.PUT_LINE('REGISTROS INSERTADOS EN ACT_INF_INFRAESTRUCTURA : '||NEW_INF||'');
             
           P_INF_NEW := 'REGISTROS INSERTADOS EN ACT_INF_INFRAESTRUCTURA : '||NEW_INF||'';

              DBMS_OUTPUT.PUT_LINE('REGISTROS ACTUALIZADOS EN  ACT_INF_INFRAESTRUCTURA : '||MODIF_INF||'');
              
              P_INF_MODIF := 'REGISTROS ACTUALIZADOS EN  ACT_INF_INFRAESTRUCTURA : '||MODIF_INF||'';

            DBMS_OUTPUT.PUT_LINE('REGISTROS INSERTADOS EN ACT_ZCO_ZONA_COMUN : '||NEW_ZCO||'');
            
          P_ZCO_NEW := 'REGISTROS INSERTADOS EN ACT_ZCO_ZONA_COMUN : '||NEW_ZCO||'';

              DBMS_OUTPUT.PUT_LINE('REGISTROS ACTUALIZADOS EN ACT_ZCO_ZONA_COMUN  : '||MODIF_ZCO||'');

          P_ZCO_MODIF := 'REGISTROS ACTUALIZADOS EN ACT_ZCO_ZONA_COMUN  : '||MODIF_ZCO||'';

         DBMS_OUTPUT.PUT_LINE('REGISTROS INSERTADOS EN ACT_INS_INSTALACION : '||NEW_INS||'');
         
      P_INS_NEW := 'REGISTROS INSERTADOS EN ACT_INS_INSTALACION : '||NEW_INS||'';

              DBMS_OUTPUT.PUT_LINE('REGISTROS ACTUALIZADOS EN ACT_INS_INSTALACION  : '||MODIF_INS||'');
              
             P_INS_MODIF := 'REGISTROS ACTUALIZADOS EN ACT_INS_INSTALACION  : '||MODIF_INS||'';
              
               DBMS_OUTPUT.PUT_LINE('REGISTROS INSERTADOS EN ACT_BNY_BANYO : '||NEW_BNY||'');
               
               P_BNY_NEW := 'REGISTROS INSERTADOS EN ACT_BNY_BANYO : '||NEW_BNY||'';

              DBMS_OUTPUT.PUT_LINE('REGISTROS ACTUALIZADOS EN ACT_BNY_BANYO  : '||MODIF_BNY||'');
              
              P_BNY_MODIF := 'REGISTROS ACTUALIZADOS EN ACT_BNY_BANYO  : '||MODIF_BNY||'';
              
              DBMS_OUTPUT.PUT_LINE('REGISTROS INSERTADOS EN ACT_COC_COCINA : '||NEW_COC||'');
              
             P_COC_NEW := 'REGISTROS INSERTADOS EN ACT_COC_COCINA : '||NEW_COC||'';

              DBMS_OUTPUT.PUT_LINE('REGISTROS ACTUALIZADOS EN ACT_COC_COCINA  : '||MODIF_COC||'');    
              
              P_COC_MODIF := 'REGISTROS ACTUALIZADOS EN ACT_COC_COCINA  : '||MODIF_COC||'';
              
        
              
              
      


 


 EXCEPTION

 WHEN OTHERS THEN
   err_num := SQLCODE;
   err_msg := SQLERRM;

   DBMS_OUTPUT.put_line('Error:'||TO_CHAR(err_num));
   DBMS_OUTPUT.put_line(err_msg);
   P_TEXTO := 'Error:'||TO_CHAR(err_num)||'['||err_msg||']'; 

   ROLLBACK;
   RAISE;


END SP_UPDATE_CALID_ACTIV_UVEM_REM;

/
