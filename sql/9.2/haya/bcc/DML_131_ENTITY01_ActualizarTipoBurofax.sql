--/*
--##########################################
--## AUTOR=Iván Picazo
--## FECHA_CREACION=20160420
--## ARTEFACTO=online
--## VERSION_ARTEFACTO=9.2
--## INCIDENCIA_LINK=HR-2277
--## PRODUCTO=NO
--## Finalidad: DML para actualizar las plantillas de los burofax
--##           
--## INSTRUCCIONES: Configurar las variables necesarias en el principio del DECLARE
--## VERSIONES:
--##        0.1 Versión inicial
--##########################################
--*/

--Para permitir la visualización de texto en un bloque PL/SQL utilizando DBMS_OUTPUT.PUT_LINE

WHENEVER SQLERROR EXIT SQL.SQLCODE;
SET SERVEROUTPUT ON;
SET DEFINE OFF;

DECLARE
    V_MSQL VARCHAR2(32000 CHAR); -- Sentencia a ejecutar     
    V_ESQUEMA VARCHAR2(25 CHAR):= '#ESQUEMA#'; -- Configuracion Esquema
    V_ESQUEMA_M VARCHAR2(25 CHAR):= '#ESQUEMA_MASTER#'; -- Configuracion Esquema Master
    V_SQL VARCHAR2(4000 CHAR); -- Vble. para consulta que valida la existencia de una tabla.
    V_NUM_TABLAS NUMBER(16); -- Vble. para validar la existencia de una tabla.   
    ERR_NUM NUMBER(25);  -- Vble. auxiliar para registrar errores en el script.
    ERR_MSG VARCHAR2(1024 CHAR); -- Vble. auxiliar para registrar errores en el script.

    V_TEXT1 VARCHAR2(2400 CHAR); -- Vble. auxiliar
    V_ENTIDAD_ID NUMBER(16);
    V_DDNAME VARCHAR2(30):= 'DD_PCO_BFT_TIPO';

    V_INSERT VARCHAR2(2400 CHAR):= 'INSERT INTO ' || V_ESQUEMA || '.' || V_DDNAME || ' (DD_PCO_BFT_ID, DD_PCO_BFT_CODIGO, DD_PCO_BFT_DESCRIPCION, DD_PCO_BFT_DESCRIPCION_LARGA,DD_PCO_BFT_PLANTILLA ,VERSION, USUARIOCREAR, FECHACREAR) VALUES ';
    
BEGIN
	
DBMS_OUTPUT.PUT_LINE('[INICIO] Actualizamos las plantillas');

--Comercio Exterior
V_SQL := 'UPDATE ' || V_ESQUEMA || '.' || V_DDNAME || ' SET DD_PCO_BFT_PLANTILLA = ''EN SU CALIDAD DE ${tipoIntervencion} DE LA PÓLIZA DE CRÉDITO PARA OPERACIONES DE COMERCIO EXTERIOR ' || 
	'No ${CODIGO_DE_CONTRATO}  ${FORMALIZADO} EL DÍA ${FECFORMALIZ} POR UN LÍMITE DE ${CAL_RUT_POLIZA} EUROS, LE NOTIFICAMOS QUE POR INCUMPLIMIENTO DE LAS OBLIGACIONES DE PAGO PACTADAS EN LA MISMA, ' || 
	'HEMOS PROCEDIDO A DETERMINAR EL SALDO DEUDOR, ADEUDÁNDOSE A ${GEN_ENT_N}, LA CANTIDAD DE ${CAPITALCER} EUROS DE PRINCIPAL, ${IMPINTERESTELEG} EUROS DE INTERESES REMUNERATORIOS PACTADOS Y ${DEMORACER} EUROS DE INTERESES MORATORIOS PACTADOS, ' || 
	'ASCENDIENDO EL TOTAL DE LA DEUDA A LA CANTIDAD DE ${IMPCER} EUROS AL DÍA ${FECHA_CIERRE_LIQUIDACION}, IMPORTE CUYO PAGO LE REQUERIMOS A EFECTOS DE LO DISPUESTO EN LOS ARTICULOS 572 Y 573 DE LA ' || 
	'LEY DE ENJUICIAMIENTO CIVIL. <br/><br/>' || 
	'RECUERDE QUE POR EL IMPAGO DE SU DEUDA SUS DATOS PUEDEN SER INCORPORADOS A FICHEROS DE CUMPLIMIENTO O INCUMPLIMIENTO DE OBLIGACIONES DINERARIAS.<br/><br/>' || 
	'LA PRESENTE COMUNICACIÓN ANULA Y DEJA SIN EFECTO CUALQUIER OTRA QUE, RESPECTO DE LA MISMA OPERACIÓN CREDITICIA, Y CON EXPRESIÓN DE CANTIDAD, HUBIESE PODIDO RECIBIR CON ANTERIORIDAD.<br/><br/>' || 
	'${GEN_ENT_N}<br/>${LOCCRD}'' ' ||
' WHERE DD_PCO_BFT_CODIGO LIKE ''BF_COMERCIO_EXTERIOR''';
EXECUTE IMMEDIATE V_SQL;
DBMS_OUTPUT.PUT_LINE('[INICIO] Actualizada la plantilla de Comercio Exterior');


--Aval
V_SQL := 'UPDATE ' || V_ESQUEMA || '.' || V_DDNAME || ' SET DD_PCO_BFT_PLANTILLA = ''EN SU CALIDAD DE ${tipoIntervencion} DE LA POLIZA DE RELEVACION DE FIANZA No ${CODIGO_DE_CONTRATO} ' || 
	'CONCEDIDA CON FECHA ${FECFORMALIZ} POR UN LÍMITE DE ${CAL_RUT_POLIZA} EUROS, LE NOTIFICAMOS QUE POR RAZÓN DE DICHA PÓLIZA Y POR EL INCUMPLIMIENTO DE SUS OBLIGACIONES DE PAGO,  ' || 
	'HEMOS PROCEDIDO A DETERMINAR EL SALDO DEUDOR, ADEUDÁNDOSE A ${GEN_ENT_N}, LA CANTIDAD DE ${CAPITALCER} EUROS DE PRINCIPAL Y ${DEMORACER} EUROS DE INTERESES MORATORIOS PACTADOS,  ' || 
	'ASCENDIENDO EL TOTAL DE LA DEUDA POR LOS CONCEPTOS EXPRESADOS A LA CANTIDAD DE ${IMPCER} EUROS AL DÍA ${FECHA_CIERRE_LIQUIDACION}, IMPORTE CUYO PAGO LE REQUERIMOS A EFECTOS DE LO  ' || 
	'DISPUESTO EN LOS ARTICULOS 572 Y 573 DE LA LEY DE ENJUICIAMIENTO CIVIL. <br/><br/> ' || 
	'RECUERDE QUE POR EL IMPAGO DE SU DEUDA SUS DATOS PUEDEN SER INCORPORADOS A FICHEROS DE CUMPLIMIENTO O INCUMPLIMIENTO DE OBLIGACIONES DINERARIAS.<br/><br/> ' || 
	'LA PRESENTE COMUNICACIÓN ANULA Y DEJA SIN EFECTO CUALQUIER OTRA QUE, RESPECTO DE LA MISMA OPERACIÓN CREDITICIA, Y CON EXPRESIÓN DE CANTIDAD, HUBIESE PODIDO RECIBIR CON ANTERIORIDAD.<br/><br/>' || 
	'${GEN_ENT_N}<br/>${LOCCRD}'' ' ||
' WHERE DD_PCO_BFT_CODIGO LIKE ''BF_AVAL''';
EXECUTE IMMEDIATE V_SQL;
DBMS_OUTPUT.PUT_LINE('[INICIO] Actualizada la plantilla de Aval');

--Descuento de efectos (Cartera)

V_SQL := 'UPDATE ' || V_ESQUEMA || '.' || V_DDNAME || ' SET DD_PCO_BFT_PLANTILLA = ''EN SU CALIDAD DE ${tipoIntervencion} DE LA POLIZA DE  AFIANZAMIENTO Y GARANTÍA DE OPERACIONES MERCANTILES No ${CODIGO_DE_CONTRATO} ' || 
	' ${FORMALIZADO} EL ${FECFORMALIZ} POR UN LÍMITE DE ${CAL_RUT_POLIZA} EUROS, LE NOTIFICAMOS QUE POR RAZÓN DE DICHA PÓLIZA Y ' || 
	'POR EL INCUMPLIMIENTO DE SUS OBLIGACIONES DE PAGO, HEMOS PROCEDIDO A DETERMINAR EL SALDO DEUDOR, ' || 
	'ADEUDÁNDOSE A ${GEN_ENT_N}, LA CANTIDAD DE ${CAPITALCER} EUROS DE PRINCIPAL Y ${DEMORACER} EUROS DE INTERESES MORATORIOS PACTADOS,  ' || 
	'ASCENDIENDO EL TOTAL DE LA DEUDA POR LOS CONCEPTOS EXPRESADOS A LA CANTIDAD DE ${IMPCER} EUROS AL DÍA ${FECHA_CIERRE_LIQUIDACION}, ' || 
	'IMPORTE CUYO PAGO LE REQUERIMOS A EFECTOS DE LO DISPUESTO EN LOS ARTICULOS 572 Y 573 DE LA LEY DE ENJUICIAMIENTO CIVIL. <br/><br/> ' || 
	'RECUERDE QUE POR EL IMPAGO DE SU DEUDA SUS DATOS PUEDEN SER INCORPORADOS A FICHEROS DE CUMPLIMIENTO O INCUMPLIMIENTO DE OBLIGACIONES DINERARIAS.<br/><br/> ' || 
	'LA PRESENTE COMUNICACIÓN ANULA Y DEJA SIN EFECTO CUALQUIER OTRA QUE, RESPECTO DE LA MISMA OPERACIÓN CREDITICIA, Y CON EXPRESIÓN DE CANTIDAD, HUBIESE PODIDO RECIBIR CON ANTERIORIDAD.<br/><br/>' || 
	'${GEN_ENT_N}<br/>${LOCCRD}'' ' ||
	' WHERE DD_PCO_BFT_CODIGO LIKE ''BF_CARTERA''';
EXECUTE IMMEDIATE V_SQL;
DBMS_OUTPUT.PUT_LINE('[INICIO] Actualizada la plantilla de Descuento de efectos (Cartera)');


--Cuenta a la vista (cuenta corriente)
V_SQL := 'SELECT COUNT(*) FROM ' || V_ESQUEMA || '.' || V_DDNAME || ' WHERE DD_PCO_BFT_CODIGO = ''BF_CUENTA_CORRIENTE''';
EXECUTE IMMEDIATE V_SQL INTO V_NUM_TABLAS;

IF V_NUM_TABLAS = 0 THEN
    EXECUTE IMMEDIATE V_INSERT || ' ('||V_ESQUEMA||'.S_DD_PCO_BFT_TIPO.nextval, ''BF_CUENTA_CORRIENTE'', ''Cuenta corriente'', ''Cuenta corriente'',
    ''EN SU CALIDAD DE ${tipoIntervencion} DE LA CUENTA DE AHORRO A LA VISTA / CUENTA CORRIENTE No ${CODIGO_DE_CONTRATO},' || 
	', POR LA PRESENTE LE COMUNICAMOS QUE LA MISMA AL DÍA ${FECHA_CIERRE_LIQUIDACION}, ARROJA UN SALDO DEUDOR DE ${IMPCER} EUROS A FAVOR DE ${GEN_ENT_N}. <br/><br/>' || 
	'LE SOLICITAMOS QUE EN UN PLAZO MÁXIMO DE CINCO DÍAS HÁBILES REGULARICE ESTA SITUACIÓN YA QUE, EN CASO CONTRARIO, PROCEDEREMOS A LA INMEDIATA RECLAMACIÓN JUDICIAL.<br/><br/>' || 
	'RECUERDE QUE POR EL IMPAGO DE SU DEUDA SUS DATOS PUEDEN SER INCORPORADOS A FICHEROS DE CUMPLIMIENTO O INCUMPLIMIENTO DE OBLIGACIONES DINERARIAS.<br/><br/>' || 
	'LA PRESENTE COMUNICACIÓN ANULA Y DEJA SIN EFECTO CUALQUIER OTRA QUE, RESPECTO DE LA MISMA OPERACIÓN CREDITICIA, Y CON EXPRESIÓN DE CANTIDAD, HUBIESE PODIDO RECIBIR CON ANTERIORIDAD.<br/><br/>' || 
	'${GEN_ENT_N}<br/>${LOCCRD}'', 0, ''INICIAL'', sysdate) ';
	DBMS_OUTPUT.PUT_LINE('[INICIO] Creada la plantilla de Cuenta a la vista (cuenta corriente)');
ELSE
	V_SQL := 'UPDATE ' || V_ESQUEMA || '.' || V_DDNAME || ' SET DD_PCO_BFT_PLANTILLA = ''EN SU CALIDAD DE ${tipoIntervencion} DE LA CUENTA DE AHORRO A LA VISTA / CUENTA CORRIENTE No ${CODIGO_DE_CONTRATO},' || 
	', POR LA PRESENTE LE COMUNICAMOS QUE LA MISMA AL DÍA ${FECHA_CIERRE_LIQUIDACION}, ARROJA UN SALDO DEUDOR DE ${IMPCER} EUROS A FAVOR DE ${GEN_ENT_N}. <br/><br/>' || 
	'LE SOLICITAMOS QUE EN UN PLAZO MÁXIMO DE CINCO DÍAS HÁBILES REGULARICE ESTA SITUACIÓN YA QUE, EN CASO CONTRARIO, PROCEDEREMOS A LA INMEDIATA RECLAMACIÓN JUDICIAL.<br/><br/>' || 
	'RECUERDE QUE POR EL IMPAGO DE SU DEUDA SUS DATOS PUEDEN SER INCORPORADOS A FICHEROS DE CUMPLIMIENTO O INCUMPLIMIENTO DE OBLIGACIONES DINERARIAS.<br/><br/>' || 
	'LA PRESENTE COMUNICACIÓN ANULA Y DEJA SIN EFECTO CUALQUIER OTRA QUE, RESPECTO DE LA MISMA OPERACIÓN CREDITICIA, Y CON EXPRESIÓN DE CANTIDAD, HUBIESE PODIDO RECIBIR CON ANTERIORIDAD.<br/><br/>' || 
	'${GEN_ENT_N}<br/>${LOCCRD}'' ' ||
	' WHERE DD_PCO_BFT_CODIGO LIKE ''BF_CUENTA_CORRIENTE''';
	EXECUTE IMMEDIATE V_SQL;
	DBMS_OUTPUT.PUT_LINE('[INICIO] Actualizada la plantilla de Cuenta a la vista (cuenta corriente)');
END IF;

--Crédito
V_SQL := 'UPDATE ' || V_ESQUEMA || '.' || V_DDNAME || ' SET DD_PCO_BFT_PLANTILLA = ''EN SU CALIDAD DE ${tipoIntervencion} DE LA PÓLIZA DE CRÉDITO EN CUENTA ' || 
'CORRIENTE No ${CODIGO_DE_CONTRATO} CONCEDIDA EL DÍA ${FECFORMALIZ} POR UN LÍMITE DE ${CAL_RUT_POLIZA} EUROS, LE NOTIFICAMOS QUE POR INCUMPLIMIENTO DE ' ||
'LAS OBLIGACIONES DE PAGO PACTADAS EN LA MISMA, ${VENCIDOANTICIPADO} ADEUDÁNDOSE A ${GEN_ENT_N}, LA CANTIDAD DE ${CAPITALCER} EUROS CONCEPTO DE CRÉDITO ' ||
'DISPUESTO Y NO DEVUELTO, ${INTERESCER} EUROS DE INTERESES REMUNERATORIOS PACTADOS, ${IMPINTERESTELEG} EUROS DE INTERESES SOBRE CRÉDITO EXCEDIDO DISPUESTO, ' ||
'${IMPCOMITELEG} EUROS DE COMISIONES PACTADAS Y NO PAGADAS Y ${DEMORACER} EUROS DE INTERESES MORATORIOS PACTADOS, ASCENDIENDO EL TOTAL DE LA DEUDA POR LOS ' ||
'CONCEPTOS EXPRESADOS A LA CANTIDAD DE ${FECHA_CIERRE_LIQUIDACION} EUROS AL DÍA ${IMPCER}, IMPORTE CUYO PAGO LE REQUERIMOS A EFECTOS DE LO DISPUESTO EN LOS ' ||
'ARTICULOS 572 Y 573 DE LA LEY DE ENJUICIAMIENTO CIVIL.' ||
'<br/><br/>RECUERDE QUE POR EL IMPAGO DE SU DEUDA SUS DATOS PUEDEN SER INCORPORADOS A FICHEROS DE CUMPLIMIENTO O INCUMPLIMIENTO DE OBLIGACIONES DINERARIAS. ' ||
'<br/><br/>LA PRESENTE COMUNICACIÓN ANULA Y DEJA SIN EFECTO CUALQUIER OTRA QUE, RESPECTO DE LA MISMA OPERACIÓN CREDITICIA, Y CON EXPRESIÓN DE CANTIDAD, HUBIESE ' || 
'PODIDO RECIBIR CON ANTERIORIDAD. <br/><br/>${GEN_ENT_N}<br/>${LOCCRD}'', USUARIOMODIFICAR=''HR-2279'', FECHAMODIFICAR=sysdate ' ||
' WHERE DD_PCO_BFT_CODIGO LIKE ''BF_CREDITO'' ';
EXECUTE IMMEDIATE V_SQL;
DBMS_OUTPUT.PUT_LINE('[INICIO] Actualizada la plantilla de Crédito');


--Prestamo Hipotecario
V_SQL := 'UPDATE ' || V_ESQUEMA || '.' || V_DDNAME || ' SET DD_PCO_BFT_PLANTILLA = ''EN SU CALIDAD DE ${tipoIntervencion} DEL PRESTAMO HIPOTECARIO ' ||
'No ${CODIGO_DE_CONTRATO} ${FORMALIZADO} EL DIA ${FECFORMALIZ} MEDIANTE ESCRITURA PUBLICA ANTE EL NOTARIO ${nombreNotario} POR UN PRINCIPAL DE ${CAL_RUT_POLIZA} EUROS, ' ||
'LE NOTIFICAMOS QUE POR INCUMPLIMIENTO DE LAS OBLIGACIONES DE PAGO PACTADAS, HEMOS DADO POR VENCIDO ANTICIPADAMENTE EL PRÉSTAMO HIPOTECARIO, ' ||
'RESULTANDO UNA DEUDA A FAVOR DE ${GEN_ENT_N}, POR IMPORTE DE ${CAPITALCER} EUROS DE PRINCIPAL, ${INTERESCER} EUROS DE INTERESES REMUNERATORIOS ' ||
'PACTADOS Y ${DEMORACER} EUROS DE INTERESES MORATORIOS PACTADOS, ASCENDIENDO EL TOTAL DE LA DEUDA POR LOS CONCEPTOS EXPRESADOS A LA CANTIDAD ' ||
'DE ${IMPCER} EUROS AL DÍA ${FECHA_CIERRE_LIQUIDACION}, IMPORTE CUYO PAGO LE REQUERIMOS A EFECTOS DE LO DISPUESTO EN LOS ARTICULOS 572 Y 573 DE ' ||
'LA LEY DE ENJUICIAMIENTO CIVIL. <br/><br/>RECUERDE QUE POR EL IMPAGO DE SU DEUDA SUS DATOS PUEDEN SER INCORPORADOS A FICHEROS DE CUMPLIMIENTO O ' ||
'INCUMPLIMIENTO DE OBLIGACIONES DINERARIAS.<br/><br/>LA PRESENTE COMUNICACIÓN ANULA Y DEJA ' ||
'SIN EFECTO CUALQUIER OTRA QUE, RESPECTO DE LA MISMA OPERACIÓN CREDITICIA, Y CON EXPRESIÓN DE CANTIDAD, HUBIESE PODIDO RECIBIR CON ' ||
'ANTERIORIDAD.<br/><br/>${GEN_ENT_N}<br/>${LOCCRD}'' ' ||
' WHERE DD_PCO_BFT_CODIGO LIKE ''BF_PRESTAMO_HIPO''';
EXECUTE IMMEDIATE V_SQL;
DBMS_OUTPUT.PUT_LINE('[INICIO] Actualizada la plantilla de Prestamo Hipotecario');

--Prestamo Personal
V_SQL := 'UPDATE ' || V_ESQUEMA || '.' || V_DDNAME || ' SET DD_PCO_BFT_PLANTILLA = ''EN SU CALIDAD DE ${tipoIntervencion} DEL PRESTAMO ' ||
'No ${CODIGO_DE_CONTRATO} ${FORMALIZADO} EL DIA ${FECFORMALIZ} POR UN PRINCIPAL DE ${CAL_RUT_POLIZA} EUROS, ' ||
'LE NOTIFICAMOS QUE POR INCUMPLIMIENTO DE LAS OBLIGACIONES DE PAGO PACTADAS, HEMOS DADO POR VENCIDO ANTICIPADAMENTE EL PRÉSTAMO, ' ||
'RESULTANDO UNA DEUDA A FAVOR DE ${GEN_ENT_N}, POR IMPORTE DE ${CAPITALCER} EUROS DE PRINCIPAL, ${INTERESCER} EUROS DE INTERESES REMUNERATORIOS ' ||
'PACTADOS Y ${DEMORACER} EUROS DE INTERESES MORATORIOS PACTADOS, ASCENDIENDO EL TOTAL DE LA DEUDA POR LOS CONCEPTOS EXPRESADOS A LA CANTIDAD ' ||
'DE ${IMPCER} EUROS AL DÍA ${FECHA_CIERRE_LIQUIDACION}, IMPORTE CUYO PAGO LE REQUERIMOS A EFECTOS DE LO DISPUESTO EN LOS ARTICULOS 572 Y 573 ' ||
'DE LA LEY DE ENJUICIAMIENTO CIVIL. <br/><br/>RECUERDE QUE POR EL IMPAGO DE SU DEUDA SUS DATOS PUEDEN SER INCORPORADOS A FICHEROS DE CUMPLIMIENTO ' ||
'O INCUMPLIMIENTO DE OBLIGACIONES DINERARIAS.<br/><br/>LA PRESENTE COMUNICACIÓN ANULA Y DEJA ' ||
'SIN EFECTO CUALQUIER OTRA QUE, RESPECTO DE LA MISMA OPERACIÓN CREDITICIA, Y CON EXPRESIÓN DE CANTIDAD, HUBIESE PODIDO RECIBIR CON ' ||
'ANTERIORIDAD.<br/><br/>${GEN_ENT_N}<br/>${LOCCRD}'' ' ||
' WHERE DD_PCO_BFT_CODIGO LIKE ''BF_PRESTAMO_PERS''';
EXECUTE IMMEDIATE V_SQL;
DBMS_OUTPUT.PUT_LINE('[INICIO] Actualizada la plantilla de Prestamo Personal');

--Leasing
V_SQL := 'UPDATE ' || V_ESQUEMA || '.' || V_DDNAME || ' SET DD_PCO_BFT_PLANTILLA = ''EN SU CALIDAD DE ${tipoIntervencion} DEL CONTRATO DE ' ||
'ARRENDAMIENTO FINANCIERO No ${CODIGO_DE_CONTRATO} ${FORMALIZADO} EL DÍA ${FECFORMALIZ}, LE NOTIFICAMOS QUE POR INCUMPLIMIENTO DE LAS OBLIGACIONES ' ||
'DE PAGO PACTADAS HEMOS DADO POR VENCIDO ANTICIPADAMENTE EL CONTRATO, RESULTANDO UNA DEUDA A FAVOR DE ${GEN_ENT_N}, AL DÍA ${FECHA_CIERRE_LIQUIDACION} ' ||
'POR IMPORTE DE ${CAPITALCER} EUROS EN CONCEPTO DE CUOTAS MÁS IVA VENCIDAS E IMPAGADAS, ${INTERESCER} EUROS DE PRINCIPAL E INTERESES PENDIENTES MÁS ' ||
'IVA Y ${DEMORACER} EUROS DE INTERESES MORATORIOS PACTADOS, ASCENDIENDO EL TOTAL DE LA DEUDA POR LOS CONCEPTOS EXPRESADOS A LA CANTIDAD DE ${IMPCER} ' ||
'EUROS AL HABERSE RESUELTO DE PLENO DERECHO EN VIRTUD DE LO PACTADO EN LA CONDICIÓN GENERAL DECIMOTERCERA 3o-A, IMPORTE CUYO PAGO LE REQUERIMOS A ' ||
'EFECTOS DE LO DISPUESTO EN LOS ARTICULOS 572 Y 573 DE LA LEY DE ENJUICIAMIENTO CIVIL. <br/><br/>RECUERDE QUE POR EL IMPAGO DE SU DEUDA SUS DATOS ' ||
'PUEDEN SER INCORPORADOS A FICHEROS DE CUMPLIMIENTO O INCUMPLIMIENTO DE OBLIGACIONES DINERARIAS.<br/><br/>LA PRESENTE COMUNICACIÓN ANULA Y DEJA ' ||
'SIN EFECTO CUALQUIER OTRA QUE, RESPECTO DE LA MISMA OPERACIÓN CREDITICIA, Y CON EXPRESIÓN DE CANTIDAD, HUBIESE PODIDO RECIBIR CON ' ||
'ANTERIORIDAD.<br/><br/>${GEN_ENT_N}<br/>${LOCCRD}'' ' ||
' WHERE DD_PCO_BFT_CODIGO LIKE ''BF_LEASING''';
EXECUTE IMMEDIATE V_SQL;
DBMS_OUTPUT.PUT_LINE('[INICIO] Actualizada la plantilla de Leasing');

COMMIT;

DBMS_OUTPUT.PUT_LINE('[FIN]');

EXCEPTION
     WHEN OTHERS THEN
          err_num := SQLCODE;
          err_msg := SQLERRM;

          DBMS_OUTPUT.PUT_LINE('KO no modificado');
          DBMS_OUTPUT.put_line('[ERROR] Se ha producido un error en la ejecución:'||TO_CHAR(err_num));
          DBMS_OUTPUT.put_line('-----------------------------------------------------------'); 
          DBMS_OUTPUT.put_line(err_msg);

          ROLLBACK;
          RAISE;          

END;

/

EXIT

