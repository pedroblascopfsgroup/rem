--/*
--##########################################
--## AUTOR=MIGUEL ANGEL SANCHEZ
--## FECHA_CREACION=20160523
--## ARTEFACTO=BACHT
--## VERSION_ARTEFACTO=9.2
--## INCIDENCIA_LINK=HR-2532
--## PRODUCTO=NO
--## Finalidad: DDL modificacion DE LA TABLA DD_PCO_BFR_RESULTADO.
--##           
--## INSTRUCCIONES: Configurar las variables necesarias en el principio del DECLARE
--## VERSIONES:
--##        0.1 Versión inicial
--##########################################
--*/

--Para permitir la visualización de texto en un bloque PL/SQL utilizando DBMS_OUTPUT.PUT_LINE

WHENEVER SQLERROR EXIT SQL.SQLCODE;

SET SERVEROUTPUT ON;

SET DEFINE OFF;


DECLARE
    V_MSQL VARCHAR2(32000 CHAR);
 -- Sentencia a ejecutar     
    V_ESQUEMA VARCHAR2(25 CHAR):= 'HAYA01';
 -- Configuracion Esquema
    V_ESQUEMA_M VARCHAR2(25 CHAR):= 'HAYAMASTER';
 -- Configuracion Esquema Master
    V_NUM_TABLAS NUMBER(16);
 -- Vble. para validar la existencia de una tabla.   
    ERR_NUM NUMBER(25);
  -- Vble. auxiliar para registrar errores en el script.
    ERR_MSG VARCHAR2(1024 CHAR);
 -- Vble. auxiliar para registrar errores en el script.
    V_TABLA VARCHAR2(1024 CHAR);

    V_USUARIO VARCHAR2(1024 CHAR);

    
BEGIN
DBMS_OUTPUT.PUT_LINE('[INICIO] Inicio del proceso');


V_TABLA :='DD_PCO_BFR_RESULTADO';

DBMS_OUTPUT.PUT_LINE(' ');

DBMS_OUTPUT.PUT_LINE('[INFO] Modificar tabla: '||V_TABLA);

V_MSQL := 'SELECT COUNT(1) FROM ALL_TABLES WHERE TABLE_NAME = '''||V_TABLA||''' and owner = '''||V_ESQUEMA||'''';
--DBMS_OUTPUT.PUT_LINE('[QUERY] '||V_MSQL);
EXECUTE IMMEDIATE V_MSQL into V_NUM_TABLAS;

IF V_NUM_TABLAS = 1 THEN
    DBMS_OUTPUT.PUT_LINE('Cambiando el codigo a los registros 11 y 12');

    V_MSQL := 'SELECT COUNT(1) FROM '||V_ESQUEMA||'.'||V_TABLA||' BFR WHERE BFR.DD_PCO_BFR_CODIGO=''112''';
    EXECUTE IMMEDIATE V_MSQL into V_NUM_TABLAS;
    IF V_NUM_TABLAS = 0 THEN
        DBMS_OUTPUT.PUT_LINE('Modificando los registros actuales');
        V_MSQL := 'UPDATE  '||V_ESQUEMA||'.'||V_TABLA||' 
        SET DD_PCO_BFR_CODIGO = ''112''
        ,USUARIOMODIFICAR=''HR-2532''
        ,FECHAMODIFICAR=SYSDATE
        WHERE DD_PCO_BFR_CODIGO = ''12''';  
        EXECUTE IMMEDIATE V_MSQL; 
        DBMS_OUTPUT.PUT_LINE('[INFO] El codigo 12 ahora es el 112');
    ELSE
        DBMS_OUTPUT.PUT_LINE('[INFO] El codigo 112 ya existe');
    END IF;
    
     V_MSQL := 'SELECT COUNT(1) FROM '||V_ESQUEMA||'.'||V_TABLA||' BFR WHERE BFR.DD_PCO_BFR_CODIGO=''111''';
    EXECUTE IMMEDIATE V_MSQL into V_NUM_TABLAS;
    IF V_NUM_TABLAS = 0 THEN
        V_MSQL := 'UPDATE  '||V_ESQUEMA||'.'||V_TABLA||' 
        SET DD_PCO_BFR_CODIGO = ''111''
        ,USUARIOMODIFICAR=''HR-2532''
        ,FECHAMODIFICAR=SYSDATE
        WHERE DD_PCO_BFR_CODIGO = ''11''';  
        EXECUTE IMMEDIATE V_MSQL; 
        DBMS_OUTPUT.PUT_LINE('[INFO] El codigo 11 ahora es el 111');
    ELSE
        DBMS_OUTPUT.PUT_LINE('[INFO] El codigo 111 ya existe');
    END IF;
    
    DBMS_OUTPUT.PUT_LINE('Modificando los registros actuales');
    V_MSQL := 'UPDATE  '||V_ESQUEMA||'.'||V_TABLA||' 
    SET DD_PCO_BFR_DESCRIPCION=''EN REPARTO''
    ,DD_PCO_BFR_DESCRIPCION_LARGA=''EN REPARTO''
    ,USUARIOMODIFICAR=''HR-2532''
    ,FECHAMODIFICAR=SYSDATE
    ,DD_PCO_BFR_NOTIFICADO=0
    WHERE DD_PCO_BFR_CODIGO = ''0''';   
    EXECUTE IMMEDIATE V_MSQL; 
    
    V_MSQL := 'UPDATE  '||V_ESQUEMA||'.'||V_TABLA||' 
    SET DD_PCO_BFR_DESCRIPCION=''AUSENTE''
    ,DD_PCO_BFR_DESCRIPCION_LARGA=''AUSENTE''
    ,USUARIOMODIFICAR=''HR-2532''
    ,FECHAMODIFICAR=SYSDATE
    ,DD_PCO_BFR_NOTIFICADO=1
    WHERE DD_PCO_BFR_CODIGO = ''1''';   
    EXECUTE IMMEDIATE V_MSQL; 
    
    V_MSQL := 'UPDATE  '||V_ESQUEMA||'.'||V_TABLA||' 
    SET DD_PCO_BFR_DESCRIPCION=''CAMBIO DE DOMICILIO''
    ,DD_PCO_BFR_DESCRIPCION_LARGA=''CAMBIO DE DOMICILIO''
    ,USUARIOMODIFICAR=''HR-2532''
    ,FECHAMODIFICAR=SYSDATE
    ,DD_PCO_BFR_NOTIFICADO=1
    WHERE DD_PCO_BFR_CODIGO = ''2''';   
    EXECUTE IMMEDIATE V_MSQL; 
    
    V_MSQL := 'UPDATE  '||V_ESQUEMA||'.'||V_TABLA||' 
    SET DD_PCO_BFR_DESCRIPCION=''DESCONOCIDO''
    ,DD_PCO_BFR_DESCRIPCION_LARGA=''DESCONOCIDO''
    ,USUARIOMODIFICAR=''HR-2532''
    ,FECHAMODIFICAR=SYSDATE
    ,DD_PCO_BFR_NOTIFICADO=1
    WHERE DD_PCO_BFR_CODIGO = ''3''';   
    EXECUTE IMMEDIATE V_MSQL; 
    
    V_MSQL := 'UPDATE  '||V_ESQUEMA||'.'||V_TABLA||' 
    SET DD_PCO_BFR_DESCRIPCION=''REHUSADO''
    ,DD_PCO_BFR_DESCRIPCION_LARGA=''REHUSADO''
    ,USUARIOMODIFICAR=''HR-2532''
    ,FECHAMODIFICAR=SYSDATE
    ,DD_PCO_BFR_NOTIFICADO=1
    WHERE DD_PCO_BFR_CODIGO = ''4''';   
    EXECUTE IMMEDIATE V_MSQL; 
    
    V_MSQL := 'UPDATE  '||V_ESQUEMA||'.'||V_TABLA||' 
    SET DD_PCO_BFR_DESCRIPCION=''DESHABILITADO''
    ,DD_PCO_BFR_DESCRIPCION_LARGA=''DESHABILITADO''
    ,USUARIOMODIFICAR=''HR-2532''
    ,FECHAMODIFICAR=SYSDATE
    ,DD_PCO_BFR_NOTIFICADO=1
    WHERE DD_PCO_BFR_CODIGO = ''5''';   
    EXECUTE IMMEDIATE V_MSQL; 
    
    V_MSQL := 'UPDATE  '||V_ESQUEMA||'.'||V_TABLA||' 
    SET DD_PCO_BFR_DESCRIPCION=''DIRECCION INCORRECTA''
    ,DD_PCO_BFR_DESCRIPCION_LARGA=''DIRECCION INCORRECTA''
    ,USUARIOMODIFICAR=''HR-2532''
    ,FECHAMODIFICAR=SYSDATE
    WHERE DD_PCO_BFR_CODIGO = ''6''';   
    EXECUTE IMMEDIATE V_MSQL; 
    
    V_MSQL := 'UPDATE  '||V_ESQUEMA||'.'||V_TABLA||' 
    SET DD_PCO_BFR_DESCRIPCION=''IMPOSIBLE ENTREGA''
    ,DD_PCO_BFR_DESCRIPCION_LARGA=''IMPOSIBLE ENTREGA''
    ,USUARIOMODIFICAR=''HR-2532''
    ,FECHAMODIFICAR=SYSDATE
    ,DD_PCO_BFR_NOTIFICADO=0
    WHERE DD_PCO_BFR_CODIGO = ''7''';   
    EXECUTE IMMEDIATE V_MSQL; 
    
    V_MSQL := 'UPDATE  '||V_ESQUEMA||'.'||V_TABLA||' 
    SET DD_PCO_BFR_DESCRIPCION=''FALLECIDO''
    ,DD_PCO_BFR_DESCRIPCION_LARGA=''FALLECIDO''
    ,USUARIOMODIFICAR=''HR-2532''
    ,FECHAMODIFICAR=SYSDATE
    WHERE DD_PCO_BFR_CODIGO = ''8''';   
    EXECUTE IMMEDIATE V_MSQL; 
    
    V_MSQL := 'UPDATE  '||V_ESQUEMA||'.'||V_TABLA||' 
    SET DD_PCO_BFR_DESCRIPCION=''ENTREGADO''
    ,DD_PCO_BFR_DESCRIPCION_LARGA=''ENTREGADO''
    ,USUARIOMODIFICAR=''HR-2532''
    ,FECHAMODIFICAR=SYSDATE
    ,DD_PCO_BFR_NOTIFICADO=1
    WHERE DD_PCO_BFR_CODIGO = ''9''';   
    EXECUTE IMMEDIATE V_MSQL; 
    
    V_MSQL := 'UPDATE  '||V_ESQUEMA||'.'||V_TABLA||' 
    SET DD_PCO_BFR_DESCRIPCION=''EXTRAVIADO''
    ,DD_PCO_BFR_DESCRIPCION_LARGA=''EXTRAVIADO''
    ,USUARIOMODIFICAR=''HR-2532''
    ,FECHAMODIFICAR=SYSDATE
    WHERE DD_PCO_BFR_CODIGO = ''10''';   
    EXECUTE IMMEDIATE V_MSQL; 
    
    V_MSQL := 'UPDATE  '||V_ESQUEMA||'.'||V_TABLA||' 
    SET DD_PCO_BFR_DESCRIPCION=''NUEVO DOMICILIO ENTREGA''
    ,DD_PCO_BFR_DESCRIPCION_LARGA=''NUEVO DOMICILIO ENTREGA''
    ,USUARIOMODIFICAR=''HR-2532''
    ,FECHAMODIFICAR=SYSDATE
    ,DD_PCO_BFR_NOTIFICADO=1
    WHERE DD_PCO_BFR_CODIGO = ''14''';   
    EXECUTE IMMEDIATE V_MSQL; 
    
    DBMS_OUTPUT.PUT_LINE('Insertando nuevos registros');
    
    V_MSQL := 'SELECT COUNT(1) FROM '||V_ESQUEMA||'.'||V_TABLA||' BFR WHERE BFR.DD_PCO_BFR_CODIGO=''11''';
    EXECUTE IMMEDIATE V_MSQL into V_NUM_TABLAS;
    IF V_NUM_TABLAS = 0 THEN
        V_MSQL := 'INSERT INTO '||V_ESQUEMA||'.'||V_TABLA||' VALUES ('||V_ESQUEMA||'.S_'||V_TABLA||'.NEXTVAL,''11'',''AUSENTE DEJADO EN BUZON'',''AUSENTE DEJADO EN BUZON'',0,''HR-2532'',SYSDATE,null,null,null,null,0,0)';   
        EXECUTE IMMEDIATE V_MSQL; 
        DBMS_OUTPUT.PUT_LINE('[INFO] Insertado el codigo 11');
    ELSE
        DBMS_OUTPUT.PUT_LINE('[INFO] El codigo 11 ya existe, Actualizando registro');
        V_MSQL := 'UPDATE  '||V_ESQUEMA||'.'||V_TABLA||' 
        SET DD_PCO_BFR_DESCRIPCION=''AUSENTE DEJADO EN BUZON''
        ,DD_PCO_BFR_DESCRIPCION_LARGA=''AUSENTE DEJADO EN BUZON''
        ,USUARIOMODIFICAR=''HR-2532''
        ,FECHAMODIFICAR=SYSDATE
        ,DD_PCO_BFR_NOTIFICADO=1
        WHERE DD_PCO_BFR_CODIGO = ''11''';   
        EXECUTE IMMEDIATE V_MSQL; 
    END IF;
    
    V_MSQL := 'SELECT COUNT(1) FROM '||V_ESQUEMA||'.'||V_TABLA||' BFR WHERE BFR.DD_PCO_BFR_CODIGO=''12''';
    EXECUTE IMMEDIATE V_MSQL into V_NUM_TABLAS;
    IF V_NUM_TABLAS = 0 THEN
        V_MSQL := 'INSERT INTO '||V_ESQUEMA||'.'||V_TABLA||' VALUES ('||V_ESQUEMA||'.S_'||V_TABLA||'.NEXTVAL,''12'',''NULO'',''NULO'',0,''HR-2532'',SYSDATE,null,null,null,null,0,0)';   
        EXECUTE IMMEDIATE V_MSQL;  
        DBMS_OUTPUT.PUT_LINE('[INFO] Insertado el codigo 12');
    ELSE
        DBMS_OUTPUT.PUT_LINE('[INFO] El codigo 12 ya existe');
    END IF;
    
    V_MSQL := 'SELECT COUNT(1) FROM '||V_ESQUEMA||'.'||V_TABLA||' BFR WHERE BFR.DD_PCO_BFR_CODIGO=''16''';
    EXECUTE IMMEDIATE V_MSQL into V_NUM_TABLAS;
    IF V_NUM_TABLAS = 0 THEN
        V_MSQL := 'INSERT INTO '||V_ESQUEMA||'.'||V_TABLA||' VALUES ('||V_ESQUEMA||'.S_'||V_TABLA||'.NEXTVAL,''16'',''AUSENTE DEJADO AVISO'',''AUSENTE DEJADO AVISO'',0,''HR-2532'',SYSDATE,null,null,null,null,0,0)';   
        EXECUTE IMMEDIATE V_MSQL;  
        DBMS_OUTPUT.PUT_LINE('[INFO] Insertado el codigo 16');
    ELSE
        DBMS_OUTPUT.PUT_LINE('[INFO] El codigo 16 ya existe, Actualizando registro');
        V_MSQL := 'UPDATE  '||V_ESQUEMA||'.'||V_TABLA||' 
        SET DD_PCO_BFR_DESCRIPCION=''AUSENTE DEJADO AVISO''
        ,DD_PCO_BFR_DESCRIPCION_LARGA=''AUSENTE DEJADO AVISO''
        ,USUARIOMODIFICAR=''HR-2532''
        ,FECHAMODIFICAR=SYSDATE
        ,DD_PCO_BFR_NOTIFICADO=1
        WHERE DD_PCO_BFR_CODIGO = ''16''';   
        EXECUTE IMMEDIATE V_MSQL; 
    END IF;
        
    V_MSQL := 'SELECT COUNT(1) FROM '||V_ESQUEMA||'.'||V_TABLA||' BFR WHERE BFR.DD_PCO_BFR_CODIGO=''18''';
    EXECUTE IMMEDIATE V_MSQL into V_NUM_TABLAS;
    IF V_NUM_TABLAS = 0 THEN
        V_MSQL := 'INSERT INTO '||V_ESQUEMA||'.'||V_TABLA||' VALUES ('||V_ESQUEMA||'.S_'||V_TABLA||'.NEXTVAL,''18'',''IMP.CONFIRMAR ENTREGA'',''IMP.CONFIRMAR ENTREGA'',0,''HR-2532'',SYSDATE,null,null,null,null,0,0)';   
        EXECUTE IMMEDIATE V_MSQL;  
        DBMS_OUTPUT.PUT_LINE('[INFO] Insertado el codigo 18');
    ELSE
        DBMS_OUTPUT.PUT_LINE('[INFO] El codigo 18 ya existe');
    END IF;
    
    V_MSQL := 'SELECT COUNT(1) FROM '||V_ESQUEMA||'.'||V_TABLA||' BFR WHERE BFR.DD_PCO_BFR_CODIGO=''27''';
    EXECUTE IMMEDIATE V_MSQL into V_NUM_TABLAS;
    IF V_NUM_TABLAS = 0 THEN
        V_MSQL := 'INSERT INTO '||V_ESQUEMA||'.'||V_TABLA||' VALUES ('||V_ESQUEMA||'.S_'||V_TABLA||'.NEXTVAL,''27'',''ROBO'',''ROBO'',0,''HR-2532'',SYSDATE,null,null,null,null,0,0)';   
        EXECUTE IMMEDIATE V_MSQL;  
        DBMS_OUTPUT.PUT_LINE('[INFO] Insertado el codigo 27');
    ELSE
        DBMS_OUTPUT.PUT_LINE('[INFO] El codigo 27 ya existe');
    END IF;
    
    V_MSQL := 'SELECT COUNT(1) FROM '||V_ESQUEMA||'.'||V_TABLA||' BFR WHERE BFR.DD_PCO_BFR_CODIGO=''31''';
    EXECUTE IMMEDIATE V_MSQL into V_NUM_TABLAS;
    IF V_NUM_TABLAS = 0 THEN
        V_MSQL := 'INSERT INTO '||V_ESQUEMA||'.'||V_TABLA||' VALUES ('||V_ESQUEMA||'.S_'||V_TABLA||'.NEXTVAL,''31'',''ENTREGADO.ACUSE PENDIENTE'',''ENTREGADO.ACUSE PENDIENTE'',0,''HR-2532'',SYSDATE,null,null,null,null,0,1)';   
        EXECUTE IMMEDIATE V_MSQL;  
        DBMS_OUTPUT.PUT_LINE('[INFO] Insertado el codigo 31');
    ELSE
        DBMS_OUTPUT.PUT_LINE('[INFO] El codigo 31 ya existe');
    END IF;
    
    V_MSQL := 'SELECT COUNT(1) FROM '||V_ESQUEMA||'.'||V_TABLA||' BFR WHERE BFR.DD_PCO_BFR_CODIGO=''38''';
    EXECUTE IMMEDIATE V_MSQL into V_NUM_TABLAS;
    IF V_NUM_TABLAS = 0 THEN
        V_MSQL := 'INSERT INTO '||V_ESQUEMA||'.'||V_TABLA||' VALUES ('||V_ESQUEMA||'.S_'||V_TABLA||'.NEXTVAL,''38'',''VENCIDO PLAZO ESPERA OFICINA'',''VENCIDO PLAZO ESPERA OFICINA'',0,''HR-2532'',SYSDATE,null,null,null,null,0,0)';   
        EXECUTE IMMEDIATE V_MSQL;  
        DBMS_OUTPUT.PUT_LINE('[INFO] Insertado el codigo 38');
    ELSE
        DBMS_OUTPUT.PUT_LINE('[INFO] El codigo 38 ya existe, Actualizando registro');
        V_MSQL := 'UPDATE  '||V_ESQUEMA||'.'||V_TABLA||' 
        SET DD_PCO_BFR_DESCRIPCION=''VENCIDO PLAZO ESPERA OFICINA''
        ,DD_PCO_BFR_DESCRIPCION_LARGA=''VENCIDO PLAZO ESPERA OFICINA''
        ,USUARIOMODIFICAR=''HR-2532''
        ,FECHAMODIFICAR=SYSDATE
        ,DD_PCO_BFR_NOTIFICADO=1
        WHERE DD_PCO_BFR_CODIGO = ''38''';   
        EXECUTE IMMEDIATE V_MSQL; 
    END IF;
    
    V_MSQL := 'SELECT COUNT(1) FROM '||V_ESQUEMA||'.'||V_TABLA||' BFR WHERE BFR.DD_PCO_BFR_CODIGO=''39''';
    EXECUTE IMMEDIATE V_MSQL into V_NUM_TABLAS;
    IF V_NUM_TABLAS = 0 THEN
        V_MSQL := 'INSERT INTO '||V_ESQUEMA||'.'||V_TABLA||' VALUES ('||V_ESQUEMA||'.S_'||V_TABLA||'.NEXTVAL,''39'',''NADIE SE HACE CARGO'',''NADIE SE HACE CARGO'',0,''HR-2532'',SYSDATE,null,null,null,null,0,0)';   
        EXECUTE IMMEDIATE V_MSQL;  
        DBMS_OUTPUT.PUT_LINE('[INFO] Insertado el codigo 39');
    ELSE
        DBMS_OUTPUT.PUT_LINE('[INFO] El codigo 39 ya existe, Actualizando registro');
        V_MSQL := 'UPDATE  '||V_ESQUEMA||'.'||V_TABLA||' 
        SET DD_PCO_BFR_DESCRIPCION=''NADIE SE HACE CARGO''
        ,DD_PCO_BFR_DESCRIPCION_LARGA=''NADIE SE HACE CARGO''
        ,USUARIOMODIFICAR=''HR-2532''
        ,FECHAMODIFICAR=SYSDATE
        ,DD_PCO_BFR_NOTIFICADO=1
        WHERE DD_PCO_BFR_CODIGO = ''39''';   
        EXECUTE IMMEDIATE V_MSQL; 
    END IF;
    
    V_MSQL := 'SELECT COUNT(1) FROM '||V_ESQUEMA||'.'||V_TABLA||' BFR WHERE BFR.DD_PCO_BFR_CODIGO=''58''';
    EXECUTE IMMEDIATE V_MSQL into V_NUM_TABLAS;
    IF V_NUM_TABLAS = 0 THEN
        V_MSQL := 'INSERT INTO '||V_ESQUEMA||'.'||V_TABLA||' VALUES ('||V_ESQUEMA||'.S_'||V_TABLA||'.NEXTVAL,''58'',''ENTREGADO EN OFICINA'',''ENTREGADO EN OFICINA'',0,''HR-2532'',SYSDATE,null,null,null,null,0,1)';   
        EXECUTE IMMEDIATE V_MSQL;  
        DBMS_OUTPUT.PUT_LINE('[INFO] Insertado el codigo 58');
    ELSE
        DBMS_OUTPUT.PUT_LINE('[INFO] El codigo 58 ya existe');
    END IF;
    
    V_MSQL := 'SELECT COUNT(1) FROM '||V_ESQUEMA||'.'||V_TABLA||' BFR WHERE BFR.DD_PCO_BFR_CODIGO=''68''';
    EXECUTE IMMEDIATE V_MSQL into V_NUM_TABLAS;
    IF V_NUM_TABLAS = 0 THEN
        V_MSQL := 'INSERT INTO '||V_ESQUEMA||'.'||V_TABLA||' VALUES ('||V_ESQUEMA||'.S_'||V_TABLA||'.NEXTVAL,''68'',''NO DEPOSITADO EN UNIPOST'',''NO DEPOSITADO EN UNIPOST'',0,''HR-2532'',SYSDATE,null,null,null,null,0,0)';   
        EXECUTE IMMEDIATE V_MSQL;  
        DBMS_OUTPUT.PUT_LINE('[INFO] Insertado el codigo 68');
    ELSE
        DBMS_OUTPUT.PUT_LINE('[INFO] El codigo 68 ya existe');
    END IF;
    
    
    DBMS_OUTPUT.PUT_LINE('Modificando las referencias de los antiguos Entregados(0) a los nuevos entregados (9)');
    V_MSQL := 'UPDATE '||V_ESQUEMA||'.PCO_BUR_ENVIO 
    SET DD_PCO_BFR_ID=(SELECT DD_PCO_BFR_ID  FROM '||V_ESQUEMA||'.'||V_TABLA||' WHERE DD_PCO_BFR_CODIGO=''9'')
    WHERE  DD_PCO_BFR_ID=(SELECT DD_PCO_BFR_ID FROM '||V_ESQUEMA||'.'||V_TABLA||' WHERE DD_PCO_BFR_CODIGO=''0'')';   
    
    EXECUTE IMMEDIATE V_MSQL; 

ELSE
    DBMS_OUTPUT.PUT_LINE('[INFO] La tabla '||V_TABLA||' ya no existe');
END IF;


DBMS_OUTPUT.PUT_LINE('[FIN]');


EXCEPTION
     WHEN OTHERS THEN
          err_num := SQLCODE;

          err_msg := SQLERRM;

          DBMS_OUTPUT.PUT_LINE('KO no modificado');

          DBMS_OUTPUT.put_line('[ERROR] Se ha producido un error en la ejecución:'||TO_CHAR(err_num));

          DBMS_OUTPUT.put_line('-----------------------------------------------------------');
 
          DBMS_OUTPUT.put_line(err_msg);

          ROLLBACK;

          RAISE;
          
END;

/
EXIT