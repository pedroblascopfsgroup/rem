--/*
--##########################################
--## AUTOR=Joaquin_Arnal
--## FECHA_CREACION=20160111
--## ARTEFACTO=batch
--## VERSION_ARTEFACTO=9.2
--## INCIDENCIA_LINK=HREOS-1371
--## PRODUCTO=NO
--## Finalidad: Creación de tablas historicas de los datos para salida de información ASPRO
--##           
--## INSTRUCCIONES: Configurar las variables necesarias en el principio del DECLARE
--## VERSIONES:
--##        0.1 Versión inicial
--##########################################
--*/

--Para permitir la visualización de texto en un bloque PL/SQL utilizando DBMS_OUTPUT.PUT_LINE

WHENEVER SQLERROR EXIT SQL.SQLCODE;
SET SERVEROUTPUT ON; 
SET DEFINE OFF;


DECLARE

    V_MSQL VARCHAR2(32000 CHAR); -- Sentencia a ejecutar    
    V_ESQUEMA VARCHAR2(25 CHAR):= '#ESQUEMA#'; -- Configuracion Esquema
    V_ESQUEMA_M VARCHAR2(25 CHAR):= '#ESQUEMA_MASTER#'; -- Configuracion Esquema Master
    V_TABLESPACE_IDX VARCHAR2(25 CHAR):= '#TABLESPACE_INDEX#'; -- Configuracion Tablespace de Indices
    V_SQL VARCHAR2(4000 CHAR); -- Vble. para consulta que valida la existencia de una tabla.
    V_NUM_TABLAS NUMBER(16); -- Vble. para validar la existencia de una tabla.  
    V_NUM_SEQ NUMBER(16); -- Vble. para validar la existencia de una secuencia.  
    ERR_NUM NUMBER(25);  -- Vble. auxiliar para registrar errores en el script.
    ERR_MSG VARCHAR2(1024 CHAR); -- Vble. auxiliar para registrar errores en el script.

    V_TEXT1 VARCHAR2(2400 CHAR); -- Vble. auxiliar
    
	  V_TEXT_TABLA VARCHAR2(2400 CHAR) := ''; -- Vble. auxiliar para almacenar el nombre de la tabla de ref.
    V_COMMENT_TABLE VARCHAR2(500 CHAR):= ''; -- Vble. para los comentarios de las tablas
    V_COLUMN_TABLE_UNIQUE VARCHAR2(500 CHAR):= ''; -- Vble. para un campo que debe ser unico en la tabla

BEGIN

	/* KC10(CABECERA) */

	V_TEXT_TABLA := 'H_ASPRO_10_CABECERA'; 
    V_COMMENT_TABLE := 'Tabla auxiliar de salida para ASPRO, registro CABECERA.'; 
    V_COLUMN_TABLE_UNIQUE := '';

	DBMS_OUTPUT.PUT_LINE('********' ||V_TEXT_TABLA|| '********'); 
	DBMS_OUTPUT.PUT_LINE('[INFO] '||V_ESQUEMA||'.'||V_TEXT_TABLA||'... Comprobaciones previas');
	
	-- Verificar si la tabla ya existe
	V_MSQL := 'SELECT COUNT(1) FROM ALL_TABLES WHERE TABLE_NAME = '''||V_TEXT_TABLA||''' and owner = '''||V_ESQUEMA||'''';
	EXECUTE IMMEDIATE V_MSQL INTO V_NUM_TABLAS;	
	IF V_NUM_TABLAS = 1 THEN
		DBMS_OUTPUT.PUT_LINE('[INFO] ' || V_ESQUEMA || '.'||V_TEXT_TABLA||'... Ya existe. Se borrará.');
		EXECUTE IMMEDIATE 'DROP TABLE '||V_ESQUEMA||'.'||V_TEXT_TABLA||' CASCADE CONSTRAINTS';
		
	END IF;

	-- Comprobamos si existe la secuencia
	V_SQL := 'SELECT COUNT(1) FROM ALL_SEQUENCES WHERE SEQUENCE_NAME = ''S_'||V_TEXT_TABLA||''' and SEQUENCE_OWNER = '''||V_ESQUEMA||'''';
	EXECUTE IMMEDIATE V_SQL INTO V_NUM_TABLAS; 
	IF V_NUM_TABLAS = 1 THEN
		DBMS_OUTPUT.PUT_LINE('[INFO] '|| V_ESQUEMA ||'.S_'||V_TEXT_TABLA||'... Ya existe. Se borrará.');  
		EXECUTE IMMEDIATE 'DROP SEQUENCE '||V_ESQUEMA||'.S_'||V_TEXT_TABLA||'';
	END IF; 
	
	-- Creamos la tabla
	DBMS_OUTPUT.PUT_LINE('[INFO] ' ||V_ESQUEMA|| '.'||V_TEXT_TABLA||'...');
	V_MSQL := 'CREATE TABLE ' ||V_ESQUEMA||'.'||V_TEXT_TABLA||'
	(
		H_ASPRO_10_ID 		NUMBER (16),
		USUARIO_ENVIO 		VARCHAR2 (50 CHAR),
		FECHA_ENVIO 		DATE,
		USUARIO_RECEPCION	VARCHAR2 (50 CHAR),
		FECHA_RECEPCION		DATE,
		IDNOPE				VARCHAR2(15 CHAR),
		CODREG				VARCHAR2(1 CHAR),
		COENTV				VARCHAR2(7 CHAR),
		FEEJFA				VARCHAR2(4 CHAR),
		COCLDO				VARCHAR2(1 CHAR),
		NUDNIP				VARCHAR2(10 CHAR),
		COTIFA				VARCHAR2(1 CHAR),
		BISITF				VARCHAR2(1 CHAR),
		CLCENT				VARCHAR2(5 CHAR),
		CLROLT				VARCHAR2(2 CHAR),
		CLMOPA				VARCHAR2(2 CHAR),
		COFOPG				VARCHAR2(2 CHAR),
		COOPPA				VARCHAR2(2 CHAR),
		CLMNDA				VARCHAR2(3 CHAR),
		IMNFAC				VARCHAR2(15 CHAR),
		IMBFAC				VARCHAR2(15 CHAR),
		POCVAL	VARCHAR2(9 CHAR),
		NUFPRO	VARCHAR2(20 CHAR),
		FEEMFA	VARCHAR2(8 CHAR),
		FEAUFA	VARCHAR2(8 CHAR),
		IMBAFA	VARCHAR2(15 CHAR),
		COIMPT	VARCHAR2(2 CHAR),
		CLTRET	VARCHAR2(20 CHAR),
		POIMAP	VARCHAR2(5 CHAR),
		IMTIMP	VARCHAR2(15 CHAR),
		CLCENO	VARCHAR2(5 CHAR),
		NUCONE	VARCHAR2(13 CHAR),
		FMPAGN	VARCHAR2(8 CHAR),
		CLFIS1	VARCHAR2(1 CHAR),
		COFIS1	VARCHAR2(10 CHAR),
		CLFIS2	VARCHAR2(1 CHAR),
		COFIS2	VARCHAR2(10 CHAR),
		CLFIS3	VARCHAR2(1 CHAR),
		COFIS3	VARCHAR2(10 CHAR),
		NURMSA	VARCHAR2(8 CHAR),
		BISUFA	VARCHAR2(1 CHAR),
		BIFREF	VARCHAR2(1 CHAR),
		BIANUL	VARCHAR2(1 CHAR),
		CLRFRA	VARCHAR2(1 CHAR),
		COANOR	VARCHAR2(4 CHAR),
		IDNOP1	VARCHAR2(15 CHAR),
		COPPTO	VARCHAR2(20 CHAR),
		COPPST	VARCHAR2(20 CHAR),
		CLSIST	VARCHAR2(1 CHAR),
		NUFPR1	VARCHAR2(20 CHAR),
		IDPROV	VARCHAR2(9 CHAR),
		NUFPRA	VARCHAR2(20 CHAR),
		BIANFA	VARCHAR2(1 CHAR),
		NUFAAN	VARCHAR2(9 CHAR),
		COSPAT	VARCHAR2(5 CHAR),
		FEDEVG	VARCHAR2(8 CHAR),
		FEVENC	VARCHAR2(8 CHAR),
		FEPAGA	VARCHAR2(8 CHAR),
		FECTBL	VARCHAR2(8 CHAR),
		NUFREM 	VARCHAR2(16 CHAR),
		FILLER	VARCHAR2(166 CHAR),
		ERCOD9	VARCHAR2(3 CHAR)
	)
	LOGGING 
	NOCOMPRESS 
	NOCACHE
	NOPARALLEL
	NOMONITORING
	';
	EXECUTE IMMEDIATE V_MSQL;
	DBMS_OUTPUT.PUT_LINE('[INFO] ' ||V_ESQUEMA||'.'||V_TEXT_TABLA||'... Tabla creada.');
	
	
	-- Creamos indice	
	V_MSQL := 'CREATE UNIQUE INDEX '||V_ESQUEMA||'.'||V_TEXT_TABLA||'_PK ON '||V_ESQUEMA|| '.'||V_TEXT_TABLA||'(H_ASPRO_10_ID) TABLESPACE '||V_TABLESPACE_IDX;		
	EXECUTE IMMEDIATE V_MSQL;
	DBMS_OUTPUT.PUT_LINE('[INFO] ' ||V_ESQUEMA||'.'||V_TEXT_TABLA||'_PK... Indice creado.');
	
	-- Creamos primary key
	V_MSQL := 'ALTER TABLE '||V_ESQUEMA||'.'||V_TEXT_TABLA||' ADD (CONSTRAINT '||V_TEXT_TABLA||'_PK PRIMARY KEY (H_ASPRO_10_ID) USING INDEX)';
	EXECUTE IMMEDIATE V_MSQL;
	DBMS_OUTPUT.PUT_LINE('[INFO] ' ||V_ESQUEMA||'.'||V_TEXT_TABLA||'_PK... PK creada.');
	
	/*
	-- Creamos constraint unique 
	V_MSQL := 'ALTER TABLE '||V_ESQUEMA||'.'||V_TEXT_TABLA||' ADD (CONSTRAINT '||V_TEXT_TABLA||'_UN UNIQUE ('||V_COLUMN_TABLE_UNIQUE||') USING INDEX)';
	EXECUTE IMMEDIATE V_MSQL;
	DBMS_OUTPUT.PUT_LINE('[INFO] ' ||V_ESQUEMA||'.'||V_TEXT_TABLA||'_UN... Restriccion ('||V_TEXT_TABLA||'_UN) creada sobre campo '||V_COLUMN_TABLE_UNIQUE||'.');
	*/
	
	-- Creamos sequence
	V_MSQL := 'CREATE SEQUENCE '||V_ESQUEMA||'.S_'||V_TEXT_TABLA||'';		
	EXECUTE IMMEDIATE V_MSQL;		
	DBMS_OUTPUT.PUT_LINE('[INFO] '||V_ESQUEMA||'.S_'||V_TEXT_TABLA||'... Secuencia creada');
	
	-- Creamos comentario	
	V_MSQL := 'COMMENT ON TABLE '||V_ESQUEMA||'.'||V_TEXT_TABLA||' IS '''||V_COMMENT_TABLE||'''';		
	EXECUTE IMMEDIATE V_MSQL;
	DBMS_OUTPUT.PUT_LINE('[INFO] ' ||V_ESQUEMA||'.'||V_TEXT_TABLA||'... Comentario creado.');
		
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.IDNOPE IS ''IDENTIFICADOR NUMERO DE OPERAC'' ';	
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.CODREG IS ''CODIGO DE REGISTRO'' ';         
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.COENTV IS ''COD. ENTIDAD URSUS'' ';            
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.FEEJFA IS ''AÑO DE EJERCICIO DE LA FACTURA'' ';
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.COCLDO IS ''CLASE DE DOCUMENTO IDENTIFICAD'' ';
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.NUDNIP IS ''CIF DNI DEL PROVEDOR'' ';    
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.COTIFA IS ''CODIGO TIPO DE FACTURA'' ';   
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.BISITF IS ''SIT. FACTURA'' ';    
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.CLCENT IS ''CLAVE CENTRO'' ';    
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.CLROLT IS ''CLAVE ROL TERCEROS'' ';    
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.CLMOPA IS ''COD. MODALIDAD PAGO'' ';           
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.COFOPG IS ''CODIGO FORMA DE PAGO'' ';     
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.COOPPA IS ''CODIGO DE TIPO DE OPERACION'' '; 
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.CLMNDA IS ''IDENTIFICADOR DE MONEDA'' ';  
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.IMNFAC IS ''IMP. TOTAL A PAGAR'' ';      
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.IMBFAC IS ''IMP. TOTAL FACTURA'' ';   
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.POCVAL IS ''TIPO CAMBIO'' ';       
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.NUFPRO IS ''NUMERO FACTURA PROVEEDOR'' ';   
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.FEEMFA IS ''FECHA EMISION FACTURA'' ';         
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.FEAUFA IS ''FECHA DE AUTORIZACION DE LA FA'' ';	
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.IMBAFA IS ''IMPORTE BASE IMPUESTO FACTURA'' ';	
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.COIMPT IS ''CODIGO DE TIPO DE IMPUESTO'' ';  	
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.CLTRET IS ''CLASE IMPUESTO'' ';              	
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.POIMAP IS ''POR. APLIC. IMPUESTO'' ';        	
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.IMTIMP IS ''IMPORTE IMPUESTOS'' ';           	
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.CLCENO IS ''CLAVE OFICINA'' ';               	
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.NUCONE IS ''NUMERO DE CONEXION'' ';          	
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.FMPAGN IS ''FECHA PAGO NO REAL'' ';          	
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.CLFIS1 IS ''TIPO ID. FISCAL TERCERO'' ';     	
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.COFIS1 IS ''COD. ID. FISCAL TERCERO'' ';     	
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.CLFIS2 IS ''TIPO ID. FISCAL TERCERO'' ';     	
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.COFIS2 IS ''COD. ID. FISCAL TERCERO'' ';     	
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.CLFIS3 IS ''TIPO ID. FISCAL TERCERO'' ';     	
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.COFIS3 IS ''COD. ID. FISCAL TERCERO'' ';     	
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.NURMSA IS ''NUMERO DE REMESA'' ';            	
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.BISUFA IS ''INDICADOR SUPLIDOS'' ';          
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.BIFREF IS ''IND. REFACTURABLE'' ';           	
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.BIANUL IS ''IND. ANULACION'' ';              	
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.CLRFRA IS ''COD. FACTURA RELACIONADA'' ';
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.COANOR IS ''EJE. FACTURA RELACIONADA'' ';      	
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.IDNOP1 IS ''IDENTIFICADOR NUMERO DE OPERAC'' ';	
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.COPPTO IS ''COD. PRESUPUESTO'' ';              
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.COPPST IS ''COD. PROPUESTA'' ';                	
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.CLSIST IS ''COD. SISTEMA'' ';
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.NUFPR1 IS ''NUMERO DE FACTURA DEL PROVEEDO'' ';
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.IDPROV IS ''IDENTIFICADOR DE PROVEEDOR'' ';
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.NUFPRA IS ''NUMERO FACTURA PROVEEDOR RELAC'' ';	
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.BIANFA IS ''INDICADOR ANULACION'' ';
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.NUFAAN IS ''NUMERO DE FACTURA ANULADA'' ';
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.COSPAT IS ''CÓDIGO DE SOCIEDAD PATRIMONIAL'' ';
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.FEDEVG IS ''FECHA DEVENGO'' ';
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.FEVENC IS ''FECHA VENCIMIENTO'' ';	
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.FEPAGA IS ''FECHA PAGO'' ';	
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.FECTBL IS ''FECHA CONTABILIZACIÓN'' ';	
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.NUFREM IS ''NUMERO IDENTIFICADOR EN REM''';	
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.FILLER IS ''espacio vacio '' ';
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.ERCOD9 IS ''NUMERO DEL ERROR PRODUCIDO'' ';

	DBMS_OUTPUT.PUT_LINE('[INFO] ' ||V_ESQUEMA||'.'||V_TEXT_TABLA||'... OK');

	COMMIT;
	
	
	/* KC11(DETALLE) */

	V_TEXT_TABLA := 'H_ASPRO_11_DETALLE'; 
    V_COMMENT_TABLE := 'Tabla auxiliar de salida para ASPRO, registro DETALLE.'; 
    V_COLUMN_TABLE_UNIQUE := '';

	DBMS_OUTPUT.PUT_LINE('********' ||V_TEXT_TABLA|| '********'); 
	DBMS_OUTPUT.PUT_LINE('[INFO] '||V_ESQUEMA||'.'||V_TEXT_TABLA||'... Comprobaciones previas');
	
	-- Verificar si la tabla ya existe
	V_MSQL := 'SELECT COUNT(1) FROM ALL_TABLES WHERE TABLE_NAME = '''||V_TEXT_TABLA||''' and owner = '''||V_ESQUEMA||'''';
	EXECUTE IMMEDIATE V_MSQL INTO V_NUM_TABLAS;	
	IF V_NUM_TABLAS = 1 THEN
		DBMS_OUTPUT.PUT_LINE('[INFO] ' || V_ESQUEMA || '.'||V_TEXT_TABLA||'... Ya existe. Se borrará.');
		EXECUTE IMMEDIATE 'DROP TABLE '||V_ESQUEMA||'.'||V_TEXT_TABLA||' CASCADE CONSTRAINTS';
		
	END IF;

	-- Comprobamos si existe la secuencia
	V_SQL := 'SELECT COUNT(1) FROM ALL_SEQUENCES WHERE SEQUENCE_NAME = ''S_'||V_TEXT_TABLA||''' and SEQUENCE_OWNER = '''||V_ESQUEMA||'''';
	EXECUTE IMMEDIATE V_SQL INTO V_NUM_TABLAS; 
	IF V_NUM_TABLAS = 1 THEN
		DBMS_OUTPUT.PUT_LINE('[INFO] '|| V_ESQUEMA ||'.S_'||V_TEXT_TABLA||'... Ya existe. Se borrará.');  
		EXECUTE IMMEDIATE 'DROP SEQUENCE '||V_ESQUEMA||'.S_'||V_TEXT_TABLA||'';
	END IF; 
	
	-- Creamos la tabla
	DBMS_OUTPUT.PUT_LINE('[INFO] ' ||V_ESQUEMA|| '.'||V_TEXT_TABLA||'...');
	V_MSQL := 'CREATE TABLE ' ||V_ESQUEMA||'.'||V_TEXT_TABLA||'
	(
		H_ASPRO_11_ID 		NUMBER (16),
		USUARIO_ENVIO 		VARCHAR2 (50 CHAR),
		FECHA_ENVIO 		DATE,
		USUARIO_RECEPCION	VARCHAR2 (50 CHAR),
		FECHA_RECEPCION		DATE,
		IDNOPE	VARCHAR2 (15 CHAR),
		CODREG	VARCHAR2 (1 CHAR),
		COENTV	VARCHAR2 (7 CHAR),
		FEEJFA	VARCHAR2 (4 CHAR),
		COMOVT	VARCHAR2 (6 CHAR),
		GPV_ID	NUMBER(16,0),
		COCOCN	VARCHAR2 (5 CHAR),
		IMBAFA	VARCHAR2 (15 CHAR),
		COIMPT	VARCHAR2 (2 CHAR),
		CLTRET	VARCHAR2 (20 CHAR),
		POIMAP	VARCHAR2 (5 CHAR),
		IMTIMP	VARCHAR2 (15 CHAR),
		BIINMV	VARCHAR2 (1 CHAR),
		BIRECL	VARCHAR2 (1 CHAR),
		LIMOVT	VARCHAR2 (254 CHAR),
		COSURC	VARCHAR2 (2 CHAR),
		COACES	VARCHAR2 (9 CHAR),
		NUINMU	VARCHAR2 (9 CHAR),
		IDCASP	VARCHAR2 (10 CHAR),
		COCCSSA	VARCHAR2 (10 CHAR),
		IDPASA	VARCHAR2 (20 CHAR),
		FILLER	VARCHAR2 (186 CHAR),
		ERCOD9	VARCHAR2 (3 CHAR)
	)
	LOGGING 
	NOCOMPRESS 
	NOCACHE
	NOPARALLEL
	NOMONITORING
	';
	EXECUTE IMMEDIATE V_MSQL;
	DBMS_OUTPUT.PUT_LINE('[INFO] ' ||V_ESQUEMA||'.'||V_TEXT_TABLA||'... Tabla creada.');
	
	
	-- Creamos indice	
	V_MSQL := 'CREATE UNIQUE INDEX '||V_ESQUEMA||'.'||V_TEXT_TABLA||'_PK ON '||V_ESQUEMA|| '.'||V_TEXT_TABLA||'(H_ASPRO_11_ID) TABLESPACE '||V_TABLESPACE_IDX;		
	EXECUTE IMMEDIATE V_MSQL;
	DBMS_OUTPUT.PUT_LINE('[INFO] ' ||V_ESQUEMA||'.'||V_TEXT_TABLA||'_PK... Indice creado.');
	
	-- Creamos primary key
	V_MSQL := 'ALTER TABLE '||V_ESQUEMA||'.'||V_TEXT_TABLA||' ADD (CONSTRAINT '||V_TEXT_TABLA||'_PK PRIMARY KEY (H_ASPRO_11_ID) USING INDEX)';
	EXECUTE IMMEDIATE V_MSQL;
	DBMS_OUTPUT.PUT_LINE('[INFO] ' ||V_ESQUEMA||'.'||V_TEXT_TABLA||'_PK... PK creada.');
	/*
	-- Creamos constraint unique 
	V_MSQL := 'ALTER TABLE '||V_ESQUEMA||'.'||V_TEXT_TABLA||' ADD (CONSTRAINT '||V_TEXT_TABLA||'_UN UNIQUE ('||V_COLUMN_TABLE_UNIQUE||') USING INDEX)';
	EXECUTE IMMEDIATE V_MSQL;
	DBMS_OUTPUT.PUT_LINE('[INFO] ' ||V_ESQUEMA||'.'||V_TEXT_TABLA||'_UN... Restriccion ('||V_TEXT_TABLA||'_UN) creada sobre campo '||V_COLUMN_TABLE_UNIQUE||'.');
	*/
	
	-- Creamos sequence
	V_MSQL := 'CREATE SEQUENCE '||V_ESQUEMA||'.S_'||V_TEXT_TABLA||'';		
	EXECUTE IMMEDIATE V_MSQL;		
	DBMS_OUTPUT.PUT_LINE('[INFO] '||V_ESQUEMA||'.S_'||V_TEXT_TABLA||'... Secuencia creada');
	
	-- Creamos comentario	
	V_MSQL := 'COMMENT ON TABLE '||V_ESQUEMA||'.'||V_TEXT_TABLA||' IS '''||V_COMMENT_TABLE||'''';		
	EXECUTE IMMEDIATE V_MSQL;
	DBMS_OUTPUT.PUT_LINE('[INFO] ' ||V_ESQUEMA||'.'||V_TEXT_TABLA||'... Comentario creado.');
	
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.IDNOPE IS ''IDENTIFICADOR NUMERO DE OPERAC'' ';
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.CODREG IS ''CODIGO DE REGISTRO'' ';
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.COENTV IS ''COD. ENTIDAD URSUS'' ';
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.FEEJFA IS ''AÑO DE EJERCICIO DE LA FACTURA'' ';
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.COMOVT IS ''NUM. MOVIMIENTO DETALLE'' ';
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.COCOCN IS ''COD CONCEPTO CONTABLE'' ';
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.IMBAFA IS ''IMPORTE BASE IMPUESTO FACTURA'' ';
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.COIMPT IS ''CODIGO DE TIPO DE IMPUESTO'' ';
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.CLTRET IS ''CLASE IMPUESTO'' ';
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.POIMAP IS ''POR. APLIC. IMPUESTO'' ';
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.IMTIMP IS ''IMPORTE IMPUESTOS'' ';
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.BIINMV IS ''IND. INMOVILIZADO'' ';
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.BIRECL IS ''IND. RECLASIFICADO'' ';
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.LIMOVT IS ''DES. MOVIMIENTO (max. 243)'' ';
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.COSURC IS ''CODIGO SUBTIPO DE RECIBO'' ';
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.COACES IS ''IDENTIFICADOR ACTIVO ESPECIAL'' ';
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.NUINMU IS ''NUMERO DE FICHA EN INMOVILIZAD'' ';
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.IDCASP IS ''-'' ';	
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.COCCSSA IS ''CUENTA CONTABLE ASPRO'' ';
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.IDPASA IS ''PARTIDA PRESUPUESTARIA ASPRO'' ';
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.FILLER IS ''espacio reservado'' ';	                              
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.ERCOD9 IS ''NUMERO DEL ERROR PRODUCIDO'' ';


	DBMS_OUTPUT.PUT_LINE('[INFO] ' ||V_ESQUEMA||'.'||V_TEXT_TABLA||'... OK');

	COMMIT;
	
	
	/* CK12(INMOVILIZADO) */

	V_TEXT_TABLA := 'H_ASPRO_12_INMOVILIZADO'; 
    V_COMMENT_TABLE := 'Tabla auxiliar de salida para ASPRO, registro INMOVILIZADO.'; 
    V_COLUMN_TABLE_UNIQUE := '';

	DBMS_OUTPUT.PUT_LINE('********' ||V_TEXT_TABLA|| '********'); 
	DBMS_OUTPUT.PUT_LINE('[INFO] '||V_ESQUEMA||'.'||V_TEXT_TABLA||'... Comprobaciones previas');
	
	-- Verificar si la tabla ya existe
	V_MSQL := 'SELECT COUNT(1) FROM ALL_TABLES WHERE TABLE_NAME = '''||V_TEXT_TABLA||''' and owner = '''||V_ESQUEMA||'''';
	EXECUTE IMMEDIATE V_MSQL INTO V_NUM_TABLAS;	
	IF V_NUM_TABLAS = 1 THEN
		DBMS_OUTPUT.PUT_LINE('[INFO] ' || V_ESQUEMA || '.'||V_TEXT_TABLA||'... Ya existe. Se borrará.');
		EXECUTE IMMEDIATE 'DROP TABLE '||V_ESQUEMA||'.'||V_TEXT_TABLA||' CASCADE CONSTRAINTS';
		
	END IF;

	-- Comprobamos si existe la secuencia
	V_SQL := 'SELECT COUNT(1) FROM ALL_SEQUENCES WHERE SEQUENCE_NAME = ''S_'||V_TEXT_TABLA||''' and SEQUENCE_OWNER = '''||V_ESQUEMA||'''';
	EXECUTE IMMEDIATE V_SQL INTO V_NUM_TABLAS; 
	IF V_NUM_TABLAS = 1 THEN
		DBMS_OUTPUT.PUT_LINE('[INFO] '|| V_ESQUEMA ||'.S_'||V_TEXT_TABLA||'... Ya existe. Se borrará.');  
		EXECUTE IMMEDIATE 'DROP SEQUENCE '||V_ESQUEMA||'.S_'||V_TEXT_TABLA||'';
	END IF; 
	
	-- Creamos la tabla
	DBMS_OUTPUT.PUT_LINE('[INFO] ' ||V_ESQUEMA|| '.'||V_TEXT_TABLA||'...');
	V_MSQL := 'CREATE TABLE ' ||V_ESQUEMA||'.'||V_TEXT_TABLA||'
	(
		H_ASPRO_12_ID 		NUMBER (16),
		USUARIO_ENVIO 		VARCHAR2 (50 CHAR),
		FECHA_ENVIO 		DATE,
		USUARIO_RECEPCION	VARCHAR2 (50 CHAR),
		FECHA_RECEPCION		DATE,
		IDNOPE 	VARCHAR2 (15 CHAR),
		CODREG	VARCHAR2 (1 CHAR),
		COENTV	VARCHAR2 (7 CHAR),
		FEEJFA	VARCHAR2 (4 CHAR),
		COMOVT	VARCHAR2 (6 CHAR),
		GPV_ID	NUMBER(16,0),
		COENIV	VARCHAR2 (7 CHAR),
		NUINMU	VARCHAR2 (9 CHAR),
		CLDINM	VARCHAR2 (2 CHAR),
		IMNGAS	VARCHAR2 (15 CHAR),
		POINMV	VARCHAR2 (5 CHAR),
		COTIFA	VARCHAR2 (1 CHAR),
		CAMAOC	VARCHAR2 (1 CHAR),
		COACES	VARCHAR2 (9 CHAR),
		FILLER	VARCHAR2 (515 CHAR),
		ERCOD9	VARCHAR2 (3 CHAR)		
	)
	LOGGING 
	NOCOMPRESS 
	NOCACHE
	NOPARALLEL
	NOMONITORING
	';
	EXECUTE IMMEDIATE V_MSQL;
	DBMS_OUTPUT.PUT_LINE('[INFO] ' ||V_ESQUEMA||'.'||V_TEXT_TABLA||'... Tabla creada.');
	
	
	-- Creamos indice	
	V_MSQL := 'CREATE UNIQUE INDEX '||V_ESQUEMA||'.'||V_TEXT_TABLA||'_PK ON '||V_ESQUEMA|| '.'||V_TEXT_TABLA||'(H_ASPRO_12_ID) TABLESPACE '||V_TABLESPACE_IDX;		
	EXECUTE IMMEDIATE V_MSQL;
	DBMS_OUTPUT.PUT_LINE('[INFO] ' ||V_ESQUEMA||'.'||V_TEXT_TABLA||'_PK... Indice creado.');
	
	-- Creamos primary key
	V_MSQL := 'ALTER TABLE '||V_ESQUEMA||'.'||V_TEXT_TABLA||' ADD (CONSTRAINT '||V_TEXT_TABLA||'_PK PRIMARY KEY (H_ASPRO_12_ID) USING INDEX)';
	EXECUTE IMMEDIATE V_MSQL;
	DBMS_OUTPUT.PUT_LINE('[INFO] ' ||V_ESQUEMA||'.'||V_TEXT_TABLA||'_PK... PK creada.');
	/*
	-- Creamos constraint unique 
	V_MSQL := 'ALTER TABLE '||V_ESQUEMA||'.'||V_TEXT_TABLA||' ADD (CONSTRAINT '||V_TEXT_TABLA||'_UN UNIQUE ('||V_COLUMN_TABLE_UNIQUE||') USING INDEX)';
	EXECUTE IMMEDIATE V_MSQL;
	DBMS_OUTPUT.PUT_LINE('[INFO] ' ||V_ESQUEMA||'.'||V_TEXT_TABLA||'_UN... Restriccion ('||V_TEXT_TABLA||'_UN) creada sobre campo '||V_COLUMN_TABLE_UNIQUE||'.');
	*/
	
	-- Creamos sequence
	V_MSQL := 'CREATE SEQUENCE '||V_ESQUEMA||'.S_'||V_TEXT_TABLA||'';		
	EXECUTE IMMEDIATE V_MSQL;		
	DBMS_OUTPUT.PUT_LINE('[INFO] '||V_ESQUEMA||'.S_'||V_TEXT_TABLA||'... Secuencia creada');
	
	-- Creamos comentario	
	V_MSQL := 'COMMENT ON TABLE '||V_ESQUEMA||'.'||V_TEXT_TABLA||' IS '''||V_COMMENT_TABLE||'''';		
	EXECUTE IMMEDIATE V_MSQL;
	DBMS_OUTPUT.PUT_LINE('[INFO] ' ||V_ESQUEMA||'.'||V_TEXT_TABLA||'... Comentario creado.');
	
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.IDNOPE IS ''IDENTIFICADOR NUMERO DE OPERAC'' ';	
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.CODREG IS ''CODIGO DE REGISTRO'' ';	
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.COENTV IS ''COD. ENTIDAD URSUS'' ';	
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.FEEJFA IS ''AÑO DE EJERCICIO DE LA FACTURA'' ';	
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.COMOVT IS ''NUM. MOVIMIENTO DETALLE	9(6)'' ';	
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.COENIV IS ''COD. ENTIDAD INMOVILIZADO'' ';	
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.NUINMU IS ''NUMERO DE FICHA EN INMOVILIZAD'' ';	
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.CLDINM IS ''COD. DETALLE INMOVILIZADO'' ';	
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.IMNGAS IS ''IMPORTE DEL GASTO'' ';	
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.POINMV IS ''PORCENTAJE INMOVILIZADO'' ';	
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.COTIFA IS ''CODIGO TIPO DE FACTURA'' ';	
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.CAMAOC IS ''NUMERO MAX. DE OCURRENCIAS REL'' ';	
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.COACES IS ''IDENTIFICADOR ACTIVO ESPECIAL'' ';	
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.FILLER IS ''espacio reservado'' ';	
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.ERCOD9 IS ''NUMERO DEL ERROR PRODUCIDO'' ';	

	DBMS_OUTPUT.PUT_LINE('[INFO] ' ||V_ESQUEMA||'.'||V_TEXT_TABLA||'... OK');

	COMMIT;

	/* KC14(PAGO) */

	V_TEXT_TABLA := 'H_ASPRO_14_PAGO'; 
    V_COMMENT_TABLE := 'Tabla auxiliar de salida para ASPRO, registro PAGO.'; 
    V_COLUMN_TABLE_UNIQUE := '';

	DBMS_OUTPUT.PUT_LINE('********' ||V_TEXT_TABLA|| '********'); 
	DBMS_OUTPUT.PUT_LINE('[INFO] '||V_ESQUEMA||'.'||V_TEXT_TABLA||'... Comprobaciones previas');
	
	-- Verificar si la tabla ya existe
	V_MSQL := 'SELECT COUNT(1) FROM ALL_TABLES WHERE TABLE_NAME = '''||V_TEXT_TABLA||''' and owner = '''||V_ESQUEMA||'''';
	EXECUTE IMMEDIATE V_MSQL INTO V_NUM_TABLAS;	
	IF V_NUM_TABLAS = 1 THEN
		DBMS_OUTPUT.PUT_LINE('[INFO] ' || V_ESQUEMA || '.'||V_TEXT_TABLA||'... Ya existe. Se borrará.');
		EXECUTE IMMEDIATE 'DROP TABLE '||V_ESQUEMA||'.'||V_TEXT_TABLA||' CASCADE CONSTRAINTS';
		
	END IF;

	-- Comprobamos si existe la secuencia
	V_SQL := 'SELECT COUNT(1) FROM ALL_SEQUENCES WHERE SEQUENCE_NAME = ''S_'||V_TEXT_TABLA||''' and SEQUENCE_OWNER = '''||V_ESQUEMA||'''';
	EXECUTE IMMEDIATE V_SQL INTO V_NUM_TABLAS; 
	IF V_NUM_TABLAS = 1 THEN
		DBMS_OUTPUT.PUT_LINE('[INFO] '|| V_ESQUEMA ||'.S_'||V_TEXT_TABLA||'... Ya existe. Se borrará.');  
		EXECUTE IMMEDIATE 'DROP SEQUENCE '||V_ESQUEMA||'.S_'||V_TEXT_TABLA||'';
	END IF; 
	
	-- Creamos la tabla
	DBMS_OUTPUT.PUT_LINE('[INFO] ' ||V_ESQUEMA|| '.'||V_TEXT_TABLA||'...');
	V_MSQL := 'CREATE TABLE ' ||V_ESQUEMA||'.'||V_TEXT_TABLA||'
	(
		H_ASPRO_14_ID 		NUMBER (16),
		USUARIO_ENVIO 		VARCHAR2 (50 CHAR),
		FECHA_ENVIO 		DATE,
		USUARIO_RECEPCION	VARCHAR2 (50 CHAR),
		FECHA_RECEPCION		DATE,
		IDNOPE VARCHAR2(15 CHAR),
		CODREG VARCHAR2(1 CHAR),
		COENTV VARCHAR2(7 CHAR),
		FEEJFA VARCHAR2(4 CHAR),
		COMOVT VARCHAR2(6 CHAR),
		GPV_ID	NUMBER(16,0),
		FEPAGA VARCHAR2(8 CHAR),
		COFOPG VARCHAR2(2 CHAR),
		CLCONH VARCHAR2(5 CHAR),
		IMPAGF VARCHAR2(15 CHAR),
		OBTEXF VARCHAR2(60 CHAR),
		NUCHQT VARCHAR2(12 CHAR),
		NUCCCP VARCHAR2(20 CHAR),
		COCLDT VARCHAR2(1 CHAR),
		NUDNIT VARCHAR2(10 CHAR),
		NOMTER VARCHAR2(40 CHAR),
		FILLER VARCHAR2(391 CHAR), 
		ERCOD9 VARCHAR2(3 CHAR)
	)
	LOGGING 
	NOCOMPRESS 
	NOCACHE
	NOPARALLEL
	NOMONITORING
	';
	EXECUTE IMMEDIATE V_MSQL;
	DBMS_OUTPUT.PUT_LINE('[INFO] ' ||V_ESQUEMA||'.'||V_TEXT_TABLA||'... Tabla creada.');
	
	
	-- Creamos indice	
	V_MSQL := 'CREATE UNIQUE INDEX '||V_ESQUEMA||'.'||V_TEXT_TABLA||'_PK ON '||V_ESQUEMA|| '.'||V_TEXT_TABLA||'(H_ASPRO_14_ID) TABLESPACE '||V_TABLESPACE_IDX;		
	EXECUTE IMMEDIATE V_MSQL;
	DBMS_OUTPUT.PUT_LINE('[INFO] ' ||V_ESQUEMA||'.'||V_TEXT_TABLA||'_PK... Indice creado.');
	
	-- Creamos primary key
	V_MSQL := 'ALTER TABLE '||V_ESQUEMA||'.'||V_TEXT_TABLA||' ADD (CONSTRAINT '||V_TEXT_TABLA||'_PK PRIMARY KEY (H_ASPRO_14_ID) USING INDEX)';
	EXECUTE IMMEDIATE V_MSQL;
	DBMS_OUTPUT.PUT_LINE('[INFO] ' ||V_ESQUEMA||'.'||V_TEXT_TABLA||'_PK... PK creada.');
	/*
	-- Creamos constraint unique 
	V_MSQL := 'ALTER TABLE '||V_ESQUEMA||'.'||V_TEXT_TABLA||' ADD (CONSTRAINT '||V_TEXT_TABLA||'_UN UNIQUE ('||V_COLUMN_TABLE_UNIQUE||') USING INDEX)';
	EXECUTE IMMEDIATE V_MSQL;
	DBMS_OUTPUT.PUT_LINE('[INFO] ' ||V_ESQUEMA||'.'||V_TEXT_TABLA||'_UN... Restriccion ('||V_TEXT_TABLA||'_UN) creada sobre campo '||V_COLUMN_TABLE_UNIQUE||'.');
	*/
	
	-- Creamos sequence
	V_MSQL := 'CREATE SEQUENCE '||V_ESQUEMA||'.S_'||V_TEXT_TABLA||'';		
	EXECUTE IMMEDIATE V_MSQL;		
	DBMS_OUTPUT.PUT_LINE('[INFO] '||V_ESQUEMA||'.S_'||V_TEXT_TABLA||'... Secuencia creada');
	
	-- Creamos comentario	
	V_MSQL := 'COMMENT ON TABLE '||V_ESQUEMA||'.'||V_TEXT_TABLA||' IS '''||V_COMMENT_TABLE||'''';		
	EXECUTE IMMEDIATE V_MSQL;
	DBMS_OUTPUT.PUT_LINE('[INFO] ' ||V_ESQUEMA||'.'||V_TEXT_TABLA||'... Comentario creado.');
	
	
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.IDNOPE IS ''IDENTIFICADOR NUMERO DE OPERAC'' ';
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.CODREG IS ''CODIGO DE REGISTRO'' ';
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.COENTV IS ''COD. ENTIDAD URSUS'' '; 
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.FEEJFA IS ''AÑO DE EJERCICIO DE LA FACTURA'' ';
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.COMOVT IS ''NUM. PAGO/COBRO'' ';  
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.FEPAGA IS ''FECHA DEL PAGO'' ';       
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.COFOPG IS ''CODIGO FORMA DE PAGO'' ';  
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.CLCONH IS ''CLAVE CONCEPTO FICHA'' ';    
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.IMPAGF IS ''IMP. PAGO/COBRO'' ';     
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.OBTEXF IS ''DESCRIPCION DE LA FACTURA'' ';
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.NUCHQT IS ''NUMERO CHEQUE'' ';    
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.NUCCCP IS ''NUMERO CTA CCC TERCERO'' ';  
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.COCLDT IS ''TIPO DOCUMENTO TERCERO'' ';  
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.NUDNIT IS ''NUMERO DOCUMENTO TERCERO'' ';  
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.NOMTER IS ''NOMBRE TERCERO'' ';  
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.FILLER IS ''espacio reservado'' ';	                   
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.ERCOD9 IS ''NUMERO DEL ERROR PRODUCIDO'' ';    
	
	DBMS_OUTPUT.PUT_LINE('[INFO] ' ||V_ESQUEMA||'.'||V_TEXT_TABLA||'... OK');

	COMMIT;
	
	/* KC15(PROVEEDOR) */

	V_TEXT_TABLA := 'H_ASPRO_15_PROVEEDOR'; 
    V_COMMENT_TABLE := 'Tabla auxiliar de salida para ASPRO, registro PROVEEDOR.'; 
    V_COLUMN_TABLE_UNIQUE := '';

	DBMS_OUTPUT.PUT_LINE('********' ||V_TEXT_TABLA|| '********'); 
	DBMS_OUTPUT.PUT_LINE('[INFO] '||V_ESQUEMA||'.'||V_TEXT_TABLA||'... Comprobaciones previas');
	
	-- Verificar si la tabla ya existe
	V_MSQL := 'SELECT COUNT(1) FROM ALL_TABLES WHERE TABLE_NAME = '''||V_TEXT_TABLA||''' and owner = '''||V_ESQUEMA||'''';
	EXECUTE IMMEDIATE V_MSQL INTO V_NUM_TABLAS;	
	IF V_NUM_TABLAS = 1 THEN
		DBMS_OUTPUT.PUT_LINE('[INFO] ' || V_ESQUEMA || '.'||V_TEXT_TABLA||'... Ya existe. Se borrará.');
		EXECUTE IMMEDIATE 'DROP TABLE '||V_ESQUEMA||'.'||V_TEXT_TABLA||' CASCADE CONSTRAINTS';
		
	END IF;

	-- Comprobamos si existe la secuencia
	V_SQL := 'SELECT COUNT(1) FROM ALL_SEQUENCES WHERE SEQUENCE_NAME = ''S_'||V_TEXT_TABLA||''' and SEQUENCE_OWNER = '''||V_ESQUEMA||'''';
	EXECUTE IMMEDIATE V_SQL INTO V_NUM_TABLAS; 
	IF V_NUM_TABLAS = 1 THEN
		DBMS_OUTPUT.PUT_LINE('[INFO] '|| V_ESQUEMA ||'.S_'||V_TEXT_TABLA||'... Ya existe. Se borrará.');  
		EXECUTE IMMEDIATE 'DROP SEQUENCE '||V_ESQUEMA||'.S_'||V_TEXT_TABLA||'';
	END IF; 
	
	-- Creamos la tabla
	DBMS_OUTPUT.PUT_LINE('[INFO] ' ||V_ESQUEMA|| '.'||V_TEXT_TABLA||'...');
	V_MSQL := 'CREATE TABLE ' ||V_ESQUEMA||'.'||V_TEXT_TABLA||'
	(
		H_ASPRO_15_ID 		NUMBER (16),
		USUARIO_ENVIO 		VARCHAR2 (50 CHAR),
		FECHA_ENVIO 		DATE,
		USUARIO_RECEPCION	VARCHAR2 (50 CHAR),
		FECHA_RECEPCION		DATE,
		IDNOPE 	VARCHAR2 (15 CHAR),
		CODREG	VARCHAR2 (1 CHAR),
		COENTV	VARCHAR2 (7 CHAR),
		FEEJFA	VARCHAR2 (4 CHAR),
		NUDNIP	VARCHAR2 (10 CHAR),
		NOPDOR	VARCHAR2 (40 CHAR),
		COVIPR	VARCHAR2 (2 CHAR),
		NOVIAP	VARCHAR2 (60 CHAR),
		NUPOPR	VARCHAR2 (17 CHAR),
		NUESPR	VARCHAR2 (5 CHAR),
		NUPIPR	VARCHAR2 (11 CHAR),
		NUPUPR	VARCHAR2 (17 CHAR),
		COMUPR	VARCHAR2 (9 CHAR),
		NOMUPR	VARCHAR2 (30 CHAR),
		COPOPR	VARCHAR2 (5 CHAR),
		NOPRPP	VARCHAR2 (18 CHAR),
		OBNCON	VARCHAR2 (30 CHAR),
		NUTEOV	VARCHAR2 (14 CHAR),
		NOEMAI	VARCHAR2 (55 CHAR),
		NUCCEN	VARCHAR2 (4 CHAR),
		NUCCOF	VARCHAR2 (4 CHAR), 
		NUCCDI	VARCHAR2 (2 CHAR),
		NUCCNT	VARCHAR2 (10 CHAR),
		FILLER	VARCHAR2 (227 CHAR),
		ERCOD9	VARCHAR2 (3 CHAR)		
	)
	LOGGING 
	NOCOMPRESS 
	NOCACHE
	NOPARALLEL
	NOMONITORING
	';
	EXECUTE IMMEDIATE V_MSQL;
	DBMS_OUTPUT.PUT_LINE('[INFO] ' ||V_ESQUEMA||'.'||V_TEXT_TABLA||'... Tabla creada.');
	
	-- Creamos indice	
	V_MSQL := 'CREATE UNIQUE INDEX '||V_ESQUEMA||'.'||V_TEXT_TABLA||'_PK ON '||V_ESQUEMA|| '.'||V_TEXT_TABLA||'(H_ASPRO_15_ID) TABLESPACE '||V_TABLESPACE_IDX;		
	EXECUTE IMMEDIATE V_MSQL;
	DBMS_OUTPUT.PUT_LINE('[INFO] ' ||V_ESQUEMA||'.'||V_TEXT_TABLA||'_PK... Indice creado.');
	
	-- Creamos primary key
	V_MSQL := 'ALTER TABLE '||V_ESQUEMA||'.'||V_TEXT_TABLA||' ADD (CONSTRAINT '||V_TEXT_TABLA||'_PK PRIMARY KEY (H_ASPRO_15_ID) USING INDEX)';
	EXECUTE IMMEDIATE V_MSQL;
	DBMS_OUTPUT.PUT_LINE('[INFO] ' ||V_ESQUEMA||'.'||V_TEXT_TABLA||'_PK... PK creada.');
	/*
	-- Creamos constraint unique 
	V_MSQL := 'ALTER TABLE '||V_ESQUEMA||'.'||V_TEXT_TABLA||' ADD (CONSTRAINT '||V_TEXT_TABLA||'_UN UNIQUE ('||V_COLUMN_TABLE_UNIQUE||') USING INDEX)';
	EXECUTE IMMEDIATE V_MSQL;
	DBMS_OUTPUT.PUT_LINE('[INFO] ' ||V_ESQUEMA||'.'||V_TEXT_TABLA||'_UN... Restriccion ('||V_TEXT_TABLA||'_UN) creada sobre campo '||V_COLUMN_TABLE_UNIQUE||'.');
	*/
	
	-- Creamos sequence
	V_MSQL := 'CREATE SEQUENCE '||V_ESQUEMA||'.S_'||V_TEXT_TABLA||'';		
	EXECUTE IMMEDIATE V_MSQL;		
	DBMS_OUTPUT.PUT_LINE('[INFO] '||V_ESQUEMA||'.S_'||V_TEXT_TABLA||'... Secuencia creada');
	
	-- Creamos comentario	
	V_MSQL := 'COMMENT ON TABLE '||V_ESQUEMA||'.'||V_TEXT_TABLA||' IS '''||V_COMMENT_TABLE||'''';		
	EXECUTE IMMEDIATE V_MSQL;
	DBMS_OUTPUT.PUT_LINE('[INFO] ' ||V_ESQUEMA||'.'||V_TEXT_TABLA||'... Comentario creado.');

	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.IDNOPE IS ''IDENTIFICADOR NUMERO DE OPERAC'' ';
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.CODREG IS ''CODIGO DE REGISTRO'' ';
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.COENTV IS ''COD. ENTIDAD URSUS'' ';
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.FEEJFA IS ''AÑO DE EJERCICIO DE LA FACTURA'' ';
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.NUDNIP IS ''CIF DNI DEL PROVEDOR'' ';
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.NOPDOR IS ''NOMBRE DE PROVEEDOR'' ';
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.COVIPR IS ''CODIGO TIPO DE VIA'' ';
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.NOVIAP IS ''NOMBRE DE LA VIA'' ';
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.NUPOPR IS ''PORTAL PUNTO KILOMETRICO'' ';
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.NUESPR IS ''ESCALERA'' ';
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.NUPIPR IS ''PISO'' ';
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.NUPUPR IS ''NUMERO DE PUERTA'' ';
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.COMUPR IS ''CODIGO DE MUNICIPIO'' ';
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.NOMUPR IS ''NOMBRE DEL MUNICIPIO'' ';
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.COPOPR IS ''CODIGO POSTAL'' ';
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.NOPRPP IS ''NOMBRE DE LA PROVINCIA'' ';
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.OBNCON IS ''CONTACTO'' ';
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.NUTEOV IS ''NUMERO DE TELEFONO DEL PROVEED'' ';
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.NOEMAI IS ''DIRECCION EMAIL'' ';
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.NUCCEN IS ''NUMERO CUENTA (ENTIDAD)'' ';
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.NUCCOF IS ''NUMERO CUENTA (OFICINA)'' ';
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.NUCCDI IS ''NUMERO CUENTA (DIGITOS CONTROL'' ';
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.NUCCNT IS ''NUMERO CUENTA'' ';
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.FILLER IS ''espacio_reservado'' ';
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.ERCOD9 IS ''NUMERO DEL ERROR PRODUCIDO'' ';
	
	DBMS_OUTPUT.PUT_LINE('[INFO] ' ||V_ESQUEMA||'.'||V_TEXT_TABLA||'... OK');

	COMMIT;
	
	
	/* KC16(CLIENTE) */

	V_TEXT_TABLA := 'H_ASPRO_16_CLIENTE'; 
    V_COMMENT_TABLE := 'Tabla auxiliar de salida para ASPRO, registro CLIENTE.'; 
    V_COLUMN_TABLE_UNIQUE := '';

	DBMS_OUTPUT.PUT_LINE('********' ||V_TEXT_TABLA|| '********'); 
	DBMS_OUTPUT.PUT_LINE('[INFO] '||V_ESQUEMA||'.'||V_TEXT_TABLA||'... Comprobaciones previas');
	
	-- Verificar si la tabla ya existe
	V_MSQL := 'SELECT COUNT(1) FROM ALL_TABLES WHERE TABLE_NAME = '''||V_TEXT_TABLA||''' and owner = '''||V_ESQUEMA||'''';
	EXECUTE IMMEDIATE V_MSQL INTO V_NUM_TABLAS;	
	IF V_NUM_TABLAS = 1 THEN
		DBMS_OUTPUT.PUT_LINE('[INFO] ' || V_ESQUEMA || '.'||V_TEXT_TABLA||'... Ya existe. Se borrará.');
		EXECUTE IMMEDIATE 'DROP TABLE '||V_ESQUEMA||'.'||V_TEXT_TABLA||' CASCADE CONSTRAINTS';
		
	END IF;

	-- Comprobamos si existe la secuencia
	V_SQL := 'SELECT COUNT(1) FROM ALL_SEQUENCES WHERE SEQUENCE_NAME = ''S_'||V_TEXT_TABLA||''' and SEQUENCE_OWNER = '''||V_ESQUEMA||'''';
	EXECUTE IMMEDIATE V_SQL INTO V_NUM_TABLAS; 
	IF V_NUM_TABLAS = 1 THEN
		DBMS_OUTPUT.PUT_LINE('[INFO] '|| V_ESQUEMA ||'.S_'||V_TEXT_TABLA||'... Ya existe. Se borrará.');  
		EXECUTE IMMEDIATE 'DROP SEQUENCE '||V_ESQUEMA||'.S_'||V_TEXT_TABLA||'';
	END IF; 
	
	-- Creamos la tabla
	DBMS_OUTPUT.PUT_LINE('[INFO] ' ||V_ESQUEMA|| '.'||V_TEXT_TABLA||'...');
	V_MSQL := 'CREATE TABLE ' ||V_ESQUEMA||'.'||V_TEXT_TABLA||'
	(
		H_ASPRO_16_ID 		NUMBER (16),
		USUARIO_ENVIO 		VARCHAR2 (50 CHAR),
		FECHA_ENVIO 		DATE,
		USUARIO_RECEPCION	VARCHAR2 (50 CHAR),
		FECHA_RECEPCION		DATE,
		IDNOPE 	VARCHAR2 (15 CHAR),
		CODREG	VARCHAR2 (1 CHAR),
		COENTV	VARCHAR2 (7 CHAR),
		FEEJFA	VARCHAR2 (4 CHAR),
		COXIDE	VARCHAR2 (2 CHAR),
		IDXDOC	VARCHAR2 (20 CHAR),
		COCPER	VARCHAR2 (1 CHAR),
		OBNOCL	VARCHAR2 (30 CHAR),
		OBA1CL	VARCHAR2 (30 CHAR),
		OBA2CL	VARCHAR2 (30 CHAR),
		COTVIA	VARCHAR2 (5 CHAR),
		NOVIA3	VARCHAR2 (30 CHAR),
		NUVIAX	VARCHAR2 (30 CHAR),
		NUESCX	VARCHAR2 (10 CHAR),
		NUXPLA	VARCHAR2 (10 CHAR),
		NUXPUE	VARCHAR2 (10 CHAR),
		COXPOS	VARCHAR2 (20 CHAR),
		NBPOBL	VARCHAR2 (30 CHAR),
		NOPRO3	VARCHAR2 (30 CHAR),
		OBTELE	VARCHAR2 (30 CHAR),
		OBTELO	VARCHAR2 (30 CHAR),
		OBFAXT	VARCHAR2 (30 CHAR),
		ITMAIL	VARCHAR2 (80 CHAR),
		COESCC	VARCHAR2 (2 CHAR),
		COREBI	VARCHAR2 (2 CHAR),
		COSEXO	VARCHAR2 (1 CHAR),
		COPAIN	VARCHAR2 (3 CHAR),
		COPAIR	VARCHAR2 (3 CHAR),
		OBNOC2	VARCHAR2 (60 CHAR),
		FILLER	VARCHAR2 (102 CHAR),
		ERCOD9	VARCHAR2 (3 CHAR)
	)
	LOGGING 
	NOCOMPRESS 
	NOCACHE
	NOPARALLEL
	NOMONITORING
	';
	EXECUTE IMMEDIATE V_MSQL;
	DBMS_OUTPUT.PUT_LINE('[INFO] ' ||V_ESQUEMA||'.'||V_TEXT_TABLA||'... Tabla creada.');
	
	-- Creamos indice	
	V_MSQL := 'CREATE UNIQUE INDEX '||V_ESQUEMA||'.'||V_TEXT_TABLA||'_PK ON '||V_ESQUEMA|| '.'||V_TEXT_TABLA||'(H_ASPRO_16_ID) TABLESPACE '||V_TABLESPACE_IDX;		
	EXECUTE IMMEDIATE V_MSQL;
	DBMS_OUTPUT.PUT_LINE('[INFO] ' ||V_ESQUEMA||'.'||V_TEXT_TABLA||'_PK... Indice creado.');
	
	-- Creamos primary key
	V_MSQL := 'ALTER TABLE '||V_ESQUEMA||'.'||V_TEXT_TABLA||' ADD (CONSTRAINT '||V_TEXT_TABLA||'_PK PRIMARY KEY (H_ASPRO_16_ID) USING INDEX)';
	EXECUTE IMMEDIATE V_MSQL;
	DBMS_OUTPUT.PUT_LINE('[INFO] ' ||V_ESQUEMA||'.'||V_TEXT_TABLA||'_PK... PK creada.');
	/*
	-- Creamos constraint unique 
	V_MSQL := 'ALTER TABLE '||V_ESQUEMA||'.'||V_TEXT_TABLA||' ADD (CONSTRAINT '||V_TEXT_TABLA||'_UN UNIQUE ('||V_COLUMN_TABLE_UNIQUE||') USING INDEX)';
	EXECUTE IMMEDIATE V_MSQL;
	DBMS_OUTPUT.PUT_LINE('[INFO] ' ||V_ESQUEMA||'.'||V_TEXT_TABLA||'_UN... Restriccion ('||V_TEXT_TABLA||'_UN) creada sobre campo '||V_COLUMN_TABLE_UNIQUE||'.');
	*/
	
	-- Creamos sequence
	V_MSQL := 'CREATE SEQUENCE '||V_ESQUEMA||'.S_'||V_TEXT_TABLA||'';		
	EXECUTE IMMEDIATE V_MSQL;		
	DBMS_OUTPUT.PUT_LINE('[INFO] '||V_ESQUEMA||'.S_'||V_TEXT_TABLA||'... Secuencia creada');
	
	-- Creamos comentario	
	V_MSQL := 'COMMENT ON TABLE '||V_ESQUEMA||'.'||V_TEXT_TABLA||' IS '''||V_COMMENT_TABLE||'''';		
	EXECUTE IMMEDIATE V_MSQL;
	DBMS_OUTPUT.PUT_LINE('[INFO] ' ||V_ESQUEMA||'.'||V_TEXT_TABLA||'... Comentario creado.');

	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.IDNOPE IS ''IDENTIFICADOR NUMERO DE OPERAC'' ';
	
		
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.IDNOPE IS ''IDENTIFICADOR NUMERO DE OPERAC'' ';
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.CODREG IS ''CODIGO DE REGISTRO'' ';
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.COENTV IS ''COD. ENTIDAD URSUS'' ';
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.FEEJFA IS ''AÑO DE EJERCICIO DE LA FACTURA'' ';
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.COXIDE IS ''CLASE DE DOCUMENTO'' ';
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.IDXDOC IS ''IDENTIFICADOR DOCUMENTO'' ';
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.COCPER IS ''CLASE DE PERSONA'' ';
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.OBNOCL IS ''NOMBRE CLIENTE'' ';
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.OBA1CL IS ''PRIMER APELLIDO CLIENTE'' ';
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.OBA2CL IS ''SEGUNDO APELLIDO CLIENTE'' ';
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.COTVIA IS ''TIPO DE VIA'' ';
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.NOVIA3 IS ''NOMBRE DE LA VIA'' ';
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.NUVIAX IS ''NUMERO DE LA VIA'' ';
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.NUESCX IS ''ESCALERA'' ';
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.NUXPLA IS ''PLANTA'' ';
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.NUXPUE IS ''PUERTA'' ';
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.COXPOS IS ''CODIGO POSTAL'' ';
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.NBPOBL IS ''NOMBRE POBLACION'' ';
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.NOPRO3 IS ''PROVINCIA'' ';
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.OBTELE IS ''TELEFONO'' ';
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.OBTELO IS ''TELEFONO OTRO'' ';
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.OBFAXT IS ''NUMERO FAX'' ';
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.ITMAIL IS ''DIRECCION DE CORREO ELECTRONIC'' ';
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.COESCC IS ''CODIGO ESTADO CIVIL'' ';
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.COREBI IS ''CODIGO REGIMEN DE BIENES'' ';
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.COSEXO IS ''SEXO'' ';
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.COPAIN IS ''CODIGO DE PAIS NACIONALIDAD'' ';
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.COPAIR IS ''CODIGO DE PAIS RESIDENCIA'' ';
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.OBNOC2 IS ''NOMBRE DEL CLIENTE EXTENDIDO'' ';
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.FILLER IS ''espacio_reservado'' ';
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN  '||V_ESQUEMA||'.'||V_TEXT_TABLA||'.ERCOD9 IS ''NUMERO DEL ERROR PRODUCIDO'' ';
	
	DBMS_OUTPUT.PUT_LINE('[INFO] ' ||V_ESQUEMA||'.'||V_TEXT_TABLA||'... OK');

	COMMIT;	
	
EXCEPTION
     WHEN OTHERS THEN 
         DBMS_OUTPUT.PUT_LINE('KO!');
          err_num := SQLCODE;
          err_msg := SQLERRM;

          DBMS_OUTPUT.put_line('[ERROR] Se ha producido un error en la ejecución:'||TO_CHAR(err_num));
          DBMS_OUTPUT.put_line('-----------------------------------------------------------'); 
          DBMS_OUTPUT.put_line(err_msg);

          ROLLBACK;
          RAISE;          

END;

/

EXIT
