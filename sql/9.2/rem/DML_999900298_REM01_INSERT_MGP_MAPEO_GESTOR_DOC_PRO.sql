--/*
--##########################################
--## AUTOR=Pier Gotta
--## FECHA_CREACION=20180803
--## ARTEFACTO=online
--## VERSION_ARTEFACTO=9.2
--## INCIDENCIA_LINK=REMVIP-1342
--## PRODUCTO=NO
--##
--## Finalidad: Se añaden datos a la tabla MGD_MAPEO_GESTOR_DOC_PRO
--## INSTRUCCIONES:
--## VERSIONES:
--##        0.1 Versión inicial
--##########################################
--*/


WHENEVER SQLERROR EXIT SQL.SQLCODE;
SET SERVEROUTPUT ON; 
SET DEFINE OFF;


DECLARE
    V_MSQL VARCHAR2(32000 CHAR); -- Sentencia a ejecutar     
    V_ESQUEMA VARCHAR2(25 CHAR):= '#ESQUEMA#'; -- Configuracion Esquema
    V_ESQUEMA_M VARCHAR2(25 CHAR):= '#ESQUEMA_MASTER#'; -- Configuracion Esquema Master
    V_SQL VARCHAR2(4000 CHAR); -- Vble. para consulta que valida la existencia de una tabla.
    V_NUM_TABLAS NUMBER(16); -- Vble. para validar la existencia de una tabla.   
    ERR_NUM NUMBER(25);  -- Vble. auxiliar para registrar errores en el script.
    ERR_MSG VARCHAR2(1024 CHAR); -- Vble. auxiliar para registrar errores en el script.
	
    V_TEXT1 VARCHAR2(2400 CHAR); -- Vble. auxiliar
    V_ENTIDAD_ID NUMBER(16);
    V_ID NUMBER(16);
    
    TYPE T_FUNCION IS TABLE OF VARCHAR2(1500);
    TYPE T_ARRAY_FUNCION IS TABLE OF T_FUNCION;
    V_FUNCION T_ARRAY_FUNCION := T_ARRAY_FUNCION(
	  T_FUNCION('B86744349-2', 'Cajamar',''),
	  T_FUNCION('F12013231', 'Cajamar',''),
	  T_FUNCION('F12013124', 'Cajamar',''),
	  T_FUNCION('F46028064', 'Cajamar',''),
	  T_FUNCION('B04376208', 'Cajamar',''),
	  T_FUNCION('F12014221', 'Cajamar',''),
	  T_FUNCION('A04823829', 'Cajamar',''),
	  T_FUNCION('B04661484', 'Cajamar',''),
	  T_FUNCION('F03042595', 'Cajamar',''),
	  T_FUNCION('F46025433', 'Cajamar',''),
	  T_FUNCION('F12013306', 'Cajamar',''),
	  T_FUNCION('V85049039', 'Cajamar',''),
	  T_FUNCION('F46043816', 'Cajamar',''),
	  T_FUNCION('B04381406', 'Cajamar',''),
	  T_FUNCION('B98177983', 'Cajamar',''),
	  T_FUNCION('F46163598', 'Cajamar',''),
	  T_FUNCION('F97086805', 'Cajamar',''),
	  T_FUNCION('B86845179', 'Cajamar',''),
	  T_FUNCION('F96828728', 'Cajamar',''),
	  T_FUNCION('F12013215', 'Cajamar',''),
	  T_FUNCION('B85665388', 'Cajamar',''),
	  T_FUNCION('.', 'Cajamar',''),
	  T_FUNCION('1R', 'Cajamar',''),
	  T_FUNCION('F04743175', 'Cajamar',''),
	  T_FUNCION('F46047809', 'Cajamar',''),
	  T_FUNCION('B85595882', 'Cajamar',''),
	  T_FUNCION('F99999999', 'Cajamar',''),
	  T_FUNCION('F35040278', 'Cajamar',''),
	  T_FUNCION('F03027901', 'Cajamar',''),
	  T_FUNCION('F12013256', 'Cajamar',''),
	  T_FUNCION('F12013298', 'Cajamar',''),
	  T_FUNCION('B98177991', 'Cajamar',''),
	  T_FUNCION('B98403066', 'Cajamar',''),
	  T_FUNCION('F12013223', 'Cajamar',''),
	  T_FUNCION('A04764767', 'Cajamar',''),
	  T_FUNCION('B12345678', 'Cajamar',''),
	  T_FUNCION('F03014982', 'Cajamar',''),
	  T_FUNCION('F46027504', 'Cajamar',''),
	  T_FUNCION('F46043808', 'Cajamar',''),
	  T_FUNCION('F12013140', 'Cajamar',''),
	  T_FUNCION('B97135503', 'Cajamar',''),
	  T_FUNCION('A16009367', 'Sareb',''),
	  T_FUNCION('F84897800', 'Sareb',''),
	  T_FUNCION('B35237163', 'Sareb',''),
	  T_FUNCION('B12543666', 'Sareb',''),
	  T_FUNCION('B26242842', 'Sareb',''),
	  T_FUNCION('A81917171', 'Sareb',''),
	  T_FUNCION('B82421223', 'Sareb',''),
	  T_FUNCION('B07973837', 'Sareb',''),
	  T_FUNCION('A07127905', 'Sareb',''),
	  T_FUNCION('B84259670', 'Sareb',''),
	  T_FUNCION('B53342499', 'Sareb',''),
	  T_FUNCION('A05013107', 'Sareb',''),
	  T_FUNCION('B95122438', 'Sareb',''),
	  T_FUNCION('F45521796', 'Sareb',''),
	  T_FUNCION('B79011771', 'Sareb',''),
	  T_FUNCION('B83504662', 'Sareb',''),
	  T_FUNCION('B60927142', 'Sareb',''),
	  T_FUNCION('B92668771', 'Sareb',''),
	  T_FUNCION('A20306312', 'Sareb',''),
	  T_FUNCION('B96714977', 'Sareb',''),
	  T_FUNCION('B80161755', 'Sareb',''),
	  T_FUNCION('A78467842', 'Sareb',''),
	  T_FUNCION('B84751072', 'Sareb',''),
	  T_FUNCION('B02341329', 'Sareb',''),
	  T_FUNCION('B81885030', 'Sareb',''),
	  T_FUNCION('B80075211', 'Sareb',''),
	  T_FUNCION('B61180089', 'Sareb',''),
	  T_FUNCION('A78431525', 'Sareb',''),
	  T_FUNCION('A28558344', 'Sareb',''),
	  T_FUNCION('B45014529', 'Sareb',''),
	  T_FUNCION('B30127922', 'Sareb',''),
	  T_FUNCION('B83074047', 'Sareb',''),
	  T_FUNCION('A40226664', 'Sareb',''),
	  T_FUNCION('B80843659', 'Sareb',''),
	  T_FUNCION('B12510673', 'Sareb',''),
	  T_FUNCION('B53573911', 'Sareb',''),
	  T_FUNCION('B65451189', 'Sareb',''),
	  T_FUNCION('B35537307', 'Sareb',''),
	  T_FUNCION('U84475078', 'Sareb',''),
	  T_FUNCION('B17610551', 'Sareb',''),
	  T_FUNCION('E97661383', 'Sareb',''),
	  T_FUNCION('B10189249', 'Sareb',''),
	  T_FUNCION('B35126309', 'Sareb',''),
	  T_FUNCION('B79887477', 'Sareb',''),
	  T_FUNCION('B02037414', 'Sareb',''),
	  T_FUNCION('A08269136', 'Sareb',''),
	  T_FUNCION('B04302428', 'Sareb',''),
	  T_FUNCION('B48472500', 'Sareb',''),
	  T_FUNCION('A78827300', 'Sareb',''),
	  T_FUNCION('B83696153', 'Sareb',''),
	  T_FUNCION('B12040176', 'Sareb',''),
	  T_FUNCION('B96197363', 'Sareb',''),
	  T_FUNCION('B97718308', 'Sareb',''),
	  T_FUNCION('B46434528', 'Sareb',''),
	  T_FUNCION('B18697698', 'Sareb',''),
	  T_FUNCION('F83078923', 'Sareb',''),
	  T_FUNCION('A84203181', 'Sareb',''),
	  T_FUNCION('B05177548', 'Sareb',''),
	  T_FUNCION('B04454435', 'Sareb',''),
	  T_FUNCION('B92544915', 'Sareb',''),
	  T_FUNCION('B54081468', 'Sareb',''),
	  T_FUNCION('B15680572', 'Sareb',''),
	  T_FUNCION('B31114291', 'Sareb',''),
	  T_FUNCION('F97907463', 'Sareb',''),
	  T_FUNCION('B26311969', 'Sareb',''),
	  T_FUNCION('B62694377', 'Sareb',''),
	  T_FUNCION('B26100693', 'Sareb',''),
	  T_FUNCION('B63738868', 'Sareb',''),
	  T_FUNCION('B79966156', 'Sareb',''),
	  T_FUNCION('A81353344', 'Sareb',''),
	  T_FUNCION('B35649573', 'Sareb',''),
	  T_FUNCION('B16103889', 'Sareb',''),
	  T_FUNCION('B97491054', 'Sareb',''),
	  T_FUNCION('A03418449', 'Sareb',''),
	  T_FUNCION('B96406566', 'Sareb',''),
	  T_FUNCION('A26023606', 'Sareb',''),
	  T_FUNCION('B97866420', 'Sareb',''),
	  T_FUNCION('B50904630', 'Sareb',''),
	  T_FUNCION('A96736947', 'Sareb',''),
	  T_FUNCION('B27269414', 'Sareb',''),
	  T_FUNCION('A10206365', 'Sareb',''),
	  T_FUNCION('A12428298', 'Sareb',''),
	  T_FUNCION('B12461117', 'Sareb',''),
	  T_FUNCION('A10014371', 'Sareb',''),
	  T_FUNCION('B39656954', 'Sareb',''),
	  T_FUNCION('A40004731', 'Sareb',''),
	  T_FUNCION('B13274410', 'Sareb',''),
	  T_FUNCION('F85311603', 'Sareb',''),
	  T_FUNCION('B82136326', 'Sareb',''),
	  T_FUNCION('B12675120', 'Sareb',''),
	  T_FUNCION('B46076881', 'Sareb',''),
	  T_FUNCION('B82622598', 'Sareb',''),
	  T_FUNCION('A28945525', 'Sareb',''),
	  T_FUNCION('B19260223', 'Sareb',''),
	  T_FUNCION('B27320738', 'Sareb',''),
	  T_FUNCION('A83032557', 'Sareb',''),
	  T_FUNCION('A50569896', 'Sareb',''),
	  T_FUNCION('B63207526', 'Sareb',''),
	  T_FUNCION('B26361691', 'Sareb',''),
	  T_FUNCION('B48553564', 'Sareb',''),
	  T_FUNCION('B64417132', 'Sareb',''),
	  T_FUNCION('B64284466', 'Sareb',''),
	  T_FUNCION('A28429884', 'Sareb',''),
	  T_FUNCION('B81771180', 'Sareb',''),
	  T_FUNCION('A35538891', 'Sareb',''),
	  T_FUNCION('B84028141', 'Sareb',''),
	  T_FUNCION('B81882599', 'Sareb',''),
	  T_FUNCION('B54001599', 'Sareb',''),
	  T_FUNCION('B35000967', 'Sareb',''),
	  T_FUNCION('B15934847', 'Sareb',''),
	  T_FUNCION('A05196415', 'Sareb',''),
	  T_FUNCION('B38799698', 'Sareb',''),
	  T_FUNCION('B81090912', 'Sareb',''),
	  T_FUNCION('A28327195', 'Sareb',''),
	  T_FUNCION('B05178777', 'Sareb',''),
	  T_FUNCION('B63389159', 'Sareb',''),
	  T_FUNCION('U84508860', 'Sareb',''),
	  T_FUNCION('B35216928', 'Sareb',''),
	  T_FUNCION('B57176422', 'Sareb',''),
	  T_FUNCION('B58932591', 'Sareb',''),
	  T_FUNCION('B83209528', 'Sareb',''),
	  T_FUNCION('A27244730', 'Sareb',''),
	  T_FUNCION('B80433501', 'Sareb',''),
	  T_FUNCION('B74044280', 'Sareb',''),
	  T_FUNCION('B41944513', 'Sareb',''),
	  T_FUNCION('B09425968', 'Sareb',''),
	  T_FUNCION('B24460537', 'Sareb',''),
	  T_FUNCION('B13397286', 'Sareb',''),
	  T_FUNCION('B91399386', 'Sareb',''),
	  T_FUNCION('B49149677', 'Sareb',''),
	  T_FUNCION('B97801674', 'Sareb',''),
	  T_FUNCION('A26369066', 'Sareb',''),
	  T_FUNCION('B39418447', 'Sareb',''),
	  T_FUNCION('B83064949', 'Sareb',''),
	  T_FUNCION('B27018464', 'Sareb',''),
	  T_FUNCION('B61732350', 'Sareb',''),
	  T_FUNCION('A36142065', 'Sareb',''),
	  T_FUNCION('B12515391', 'Sareb',''),
	  T_FUNCION('B91536342', 'Sareb',''),
	  T_FUNCION('B24519837', 'Sareb',''),
	  T_FUNCION('B83818898', 'Sareb',''),
	  T_FUNCION('B97035745', 'Sareb',''),
	  T_FUNCION('B36518520', 'Sareb',''),
	  T_FUNCION('B80190242', 'Sareb',''),
	  T_FUNCION('B39620000', 'Sareb',''),
	  T_FUNCION('B45550175', 'Sareb',''),
	  T_FUNCION('B17885336', 'Sareb',''),
	  T_FUNCION('B97411300', 'Sareb',''),
	  T_FUNCION('B03334083', 'Sareb',''),
	  T_FUNCION('050667151Z', 'Sareb',''),
	  T_FUNCION('B26327478', 'Sareb',''),
	  T_FUNCION('B12398053', 'Sareb',''),
	  T_FUNCION('B53000600', 'Sareb',''),
	  T_FUNCION('A78803905', 'Sareb',''),
	  T_FUNCION('B12636908', 'Sareb',''),
	  T_FUNCION('B45549359', 'Sareb',''),
	  T_FUNCION('B97621833', 'Sareb',''),
	  T_FUNCION('A80163587', 'Sareb',''),
	  T_FUNCION('B81235798', 'Sareb',''),
	  T_FUNCION('B82718263', 'Sareb',''),
	  T_FUNCION('B92399740', 'Sareb',''),
	  T_FUNCION('B40168346', 'Sareb',''),
	  T_FUNCION('A60620176', 'Sareb',''),
	  T_FUNCION('A12102075', 'Sareb',''),
	  T_FUNCION('A26039453', 'Sareb',''),
	  T_FUNCION('B26281477', 'Sareb',''),
	  T_FUNCION('B17694803', 'Sareb',''),
	  T_FUNCION('B28582229', 'Sareb',''),
	  T_FUNCION('B05166368', 'Sareb',''),
	  T_FUNCION('B24482481', 'Sareb',''),
	  T_FUNCION('B82087446', 'Sareb',''),
	  T_FUNCION('A78275310', 'Sareb',''),
	  T_FUNCION('B28241495', 'Sareb',''),
	  T_FUNCION('B91138107', 'Sareb',''),
	  T_FUNCION('B30301840', 'Sareb',''),
	  T_FUNCION('A82948423', 'Sareb',''),
	  T_FUNCION('B13408331', 'Sareb',''),
	  T_FUNCION('A84543909', 'Sareb',''),
	  T_FUNCION('B28548345', 'Sareb',''),
	  T_FUNCION('B62394580', 'Sareb',''),
	  T_FUNCION('B91199273', 'Sareb',''),
	  T_FUNCION('B96674569', 'Sareb',''),
	  T_FUNCION('B97208755', 'Sareb',''),
	  T_FUNCION('B35491000', 'Sareb',''),
	  T_FUNCION('B05108329', 'Sareb',''),
	  T_FUNCION('B84420249', 'Sareb',''),
	  T_FUNCION('B05170931', 'Sareb',''),
	  T_FUNCION('B70070222', 'Sareb',''),
	  T_FUNCION('B41607607', 'Sareb',''),
	  T_FUNCION('B53761201', 'Sareb',''),
	  T_FUNCION('B60877529', 'Sareb',''),
	  T_FUNCION('F85735116', 'Sareb',''),
	  T_FUNCION('B12933214', 'Sareb',''),
	  T_FUNCION('B58847096', 'Sareb',''),
	  T_FUNCION('B84627348', 'Sareb',''),
	  T_FUNCION('B96880117', 'Sareb',''),
	  T_FUNCION('B92557784', 'Sareb',''),
	  T_FUNCION('B26271635', 'Sareb',''),
	  T_FUNCION('F83388082', 'Sareb',''),
	  T_FUNCION('B84401991', 'Sareb',''),
	  T_FUNCION('B53394045', 'Sareb',''),
	  T_FUNCION('B23529936', 'Sareb',''),
	  T_FUNCION('B80121783', 'Sareb',''),
	  T_FUNCION('B46895264', 'Sareb',''),
	  T_FUNCION('B13315098', 'Sareb',''),
	  T_FUNCION('B35440288', 'Sareb',''),
	  T_FUNCION('B91361741', 'Sareb',''),
	  T_FUNCION('B19197185', 'Sareb',''),
	  T_FUNCION('B06223549', 'Sareb',''),
	  T_FUNCION('B26412692', 'Sareb',''),
	  T_FUNCION('B07259419', 'Sareb',''),
	  T_FUNCION('B26335596', 'Sareb',''),
	  T_FUNCION('B97704886', 'Sareb',''),
	  T_FUNCION('A12208427', 'Sareb',''),
	  T_FUNCION('B03195310', 'Sareb',''),
	  T_FUNCION('A80672868', 'Sareb',''),
	  T_FUNCION('B29854551', 'Sareb',''),
	  T_FUNCION('B97754196', 'Sareb',''),
	  T_FUNCION('B60529278', 'Sareb',''),
	  T_FUNCION('B96720289', 'Sareb',''),
	  T_FUNCION('B84852094', 'Sareb',''),
	  T_FUNCION('B04279527', 'Sareb',''),
	  T_FUNCION('A79176681', 'Sareb',''),
	  T_FUNCION('A28625176', 'Sareb',''),
	  T_FUNCION('A30082515', 'Sareb',''),
	  T_FUNCION('B26391979', 'Sareb',''),
	  T_FUNCION('B97709554', 'Sareb',''),
	  T_FUNCION('B24416828', 'Sareb',''),
	  T_FUNCION('B44193381', 'Sareb',''),
	  T_FUNCION('B63857619', 'Sareb',''),
	  T_FUNCION('B21329891', 'Sareb',''),
	  T_FUNCION('B24406142', 'Sareb',''),
	  T_FUNCION('B96852819', 'Sareb',''),
	  T_FUNCION('F73516478', 'Sareb',''),
	  T_FUNCION('B96062385', 'Sareb',''),
	  T_FUNCION('A78418241', 'Sareb',''),
	  T_FUNCION('B96369194', 'Sareb',''),
	  T_FUNCION('B28521722', 'Sareb',''),
	  T_FUNCION('A07096845', 'Sareb',''),
	  T_FUNCION('B61453874', 'Sareb',''),
	  T_FUNCION('B33485277', 'Sareb',''),
	  T_FUNCION('B92837194', 'Sareb',''),
	  T_FUNCION('F84944891', 'Sareb',''),
	  T_FUNCION('B40196792', 'Sareb',''),
	  T_FUNCION('B41929365', 'Sareb',''),
	  T_FUNCION('B96734504', 'Sareb',''),
	  T_FUNCION('B28725786', 'Sareb',''),
	  T_FUNCION('B54074729', 'Sareb',''),
	  T_FUNCION('B82637273', 'Sareb',''),
	  T_FUNCION('B83001057', 'Sareb',''),
	  T_FUNCION('B24531907', 'Sareb',''),
	  T_FUNCION('B05210679', 'Sareb',''),
	  T_FUNCION('B83282806', 'Sareb',''),
	  T_FUNCION('A78847811', 'Sareb',''),
	  T_FUNCION('F91291138', 'Sareb',''),
	  T_FUNCION('B37341617', 'Sareb',''),
	  T_FUNCION('A17062498', 'Sareb',''),
	  T_FUNCION('B53449070', 'Sareb',''),
	  T_FUNCION('E13348917', 'Sareb',''),
	  T_FUNCION('B82692120', 'Sareb',''),
	  T_FUNCION('B45287877', 'Sareb',''),
	  T_FUNCION('A13103064', 'Sareb',''),
	  T_FUNCION('B97865679', 'Sareb',''),
	  T_FUNCION('A45046158', 'Sareb',''),
	  T_FUNCION('A35070044', 'Sareb',''),
	  T_FUNCION('B12628764', 'Sareb',''),
	  T_FUNCION('B46620498', 'Sareb',''),
	  T_FUNCION('B53635306', 'Sareb',''),
	  T_FUNCION('B38397444', 'Sareb',''),
	  T_FUNCION('A03961752', 'Sareb',''),
	  T_FUNCION('B24368458', 'Sareb',''),
	  T_FUNCION('A83009357', 'Sareb',''),
	  T_FUNCION('B35492941', 'Sareb',''),
	  T_FUNCION('U84586411', 'Sareb',''),
	  T_FUNCION('A84637834', 'Sareb',''),
	  T_FUNCION('B80182017', 'Sareb',''),
	  T_FUNCION('A46289716', 'Sareb',''),
	  T_FUNCION('A96451125', 'Sareb',''),
	  T_FUNCION('B97047237', 'Sareb',''),
	  T_FUNCION('B05199955', 'Sareb',''),
	  T_FUNCION('B39655907', 'Sareb',''),
	  T_FUNCION('A28964906', 'Sareb',''),
	  T_FUNCION('A78375045', 'Sareb',''),
	  T_FUNCION('B46432183', 'Sareb',''),
	  T_FUNCION('B83483057', 'Sareb',''),
	  T_FUNCION('B82359977', 'Sareb',''),
	  T_FUNCION('B28201598', 'Sareb',''),
	  T_FUNCION('B97158364', 'Sareb',''),
	  T_FUNCION('A24233868', 'Sareb',''),
	  T_FUNCION('A28266690', 'Sareb',''),
	  T_FUNCION('A35004571', 'Sareb',''),
	  T_FUNCION('B54050323', 'Sareb',''),
	  T_FUNCION('B40147019', 'Sareb',''),
	  T_FUNCION('B03832771', 'Sareb',''),
	  T_FUNCION('A12414520', 'Sareb',''),
	  T_FUNCION('A03020948', 'Sareb',''),
	  T_FUNCION('B38672531', 'Sareb',''),
	  T_FUNCION('A28686129', 'Sareb',''),
	  T_FUNCION('F47580063', 'Sareb',''),
	  T_FUNCION('B33826884', 'Sareb',''),
	  T_FUNCION('B50031558', 'Sareb',''),
	  T_FUNCION('B98341522', 'Sareb',''),
	  T_FUNCION('B11394426', 'Sareb',''),
	  T_FUNCION('A96911482', 'Sareb',''),
	  T_FUNCION('B54149919', 'Sareb',''),
	  T_FUNCION('B96621784', 'Sareb',''),
	  T_FUNCION('B25567421', 'Sareb',''),
	  T_FUNCION('B96060892', 'Sareb',''),
	  T_FUNCION('B18566901', 'Sareb',''),
	  T_FUNCION('B05165618', 'Sareb',''),
	  T_FUNCION('A78668498', 'Sareb',''),
	  T_FUNCION('B20857538', 'Sareb',''),
	  T_FUNCION('B12871067', 'Sareb',''),
	  T_FUNCION('B09250119', 'Sareb',''),
	  T_FUNCION('A21109426', 'Sareb',''),
	  T_FUNCION('A28006195', 'Sareb',''),
	  T_FUNCION('B35730779', 'Sareb',''),
	  T_FUNCION('B35418672', 'Sareb',''),
	  T_FUNCION('A28918696', 'Sareb',''),
	  T_FUNCION('B58298035', 'Sareb',''),
	  T_FUNCION('A59134593', 'Sareb',''),
	  T_FUNCION('B28180248', 'Sareb',''),
	  T_FUNCION('B97850747', 'Sareb',''),
	  T_FUNCION('A78688603', 'Sareb',''),
	  T_FUNCION('B53906178', 'Sareb',''),
	  T_FUNCION('B32262537', 'Sareb',''),
	  T_FUNCION('B48737795', 'Sareb',''),
	  T_FUNCION('B35507748', 'Sareb',''),
	  T_FUNCION('B33617747', 'Sareb',''),
	  T_FUNCION('A19122209', 'Sareb',''),
	  T_FUNCION('B03366887', 'Sareb',''),
	  T_FUNCION('A86602158', 'Sareb',''),
	  T_FUNCION('A78436573', 'Sareb',''),
	  T_FUNCION('A28245009', 'Sareb',''),
	  T_FUNCION('B61424644', 'Sareb',''),
	  T_FUNCION('B85047165', 'Sareb',''),
	  T_FUNCION('B96158126', 'Sareb',''),
	  T_FUNCION('F46823951', 'Sareb',''),
	  T_FUNCION('B46657979', 'Sareb',''),
	  T_FUNCION('B26376590', 'Sareb',''),
	  T_FUNCION('B64228711', 'Sareb',''),
	  T_FUNCION('A62564307', 'Sareb',''),
	  T_FUNCION('B82479841', 'Sareb',''),
	  T_FUNCION('B46151411', 'Sareb',''),
	  T_FUNCION('B33536178', 'Sareb',''),
	  T_FUNCION('A26115998', 'Sareb',''),
	  T_FUNCION('B61677696', 'Sareb',''),
	  T_FUNCION('B53662102', 'Sareb',''),
	  T_FUNCION('B84627520', 'Sareb',''),
	  T_FUNCION('B98213663', 'Sareb',''),
	  T_FUNCION('B97664882', 'Sareb',''),
	  T_FUNCION('B50549112', 'Sareb',''),
	  T_FUNCION('A28749562', 'Sareb',''),
	  T_FUNCION('B37347820', 'Sareb',''),
	  T_FUNCION('B83179481', 'Sareb',''),
	  T_FUNCION('B39552831', 'Sareb',''),
	  T_FUNCION('B12723672', 'Sareb',''),
	  T_FUNCION('B91549675', 'Sareb',''),
	  T_FUNCION('B97746713', 'Sareb',''),
	  T_FUNCION('B82134669', 'Sareb',''),
	  T_FUNCION('B35434133', 'Sareb',''),
	  T_FUNCION('B36368058', 'Sareb',''),
	  T_FUNCION('B46559795', 'Sareb',''),
	  T_FUNCION('B46617627', 'Sareb',''),
	  T_FUNCION('A58459090', 'Sareb',''),
	  T_FUNCION('A04172805', 'Sareb',''),
	  T_FUNCION('B80757412', 'Sareb',''),
	  T_FUNCION('A82343609', 'Sareb',''),
	  T_FUNCION('B27179738', 'Sareb',''),
	  T_FUNCION('B70385901', 'Sareb',''),
	  T_FUNCION('B04176079', 'Sareb',''),
	  T_FUNCION('A46094959', 'Sareb',''),
	  T_FUNCION('B39413596', 'Sareb',''),
	  T_FUNCION('B17026964', 'Sareb',''),
	  T_FUNCION('U84124692', 'Sareb',''),
	  T_FUNCION('B03199007', 'Sareb',''),
	  T_FUNCION('A78763018', 'Sareb',''),
	  T_FUNCION('B02365591', 'Sareb',''),
	  T_FUNCION('B96441878', 'Sareb',''),
	  T_FUNCION('B40211211', 'Sareb',''),
	  T_FUNCION('A28558377', 'Sareb',''),
	  T_FUNCION('B62786215', 'Sareb',''),
	  T_FUNCION('B82616004', 'Sareb',''),
	  T_FUNCION('B82688326', 'Sareb',''),
	  T_FUNCION('F24274359', 'Sareb',''),
	  T_FUNCION('B03642584', 'Sareb',''),
	  T_FUNCION('B20891206', 'Sareb',''),
	  T_FUNCION('B35783893', 'Sareb',''),
	  T_FUNCION('B97128607', 'Sareb',''),
	  T_FUNCION('B28988053', 'Sareb',''),
	  T_FUNCION('A14027635', 'Sareb',''),
	  T_FUNCION('B83897652', 'Sareb',''),
	  T_FUNCION('A84203157', 'Sareb',''),
	  T_FUNCION('B97663181', 'Sareb',''),
	  T_FUNCION('B35476811', 'Sareb',''),
	  T_FUNCION('F84907732', 'Sareb',''),
	  T_FUNCION('B82985201', 'Sareb',''),
	  T_FUNCION('B63789242', 'Sareb',''),
	  T_FUNCION('B97389167', 'Sareb',''),
	  T_FUNCION('A97146427', 'Sareb',''),
	  T_FUNCION('A96993456', 'Bankia',''),
	  T_FUNCION('V84593961', 'Bankia',''),
	  T_FUNCION('B98037807', 'Bankia',''),
	  T_FUNCION('V85160935', 'Bankia',''),
	  T_FUNCION('B84039460', 'Bankia',''),
	  T_FUNCION('B97852149', 'Bankia',''),
	  T_FUNCION('B86744349', 'Bankia',''),
	  T_FUNCION('V84966126', 'Bankia',''),
	  T_FUNCION('V84388131', 'Bankia',''),
	  T_FUNCION('V84889229', 'Bankia',''),
	  T_FUNCION('B84068287', 'Bankia',''),
	  T_FUNCION('A14010342', 'Bankia',''),
	  T_FUNCION('A05168646', 'Bankia',''),
	  T_FUNCION('B98073133', 'Bankia',''),
	  T_FUNCION('V84322205', 'Bankia',''),
	  T_FUNCION('V84054840', 'Bankia',''),
	  T_FUNCION('B85745099', 'Bankia',''),
	  T_FUNCION('B83622134', 'Bankia',''),
	  T_FUNCION('A40185027', 'Bankia',''),
	  T_FUNCION('A28446995', 'Bankia',''),
	  T_FUNCION('B84212463', 'Bankia',''),
	  T_FUNCION('XXA14010342', 'Bankia',''),
	  T_FUNCION('A28141935', 'Bankia',''),
	  T_FUNCION('B97278857', 'Bankia',''),
	  T_FUNCION('V85164648', 'Bankia',''),
	  T_FUNCION('V85082675', 'Bankia',''),
	  T_FUNCION('B26452987', 'Bankia',''),
	  T_FUNCION('V85295087', 'Bankia',''),
	  T_FUNCION('A86085685', 'Bankia',''),
	  T_FUNCION('B62464839', 'Bankia',''),
	  T_FUNCION('B97959043', 'Bankia',''),
	  T_FUNCION('xxA86602158', 'Bankia',''),
	  T_FUNCION('V85623668', 'Bankia',''),
	  T_FUNCION('V84669332', 'Bankia',''),
	  T_FUNCION('B26465070', 'Bankia',''),
	  T_FUNCION('V84916956', 'Bankia',''),
	  T_FUNCION('V85981231', 'Bankia',''),
	  T_FUNCION('A96868773', 'Bankia',''),
	  T_FUNCION('B97105068', 'Bankia',''),
	  T_FUNCION('A28286987', 'Bankia',''),
	  T_FUNCION('B97966931', 'Bankia',''),
	  T_FUNCION('V85587434', 'Bankia',''),
	  T_FUNCION('B12637310', 'Bankia',''),
	  T_FUNCION('V83829614', 'Bankia',''),
	  T_FUNCION('V85594927', 'Bankia',''),
	  T_FUNCION('B83581405', 'Bankia',''),
	  T_FUNCION('B97997837', 'Bankia',''),
	  T_FUNCION('B62464821', 'Bankia',''),
	  T_FUNCION('B97236665', 'Bankia',''),
	  T_FUNCION('V86106663', 'Bankia',''),
	  T_FUNCION('V85674323', 'Bankia',''),
	  T_FUNCION('B98351182', 'Bankia',''),
	  T_FUNCION('B46644290', 'Bankia',''),
	  T_FUNCION('B97095038', 'Bankia',''),
	  T_FUNCION('B87103883', 'Otras carteras',''),
	  T_FUNCION('B84634708', 'Otras carteras',''),
	  T_FUNCION('V83948331', 'Haya Titulizacion',''),
	  T_FUNCION('V84369479', 'Haya Titulizacion',''),
	  T_FUNCION('V84734532', 'Haya Titulizacion',''),
	  T_FUNCION('V85296705', 'Haya Titulizacion',''),
	  T_FUNCION('V83914572', 'Haya Titulizacion',''),
	  T_FUNCION('V86097979', 'Haya Titulizacion',''),
	  T_FUNCION('V84382803', 'Haya Titulizacion',''),
	  T_FUNCION('V83799296', 'Haya Titulizacion',''),
	  T_FUNCION('V84515121', 'Haya Titulizacion',''),
	  T_FUNCION('V83453696', 'Haya Titulizacion',''),
	  T_FUNCION('V83669531', 'Haya Titulizacion',''),
	  T_FUNCION('V64366412', 'Haya Titulizacion',''),
	  T_FUNCION('V85489946', 'Haya Titulizacion',''),
	  T_FUNCION('V86171451', 'Haya Titulizacion',''),
	  T_FUNCION('V85144707', 'Haya Titulizacion',''),
	  T_FUNCION('V85140713', 'Haya Titulizacion',''),
	  T_FUNCION('V86304706', 'Haya Titulizacion',''),
	  T_FUNCION('V64904147', 'Haya Titulizacion',''),
	  T_FUNCION('V64606262', 'Haya Titulizacion',''),
	  T_FUNCION('V84325927', 'Haya Titulizacion',''),
	  T_FUNCION('V85600757', 'Haya Titulizacion',''),
	  T_FUNCION('V84776335', 'Haya Titulizacion',''),
	  T_FUNCION('V84906353', 'Haya Titulizacion',''),
	  T_FUNCION('B84921758', 'Liberbank',''),
	  T_FUNCION('A15011489', 'Liberbank',''),
	  T_FUNCION('A86201993', 'Liberbank',''),
	  T_FUNCION('A86486461', 'Liberbank',''),
	  T_FUNCION('A78485752', 'Liberbank',''),
	  T_FUNCION('B87684874', 'Waterfall',''),
	  T_FUNCION('B87616496', 'Waterfall',''),
	  T_FUNCION('B88001078', 'Goldentree',''),
	  T_FUNCION('B88001060', 'Goldentree',''),
	  T_FUNCION('B88001029', 'Goldentree',''),
	  T_FUNCION('B8800109', 'Goldentree',''),
	  T_FUNCION('W0037986G', 'Ing',''),
     	  T_FUNCION('B86053394', 'Cerberus', '7038'),
      	  T_FUNCION('B86053394', 'Promontoria 227', '8001'),
      	  T_FUNCION('B86053394', 'Promontoria 227', '8002')

    );          
    V_TMP_FUNCION T_FUNCION;
    V_PERFILES VARCHAR2(100 CHAR) := '%';  -- Cambiar por ALGÚN PERFIL para otorgar permisos a ese perfil.
    V_FILTRO VARCHAR2(50 CHAR);
                
BEGIN	        
	            
	DBMS_OUTPUT.PUT_LINE('[INICIO] ');
	            
    -- LOOP para insertar los valores en MGP_MAPEO_GESTOR_DOC_PRO -----------------------------------------------------------------
    DBMS_OUTPUT.PUT_LINE('[INFO]: INSERCION EN MGP_MAPEO_GESTOR_DOC_PRO] ');
     FOR I IN V_FUNCION.FIRST .. V_FUNCION.LAST
      LOOP
            V_TMP_FUNCION := V_FUNCION(I);
            
            IF V_TMP_FUNCION(3) IS NOT NULL THEN
                V_FILTRO := 'AND PRO.PRO_CODIGO_UVEM = '||V_TMP_FUNCION(3);
            
            END IF;
			V_SQL := 'SELECT COUNT(1) FROM '||V_ESQUEMA||'.MGP_MAPEO_GESTOR_DOC_PRO WHERE PRO_ID IN 
						(SELECT PRO.PRO_ID FROM '||V_ESQUEMA||'.ACT_PRO_PROPIETARIO PRO WHERE PRO.PRO_DOCIDENTIF = '''||(V_TMP_FUNCION(1))||'''' || V_FILTRO ||')';
			EXECUTE IMMEDIATE V_SQL INTO V_NUM_TABLAS;
			
			-- Si existe la FUNCION
			IF V_NUM_TABLAS > 0 THEN	  
				DBMS_OUTPUT.PUT_LINE('[INFO] Ya existen los datos en la tabla '||V_ESQUEMA||'.MGP_MAPEO_GESTOR_DOC_PRO...no se modifica nada.');
				
			ELSE

				V_MSQL := 'INSERT INTO '||V_ESQUEMA||'.MGP_MAPEO_GESTOR_DOC_PRO (' ||
					'MGP_ID, PRO_ID, CLIENTE_GD, USUARIOCREAR, FECHACREAR, BORRADO) ' ||
					' SELECT '||V_ESQUEMA||'.S_MGP_MAPEO_GESTOR_DOC_PRO.NEXTVAL, PRO.PRO_ID,'''|| (V_TMP_FUNCION(2)) ||''',''DML'',
                    SYSDATE,0 FROM REM01.ACT_PRO_PROPIETARIO PRO where PRO.PRO_DOCIDENTIF = '''|| (V_TMP_FUNCION(1)) ||''''|| V_FILTRO;
		    	
				EXECUTE IMMEDIATE V_MSQL;
                
                V_MSQL := NULL;
                V_FILTRO := NULL;
                
				DBMS_OUTPUT.PUT_LINE('[INFO] Datos de la tabla '||V_ESQUEMA||'.MGP_MAPEO_GESTOR_DOC_PRO insertados correctamente.');
				
		    END IF;	
        COMMIT;
      END LOOP;
    DBMS_OUTPUT.PUT_LINE('[FIN]: MGP_MAPEO_GESTOR_DOC_PRO ACTUALIZADO CORRECTAMENTE ');
   

EXCEPTION
     WHEN OTHERS THEN
          err_num := SQLCODE;
          err_msg := SQLERRM;

          DBMS_OUTPUT.put_line('[ERROR] Se ha producido un error en la ejecución:'||TO_CHAR(err_num));
          DBMS_OUTPUT.put_line('-----------------------------------------------------------'); 
          DBMS_OUTPUT.put_line(V_SQL);
          DBMS_OUTPUT.put_line(V_NUM_TABLAS);
          DBMS_OUTPUT.PUT_LINE(V_MSQL);
          DBMS_OUTPUT.put_line(err_msg);

          ROLLBACK;
          RAISE;          

END;

/

EXIT



   
