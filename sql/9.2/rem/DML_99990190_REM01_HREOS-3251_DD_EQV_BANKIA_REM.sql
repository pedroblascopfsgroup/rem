--/*
--##########################################
--## AUTOR=Gustavo Mora
--## FECHA_CREACION=20171123
--## ARTEFACTO=online
--## VERSION_ARTEFACTO=9.2
--## INCIDENCIA_LINK=HREOS-3251
--## PRODUCTO=NO
--##
--## Finalidad: Script que modifica en DD_EQV_BANKIA_REM los datos en T_ARRAY_DATA
--## INSTRUCCIONES:
--## VERSIONES:
--##        0.1 Versión inicial
--##########################################
--*/


WHENEVER SQLERROR EXIT SQL.SQLCODE;
SET SERVEROUTPUT ON; 
SET DEFINE OFF;


DECLARE
    V_MSQL VARCHAR2(32000 CHAR); -- Sentencia a ejecutar     
    V_ESQUEMA VARCHAR2(25 CHAR):= '#ESQUEMA#'; -- Configuracion Esquema
    V_ESQUEMA_M VARCHAR2(25 CHAR):= '#ESQUEMA_MASTER#'; -- Configuracion Esquema Master
    V_SQL VARCHAR2(4000 CHAR); -- Vble. para consulta que valida la existencia de una tabla.
    V_NUM_TABLAS NUMBER(16); -- Vble. para validar la existencia de una tabla.   
    ERR_NUM NUMBER(25);  -- Vble. auxiliar para registrar errores en el script.
    ERR_MSG VARCHAR2(1024 CHAR); -- Vble. auxiliar para registrar errores en el script.
	
    V_ENTIDAD_ID NUMBER(16);
    V_ID NUMBER(16);
    
    TYPE T_TIPO_DATA IS TABLE OF VARCHAR2(150);
    TYPE T_ARRAY_DATA IS TABLE OF T_TIPO_DATA;
    V_TIPO_DATA T_ARRAY_DATA := T_ARRAY_DATA(
               T_TIPO_DATA('DD_SCR_CODIGO','0','BANKIA','BANKIA','DD_SCR_SUBCARTERA','08','BANKIA','BANKIA'),
               T_TIPO_DATA('DD_SCR_CODIGO','1','BANKIA','BANKIA','DD_SCR_SUBCARTERA','08','BANKIA','BANKIA'),
               T_TIPO_DATA('DD_SCR_CODIGO','2','ALTAE','ALTAE','DD_SCR_SUBCARTERA','08','BANKIA','BANKIA'),
               T_TIPO_DATA('DD_SCR_CODIGO','3','INCOMSA','INCOMSA','DD_SCR_SUBCARTERA','08','BANKIA','BANKIA'),
               T_TIPO_DATA('DD_SCR_CODIGO','4','DECOMSA','DECOMSA','DD_SCR_SUBCARTERA','08','BANKIA','BANKIA'),
               T_TIPO_DATA('DD_SCR_CODIGO','5','CISMISA','CISMISA','DD_SCR_SUBCARTERA','08','BANKIA','BANKIA'),
               T_TIPO_DATA('DD_SCR_CODIGO','6','MAPFRE','MAPFRE','DD_SCR_SUBCARTERA','08','BANKIA','BANKIA'),
               T_TIPO_DATA('DD_SCR_CODIGO','7','INFODIRECCION','INFODIRECCION','DD_SCR_SUBCARTERA','08','BANKIA','BANKIA'),
               T_TIPO_DATA('DD_SCR_CODIGO','8','MADRID LEASING CORPORACION','MADRID LEASING CORPORACION','DD_SCR_SUBCARTERA','08','BANKIA','BANKIA'),
               T_TIPO_DATA('DD_SCR_CODIGO','9','FINANMADRID','FINANMADRID','DD_SCR_SUBCARTERA','08','BANKIA','BANKIA'),
               T_TIPO_DATA('DD_SCR_CODIGO','11','MBS BANCAJA 8 FTA','MBS BANCAJA 8 FTA','DD_SCR_SUBCARTERA','09','TITULIZADAS','TITULIZADAS'),
               T_TIPO_DATA('DD_SCR_CODIGO','12','MBS BANCAJA 7 FTA','MBS BANCAJA 7 FTA','DD_SCR_SUBCARTERA','09','TITULIZADAS','TITULIZADAS'),
               T_TIPO_DATA('DD_SCR_CODIGO','13','FTPYME BANCAJA 8','FTPYME BANCAJA 8','DD_SCR_SUBCARTERA','08','BANKIA','BANKIA'),
               T_TIPO_DATA('DD_SCR_CODIGO','14','FTGENVAL BANCAJA 1 FTA','FTGENVAL BANCAJA 1 FTA','DD_SCR_SUBCARTERA','08','BANKIA','BANKIA'),
               T_TIPO_DATA('DD_SCR_CODIGO','15','BANCAJA-BVA VPO 1 FTA','BANCAJA-BVA VPO 1 FTA','DD_SCR_SUBCARTERA','09','TITULIZADAS','TITULIZADAS'),
               T_TIPO_DATA('DD_SCR_CODIGO','16','MBS BANCAJA 6 FTA','MBS BANCAJA 6 FTA','DD_SCR_SUBCARTERA','09','TITULIZADAS','TITULIZADAS'),
               T_TIPO_DATA('DD_SCR_CODIGO','18','BANCAJA 13 FTA','BANCAJA 13 FTA','DD_SCR_SUBCARTERA','09','TITULIZADAS','TITULIZADAS'),
               T_TIPO_DATA('DD_SCR_CODIGO','19','PYME BANCAJA 7','PYME BANCAJA 7','DD_SCR_SUBCARTERA','08','BANKIA','BANKIA'),
               T_TIPO_DATA('DD_SCR_CODIGO','20','CISA','CISA','DD_SCR_SUBCARTERA','07','BFA','BFA'),
               T_TIPO_DATA('DD_SCR_CODIGO','21','BANKIA HABITAT','BANKIA HABITAT','DD_SCR_SUBCARTERA','06','BANKIA HABITAT','BANKIA HABITAT'),
               T_TIPO_DATA('DD_SCR_CODIGO','22','BANCAJA','BANCAJA','DD_SCR_SUBCARTERA','08','BANKIA','BANKIA'),
               T_TIPO_DATA('DD_SCR_CODIGO','23','TREBOL HABITAT','TREBOL HABITAT','DD_SCR_SUBCARTERA','06','BANKIA HABITAT','BANKIA HABITAT'),
               T_TIPO_DATA('DD_SCR_CODIGO','24','FUENTES DE CHIVA','FUENTES DE CHIVA','DD_SCR_SUBCARTERA','07','BFA','BFA'),
               T_TIPO_DATA('DD_SCR_CODIGO','25','GOLF SAN GREGORI','GOLF SAN GREGORI','DD_SCR_SUBCARTERA','07','BFA','BFA'),
               T_TIPO_DATA('DD_SCR_CODIGO','26','URBANIZADORA MADRIGAL','URBANIZADORA MADRIGAL','DD_SCR_SUBCARTERA','06','BANKIA HABITAT','BANKIA HABITAT'),
               T_TIPO_DATA('DD_SCR_CODIGO','27','ANSOGASA','ANSOGASA','DD_SCR_SUBCARTERA','07','BFA','BFA'),
               T_TIPO_DATA('DD_SCR_CODIGO','28','MARENYS','MARENYS','DD_SCR_SUBCARTERA','07','BFA','BFA'),
               T_TIPO_DATA('DD_SCR_CODIGO','29','URBANIZADORA NORTE PEÑISCOLA','URBANIZADORA NORTE PEÑISCOLA','DD_SCR_SUBCARTERA','07','BFA','BFA'),
               T_TIPO_DATA('DD_SCR_CODIGO','30','BANKIA','BANKIA','DD_SCR_SUBCARTERA','08','BANKIA','BANKIA'),
               T_TIPO_DATA('DD_SCR_CODIGO','31','INVERAVILA','INVERAVILA','DD_SCR_SUBCARTERA','06','BANKIA HABITAT','BANKIA HABITAT'),
               T_TIPO_DATA('DD_SCR_CODIGO','32','VEHICULOS DE TENENCIA Y GESTION 4','VEHICULOS DE TENENCIA Y GESTION 4','DD_SCR_SUBCARTERA','08','BANKIA','BANKIA'),
               T_TIPO_DATA('DD_SCR_CODIGO','35','EUROMIESKANIA','EUROMIESKANIA','DD_SCR_SUBCARTERA','06','BANKIA HABITAT','BANKIA HABITAT'),
               T_TIPO_DATA('DD_SCR_CODIGO','36','CIVITAS','CIVITAS','DD_SCR_SUBCARTERA','06','BANKIA HABITAT','BANKIA HABITAT'),
               T_TIPO_DATA('DD_SCR_CODIGO','37','DICUMAR BALEAR','DICUMAR BALEAR','DD_SCR_SUBCARTERA','06','BANKIA HABITAT','BANKIA HABITAT'),
               T_TIPO_DATA('DD_SCR_CODIGO','38','BANCAJA 11 FTA','BANCAJA 11 FTA','DD_SCR_SUBCARTERA','09','TITULIZADAS','TITULIZADAS'),
               T_TIPO_DATA('DD_SCR_CODIGO','39','FTPYME BANCAJA 6','FTPYME BANCAJA 6','DD_SCR_SUBCARTERA','08','BANKIA','BANKIA'),
               T_TIPO_DATA('DD_SCR_CODIGO','41','VALLENAVA INVERSIONES','VALLENAVA INVERSIONES','DD_SCR_SUBCARTERA','08','BANKIA','BANKIA'),
               T_TIPO_DATA('DD_SCR_CODIGO','45','MBS BANCAJA 3 FTA','MBS BANCAJA 3 FTA','DD_SCR_SUBCARTERA','09','TITULIZADAS','TITULIZADAS'),
               T_TIPO_DATA('DD_SCR_CODIGO','46','CONSUMO BANCAJA 1 FTA','CONSUMO BANCAJA 1 FTA','DD_SCR_SUBCARTERA','08','BANKIA','BANKIA'),
               T_TIPO_DATA('DD_SCR_CODIGO','47','PYME BANCAJA 5 FTA','PYME BANCAJA 5 FTA','DD_SCR_SUBCARTERA','09','TITULIZADAS','TITULIZADAS'),
               T_TIPO_DATA('DD_SCR_CODIGO','48','BANCAJA 10 FTA','BANCAJA 10 FTA','DD_SCR_SUBCARTERA','09','TITULIZADAS','TITULIZADAS'),
               T_TIPO_DATA('DD_SCR_CODIGO','49','MBS BANCAJA 4 FTA','MBS BANCAJA 4 FTA','DD_SCR_SUBCARTERA','09','TITULIZADAS','TITULIZADAS'),
               T_TIPO_DATA('DD_SCR_CODIGO','50','ADQUIRENT INMOBLES, S.L.','ADQUIRENT INMOBLES, S.L.','DD_SCR_SUBCARTERA','08','BANKIA','BANKIA'),
               T_TIPO_DATA('DD_SCR_CODIGO','51','ANALISIS VERIFICACION CONTROL TECNICO EDIFICACION','ANALISIS VERIFICACION CONTROL TECNICO EDIFICACION','DD_SCR_SUBCARTERA','08','BANKIA','BANKIA'),
               T_TIPO_DATA('DD_SCR_CODIGO','52','INVERSORA BURRIAC, S.L.','INVERSORA BURRIAC, S.L.','DD_SCR_SUBCARTERA','08','BANKIA','BANKIA'),
               T_TIPO_DATA('DD_SCR_CODIGO','53','MOVIOLA ASOCIADOS 21, S.L.','MOVIOLA ASOCIADOS 21, S.L.','DD_SCR_SUBCARTERA','08','BANKIA','BANKIA'),
               T_TIPO_DATA('DD_SCR_CODIGO','55','FTPYME BANCAJA 3 FTA','FTPYME BANCAJA 3 FTA','DD_SCR_SUBCARTERA','09','TITULIZADAS','TITULIZADAS'),
               T_TIPO_DATA('DD_SCR_CODIGO','56','BANCAJA 8 FTA','BANCAJA 8 FTA','DD_SCR_SUBCARTERA','09','TITULIZADAS','TITULIZADAS'),
               T_TIPO_DATA('DD_SCR_CODIGO','57','MBS BANCAJA 2 FTA','MBS BANCAJA 2 FTA','DD_SCR_SUBCARTERA','09','TITULIZADAS','TITULIZADAS'),
               T_TIPO_DATA('DD_SCR_CODIGO','58','CM BANCAJA 1 FTA','CM BANCAJA 1 FTA','DD_SCR_SUBCARTERA','09','TITULIZADAS','TITULIZADAS'),
               T_TIPO_DATA('DD_SCR_CODIGO','59','BANCAJA 9 FTA','BANCAJA 9 FTA','DD_SCR_SUBCARTERA','09','TITULIZADAS','TITULIZADAS'),
               T_TIPO_DATA('DD_SCR_CODIGO','60','BANKIA','BANKIA','DD_SCR_SUBCARTERA','08','BANKIA','BANKIA'),
               T_TIPO_DATA('DD_SCR_CODIGO','61','ACTIVOS 26001, S.L.','ACTIVOS 26001, S.L.','DD_SCR_SUBCARTERA','08','BANKIA','BANKIA'),
               T_TIPO_DATA('DD_SCR_CODIGO','62','SUELOS 26001, S.L.','SUELOS 26001, S.L.','DD_SCR_SUBCARTERA','08','BANKIA','BANKIA'),
               T_TIPO_DATA('DD_SCR_CODIGO','63','PROMOCIONES Y OBRAS 26001, S.L.','PROMOCIONES Y OBRAS 26001, S.L.','DD_SCR_SUBCARTERA','08','BANKIA','BANKIA'),
               T_TIPO_DATA('DD_SCR_CODIGO','64','ARRENDAMIENTOS 26001, S.L.','ARRENDAMIENTOS 26001, S.L.','DD_SCR_SUBCARTERA','08','BANKIA','BANKIA'),
               T_TIPO_DATA('DD_SCR_CODIGO','66','SUELOS 26002, S.L.','SUELOS 26002, S.L.','DD_SCR_SUBCARTERA','08','BANKIA','BANKIA'),
               T_TIPO_DATA('DD_SCR_CODIGO','67','BANCAJA 6 FTA','BANCAJA 6 FTA','DD_SCR_SUBCARTERA','09','TITULIZADAS','TITULIZADAS'),
               T_TIPO_DATA('DD_SCR_CODIGO','68','MBS BANCAJA 1 FTA','MBS BANCAJA 1 FTA','DD_SCR_SUBCARTERA','09','TITULIZADAS','TITULIZADAS'),
               T_TIPO_DATA('DD_SCR_CODIGO','69','BANCAJA 7 FTA','BANCAJA 7 FTA','DD_SCR_SUBCARTERA','09','TITULIZADAS','TITULIZADAS'),
               T_TIPO_DATA('DD_SCR_CODIGO','71','ESINCA, S.A.','ESINCA, S.A.','DD_SCR_SUBCARTERA','08','BANKIA','BANKIA'),
               T_TIPO_DATA('DD_SCR_CODIGO','75','BANCAJA 3 FTA','BANCAJA 3 FTA','DD_SCR_SUBCARTERA','09','TITULIZADAS','TITULIZADAS'),
               T_TIPO_DATA('DD_SCR_CODIGO','76','BANCAJA 4 FTH','BANCAJA 4 FTH','DD_SCR_SUBCARTERA','09','TITULIZADAS','TITULIZADAS'),
               T_TIPO_DATA('DD_SCR_CODIGO','77','BANCAJA 5 FTA','BANCAJA 5 FTA','DD_SCR_SUBCARTERA','09','TITULIZADAS','TITULIZADAS'),
               T_TIPO_DATA('DD_SCR_CODIGO','78','FTPYME BANCAJA 2','FTPYME BANCAJA 2','DD_SCR_SUBCARTERA','08','BANKIA','BANKIA'),
               T_TIPO_DATA('DD_SCR_CODIGO','79','AYT','AYT','DD_SCR_SUBCARTERA','09','TITULIZADAS','TITULIZADAS'),
               T_TIPO_DATA('DD_SCR_CODIGO','80','RMBS I','RMBS I','DD_SCR_SUBCARTERA','09','TITULIZADAS','TITULIZADAS'),
               T_TIPO_DATA('DD_SCR_CODIGO','81','RMBS II','RMBS II','DD_SCR_SUBCARTERA','09','TITULIZADAS','TITULIZADAS'),
               T_TIPO_DATA('DD_SCR_CODIGO','82','RMBS III','RMBS III','DD_SCR_SUBCARTERA','09','TITULIZADAS','TITULIZADAS'),
               T_TIPO_DATA('DD_SCR_CODIGO','83','RMBS IV','RMBS IV','DD_SCR_SUBCARTERA','09','TITULIZADAS','TITULIZADAS'),
               T_TIPO_DATA('DD_SCR_CODIGO','84','MADRID ICO-FTVPO','MADRID ICO-FTVPO','DD_SCR_SUBCARTERA','09','TITULIZADAS','TITULIZADAS'),
               T_TIPO_DATA('DD_SCR_CODIGO','85','MADRID RESIDENCIAL I','MADRID RESIDENCIAL I','DD_SCR_SUBCARTERA','09','TITULIZADAS','TITULIZADAS'),
               T_TIPO_DATA('DD_SCR_CODIGO','86','MADRID RESIDENCIAL II','MADRID RESIDENCIAL II','DD_SCR_SUBCARTERA','09','TITULIZADAS','TITULIZADAS'),
               T_TIPO_DATA('DD_SCR_CODIGO','87','MADRID FTPYME I','MADRID FTPYME I','DD_SCR_SUBCARTERA','09','TITULIZADAS','TITULIZADAS'),
               T_TIPO_DATA('DD_SCR_CODIGO','90','ALIANCIA ZERO, S.L.','ALIANCIA ZERO, S.L.','DD_SCR_SUBCARTERA','08','BANKIA','BANKIA'),
               T_TIPO_DATA('DD_SCR_CODIGO','91','ALIANCIA INVERSION EN INMUEBLES DOS, S.L.','ALIANCIA INVERSION EN INMUEBLES DOS, S.L.','DD_SCR_SUBCARTERA','08','BANKIA','BANKIA'),
               T_TIPO_DATA('DD_SCR_CODIGO','92','URBAPINAR, S.L.','URBAPINAR, S.L.','DD_SCR_SUBCARTERA','08','BANKIA','BANKIA'),
               T_TIPO_DATA('DD_SCR_CODIGO','93','GESTORA DE SUELO DE LEVANTE, S.L.','GESTORA DE SUELO DE LEVANTE, S.L.','DD_SCR_SUBCARTERA','08','BANKIA','BANKIA'),
               T_TIPO_DATA('DD_SCR_CODIGO','99','BFA','BFA','DD_SCR_SUBCARTERA','07','BFA','BFA'),
               T_TIPO_DATA('DD_SCR_CODIGO','100','ACINELAV INVERSIONES 2006, S.L.','ACINELAV INVERSIONES 2006, S.L.','DD_SCR_SUBCARTERA','06','BANKIA HABITAT','BANKIA HABITAT'),
               T_TIPO_DATA('DD_SCR_CODIGO','101','ADAMAR SECTORS, S.L','ADAMAR SECTORS, S.L','DD_SCR_SUBCARTERA','06','BANKIA HABITAT','BANKIA HABITAT'),
               T_TIPO_DATA('DD_SCR_CODIGO','102','ALIANZA LOGÍSTICA MAFORT-HABITAT, S.L.','ALIANZA LOGÍSTICA MAFORT-HABITAT, S.L.','DD_SCR_SUBCARTERA','06','BANKIA HABITAT','BANKIA HABITAT'),
               T_TIPO_DATA('DD_SCR_CODIGO','103','ALQUILER PARA JOVENES VIVIENDAS EN COLMENAR VIEJO','ALQUILER PARA JOVENES VIVIENDAS EN COLMENAR VIEJO','DD_SCR_SUBCARTERA','06','BANKIA HABITAT','BANKIA HABITAT'),
               T_TIPO_DATA('DD_SCR_CODIGO','106','ANALYS INVIERTE 21, S.L.','ANALYS INVIERTE 21, S.L.','DD_SCR_SUBCARTERA','06','BANKIA HABITAT','BANKIA HABITAT'),
               T_TIPO_DATA('DD_SCR_CODIGO','111','ASSET FOUNDS','ASSET FOUNDS','DD_SCR_SUBCARTERA','06','BANKIA HABITAT','BANKIA HABITAT'),
               T_TIPO_DATA('DD_SCR_CODIGO','112','AUDET PROMOCIONS, S.L','AUDET PROMOCIONS, S.L','DD_SCR_SUBCARTERA','08','BANKIA','BANKIA'),
               T_TIPO_DATA('DD_SCR_CODIGO','118','BENIDORM COMPLEJO DE VIDA Y GOLF','BENIDORM COMPLEJO DE VIDA Y GOLF','DD_SCR_SUBCARTERA','06','BANKIA HABITAT','BANKIA HABITAT'),
               T_TIPO_DATA('DD_SCR_CODIGO','120','CAMI LA MAR DE SAGUNTO','CAMI LA MAR DE SAGUNTO','DD_SCR_SUBCARTERA','06','BANKIA HABITAT','BANKIA HABITAT'),
               T_TIPO_DATA('DD_SCR_CODIGO','125','COBIMANSA PROMOCIONES INMOBILIARIAS, S.L.','COBIMANSA PROMOCIONES INMOBILIARIAS, S.L.','DD_SCR_SUBCARTERA','08','BANKIA','BANKIA'),
               T_TIPO_DATA('DD_SCR_CODIGO','126','COLMENAR DESARROLLOS RESIDENCIALES S.L.','COLMENAR DESARROLLOS RESIDENCIALES S.L.','DD_SCR_SUBCARTERA','08','BANKIA','BANKIA'),
               T_TIPO_DATA('DD_SCR_CODIGO','131','COSTA EBORIS','COSTA EBORIS','DD_SCR_SUBCARTERA','06','BANKIA HABITAT','BANKIA HABITAT'),
               T_TIPO_DATA('DD_SCR_CODIGO','142','DESARROLLOS URBANISTICOS DE SEGOVIA S.A.','DESARROLLOS URBANISTICOS DE SEGOVIA S.A.','DD_SCR_SUBCARTERA','08','BANKIA','BANKIA'),
               T_TIPO_DATA('DD_SCR_CODIGO','154','ENCINA LOS MONTEROS, S.L.','ENCINA LOS MONTEROS, S.L.','DD_SCR_SUBCARTERA','06','BANKIA HABITAT','BANKIA HABITAT'),
               T_TIPO_DATA('DD_SCR_CODIGO','157','ESPAI COMERCIAL VILA-REIAL, S.L.','ESPAI COMERCIAL VILA-REIAL, S.L.','DD_SCR_SUBCARTERA','06','BANKIA HABITAT','BANKIA HABITAT'),
               T_TIPO_DATA('DD_SCR_CODIGO','165','GEBER URBANA, S.L.','GEBER URBANA, S.L.','DD_SCR_SUBCARTERA','06','BANKIA HABITAT','BANKIA HABITAT'),
               T_TIPO_DATA('DD_SCR_CODIGO','175','GESTORA CASTELLANA DEL SUELO SAU','GESTORA CASTELLANA DEL SUELO SAU','DD_SCR_SUBCARTERA','08','BANKIA','BANKIA'),
               T_TIPO_DATA('DD_SCR_CODIGO','176','GESTORA DE DESARR. Y ARREND., S.L. (GEDASA)','GESTORA DE DESARR. Y ARREND., S.L. (GEDASA)','DD_SCR_SUBCARTERA','06','BANKIA HABITAT','BANKIA HABITAT'),
               T_TIPO_DATA('DD_SCR_CODIGO','177','GOLF PEÑISCOLA','GOLF PEÑISCOLA','DD_SCR_SUBCARTERA','07','BFA','BFA'),
               T_TIPO_DATA('DD_SCR_CODIGO','185','HABITAT RESORTS, S.L.','HABITAT RESORTS, S.L.','DD_SCR_SUBCARTERA','06','BANKIA HABITAT','BANKIA HABITAT'),
               T_TIPO_DATA('DD_SCR_CODIGO','186','HABITAT SON VALENTI','HABITAT SON VALENTI','DD_SCR_SUBCARTERA','06','BANKIA HABITAT','BANKIA HABITAT'),
               T_TIPO_DATA('DD_SCR_CODIGO','196','HOTEL ALAMEDA VALENCIA, S.L.','HOTEL ALAMEDA VALENCIA, S.L.','DD_SCR_SUBCARTERA','06','BANKIA HABITAT','BANKIA HABITAT'),
               T_TIPO_DATA('DD_SCR_CODIGO','203','INICIATIVAS GESTIOMAT, S.L.','INICIATIVAS GESTIOMAT, S.L.','DD_SCR_SUBCARTERA','08','BANKIA','BANKIA'),
               T_TIPO_DATA('DD_SCR_CODIGO','207','INMOVEMU, S.L.','INMOVEMU, S.L.','DD_SCR_SUBCARTERA','08','BANKIA','BANKIA'),
               T_TIPO_DATA('DD_SCR_CODIGO','213','INTERNOVA VIVIENDA JOVEN, S.L','INTERNOVA VIVIENDA JOVEN, S.L','DD_SCR_SUBCARTERA','06','BANKIA HABITAT','BANKIA HABITAT'),
               T_TIPO_DATA('DD_SCR_CODIGO','218','INVERSIONES Y DESARROLLOS 2069 MADRID, S.L.','INVERSIONES Y DESARROLLOS 2069 MADRID, S.L.','DD_SCR_SUBCARTERA','08','BANKIA','BANKIA'),
               T_TIPO_DATA('DD_SCR_CODIGO','219','INVERSIONES Y DESARROLLOS 2069 VALLADOLID, S.L.','INVERSIONES Y DESARROLLOS 2069 VALLADOLID, S.L.','DD_SCR_SUBCARTERA','08','BANKIA','BANKIA'),
               T_TIPO_DATA('DD_SCR_CODIGO','220','JARDI RESIDENCIAL LA GARRIGA, S.L.','JARDI RESIDENCIAL LA GARRIGA, S.L.','DD_SCR_SUBCARTERA','08','BANKIA','BANKIA'),
               T_TIPO_DATA('DD_SCR_CODIGO','227','LEADERMAN INVESTMENT GROUP S.L.','LEADERMAN INVESTMENT GROUP S.L.','DD_SCR_SUBCARTERA','08','BANKIA','BANKIA'),
               T_TIPO_DATA('DD_SCR_CODIGO','232','MACLA 2005, S.L.','MACLA 2005, S.L.','DD_SCR_SUBCARTERA','08','BANKIA','BANKIA'),
               T_TIPO_DATA('DD_SCR_CODIGO','236','MAS DE PEIRON, S.L.','MAS DE PEIRON, S.L.','DD_SCR_SUBCARTERA','06','BANKIA HABITAT','BANKIA HABITAT'),
               T_TIPO_DATA('DD_SCR_CODIGO','237','MASIA DE MONTE SANO, S.L.','MASIA DE MONTE SANO, S.L.','DD_SCR_SUBCARTERA','07','BFA','BFA'),
               T_TIPO_DATA('DD_SCR_CODIGO','238','MATARO LLAR, S.L.','MATARO LLAR, S.L.','DD_SCR_SUBCARTERA','08','BANKIA','BANKIA'),
               T_TIPO_DATA('DD_SCR_CODIGO','247','NORDIC RESIDENTIAL, S.L.','NORDIC RESIDENTIAL, S.L.','DD_SCR_SUBCARTERA','06','BANKIA HABITAT','BANKIA HABITAT'),
               T_TIPO_DATA('DD_SCR_CODIGO','248','NORDIC SOL COMMERCIAL SL','NORDIC SOL COMMERCIAL SL','DD_SCR_SUBCARTERA','06','BANKIA HABITAT','BANKIA HABITAT'),
               T_TIPO_DATA('DD_SCR_CODIGO','249','NOVA PANORÁMICA','NOVA PANORÁMICA','DD_SCR_SUBCARTERA','06','BANKIA HABITAT','BANKIA HABITAT'),
               T_TIPO_DATA('DD_SCR_CODIGO','253','OCIO LOS MONTEROS, S.L.','OCIO LOS MONTEROS, S.L.','DD_SCR_SUBCARTERA','06','BANKIA HABITAT','BANKIA HABITAT'),
               T_TIPO_DATA('DD_SCR_CODIGO','260','PARQUE CENTRAL AGENTE URBANIZADOR','PARQUE CENTRAL AGENTE URBANIZADOR','DD_SCR_SUBCARTERA','06','BANKIA HABITAT','BANKIA HABITAT'),
               T_TIPO_DATA('DD_SCR_CODIGO','270','POLSAR CORPORATION,S.L','POLSAR CORPORATION,S.L','DD_SCR_SUBCARTERA','08','BANKIA','BANKIA'),
               T_TIPO_DATA('DD_SCR_CODIGO','274','PROMOCIONES EL PEDRAZO','PROMOCIONES EL PEDRAZO','DD_SCR_SUBCARTERA','08','BANKIA','BANKIA'),
               T_TIPO_DATA('DD_SCR_CODIGO','276','PROMOCIONES LLANOS DE MASPALOMAS','PROMOCIONES LLANOS DE MASPALOMAS','DD_SCR_SUBCARTERA','08','BANKIA','BANKIA'),
               T_TIPO_DATA('DD_SCR_CODIGO','278','PROMOCIONES Y PROPIEDADES ESPACIO-HABITAT, S.L.','PROMOCIONES Y PROPIEDADES ESPACIO-HABITAT, S.L.','DD_SCR_SUBCARTERA','06','BANKIA HABITAT','BANKIA HABITAT'),
               T_TIPO_DATA('DD_SCR_CODIGO','282','PROMO-SERVEIS DAMSEL, SL','PROMO-SERVEIS DAMSEL, SL','DD_SCR_SUBCARTERA','08','BANKIA','BANKIA'),
               T_TIPO_DATA('DD_SCR_CODIGO','283','PROYECTO INMOBILIARIO VALIANT, S.L.','PROYECTO INMOBILIARIO VALIANT, S.L.','DD_SCR_SUBCARTERA','08','BANKIA','BANKIA'),
               T_TIPO_DATA('DD_SCR_CODIGO','287','RADION IBERKAT, S.L.','RADION IBERKAT, S.L.','DD_SCR_SUBCARTERA','08','BANKIA','BANKIA'),
               T_TIPO_DATA('DD_SCR_CODIGO','288','REALES ATARAZANAS','REALES ATARAZANAS','DD_SCR_SUBCARTERA','06','BANKIA HABITAT','BANKIA HABITAT'),
               T_TIPO_DATA('DD_SCR_CODIGO','289','RENLOVI, S.L.','RENLOVI, S.L.','DD_SCR_SUBCARTERA','08','BANKIA','BANKIA'),
               T_TIPO_DATA('DD_SCR_CODIGO','290','RESIDENCIA FONTSANA, S.L','RESIDENCIA FONTSANA, S.L','DD_SCR_SUBCARTERA','08','BANKIA','BANKIA'),
               T_TIPO_DATA('DD_SCR_CODIGO','295','RESIDENCIAL LLOMA DEL MAS, S.L.','RESIDENCIAL LLOMA DEL MAS, S.L.','DD_SCR_SUBCARTERA','06','BANKIA HABITAT','BANKIA HABITAT'),
               T_TIPO_DATA('DD_SCR_CODIGO','297','RESIDENCIAL PARC CAN RATES, S.L.','RESIDENCIAL PARC CAN RATES, S.L.','DD_SCR_SUBCARTERA','08','BANKIA','BANKIA'),
               T_TIPO_DATA('DD_SCR_CODIGO','301','RESTAURA NOWOGRODZKA, Sp.zo.o','RESTAURA NOWOGRODZKA, Sp.zo.o','DD_SCR_SUBCARTERA','08','BANKIA','BANKIA'),
               T_TIPO_DATA('DD_SCR_CODIGO','310','SANTA POLA LIFE RESORT','SANTA POLA LIFE RESORT','DD_SCR_SUBCARTERA','06','BANKIA HABITAT','BANKIA HABITAT'),
               T_TIPO_DATA('DD_SCR_CODIGO','324','TEULAVER, S.L.','TEULAVER, S.L.','DD_SCR_SUBCARTERA','08','BANKIA','BANKIA'),
               T_TIPO_DATA('DD_SCR_CODIGO','325','TORRELUGANO, S.L.','TORRELUGANO, S.L.','DD_SCR_SUBCARTERA','06','BANKIA HABITAT','BANKIA HABITAT'),
               T_TIPO_DATA('DD_SCR_CODIGO','327','TRIANGULUM EUROTRUST, S.L','TRIANGULUM EUROTRUST, S.L','DD_SCR_SUBCARTERA','08','BANKIA','BANKIA'),
               T_TIPO_DATA('DD_SCR_CODIGO','332','URBANIZADORA EXPERIENCIA INMOBILIARIA','URBANIZADORA EXPERIENCIA INMOBILIARIA','DD_SCR_SUBCARTERA','07','BFA','BFA'),
               T_TIPO_DATA('DD_SCR_CODIGO','333','URBANIZADORA FUENTE SAN LUIS, S.L.','URBANIZADORA FUENTE SAN LUIS, S.L.','DD_SCR_SUBCARTERA','06','BANKIA HABITAT','BANKIA HABITAT'),
               T_TIPO_DATA('DD_SCR_CODIGO','334','URBANIZADORA LA VIÑA DEL MAR, S.L.','URBANIZADORA LA VIÑA DEL MAR, S.L.','DD_SCR_SUBCARTERA','06','BANKIA HABITAT','BANKIA HABITAT'),
               T_TIPO_DATA('DD_SCR_CODIGO','336','URBANIZADORA PARQUE AZUL','URBANIZADORA PARQUE AZUL','DD_SCR_SUBCARTERA','07','BFA','BFA'),
               T_TIPO_DATA('DD_SCR_CODIGO','338','URBILAND INVERSORA, S.L.U','URBILAND INVERSORA, S.L.U','DD_SCR_SUBCARTERA','06','BANKIA HABITAT','BANKIA HABITAT'),
               T_TIPO_DATA('DD_SCR_CODIGO','350','VILADECAVALLS PARK, CENTRO IND.-LOG. Y COM.','VILADECAVALLS PARK, CENTRO IND.-LOG. Y COM.','DD_SCR_SUBCARTERA','08','BANKIA','BANKIA'),
               T_TIPO_DATA('DD_SCR_CODIGO','351','VIMODESARROLLOS S.L','VIMODESARROLLOS S.L','DD_SCR_SUBCARTERA','08','BANKIA','BANKIA'),
               T_TIPO_DATA('DD_SCR_CODIGO','358','VIVIENDAS EN ALQUILER DE MOSTOLES S.L.','VIVIENDAS EN ALQUILER DE MOSTOLES S.L.','DD_SCR_SUBCARTERA','08','BANKIA','BANKIA'),
               T_TIPO_DATA('DD_SCR_CODIGO','360','XADAY PROYECTOS Y APLICACIONES, S.L.','XADAY PROYECTOS Y APLICACIONES, S.L.','DD_SCR_SUBCARTERA','08','BANKIA','BANKIA'),
               T_TIPO_DATA('DD_SCR_CODIGO','5057','CONSTRUCCIONES SALDAÑA, S.A.','CONSTRUCCIONES SALDAÑA, S.A.','DD_SCR_SUBCARTERA','05','COLATERALES','COLATERALES'),
               T_TIPO_DATA('DD_SCR_CODIGO','5286','PROBACASA S.L.','PROBACASA S.L.','DD_SCR_SUBCARTERA','05','COLATERALES','COLATERALES'),
               T_TIPO_DATA('DD_SCR_CODIGO','5402','HAYA REAL ESTATE S.L.U.','HAYA REAL ESTATE S.L.U.','DD_SCR_SUBCARTERA','05','Quitas Individuales','Quitas Individuales'),
               T_TIPO_DATA('DD_SCR_CODIGO','7042','MARSE S.A','MARSE S.A','DD_SCR_SUBCARTERA','05','COLATERALES','COLATERALES'),
               T_TIPO_DATA('DD_SCR_CODIGO','9991','SAREB - SOLVIA','SAREB - SOLVIA','DD_SCR_SUBCARTERA','14','Solvia','Solvia'),
               T_TIPO_DATA('DD_SCR_CODIGO','9993','FAB CROSSOVER','FAB CROSSOVER','DD_SCR_SUBCARTERA','19','SAREB Pre-IBERO','SAREB Pre-IBERO'),
               T_TIPO_DATA('DD_SCR_CODIGO','9994','FAB MAY 2014','FAB MAY 2014','DD_SCR_SUBCARTERA','19','SAREB Pre-IBERO','SAREB Pre-IBERO'),
               T_TIPO_DATA('DD_SCR_CODIGO','9995','DORIAN','DORIAN','DD_SCR_SUBCARTERA','19','SAREB Pre-IBERO','SAREB Pre-IBERO'),
               T_TIPO_DATA('DD_SCR_CODIGO','9996','CORONA FAB','CORONA FAB','DD_SCR_SUBCARTERA','19','SAREB Pre-IBERO','SAREB Pre-IBERO'),
               T_TIPO_DATA('DD_SCR_CODIGO','9997','TEIDE 2013 FAB','TEIDE 2013 FAB','DD_SCR_SUBCARTERA','19','SAREB Pre-IBERO','SAREB Pre-IBERO')
    ); 
    V_TMP_TIPO_DATA T_TIPO_DATA;
    
BEGIN	
	
	DBMS_OUTPUT.PUT_LINE('[INICIO] ');

	 
    -- LOOP para insertar los valores en DD_EQV_BANKIA_REM -----------------------------------------------------------------
    DBMS_OUTPUT.PUT_LINE('[INFO]: INSERCION EN DD_EQV_BANKIA_REM ] ');
    FOR I IN V_TIPO_DATA.FIRST .. V_TIPO_DATA.LAST
      LOOP
      
        V_TMP_TIPO_DATA := V_TIPO_DATA(I);
    
        --Comprobamos el dato a insertar
        V_SQL := 'SELECT COUNT(1) FROM '||V_ESQUEMA||'.DD_EQV_BANKIA_REM  WHERE DD_NOMBRE_BANKIA = '''||TRIM(V_TMP_TIPO_DATA(1))||'''' || 
		                 'AND DD_CODIGO_BANKIA = '''||TRIM(V_TMP_TIPO_DATA(2))||'''';
        EXECUTE IMMEDIATE V_SQL INTO V_NUM_TABLAS;
        
        --Si existe lo modificamos
        IF V_NUM_TABLAS > 0 THEN				
          DBMS_OUTPUT.PUT_LINE('[INFO]: MODIFICAMOS EL REGISTRO '''|| TRIM(V_TMP_TIPO_DATA(1)) ||''','''||TRIM(V_TMP_TIPO_DATA(2))||'''');
       	  V_MSQL := 'UPDATE '|| V_ESQUEMA ||'.DD_EQV_BANKIA_REM  '||
                    'SET DD_CODIGO_REM            = '''||TRIM(V_TMP_TIPO_DATA(6))||''''|| 
		      ', DD_DESCRIPCION_REM       = '''||TRIM(V_TMP_TIPO_DATA(7))||''''||
		      ', DD_DESCRIPCION_LARGA_REM = '''||TRIM(V_TMP_TIPO_DATA(8))||''''||
		      ', USUARIOMODIFICAR         = ''HREOS-3251'' , FECHAMODIFICAR = SYSDATE '||
		   'WHERE DD_NOMBRE_BANKIA = '''||TRIM(V_TMP_TIPO_DATA(1))||'''' || 
		     'AND DD_CODIGO_BANKIA = '''||TRIM(V_TMP_TIPO_DATA(2))||'''';
	
          EXECUTE IMMEDIATE V_MSQL;
          DBMS_OUTPUT.PUT_LINE('[INFO]: REGISTRO MODIFICADO CORRECTAMENTE');
          
       --Si no existe, lo insertamos   
       ELSE
       
          DBMS_OUTPUT.PUT_LINE('[INFO]: INSERTAMOS EL REGISTRO '''|| TRIM(V_TMP_TIPO_DATA(1)) ||''','''||TRIM(V_TMP_TIPO_DATA(2))||'''');   
          V_MSQL := 'INSERT INTO '|| V_ESQUEMA ||'.DD_EQV_BANKIA_REM (' ||
		      'DD_NOMBRE_BANKIA, DD_CODIGO_BANKIA, DD_DESCRIPCION_BANKIA, DD_DESCRIPCION_LARGA_BANKIA, DD_NOMBRE_REM, DD_CODIGO_REM, DD_DESCRIPCION_REM, DD_DESCRIPCION_LARGA_REM, VERSION, USUARIOCREAR, FECHACREAR, BORRADO) ' ||
                      'SELECT '''||TRIM(V_TMP_TIPO_DATA(1))||''','''||TRIM(V_TMP_TIPO_DATA(2))||''','''||TRIM(V_TMP_TIPO_DATA(3))||''', '''||TRIM(V_TMP_TIPO_DATA(4))||''','''||TRIM(V_TMP_TIPO_DATA(5))||''','''||TRIM(V_TMP_TIPO_DATA(6))||''', '''||TRIM(V_TMP_TIPO_DATA(7))||''','''||TRIM(V_TMP_TIPO_DATA(8))||''', 0, ''HREOS-3251'',SYSDATE,0 FROM DUAL';
          EXECUTE IMMEDIATE V_MSQL;
          DBMS_OUTPUT.PUT_LINE('[INFO]: REGISTRO INSERTADO CORRECTAMENTE');
        
       END IF;
      END LOOP;
    COMMIT;
    DBMS_OUTPUT.PUT_LINE('[FIN]: DICCIONARIO DD_EQV_BANKIA_REM ACTUALIZADO CORRECTAMENTE ');
   

EXCEPTION
     WHEN OTHERS THEN
          err_num := SQLCODE;
          err_msg := SQLERRM;

          DBMS_OUTPUT.put_line('[ERROR] Se ha producido un error en la ejecución:'||TO_CHAR(err_num));
          DBMS_OUTPUT.put_line('-----------------------------------------------------------'); 
          DBMS_OUTPUT.put_line(err_msg);

          ROLLBACK;
          RAISE;          

END;

/

EXIT;



   
