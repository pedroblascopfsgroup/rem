--/*
--##########################################
--## AUTOR=CLV
--## FECHA_CREACION=20161028
--## ARTEFACTO=online
--## VERSION_ARTEFACTO=9.2
--## INCIDENCIA_LINK=0
--## PRODUCTO=NO
--##
--## Finalidad: Script que añade en DD_ETG_EQV_TIPO_GASTO_RU
--## INSTRUCCIONES:
--## VERSIONES:
--##        0.1 Versión inicial
--##########################################
--*/


WHENEVER SQLERROR EXIT SQL.SQLCODE;
SET SERVEROUTPUT ON; 
SET DEFINE OFF;


DECLARE
    V_MSQL VARCHAR2(32000 CHAR); -- Sentencia a ejecutar     
    V_ESQUEMA VARCHAR2(25 CHAR):= '#ESQUEMA#'; -- Configuracion Esquema
    V_ESQUEMA_M VARCHAR2(25 CHAR):= '#ESQUEMA_MASTER#'; -- Configuracion Esquema Master
    V_SQL VARCHAR2(4000 CHAR); -- Vble. para consulta que valida la existencia de una tabla.
    V_NUM_TABLAS NUMBER(16); -- Vble. para validar la existencia de una tabla.   
    ERR_NUM NUMBER(25);  -- Vble. auxiliar para registrar errores en el script.
    ERR_MSG VARCHAR2(1024 CHAR); -- Vble. auxiliar para registrar errores en el script.
	
    V_TEXT1 VARCHAR2(2400 CHAR); -- Vble. auxiliar
    V_ENTIDAD_ID NUMBER(16);
    V_ID NUMBER(16);
    V_TABLA VARCHAR2(50 CHAR) := 'DD_ETG_EQV_TIPO_GASTO_RU';
  
    TYPE T_TIPO_DATA IS TABLE OF VARCHAR2(500);
    TYPE T_ARRAY_DATA IS TABLE OF T_TIPO_DATA;
    V_TIPO_DATA T_ARRAY_DATA := T_ARRAY_DATA(
T_TIPO_DATA('01','01','01','IBIS','IBIS','2','1','1','DEVOLUCIÓN IBIS','DEVOLUCIÓN IBIS','2','1','51'),
T_TIPO_DATA('01','02','02','IBI RÚSTICO','IBI RÚSTICO','2','1','9','DEVOLUCIÓN IBI RÚSTICO','DEVOLUCIÓN IBI RÚSTICO','2','1','59'),
T_TIPO_DATA('01','03','03','PLUSVALÍA','PLUSVALÍA','1','1','0','DEVOLUCIÓN PLUSVALÍA','DEVOLUCIÓN PLUSVALÍA','1','1','50'),
T_TIPO_DATA('01','04','04','PLUSVALÍA','PLUSVALÍA','1','1','0','DEVOLUCIÓN PLUSVALÍA','DEVOLUCIÓN PLUSVALÍA','1','1','50'),
T_TIPO_DATA('01','05','05','IBIS E IMPUSTOS ','IBIS E IMPUSTOS ','2','1','0','DEVOLUCIÓN IBIS E IMPUESTOS','DEVOLUCIÓN IBIS E IMPUESTOS','2','1','50'),
T_TIPO_DATA('01','06','06','IBIS E IMPUSTOS ','IBIS E IMPUSTOS ','2','1','0','DEVOLUCIÓN IBIS E IMPUESTOS','DEVOLUCIÓN IBIS E IMPUESTOS','2','1','50'),
T_TIPO_DATA('01','07','07','IBIS E IMPUSTOS ','IBIS E IMPUSTOS ','2','1','0','DEVOLUCIÓN IBIS E IMPUESTOS','DEVOLUCIÓN IBIS E IMPUESTOS','2','1','50'),
T_TIPO_DATA('02','08','08','TASAS BASURA','TASAS BASURA','2','1','2','DEVOLUCIÓN TASAS BASURA','DEVOLUCIÓN TASAS BASURA','2','1','52'),
T_TIPO_DATA('02','09','09','TASAS ALCANTARILLADO','TASAS ALCANTARILLADO','2','1','3','DEVOLUCIÓN TASAS ALCANTARILLADO','DEVOLUCIÓN TASAS ALCANTARILLADO','2','1','53'),
T_TIPO_DATA('02','10','10','TASAS AGUA','TASAS AGUA','2','1','4','DEVOLUCIÓN TASAS AGUA','DEVOLUCIÓN TASAS AGUA','2','1','54'),
T_TIPO_DATA('02','11','11','VADOS','VADOS','2','1','7','DEVOLUCIÓN VADOS','DEVOLUCIÓN VADOS','2','1','57'),
T_TIPO_DATA('02','12','12','ECOTASA','ECOTASA','2','1','8','DEVOLUCIÓN ECOTASA','DEVOLUCIÓN ECOTASA','2','1','58'),
T_TIPO_DATA('02','13','13','OTRAS TASAS','OTRAS TASAS','2','1','6','DEVOLUCIÓN OTRAS TASAS','DEVOLUCIÓN OTRAS TASAS','2','1','56'),
T_TIPO_DATA('02','14','14','OTRAS TASAS','OTRAS TASAS','2','1','6','DEVOLUCIÓN OTRAS TASAS','DEVOLUCIÓN OTRAS TASAS','2','1','56'),
T_TIPO_DATA('02','15','15','OTRAS TASAS','OTRAS TASAS','2','1','6','DEVOLUCIÓN OTRAS TASAS','DEVOLUCIÓN OTRAS TASAS','2','1','56'),
T_TIPO_DATA('02','16','16','OTRAS TASAS','OTRAS TASAS','2','1','6','DEVOLUCIÓN OTRAS TASAS','DEVOLUCIÓN OTRAS TASAS','2','1','56'),
T_TIPO_DATA('02','17','17','OTRAS TASAS','OTRAS TASAS','2','1','6','DEVOLUCIÓN OTRAS TASAS','DEVOLUCIÓN OTRAS TASAS','2','1','56'),
T_TIPO_DATA('02','18','18','OTRAS TASAS','OTRAS TASAS','2','1','6','DEVOLUCIÓN OTRAS TASAS','DEVOLUCIÓN OTRAS TASAS','2','1','56'),
T_TIPO_DATA('03','19','19','CONTRIBUCIONES ESPECIALES','CONTRIBUCIONES ESPECIALES','2','1','5','DEVOLUCIÓN CONTRIB. ESPECIALES','DEVOLUCIÓN CONTRIB. ESPECIALES','2','1','55'),
T_TIPO_DATA('03','20','20','IBIS E IMPUESTOS','IBIS E IMPUESTOS','2','1','0','DEVOLUCIÓN IBIS E IMPUESTOS','DEVOLUCIÓN IBIS E IMPUESTOS','2','1','50'),
T_TIPO_DATA('04','21','21','GASTOS VARIOS','GASTOS VARIOS','3','55','1','DEVOLUCIÓN DENUNCIA','DEVOLUCIÓN DENUNCIA','3','20','2'),
T_TIPO_DATA('04','22','22','GASTOS VARIOS','GASTOS VARIOS','3','55','1','DEVOLUCIÓN DENUNCIA','DEVOLUCIÓN DENUNCIA','3','20','2'),
T_TIPO_DATA('04','23','23','GASTOS VARIOS','GASTOS VARIOS','3','55','1','DEVOLUCIÓN DENUNCIA','DEVOLUCIÓN DENUNCIA','3','20','2'),
T_TIPO_DATA('04','24','24','GASTOS VARIOS','GASTOS VARIOS','3','55','1','DEVOLUCIÓN DENUNCIA','DEVOLUCIÓN DENUNCIA','3','20','2'),
T_TIPO_DATA('04','25','25','GASTOS VARIOS','GASTOS VARIOS','3','55','1','DEVOLUCIÓN DENUNCIA','DEVOLUCIÓN DENUNCIA','3','20','2'),
T_TIPO_DATA('05','26','26','COMUNIDAD ORDINARIA','COMUNIDAD ORDINARIA','2','2','1','DEVOLUCIÓN COMUNIDAD ORDINARIA','DEVOLUCIÓN COMUNIDAD ORDINARIA','2','2','51'),
T_TIPO_DATA('05','27','27','EXTRAS COMUNIDAD','EXTRAS COMUNIDAD','2','2','2','DEVOLUCIÓN EXTRAS COMUNIDAD','DEVOLUCIÓN EXTRAS COMUNIDAD','2','2','52'),
T_TIPO_DATA('06','28','28','MANCOMUNIDAD','MANCOMUNIDAD','2','2','3','DEVOLUCIÓN MANCOMUNIDAD','DEVOLUCIÓN MANCOMUNIDAD','2','2','53'),
T_TIPO_DATA('06','29','29','EXTRAS MANCOMUNIDAD','EXTRAS MANCOMUNIDAD','2','2','4','DEVOLUCIÓN EXTRAS MANCOMUNIDAD','DEVOLUCIÓN EXTRAS MANCOMUNIDAD','2','2','54'),
T_TIPO_DATA('07','30','30','JUNTAS COMPENSACIÓN GTO GRAL','JUNTAS COMPENSACIÓN GTO GRAL','3','14','6','DEVOLUCIÓN COMUNIDADES','DEVOLUCIÓN COMUNIDADES','2','2','50'),
T_TIPO_DATA('07','31','31','COMUNIDADES EUC','COMUNIDADES EUC','3','44','5','DEVOLUCIÓN COMUNIDADES','DEVOLUCIÓN COMUNIDADES','2','2','50'),
T_TIPO_DATA('08','32','32','COMUNIDADES','COMUNIDADES','2','2','0','DEVOLUCIÓN COMUNIDADES','DEVOLUCIÓN COMUNIDADES','2','2','50'),
T_TIPO_DATA('08','33','33','COMUNIDADES','COMUNIDADES','2','2','0','DEVOLUCIÓN COMUNIDADES','DEVOLUCIÓN COMUNIDADES','2','2','50'),
T_TIPO_DATA('08','34','34','COMUNIDADES','COMUNIDADES','2','2','0','DEVOLUCIÓN COMUNIDADES','DEVOLUCIÓN COMUNIDADES','2','2','50'),
T_TIPO_DATA('09','35','35','SUMINISTROS LUZ','SUMINISTROS LUZ','2','3','1','DEVOLUCIÓN LUZ','DEVOLUCIÓN LUZ','2','3','51'),
T_TIPO_DATA('09','36','36','SUMINISTROS AGUA','SUMINISTROS AGUA','2','3','2','DEVOLUCIÓN SUMINISTROS AGUA','DEVOLUCIÓN SUMINISTROS AGUA','2','3','52'),
T_TIPO_DATA('09','37','37','SUMINISTROS GAS','SUMINISTROS GAS','2','3','3','DEVOLUCIÓN SUMINISTROS GAS','DEVOLUCIÓN SUMINISTROS GAS','2','3','53'),
T_TIPO_DATA('09','38','38','OTROS SUMINISTROS','OTROS SUMINISTROS','2','3','0','DEVOLUCIÓN OTROS SUMINISTROS','DEVOLUCIÓN OTROS SUMINISTROS','2','3','50'),
T_TIPO_DATA('10','39','39','SEGUROS INMUEBLES','SEGUROS INMUEBLES','3','42','6','FACTURAS ABONO','FACTURAS ABONO','3','20','0'),
T_TIPO_DATA('10','40','40','SEGUROS INMUEBLES','SEGUROS INMUEBLES','3','42','6','FACTURAS ABONO','FACTURAS ABONO','3','20','0'),
T_TIPO_DATA('10','41','41','DA#OS PROPIOS','DA#OS PROPIOS','3','19','3','FACTURAS ABONO','FACTURAS ABONO','3','20','0'),
T_TIPO_DATA('10','42','42','PARTES AL SEGURO','PARTES AL SEGURO','3','19','2','FACTURAS ABONO','FACTURAS ABONO','3','20','0'),
T_TIPO_DATA('11','43','43','GASTOS REGISTRALES','GASTOS REGISTRALES','3','49','3','HONORARIOS ABONO','HONORARIOS ABONO','3','20','6'),
T_TIPO_DATA('11','44','44','GASTOS NOTARIALES','GASTOS NOTARIALES','1','2','0','DEVOLUCIÓN NOTARÍA','DEVOLUCIÓN NOTARÍA','1','2','50'),
T_TIPO_DATA('11','45','45','GASTOS ABOGADO','GASTOS ABOGADO','3','21','10','HONORARIOS ABONO','HONORARIOS ABONO','3','20','6'),
T_TIPO_DATA('11','46','46','GASTOS PROCURADOR','GASTOS PROCURADOR','3','21','12','HONORARIOS ABONO','HONORARIOS ABONO','3','20','6'),
T_TIPO_DATA('11','47','47','HONORARIOS JURÍDICOS','HONORARIOS JURÍDICOS','3','47','2','HONORARIOS ABONO','HONORARIOS ABONO','3','20','6'),
T_TIPO_DATA('11','48','48','SERVICIOS VARIOS','SERVICIOS VARIOS','3','2','4','HONORARIOS ABONO','HONORARIOS ABONO','3','20','6'),
T_TIPO_DATA('11','49','49','OTROS ASESORAMIENTOS','OTROS ASESORAMIENTOS','3','49','2','HONORARIOS ABONO','HONORARIOS ABONO','3','20','6'),
T_TIPO_DATA('11','50','50','INF. TÉCNICO DE OBRAS','INF. TÉCNICO DE OBRAS','3','45','2','HONORARIOS ABONO','HONORARIOS ABONO','3','20','6'),
T_TIPO_DATA('11','51','51',' E.TÉCNICO 2-ANÁLIS. TASACIÓN',' E.TÉCNICO 2-ANÁLIS. TASACIÓN','3','15','0','ABONO TASACIÓN','ABONO TASACIÓN','3','22','3'),
T_TIPO_DATA('11','52','52','SERVICIOS VARIOS','SERVICIOS VARIOS','3','2','4','HONORARIOS ABONO','HONORARIOS ABONO','3','20','6'),
T_TIPO_DATA('12','53','53','HONORARIOS GESTORÍA','HONORARIOS GESTORÍA','3','49','4','HONORARIOS ABONO','HONORARIOS ABONO','3','20','6'),
T_TIPO_DATA('12','54','54','FIRMA CON ASISTENCIA','FIRMA CON ASISTENCIA','3','35','2','HONORARIOS ABONO','HONORARIOS ABONO','3','20','6'),
T_TIPO_DATA('13','55','55','PRESCRIPCIÓN','PRESCRIPCIÓN','3','2','1','ABONO GESTIÓN COMERCIAL','ABONO GESTIÓN COMERCIAL','3','20','3'),
T_TIPO_DATA('13','56','56','FUERZA VENTA DIRECTA','FUERZA VENTA DIRECTA','3','2','5','','','','',''),
T_TIPO_DATA('14','57','57','INFORMES','INFORMES','3','13','2','ABONO INFORMES','ABONO INFORMES','3','20','1'),
T_TIPO_DATA('14','58','58','OBTENCIÓN DE CEE','OBTENCIÓN DE CEE','3','45','5','FACTURAS ABONO','FACTURAS ABONO','3','20','0'),
T_TIPO_DATA('14','59','59','LICENCIAS 1ª OCUPACIÓN','LICENCIAS 1ª OCUPACIÓN','3','14','3','FACTURAS ABONO','FACTURAS ABONO','3','20','0'),
T_TIPO_DATA('14','60','60','CÉDULAS HABITABILIDAD','CÉDULAS HABITABILIDAD','3','42','8','FACTURAS ABONO','FACTURAS ABONO','3','20','0'),
T_TIPO_DATA('14','61','61','CFO''''S','CFO''''S','3','14','2','FACTURAS ABONO','FACTURAS ABONO','3','20','0'),
T_TIPO_DATA('14','62','62','INSTALACIONES','INSTALACIONES','3','13','8','FACTURAS ABONO','FACTURAS ABONO','3','20','0'),
T_TIPO_DATA('14','63','63','OBTENCIÓN DOCUMENTACIÓN','OBTENCIÓN DOCUMENTACIÓN','3','14','4','FACTURAS ABONO','FACTURAS ABONO','3','20','0'),
T_TIPO_DATA('14','64','64','HONORARIOS GESTORÍA','HONORARIOS GESTORÍA','3','49','4','FACTURAS ABONO','FACTURAS ABONO','3','20','0'),
T_TIPO_DATA('14','65','65','HONORARIOS GESTORÍA','HONORARIOS GESTORÍA','3','49','4','FACTURAS ABONO','FACTURAS ABONO','3','20','0'),
T_TIPO_DATA('14','66','66','HONORARIOS GESTORÍA','HONORARIOS GESTORÍA','3','49','4','FACTURAS ABONO','FACTURAS ABONO','3','20','0'),
T_TIPO_DATA('14','67','67','HONORARIOS GESTORÍA','HONORARIOS GESTORÍA','3','49','4','FACTURAS ABONO','FACTURAS ABONO','3','20','0'),
T_TIPO_DATA('14','68','68','SERVICIOS VARIOS','SERVICIOS VARIOS','3','2','4','FACTURAS ABONO','FACTURAS ABONO','3','20','0'),
T_TIPO_DATA('14','69','69','LEVANTAMIENTO TOPOGRÁFICO','LEVANTAMIENTO TOPOGRÁFICO','3','17','4','FACTURAS ABONO','FACTURAS ABONO','3','20','0'),
T_TIPO_DATA('15','70','70','CERRADURAS','CERRADURAS','3','13','1','FACTURAS ABONO','FACTURAS ABONO','3','20','0'),
T_TIPO_DATA('15','71','71','MANTENIMIENTO','MANTENIMIENTO','3','13','8','FACTURAS ABONO','FACTURAS ABONO','3','20','0'),
T_TIPO_DATA('15','72','72','MANTENIMIENTO','MANTENIMIENTO','3','13','8','FACTURAS ABONO','FACTURAS ABONO','3','20','0'),
T_TIPO_DATA('15','73','73','LIMPIEZAS','LIMPIEZAS','3','13','5','FACTURAS ABONO','FACTURAS ABONO','3','20','0'),
T_TIPO_DATA('15','74','74','LIMPIEZAS','LIMPIEZAS','3','13','5','FACTURAS ABONO','FACTURAS ABONO','3','20','0'),
T_TIPO_DATA('15','75','75','LIMPIEZAS','LIMPIEZAS','3','13','5','FACTURAS ABONO','FACTURAS ABONO','3','20','0'),
T_TIPO_DATA('15','76','76','DESBROCES, VALLADOS Y LIMPIEZAS','DESBROCES, VALLADOS Y LIMPIEZAS','3','44','4','FACTURAS ABONO','FACTURAS ABONO','3','20','0'),
T_TIPO_DATA('15','77','77','ASIS.TECN, DF, SEG. CONSTR.','ASIS.TECN, DF, SEG. CONSTR.','3','43','1','FACTURAS ABONO','FACTURAS ABONO','3','20','0'),
T_TIPO_DATA('15','78','78','INFORMES','INFORMES','3','13','2','FACTURAS ABONO','FACTURAS ABONO','3','20','0'),
T_TIPO_DATA('15','79','79','MANTENIMIENTO','MANTENIMIENTO','3','13','8','FACTURAS ABONO','FACTURAS ABONO','3','20','0'),
T_TIPO_DATA('15','80','80','OBRA DE EDIFICACIÓN','OBRA DE EDIFICACIÓN','3','13','10','FACTURAS ABONO','FACTURAS ABONO','3','20','0'),
T_TIPO_DATA('15','81','81','CONTROL DE LAS ACTUACIONES','CONTROL DE LAS ACTUACIONES','3','13','14','FACTURAS ABONO','FACTURAS ABONO','3','20','0'),
T_TIPO_DATA('15','82','82','CERRADURAS','CERRADURAS','3','13','1','FACTURAS ABONO','FACTURAS ABONO','3','20','0'),
T_TIPO_DATA('15','83','83','MOBILIARIO','MOBILIARIO','3','41','4','FACTURAS ABONO','FACTURAS ABONO','3','20','0'),
T_TIPO_DATA('15','84','84','REPARACIONES POST-VENTA','REPARACIONES POST-VENTA','3','13','11','FACTURAS ABONO','FACTURAS ABONO','3','20','0'),
T_TIPO_DATA('16','85','85','VIGILANCIA Y SEGURIDAD','VIGILANCIA Y SEGURIDAD','3','42','5','FACTURAS ABONO','FACTURAS ABONO','3','20','0'),
T_TIPO_DATA('16','86','86','VIGILANCIA Y SEGURIDAD','VIGILANCIA Y SEGURIDAD','3','42','5','FACTURAS ABONO','FACTURAS ABONO','3','20','0'),
T_TIPO_DATA('16','87','87','VIGILANCIA Y SEGURIDAD','VIGILANCIA Y SEGURIDAD','3','42','5','FACTURAS ABONO','FACTURAS ABONO','3','20','0'),
T_TIPO_DATA('17','88','88','OTROS GASTOS','OTROS GASTOS','3','48','1','FACTURAS ABONO','FACTURAS ABONO','3','20','0'),
T_TIPO_DATA('18','89','89','OTROS GASTOS','OTROS GASTOS','3','48','1','FACTURAS ABONO','FACTURAS ABONO','3','20','0'),
T_TIPO_DATA('18','90','90','COSTAS DEMANDAS COMUNIDAD','COSTAS DEMANDAS COMUNIDAD','2','2','6','DEVOL. COSTAS DEMANDAS COMUNIDAD','DEVOL. COSTAS DEMANDAS COMUNIDAD','2','2','56'),
T_TIPO_DATA('18','91','91','OTROS GASTOS','OTROS GASTOS','3','48','1','FACTURAS ABONO','FACTURAS ABONO','3','20','0')

        
    ); 
    V_TMP_TIPO_DATA T_TIPO_DATA;
    
BEGIN	
	
	DBMS_OUTPUT.PUT_LINE('[INICIO] ');

	
    -- LOOP para insertar los valores en  -----------------------------------------------------------------
    DBMS_OUTPUT.PUT_LINE('[INFO]: INSERCION EN '||V_TABLA);
    FOR I IN V_TIPO_DATA.FIRST .. V_TIPO_DATA.LAST
      LOOP
      
        V_TMP_TIPO_DATA := V_TIPO_DATA(I);
    
        --Comprobamos el dato a insertar
        V_SQL := 'SELECT COUNT(1) FROM '||V_ESQUEMA||'.'||V_TABLA||' WHERE DD_ETG_CODIGO = '''||TRIM(V_TMP_TIPO_DATA(3))||'''';
        EXECUTE IMMEDIATE V_SQL INTO V_NUM_TABLAS;
        
        --Si existe lo modificamos
        IF V_NUM_TABLAS > 0 THEN				
          
          DBMS_OUTPUT.PUT_LINE('[INFO]: MODIFICAMOS EL REGISTGO '''|| TRIM(V_TMP_TIPO_DATA(1)) ||'''');
       	  /*V_MSQL := 'UPDATE '|| V_ESQUEMA ||'.DD_STG_SUBTIPOS_GASTO '||
                              'SET DD_STG_DESCRIPCION = '''||TRIM(V_TMP_TIPO_DATA(3))||''''|| 
                    ', DD_STG_DESCRIPCION_LARGA = '''||TRIM(V_TMP_TIPO_DATA(4))||''''||
                    ', USUARIOMODIFICAR = ''REM_F2'' , FECHAMODIFICAR = SYSDATE '||
                    'WHERE DD_STG_CODIGO = '''||TRIM(V_TMP_TIPO_DATA(2))||'''';
          EXECUTE IMMEDIATE V_MSQL;*/
          DBMS_OUTPUT.PUT_LINE('[INFO]: REGISTGO MODIFICADO CORRECTAMENTE');
          
       --Si no existe, lo insertamos   
       ELSE
       
          DBMS_OUTPUT.PUT_LINE('[INFO]: INSERTAMOS EL REGISTRO '''|| TRIM(V_TMP_TIPO_DATA(1)) ||'''');   
          V_MSQL := 'SELECT '|| V_ESQUEMA ||'.S_DD_ETG_EQV_TIPO_GASTO_RU.NEXTVAL FROM DUAL';
          
          EXECUTE IMMEDIATE V_MSQL INTO V_ID;	
          
          V_MSQL := 'INSERT INTO '|| V_ESQUEMA ||'.'|| V_TABLA ||' (' ||
                      'DD_ETG_ID, DD_TGA_ID, DD_STG_ID
                      ,DD_ETG_CODIGO,DD_ETG_DESCRIPCION_POS,DD_ETG_DESCRIPCION_LARGA_POS
                      ,COGRUG_POS,COTACA_POS,COSBAC_POS
                      ,DD_ETG_DESCRIPCION_NEG,DD_ETG_DESCRIPCION_LARGA_NEG
                      ,COGRUG_NEG,COTACA_NEG,COSBAC_NEG
                      ,VERSION,USUARIOCREAR,FECHACREAR
                      ,BORRADO) VALUES' ||
                      '('|| V_ID || ',
                      (SELECT DD_TGA_ID FROM '||V_ESQUEMA ||'.DD_TGA_TIPOS_GASTO  WHERE DD_TGA_CODIGO = '''||V_TMP_TIPO_DATA(1)||'''),
                      (SELECT DD_STG_ID FROM '||V_ESQUEMA ||'.DD_STG_SUBTIPOS_GASTO  WHERE DD_STG_CODIGO = '''||V_TMP_TIPO_DATA(2)||'''),
                      '''||TRIM(V_TMP_TIPO_DATA(3))||''', '''||TRIM(V_TMP_TIPO_DATA(4))||''', '''||TRIM(V_TMP_TIPO_DATA(5))||''',
                      '''||TRIM(V_TMP_TIPO_DATA(6))||''', '''||TRIM(V_TMP_TIPO_DATA(7))||''', '''||TRIM(V_TMP_TIPO_DATA(8))||''',
                      '''||TRIM(V_TMP_TIPO_DATA(9))||''', '''||TRIM(V_TMP_TIPO_DATA(10))||''', 
                      '''||TRIM(V_TMP_TIPO_DATA(11))||''', '''||TRIM(V_TMP_TIPO_DATA(12))||''', '''||TRIM(V_TMP_TIPO_DATA(13))||''',
                       0, ''HREOS-1058'',SYSDATE,0 )';

          EXECUTE IMMEDIATE V_MSQL;
          DBMS_OUTPUT.PUT_LINE('[INFO]: REGISTRO INSERTADO CORRECTAMENTE');
        
       END IF;
      END LOOP;
    COMMIT;
    
    DBMS_OUTPUT.PUT_LINE('[FIN]: DICCIONARIO '||V_TABLA||' ACTUALIZADO CORRECTAMENTE ');
   

EXCEPTION
     WHEN OTHERS THEN
          err_num := SQLCODE;
          err_msg := SQLERRM;

          DBMS_OUTPUT.put_line('[ERROR] Se ha producido un error en la ejecución:'||TO_CHAR(err_num));
          DBMS_OUTPUT.put_line('-----------------------------------------------------------'); 
          DBMS_OUTPUT.put_line(err_msg);

          ROLLBACK;
          RAISE;          

END;

/

EXIT;
