 --COMPROBACIONES PREVIAS - PROPIETARIOS
  DBMS_OUTPUT.PUT_LINE('[INFO] ['||V_TABLA||'] COMPROBANDO PROPIETARIOS...');
  
  V_SENTENCIA := '
  SELECT COUNT(1) 
  FROM '||V_ESQUEMA||'.'||V_TABLA_MIG||' MIG 
  WHERE NOT EXISTS (
    SELECT 1 FROM '||V_ESQUEMA||'.ACT_PRO_PROPIETARIO PRO WHERE PRO.PRO_CODIGO_UVEM = MIG.PRO_PROPIETARIO_CODIGO_UVEM
  )
  '
  ;
  
  EXECUTE IMMEDIATE V_SENTENCIA INTO TABLE_COUNT;
  
  IF TABLE_COUNT = 0 THEN
  
    DBMS_OUTPUT.PUT_LINE('[INFO] TODOS LOS PROPIETARIOS EXISTEN EN ACT_PRO_PROPIETARIO');
    
  ELSE
  
    DBMS_OUTPUT.PUT_LINE('[INFO] SE HAN INFORMADO '||TABLE_COUNT||' PROPIETARIOS INEXISTENTES EN ACT_PRO_PROPIETARIO. SE DERIVAR√ÅN A LA TABLA '||V_ESQUEMA||'.MIG2_PRO_NOT_EXISTS.');
    
    --BORRAMOS LOS REGISTROS QUE HAYA EN NOT_EXISTS REFERENTES A ESTA INTERFAZ
    
    EXECUTE IMMEDIATE '
    DELETE FROM '||V_ESQUEMA||'.MIG2_PRO_NOT_EXISTS
    WHERE TABLA_MIG = '''||V_TABLA_MIG||'''
    '
    ;
    
    COMMIT;
  
    EXECUTE IMMEDIATE '
    INSERT INTO '||V_ESQUEMA||'.MIG2_PRO_NOT_EXISTS (
    PRO_CODIGO_UVEM,
    TABLA_MIG,
    FECHA_COMPROBACION
    )
    WITH PRO_CODIGO_UVEM AS (
		SELECT
		MIG.PRO_PROPIETARIO_CODIGO_UVEM 
		FROM '||V_ESQUEMA||'.'||V_TABLA_MIG||' MIG 
		WHERE NOT EXISTS (
		  SELECT 1 FROM '||V_ESQUEMA||'.ACT_PRO_PROPIETARIO PRO WHERE MIG.PRO_PROPIETARIO_CODIGO_UVEM = PRO.PRO_CODIGO_UVEM
		)
    )
    SELECT DISTINCT
    MIG.PRO_PROPIETARIO_CODIGO_UVEM                              			PRO_CODIGO_UVEM,
    '''||V_TABLA_MIG||'''                                                   TABLA_MIG,
    SYSDATE                                                                 FECHA_COMPROBACION
    FROM '||V_ESQUEMA||'.'||V_TABLA_MIG||' MIG  
    INNER JOIN PRO_CODIGO_UVEM
    ON PRO_CODIGO_UVEM.PRO_PROPIETARIO_CODIGO_UVEM = MIG.PRO_PROPIETARIO_CODIGO_UVEM
    '
    ;
    
    COMMIT;

  END IF;
