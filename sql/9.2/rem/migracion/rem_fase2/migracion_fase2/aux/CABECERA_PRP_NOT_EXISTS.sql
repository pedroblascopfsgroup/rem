  --COMPROBACIONES PREVIAS - PRUESTAS DE PRECIOS
  DBMS_OUTPUT.PUT_LINE('[INFO] ['||V_TABLA||'] COMPROBANDO PRUESTAS DE PRECIOS...');
  
  V_SENTENCIA := '
  SELECT COUNT(1) 
  FROM '||V_ESQUEMA||'.'||V_TABLA_MIG||' MIG 
  WHERE NOT EXISTS (
    SELECT 1 FROM '||V_ESQUEMA||'.PRP_PROPUESTAS_PRECIOS PRP WHERE PRP.PRP_NUM_PROPUESTA = MIG.ACT_PRP_NUM_PROPUESTA
  )
  '
  ;
  
  EXECUTE IMMEDIATE V_SENTENCIA INTO TABLE_COUNT;
  
  IF TABLE_COUNT = 0 THEN
  
    DBMS_OUTPUT.PUT_LINE('[INFO] TODOS LOS ACTIVOS EXISTEN EN PRP_PROPUESTAS_PRECIOS');
    
  ELSE
  
    DBMS_OUTPUT.PUT_LINE('[INFO] SE HAN INFORMADO '||TABLE_COUNT||' PRUESTAS DE PRECIOS INEXISTENTES EN PRP_PROPUESTAS_PRECIOS. SE DERIVAR√ÅN A LA TABLA '||V_ESQUEMA||'.MIG2_PRP_NOT_EXISTS.');
    
    --BORRAMOS LOS REGISTROS QUE HAYA EN NOT_EXISTS REFERENTES A ESTA INTERFAZ
    
    EXECUTE IMMEDIATE '
    DELETE FROM '||V_ESQUEMA||'.MIG2_PRP_NOT_EXISTS
    WHERE TABLA_MIG = '''||V_TABLA_MIG||'''
    '
    ;
    
    COMMIT;
  
    EXECUTE IMMEDIATE '
    INSERT INTO '||V_ESQUEMA||'.MIG2_PRP_NOT_EXISTS (
    PRP_NUM_PROPUESTA,
    TABLA_MIG,
    FECHA_COMPROBACION
    )
    WITH PRP_NUM_PROPUESTA AS (
		SELECT
		MIG.ACT_PRP_NUM_PROPUESTA 
		FROM '||V_ESQUEMA||'.'||V_TABLA_MIG||' MIG 
		WHERE NOT EXISTS (
		  SELECT 1 FROM '||V_ESQUEMA||'.PRP_PROPUESTAS_PRECIOS PRP WHERE MIG.ACT_PRP_NUM_PROPUESTA = PRP.PRP_NUM_PROPUESTA
		)
    )
    SELECT DISTINCT
    MIG.ACT_PRP_NUM_PROPUESTA                              					PRP_NUM_PROPUESTA,
    '''||V_TABLA_MIG||'''                                                   TABLA_MIG,
    SYSDATE                                                                 FECHA_COMPROBACION
    FROM '||V_ESQUEMA||'.'||V_TABLA_MIG||' MIG  
    INNER JOIN ACT_NUM_ACTIVO
    ON ACT_NUM_ACTIVO.ACT_PRP_NUM_PROPUESTA = MIG.ACT_PRP_NUM_PROPUESTA
    '
    ;
    
    COMMIT;

  END IF;
