SELECT
      (SELECT '# CLIENTE_COMERCIAL' FROM DUAL) AS VALIDACION,
      (SELECT NULL FROM DUAL) AS RESULTADO
FROM DUAL

UNION ALL

SELECT
      (SELECT 'DUPLICADOS (CLC_COD_CLIENTE_HAYA)' FROM DUAL) AS VALIDACION,
      (SELECT SUM(COUNT(1)) FROM MIG2_CLC_CLIENTE_COMERCIAL WHERE CLC_COD_CLIENTE_HAYA IS NOT NULL GROUP BY CLC_COD_CLIENTE_HAYA HAVING COUNT(1) > 1) AS RESULTADO
FROM DUAL

UNION ALL 

SELECT
      (SELECT 'DUPLICADOS (CLC_COD_CLIENTE_WEBCOM)' FROM DUAL) AS VALIDACION,
      (SELECT SUM(COUNT(1)) FROM MIG2_CLC_CLIENTE_COMERCIAL WHERE CLC_COD_CLIENTE_HAYA IS NOT NULL GROUP BY CLC_COD_CLIENTE_WEBCOM HAVING COUNT(1) > 1) AS RESULTADO
FROM DUAL

UNION ALL 

SELECT
      (SELECT '# VISITAS' FROM DUAL) AS VALIDACION,
      (SELECT NULL FROM DUAL) AS RESULTADO
FROM DUAL

UNION ALL

SELECT
      (SELECT 'DUPLICADOS (VIS_COD_VISITA_WEBCOM)' FROM DUAL) AS VALIDACION,
      (SELECT SUM(COUNT(1)) FROM MIG2_VIS_VISITAS GROUP BY VIS_COD_VISITA_WEBCOM HAVING COUNT(1) > 1) AS RESULTADO
FROM DUAL

UNION ALL

SELECT
      (SELECT 'DUPLICADOS (VIS_COD_VISITA_WEBCOM + VIS_COD_CLIENTE_WEBCOM)' FROM DUAL) AS VALIDACION,
      (SELECT SUM(COUNT(1)) FROM MIG2_VIS_VISITAS GROUP BY VIS_COD_VISITA_WEBCOM, VIS_COD_CLIENTE_WEBCOM HAVING COUNT(1) > 1) AS RESULTADO
FROM DUAL

UNION ALL

SELECT
      (SELECT '# OFERTAS' FROM DUAL) AS VALIDACION,
      (SELECT NULL FROM DUAL) AS RESULTADO
FROM DUAL

UNION ALL 

SELECT
      (SELECT 'DUPLICADOS (OFR_COD_OFERTA)' FROM DUAL) AS VALIDACION,
      (SELECT SUM(COUNT(1)) FROM MIG2_OFR_OFERTAS GROUP BY OFR_COD_OFERTA HAVING COUNT(1) > 1) AS RESULTADO
FROM DUAL

UNION ALL

SELECT
      (SELECT '# OFERTAS ACTIVOS' FROM DUAL) AS VALIDACION,
      (SELECT NULL FROM DUAL) AS RESULTADO
FROM DUAL

UNION ALL 

SELECT
      (SELECT 'DUPLICADOS (OFA_COD_OFERTA + OFA_ACT_NUMERO_ACTIVO)' FROM DUAL) AS VALIDACION,
      (SELECT SUM(COUNT(1)) FROM MIG2_OFA_OFERTAS_ACTIVO GROUP BY OFA_COD_OFERTA, OFA_ACT_NUMERO_ACTIVO HAVING COUNT(1) > 1) AS RESULTADO
FROM DUAL

UNION ALL

SELECT
      (SELECT '# TITULARES ADICIONALES' FROM DUAL) AS VALIDACION,
      (SELECT NULL FROM DUAL) AS RESULTADO
FROM DUAL

UNION ALL 

SELECT
      (SELECT 'DUPLICADOS (OFR_TIA_COD_OFERTA + OFR_TIA_DOCUMENTO)' FROM DUAL) AS VALIDACION,
      (SELECT SUM(COUNT(1)) FROM MIG2_OFR_TIA_TITULARES_ADI GROUP BY OFR_TIA_COD_OFERTA, OFR_TIA_DOCUMENTO HAVING COUNT(1) > 1) AS RESULTADO
FROM DUAL

UNION ALL

SELECT
      (SELECT '# CONDICIONANTE OFERTA ACEPTADA' FROM DUAL) AS VALIDACION,
      (SELECT NULL FROM DUAL) AS RESULTADO
FROM DUAL

UNION ALL 

SELECT
      (SELECT 'DUPLICADOS (COE_COD_OFERTA)' FROM DUAL) AS VALIDACION,
      (SELECT SUM(COUNT(1)) FROM MIG2_COE_CONDICIONAN_OFR_ACEP GROUP BY COE_COD_OFERTA HAVING COUNT(1) > 1) AS RESULTADO
FROM DUAL

UNION ALL
SELECT
      (SELECT '# RESERVAS' FROM DUAL) AS VALIDACION,
      (SELECT NULL FROM DUAL) AS RESULTADO
FROM DUAL

UNION ALL 

SELECT
      (SELECT 'DUPLICADOS (RES_COD_NUM_RESERVA)' FROM DUAL) AS VALIDACION,
      (SELECT SUM(COUNT(1)) FROM MIG2_RES_RESERVAS GROUP BY RES_COD_NUM_RESERVA HAVING COUNT(1) > 1) AS RESULTADO
FROM DUAL

UNION ALL

SELECT
      (SELECT '# COMPRADORES' FROM DUAL) AS VALIDACION,
      (SELECT NULL FROM DUAL) AS RESULTADO
FROM DUAL

UNION ALL 

SELECT
      (SELECT 'DUPLICADOS (COM_COD_COMPRADOR)' FROM DUAL) AS VALIDACION,
      (SELECT SUM(COUNT(1)) FROM MIG2_COM_COMPRADORES GROUP BY COM_COD_COMPRADOR HAVING COUNT(1) > 1) AS RESULTADO
FROM DUAL

UNION ALL

SELECT
      (SELECT '# COMPRADORES EXPEDIENTES' EXPEDIENTE FROM DUAL) AS VALIDACION,
      (SELECT NULL FROM DUAL) AS RESULTADO
FROM DUAL

UNION ALL 

SELECT
      (SELECT 'DUPLICADOS (CEX_COD_COMPRADOR + CEX_COD_OFERTA)' FROM DUAL) AS VALIDACION,
      (SELECT SUM(COUNT(1)) FROM MIG2_CEX_COMPRADOR_EXPEDIENTE GROUP BY (CEX_COD_COMPRADOR, CEX_COD_OFERTA) HAVING COUNT(1) > 1) AS RESULTADO
FROM DUAL

UNION ALL

SELECT
      (SELECT '# GASTOS EXPEDIENTE' FROM DUAL) AS VALIDACION,
      (SELECT NULL FROM DUAL) AS RESULTADO
FROM DUAL

UNION ALL 

SELECT
      (SELECT 'DUPLICADOS (GEX_COD_OFERTA + GEX_COD_CONCEPTO_GASTO + GEX_IMPORTE_FINAL + GEX_COD_PROVEEDOR)' FROM DUAL) AS VALIDACION,
      (SELECT SUM(COUNT(1)) FROM MIG2_GEX_GASTOS_EXPEDIENTE MIG2 GROUP BY (GEX_COD_OFERTA, GEX_COD_CONCEPTO_GASTO, GEX_IMPORTE_FINAL, GEX_COD_PROVEEDOR) HAVING COUNT (1) > 1) AS RESULTADO
FROM DUAL

UNION ALL

SELECT
      (SELECT '# FORMALIZACIONES' FROM DUAL) AS VALIDACION,
      (SELECT NULL FROM DUAL) AS RESULTADO
FROM DUAL

UNION ALL 

SELECT
      (SELECT 'DUPLICADOS (FOR_COD_OFERTA)' FROM DUAL) AS VALIDACION,
      (SELECT SUM(COUNT(1)) FROM MIG2_FOR_FORMALIZACIONES GROUP BY (FOR_COD_OFERTA) HAVING COUNT (1) > 1) AS RESULTADO
FROM DUAL

UNION ALL

SELECT
      (SELECT '# SUBSANACIONES' FROM DUAL) AS VALIDACION,
      (SELECT NULL FROM DUAL) AS RESULTADO
FROM DUAL

UNION ALL 

SELECT
      (SELECT 'DUPLICADOS (SUB_COD_OFERTA)' FROM DUAL) AS VALIDACION,
      (SELECT SUM(COUNT(1)) FROM MIG2_SUB_SUBSANACIONES GROUP BY (SUB_COD_OFERTA) HAVING COUNT (1) > 1) AS RESULTADO
FROM DUAL

UNION ALL

SELECT
      (SELECT '# CONDICIONES ESPECIFICAS' FROM DUAL) AS VALIDACION,
      (SELECT NULL FROM DUAL) AS RESULTADO
FROM DUAL

UNION ALL 

SELECT
      (SELECT 'DUPLICADOS (COE_ACT_NUMERO_ACTIVO + COE_FECHA_DESDE)' FROM DUAL) AS VALIDACION,
      (SELECT SUM(COUNT(1)) FROM MIG2_ACT_COE_CONDICIONES_ESPEC GROUP BY (COE_ACT_NUMERO_ACTIVO, COE_FECHA_DESDE) HAVING COUNT (1) > 1) AS RESULTADO
FROM DUAL

UNION ALL

SELECT
      (SELECT '#  HISTORICO VALORACIONES' FROM DUAL) AS VALIDACION,
      (SELECT NULL FROM DUAL) AS RESULTADO
FROM DUAL

UNION ALL 

SELECT
      (SELECT 'DUPLICADOS (HVA_ACT_NUMERO_ACTIVO + HVA_COD_TIPO_PRECIO + HVA_FECHA_INICIO)' FROM DUAL) AS VALIDACION,
      (SELECT SUM(COUNT(1)) FROM MIG2_ACT_HVA_HIST_VALORACIONES GROUP BY (HVA_ACT_NUMERO_ACTIVO, HVA_COD_TIPO_PRECIO, HVA_FECHA_INICIO) HAVING COUNT (1) > 1) AS RESULTADO
FROM DUAL

UNION ALL

SELECT
      (SELECT '# PROPUESTAS PRECIOS' FROM DUAL) AS VALIDACION,
      (SELECT NULL FROM DUAL) AS RESULTADO
FROM DUAL

UNION ALL 

SELECT
      (SELECT 'DUPLICADOS (PRP_NUM_PROPUESTA)' FROM DUAL) AS VALIDACION,
      (SELECT SUM(COUNT(1)) FROM MIG2_PRP_PROPUESTAS_PRECIOS GROUP BY (PRP_NUM_PROPUESTA) HAVING COUNT (1) > 1) AS RESULTADO
FROM DUAL

UNION ALL

SELECT
      (SELECT '# ACTIVOS PROPUESTAS' FROM DUAL) AS VALIDACION,
      (SELECT NULL FROM DUAL) AS RESULTADO
FROM DUAL

UNION ALL 

SELECT
      (SELECT 'DUPLICADOS (ACT_PRP_ACT_NUMERO_ACTIVO + ACT_PRP_NUM_PROPUESTA)' FROM DUAL) AS VALIDACION,
      (SELECT SUM(COUNT(1)) FROM MIG2_ACT_PRP GROUP BY (ACT_PRP_ACT_NUMERO_ACTIVO, ACT_PRP_NUM_PROPUESTA) HAVING COUNT (1) > 1) AS RESULTADO
FROM DUAL

UNION ALL

SELECT
      (SELECT '# PROVEEDORES' FROM DUAL) AS VALIDACION,
      (SELECT NULL FROM DUAL) AS RESULTADO
FROM DUAL

UNION ALL 

SELECT
      (SELECT 'DUPLICADOS (PVE_COD_UVEM)' FROM DUAL) AS VALIDACION,
      (SELECT SUM(COUNT(1)) FROM MIG2_PVE_PROVEEDORES GROUP BY (PVE_COD_UVEM) HAVING COUNT (1) > 1) AS RESULTADO
FROM DUAL

UNION ALL

SELECT
      (SELECT '# PROVEEDORES DIRECCIONES' FROM DUAL) AS VALIDACION,
      (SELECT NULL FROM DUAL) AS RESULTADO
FROM DUAL

UNION ALL 

SELECT
      (SELECT 'DUPLICADOS (PVE_COD_UVEM)' FROM DUAL) AS VALIDACION,
      (SELECT SUM(COUNT(1)) FROM MIG2_PRD_PROVEEDOR_DIRECCION GROUP BY (PVD_COD_DIRECCION) HAVING COUNT (1) > 1) AS RESULTADO
FROM DUAL

UNION ALL

SELECT
      (SELECT '# PROVEEDORES CONTACTOS' FROM DUAL) AS VALIDACION,
      (SELECT NULL FROM DUAL) AS RESULTADO
FROM DUAL

UNION ALL 

SELECT
      (SELECT 'DUPLICADOS (PVC_DOCUMENTO + PVE_COD_UVEM)' FROM DUAL) AS VALIDACION,
      (SELECT SUM(COUNT(1)) FROM MIG2_PVC_PROVEEDOR_CONTACTO GROUP BY (PVC_DOCUMENTO, PVE_COD_UVEM) HAVING COUNT (1) > 1) AS RESULTADO
FROM DUAL

UNION ALL

SELECT
      (SELECT '# GASTOS PROVEEDORES' FROM DUAL) AS VALIDACION,
      (SELECT NULL FROM DUAL) AS RESULTADO
FROM DUAL

UNION ALL 

SELECT
      (SELECT 'DUPLICADOS (GPV_ID)' FROM DUAL) AS VALIDACION,
      (SELECT SUM(COUNT(1)) FROM MIG2_GPV_GASTOS_PROVEEDORES GROUP BY (GPV_ID) HAVING COUNT (1) > 1) AS RESULTADO
FROM DUAL

UNION ALL

SELECT
      (SELECT '# GASTOS PROVEEDORES, ACTIVO, TRABAJO' FROM DUAL) AS VALIDACION,
      (SELECT NULL FROM DUAL) AS RESULTADO
FROM DUAL

UNION ALL 

SELECT
      (SELECT 'DUPLICADOS (GPT_GPV_ID + GPT_ACT_NUMERO_ACTIVO + GPT_TBJ_NUM_TRABAJO)' FROM DUAL) AS VALIDACION,
      (SELECT SUM(COUNT(1)) FROM MIG2_GPV_ACT_TBJ GROUP BY (GPT_GPV_ID, GPT_ACT_NUMERO_ACTIVO, GPT_TBJ_NUM_TRABAJO) HAVING COUNT (1) > 1) AS RESULTADO
FROM DUAL

UNION ALL

SELECT
      (SELECT '# GASTOS DETALLE ECONOMICO' FROM DUAL) AS VALIDACION,
      (SELECT NULL FROM DUAL) AS RESULTADO
FROM DUAL

UNION ALL 

SELECT
      (SELECT 'DUPLICADOS (GDE_GPV_ID)' FROM DUAL) AS VALIDACION,
      (SELECT SUM(COUNT(1)) FROM MIG2_GDE_GASTOS_DET_ECONOMICO GROUP BY (GDE_GPV_ID) HAVING COUNT (1) > 1) AS RESULTADO
FROM DUAL

UNION ALL

SELECT
      (SELECT '# GASTOS GESTION' FROM DUAL) AS VALIDACION,
      (SELECT NULL FROM DUAL) AS RESULTADO
FROM DUAL

UNION ALL 

SELECT
      (SELECT 'DUPLICADOS (GGE_GPV_ID)' FROM DUAL) AS VALIDACION,
      (SELECT SUM(COUNT(1)) FROM MIG2_GGE_GASTOS_GESTION GROUP BY (GGE_GPV_ID) HAVING COUNT (1) > 1) AS RESULTADO
FROM DUAL

UNION ALL

SELECT
      (SELECT '# GASTOS IMPUGNACIONES' FROM DUAL) AS VALIDACION,
      (SELECT NULL FROM DUAL) AS RESULTADO
FROM DUAL

UNION ALL 

SELECT
      (SELECT 'DUPLICADOS (GIM_GPV_ID)' FROM DUAL) AS VALIDACION,
      (SELECT SUM(COUNT(1)) FROM MIG2_GIM_GASTOS_IMPUGNACION GROUP BY (GIM_GPV_ID) HAVING COUNT (1) > 1) AS RESULTADO
FROM DUAL

UNION ALL

SELECT
      (SELECT '# GASTOS INFO CONTABILIDAD' FROM DUAL) AS VALIDACION,
      (SELECT NULL FROM DUAL) AS RESULTADO
FROM DUAL

UNION ALL 

SELECT
      (SELECT 'DUPLICADOS (GIC_GPV_ID)' FROM DUAL) AS VALIDACION,
      (SELECT SUM(COUNT(1)) FROM MIG2_GIC_GASTOS_INFO_CONTABI GROUP BY (GIC_GPV_ID) HAVING COUNT (1) > 1) AS RESULTADO
FROM DUAL

UNION ALL

SELECT
      (SELECT '# GASTOS PROVISION' FROM DUAL) AS VALIDACION,
      (SELECT NULL FROM DUAL) AS RESULTADO
FROM DUAL

UNION ALL 

SELECT
      (SELECT 'DUPLICADOS (GPR_NUMERO_PROVISION_FONDOS + GPR_COD_GESTORIA + GPR_COD_ESTADO_PROVISION)' FROM DUAL) AS VALIDACION,
      (SELECT SUM(COUNT(1)) FROM MIG2_GPR_PROVISION_GASTOS GROUP BY (GPR_NUMERO_PROVISION_FONDOS, GPR_COD_GESTORIA, GPR_COD_ESTADO_PROVISION) HAVING COUNT (1) > 1) AS RESULTADO
FROM DUAL

UNION ALL

SELECT
      (SELECT '# PERIMETRO ACTIVO' FROM DUAL) AS VALIDACION,
      (SELECT NULL FROM DUAL) AS RESULTADO
FROM DUAL

UNION ALL 

SELECT
      (SELECT 'DUPLICADOS (PAC_NUMERO_ACTIVO)' FROM DUAL) AS VALIDACION,
      (SELECT SUM(COUNT(1)) FROM MIG2_PAC_PERIMETRO_ACTIVO GROUP BY (PAC_NUMERO_ACTIVO) HAVING COUNT (1) > 1) AS RESULTADO
FROM DUAL

UNION ALL

SELECT
      (SELECT '# ACTIVO' FROM DUAL) AS VALIDACION,
      (SELECT NULL FROM DUAL) AS RESULTADO
FROM DUAL

UNION ALL 

SELECT
      (SELECT 'DUPLICADOS (ACT_NUMERO_ACTIVO)' FROM DUAL) AS VALIDACION,
      (SELECT SUM(COUNT(1)) FROM MIG2_ACT_ACTIVO GROUP BY (ACT_NUMERO_ACTIVO) HAVING COUNT (1) > 1) AS RESULTADO
FROM DUAL

UNION ALL

SELECT
      (SELECT '# DATOS ALQUILERES' FROM DUAL) AS VALIDACION,
      (SELECT NULL FROM DUAL) AS RESULTADO
FROM DUAL

UNION ALL 

SELECT
      (SELECT 'DUPLICADOS (ACQ_NUMERO_ACTIVO + ACQ_NUMERO_CONTRATO_ALQUILER)' FROM DUAL) AS VALIDACION,
      (SELECT SUM(COUNT(1)) FROM MIG2_ACQ_ACTIVO_ALQUILER GROUP BY (ACQ_NUMERO_ACTIVO, ACQ_NUMERO_CONTRATO_ALQUILER) HAVING COUNT (1) > 1) AS RESULTADO
FROM DUAL

UNION ALL

SELECT
      (SELECT '# AGRUPACIONES' FROM DUAL) AS VALIDACION,
      (SELECT NULL FROM DUAL) AS RESULTADO
FROM DUAL

UNION ALL 

SELECT
      (SELECT 'DUPLICADOS (AGR_UVEM)' FROM DUAL) AS VALIDACION,
      (SELECT SUM(COUNT(1)) FROM MIG2_AGR_AGRUPACIONES GROUP BY (AGR_UVEM) HAVING COUNT (1) > 1) AS RESULTADO
FROM DUAL

UNION ALL

SELECT
      (SELECT '# PROPIETARIOS' FROM DUAL) AS VALIDACION,
      (SELECT NULL FROM DUAL) AS RESULTADO
FROM DUAL

UNION ALL 

SELECT
      (SELECT 'DUPLICADOS (PRO_PROPIETARIO_CODIGO_UVEM)' FROM DUAL) AS VALIDACION,
      (SELECT SUM(COUNT(1)) FROM MIG2_PRO_PROPIETARIOS GROUP BY (PRO_PROPIETARIO_CODIGO_UVEM) HAVING COUNT (1) > 1) AS RESULTADO
FROM DUAL
;

DELETE FROM MIG2_CLC_CLIENTE_COMERCIAL WHERE rowid in  (SELECT MIN(rowid) FROM MIG2_CLC_CLIENTE_COMERCIAL a GROUP BY a.CLC_COD_CLIENTE_HAYA HAVING count(*) > 1); 
DELETE FROM MIG2_VIS_VISITAS WHERE rowid in  (SELECT MIN(rowid) FROM MIG2_VIS_VISITAS a GROUP BY a.VIS_COD_VISITA_WEBCOM HAVING count(*) > 1); 
DELETE FROM MIG2_COM_COMPRADORES WHERE rowid in  (SELECT MIN(rowid) FROM MIG2_COM_COMPRADORES a GROUP BY a.COM_COD_COMPRADOR HAVING count(*) > 1); 
DELETE FROM MIG2_CEX_COMPRADOR_EXPEDIENTE WHERE rowid in  (SELECT MIN(rowid) FROM MIG2_CEX_COMPRADOR_EXPEDIENTE a GROUP BY a.CEX_COD_COMPRADOR, a.CEX_COD_OFERTA HAVING count(*) > 1);
DELETE FROM MIG2_ACT_PRP WHERE rowid in  (SELECT MIN(rowid) FROM MIG2_ACT_PRP a GROUP BY a.ACT_PRP_ACT_NUMERO_ACTIVO, a.ACT_PRP_NUM_PROPUESTA HAVING count(*) > 1);
DELETE FROM MIG2_GPR_PROVISION_GASTOS WHERE rowid in  (SELECT MIN(rowid) FROM MIG2_GPR_PROVISION_GASTOS a GROUP BY a.GPR_NUMERO_PROVISION_FONDOS, a.GPR_COD_GESTORIA, a.GPR_COD_ESTADO_PROVISION HAVING count(*) > 1);
DELETE FROM MIG2_ACT_ACTIVO WHERE rowid in  (SELECT MIN(rowid) FROM MIG2_ACT_ACTIVO a GROUP BY ACT_NUMERO_ACTIVO HAVING count(*) > 1);
DELETE FROM MIG2_PRO_PROPIETARIOS WHERE rowid in  (SELECT MIN(rowid) FROM MIG2_PRO_PROPIETARIOS a GROUP BY PRO_PROPIETARIO_CODIGO_UVEM HAVING count(*) > 1);
