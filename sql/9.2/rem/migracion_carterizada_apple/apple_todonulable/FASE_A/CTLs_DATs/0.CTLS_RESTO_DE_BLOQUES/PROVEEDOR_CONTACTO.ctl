OPTIONS (DIRECT=TRUE, BINDSIZE=512000, ROWS=10000, ERRORS=999999)
LOAD DATA
CHARACTERSET WE8ISO8859P1
INFILE './CTLs_DATs/DATs/PROVEEDOR_CONTACTO.dat'
BADFILE './CTLs_DATs/bad/PROVEEDOR_CONTACTO.bad'
DISCARDFILE './CTLs_DATs/rejects/PROVEEDOR_CONTACTO.bad'
INTO TABLE REM01.MIG2_PVC_PROVEEDOR_CONTACTO
TRUNCATE
TRAILING NULLCOLS
(   
    PVC_DOCUMENTO       POSITION(1:20)          CHAR                       								"REPLACE(REPLACE(REPLACE(TRIM(:PVC_DOCUMENTO),';',' '), '\"',''),'''','')",
    PVC_TIPO_DOCUMENTO  POSITION(21:40)         CHAR                   									"REPLACE(REPLACE(REPLACE(TRIM(:PVC_TIPO_DOCUMENTO),';',' '), '\"',''),'''','')",
    PVE_COD_ORIGEN      POSITION(41:60)         CHAR                                                    "REPLACE(REPLACE(REPLACE(TRIM(:PVE_COD_ORIGEN),';',' '), '\"',''),'''','')",
    PVC_NOMBRE          POSITION(61:310)        CHAR NULLIF(PVC_NOMBRE=BLANKS)                          "REPLACE(REPLACE(REPLACE(TRIM(:PVC_NOMBRE),';',' '), '\"',''),'''','')",
    PVC_APELLIDO1       POSITION(311:410)       CHAR NULLIF(PVC_APELLIDO1=BLANKS)                       "REPLACE(REPLACE(REPLACE(TRIM(:PVC_APELLIDO1),';',' '), '\"',''),'''','')",
    PVC_APELLIDO2       POSITION(411:510)       CHAR NULLIF(PVC_APELLIDO2=BLANKS)                       "REPLACE(REPLACE(REPLACE(TRIM(:PVC_APELLIDO2),';',' '), '\"',''),'''','')",
    PVC_PROVINCIA       POSITION(511:530)       CHAR NULLIF(PVC_PROVINCIA=BLANKS)                       "TO_NUMBER(REPLACE(REPLACE(REPLACE(TRIM(:PVC_PROVINCIA),';',' '), '\"',''),'''',''))",
    PVC_CP              POSITION(531:539)       INTEGER EXTERNAL NULLIF(PVC_CP=BLANKS)                  "TO_NUMBER(SUBSTR(REPLACE(REPLACE(REPLACE(TRIM(:PVC_CP),';',' '), '\"',''),'''',''),2,8))",
    PVC_DIRECCION       POSITION(540:789)       CHAR NULLIF(PVC_DIRECCION=BLANKS)                       "REPLACE(REPLACE(REPLACE(TRIM(:PVC_DIRECCION),';',' '), '\"',''),'''','')",
    PVC_TELF1           POSITION(790:809)       CHAR NULLIF(PVC_TELF1=BLANKS)                           "REPLACE(REPLACE(REPLACE(TRIM(:PVC_TELF1),';',' '), '\"',''),'''','')",
    PVC_TELF2           POSITION(810:829)       CHAR NULLIF(PVC_TELF2=BLANKS)                           "REPLACE(REPLACE(REPLACE(TRIM(:PVC_TELF2),';',' '), '\"',''),'''','')",
    PVC_FAX             POSITION(830:849)       CHAR NULLIF(PVC_FAX=BLANKS)                             "REPLACE(REPLACE(REPLACE(TRIM(:PVC_FAX),';',' '), '\"',''),'''','')",
    PVC_EMAIL           POSITION(850:899)       CHAR 						                            "REPLACE(REPLACE(REPLACE(TRIM(:PVC_EMAIL),';',' '), '\"',''),'''','')",
    PVC_IND_PRINCIPAL   POSITION(900:901)       INTEGER EXTERNAL 								        "TO_NUMBER(SUBSTR(REPLACE(REPLACE(REPLACE(TRIM(:PVC_IND_PRINCIPAL),';',' '), '\"',''),'''',''),2,1))",
    PVC_COD_CARGO       POSITION(902:921)       CHAR 							                        "REPLACE(REPLACE(REPLACE(TRIM(:PVC_COD_CARGO),';',' '), '\"',''),'''','')",
    PVC_CARGO           POSITION(922:971)       CHAR NULLIF(PVC_CARGO=BLANKS)                           "REPLACE(REPLACE(REPLACE(TRIM(:PVC_CARGO),';',' '), '\"',''),'''','')",
    PVC_FECHA_ALTA      POSITION(972:979)       DATE 'YYYYMMDD'								            "REPLACE(:PVC_FECHA_ALTA, '00000000', '')",
    PVC_FECHA_BAJA      POSITION(980:987)       DATE 'YYYYMMDD' NULLIF(PVC_FECHA_BAJA=BLANKS)           "REPLACE(:PVC_FECHA_BAJA, '00000000', '')",
    PVC_OBSERVACIONES   POSITION(988:1187)      CHAR NULLIF(PVC_OBSERVACIONES=BLANKS)                   "REPLACE(REPLACE(REPLACE(TRIM(:PVC_OBSERVACIONES),';',' '), '\"',''),'''','')",
    PVC_COD_DIRECCION   POSITION(1188:1204)     INTEGER EXTERNAL NULLIF(PVC_COD_DIRECCION=BLANKS)       "TO_NUMBER(SUBSTR(REPLACE(REPLACE(REPLACE(TRIM(:PVC_COD_DIRECCION),';',' '), '\"',''),'''',''),2,16))",
    PVC_COD_USUARIO     POSITION(1205:1224)     CHAR 							                        "REPLACE(REPLACE(REPLACE(TRIM(:PVC_COD_USUARIO),';',' '), '\"',''),'''','')",
    VALIDACION CONSTANT "0" 
)
