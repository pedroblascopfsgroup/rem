--/*
--##########################################
--## AUTOR=DANIEL ALBERT PÉREZ
--## FECHA_CREACION=20170518
--## ARTEFACTO=batch
--## VERSION_ARTEFACTO=2.0.4
--## INCIDENCIA_LINK=HREOS-2041
--## PRODUCTO=NO
--## 
--## Finalidad: 
--## INSTRUCCIONES:  Rellenar el array
--## VERSIONES:
--##        0.1 Versión inicial
--##########################################
--*/
WHENEVER SQLERROR EXIT SQL.SQLCODE;
SET SERVEROUTPUT ON;

DECLARE
  
  TYPE T_VIC IS TABLE OF VARCHAR2(4000 CHAR);
  TYPE T_ARRAY_VIC IS TABLE OF T_VIC;
   
  V_ESQUEMA          VARCHAR2(25 CHAR):= 'REM01'; 	-- '#ESQUEMA#'; -- Configuracion Esquema
  V_ESQUEMA_M   VARCHAR2(25 CHAR):= 'REMMASTER'; 	-- '#ESQUEMA_MASTER#'; -- Configuracion Esquema Master
  V_TABLA   VARCHAR2(30 CHAR):= 'VALIDACIONES_DICCIONARIOS'; 
  TABLE_COUNT number(3); 											-- Vble. para validar la existencia de las Tablas.
  err_num NUMBER; 													-- Numero de errores
  err_msg VARCHAR2(2048); 											-- Mensaje de error
  V_MSQL VARCHAR2(4000 CHAR);
  V_EXIST NUMBER(10);
  V_SEQUENCIA VARCHAR2(30 CHAR) := 'S_VALIDACIONES_DICCIONARIOS';
  V_SEC NUMBER(16);

  V_VIC T_ARRAY_VIC := T_ARRAY_VIC
  (
	/*
		1er bloque: Activos y Agrupaciones
	*/
	--ACTIVOS
	T_VIC('MIG2_ACT_ACTIVO', 'ACT_COD_CARTERA', 'DD_CRA_CARTERA', 'DD_CRA_CODIGO',0),
	T_VIC('MIG2_ACT_ACTIVO', 'ACT_COD_SUBCARTERA', 'DD_SCR_SUBCARTERA', 'DD_SCR_CODIGO',0),
	T_VIC('MIG2_ACT_ACTIVO', 'ACT_COD_SUBCARTERA_ANTERIOR', 'DD_SCR_SUBCARTERA', 'DD_SCR_CODIGO',0),
	T_VIC('MIG2_ACT_ACTIVO', 'ACT_COD_TIPO_COMERCIALIZACION', 'DD_TCO_TIPO_COMERCIALIZACION', 'DD_TCO_CODIGO',0),
	T_VIC('MIG2_ACT_ACTIVO', 'ACT_COD_TIPO_ALQUILER', 'DD_TAL_TIPO_ALQUILER', 'DD_TAL_CODIGO',0),
	T_VIC('MIG2_ACT_ACTIVO', 'ACT_COD_PROPIETARIO_ANTERIOR', 'DD_PRO_PROPIETARIOS', 'DD_PRO_CODIGO',0),
	T_VIC('MIG2_ACT_ACTIVO', 'ACT_BLOQUEO_PRECIO_USU_ID', 'REMMASTER.USU_USUARIOS', 'USU_USERNAME',0),
	T_VIC('MIG2_ACT_ACTIVO', 'ACT_COD_TIPO_PUBLICACION', 'DD_TPU_TIPO_PUBLICACION', 'DD_TPU_CODIGO',0),
	T_VIC('MIG2_ACT_ACTIVO', 'ACT_COD_ESTADO_PUBLICACION', 'DD_EPU_ESTADO_PUBLICACION', 'DD_EPU_CODIGO',0),
	T_VIC('MIG_ACA_CABECERA', 'ENTIDAD_PROPIETARIA', 'DD_CRA_CARTERA', 'DD_CRA_CODIGO',0),
	T_VIC('MIG_ACA_CABECERA', 'ENTIDAD_ORIGEN', 'DD_ENO_ENTIDAD_ORIGEN', 'DD_ENO_CODIGO',0),
	T_VIC('MIG_ACA_CABECERA', 'ENTIDAD_ORIGEN_ANTERIOR', 'DD_ENO_ENTIDAD_ORIGEN', 'DD_ENO_CODIGO',0),
	T_VIC('MIG_ACA_CABECERA', 'ACT_RATING', 'DD_RTG_RATING_ACTIVO', 'DD_RTG_CODIGO',0),
	T_VIC('MIG_ACA_CABECERA', 'TIPO_ACTIVO', 'DD_TPA_TIPO_ACTIVO', 'DD_TPA_CODIGO',0),
	T_VIC('MIG_ACA_CABECERA', 'SUBTIPO_ACTIVO', 'DD_SAC_SUBTIPO_ACTIVO', 'DD_SAC_CODIGO',0),
	T_VIC('MIG_ACA_CABECERA', 'ESTADO_ACTIVO', 'DD_EAC_ESTADO_ACTIVO', 'DD_EAC_CODIGO',0),
	T_VIC('MIG_ACA_CABECERA', 'USO_ACTIVO', 'DD_TUD_TIPO_USO_DESTINO', 'DD_TUD_CODIGO',0),
	T_VIC('MIG_ACA_CABECERA', 'TIPO_TITULO', 'DD_TTA_TIPO_TITULO_ACTIVO', 'DD_TTA_CODIGO',0),
	T_VIC('MIG_ACA_CABECERA', 'SUBTIPO_TITULO', 'DD_STA_SUBTIPO_TITULO_ACTIVO', 'DD_STA_CODIGO',0),
	T_VIC('MIG_ACA_CABECERA', 'SITUACION_COMERCIAL', 'DD_SCM_SITUACION_COMERCIAL', 'DD_SCM_CODIGO',0),
	T_VIC('MIG_APC_PRECIO', 'TIPO_PRECIO', 'DD_TPC_TIPO_PRECIO', 'DD_TPC_CODIGO',0),
	T_VIC('MIG_ADJ_JUDICIAL', 'ENTIDAD_EJECUTANTE', 'DD_EEJ_ENTIDAD_EJECUTANTE', 'DD_EEJ_CODIGO',0),
	T_VIC('MIG_ADJ_JUDICIAL', 'ESTADO_ADJUDICACION', 'DD_EDJ_ESTADO_ADJUDICACION', 'DD_EDJ_CODIGO',0),
	T_VIC('MIG_ADJ_NO_JUDICIAL', 'ENTIDAD_EJECUTANTE', 'DD_EEJ_ENTIDAD_EJECUTANTE', 'DD_EEJ_CODIGO',0),	
	T_VIC('MIG2_ACT_AHP_HIST_PUBLICACION', 'DD_EPV_COD', 'DD_EPV_ESTADO_PUB_VENTA', 'DD_EPV_CODIGO',0),
	T_VIC('MIG2_ACT_AHP_HIST_PUBLICACION', 'DD_EPA_COD', 'DD_EPA_ESTADO_PUB_ALQUILER', 'DD_EPA_CODIGO',0),
	T_VIC('MIG2_ACT_AHP_HIST_PUBLICACION', 'DD_TCO_COD', 'DD_TCO_TIPO_COMERCIALIZACION', 'DD_TCO_CODIGO',0),
	T_VIC('MIG2_ACT_AHP_HIST_PUBLICACION', 'DD_MTO_V_CODIGO', 'DD_MTO_MOTIVOS_OCULTACION', 'DD_MTO_CODIGO',0),
	T_VIC('MIG2_ACT_AHP_HIST_PUBLICACION', 'DD_MTO_A_CODIGO', 'DD_MTO_MOTIVOS_OCULTACION', 'DD_MTO_CODIGO',0),
	T_VIC('MIG2_ACT_AHP_HIST_PUBLICACION', 'DD_TPU_V_CODIGO', 'DD_TPU_TIPO_PUBLICACION', 'DD_TPU_CODIGO',0),
	T_VIC('MIG2_ACT_AHP_HIST_PUBLICACION', 'DD_TPU_A_CODIGO', 'DD_TPU_TIPO_PUBLICACION', 'DD_TPU_CODIGO',0),	
	T_VIC('MIG_ADA_DATOS_ADI', 'TIPO_VPO', 'DD_TVP_TIPO_VPO', 'DD_TVP_CODIGO',0),
	T_VIC('MIG_ADA_DATOS_ADI', 'TIPO_TITULO_POSESORIO', 'DD_TPO_TIPO_TITULO_POSESORIO', 'DD_TPO_CODIGO',0),
	T_VIC('MIG_ADA_DATOS_ADI', 'MUNICIPIO_REGISTRO', 'REMMASTER.DD_LOC_LOCALIDAD', 'DD_LOC_CODIGO',0),
	T_VIC('MIG_ADA_DATOS_ADI', 'MUNICIPIO_REG_ANTERIOR', 'REMMASTER.DD_LOC_LOCALIDAD', 'DD_LOC_CODIGO',0),
	T_VIC('MIG_ADA_DATOS_ADI', 'ESTADO_DIVISION_HORIZONTAL', 'DD_EDH_ESTADO_DIV_HORIZONTAL', 'DD_EDH_CODIGO',0),
	T_VIC('MIG_ADA_DATOS_ADI', 'ESTADO_OBRA_NUEVA', 'DD_EON_ESTADO_OBRA_NUEVA', 'DD_EON_CODIGO',0),
	T_VIC('MIG_ADA_DATOS_ADI', 'TIPO_UBICACION', 'DD_TUB_TIPO_UBICACION', 'DD_TUB_CODIGO',0),
	T_VIC('MIG_ADA_DATOS_ADI', 'TIPO_VIA', 'REMMASTER.DD_TVI_TIPO_VIA', 'DD_TVI_CODIGO',0),
	T_VIC('MIG_ADA_DATOS_ADI', 'UNIDAD_INFERIOR_MUNICIPIO', 'REMMASTER.DD_UPO_UNID_POBLACIONAL', 'DD_UPO_CODIGO',0),	
	T_VIC('MIG_ADA_DATOS_ADI', 'MUNICIPIO', 'REMMASTER.DD_LOC_LOCALIDAD', 'DD_LOC_CODIGO',0),
	T_VIC('MIG_ADA_DATOS_ADI', 'BIE_DREG_MUNICIPIO_LIBRO', 'REMMASTER.DD_LOC_LOCALIDAD', 'DD_LOC_CODIGO',0),
	T_VIC('MIG_ADA_DATOS_ADI', 'PROVINCIA', 'REMMASTER.DD_PRV_PROVINCIA', 'DD_PRV_CODIGO',0),
	T_VIC('MIG_ADA_DATOS_ADI', 'PAIS', 'REMMASTER.DD_CIC_CODIGO_ISO_CIRBE_BKP', 'DD_CIC_CODIGO',0),
	T_VIC('MIG_ADA_DATOS_ADI', 'DD_SIJ_ID', 'DD_SIJ_SITUACION_JURIDICA', 'DD_SIJ_CODIGO',0),
	T_VIC('MIG_ATI_TITULO', 'ESTADO_TITULO', 'DD_ETI_ESTADO_TITULO', 'DD_ETI_CODIGO',0),
	T_VIC('MIG_ADD_ADMISION_DOC', 'TIPO_DOCUMENTO', 'DD_TPD_TIPO_DOCUMENTO', 'DD_TPD_CODIGO',0),
	T_VIC('MIG_ADD_ADMISION_DOC', 'ESTADO_DOCUMENTO', 'DD_EDC_ESTADO_DOCUMENTO', 'DD_EDC_CODIGO',0),
	T_VIC('MIG_ADD_ADMISION_DOC', 'ADO_CALIFICACION', 'DD_TCE_TIPO_CALIF_ENERGETICA', 'DD_TCE_CODIGO',0),
	T_VIC('MIG_ACA_CALIDADES_ACTIVO', 'NIVEL_ACABADO_INTERIOR', 'DD_ACR_ACABADO_CARPINTERIA', 'DD_ACR_CODIGO',0),
	T_VIC('MIG_ACA_CARGAS_ACTIVO', 'TIPO_CARGA', 'DD_TCA_TIPO_CARGA', 'DD_TCA_CODIGO',0),
	T_VIC('MIG_ACA_CARGAS_ACTIVO', 'SUBTIPO_CARGA', 'DD_STC_SUBTIPO_CARGA', 'DD_STC_CODIGO',0),
	T_VIC('MIG_ACA_CARGAS_ACTIVO', 'SITUACION_CARGA', 'DD_SIC_SITUACION_CARGA', 'DD_SIC_CODIGO',0),
	T_VIC('MIG_ACA_CARGAS_ACTIVO', 'DD_ODT_ID', 'DD_ODT_ORIGEN_DATO', 'DD_ODT_CODIGO',0),
	T_VIC('MIG_AIA_INFCOMERCIAL_ACT', 'DD_TVP_ID', 'DD_TVP_TIPO_VPO', 'DD_TVP_CODIGO',0),
	T_VIC('MIG_AIA_INFCOMERCIAL_ACT', 'UBICACION_ACTIVO', 'DD_UAC_UBICACION_ACTIVO', 'DD_UAC_CODIGO',0),
	T_VIC('MIG_AIA_INFCOMERCIAL_ACT', 'ESTADO_CONSTRUCCION', 'DD_ECT_ESTADO_CONSTRUCCION', 'DD_ECT_CODIGO',0),
	T_VIC('MIG_AIA_INFCOMERCIAL_ACT', 'ESTADO_CONSERVACION', 'DD_ECV_ESTADO_CONSERVACION', 'DD_ECV_CODIGO',0),  
	T_VIC('MIG_AIA_INFCOMERCIAL_ACT', 'TIPO_INFO_COMERCIAL', 'DD_TIC_TIPO_INFO_COMERCIAL', 'DD_TIC_CODIGO',0),  
	T_VIC('MIG_AIA_INFCOMERCIAL_ACT', 'ESTADO_CONSERVACION_EDIFICIO', 'DD_ECV_ESTADO_CONSERVACION', 'DD_ECV_CODIGO',0),
	T_VIC('MIG_AIA_INFCOMERCIAL_ACT', 'TIPO_FACHADA_EDIFICIO', 'DD_TPF_TIPO_FACHADA', 'DD_TPF_CODIGO',0),
	T_VIC('MIG_AIA_INFCOMERCIAL_ACT', 'TIPO_VIVIENDA', 'DD_TPV_TIPO_VIVIENDA', 'DD_TPV_CODIGO',0),
	T_VIC('MIG_AIA_INFCOMERCIAL_ACT', 'TIPO_ORIENTACION', 'DD_TPO_TIPO_ORIENTACION', 'DD_TPO_CODIGO',0),
	T_VIC('MIG_AIA_INFCOMERCIAL_ACT', 'TIPO_RENTA', 'DD_TPR_TIPO_RENTA', 'DD_TPR_CODIGO',0),
	T_VIC('MIG_AIA_INFCOMERCIAL_ACT', 'DD_TUA_ID', 'DD_TUA_TIPO_UBICA_APARCA', 'DD_TUA_CODIGO',0),
	T_VIC('MIG_AIA_INFCOMERCIAL_ACT', 'DD_TCA_ID', 'DD_TCA_TIPO_CALIDAD', 'DD_TCA_CODIGO',0),
	T_VIC('MIG_AID_INFCOMERCIAL_DISTR', 'TIPO_HABITACULO', 'DD_TPH_TIPO_HABITACULO', 'DD_TPH_CODIGO',0),
	T_VIC('MIG_AML_MOVIMIENTOS_LLAVE', 'MLV_TIPO_TENEDOR', 'DD_TTE_TIPO_TENEDOR', 'DD_TTE_CODIGO',0),
	T_VIC('MIG_AOA_OBSERVACIONES_ACTIVOS', 'AOB_TIPO_OBSERVACION', 'DD_TOB_TIPO_OBSERVACION', 'DD_TOB_CODIGO',0),
	T_VIC('MIG2_PAC_PERIMETRO_ACTIVO', 'PAC_COD_MOTIVO_COMERCIAL', 'DD_MCO_MOTIVO_COMERCIALIZACION', 'DD_MCO_CODIGO',0),
	T_VIC('MIG2_PAC_PERIMETRO_ACTIVO', 'PAC_COD_MOTIVO_NOCOMERCIAL', 'DD_MNC_MOT_NOCOMERCIALIZACION', 'DD_MNC_CODIGO',0),
	T_VIC('MIG_ATA_TASACIONES_ACTIVO', 'TAS_TIPO_TASACION', 'DD_TTS_TIPO_TASACION', 'DD_TTS_CODIGO',0),	
	T_VIC('MIG_APC_PROP_CABECERA', 'LOCALIDAD_PROPIETARIO', 'REMMASTER.DD_LOC_LOCALIDAD', 'DD_LOC_CODIGO',0),
	T_VIC('MIG_APC_PROP_CABECERA', 'PROVINCIA_PROPIETARIO', 'REMMASTER.DD_PRV_PROVINCIA', 'DD_PRV_CODIGO',0),
	T_VIC('MIG_APC_PROP_CABECERA', 'TIPO_PERSONA', 'REMMASTER.DD_TPE_TIPO_PERSONA', 'DD_TPE_CODIGO',0),
	T_VIC('MIG_APC_PROP_CABECERA', 'TIPO_DOCUMENTO', 'DD_TDI_TIPO_DOCUMENTO_ID', 'DD_TDI_CODIGO',0),
	T_VIC('MIG_APC_PROP_CABECERA', 'LOCALIDAD_CONTACTO', 'REMMASTER.DD_LOC_LOCALIDAD', 'DD_LOC_CODIGO',0),
	T_VIC('MIG_APC_PROP_CABECERA', 'PROVINCIA_CONTACTO', 'REMMASTER.DD_PRV_PROVINCIA', 'DD_PRV_CODIGO',0),	
	T_VIC('MIG2_PRO_PROPIETARIOS', 'PRO_COD_CARTERA', 'DD_CRA_CARTERA', 'DD_CRA_CODIGO',0),
	T_VIC('MIG2_PRO_PROPIETARIOS', 'PRO_COD_SUBCARTERA', 'DD_SCR_SUBCARTERA', 'DD_SCR_CODIGO',0),
	T_VIC('MIG_APA_PROP_ACTIVO', 'GRADO_PROPIEDAD', 'DD_TGP_TIPO_GRADO_PROPIEDAD', 'DD_TGP_CODIGO',0),
	T_VIC('MIG2_ACT_PRP','DD_EPA_ID','DD_EPA_ESTADO_PROP_ACTIVO','DD_EPA_CODIGO',0),
	T_VIC('MIG2_GEA_GESTORES_ACTIVOS','GEA_TIPO_GESTOR','REMMASTER.DD_TGE_TIPO_GESTOR','DD_TGE_CODIGO',0),
	T_VIC('MIG2_USU_USUARIOS','USU_CODIGO_PERFIL','REM01.PEF_PERFILES','PEF_CODIGO',0),
	--AGRUPACIONES
	T_VIC('MIG_AAG_AGRUPACIONES', 'TIPO_AGRUPACION', 'DD_TAG_TIPO_AGRUPACION', 'DD_TAG_CODIGO',0),
	T_VIC('MIG_AAG_AGRUPACIONES', 'LOC_AGRUP_OBRA_NUEVA', 'REMMASTER.DD_LOC_LOCALIDAD', 'DD_LOC_CODIGO',0),
	T_VIC('MIG_AAG_AGRUPACIONES', 'PROV_AGRUP_OBRA_NUEVA', 'REMMASTER.DD_PRV_PROVINCIA', 'DD_PRV_CODIGO',0),
	T_VIC('MIG_AAG_AGRUPACIONES', 'ESTADO_AGRUP_OBRA_NUEVA', 'DD_EON_ESTADO_OBRA_NUEVA', 'DD_EON_CODIGO',0),
	T_VIC('MIG_AAG_AGRUPACIONES', 'LOC_AGRUP_LOTE_RESTRINGIDO', 'REMMASTER.DD_LOC_LOCALIDAD', 'DD_LOC_CODIGO',0),
	T_VIC('MIG_AAG_AGRUPACIONES', 'PRO_AGRUP_LOTE_RESTRINGIDO', 'REMMASTER.DD_PRV_PROVINCIA', 'DD_PRV_CODIGO',0)	
	/*
	--Resto de bloques:
	T_VIC('MIG2_CLC_CLIENTE_COMERCIAL', 'CLC_COD_PROVINCIA', 'REMMASTER.DD_PRV_PROVINCIA', 'DD_PRV_CODIGO',0),
	T_VIC('MIG2_VIS_VISITAS', 'VIS_COD_ESTADO_VISITA', 'DD_EVI_ESTADOS_VISITA', 'DD_EVI_CODIGO',0),
	T_VIC('MIG2_VIS_VISITAS', 'VIS_COD_SUBESTADO_VISISTA', 'DD_SVI_SUBESTADOS_VISITA', 'DD_SVI_CODIGO',0),
	T_VIC('MIG2_OFR_OFERTAS', 'SUBSTR(OFR_COD_ESTADO_OFERTA,1,2)', 'DD_EOF_ESTADOS_OFERTA', 'DD_EOF_CODIGO',0),
	T_VIC('MIG2_OFR_OFERTAS', 'OFR_COD_TIPO_OFERTA', 'DD_TOF_TIPOS_OFERTA', 'DD_TOF_CODIGO',0),
	T_VIC('MIG2_OFR_OFERTAS', 'OFR_COD_ESTADO_VISITA_OFR', 'DD_EVO_EST_VISITA_OFERTA', 'DD_EVO_CODIGO',0),
	T_VIC('MIG2_OFR_TIA_TITULARES_ADI', 'OFR_TIA_COD_TIPO_DOC_TITUL_ADI', 'DD_TDI_TIPO_DOCUMENTO_ID', 'DD_TDI_CODIGO',0),
	T_VIC('MIG2_COE_CONDICIONAN_OFR_ACEP', 'COE_COD_TIPO_CALCULO', 'DD_TCC_TIPO_CALCULO', 'DD_TCC_CODIGO',0),
	T_VIC('MIG2_COE_CONDICIONAN_OFR_ACEP', 'COE_COD_TIPO_IMPUESTO', 'DD_TIT_TIPOS_IMPUESTO', 'DD_TIT_CODIGO',0),
	T_VIC('MIG2_COE_CONDICIONAN_OFR_ACEP', 'COE_COD_TIPO_PORCTA_PLUSVALIA', 'DD_TPC_TIPOS_PORCUENTA', 'DD_TPC_CODIGO',0),
	T_VIC('MIG2_COE_CONDICIONAN_OFR_ACEP', 'COE_COD_TIPO_PORCTA_NOTARIA', 'DD_TPC_TIPOS_PORCUENTA', 'DD_TPC_CODIGO',0),
	T_VIC('MIG2_COE_CONDICIONAN_OFR_ACEP', 'COE_COD_TIPO_PORCTA_OTROS', 'DD_TPC_TIPOS_PORCUENTA', 'DD_TPC_CODIGO',0),
	T_VIC('MIG2_COE_CONDICIONAN_OFR_ACEP', 'COE_COD_TIPO_CARGAS_IMPUESTOS', 'DD_TPC_TIPOS_PORCUENTA', 'DD_TPC_CODIGO',0),
	T_VIC('MIG2_COE_CONDICIONAN_OFR_ACEP', 'COE_COD_TIPO_CARGAS_COMUNIDAD', 'DD_TPC_TIPOS_PORCUENTA', 'DD_TPC_CODIGO',0),
	T_VIC('MIG2_COE_CONDICIONAN_OFR_ACEP', 'COE_COD_TIPO_CARGAS_OTROS', 'DD_TPC_TIPOS_PORCUENTA', 'DD_TPC_CODIGO',0),
	T_VIC('MIG2_COE_CONDICIONAN_OFR_ACEP', 'COE_COD_TIPO_LICENCIA', 'DD_TPC_TIPOS_PORCUENTA', 'DD_TPC_CODIGO',0),
	T_VIC('MIG2_COE_CONDICIONAN_OFR_ACEP', 'COE_COD_SITUACION_POSESORIA', 'DD_SIP_SITUACION_POSESORIA', 'DD_SIP_CODIGO',0),
	T_VIC('MIG2_COE_CONDICIONAN_OFR_ACEP', 'COE_COD_ESTADO_TITULO', 'DD_ETI_ESTADO_TITULO', 'DD_ETI_CODIGO',0),
	T_VIC('MIG2_RES_RESERVAS', 'RES_COD_MOTIVO_ANULACION', 'DD_MAR_MOTIVO_ANULACION_RES', 'DD_MAR_CODIGO',0),
	T_VIC('MIG2_RES_RESERVAS', 'RES_COD_TIPO_ARRA', 'DD_TAR_TIPOS_ARRAS', 'DD_TAR_CODIGO',0),
	T_VIC('MIG2_RES_RESERVAS', 'RES_COD_ESTADO_RESERVA', 'DD_ERE_ESTADOS_RESERVA', 'DD_ERE_CODIGO',0),
	T_VIC('MIG2_COM_COMPRADORES', 'COM_COD_TIPO_PERSONA', 'REMMASTER.DD_TPE_TIPO_PERSONA', 'DD_TPE_CODIGO',0),
	T_VIC('MIG2_COM_COMPRADORES', 'COM_COD_TIPO_DOCUMENTO', 'DD_TDI_TIPO_DOCUMENTO_ID', 'DD_TDI_CODIGO',0),
	T_VIC('MIG2_COM_COMPRADORES', 'COM_COD_TIPO_DOC_REPRESENT', 'DD_TDI_TIPO_DOCUMENTO_ID', 'DD_TDI_CODIGO',0),
	T_VIC('MIG2_COM_COMPRADORES', 'COM_COD_TIPO_VIA', 'REMMASTER.DD_TVI_TIPO_VIA', 'DD_TVI_CODIGO',0),
	T_VIC('MIG2_COM_COMPRADORES', 'COM_COD_LOCALIDAD ', 'REMMASTER.DD_LOC_LOCALIDAD', 'DD_LOC_CODIGO',0),
	T_VIC('MIG2_COM_COMPRADORES', 'COM_COD_UNIDADPOBLACIONAL ', 'REMMASTER.DD_UPO_UNID_POBLACIONAL', 'DD_UPO_CODIGO',0),
	T_VIC('MIG2_COM_COMPRADORES', 'COM_COD_PROVINCIA ', 'REMMASTER.DD_PRV_PROVINCIA', 'DD_PRV_CODIGO',0),
	T_VIC('MIG2_CEX_COMPRADOR_EXPEDIENTE', 'CEX_COD_ESTADO_CIVIL ', 'DD_ECV_ESTADOS_CIVILES', 'DD_ECV_CODIGO',0),
	T_VIC('MIG2_CEX_COMPRADOR_EXPEDIENTE', 'CEX_COD_REGIMEN_MATRIMONIAL ', 'DD_REM_REGIMENES_MATRIMONIALES', 'DD_REM_CODIGO',0),
	T_VIC('MIG2_CEX_COMPRADOR_EXPEDIENTE', 'CEX_COD_USO_ACTIVO ', 'DD_UAC_USOS_ACTIVO', 'DD_UAC_CODIGO',0),
	T_VIC('MIG2_CEX_COMPRADOR_EXPEDIENTE', 'CEX_COD_TIPO_DOC_RTE', 'DD_TDI_TIPO_DOCUMENTO_ID', 'DD_TDI_CODIGO',0),
	T_VIC('MIG2_CEX_COMPRADOR_EXPEDIENTE', 'CEX_COD_TIPO_VIA_RTE', 'REMMASTER.DD_TVI_TIPO_VIA', 'DD_TVI_CODIGO',0),
	T_VIC('MIG2_CEX_COMPRADOR_EXPEDIENTE', 'CEX_COD_LOCALIDAD_RTE ', 'REMMASTER.DD_LOC_LOCALIDAD', 'DD_LOC_CODIGO',0),
	T_VIC('MIG2_CEX_COMPRADOR_EXPEDIENTE', 'CEX_COD_UNIDADPOBLACIONAL_RTE ', 'REMMASTER.DD_UPO_UNID_POBLACIONAL', 'DD_UPO_CODIGO',0),
	T_VIC('MIG2_CEX_COMPRADOR_EXPEDIENTE', 'CEX_COD_PROVINCIA_RTE ', 'REMMASTER.DD_PRV_PROVINCIA', 'DD_PRV_CODIGO',0),
	T_VIC('MIG2_CEX_COMPRADOR_EXPEDIENTE', 'CEX_IND_PBC ', 'REM01.DD_EPB_ESTADOS_PBC', 'DD_EPB_CODIGO',0),
	T_VIC('MIG2_GEX_GASTOS_EXPEDIENTE', 'GEX_COD_CONCEPTO_GASTO', 'DD_ACC_ACCION_GASTOS', 'DD_ACC_CODIGO',0),
	T_VIC('MIG2_GEX_GASTOS_EXPEDIENTE', 'GEX_COD_TIPO_CALCULO', 'DD_TCC_TIPO_CALCULO', 'DD_TCC_CODIGO',0),
	T_VIC('MIG2_GEX_GASTOS_EXPEDIENTE', 'GEX_COD_DESTINATARIO', 'DD_DEG_DESTINATARIOS_GASTO', 'DD_DEG_CODIGO',0),
	T_VIC('MIG2_OBF_OBSERVACIONES_OFERTAS', 'OBF_COD_TIPO_OBS', 'DD_TTX_TIPOS_TEXTO_OFERTA', 'DD_TTX_CODIGO',1),
	T_VIC('MIG2_PRD_PROVEEDOR_DIRECCION', 'PRD_COD_TIPO_DIRECCION', 'DD_TDP_TIPO_DIR_PROVEEDOR', 'DD_TDP_CODIGO',1),
	T_VIC('MIG2_PRD_PROVEEDOR_DIRECCION', 'PRD_COD_TIPO_VIA', 'REMMASTER.DD_TVI_TIPO_VIA', 'DD_TVI_CODIGO',0),
	T_VIC('MIG2_PRD_PROVEEDOR_DIRECCION', 'PRD_COD_LOCALIDAD', 'REMMASTER.DD_LOC_LOCALIDAD', 'DD_LOC_CODIGO',0),
	T_VIC('MIG2_PRD_PROVEEDOR_DIRECCION', 'PRD_COD_UNIDADPOBLACIONAL', 'REMMASTER.DD_UPO_UNID_POBLACIONAL', 'DD_UPO_CODIGO',0),
	T_VIC('MIG2_PRD_PROVEEDOR_DIRECCION', 'PRD_COD_PROVINCIA', 'REMMASTER.DD_PRV_PROVINCIA', 'DD_PRV_CODIGO',0),
	T_VIC('MIG2_GPV_GASTOS_PROVEEDORES', 'GPV_COD_TIPO_GASTO', 'DD_TGA_TIPOS_GASTO', 'DD_TGA_CODIGO',0),
	T_VIC('MIG2_GPV_GASTOS_PROVEEDORES', 'GPV_COD_SUBTIPO_GASTO', 'DD_STG_SUBTIPOS_GASTO', 'DD_STG_CODIGO',0),
	T_VIC('MIG2_GPV_GASTOS_PROVEEDORES', 'GPV_COD_PERIODICIDAD', 'DD_TPE_TIPOS_PERIOCIDAD', 'DD_TPE_CODIGO',0),
	T_VIC('MIG2_GPV_GASTOS_PROVEEDORES', 'GPV_COD_DESTINATARIO', 'DD_DEG_DESTINATARIOS_GASTO', 'DD_DEG_CODIGO',0),
	T_VIC('MIG2_GDE_GASTOS_DET_ECONOMICO', 'GDE_COD_TIPO_IMPUESTO', 'DD_TIT_TIPOS_IMPUESTO', 'DD_TIT_CODIGO',0),
	T_VIC('MIG2_GDE_GASTOS_DET_ECONOMICO', 'GDE_COD_TIPO_PAGADOR', 'DD_TPA_TIPOS_PAGADOR', 'DD_TPA_CODIGO',0),
	T_VIC('MIG2_GDE_GASTOS_DET_ECONOMICO', 'GDE_COD_TIPO_PAGO', 'DD_TPP_TIPOS_PAGO', 'DD_TPP_CODIGO',0),
	T_VIC('MIG2_GDE_GASTOS_DET_ECONOMICO', 'GDE_COD_RESP_PAGO_FUERA_PLAZO', 'DD_DEP_DESTINATARIOS_PAGO', 'DD_DEP_CODIGO',0),
	T_VIC('MIG2_GGE_GASTOS_GESTION', 'GGE_COD_MOT_AUTORIZ_PROP', 'DD_MAP_MOT_AUT_PROP_GASTO', 'DD_MAP_CODIGO',0),
	T_VIC('MIG2_GGE_GASTOS_GESTION', 'GGE_COD_EST_AUTORIZ_PROP', 'DD_EAP_ESTADOS_AUTORIZ_PROP', 'DD_EAP_CODIGO',0),
	T_VIC('MIG2_GGE_GASTOS_GESTION', 'GGE_COD_EST_AUTORIZ_HAYA', 'DD_EAH_ESTADOS_AUTORIZ_HAYA', 'DD_EAH_CODIGO',0),
	T_VIC('MIG2_GGE_GASTOS_GESTION', 'GGE_COD_MOT_RECH_AUTORIZ_HAYA', 'DD_MRH_MOTIVOS_RECHAZO_HAYA', 'DD_MRH_CODIGO',0),
	T_VIC('MIG2_GGE_GASTOS_GESTION', 'GGE_COD_MOTIVO_ANULACION_GASTO', 'DD_MAG_MOTIVOS_ANULACION_GASTO', 'DD_MAG_CODIGO',0),
	T_VIC('MIG2_GGE_GASTOS_GESTION', 'GGE_COD_MOTIVO_RETENCION_PAGO', 'DD_MRP_MOTIVOS_RET_PAGO', 'DD_MRP_CODIGO',0),
	T_VIC('MIG2_GIM_GASTOS_IMPUGNACION', 'GIM_COD_RESULTADO_IMPUGNACION', 'DD_RIM_RESULTADOS_IMPUGNACION', 'DD_RIM_CODIGO',0),
	T_VIC('MIG2_GIC_GASTOS_INFO_CONTABI', 'GIC_COD_DESTINA_CONTABILIZA', 'DD_DEP_DESTINATARIOS_PAGO', 'DD_DEP_CODIGO',0),
	T_VIC('MIG2_GIC_GASTOS_INFO_CONTABI', 'GIC_COD_PERIODICIDAD_ESPECIAL', 'DD_TPE_TIPOS_PERIOCIDAD', 'DD_TPE_CODIGO',0),
	T_VIC('MIG2_GPR_PROVISION_GASTOS', 'GPR_COD_ESTADO_PROVISION', 'DD_EPR_ESTADOS_PROVISION_GASTO', 'DD_EPR_CODIGO',1),
	T_VIC('MIG_ATR_TRABAJO', 'ESTADO_TRABAJO', 'DD_EST_ESTADO_TRABAJO', 'DD_EST_CODIGO',0),
	T_VIC('MIG2_PVC_PROVEEDOR_CONTACTO', 'PVC_PROVINCIA', 'REMMASTER.DD_PRV_PROVINCIA', 'DD_PRV_CODIGO',0),
	T_VIC('MIG2_PVE_PROVEEDORES', 'PVE_COD_LOCALIDAD', 'REMMASTER.DD_LOC_LOCALIDAD', 'DD_LOC_CODIGO',0),
	T_VIC('MIG2_PVE_PROVEEDORES', 'PVE_COD_TIPO_PROVEEDOR', 'DD_TPR_TIPO_PROVEEDOR', 'DD_TPR_CODIGO',0),
	T_VIC('MIG2_PVE_PROVEEDORES', 'PVE_COD_TIPO_DOCUMENTO', 'DD_TDI_TIPO_DOCUMENTO_ID', 'DD_TDI_CODIGO',0),
	T_VIC('MIG2_PVE_PROVEEDORES', 'PVE_CON_ZONA_GEOGRAFICA', 'DD_ZNG_ZONA_GEOGRAFICA', 'DD_ZNG_CODIGO',0),
	T_VIC('MIG2_PVE_PROVEEDORES', 'PVE_COD_PROVINCIA', 'REMMASTER.DD_PRV_PROVINCIA', 'DD_PRV_CODIGO',0),
	T_VIC('MIG2_PVE_PROVEEDORES', 'PVE_COD_TIPO_COLABORADOR', 'DD_TPC_TIPOS_COLABORADOR', 'DD_TPC_CODIGO',0),
	T_VIC('MIG2_PVE_PROVEEDORES', 'PVE_COD_TIPO_PERSONA', 'REMMASTER.DD_TPE_TIPO_PERSONA', 'DD_TPE_CODIGO',0),
	T_VIC('MIG2_PVE_PROVEEDORES', 'PVE_COD_ESTADO', 'DD_EPR_ESTADO_PROVEEDOR', 'DD_EPR_CODIGO',0),
	T_VIC('MIG2_PVE_PROVEEDORES', 'PVE_COD_CALIFICACION', 'DD_CPR_CALIFICACION_PROVEEDOR', 'DD_CPR_CODIGO',0),
	T_VIC('MIG2_PVE_PROVEEDORES', 'PVE_COD_MOTIVO_RETENCION', 'DD_MRE_MOTIVO_RETENCION', 'DD_MRE_CODIGO',0),
	T_VIC('MIG2_PVE_PROVEEDORES', 'PVE_COD_RES_PROCESO_BLANQUEO', 'DD_RPB_RES_PROCESO_BLANQUEO', 'DD_RPB_CODIGO',0),
	T_VIC('MIG_AEP_ENTIDAD_PROVEEDOR', 'ENTIDAD_PROPIETARIA', 'DD_CRA_CARTERA', 'DD_CRA_CODIGO',0),
	T_VIC('MIG_AEP_ENTIDAD_PROVEEDOR', 'TIPO_COLABORACION', 'DD_TCL_TIPO_COLABORACION', 'DD_TCL_CODIGO',0),
	T_VIC('MIG_ATR_TRABAJO', 'TIPO_TRABAJO', 'DD_TTR_TIPO_TRABAJO', 'DD_TTR_CODIGO',0),
	T_VIC('MIG_ATR_TRABAJO', 'SUBTIPO_TRABAJO', 'DD_STR_SUBTIPO_TRABAJO', 'DD_STR_CODIGO',0),
	T_VIC('MIG_ATR_TRABAJO', 'TIPO_CALIDAD', 'DD_TCA_TIPO_CALIDAD', 'DD_TCA_CODIGO',0),
	T_VIC('MIG_APT_PRESUPUESTO_TRABAJO', 'ESTADO_PRESUPUESTO', 'DD_ESP_ESTADO_PRESUPUESTO', 'DD_ESP_CODIGO',0),
	T_VIC('MIG2_PVC_PROVEEDOR_CONTACTO', 'PVC_TIPO_DOCUMENTO', 'DD_TDI_TIPO_DOCUMENTO_ID', 'DD_TDI_CODIGO',0),
	T_VIC('MIG2_CLC_CLIENTE_COMERCIAL', 'CLC_COD_TIPO_DOCUMENTO', 'DD_TDI_TIPO_DOCUMENTO_ID', 'DD_TDI_CODIGO',0),
	T_VIC('MIG2_CLC_CLIENTE_COMERCIAL', 'CLC_COD_TIPO_DOC_RTE', 'DD_TDI_TIPO_DOCUMENTO_ID', 'DD_TDI_CODIGO',0),
	T_VIC('MIG2_CLC_CLIENTE_COMERCIAL', 'CLC_COD_TIPO_VIA', 'REMMASTER.DD_TVI_TIPO_VIA', 'DD_TVI_CODIGO',0),
	T_VIC('MIG2_CLC_CLIENTE_COMERCIAL', 'CLC_COD_LOCALIDAD', 'REMMASTER.DD_LOC_LOCALIDAD', 'DD_LOC_CODIGO',0),
	T_VIC('MIG2_CLC_CLIENTE_COMERCIAL', 'CLC_COD_UNIDADPOBLACIONAL', 'REMMASTER.DD_UPO_UNID_POBLACIONAL', 'DD_UPO_CODIGO',0),
	T_VIC('MIG2_CLC_CLIENTE_COMERCIAL','CLC_COD_USUARIO_LDAP_ACCION','REM01.MIG2_USU_USUARIOS','USU_USERNAME',0),
	T_VIC('MIG2_GGE_GASTOS_GESTION','GGE_COD_USUARIO_ANULACION','REM01.MIG2_USU_USUARIOS','USU_USERNAME',0),
	T_VIC('MIG2_GGE_GASTOS_GESTION','GGE_COD_USUARIO_RETENCION_PAGO','REM01.MIG2_USU_USUARIOS','USU_USERNAME',0),
	T_VIC('MIG2_GGE_GASTOS_GESTION','GGE_COD_USUARIO_ALTA','REM01.MIG2_USU_USUARIOS','USU_USERNAME',0),
	T_VIC('MIG2_OFR_OFERTAS','OFR_COD_USUARIO_LDAP_ACCION','REM01.MIG2_USU_USUARIOS','USU_USERNAME',0),
	T_VIC('MIG2_GEO_GESTORES_OFERTAS','GEO_TIPO_GESTOR','REMMASTER.DD_TGE_TIPO_GESTOR','DD_TGE_CODIGO',0),
	T_VIC('MIG2_GEO_GESTORES_OFERTAS','GEO_GESTOR_ACTIVO','REM01.MIG2_USU_USUARIOS','USU_USERNAME',0)
	T_VIC('MIG2_PVC_PROVEEDOR_CONTACTO','PVC_COD_USUARIO','REMMASTER.USU_USUARIOS','USU_USERNAME',0)
	*/
	/*Interfaces excluidas:
	T_VIC('MIG2_AGR_AGRUPACIONES', 'AGR_COD_TIPO_AGRUPACION', 'DD_TAG_TIPO_AGRUPACION', 'DD_TAG_CODIGO',0),
	T_VIC('MIG2_ACT_HVA_HIST_VICORACIONES', 'HVA_COD_TIPO_PRECIO', 'DD_TPC_TIPO_PRECIO', 'DD_TPC_CODIGO',1),
	T_VIC('MIG2_PRP_PROPUESTAS_PRECIOS', 'PRP_COD_ESTADO_PRP', 'DD_EPP_ESTADO_PROP_PRECIO', 'DD_EPP_CODIGO',1),
	T_VIC('MIG2_PRP_PROPUESTAS_PRECIOS', 'PRP_COD_CARTERA', 'DD_CRA_CARTERA', 'DD_CRA_CODIGO',1),
	T_VIC('MIG2_PRP_PROPUESTAS_PRECIOS', 'PRP_COD_TIPO_PRP', 'DD_TPP_TIPO_PROP_PRECIO', 'DD_TPP_CODIGO',1),
	T_VIC('MIG_AIC_IMAGENES_CABECERA', 'TIPO_FOTO', 'DD_TFO_TIPO_FOTO', 'DD_TFO_CODIGO',0),
	T_VIC('MIG_ADA_DOCUMENTOS_ACTIVO', 'TIPO_DOCUMENTO', 'DD_TPD_TIPO_DOCUMENTO', 'DD_TPD_CODIGO',0),
	T_VIC('MIG2_ACQ_ACTIVO_ALQUILER', 'ACQ_COD_ESTADO_CNT_ALQUILER', 'DD_ESC_ESTADO_CNT_ALQUILER', 'DD_ESC_CODIGO',0),
	T_VIC('MIG2_ACQ_ACTIVO_ALQUILER', 'ACQ_COD_TIPO_PORCTA_IBI', 'DD_TPC_TIPOS_PORCUENTA', 'DD_TPC_CODIGO',0),
	T_VIC('MIG2_ACQ_ACTIVO_ALQUILER', 'ACQ_COD_TIPO_PORCTA_COMUNIDAD', 'DD_TPC_TIPOS_PORCUENTA', 'DD_TPC_CODIGO',0),
	T_VIC('MIG2_ACQ_ACTIVO_ALQUILER', 'ACQ_COD_TIPO_PORCTA_SUMINIS', 'DD_TPC_TIPOS_PORCUENTA', 'DD_TPC_CODIGO',0),
	T_VIC('MIG_CPC_PROP_CUOTAS', 'TIPO_CUOTA', 'DD_TPC_TIPO_CUOTA', 'DD_TPC_CODIGO',0),
	T_VIC('MIG2_ACT_HVA_HIST_VICORACIONES','HVA_COD_USUARIO','REM01.MIG2_USU_USUARIOS','USU_USERNAME',0),
	T_VIC('MIG2_SUB_SUBSANACIONES', 'SUB_COD_ESTADO_SUBSANACION', 'DD_ESU_ESTADOS_SUBSANACION', 'DD_ESU_CODIGO',0),
	T_VIC('MIG2_PRP_PROPUESTAS_PRECIOS','PRP_COD_USUARIO','REM01.MIG2_USU_USUARIOS','USU_USERNAME',0),
	T_VIC('MIG_APS_PROVISION_SUPLIDO', 'TIPO_ADELANTO', 'DD_TAD_TIPO_ADELANTO', 'DD_TAD_CODIGO',0),
	T_VIC('MIG2_ACT_HEP_HIST_EST_PUBLI', 'HEP_COD_PORTAL', 'DD_POR_PORTAL', 'DD_POR_CODIGO',0),
	T_VIC('MIG2_ACT_HEP_HIST_EST_PUBLI', 'HEP_COD_TIPO_PUBLICACION', 'DD_TPU_TIPO_PUBLICACION', 'DD_TPU_CODIGO',0),
	T_VIC('MIG2_ACT_HEP_HIST_EST_PUBLI', 'HEP_COD_ESTADO_PUBLI', 'DD_EPU_ESTADO_PUBLICACION', 'DD_EPU_CODIGO',0),
	*/
	);

  V_TMP_VIC T_VIC;

BEGIN

    DBMS_OUTPUT.PUT_LINE('[INICIO] Inicio del proceso');

    V_MSQL := 'SELECT COUNT(1) FROM ALL_TABLES WHERE TABLE_NAME = '''||V_TABLA||''' AND OWNER = '''||V_ESQUEMA||'''';
    EXECUTE IMMEDIATE V_MSQL INTO TABLE_COUNT;

    IF TABLE_COUNT = 1 THEN
        EXECUTE IMMEDIATE 'TRUNCATE TABLE '||V_ESQUEMA||'.'||V_TABLA;
        FOR I IN V_VIC.FIRST .. V_VIC.LAST
            LOOP
                V_TMP_VIC := V_VIC(I);
                V_MSQL := 'SELECT COUNT(1) FROM '||V_ESQUEMA||'.'||V_TABLA||' WHERE NOMBRE_INTERFAZ = '''||V_TMP_VIC(1)||''' AND NOMBRE_CAMPO = '''||V_TMP_VIC(2)||''' AND NOMBRE_DICCIONARIO = '''||V_TMP_VIC(3)||''' ';
                EXECUTE IMMEDIATE V_MSQL INTO V_EXIST;
                
                IF V_EXIST = 1 THEN
                  DBMS_OUTPUT.PUT_LINE('Ya existe la validación: '''||V_TMP_VIC(1)||'''|'''||V_TMP_VIC(2)||'''|'''||V_TMP_VIC(3)||''' ');
                ELSE
                  V_MSQL := 'SELECT '||V_ESQUEMA||'.'||V_SEQUENCIA||'.NEXTVAL FROM DUAL';
                  EXECUTE IMMEDIATE V_MSQL INTO V_SEC;
                
                  DBMS_OUTPUT.PUT_LINE('Insertando la validación: '''||V_TMP_VIC(1)||'''|'''||V_TMP_VIC(2)||'''|'''||V_TMP_VIC(3)||''' con nuevo ID: '||V_SEC);
                  V_MSQL := '
                  INSERT INTO '||V_ESQUEMA||'.'||V_TABLA||' 
                    (VALIDACION_ID, NOMBRE_INTERFAZ, NOMBRE_CAMPO, NOMBRE_DICCIONARIO, NOMBRE_CODIGO, REQUERIDO)
                  VALUES 
                    ('||V_SEC||','''||V_TMP_VIC(1)||''','''||V_TMP_VIC(2)||''','''||V_TMP_VIC(3)||''','''||V_TMP_VIC(4)||''','||V_TMP_VIC(5)||')';
                  EXECUTE IMMEDIATE V_MSQL;
                END IF;
            END LOOP;
        END IF;

        V_TMP_VIC := NULL;

        COMMIT;
        
        DBMS_OUTPUT.PUT_LINE('[FIN] Validaciones Insertadas.');

EXCEPTION
  WHEN OTHERS THEN
    DBMS_OUTPUT.put_line('[ERROR] Se ha producido un error en la ejecución:'||TO_CHAR(SQLCODE));
    DBMS_OUTPUT.put_line('-----------------------------------------------------------');
    DBMS_OUTPUT.put_line(SQLERRM);
    ROLLBACK;
    RAISE;

END;
/
EXIT
