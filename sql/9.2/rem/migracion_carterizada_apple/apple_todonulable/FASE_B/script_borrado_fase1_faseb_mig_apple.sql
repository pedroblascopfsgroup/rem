--BORRADO MIGRACION APPLE FASE I. En Ã©ste orden
DELETE FROM REM01.ACT_APU_ACTIVO_PUBLICACION    WHERE USUARIOCREAR = 'MIG_APPLE';--0
DELETE FROM REM01.ACT_AHP_HIST_PUBLICACION      WHERE USUARIOCREAR = 'MIG_APPLE';--0
DELETE FROM REM01.AIN_ACTIVO_INTEGRADO          WHERE USUARIOCREAR = 'MIG_APPLE';--0
DELETE FROM rem01.ACT_INP_INC_PRESUPUESTO     inc      WHERE EXISTS (SELECT 1 FROM REM01.ACT_PTO_PRESUPUESTO     pto      WHERE EXISTS (SELECT 1 FROM REM01.ACT_ACTIVO ACT WHERE ACT.ACT_ID = pto.ACT_ID AND ACT.USUARIOCREAR = 'MIG_APPLE'));--0

DELETE FROM REM01.ACT_PTO_PRESUPUESTO     pto      WHERE EXISTS (SELECT 1 FROM REM01.ACT_ACTIVO ACT WHERE ACT.ACT_ID = pto.ACT_ID AND ACT.USUARIOCREAR = 'MIG_APPLE');--0
DELETE FROM REM01.GAH_GESTOR_ACTIVO_HISTORICO GAH   WHERE EXISTS (SELECT 1 FROM REM01.ACT_ACTIVO ACT WHERE ACT.ACT_ID = GAH.ACT_ID AND ACT.USUARIOCREAR = 'MIG_APPLE');--0
DELETE FROM REM01.GEH_GESTOR_ENTIDAD_HIST       WHERE USUARIOCREAR = 'MIG_APPLE';--0
DELETE FROM REM01.GAC_GESTOR_ADD_ACTIVO GAC   WHERE EXISTS (SELECT 1 FROM REM01.ACT_ACTIVO ACT WHERE ACT.ACT_ID = GAC.ACT_ID AND ACT.USUARIOCREAR = 'MIG_APPLE');--0
DELETE FROM REM01.GEE_GESTOR_ENTIDAD            WHERE USUARIOCREAR = 'MIG_APPLE';--0
DELETE FROM REM01.ACT_AOB_ACTIVO_OBS            WHERE USUARIOCREAR = 'MIG_APPLE';--0
DELETE FROM REM01.ACT_ABA_ACTIVO_BANCARIO       WHERE USUARIOCREAR = 'MIG_APPLE';--0
DELETE FROM REM01.ACT_PAC_PERIMETRO_ACTIVO      WHERE USUARIOCREAR = 'MIG_APPLE';--0
DELETE FROM REM01.ACT_PRP PRP   WHERE EXISTS (SELECT 1 FROM REM01.ACT_ACTIVO ACT WHERE ACT.ACT_ID = PRP.ACT_ID AND ACT.USUARIOCREAR = 'MIG_APPLE');--0
DELETE FROM REM01.ACT_ADO_ADMISION_DOCUMENTO    WHERE USUARIOCREAR = 'MIG_APPLE';--0
DELETE FROM REM01.ACT_MLV_MOVIMIENTO_LLAVE      WHERE USUARIOCREAR = 'MIG_APPLE';--0
DELETE FROM REM01.ACT_LLV_LLAVE                 WHERE USUARIOCREAR = 'MIG_APPLE';--0
DELETE FROM REM01.ACT_CAT_CATASTRO              WHERE USUARIOCREAR = 'MIG_APPLE';--0
DELETE FROM REM01.ACT_AGO_AGRUPACION_OBS        WHERE USUARIOCREAR = 'MIG_APPLE';--0
DELETE FROM REM01.ACT_AGA_AGRUPACION_ACTIVO     WHERE USUARIOCREAR = 'MIG_APPLE';--0
DELETE FROM REM01.ACT_ASI_ASISTIDA ASI   WHERE EXISTS (SELECT 1 FROM REM01.ACT_AGA_AGRUPACION_ACTIVO ACT WHERE ACT.AGR_ID = ASI.AGR_ID AND ACT.USUARIOCREAR = 'MIG_APPLE');--0
DELETE FROM REM01.ACT_LCO_LOTE_COMERCIAL LCO  WHERE EXISTS (SELECT 1 FROM REM01.ACT_AGA_AGRUPACION_ACTIVO ACT WHERE ACT.AGR_ID = LCO.AGR_ID AND ACT.USUARIOCREAR = 'MIG_APPLE');--0
DELETE FROM REM01.ACT_ONV_OBRA_NUEVA  ONV  WHERE EXISTS (SELECT 1 FROM REM01.ACT_AGA_AGRUPACION_ACTIVO ACT WHERE ACT.AGR_ID = ONV.AGR_ID AND ACT.USUARIOCREAR = 'MIG_APPLE');--0
DELETE FROM REM01.ACT_RES_RESTRINGIDA  RES  WHERE EXISTS (SELECT 1 FROM REM01.ACT_AGA_AGRUPACION_ACTIVO ACT WHERE ACT.AGR_ID = RES.AGR_ID AND ACT.USUARIOCREAR = 'MIG_APPLE');--0
DELETE FROM REM01.ACT_AGR_AGRUPACION      agr      WHERE EXISTS (SELECT 1 FROM REM01.ACT_AGA_AGRUPACION_ACTIVO ACT WHERE ACT.AGR_ID = agr.AGR_ID AND ACT.USUARIOCREAR = 'MIG_APPLE');--0
DELETE FROM REM01.ACT_DIS_DISTRIBUCION          WHERE USUARIOCREAR = 'MIG_APPLE';--0
DELETE FROM REM01.ACT_APR_PLAZA_APARCAMIENTO  APR  WHERE EXISTS (SELECT 1 FROM REM01.ACT_ICO_INFO_COMERCIAL ACT WHERE ACT.ICO_ID = APR.ICO_ID AND ACT.USUARIOCREAR = 'MIG_APPLE');--0
DELETE FROM REM01.ACT_LCO_LOCAL_COMERCIAL  LCO  WHERE EXISTS (SELECT 1 FROM REM01.ACT_ICO_INFO_COMERCIAL ACT WHERE ACT.ICO_ID = LCO.ICO_ID AND ACT.USUARIOCREAR = 'MIG_APPLE');--0
DELETE FROM REM01.act_cri_carpinteria_int  APR  WHERE EXISTS (SELECT 1 FROM REM01.ACT_ICO_INFO_COMERCIAL ACT WHERE ACT.ICO_ID = APR.ICO_ID AND ACT.USUARIOCREAR = 'MIG_APPLE');--0
DELETE FROM REM01.act_cre_carpinteria_ext  APR  WHERE EXISTS (SELECT 1 FROM REM01.ACT_ICO_INFO_COMERCIAL ACT WHERE ACT.ICO_ID = APR.ICO_ID AND ACT.USUARIOCREAR = 'MIG_APPLE');--0

DELETE FROM REM01.ACT_VIV_VIVIENDA  VIV  WHERE EXISTS (SELECT 1 FROM REM01.ACT_ICO_INFO_COMERCIAL ACT WHERE ACT.ICO_ID = VIV.ICO_ID AND ACT.USUARIOCREAR = 'MIG_APPLE');--0
DELETE FROM REM01.ACT_EDI_EDIFICIO  EDI  WHERE EXISTS (SELECT 1 FROM REM01.ACT_ICO_INFO_COMERCIAL ACT WHERE ACT.ICO_ID = EDI.ICO_ID AND ACT.USUARIOCREAR = 'MIG_APPLE');--0
DELETE FROM rem01.ACT_PRV_PARAMENTO_VERTICAL  EDI  WHERE EXISTS (SELECT 1 FROM REM01.ACT_ICO_INFO_COMERCIAL ACT WHERE ACT.ICO_ID = EDI.ICO_ID AND ACT.USUARIOCREAR = 'MIG_APPLE');--0
DELETE FROM rem01.act_sol_solado  EDI  WHERE EXISTS (SELECT 1 FROM REM01.ACT_ICO_INFO_COMERCIAL ACT WHERE ACT.ICO_ID = EDI.ICO_ID AND ACT.USUARIOCREAR = 'MIG_APPLE');--0
DELETE FROM rem01.act_coc_cocina  EDI  WHERE EXISTS (SELECT 1 FROM REM01.ACT_ICO_INFO_COMERCIAL ACT WHERE ACT.ICO_ID = EDI.ICO_ID AND ACT.USUARIOCREAR = 'MIG_APPLE');--0
DELETE FROM rem01.ACT_BNY_BANYO  EDI  WHERE EXISTS (SELECT 1 FROM REM01.ACT_ICO_INFO_COMERCIAL ACT WHERE ACT.ICO_ID = EDI.ICO_ID AND ACT.USUARIOCREAR = 'MIG_APPLE');--0
DELETE FROM rem01.ACT_INS_INSTALACION  EDI  WHERE EXISTS (SELECT 1 FROM REM01.ACT_ICO_INFO_COMERCIAL ACT WHERE ACT.ICO_ID = EDI.ICO_ID AND ACT.USUARIOCREAR = 'MIG_APPLE');--0
DELETE FROM rem01.ACT_ZCO_ZONA_COMUN  EDI  WHERE EXISTS (SELECT 1 FROM REM01.ACT_ICO_INFO_COMERCIAL ACT WHERE ACT.ICO_ID = EDI.ICO_ID AND ACT.USUARIOCREAR = 'MIG_APPLE');--0
DELETE FROM rem01.ACT_INF_INFRAESTRUCTURA  EDI  WHERE EXISTS (SELECT 1 FROM REM01.ACT_ICO_INFO_COMERCIAL ACT WHERE ACT.ICO_ID = EDI.ICO_ID AND ACT.USUARIOCREAR = 'MIG_APPLE');--0
DELETE FROM REM01.ACT_HIC_EST_INF_COMER_HIST    WHERE USUARIOCREAR = 'MIG_APPLE';--0
DELETE FROM REM01.ACT_ICO_INFO_COMERCIAL        WHERE USUARIOCREAR = 'MIG_APPLE';--0
DELETE FROM REM01.ACT_PAC_PROPIETARIO_ACTIVO    WHERE USUARIOCREAR = 'MIG_APPLE';--0
DELETE FROM REM01.ACT_PRO_PROPIETARIO           WHERE USUARIOCREAR = 'MIG_APPLE';--0
DELETE FROM REM01.ACT_TAS_TASACION              WHERE USUARIOCREAR = 'MIG_APPLE';--0
DELETE FROM REM01.BIE_VALORACIONES              WHERE USUARIOCREAR = 'MIG_APPLE';--0
DELETE FROM REM01.ACT_CRG_CARGAS                WHERE USUARIOCREAR = 'MIG_APPLE';--0
DELETE FROM REM01.BIE_CAR_CARGAS                WHERE USUARIOCREAR = 'MIG_APPLE';--0
DELETE FROM REM01.ACT_ADN_ADJNOJUDICIAL         WHERE USUARIOCREAR = 'MIG_APPLE';--0
DELETE FROM REM01.ACT_AJD_ADJJUDICIAL           WHERE USUARIOCREAR = 'MIG_APPLE';--0
DELETE FROM REM01.ACT_PDV_PLAN_DIN_VENTAS       WHERE USUARIOCREAR = 'MIG_APPLE';--0
DELETE FROM REM01.ACT_VAL_VALORACIONES          WHERE USUARIOCREAR = 'MIG_APPLE';--0
DELETE FROM REM01.ACT_TIT_TITULO                WHERE USUARIOCREAR = 'MIG_APPLE';--0
DELETE FROM REM01.ACT_LOC_LOCALIZACION          WHERE USUARIOCREAR = 'MIG_APPLE';--0
DELETE FROM REM01.BIE_LOCALIZACION              WHERE USUARIOCREAR = 'MIG_APPLE';--0
DELETE FROM REM01.ACT_REG_INFO_REGISTRAL        WHERE USUARIOCREAR = 'MIG_APPLE';--0
DELETE FROM REM01.BIE_DATOS_REGISTRALES         WHERE USUARIOCREAR = 'MIG_APPLE';--0
DELETE FROM REM01.ACT_SPS_SIT_POSESORIA         WHERE USUARIOCREAR = 'MIG_APPLE';--0
DELETE FROM REM01.ACT_ADM_INF_ADMINISTRATIVA    WHERE USUARIOCREAR = 'MIG_APPLE';--0
DELETE FROM REM01.BIE_ADJ_ADJUDICACION          WHERE USUARIOCREAR = 'MIG_APPLE';--0
DELETE FROM REM01.BIE_BIEN                      WHERE USUARIOCREAR = 'MIG_APPLE';--0
DELETE FROM REM01.ACT_HVA_HIST_VALORACIONES             gac      WHERE EXISTS (SELECT 1 FROM REM01.ACT_ACTIVO ACT WHERE ACT.ACT_ID = GAC.ACT_ID AND ACT.USUARIOCREAR = 'MIG_APPLE');--0


----
--[INICIO] FKs ACTIVO
----
DELETE FROM REM01.ACT_HVA_HIST_VALORACIONES             gac      WHERE EXISTS (
SELECT 1 FROM REM01.ACT_ACTIVO ACT WHERE ACT.ACT_ID = GAC.ACT_ID AND ACT.USUARIOCREAR = 'MIG_APPLE');--0

DELETE FROM REM01.ACT_ADA_ADJUNTO_ACTIVO             gac      WHERE EXISTS (
SELECT 1 FROM REM01.ACT_ACTIVO ACT WHERE ACT.ACT_ID = GAC.ACT_ID AND ACT.USUARIOCREAR = 'MIG_APPLE');--0

DELETE FROM REM01.ACT_PTA_PATRIMONIO_ACTIVO             gac      WHERE EXISTS (
SELECT 1 FROM REM01.ACT_ACTIVO ACT WHERE ACT.ACT_ID = GAC.ACT_ID AND ACT.USUARIOCREAR = 'MIG_APPLE');--0

DELETE FROM REM01.ACT_OFR             gac      WHERE EXISTS (
SELECT 1 FROM REM01.ACT_ACTIVO ACT WHERE ACT.ACT_ID = GAC.ACT_ID AND ACT.USUARIOCREAR = 'MIG_APPLE');--0

DELETE FROM REM01.ACT_TBJ             gac      WHERE EXISTS (
SELECT 1 FROM REM01.ACT_ACTIVO ACT WHERE ACT.ACT_ID = GAC.ACT_ID AND ACT.USUARIOCREAR = 'MIG_APPLE');--0

DELETE FROM REM01.TAC_TAREAS_ACTIVOS             gac      WHERE EXISTS (
SELECT 1 FROM REM01.ACT_ACTIVO ACT WHERE ACT.ACT_ID = GAC.ACT_ID AND ACT.USUARIOCREAR = 'MIG_APPLE');--0

DELETE FROM REM01.ACT_VAL_VALORACIONES             gac      WHERE EXISTS (
SELECT 1 FROM REM01.ACT_ACTIVO ACT WHERE ACT.ACT_ID = GAC.ACT_ID AND ACT.USUARIOCREAR = 'MIG_APPLE');--0

DELETE FROM REM01.HDC_HIST_DESTINO_COMERCIAL             gac      WHERE EXISTS (
SELECT 1 FROM REM01.ACT_ACTIVO ACT WHERE ACT.ACT_ID = GAC.ACT_ID AND ACT.USUARIOCREAR = 'MIG_APPLE');--0

DELETE FROM REM01.ACT_ILB_NFO_LIBERBANK             gac      WHERE EXISTS (
SELECT 1 FROM REM01.ACT_ACTIVO ACT WHERE ACT.ACT_ID = GAC.ACT_ID AND ACT.USUARIOCREAR = 'MIG_APPLE');--0

DELETE FROM REM01.ACT_AOB_ACTIVO_OBS             gac      WHERE EXISTS (
SELECT 1 FROM REM01.ACT_ACTIVO ACT WHERE ACT.ACT_ID = GAC.ACT_ID AND ACT.USUARIOCREAR = 'MIG_APPLE');--0


/*DELETE FROM ACT_ACTIVO T1 WHERE EXISTS (
SELECT 1 FROM ACT_ACTIVO T2 WHERE T1.ACT_ID = T2.ACT_ID AND T2.USUARIOCREAR = 'MIG_APPLE'
);
EN VEZ DE BORRARLOS (MUY COSTOSO) BORRAMOS LOGICO LOS ACTIVOS*/
MERGE INTO REM01.ACT_ACTIVO T1
USING (
SELECT ACT_ID, ACT_NUM_ACTIVO
FROM REM01.ACT_ACTIVO 
WHERE USUARIOCREAR = 'MIG_APPLE'
) T2
ON (T1.ACT_ID = T2.ACT_ID)
WHEN MATCHED THEN UPDATE SET
   T1.USUARIOCREAR = 'MIG_APPLE_BORRADOS',
   T1.BORRADO = 1,
   T1.ACT_NUM_ACTIVO = TO_NUMBER('-'||T2.ACT_NUM_ACTIVO)
;
----
--[FIN] FKs ACTIVO
----

DELETE FROM REM01.ACT_CPR_COM_PROPIETARIOS      WHERE USUARIOCREAR = 'MIG_APPLE';--0
DELETE FROM REM01.USD_USUARIOS_DESPACHOS        WHERE USUARIOCREAR = 'MIG_APPLE';--0
DELETE FROM REM01.ZON_PEF_USU                   WHERE USUARIOCREAR = 'MIG_APPLE';--0
DELETE FROM REMMASTER.GRU_GRUPOS_USUARIOS 		WHERE USUARIOCREAR = 'MIG_APPLE';--0
DELETE FROM REMMASTER.USU_USUARIOS        		WHERE USUARIOCREAR = 'MIG_APPLE';--0
