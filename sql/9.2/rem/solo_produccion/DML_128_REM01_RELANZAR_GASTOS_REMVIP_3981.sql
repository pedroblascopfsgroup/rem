--/*
--#########################################
--## AUTOR=Oscar Diestre
--## FECHA_CREACION=20190411
--## ARTEFACTO=batch
--## VERSION_ARTEFACTO=9.2
--## INCIDENCIA_LINK=REMVIP-3981
--## PRODUCTO=NO
--## 
--## Finalidad: Relanzar gastos
--## INSTRUCCIONES:  
--## VERSIONES:
--##        0.1 Versión inicial
--#########################################
--*/
--Para permitir la visualización de texto en un bloque PL/SQL utilizando DBMS_OUTPUT.PUT_LINE
WHENEVER SQLERROR EXIT SQL.SQLCODE;
SET SERVEROUTPUT ON;
SET DEFINE OFF;

DECLARE

	V_USUARIO VARCHAR2(50 CHAR) := 'REMVIP-3981';

	V_ESQUEMA VARCHAR2(25 CHAR):= '#ESQUEMA#';-- '#ESQUEMA#'; -- Configuracion Esquema
	V_ESQUEMA_M VARCHAR2(25 CHAR):= '#ESQUEMA_MASTER#';-- '#ESQUEMA_MASTER#'; -- Configuracion Esquema Master
	ERR_NUM NUMBER;-- Numero de errores
	ERR_MSG VARCHAR2(2048);-- Mensaje de error
	V_SQL VARCHAR2(4000 CHAR);

	V_GPV_ID VARCHAR(50 CHAR); -- Vble. que almacena el id del gasto.
	
	V_EXISTE_GASTO NUMBER(16); -- Vble. para almacenar el resultado de la busqueda.



    TYPE T_GASTO IS TABLE OF VARCHAR2(1000);

    TYPE T_ARRAY_GASTOS IS TABLE OF T_GASTO;
    V_GASTOS T_ARRAY_GASTOS := T_ARRAY_GASTOS(
		 
                --NUMERO GASTO
                         T_GASTO('9472005'),
                         T_GASTO('9472006'),
                         T_GASTO('9472921'),
                         T_GASTO('9479712'),
                         T_GASTO('9453766'),
                         T_GASTO('9462096'),
                         T_GASTO('9462341'),
                         T_GASTO('9462344'),
                         T_GASTO('9462697'),
                         T_GASTO('9462705'),
                         T_GASTO('9497379'),
                         T_GASTO('9583787'),
                         T_GASTO('9605748'),
                         T_GASTO('9606290'),
                         T_GASTO('9606291'),
                         T_GASTO('9676602'),
                         T_GASTO('9736091'),
                         T_GASTO('9736094'),
                         T_GASTO('9736100'),
                         T_GASTO('9736138'),
                         T_GASTO('9736844'),
                         T_GASTO('10034229'),
                         T_GASTO('10217280'),
                         T_GASTO('10217281'),
                         T_GASTO('10217286'),
                         T_GASTO('10217287'),
                         T_GASTO('10217288'),
                         T_GASTO('10217289'),
                         T_GASTO('10217290'),
                         T_GASTO('10217291'),
                         T_GASTO('10217292'),
                         T_GASTO('10217293'),
                         T_GASTO('10217294'),
                         T_GASTO('10217296'),
                         T_GASTO('10217297'),
                         T_GASTO('10217299'),
                         T_GASTO('10217300'),
                         T_GASTO('10217301'),
                         T_GASTO('10217302'),
                         T_GASTO('10217303'),
                         T_GASTO('10217304'),
                         T_GASTO('10217305'),
                         T_GASTO('10217306'),
                         T_GASTO('10217307'),
                         T_GASTO('10217308'),
                         T_GASTO('10217309'),
                         T_GASTO('10217310'),
                         T_GASTO('10217312'),
                         T_GASTO('10217313'),
                         T_GASTO('10217314'),
                         T_GASTO('10217315'),
                         T_GASTO('10217316'),
                         T_GASTO('10217800'),
                         T_GASTO('10217827'),
                         T_GASTO('10217829'),
                         T_GASTO('10217835'),
                         T_GASTO('10217889'),
                         T_GASTO('10217894'),
                         T_GASTO('10217895'),
                         T_GASTO('10217897'),
                         T_GASTO('10217900'),
                         T_GASTO('10217902'),
                         T_GASTO('10217903'),
                         T_GASTO('10217904'),
                         T_GASTO('10217905'),
                         T_GASTO('10217907'),
                         T_GASTO('10217909'),
                         T_GASTO('10217910'),
                         T_GASTO('10227138'),
                         T_GASTO('10465002'),
                         T_GASTO('10465003'),
                         T_GASTO('10465004'),
                         T_GASTO('10465005'),
                         T_GASTO('10465006'),
                         T_GASTO('10465007'),
                         T_GASTO('10465008'),
                         T_GASTO('10465009'),
                         T_GASTO('10465010'),
                         T_GASTO('10465011'),
                         T_GASTO('10465012'),
                         T_GASTO('10465013'),
                         T_GASTO('10465014'),
                         T_GASTO('10465015'),
                         T_GASTO('10465016'),
                         T_GASTO('10465017'),
                         T_GASTO('10465033'),
                         T_GASTO('10465042'),
                         T_GASTO('10465043'),
                         T_GASTO('10465044'),
                         T_GASTO('10465045'),
                         T_GASTO('10465046'),
                         T_GASTO('10465047'),
                         T_GASTO('10465048'),
                         T_GASTO('10465049'),
                         T_GASTO('10465050'),
                         T_GASTO('10465426'),
                         T_GASTO('10465427'),
                         T_GASTO('10465428'),
                         T_GASTO('10465429'),
                         T_GASTO('10465430'),
                         T_GASTO('10465431'),
                         T_GASTO('10465432'),
                         T_GASTO('10465433'),
                         T_GASTO('10465434'),
                         T_GASTO('10455421'),
                         T_GASTO('10455422'),
                         T_GASTO('10455423'),
                         T_GASTO('10455424'),
                         T_GASTO('10455477'),
                         T_GASTO('10455478'),
                         T_GASTO('10455479'),
                         T_GASTO('10455480'),
                         T_GASTO('10455743'),
                         T_GASTO('10455744'),
                         T_GASTO('10455745'),
                         T_GASTO('10455746'),
                         T_GASTO('10455849'),
                         T_GASTO('10455850'),
                         T_GASTO('10455851'),
                         T_GASTO('10455859'),
                         T_GASTO('10455860'),
                         T_GASTO('10455861'),
                         T_GASTO('10455862'),
                         T_GASTO('10455863'),
                         T_GASTO('10455864'),
                         T_GASTO('10455865'),
                         T_GASTO('10455866'),
                         T_GASTO('10455867'),
                         T_GASTO('10455874'),
                         T_GASTO('10455875'),
                         T_GASTO('10455876'),
                         T_GASTO('10455883'),
                         T_GASTO('10455884'),
                         T_GASTO('10455885'),
                         T_GASTO('10455888'),
                         T_GASTO('10455889'),
                         T_GASTO('10455890'),
                         T_GASTO('10455895'),
                         T_GASTO('10455896'),
                         T_GASTO('10455897'),
                         T_GASTO('10455898'),
                         T_GASTO('10455899'),
                         T_GASTO('10455942'),
                         T_GASTO('10455943'),
                         T_GASTO('10455944'),
                         T_GASTO('10456018'),
                         T_GASTO('10456019'),
                         T_GASTO('10456020'),
                         T_GASTO('10456040'),
                         T_GASTO('10456041'),
                         T_GASTO('10456042'),
                         T_GASTO('10456043'),
                         T_GASTO('10456060'),
                         T_GASTO('10456061'),
                         T_GASTO('10456062'),
                         T_GASTO('10456063'),
                         T_GASTO('10456064'),
                         T_GASTO('10456065'),
                         T_GASTO('10456083'),
                         T_GASTO('10456084'),
                         T_GASTO('10456085'),
                         T_GASTO('10456086'),
                         T_GASTO('10456087'),
                         T_GASTO('10456088'),
                         T_GASTO('10456089'),
                         T_GASTO('10456090'),
                         T_GASTO('10456091'),
                         T_GASTO('10456092'),
                         T_GASTO('10456093'),
                         T_GASTO('10456094'),
                         T_GASTO('10456095'),
                         T_GASTO('10456096'),
                         T_GASTO('10456097'),
                         T_GASTO('10456098'),
                         T_GASTO('10456099'),
                         T_GASTO('10456100'),
                         T_GASTO('10456101'),
                         T_GASTO('10456102'),
                         T_GASTO('10456103'),
                         T_GASTO('10456104'),
                         T_GASTO('10424133'),
                         T_GASTO('10424134'),
                         T_GASTO('10424135'),
                         T_GASTO('10424136'),
                         T_GASTO('10424137'),
                         T_GASTO('10424138'),
                         T_GASTO('10424139'),
                         T_GASTO('10424140'),
                         T_GASTO('10424141'),
                         T_GASTO('10424142'),
                         T_GASTO('10424150'),
                         T_GASTO('10424151'),
                         T_GASTO('10424152'),
                         T_GASTO('10424153'),
                         T_GASTO('10424156'),
                         T_GASTO('10424157'),
                         T_GASTO('10424170'),
                         T_GASTO('10424174'),
                         T_GASTO('10424178'),
                         T_GASTO('10424179'),
                         T_GASTO('10424181'),
                         T_GASTO('10424184'),
                         T_GASTO('10424191'),
                         T_GASTO('10424199'),
                         T_GASTO('10424531'),
                         T_GASTO('10424533'),
                         T_GASTO('10424570'),
                         T_GASTO('10416317'),
                         T_GASTO('10279498'),
                         T_GASTO('10279510'),
                         T_GASTO('10339419'),
                         T_GASTO('10402521'),
                         T_GASTO('10402522'),
                         T_GASTO('10402523'),
                         T_GASTO('10286154'),
                         T_GASTO('10340319'),
                         T_GASTO('10264562'),
                         T_GASTO('10264632'),
                         T_GASTO('10264633'),
                         T_GASTO('10264635'),
                         T_GASTO('10264636'),
                         T_GASTO('10343539'),
                         T_GASTO('10291000'),
                         T_GASTO('10419325'),
                         T_GASTO('10419327'),
                         T_GASTO('10419328'),
                         T_GASTO('10419330'),
                         T_GASTO('10330876'),
                         T_GASTO('10436635'),
                         T_GASTO('10436714'),
                         T_GASTO('10436715'),
                         T_GASTO('10436716'),
                         T_GASTO('10466230'),
                         T_GASTO('10466231'),
                         T_GASTO('10466232'),
                         T_GASTO('10466233'),
                         T_GASTO('10466234'),
                         T_GASTO('10466235'),
                         T_GASTO('10466236'),
                         T_GASTO('10466237'),
                         T_GASTO('10466238'),
                         T_GASTO('10466239'),
                         T_GASTO('10466240'),
                         T_GASTO('10466241'),
                         T_GASTO('10466322'),
                         T_GASTO('10466323'),
                         T_GASTO('10466324'),
                         T_GASTO('10466325'),
                         T_GASTO('10466326'),
                         T_GASTO('10466327'),
                         T_GASTO('10466328'),
                         T_GASTO('10466329'),
                         T_GASTO('10466330'),
                         T_GASTO('10466331'),
                         T_GASTO('10466332'),
                         T_GASTO('10466333'),
                         T_GASTO('10466334'),
                         T_GASTO('10466335'),
                         T_GASTO('10466336'),
                         T_GASTO('10466337'),
                         T_GASTO('10466338'),
                         T_GASTO('10466339'),
                         T_GASTO('10466340'),
                         T_GASTO('10466341'),
                         T_GASTO('10466342'),
                         T_GASTO('10466343'),
                         T_GASTO('10466344'),
                         T_GASTO('10466345'),
                         T_GASTO('10465916'),
                         T_GASTO('10465920'),
                         T_GASTO('10465921'),
                         T_GASTO('10465922'),
                         T_GASTO('10465923'),
                         T_GASTO('10465924'),
                         T_GASTO('10465925'),
                         T_GASTO('10465926'),
                         T_GASTO('10465927'),
                         T_GASTO('10465928'),
                         T_GASTO('10465929'),
                         T_GASTO('10465930'),
                         T_GASTO('10465931'),
                         T_GASTO('10465934'),
                         T_GASTO('10465935'),
                         T_GASTO('10465936'),
                         T_GASTO('10465937'),
                         T_GASTO('10465938'),
                         T_GASTO('10465939'),
                         T_GASTO('10465940'),
                         T_GASTO('10465941'),
                         T_GASTO('10465942'),
                         T_GASTO('10465943'),
                         T_GASTO('10465944'),
                         T_GASTO('10465945'),
                         T_GASTO('10465950'),
                         T_GASTO('10465952'),
                         T_GASTO('10465953'),
                         T_GASTO('10465954'),
                         T_GASTO('10465956'),
                         T_GASTO('10465958'),
                         T_GASTO('10465959'),
                         T_GASTO('10465960'),
                         T_GASTO('10465961'),
                         T_GASTO('10465962'),
                         T_GASTO('10465963'),
                         T_GASTO('10465964'),
                         T_GASTO('10465975'),
                         T_GASTO('10465983'),
                         T_GASTO('10465990'),
                         T_GASTO('10465994'),
                         T_GASTO('10465996'),
                         T_GASTO('10465997'),
                         T_GASTO('10465998'),
                         T_GASTO('10465999'),
                         T_GASTO('10466000'),
                         T_GASTO('10466002'),
                         T_GASTO('10466003'),
                         T_GASTO('10466004'),
                         T_GASTO('10465893'),
                         T_GASTO('10465895'),
                         T_GASTO('10465897'),
                         T_GASTO('10465898'),
                         T_GASTO('10465901'),
                         T_GASTO('10431826'),
                         T_GASTO('10431835'),
                         T_GASTO('10413610'),
                         T_GASTO('10413613'),
                         T_GASTO('10422811'),
                         T_GASTO('10422813'),
                         T_GASTO('10422814'),
                         T_GASTO('10422816'),
                         T_GASTO('10422817'),
                         T_GASTO('10422818'),
                         T_GASTO('10422820'),
                         T_GASTO('10422821'),
                         T_GASTO('10422822'),
                         T_GASTO('10422824'),
                         T_GASTO('10422825'),
                         T_GASTO('10422826'),
                         T_GASTO('10422828'),
                         T_GASTO('10422829'),
                         T_GASTO('10422830'),
                         T_GASTO('10422832'),
                         T_GASTO('10422834'),
                         T_GASTO('10422836'),
                         T_GASTO('10422837'),
                         T_GASTO('10422838'),
                         T_GASTO('10422840'),
                         T_GASTO('10422842'),
                         T_GASTO('10422844'),
                         T_GASTO('10422845'),
                         T_GASTO('10422846'),
                         T_GASTO('10422848'),
                         T_GASTO('10422849'),
                         T_GASTO('10422850'),
                         T_GASTO('10422852'),
                         T_GASTO('10422853'),
                         T_GASTO('10422855'),
                         T_GASTO('10466388'),
                         T_GASTO('10466389'),
                         T_GASTO('10466390'),
                         T_GASTO('10466391'),
                         T_GASTO('10448231'),
                         T_GASTO('10292033'),
                         T_GASTO('10292034'),
                         T_GASTO('10291047'),
                         T_GASTO('10344286'),
                         T_GASTO('10468816'),
                         T_GASTO('10468818'),
                         T_GASTO('10468030'),
                         T_GASTO('10468031'),
                         T_GASTO('10468032'),
                         T_GASTO('10468033'),
                         T_GASTO('10468034'),
                         T_GASTO('10468035'),
                         T_GASTO('10468036'),
                         T_GASTO('10468037'),
                         T_GASTO('10468038'),
                         T_GASTO('10468039'),
                         T_GASTO('10468040'),
                         T_GASTO('10468041'),
                         T_GASTO('10468042'),
                         T_GASTO('10468043'),
                         T_GASTO('10468044'),
                         T_GASTO('10468045'),
                         T_GASTO('10468046'),
                         T_GASTO('10468047'),
                         T_GASTO('10468050'),
                         T_GASTO('10468052'),
                         T_GASTO('10468053'),
                         T_GASTO('10468054'),
                         T_GASTO('10468055'),
                         T_GASTO('10468056'),
                         T_GASTO('10468057'),
                         T_GASTO('10468058'),
                         T_GASTO('10468060'),
                         T_GASTO('10468061'),
                         T_GASTO('10468062'),
                         T_GASTO('10468063'),
                         T_GASTO('10468064'),
                         T_GASTO('10468065'),
                         T_GASTO('10468066'),
                         T_GASTO('10468067'),
                         T_GASTO('10468068'),
                         T_GASTO('10468069'),
                         T_GASTO('10468070'),
                         T_GASTO('10468071'),
                         T_GASTO('10468072'),
                         T_GASTO('10468074'),
                         T_GASTO('10468075'),
                         T_GASTO('10468076'),
                         T_GASTO('10468077'),
                         T_GASTO('10468078'),
                         T_GASTO('10468081'),
                         T_GASTO('10468082'),
                         T_GASTO('10468083'),
                         T_GASTO('10468084'),
                         T_GASTO('10468086'),
                         T_GASTO('10468088'),
                         T_GASTO('10468089'),
                         T_GASTO('10468090'),
                         T_GASTO('10468091'),
                         T_GASTO('10468093'),
                         T_GASTO('10468096'),
                         T_GASTO('10468097'),
                         T_GASTO('10468098'),
                         T_GASTO('10468099'),
                         T_GASTO('10468100'),
                         T_GASTO('10468101'),
                         T_GASTO('10468102'),
                         T_GASTO('10468103'),
                         T_GASTO('10468104'),
                         T_GASTO('10468105'),
                         T_GASTO('10468106'),
                         T_GASTO('10468107'),
                         T_GASTO('10468108'),
                         T_GASTO('10468109'),
                         T_GASTO('10468110'),
                         T_GASTO('10468111'),
                         T_GASTO('10468112'),
                         T_GASTO('10468113'),
                         T_GASTO('10468114'),
                         T_GASTO('10468115'),
                         T_GASTO('10468116'),
                         T_GASTO('10468117'),
                         T_GASTO('10468118'),
                         T_GASTO('10468119'),
                         T_GASTO('10468120'),
                         T_GASTO('10468121'),
                         T_GASTO('10468122'),
                         T_GASTO('10468123'),
                         T_GASTO('10468124'),
                         T_GASTO('10468125'),
                         T_GASTO('10468126'),
                         T_GASTO('10468127'),
                         T_GASTO('10468128'),
                         T_GASTO('10468129'),
                         T_GASTO('10468130'),
                         T_GASTO('10468131'),
                         T_GASTO('10468132'),
                         T_GASTO('10468133'),
                         T_GASTO('10468134'),
                         T_GASTO('10468135'),
                         T_GASTO('10468136'),
                         T_GASTO('10468137'),
                         T_GASTO('10468138'),
                         T_GASTO('10468139'),
                         T_GASTO('10468140'),
                         T_GASTO('10468141'),
                         T_GASTO('10468142'),
                         T_GASTO('10468143'),
                         T_GASTO('10468144'),
                         T_GASTO('10468145'),
                         T_GASTO('10468146'),
                         T_GASTO('10468147'),
                         T_GASTO('10468148'),
                         T_GASTO('10468149'),
                         T_GASTO('10468151'),
                         T_GASTO('10468152'),
                         T_GASTO('10468153'),
                         T_GASTO('10468154'),
                         T_GASTO('10468155'),
                         T_GASTO('10468156'),
                         T_GASTO('10468157'),
                         T_GASTO('10468158'),
                         T_GASTO('10468514'),
                         T_GASTO('10373741'),
                         T_GASTO('10373886'),
                         T_GASTO('10468660'),
                         T_GASTO('10468661'),
                         T_GASTO('10468662'),
                         T_GASTO('10468663'),
                         T_GASTO('10468664'),
                         T_GASTO('10468665'),
                         T_GASTO('10468666'),
                         T_GASTO('10468667'),
                         T_GASTO('10468668'),
                         T_GASTO('10468669'),
                         T_GASTO('10468670'),
                         T_GASTO('10468671'),
                         T_GASTO('10468672'),
                         T_GASTO('10468673'),
                         T_GASTO('10468674'),
                         T_GASTO('10468675'),
                         T_GASTO('10468676'),
                         T_GASTO('10468677'),
                         T_GASTO('10468678'),
                         T_GASTO('10468679'),
                         T_GASTO('10468680'),
                         T_GASTO('10468681'),
                         T_GASTO('10468684'),
                         T_GASTO('10468686'),
                         T_GASTO('10468687'),
                         T_GASTO('10468689'),
                         T_GASTO('10468700'),
                         T_GASTO('10468704'),
                         T_GASTO('10468706'),
                         T_GASTO('10468708'),
                         T_GASTO('10468710'),
                         T_GASTO('10468715'),
                         T_GASTO('10468718'),
                         T_GASTO('10468720'),
                         T_GASTO('10468722'),
                         T_GASTO('10468724'),
                         T_GASTO('10468725'),
                         T_GASTO('10468727'),
                         T_GASTO('10468728'),
                         T_GASTO('10468735'),
                         T_GASTO('10468737'),
                         T_GASTO('10468745'),
                         T_GASTO('10374093'),
                         T_GASTO('10374303'),
                         T_GASTO('10464835'),
                         T_GASTO('10464841'),
                         T_GASTO('10464843'),
                         T_GASTO('10464845'),
                         T_GASTO('10464847'),
                         T_GASTO('10464854'),
                         T_GASTO('10464856'),
                         T_GASTO('10464858'),
                         T_GASTO('10464859'),
                         T_GASTO('10464860'),
                         T_GASTO('10464861'),
                         T_GASTO('10464862'),
                         T_GASTO('10464875'),
                         T_GASTO('10464877'),
                         T_GASTO('10464879'),
                         T_GASTO('10464882'),
                         T_GASTO('10464893'),
                         T_GASTO('10471371'),
                         T_GASTO('10471404'),
                         T_GASTO('10471408'),
                         T_GASTO('10471419'),
                         T_GASTO('10471429'),
                         T_GASTO('10471431'),
                         T_GASTO('10471433'),
                         T_GASTO('10471438'),
                         T_GASTO('10471440'),
                         T_GASTO('10471442'),
                         T_GASTO('10471444'),
                         T_GASTO('10471446'),
                         T_GASTO('10471448'),
                         T_GASTO('10471450'),
                         T_GASTO('10471452'),
                         T_GASTO('10471454'),
                         T_GASTO('10471456'),
                         T_GASTO('10471458'),
                         T_GASTO('10471460'),
                         T_GASTO('10471462'),
                         T_GASTO('10471464'),
                         T_GASTO('10471467'),
                         T_GASTO('10471471'),
                         T_GASTO('10471473'),
                         T_GASTO('10471499'),
                         T_GASTO('10471501'),
                         T_GASTO('10471503'),
                         T_GASTO('10471505'),
                         T_GASTO('10471507'),
                         T_GASTO('10471509'),
                         T_GASTO('10471511'),
                         T_GASTO('10471513'),
                         T_GASTO('10471515'),
                         T_GASTO('10471517'),
                         T_GASTO('10471519'),
                         T_GASTO('10471521'),
                         T_GASTO('10471523'),
                         T_GASTO('10471525'),
                         T_GASTO('10471527'),
                         T_GASTO('10471544'),
                         T_GASTO('10471797'),
                         T_GASTO('10410718'),
                         T_GASTO('10471213'),
                         T_GASTO('10471230'),
                         T_GASTO('10471240'),
                         T_GASTO('10471251'),
                         T_GASTO('10471252'),
                         T_GASTO('10471253'),
                         T_GASTO('10471254'),
                         T_GASTO('10471255'),
                         T_GASTO('10471256'),
                         T_GASTO('10471257'),
                         T_GASTO('10471258'),
                         T_GASTO('10471259'),
                         T_GASTO('10471296'),
                         T_GASTO('10471297'),
                         T_GASTO('10471298'),
                         T_GASTO('10471299'),
                         T_GASTO('10471300'),
                         T_GASTO('10471301'),
                         T_GASTO('10471302'),
                         T_GASTO('10471303'),
                         T_GASTO('10471304'),
                         T_GASTO('10471305'),
                         T_GASTO('10471311'),
                         T_GASTO('10471312'),
                         T_GASTO('10471322'),
                         T_GASTO('10471347'),
                         T_GASTO('10364868'),
                         T_GASTO('10365122'),
                         T_GASTO('10365583'),
                         T_GASTO('10365689'),
                         T_GASTO('10363704'),
                         T_GASTO('10362947'),
                         T_GASTO('10363055'),
                         T_GASTO('10363919'),
                         T_GASTO('10364170'),
                         T_GASTO('10413721'),
                         T_GASTO('10413722'),
                         T_GASTO('10368154'),
                         T_GASTO('10366211'),
                         T_GASTO('10366743'),
                         T_GASTO('10379600'),
                         T_GASTO('10379610'),
                         T_GASTO('10379612'),
                         T_GASTO('10379616'),
                         T_GASTO('10445243'),
                         T_GASTO('10445315'),
                         T_GASTO('10445319'),
                         T_GASTO('10462049'),
                         T_GASTO('10462051'),
                         T_GASTO('10415102'),
                         T_GASTO('10415103'),
                         T_GASTO('10415105'),
                         T_GASTO('10415106'),
                         T_GASTO('10415107'),
                         T_GASTO('10415109'),
                         T_GASTO('10415110'),
                         T_GASTO('10415111'),
                         T_GASTO('10463436'),
                         T_GASTO('10463437'),
                         T_GASTO('10463439'),
                         T_GASTO('10463440'),
                         T_GASTO('10463441'),
                         T_GASTO('10463442'),
                         T_GASTO('10463444'),
                         T_GASTO('10463448'),
                         T_GASTO('10463453'),
                         T_GASTO('10463457'),
                         T_GASTO('10463459'),
                         T_GASTO('10463462'),
                         T_GASTO('10463496'),
                         T_GASTO('10463498'),
                         T_GASTO('10463500'),
                         T_GASTO('10463502'),
                         T_GASTO('10463509'),
                         T_GASTO('10463511'),
                         T_GASTO('10463512'),
                         T_GASTO('10463517'),
                         T_GASTO('10463518'),
                         T_GASTO('10404842'),
                         T_GASTO('10404843'),
                         T_GASTO('10404844'),
                         T_GASTO('10405328'),
                         T_GASTO('10405329'),
                         T_GASTO('10405330'),
                         T_GASTO('10405345'),
                         T_GASTO('10375238'),
                         T_GASTO('10375239'),
                         T_GASTO('10376138'),
                         T_GASTO('10376139'),
                         T_GASTO('10383568'),
                         T_GASTO('10383578'),
                         T_GASTO('10383696'),
                         T_GASTO('10383769'),
                         T_GASTO('10383799'),
                         T_GASTO('10383457'),
                         T_GASTO('10386637'),
                         T_GASTO('10380884'),
                         T_GASTO('10387624'),
                         T_GASTO('10386101'),
                         T_GASTO('10331733'),
                         T_GASTO('10331734'),
                         T_GASTO('10331735'),
                         T_GASTO('10331736'),
                         T_GASTO('10331737'),
                         T_GASTO('10331738'),
                         T_GASTO('10331739'),
                         T_GASTO('10331740'),
                         T_GASTO('10331741'),
                         T_GASTO('10331742'),
                         T_GASTO('10331809'),
                         T_GASTO('10331810'),
                         T_GASTO('10331849'),
                         T_GASTO('10331850'),
                         T_GASTO('10331851'),
                         T_GASTO('10332103'),
                         T_GASTO('10452243'),
                         T_GASTO('10452259'),
                         T_GASTO('10452305'),
                         T_GASTO('10452306'),
                         T_GASTO('10452334'),
                         T_GASTO('10452520'),
                         T_GASTO('10452521'),
                         T_GASTO('10452564'),
                         T_GASTO('10452587'),
                         T_GASTO('10373667'),
                         T_GASTO('10451445'),
                         T_GASTO('10451448'),
                         T_GASTO('10451454'),
                         T_GASTO('10406068'),
                         T_GASTO('10406069'),
                         T_GASTO('10406070'),
                         T_GASTO('10452733'),
                         T_GASTO('10452734'),
                         T_GASTO('10452763'),
                         T_GASTO('10452764'),
                         T_GASTO('10394445'),
                         T_GASTO('10394447'),
                         T_GASTO('10394448'),
                         T_GASTO('10394449'),
                         T_GASTO('10394451'),
                         T_GASTO('10394452'),
                         T_GASTO('10394453'),
                         T_GASTO('10394455'),
                         T_GASTO('10394456'),
                         T_GASTO('10394457'),
                         T_GASTO('10394459'),
                         T_GASTO('10394460'),
                         T_GASTO('10394461'),
                         T_GASTO('10394463'),
                         T_GASTO('10394464'),
                         T_GASTO('10394465'),
                         T_GASTO('10394470'),
                         T_GASTO('10394472'),
                         T_GASTO('10394473'),
                         T_GASTO('10394475'),
                         T_GASTO('10394476'),
                         T_GASTO('10394477'),
                         T_GASTO('10394479'),
                         T_GASTO('10394480'),
                         T_GASTO('10394481'),
                         T_GASTO('10394483'),
                         T_GASTO('10394484'),
                         T_GASTO('10394486'),
                         T_GASTO('10394487'),
                         T_GASTO('10394490'),
                         T_GASTO('10394491'),
                         T_GASTO('10394493'),
                         T_GASTO('10394757'),
                         T_GASTO('10395959'),
                         T_GASTO('10417143'),
                         T_GASTO('10417144'),
                         T_GASTO('10417145'),
                         T_GASTO('10417316'),
                         T_GASTO('10435822'),
                         T_GASTO('10435874'),
                         T_GASTO('10447016'),
                         T_GASTO('10447020'),
                         T_GASTO('10447023'),
                         T_GASTO('10447025'),
                         T_GASTO('10447027'),
                         T_GASTO('10447030'),
                         T_GASTO('10418457'),
                         T_GASTO('10460661'),
                         T_GASTO('10460662'),
                         T_GASTO('10460663'),
                         T_GASTO('10460664'),
                         T_GASTO('10460665'),
                         T_GASTO('10460666'),
                         T_GASTO('10460673'),
                         T_GASTO('10460675'),
                         T_GASTO('10460686'),
                         T_GASTO('10460687'),
                         T_GASTO('10465357'),
                         T_GASTO('10465367'),
                         T_GASTO('10465373'),
                         T_GASTO('10465380'),
                         T_GASTO('10465381'),
                         T_GASTO('10465384'),
                         T_GASTO('10465390'),
                         T_GASTO('10465412'),
                         T_GASTO('10465424'),
                         T_GASTO('10465425'),
                         T_GASTO('10467304'),
                         T_GASTO('10467339'),
                         T_GASTO('10467348'),
                         T_GASTO('10415466'),
                         T_GASTO('10415467'),
                         T_GASTO('10415469'),
                         T_GASTO('10415472'),
                         T_GASTO('10415473'),
                         T_GASTO('10415475'),
                         T_GASTO('10415476'),
                         T_GASTO('10415478'),
                         T_GASTO('10415481'),
                         T_GASTO('10415491'),
                         T_GASTO('10415493'),
                         T_GASTO('10415494'),
                         T_GASTO('10415497'),
                         T_GASTO('10415499'),
                         T_GASTO('10415500'),
                         T_GASTO('10415503'),
                         T_GASTO('10415506'),
                         T_GASTO('10426340'),
                         T_GASTO('10426355'),
                         T_GASTO('10438079'),
                         T_GASTO('10438080'),
                         T_GASTO('10438081'),
                         T_GASTO('10438082'),
                         T_GASTO('10438083'),
                         T_GASTO('10438084'),
                         T_GASTO('10438085'),
                         T_GASTO('10438086'),
                         T_GASTO('10438087'),
                         T_GASTO('10438088'),
                         T_GASTO('10438089'),
                         T_GASTO('10438090'),
                         T_GASTO('10438091'),
                         T_GASTO('10438092'),
                         T_GASTO('10438093'),
                         T_GASTO('10438094'),
                         T_GASTO('10438095'),
                         T_GASTO('10438096'),
                         T_GASTO('10438097'),
                         T_GASTO('10438098'),
                         T_GASTO('10438099'),
                         T_GASTO('10438100'),
                         T_GASTO('10438101'),
                         T_GASTO('10438102'),
                         T_GASTO('10438103'),
                         T_GASTO('10438104'),
                         T_GASTO('10438105'),
                         T_GASTO('10438106'),
                         T_GASTO('10438109'),
                         T_GASTO('10438153'),
                         T_GASTO('10438160'),
                         T_GASTO('10438217'),
                         T_GASTO('10438218'),
                         T_GASTO('10438219'),
                         T_GASTO('10438220'),
                         T_GASTO('10438251'),
                         T_GASTO('10439092'),
                         T_GASTO('10439093'),
                         T_GASTO('10439094'),
                         T_GASTO('10439095'),
                         T_GASTO('10464096'),
                         T_GASTO('10464105'),
                         T_GASTO('10464130'),
                         T_GASTO('10464131'),
                         T_GASTO('10464138'),
                         T_GASTO('10464139'),
                         T_GASTO('10436811'),
                         T_GASTO('10436828'),
                         T_GASTO('10436829'),
                         T_GASTO('10436830'),
                         T_GASTO('10436831'),
                         T_GASTO('10436832'),
                         T_GASTO('10436833'),
                         T_GASTO('10428377'),
                         T_GASTO('10428477'),
                         T_GASTO('10425722'),
                         T_GASTO('10425821'),
                         T_GASTO('10425833')
	
   ); 
    V_TMP_GASTO T_GASTO;



BEGIN

	DBMS_OUTPUT.PUT_LINE('[INICIO] Haciendo comprobaciones previas... ');


		FOR I IN V_GASTOS.FIRST .. V_GASTOS.LAST
		LOOP
			V_TMP_GASTO := V_GASTOS(I);

			DBMS_OUTPUT.PUT_LINE('[INFO] Comprobando que existe el gasto '||TRIM(V_TMP_GASTO(1))||'.');

			V_SQL := 'SELECT COUNT(1)
					  FROM '||V_ESQUEMA||'.GPV_GASTOS_PROVEEDOR 
					  WHERE GPV_NUM_GASTO_HAYA = '||TRIM(V_TMP_GASTO(1));

			EXECUTE IMMEDIATE V_SQL INTO V_EXISTE_GASTO;

			IF V_EXISTE_GASTO > 0 THEN

				DBMS_OUTPUT.PUT_LINE('[INFO] Recogiendo el id del gasto '||TRIM(V_TMP_GASTO(1))||'.');

				V_SQL := 'SELECT GPV_ID
					  FROM '||V_ESQUEMA||'.GPV_GASTOS_PROVEEDOR 
					  WHERE GPV_NUM_GASTO_HAYA = '||TRIM(V_TMP_GASTO(1));

				EXECUTE IMMEDIATE V_SQL INTO V_GPV_ID;

				DBMS_OUTPUT.PUT_LINE('[INFO] Actualizando el gasto '||TRIM(V_TMP_GASTO(1)) );

				V_SQL := 'UPDATE '||V_ESQUEMA||'.GPV_GASTOS_PROVEEDOR
					  SET DD_EGA_ID = (SELECT DD_EGA_ID FROM  ' || V_ESQUEMA || '.DD_EGA_ESTADOS_GASTO WHERE DD_EGA_CODIGO = ''03''),
					      PRG_ID = NULL,
					      USUARIOMODIFICAR = ''REMVIP-3981'',
					      FECHAMODIFICAR = SYSDATE
					  WHERE GPV_ID = '||V_GPV_ID||'';

				EXECUTE IMMEDIATE V_SQL;


				V_SQL := 'UPDATE '||V_ESQUEMA||'.GGE_GASTOS_GESTION
					  SET DD_EAH_ID = (SELECT DD_EAH_ID FROM  ' || V_ESQUEMA || '.DD_EAH_ESTADOS_AUTORIZ_HAYA WHERE DD_EAH_CODIGO = ''03''),
					      GGE_FECHA_EAH = SYSDATE,
					      DD_EAP_ID = (SELECT DD_EAP_ID FROM  ' || V_ESQUEMA || '.DD_EAP_ESTADOS_AUTORIZ_PROP WHERE DD_EAP_CODIGO = ''01''),
					      GGE_FECHA_EAP = NULL,
 					      GGE_MOTIVO_RECHAZO_PROP = NULL,
					      GGE_FECHA_ENVIO_PRPTRIO = NULL,
					      USUARIOMODIFICAR = ''REMVIP-3981'',
					      FECHAMODIFICAR = SYSDATE
					  WHERE GPV_ID = '||V_GPV_ID||'';	

				EXECUTE IMMEDIATE V_SQL;


				DBMS_OUTPUT.PUT_LINE('[INFO] El gasto '||TRIM(V_TMP_GASTO(1))||' ha sido actualizado.');

			ELSE 
				DBMS_OUTPUT.PUT_LINE('[INFO] No se ha encontrado el gasto '||TRIM(V_TMP_GASTO(1))  );
			END IF;

		END LOOP;



	COMMIT;

EXCEPTION
    WHEN OTHERS THEN
      DBMS_OUTPUT.PUT_LINE('[ERROR] Se ha producido un error en la ejecución:'||TO_CHAR(SQLCODE));
      DBMS_OUTPUT.PUT_LINE('-----------------------------------------------------------');
      DBMS_OUTPUT.PUT_LINE(SQLERRM);
      DBMS_OUTPUT.PUT_LINE(V_SQL);
      ROLLBACK;
      RAISE;
END;
/
EXIT;
