--/*
--##########################################
--## AUTOR=JINLI HU
--## FECHA_CREACION=20190123
--## ARTEFACTO=online
--## VERSION_ARTEFACTO=9.2
--## INCIDENCIA_LINK=REMVIP-3083
--## PRODUCTO=NO
--##
--## Finalidad: Script para sustituir el gestor actual de las configuraciones por las de una Excel adjunta en el item.
--## 			(Cambio en configuración de gestor de activo y supervisor de activo)
--##			Añade en la tabla ACT_GES_DIST_GESTORES los datos del array T_ARRAY_DATA
--## INSTRUCCIONES:
--## VERSIONES:
--##        0.1 Versión inicial
--##########################################
--*/


WHENEVER SQLERROR EXIT SQL.SQLCODE;
SET SERVEROUTPUT ON; 
SET DEFINE OFF;


DECLARE
    V_MSQL VARCHAR2(32000 CHAR); -- Sentencia a ejecutar     
    V_ESQUEMA VARCHAR2(25 CHAR):= '#ESQUEMA#'; -- Configuracion Esquema
    V_ESQUEMA_M VARCHAR2(25 CHAR):= '#ESQUEMA_MASTER#'; -- Configuracion Esquema Master
    V_SQL VARCHAR2(4000 CHAR); -- Vble. para consulta que valida la existencia de una tabla.
    V_NUM_TABLAS NUMBER(16); -- Vble. para validar la existencia de una tabla.   
    ERR_NUM NUMBER(25);  -- Vble. auxiliar para registrar errores en el script.
    ERR_MSG VARCHAR2(1024 CHAR); -- Vble. auxiliar para registrar errores en el script.
	
    V_TEXT1 VARCHAR2(2400 CHAR); -- Vble. auxiliar
    V_TEXT_TABLA VARCHAR2(2400 CHAR) := 'ACT_GES_DIST_GESTORES'; -- Vble. auxiliar para almacenar el nombre de la tabla de ref.
    V_ENTIDAD_ID NUMBER(16);
    V_ID NUMBER(16);
    V_USU VARCHAR2(2400 CHAR) := 'REMVIP-3083';

    TYPE T_TIPO_DATA IS TABLE OF VARCHAR2(150);
    TYPE T_ARRAY_DATA IS TABLE OF T_TIPO_DATA;
    
    V_TIPO_DATA T_ARRAY_DATA := T_ARRAY_DATA(
    	T_TIPO_DATA('igomezr','2','',''),
		T_TIPO_DATA('igomezr','33','',''),
		T_TIPO_DATA('igomezr','5','',''),
		T_TIPO_DATA('igomezr','48','',''),
		T_TIPO_DATA('igomezr','9','',''),
		T_TIPO_DATA('igomezr','13','',''),
		T_TIPO_DATA('igomezr','15','',''),
		T_TIPO_DATA('igomezr','16','',''),
		T_TIPO_DATA('igomezr','19','',''),
		T_TIPO_DATA('igomezr','22','',''),
		T_TIPO_DATA('igomezr','24','',''),
		T_TIPO_DATA('igomezr','28','',''),
		T_TIPO_DATA('igomezr','31','',''),
		T_TIPO_DATA('igomezr','34','',''),
		T_TIPO_DATA('igomezr','35','',''),
		T_TIPO_DATA('igomezr','36','',''),
		T_TIPO_DATA('igomezr','26','',''),
		T_TIPO_DATA('igomezr','38','',''),
		T_TIPO_DATA('igomezr','40','',''),
		T_TIPO_DATA('igomezr','42','',''),
		T_TIPO_DATA('igomezr','44','',''),
		T_TIPO_DATA('igomezr','45','',''),
		T_TIPO_DATA('igomezr','47','',''),
		T_TIPO_DATA('igomezr','50','',''),
		T_TIPO_DATA('maguilar','7','',''),
		T_TIPO_DATA('maguilar','8','',''),
		T_TIPO_DATA('maguilar','17','',''),
		T_TIPO_DATA('maguilar','25','',''),
		T_TIPO_DATA('maguilar','43','',''),
		T_TIPO_DATA('dvillaescusa','6','',''),
		T_TIPO_DATA('dvillaescusa','10','',''),
		T_TIPO_DATA('dvillaescusa','11','',''),
		T_TIPO_DATA('dvillaescusa','51','',''),
		T_TIPO_DATA('dvillaescusa','52','',''),
		T_TIPO_DATA('dvillaescusa','21','',''),
		T_TIPO_DATA('dvillaescusa','29','',''),
		T_TIPO_DATA('dvillaescusa','41','',''),
		T_TIPO_DATA('ateruel','12','',''),
		T_TIPO_DATA('asalag','30','',''),
		T_TIPO_DATA('agonzalezcr','3','',''),
		T_TIPO_DATA('gdelrosal','18','',''),
		T_TIPO_DATA('gdelrosal','23','',''),
		T_TIPO_DATA('mmaldonado','46','46011','46260'),
		T_TIPO_DATA('mmaldonado','46','46012','46369'),
		T_TIPO_DATA('mmaldonado','46','46016','46293'),
		T_TIPO_DATA('mmaldonado','46','46031','46230'),
		T_TIPO_DATA('mmaldonado','46','46017','46270'),
		T_TIPO_DATA('mmaldonado','46','46017','46600'),
		T_TIPO_DATA('mmaldonado','46','46038','46162'),
		T_TIPO_DATA('mmaldonado','46','46044','46620'),
		T_TIPO_DATA('mmaldonado','46','46051','46180'),
		T_TIPO_DATA('mmaldonado','46','46064','46611'),
		T_TIPO_DATA('mmaldonado','46','46067','46181'),
		T_TIPO_DATA('mmaldonado','46','46070','46117'),
		T_TIPO_DATA('mmaldonado','46','46076','46165'),
		T_TIPO_DATA('mmaldonado','46','46077','46360'),
		T_TIPO_DATA('mmaldonado','46','46078','46100'),
		T_TIPO_DATA('mmaldonado','46','46080','46330'),
		T_TIPO_DATA('mmaldonado','46','46083','46749'),
		T_TIPO_DATA('mmaldonado','46','46083','46760'),
		T_TIPO_DATA('mmaldonado','46','46084','46029'),
		T_TIPO_DATA('mmaldonado','46','46084','46294'),
		T_TIPO_DATA('mmaldonado','46','46089','46171'),
		T_TIPO_DATA('mmaldonado','46','46095','46315'),
		T_TIPO_DATA('mmaldonado','46','46106','46176'),
		T_TIPO_DATA('mmaldonado','46','46106','46380'),
		T_TIPO_DATA('mmaldonado','46','46111','46370'),
		T_TIPO_DATA('mmaldonado','46','46112','46000'),
		T_TIPO_DATA('mmaldonado','46','46099','46199'),
		T_TIPO_DATA('mmaldonado','46','46100','46294'),
		T_TIPO_DATA('mmaldonado','46','46100','46294'),
		T_TIPO_DATA('mmaldonado','46','46114','46174'),
		T_TIPO_DATA('mmaldonado','46','46116','46183'),
		T_TIPO_DATA('mmaldonado','46','46117','46135'),
		T_TIPO_DATA('mmaldonado','46','46119','46669'),
		T_TIPO_DATA('mmaldonado','46','46130','46267'),
		T_TIPO_DATA('mmaldonado','46','46133','46166'),
		T_TIPO_DATA('mmaldonado','46','46135','46110'),
		T_TIPO_DATA('mmaldonado','46','46136','46388'),
		T_TIPO_DATA('mmaldonado','46','46142','46624'),
		T_TIPO_DATA('mmaldonado','46','46144','46623'),
		T_TIPO_DATA('mmaldonado','46','46147','46160'),
		T_TIPO_DATA('mmaldonado','46','46157','46815'),
		T_TIPO_DATA('mmaldonado','46','46149','46168'),
		T_TIPO_DATA('mmaldonado','46','46158','46368'),
		T_TIPO_DATA('mmaldonado','46','46160','46660'),
		T_TIPO_DATA('mmaldonado','46','46160','46669'),
		T_TIPO_DATA('mmaldonado','46','46160','46670'),
		T_TIPO_DATA('mmaldonado','46','46161','46163'),
		T_TIPO_DATA('mmaldonado','46','46161','46169'),
		T_TIPO_DATA('mmaldonado','46','46162','46292'),
		T_TIPO_DATA('mmaldonado','46','46178','46119'),
		T_TIPO_DATA('mmaldonado','46','46182','46169'),
		T_TIPO_DATA('mmaldonado','46','46190','46098'),
		T_TIPO_DATA('mmaldonado','46','46190','46182'),
		T_TIPO_DATA('mmaldonado','46','46190','46980'),
		T_TIPO_DATA('mmaldonado','46','46191','46164'),
		T_TIPO_DATA('mmaldonado','46','46202','46185'),
		T_TIPO_DATA('mmaldonado','46','46203','46670'),
		T_TIPO_DATA('mmaldonado','46','46206','46824'),
		T_TIPO_DATA('mmaldonado','46','46209','46666'),
		T_TIPO_DATA('mmaldonado','46','46213','46340'),
		T_TIPO_DATA('mmaldonado','46','46213','46357'),
		T_TIPO_DATA('mmaldonado','46','46213','46390'),
		T_TIPO_DATA('mmaldonado','46','46214','46190'),
		T_TIPO_DATA('mmaldonado','46','46216','46111'),
		T_TIPO_DATA('mmaldonado','46','46222','46669'),
		T_TIPO_DATA('mmaldonado','46','46228','46118'),
		T_TIPO_DATA('mmaldonado','46','46234','46168'),
		T_TIPO_DATA('mmaldonado','46','46236','46295'),
		T_TIPO_DATA('mmaldonado','46','46239','46470'),
		T_TIPO_DATA('mmaldonado','46','46242','46143'),
		T_TIPO_DATA('mmaldonado','46','46246','46269'),
		T_TIPO_DATA('mmaldonado','46','46247','46177'),
		T_TIPO_DATA('mmaldonado','46','46248','46000'),
		T_TIPO_DATA('mmaldonado','46','46248','46389'),
		T_TIPO_DATA('mmaldonado','46','46249','46300'),
		T_TIPO_DATA('mmaldonado','46','46249','46313'),
		T_TIPO_DATA('mmaldonado','46','46256','46191'),
		T_TIPO_DATA('mmaldonado','46','46257','46270'),
		T_TIPO_DATA('mmaldonado','46','46258','46170'),
		T_TIPO_DATA('mmaldonado','46','46261','46367'),
		T_TIPO_DATA('mmaldonado','46','46002','46729'),
		T_TIPO_DATA('mmaldonado','46','46008','46000'),
		T_TIPO_DATA('mmaldonado','46','46008','46687'),
		T_TIPO_DATA('mmaldonado','46','46026','46197'),
		T_TIPO_DATA('mmaldonado','46','46029','46680'),
		T_TIPO_DATA('mmaldonado','46','46034','46723'),
		T_TIPO_DATA('mmaldonado','46','46035','46440'),
		T_TIPO_DATA('mmaldonado','46','46048','46713'),
		T_TIPO_DATA('mmaldonado','46','46904','46689'),
		T_TIPO_DATA('mmaldonado','46','46060','46450'),
		T_TIPO_DATA('mmaldonado','46','46059','46791'),
		T_TIPO_DATA('mmaldonado','46','46059','46791'),
		T_TIPO_DATA('mmaldonado','46','46061','46722'),
		T_TIPO_DATA('mmaldonado','46','46063','46291'),
		T_TIPO_DATA('mmaldonado','46','46066','46703'),
		T_TIPO_DATA('mmaldonado','46','46085','46240'),
		T_TIPO_DATA('mmaldonado','46','46093','46196'),
		T_TIPO_DATA('mmaldonado','46','46098','46612'),
		T_TIPO_DATA('mmaldonado','46','46105','46400'),
		T_TIPO_DATA('mmaldonado','46','46105','46408'),
		T_TIPO_DATA('mmaldonado','46','46113','46710'),
		T_TIPO_DATA('mmaldonado','46','46123','46614'),
		T_TIPO_DATA('mmaldonado','46','46127','46717'),
		T_TIPO_DATA('mmaldonado','46','46125','46418'),
		T_TIPO_DATA('mmaldonado','46','46131','46131'),
		T_TIPO_DATA('mmaldonado','46','46131','46700'),
		T_TIPO_DATA('mmaldonado','46','46131','46702'),
		T_TIPO_DATA('mmaldonado','46','46131','46703'),
		T_TIPO_DATA('mmaldonado','46','46131','46730'),
		T_TIPO_DATA('mmaldonado','46','46139','46610'),
		T_TIPO_DATA('mmaldonado','46','46140','46711'),
		T_TIPO_DATA('mmaldonado','46','46155','46613'),
		T_TIPO_DATA('mmaldonado','46','46156','46195'),
		T_TIPO_DATA('mmaldonado','46','46181','46780'),
		T_TIPO_DATA('mmaldonado','46','46187','46701'),
		T_TIPO_DATA('mmaldonado','46','46187','46724'),
		T_TIPO_DATA('mmaldonado','46','46195','46712'),
		T_TIPO_DATA('mmaldonado','46','46197','46688'),
		T_TIPO_DATA('mmaldonado','46','46197','46689'),
		T_TIPO_DATA('mmaldonado','46','46198','46721'),
		T_TIPO_DATA('mmaldonado','46','46208','46716'),
		T_TIPO_DATA('mmaldonado','46','46211','46727'),
		T_TIPO_DATA('mmaldonado','46','46215','46417'),
		T_TIPO_DATA('mmaldonado','46','46215','46418'),
		T_TIPO_DATA('mmaldonado','46','46231','46740'),
		T_TIPO_DATA('mmaldonado','46','46231','46750'),
		T_TIPO_DATA('mmaldonado','46','46233','46430'),
		T_TIPO_DATA('mmaldonado','46','46235','46410'),
		T_TIPO_DATA('mmaldonado','46','46235','46419'),
		T_TIPO_DATA('mmaldonado','46','46235','46420'),
		T_TIPO_DATA('mmaldonado','46','46235','46440'),
		T_TIPO_DATA('mmaldonado','46','46238','46016'),
		T_TIPO_DATA('mmaldonado','46','46238','46760'),
		T_TIPO_DATA('mmaldonado','46','46255','46720'),
		T_TIPO_DATA('mmaldonado','46','46143','46770'),
		T_TIPO_DATA('mmaldonado','46','46146','46790'),
		T_TIPO_DATA('gcarbonell','46','46126','46000'),
		T_TIPO_DATA('gcarbonell','46','46250','46004'),
		T_TIPO_DATA('gcarbonell','46','46250','46008'),
		T_TIPO_DATA('gcarbonell','46','46250','46009'),
		T_TIPO_DATA('gcarbonell','46','46250','46011'),
		T_TIPO_DATA('gcarbonell','46','46250','46015'),
		T_TIPO_DATA('gcarbonell','46','46237','46016'),
		T_TIPO_DATA('gcarbonell','46','46250','46017'),
		T_TIPO_DATA('gcarbonell','46','46250','46018'),
		T_TIPO_DATA('gcarbonell','46','46250','46019'),
		T_TIPO_DATA('gcarbonell','46','46250','46020'),
		T_TIPO_DATA('gcarbonell','46','46250','46021'),
		T_TIPO_DATA('gcarbonell','46','46250','46022'),
		T_TIPO_DATA('gcarbonell','46','46172','46023'),
		T_TIPO_DATA('gcarbonell','46','46035','46035'),
		T_TIPO_DATA('gcarbonell','46','46014','46113'),
		T_TIPO_DATA('gcarbonell','46','46260','46114'),
		T_TIPO_DATA('gcarbonell','46','46164','46119'),
		T_TIPO_DATA('gcarbonell','46','46013','46120'),
		T_TIPO_DATA('gcarbonell','46','46164','46130'),
		T_TIPO_DATA('gcarbonell','46','46032','46132'),
		T_TIPO_DATA('gcarbonell','46','46166','46133'),
		T_TIPO_DATA('gcarbonell','46','46126','46134'),
		T_TIPO_DATA('gcarbonell','46','46009','46135'),
		T_TIPO_DATA('gcarbonell','46','46177','46136'),
		T_TIPO_DATA('gcarbonell','46','46199','46137'),
		T_TIPO_DATA('gcarbonell','46','46207','46138'),
		T_TIPO_DATA('gcarbonell','46','46199','46139'),
		T_TIPO_DATA('gcarbonell','46','46134','46149'),
		T_TIPO_DATA('gcarbonell','46','46164','46371'),
		T_TIPO_DATA('gcarbonell','46','46220','46500'),
		T_TIPO_DATA('gcarbonell','46','46192','46501'),
		T_TIPO_DATA('gcarbonell','46','46220','46520'),
		T_TIPO_DATA('gcarbonell','46','46205','46530'),
		T_TIPO_DATA('gcarbonell','46','46204','46540'),
		T_TIPO_DATA('gcarbonell','46','46014','46550'),
		T_TIPO_DATA('gcarbonell','46','46163','46560'),
		T_TIPO_DATA('gcarbonell','46','46010','46591'),
		T_TIPO_DATA('gcarbonell','46','46024','46594'),
		T_TIPO_DATA('gcarbonell','46','46009','46687'),
		T_TIPO_DATA('gcarbonell','46','46169','46920'),
		T_TIPO_DATA('gcarbonell','46','46110','46920'),
		T_TIPO_DATA('gcarbonell','46','46102','46930'),
		T_TIPO_DATA('gcarbonell','46','46159','46940'),
		T_TIPO_DATA('gcarbonell','46','46102','46940'),
		T_TIPO_DATA('gcarbonell','46','46110','46950'),
		T_TIPO_DATA('gcarbonell','46','46005','46970'),
		T_TIPO_DATA('gcarbonell','46','46250','49019'),
		T_TIPO_DATA('gcarbonell','46','46004','46890'),
		T_TIPO_DATA('gcarbonell','46','46042','46812'),
		T_TIPO_DATA('gcarbonell','46','46006','46860'),
		T_TIPO_DATA('gcarbonell','46','46006','46860'),
		T_TIPO_DATA('gcarbonell','46','46007','46470'),
		T_TIPO_DATA('gcarbonell','46','46015','46290'),
		T_TIPO_DATA('gcarbonell','46','46020','46690'),
		T_TIPO_DATA('gcarbonell','46','46019','46250'),
		T_TIPO_DATA('gcarbonell','46','46021','46960'),
		T_TIPO_DATA('gcarbonell','46','46022','46909'),
		T_TIPO_DATA('gcarbonell','46','46022','46910'),
		T_TIPO_DATA('gcarbonell','46','46039','46820'),
		T_TIPO_DATA('gcarbonell','46','46047','46868'),
		T_TIPO_DATA('gcarbonell','46','46054','46910'),
		T_TIPO_DATA('gcarbonell','46','46057','46838'),
		T_TIPO_DATA('gcarbonell','46','46062','46830'),
		T_TIPO_DATA('gcarbonell','46','46065','46469'),
		T_TIPO_DATA('gcarbonell','46','46069','46839'),
		T_TIPO_DATA('gcarbonell','46','46072','46880'),
		T_TIPO_DATA('gcarbonell','46','46073','46822'),
		T_TIPO_DATA('gcarbonell','46','46075','46891'),
		T_TIPO_DATA('gcarbonell','46','46081','46650'),
		T_TIPO_DATA('gcarbonell','46','46090','46841'),
		T_TIPO_DATA('gcarbonell','46','46094','46470'),
		T_TIPO_DATA('gcarbonell','46','46107','46821'),
		T_TIPO_DATA('gcarbonell','46','46106','46380'),
		T_TIPO_DATA('gcarbonell','46','46118','46810'),
		T_TIPO_DATA('gcarbonell','46','46121','46817'),
		T_TIPO_DATA('gcarbonell','46','46132','46894'),
		T_TIPO_DATA('gcarbonell','46','46137','46818'),
		T_TIPO_DATA('gcarbonell','46','46138','46839'),
		T_TIPO_DATA('gcarbonell','46','46154','46814'),
		T_TIPO_DATA('gcarbonell','46','46151','46668'),
		T_TIPO_DATA('gcarbonell','46','46165','46470'),
		T_TIPO_DATA('gcarbonell','46','46165','46470'),
		T_TIPO_DATA('gcarbonell','46','46165','46910'),
		T_TIPO_DATA('gcarbonell','46','46170','46640'),
		T_TIPO_DATA('gcarbonell','46','46173','46892'),
		T_TIPO_DATA('gcarbonell','46','46174','46692'),
		T_TIPO_DATA('gcarbonell','46','46176','46193'),
		T_TIPO_DATA('gcarbonell','46','46172','46192'),
		T_TIPO_DATA('gcarbonell','46','46179','46823'),
		T_TIPO_DATA('gcarbonell','46','46180','46800'),
		T_TIPO_DATA('gcarbonell','46','46183','46850'),
		T_TIPO_DATA('gcarbonell','46','46184','46184'),
		T_TIPO_DATA('gcarbonell','46','46184','46870'),
		T_TIPO_DATA('gcarbonell','46','46185','46844'),
		T_TIPO_DATA('gcarbonell','46','46186','46200'),
		T_TIPO_DATA('gcarbonell','46','46189','46891'),
		T_TIPO_DATA('gcarbonell','46','46193','46210'),
		T_TIPO_DATA('gcarbonell','46','46194','46220'),
		T_TIPO_DATA('gcarbonell','46','46200','46840'),
		T_TIPO_DATA('gcarbonell','46','46104','46837'),
		T_TIPO_DATA('gcarbonell','46','46212','46194'),
		T_TIPO_DATA('gcarbonell','46','46217','46816'),
		T_TIPO_DATA('gcarbonell','46','46225','46295'),
		T_TIPO_DATA('gcarbonell','46','46230','46460'),
		T_TIPO_DATA('gcarbonell','46','46235','46001'),
		T_TIPO_DATA('gcarbonell','46','46243','46814'),
		T_TIPO_DATA('gcarbonell','46','46244','46244'),
		T_TIPO_DATA('gcarbonell','46','46244','46900'),
		T_TIPO_DATA('gcarbonell','46','46244','46901'),
		T_TIPO_DATA('gcarbonell','46','46248','46389'),
		T_TIPO_DATA('gcarbonell','46','46250','46000'),
		T_TIPO_DATA('gcarbonell','46','46250','46001'),
		T_TIPO_DATA('gcarbonell','46','46250','46006'),
		T_TIPO_DATA('gcarbonell','46','46250','46007'),
		T_TIPO_DATA('gcarbonell','46','46250','46013'),
		T_TIPO_DATA('gcarbonell','46','46250','46014'),
		T_TIPO_DATA('gcarbonell','46','46250','46016'),
		T_TIPO_DATA('gcarbonell','46','46250','46024'),
		T_TIPO_DATA('gcarbonell','46','46250','46025'),
		T_TIPO_DATA('gcarbonell','46','46250','46026'),
		T_TIPO_DATA('gcarbonell','46','46250','46112'),
		T_TIPO_DATA('gcarbonell','46','46250','46179'),
		T_TIPO_DATA('gcarbonell','46','46250','46191'),
		T_TIPO_DATA('gcarbonell','46','46250','46705'),
		T_TIPO_DATA('gcarbonell','46','46250','46970'),
		T_TIPO_DATA('gcarbonell','46','46251','46691'),
		T_TIPO_DATA('gcarbonell','46','46145','46800'),
		T_TIPO_DATA('gcarbonell','46','46040','46266'),
		T_TIPO_DATA('gcarbonell','46','46046','46758'),
		T_TIPO_DATA('gcarbonell','46','46045','46667'),
		T_TIPO_DATA('gcarbonell','46','46074','46131'),
		T_TIPO_DATA('gcarbonell','46','46153','46726'),
		T_TIPO_DATA('gcarbonell','46','46227','46669'),
		T_TIPO_DATA('gcarbonell','46','46229','46392'),
		T_TIPO_DATA('gcarbonell','46','46259','46317'),
		T_TIPO_DATA('fsamper','4','04001','04510'),
		T_TIPO_DATA('fsamper','4','04003','04770'),
		T_TIPO_DATA('fsamper','4','04003','04779'),
		T_TIPO_DATA('fsamper','4','04003','04003'),
		T_TIPO_DATA('fsamper','4','04003','04628'),
		T_TIPO_DATA('fsamper','4','04011','04000'),
		T_TIPO_DATA('fsamper','4','04011','04400'),
		T_TIPO_DATA('fsamper','4','04013','04000'),
		T_TIPO_DATA('fsamper','4','04013','04001'),
		T_TIPO_DATA('fsamper','4','04013','04002'),
		T_TIPO_DATA('fsamper','4','04013','04003'),
		T_TIPO_DATA('fsamper','4','04013','04004'),
		T_TIPO_DATA('fsamper','4','04013','04005'),
		T_TIPO_DATA('fsamper','4','04013','04006'),
		T_TIPO_DATA('fsamper','4','04013','04007'),
		T_TIPO_DATA('fsamper','4','04013','04008'),
		T_TIPO_DATA('fsamper','4','04013','04009'),
		T_TIPO_DATA('fsamper','4','04013','04100'),
		T_TIPO_DATA('fsamper','4','04013','04110'),
		T_TIPO_DATA('fsamper','4','04013','04117'),
		T_TIPO_DATA('fsamper','4','04013','04120'),
		T_TIPO_DATA('fsamper','4','04013','04130'),
		T_TIPO_DATA('fsamper','4','04013','04131'),
		T_TIPO_DATA('fsamper','4','04013','04150'),
		T_TIPO_DATA('fsamper','4','04013','04400'),
		T_TIPO_DATA('fsamper','4','04013','04630'),
		T_TIPO_DATA('fsamper','4','04013','04720'),
		T_TIPO_DATA('fsamper','4','04013','04700'),
		T_TIPO_DATA('fsamper','4','04013','40074'),
		T_TIPO_DATA('fsamper','4','04015','04567'),
		T_TIPO_DATA('fsamper','4','04015','04568'),
		T_TIPO_DATA('fsamper','4','04029','04760'),
		T_TIPO_DATA('fsamper','4','04030','04450'),
		T_TIPO_DATA('fsamper','4','04038','04750'),
		T_TIPO_DATA('fsamper','4','04038','04710'),
		T_TIPO_DATA('fsamper','4','04038','04716'),
		T_TIPO_DATA('fsamper','4','04902','04000'),
		T_TIPO_DATA('fsamper','4','04902','04700'),
		T_TIPO_DATA('fsamper','4','04902','04710'),
		T_TIPO_DATA('fsamper','4','04902','04711'),
		T_TIPO_DATA('fsamper','4','04902','04712'),
		T_TIPO_DATA('fsamper','4','04902','04715'),
		T_TIPO_DATA('fsamper','4','04902','04716'),
		T_TIPO_DATA('fsamper','4','04046','04460'),
		T_TIPO_DATA('fsamper','4','04046','04450'),
		T_TIPO_DATA('fsamper','4','04047','04560'),
		T_TIPO_DATA('fsamper','4','04050','04200'),
		T_TIPO_DATA('fsamper','4','04050','04549'),
		T_TIPO_DATA('fsamper','4','04050','04550'),
		T_TIPO_DATA('fsamper','4','04051','04409'),
		T_TIPO_DATA('fsamper','4','04052','04230'),
		T_TIPO_DATA('fsamper','4','04057','04470'),
		T_TIPO_DATA('fsamper','4','04903','04745'),
		T_TIPO_DATA('fsamper','4','04079','04000'),
		T_TIPO_DATA('fsamper','4','04079','04600'),
		T_TIPO_DATA('fsamper','4','04079','04710'),
		T_TIPO_DATA('fsamper','4','04079','04720'),
		T_TIPO_DATA('fsamper','4','04079','04730'),
		T_TIPO_DATA('fsamper','4','04079','04738'),
		T_TIPO_DATA('fsamper','4','04079','04740'),
		T_TIPO_DATA('fsamper','4','04079','04741'),
		T_TIPO_DATA('fsamper','4','04079','04743'),
		T_TIPO_DATA('fsamper','4','04079','04746'),
		T_TIPO_DATA('fsamper','4','18905','18110'),
		T_TIPO_DATA('fsamper','4','04091','04567'),
		T_TIPO_DATA('fsamper','4','04091','04569'),
		T_TIPO_DATA('fsamper','4','04901','04530'),
		T_TIPO_DATA('fsamper','4','04101','04240'),
		T_TIPO_DATA('fsamper','4','04102','04102'),
		T_TIPO_DATA('fsamper','4','04102','04721'),
		T_TIPO_DATA('fsamper','4','04102','04727'),
		T_TIPO_DATA('fsamper','4','04102','04738'),
		T_TIPO_DATA('fsamper','4','04102','04740'),
		T_TIPO_DATA('fsamper','4','04102','04741'),
		T_TIPO_DATA('gdelrosal','4','04103','04650'),
		T_TIPO_DATA('gdelrosal','4','04100','04000'),
		T_TIPO_DATA('gdelrosal','4','04100','04620'),
		T_TIPO_DATA('gdelrosal','4','04100','04621'),
		T_TIPO_DATA('gdelrosal','4','04100','04623'),
		T_TIPO_DATA('gdelrosal','4','04100','04624'),
		T_TIPO_DATA('gdelrosal','4','04099','04820'),
		T_TIPO_DATA('gdelrosal','4','04098','04830'),
		T_TIPO_DATA('gdelrosal','4','04097','04560'),
		T_TIPO_DATA('gdelrosal','4','04095','04279'),
		T_TIPO_DATA('gdelrosal','4','04093','04639'),
		T_TIPO_DATA('gdelrosal','4','04092','04880'),
		T_TIPO_DATA('gdelrosal','4','04089','04692'),
		T_TIPO_DATA('gdelrosal','4','04088','04200'),
		T_TIPO_DATA('gdelrosal','4','04086','04149'),
		T_TIPO_DATA('gdelrosal','4','04086','04270'),
		T_TIPO_DATA('gdelrosal','4','04085','04877'),
		T_TIPO_DATA('gdelrosal','4','04083','04890'),
		T_TIPO_DATA('gdelrosal','4','04082','04213'),
		T_TIPO_DATA('gdelrosal','4','04081','04420'),
		T_TIPO_DATA('gdelrosal','4','04078','04260'),
		T_TIPO_DATA('gdelrosal','4','04077','04000'),
		T_TIPO_DATA('gdelrosal','4','04076','04870'),
		T_TIPO_DATA('gdelrosal','4','04075','04647'),
		T_TIPO_DATA('gdelrosal','4','04075','04640'),
		T_TIPO_DATA('gdelrosal','4','04075','04648'),
		T_TIPO_DATA('gdelrosal','4','04074','04250'),
		T_TIPO_DATA('gdelrosal','4','04073','04479'),
		T_TIPO_DATA('gdelrosal','4','04070','04810'),
		T_TIPO_DATA('gdelrosal','4','04069','04660'),
		T_TIPO_DATA('gdelrosal','4','04069','04860'),
		T_TIPO_DATA('gdelrosal','4','04067','04459'),
		T_TIPO_DATA('gdelrosal','4','04066','04100'),
		T_TIPO_DATA('gdelrosal','4','04066','04116'),
		T_TIPO_DATA('gdelrosal','4','04066','04117'),
		T_TIPO_DATA('gdelrosal','4','04066','04115'),
		T_TIPO_DATA('gdelrosal','4','04066','04118'),
		T_TIPO_DATA('gdelrosal','4','04066','04149'),
		T_TIPO_DATA('gdelrosal','4','04065','04000'),
		T_TIPO_DATA('gdelrosal','4','04065','04540'),
		T_TIPO_DATA('gdelrosal','4','04064','04000'),
		T_TIPO_DATA('gdelrosal','4','04064','04630'),
		T_TIPO_DATA('gdelrosal','4','04064','04638'),
		T_TIPO_DATA('gdelrosal','4','04063','04838'),
		T_TIPO_DATA('gdelrosal','4','04063','04830'),
		T_TIPO_DATA('gdelrosal','4','04062','04687'),
		T_TIPO_DATA('gdelrosal','4','04062','04867'),
		T_TIPO_DATA('gdelrosal','4','04060','04210'),
		T_TIPO_DATA('gdelrosal','4','04059','04271'),
		T_TIPO_DATA('gdelrosal','4','04053','04600'),
		T_TIPO_DATA('gdelrosal','4','04053','04692'),
		T_TIPO_DATA('gdelrosal','4','04053','04662'),
		T_TIPO_DATA('gdelrosal','4','04053','04693'),
		T_TIPO_DATA('gdelrosal','4','04049','04630'),
		T_TIPO_DATA('gdelrosal','4','04048','04280'),
		T_TIPO_DATA('gdelrosal','4','04048','04000'),
		T_TIPO_DATA('gdelrosal','4','04045','04500'),
		T_TIPO_DATA('gdelrosal','4','04044','04869'),
		T_TIPO_DATA('gdelrosal','4','04044','04897'),
		T_TIPO_DATA('gdelrosal','4','04043','04279'),
		T_TIPO_DATA('gdelrosal','4','04035','04610'),
		T_TIPO_DATA('gdelrosal','4','04035','04617'),
		T_TIPO_DATA('gdelrosal','4','04035','04618'),
		T_TIPO_DATA('gdelrosal','4','04035','04619'),
		T_TIPO_DATA('gdelrosal','4','04034','04000'),
		T_TIPO_DATA('gdelrosal','4','04037','04825'),
		T_TIPO_DATA('gdelrosal','4','04036','04859'),
		T_TIPO_DATA('gdelrosal','4','04032','04140'),
		T_TIPO_DATA('gdelrosal','4','04031','04000'),
		T_TIPO_DATA('gdelrosal','4','04031','04850'),
		T_TIPO_DATA('gdelrosal','4','04031','04815'),
		T_TIPO_DATA('gdelrosal','4','04027','04274'),
		T_TIPO_DATA('gdelrosal','4','04027','04276'),
		T_TIPO_DATA('gdelrosal','4','04024','04410'),
		T_TIPO_DATA('gdelrosal','4','04022','04288'),
		T_TIPO_DATA('gdelrosal','4','04017','04660'),
		T_TIPO_DATA('gdelrosal','4','04016','04628'),
		T_TIPO_DATA('gdelrosal','4','04016','04629'),
		T_TIPO_DATA('gdelrosal','4','04010','04567'),
		T_TIPO_DATA('gdelrosal','4','04009','04009'),
		T_TIPO_DATA('gdelrosal','4','04007','04480'),
		T_TIPO_DATA('gdelrosal','4','04006','04800'),
		T_TIPO_DATA('gdelrosal','4','04006','04814'),
		T_TIPO_DATA('gdelrosal','4','04004','04857')); 
    V_TMP_TIPO_DATA T_TIPO_DATA;
    
BEGIN	
	
	DBMS_OUTPUT.PUT_LINE('[INICIO] ');
	
    DBMS_OUTPUT.PUT_LINE('[INFO]: INSERCION EN '||V_ESQUEMA||'.'||V_TEXT_TABLA);
    FOR I IN V_TIPO_DATA.FIRST .. V_TIPO_DATA.LAST
		LOOP
      
			V_TMP_TIPO_DATA := V_TIPO_DATA(I);
    
			V_MSQL := 'SELECT '|| V_ESQUEMA ||'.S_'||V_TEXT_TABLA||'.NEXTVAL FROM DUAL';
			EXECUTE IMMEDIATE V_MSQL INTO V_ID;	
          
			V_MSQL := 'INSERT INTO '|| V_ESQUEMA ||'.'||V_TEXT_TABLA||'
                      	(ID, 
                      	TIPO_GESTOR, 
                      	COD_CARTERA, 
                      	USERNAME,
                      	COD_PROVINCIA, 
                      	COD_MUNICIPIO, 
                      	COD_POSTAL,  
                      	NOMBRE_USUARIO, 
                      	VERSION, 
                      	USUARIOCREAR, 
                      	FECHACREAR, 
                      	BORRADO) 
                      	SELECT '|| V_ID ||',
                      	''HAYAGBOINM'', 
						1,
						'''||TRIM(V_TMP_TIPO_DATA(1))||''',
						'''||TRIM(V_TMP_TIPO_DATA(2))||''',
						'''||TRIM(V_TMP_TIPO_DATA(3))||''', 
						'''||TRIM(V_TMP_TIPO_DATA(4))||''', 
						(SELECT USU.USU_NOMBRE ||'' ''|| USU.USU_APELLIDO1 ||'' ''|| USU.USU_APELLIDO2 
							FROM '|| V_ESQUEMA_M ||'.USU_USUARIOS USU 
							WHERE USU.USU_USERNAME = '''||TRIM(V_TMP_TIPO_DATA(1))||'''),
						 0,
						 '''||V_USU||''',
						 SYSDATE,
						 0 FROM DUAL';
			
			EXECUTE IMMEDIATE V_MSQL;
			DBMS_OUTPUT.PUT_LINE('[INFO]: INSERT CORRECTO PARA COD PROVINCIA: '''|| TRIM(V_TMP_TIPO_DATA(2)) ||'''');

		END LOOP;
    COMMIT;
    DBMS_OUTPUT.PUT_LINE('[FIN]: TABLA '||V_TEXT_TABLA||' ACTUALIZADA CORRECTAMENTE ');


EXCEPTION
     WHEN OTHERS THEN
          err_num := SQLCODE;
          err_msg := SQLERRM;

          DBMS_OUTPUT.put_line('[ERROR] Se ha producido un error en la ejecución:'||TO_CHAR(err_num));
          DBMS_OUTPUT.put_line('-----------------------------------------------------------'); 
          DBMS_OUTPUT.put_line(err_msg);

          ROLLBACK;
          RAISE;          

END;
/

EXIT
