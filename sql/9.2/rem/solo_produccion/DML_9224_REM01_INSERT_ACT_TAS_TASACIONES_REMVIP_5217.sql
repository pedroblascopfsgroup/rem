--/*
--##########################################
--## AUTOR=Viorel Remus Ovidiu
--## FECHA_CREACION=20190910
--## ARTEFACTO=online
--## VERSION_ARTEFACTO=9.2
--## INCIDENCIA_LINK=REMVIP-5217
--## PRODUCTO=NO
--## 
--## Finalidad: Script que añade en ACT_TAS_TASACION los datos añadidos en T_ARRAY_DATA
--## INSTRUCCIONES:
--## VERSIONES:
--##        0.1 Versión inicial
--##########################################
--*/


WHENEVER SQLERROR EXIT SQL.SQLCODE;
SET SERVEROUTPUT ON; 
SET DEFINE OFF;


DECLARE
        V_SQL VARCHAR2(32000 CHAR); -- Sentencia a ejecutar         
    V_ESQUEMA VARCHAR2(25 CHAR):= '#ESQUEMA#'; -- Configuracion Esquema
    V_ESQUEMA_M VARCHAR2(25 CHAR):= '#ESQUEMA_MASTER#'; -- Configuracion Esquema Master
    V_TABLA_1 VARCHAR2(25 CHAR):= 'BIE_VALORACIONES';
    V_TABLA_2 VARCHAR2(25 CHAR):= 'ACT_TAS_TASACION';
    V_TABLA_3 VARCHAR2(25 CHAR):= 'BIE_DATOS_REGISTRALES';
    V_COUNT NUMBER(16); -- Vble. para contar.
    V_KOUNT NUMBER(16); -- Vble. para kontar.
    V_COUNT_UPDATE NUMBER(16):= 0; -- Vble. para contar updates
    ERR_NUM NUMBER(25);  -- Vble. auxiliar para registrar errores en el script.
    ERR_MSG VARCHAR2(1024 CHAR); -- Vble. auxiliar para registrar errores en el script.

	ACT_NUM_ACTIVO NUMBER(16);
	ACT_ID NUMBER(16);
	NUM_SECUENCIA_VAL NUMBER(16);
	NUM_SECUENCIA_TAS NUMBER(16);
	BIE_ID NUMBER(16);

    V_USUARIO VARCHAR2(50 CHAR) := 'REMVIP-5217';    
    
    TYPE T_TIPO_DATA IS TABLE OF VARCHAR2(150);
    TYPE T_ARRAY_DATA IS TABLE OF T_TIPO_DATA;
    V_TIPO_DATA T_ARRAY_DATA := T_ARRAY_DATA(
    			-- NUM_ACT	NºFINCA 	FECHA_TAS	IMPORTE_TAS		TASADORA
		T_TIPO_DATA('6044007','','14/08/2019',' 85816.31','ARCO VALORACIONES'),
		T_TIPO_DATA('6044008','','14/08/2019',' 105208.08','ARCO VALORACIONES'),
		T_TIPO_DATA('6044009','','15/07/2019',' 120912.95','ARCO VALORACIONES'),
		T_TIPO_DATA('6044010','','19/07/2019',' 112950.70','ARCO VALORACIONES'),
		T_TIPO_DATA('6044012','','14/08/2019',' 58851.24','ARCO VALORACIONES'),
		T_TIPO_DATA('6044013','','15/07/2019',' 51492.80','ARCO VALORACIONES'),
		T_TIPO_DATA('6044016','','26/07/2019',' 110221.50','ARCO VALORACIONES'),
		T_TIPO_DATA('6044019','','14/08/2019',' 158046.68','ARCO VALORACIONES'),
		T_TIPO_DATA('6044020','','15/07/2019',' 111715.70','ARCO VALORACIONES'),
		T_TIPO_DATA('6044021','','15/07/2019',' 33461.85','ARCO VALORACIONES'),
		T_TIPO_DATA('6044024','','14/08/2019',' 122554.69','ARCO VALORACIONES'),
		T_TIPO_DATA('6044030','','14/08/2019',' 342744.74','ARCO VALORACIONES'),
		T_TIPO_DATA('6044032','','19/07/2019',' 125777.93','ARCO VALORACIONES'),
		T_TIPO_DATA('6044034','','19/07/2019',' 167490.67','ARCO VALORACIONES'),
		T_TIPO_DATA('6044042','','15/07/2019',' 68152.19','ARCO VALORACIONES'),
		T_TIPO_DATA('6044045','','14/08/2019',' 76403.82','ARCO VALORACIONES'),
		T_TIPO_DATA('6044047','','30/08/2019',' 175254.34','ARCO VALORACIONES'),
		T_TIPO_DATA('6044059','','30/08/2019',' 102243.40','ARCO VALORACIONES'),
		T_TIPO_DATA('6044061','','15/07/2019',' 28209.36','ARCO VALORACIONES'),
		T_TIPO_DATA('6044070','','18/07/2019',' 57531.48','ARCO VALORACIONES'),
		T_TIPO_DATA('6044071','','19/07/2019',' 148726.56','ARCO VALORACIONES'),
		T_TIPO_DATA('6044079','','14/08/2019',' 97327.06','ARCO VALORACIONES'),
		T_TIPO_DATA('6044080','','19/07/2019',' 109720.20','ARCO VALORACIONES'),
		T_TIPO_DATA('6044082','','30/08/2019',' 111406.55','ARCO VALORACIONES'),
		T_TIPO_DATA('6044083','','14/08/2019',' 137675.96','ARCO VALORACIONES'),
		T_TIPO_DATA('6044088','','15/07/2019',' 270659.06','ARCO VALORACIONES'),
		T_TIPO_DATA('6044089','','15/07/2019',' 124819.43','ARCO VALORACIONES'),
		T_TIPO_DATA('6044092','','19/07/2019',' 59059.67','ARCO VALORACIONES'),
		T_TIPO_DATA('6044098','','26/07/2019',' 19131.05','ARCO VALORACIONES'),
		T_TIPO_DATA('6044103','','19/07/2019',' 89066.09','ARCO VALORACIONES'),
		T_TIPO_DATA('6044104','','14/08/2019',' 79249.69','ARCO VALORACIONES'),
		T_TIPO_DATA('6044105','','14/08/2019',' 77604.17','ARCO VALORACIONES'),
		T_TIPO_DATA('6044111','','26/07/2019',' 178436.85','ARCO VALORACIONES'),
		T_TIPO_DATA('6044112','','15/07/2019',' 75122.48','ARCO VALORACIONES'),
		T_TIPO_DATA('6044116','','19/07/2019',' 151719.28','ARCO VALORACIONES'),
		T_TIPO_DATA('6044123','','15/07/2019',' 168421.61','ARCO VALORACIONES'),
		T_TIPO_DATA('6044162','','18/07/2019',' 106966.92','ARCO VALORACIONES'),
		T_TIPO_DATA('6044168','','14/08/2019',' 97813.47','ARCO VALORACIONES'),
		T_TIPO_DATA('6044170','','15/07/2019',' 91409.60','ARCO VALORACIONES'),
		T_TIPO_DATA('6044179','','15/07/2019',' 115544.34','ARCO VALORACIONES'),
		T_TIPO_DATA('6044180','','15/07/2019',' 119201.90','ARCO VALORACIONES'),
		T_TIPO_DATA('6044181','','26/07/2019',' 74449.65','ARCO VALORACIONES'),
		T_TIPO_DATA('6044182','','09/08/2019',' 7840.07','ARCO VALORACIONES'),
		T_TIPO_DATA('6044187','','14/08/2019',' 61939.23','ARCO VALORACIONES'),
		T_TIPO_DATA('6044188','','15/07/2019',' 227839.64','ARCO VALORACIONES'),
		T_TIPO_DATA('6044189','','15/07/2019',' 13945.67','ARCO VALORACIONES'),
		T_TIPO_DATA('6044190','','14/08/2019',' 78938.16','ARCO VALORACIONES'),
		T_TIPO_DATA('6044191','','14/08/2019',' 78616.21','ARCO VALORACIONES'),
		T_TIPO_DATA('6044201','','26/07/2019',' 250792.19','ARCO VALORACIONES'),
		T_TIPO_DATA('6044204','','15/07/2019',' 334804.45','ARCO VALORACIONES'),
		T_TIPO_DATA('6044207','','14/08/2019',' 12064.64','ARCO VALORACIONES'),
		T_TIPO_DATA('6044208','','26/07/2019',' 185478.71','ARCO VALORACIONES'),
		T_TIPO_DATA('6044214','','14/08/2019',' 116089.39','ARCO VALORACIONES'),
		T_TIPO_DATA('6044220','','14/08/2019',' 168771.14','ARCO VALORACIONES'),
		T_TIPO_DATA('6044221','','14/08/2019',' 105879.80','ARCO VALORACIONES'),
		T_TIPO_DATA('6044224','','15/07/2019',' 169562.00','ARCO VALORACIONES'),
		T_TIPO_DATA('6044225','','14/08/2019',' 124885.13','ARCO VALORACIONES'),
		T_TIPO_DATA('6044226','','26/07/2019',' 67755.74','ARCO VALORACIONES'),
		T_TIPO_DATA('6044230','','26/07/2019',' 117011.43','ARCO VALORACIONES'),
		T_TIPO_DATA('6044233','','14/08/2019',' 34149.23','ARCO VALORACIONES'),
		T_TIPO_DATA('6044234','','19/07/2019',' 157154.43','ARCO VALORACIONES'),
		T_TIPO_DATA('6044248','','26/07/2019',' 145961.02','ARCO VALORACIONES'),
		T_TIPO_DATA('6044259','','26/07/2019',' 83345.43','ARCO VALORACIONES'),
		T_TIPO_DATA('6044260','','30/08/2019',' 41483.32','ARCO VALORACIONES'),
		T_TIPO_DATA('6044266','','14/08/2019',' 135973.13','ARCO VALORACIONES'),
		T_TIPO_DATA('6044271','','15/07/2019',' 114403.33','ARCO VALORACIONES'),
		T_TIPO_DATA('6044275','','19/07/2019',' 83481.45','ARCO VALORACIONES'),
		T_TIPO_DATA('6044277','','26/07/2019',' 62142.14','ARCO VALORACIONES'),
		T_TIPO_DATA('6044278','','15/07/2019',' 113039.47','ARCO VALORACIONES'),
		T_TIPO_DATA('6044281','','14/08/2019',' 78616.21','ARCO VALORACIONES'),
		T_TIPO_DATA('6044284','','18/07/2019',' 142216.84','ARCO VALORACIONES'),
		T_TIPO_DATA('6044292','','18/07/2019',' 103220.09','ARCO VALORACIONES'),
		T_TIPO_DATA('6044293','','15/07/2019',' 74017.74','ARCO VALORACIONES'),
		T_TIPO_DATA('6044294','','14/08/2019',' 308812.99','ARCO VALORACIONES'),
		T_TIPO_DATA('6044296','','26/07/2019',' 326629.95','ARCO VALORACIONES'),
		T_TIPO_DATA('6044298','','14/08/2019',' 264890.12','ARCO VALORACIONES'),
		T_TIPO_DATA('6044301','','19/07/2019',' 448220.49','ARCO VALORACIONES'),
		T_TIPO_DATA('6044306','','14/08/2019',' 260967.49','ARCO VALORACIONES'),
		T_TIPO_DATA('6044308','','30/08/2019',' 185907.64','ARCO VALORACIONES'),
		T_TIPO_DATA('6044309','','14/08/2019',' 113244.06','ARCO VALORACIONES'),
		T_TIPO_DATA('6044315','','15/07/2019',' 150933.71','ARCO VALORACIONES'),
		T_TIPO_DATA('6044317','','15/07/2019',' 230333.37','ARCO VALORACIONES'),
		T_TIPO_DATA('6044318','','15/07/2019',' 64192.31','ARCO VALORACIONES'),
		T_TIPO_DATA('6044319','','19/07/2019',' 56293.30','ARCO VALORACIONES'),
		T_TIPO_DATA('6044321','','15/07/2019',' 103265.12','ARCO VALORACIONES'),
		T_TIPO_DATA('6044322','','19/07/2019',' 79945.57','ARCO VALORACIONES'),
		T_TIPO_DATA('6044325','','15/07/2019',' 49477.08','ARCO VALORACIONES'),
		T_TIPO_DATA('6084916','','18/07/2019',' 87832.86','ARCO VALORACIONES'),
		T_TIPO_DATA('6084924','','18/07/2019',' 94016.69','ARCO VALORACIONES'),
		T_TIPO_DATA('6084929','','15/07/2019',' 54533.56','ARCO VALORACIONES'),
		T_TIPO_DATA('6084930','','15/07/2019',' 44664.28','ARCO VALORACIONES'),
		T_TIPO_DATA('6084931','','18/07/2019',' 100339.24','ARCO VALORACIONES'),
		T_TIPO_DATA('6084935','','14/08/2019',' 88798.73','ARCO VALORACIONES'),
		T_TIPO_DATA('6084941','','15/07/2019',' 306620.95','ARCO VALORACIONES'),
		T_TIPO_DATA('6084942','','15/07/2019',' 312221.46','ARCO VALORACIONES'),
		T_TIPO_DATA('6084947','','26/07/2019',' 223699.29','ARCO VALORACIONES'),
		T_TIPO_DATA('6084948','','14/08/2019',' 124278.11','ARCO VALORACIONES'),
		T_TIPO_DATA('6084949','','19/07/2019',' 443275.07','ARCO VALORACIONES'),
		T_TIPO_DATA('6084954','','15/07/2019',' 115672.51','ARCO VALORACIONES'),
		T_TIPO_DATA('6084959','','15/07/2019',' 119858.49','ARCO VALORACIONES'),
		T_TIPO_DATA('6084964','','15/07/2019',' 128590.86','ARCO VALORACIONES'),
		T_TIPO_DATA('6084965','','15/07/2019',' 1234.69','ARCO VALORACIONES'),
		T_TIPO_DATA('6084966','','15/07/2019',' 10442.14','ARCO VALORACIONES'),
		T_TIPO_DATA('6084970','','31/07/2019',' 247615.44','ARCO VALORACIONES'),
		T_TIPO_DATA('6084980','','19/07/2019',' 68569.69','ARCO VALORACIONES'),
		T_TIPO_DATA('6084986','','14/08/2019',' 116010.76','ARCO VALORACIONES'),
		T_TIPO_DATA('6084990','','19/07/2019',' 34564.89','ARCO VALORACIONES'),
		T_TIPO_DATA('6084991','','19/07/2019',' 93608.97','ARCO VALORACIONES'),
		T_TIPO_DATA('6084992','','19/07/2019',' 101804.67','ARCO VALORACIONES'),
		T_TIPO_DATA('6084994','','15/07/2019',' 50524.13','ARCO VALORACIONES'),
		T_TIPO_DATA('6085003','','19/07/2019',' 295145.82','ARCO VALORACIONES'),
		T_TIPO_DATA('6085004','','14/08/2019',' 46065.13','ARCO VALORACIONES'),
		T_TIPO_DATA('6127802','','19/07/2019',' 114053.89','ARCO VALORACIONES'),
		T_TIPO_DATA('6129203','','15/07/2019',' 114583.36','ARCO VALORACIONES'),
		T_TIPO_DATA('6525061','','26/07/2019',' 57208.11','ARCO VALORACIONES'),
		T_TIPO_DATA('6762165','','14/08/2019',' 58494.13','ARCO VALORACIONES'),
		T_TIPO_DATA('6762167','','30/08/2019',' 454363.38','ARCO VALORACIONES'),
		T_TIPO_DATA('6762169','','30/08/2019',' 6643.34','ARCO VALORACIONES'),
		T_TIPO_DATA('6762171','','30/08/2019',' 6643.34','ARCO VALORACIONES'),
		T_TIPO_DATA('6762172','','14/08/2019',' 47391.12','ARCO VALORACIONES'),
		T_TIPO_DATA('6762173','','30/08/2019',' 68580.03','ARCO VALORACIONES'),
		T_TIPO_DATA('6762174','','30/08/2019',' 779.70','ARCO VALORACIONES'),
		T_TIPO_DATA('6762175','','14/08/2019',' 5997.80','ARCO VALORACIONES'),
		T_TIPO_DATA('6762179','','14/08/2019',' 6177.03','ARCO VALORACIONES'),
		T_TIPO_DATA('6762182','','14/08/2019',' 6107.09','ARCO VALORACIONES'),
		T_TIPO_DATA('6762184','','14/08/2019',' 6177.03','ARCO VALORACIONES'),
		T_TIPO_DATA('6762187','','14/08/2019',' 6177.03','ARCO VALORACIONES'),
		T_TIPO_DATA('6762188','','26/07/2019',' 463493.67','ARCO VALORACIONES'),
		T_TIPO_DATA('6762189','','30/08/2019',' 31450.44','ARCO VALORACIONES'),
		T_TIPO_DATA('6762190','','15/07/2019',' 29705.85','ARCO VALORACIONES'),
		T_TIPO_DATA('6762191','','14/08/2019',' 6043.70','ARCO VALORACIONES'),
		T_TIPO_DATA('6762192','','30/08/2019',' 31450.44','ARCO VALORACIONES'),
		T_TIPO_DATA('6762194','','14/08/2019',' 6043.70','ARCO VALORACIONES'),
		T_TIPO_DATA('6762196','','30/08/2019',' 75522.34','ARCO VALORACIONES'),
		T_TIPO_DATA('6762198','','26/07/2019',' 76655.15','ARCO VALORACIONES'),
		T_TIPO_DATA('6762199','','15/07/2019',' 57729.49','ARCO VALORACIONES'),
		T_TIPO_DATA('6762200','','02/08/2019',' 94935.82','ARCO VALORACIONES'),
		T_TIPO_DATA('6762202','','19/07/2019',' 106750.01','ARCO VALORACIONES'),
		T_TIPO_DATA('6762203','','26/07/2019',' 23874.31','ARCO VALORACIONES'),
		T_TIPO_DATA('6762208','','15/07/2019',' 21685.10','ARCO VALORACIONES'),
		T_TIPO_DATA('6762209','','15/07/2019',' 87088.91','ARCO VALORACIONES'),
		T_TIPO_DATA('6762210','','19/07/2019',' 55902.42','ARCO VALORACIONES'),
		T_TIPO_DATA('6762211','','26/07/2019',' 2038.40','ARCO VALORACIONES'),
		T_TIPO_DATA('6762212','','14/08/2019',' 77849.62','ARCO VALORACIONES'),
		T_TIPO_DATA('6762214','','14/08/2019',' 5935.38','ARCO VALORACIONES'),
		T_TIPO_DATA('6762215','','15/07/2019',' 50238.48','ARCO VALORACIONES'),
		T_TIPO_DATA('6762216','','30/08/2019',' 41204.02','ARCO VALORACIONES'),
		T_TIPO_DATA('6762217','','14/08/2019',' 5995.61','ARCO VALORACIONES'),
		T_TIPO_DATA('6762220','','14/08/2019',' 127824.79','ARCO VALORACIONES'),
		T_TIPO_DATA('6762221','','14/08/2019',' 92131.91','ARCO VALORACIONES'),
		T_TIPO_DATA('6762222','','14/08/2019',' 6043.70','ARCO VALORACIONES'),
		T_TIPO_DATA('6762223','','15/07/2019',' 97877.67','ARCO VALORACIONES'),
		T_TIPO_DATA('6762224','','14/08/2019',' 392655.19','ARCO VALORACIONES'),
		T_TIPO_DATA('6762225','','19/07/2019',' 181514.10','ARCO VALORACIONES'),
		T_TIPO_DATA('6762226','','14/08/2019',' 75090.72','ARCO VALORACIONES'),
		T_TIPO_DATA('6762227','','26/07/2019',' 13862.72','ARCO VALORACIONES'),
		T_TIPO_DATA('6762228','','15/07/2019',' 122614.68','ARCO VALORACIONES'),
		T_TIPO_DATA('6762230','','15/07/2019',' 58330.35','ARCO VALORACIONES'),
		T_TIPO_DATA('6762231','','26/07/2019',' 65423.09','ARCO VALORACIONES'),
		T_TIPO_DATA('6762233','','26/07/2019',' 6624.70','ARCO VALORACIONES'),
		T_TIPO_DATA('6762237','','14/08/2019',' 109949.21','ARCO VALORACIONES'),
		T_TIPO_DATA('6762239','','19/07/2019',' 39689.50','ARCO VALORACIONES'),
		T_TIPO_DATA('6762240','','30/08/2019',' 62182.86','ARCO VALORACIONES'),
		T_TIPO_DATA('6762243','','31/07/2019',' 159417.65','ARCO VALORACIONES'),
		T_TIPO_DATA('6762247','','15/07/2019',' 120119.75','ARCO VALORACIONES'),
		T_TIPO_DATA('6762249','','19/07/2019',' 67852.92','ARCO VALORACIONES'),
		T_TIPO_DATA('6762252','','14/08/2019',' 38855.78','ARCO VALORACIONES'),
		T_TIPO_DATA('6762256','','19/07/2019',' 124130.23','ARCO VALORACIONES'),
		T_TIPO_DATA('6762258','','15/07/2019',' 159165.66','ARCO VALORACIONES'),
		T_TIPO_DATA('6762260','','15/07/2019',' 53847.31','ARCO VALORACIONES'),
		T_TIPO_DATA('6762264','','15/07/2019',' 159586.08','ARCO VALORACIONES'),
		T_TIPO_DATA('6762265','','15/07/2019',' 111709.11','ARCO VALORACIONES'),
		T_TIPO_DATA('6762267','','15/07/2019',' 113563.08','ARCO VALORACIONES'),
		T_TIPO_DATA('6762268','','19/07/2019',' 20747.72','ARCO VALORACIONES'),
		T_TIPO_DATA('6762269','','14/08/2019',' 5401.08','ARCO VALORACIONES'),
		T_TIPO_DATA('6762271','','26/07/2019',' 106701.68','ARCO VALORACIONES'),
		T_TIPO_DATA('6762272','','19/07/2019',' 228629.42','ARCO VALORACIONES'),
		T_TIPO_DATA('6762273','','19/07/2019',' 96680.04','ARCO VALORACIONES'),
		T_TIPO_DATA('6762277','','14/08/2019',' 116083.80','ARCO VALORACIONES'),
		T_TIPO_DATA('6762279','','15/07/2019',' 117710.84','ARCO VALORACIONES'),
		T_TIPO_DATA('6762281','','15/07/2019',' 158524.76','ARCO VALORACIONES'),
		T_TIPO_DATA('6762291','','15/07/2019',' 47733.15','ARCO VALORACIONES'),
		T_TIPO_DATA('6762295','','15/07/2019',' 134067.05','ARCO VALORACIONES'),
		T_TIPO_DATA('6762296','','14/08/2019',' 90147.74','ARCO VALORACIONES'),
		T_TIPO_DATA('6762301','','14/08/2019',' 81200.12','ARCO VALORACIONES'),
		T_TIPO_DATA('6762302','','14/08/2019',' 89836.88','ARCO VALORACIONES'),
		T_TIPO_DATA('6762303','','26/07/2019',' 5995.61','ARCO VALORACIONES'),
		T_TIPO_DATA('6762305','','15/07/2019',' 59544.53','ARCO VALORACIONES'),
		T_TIPO_DATA('6762307','','14/08/2019',' 107015.53','ARCO VALORACIONES'),
		T_TIPO_DATA('6762308','','30/08/2019',' 36279.21','ARCO VALORACIONES'),
		T_TIPO_DATA('6762309','','14/08/2019',' 6177.03','ARCO VALORACIONES'),
		T_TIPO_DATA('6762310','','14/08/2019',' 187286.12','ARCO VALORACIONES'),
		T_TIPO_DATA('6762311','','14/08/2019',' 5851.35','ARCO VALORACIONES'),
		T_TIPO_DATA('6762312','','30/08/2019',' 30370.63','ARCO VALORACIONES'),
		T_TIPO_DATA('6762313','','26/07/2019',' 175810.94','ARCO VALORACIONES'),
		T_TIPO_DATA('6762314','','14/08/2019',' 9982.40','ARCO VALORACIONES'),
		T_TIPO_DATA('6762315','','26/07/2019',' 5851.35','ARCO VALORACIONES'),
		T_TIPO_DATA('6762317','','15/07/2019',' 185944.52','ARCO VALORACIONES'),
		T_TIPO_DATA('6762318','','15/07/2019',' 198433.69','ARCO VALORACIONES'),
		T_TIPO_DATA('6762319','','26/07/2019',' 16059.02','ARCO VALORACIONES'),
		T_TIPO_DATA('6762320','','26/07/2019',' 128649.94','ARCO VALORACIONES'),
		T_TIPO_DATA('6762324','','30/08/2019',' 139468.04','ARCO VALORACIONES'),
		T_TIPO_DATA('6762326','','14/08/2019',' 43216.08','ARCO VALORACIONES'),
		T_TIPO_DATA('6762335','','26/07/2019',' 97214.27','ARCO VALORACIONES'),
		T_TIPO_DATA('6762336','','15/07/2019',' 239432.21','ARCO VALORACIONES'),
		T_TIPO_DATA('6762339','','14/08/2019',' 183731.25','ARCO VALORACIONES'),
		T_TIPO_DATA('6762342','','30/08/2019',' 137457.33','ARCO VALORACIONES'),
		T_TIPO_DATA('6762345','','15/07/2019',' 179813.24','ARCO VALORACIONES'),
		T_TIPO_DATA('6762346','','15/07/2019',' 201932.40','ARCO VALORACIONES'),
		T_TIPO_DATA('6762348','','02/08/2019',' 54745.18','ARCO VALORACIONES'),
		T_TIPO_DATA('6762349','','15/07/2019',' 70852.91','ARCO VALORACIONES'),
		T_TIPO_DATA('6762350','','14/08/2019',' 94102.90','ARCO VALORACIONES'),
		T_TIPO_DATA('6762353','','15/07/2019',' 118248.57','ARCO VALORACIONES'),
		T_TIPO_DATA('6762355','','14/08/2019',' 6043.70','ARCO VALORACIONES'),
		T_TIPO_DATA('6762356','','14/08/2019',' 27625.12','ARCO VALORACIONES'),
		T_TIPO_DATA('6762357','','14/08/2019',' 6043.70','ARCO VALORACIONES'),
		T_TIPO_DATA('6762358','','14/08/2019',' 31690.78','ARCO VALORACIONES'),
		T_TIPO_DATA('6762361','','14/08/2019',' 6177.03','ARCO VALORACIONES'),
		T_TIPO_DATA('6762362','','14/08/2019',' 70229.37','ARCO VALORACIONES'),
		T_TIPO_DATA('6762369','','14/08/2019',' 174838.86','ARCO VALORACIONES'),
		T_TIPO_DATA('6762370','','14/08/2019',' 42192.18','ARCO VALORACIONES'),
		T_TIPO_DATA('6762371','','14/08/2019',' 24822.18','ARCO VALORACIONES'),
		T_TIPO_DATA('6762373','','14/08/2019',' 6087.41','ARCO VALORACIONES'),
		T_TIPO_DATA('6762375','','15/07/2019',' 59551.75','ARCO VALORACIONES'),
		T_TIPO_DATA('6762377','','02/08/2019',' 60379.98','ARCO VALORACIONES'),
		T_TIPO_DATA('6762379','','14/08/2019',' 38036.87','ARCO VALORACIONES'),
		T_TIPO_DATA('6762380','','30/08/2019',' 36191.67','ARCO VALORACIONES'),
		T_TIPO_DATA('6762383','','14/08/2019',' 5945.34','ARCO VALORACIONES'),
		T_TIPO_DATA('6762384','','14/08/2019',' 102992.33','ARCO VALORACIONES'),
		T_TIPO_DATA('6762385','','26/07/2019',' 110706.53','ARCO VALORACIONES'),
		T_TIPO_DATA('6762386','','30/08/2019',' 118858.64','ARCO VALORACIONES'),
		T_TIPO_DATA('6762387','','15/07/2019',' 101650.00','ARCO VALORACIONES'),
		T_TIPO_DATA('6762389','','19/07/2019',' 429110.17','ARCO VALORACIONES'),
		T_TIPO_DATA('6762390','','26/07/2019',' 63756.33','ARCO VALORACIONES'),
		T_TIPO_DATA('6762392','','26/07/2019',' 6083.04','ARCO VALORACIONES'),
		T_TIPO_DATA('6762395','','30/08/2019',' 102442.53','ARCO VALORACIONES'),
		T_TIPO_DATA('6762399','','15/07/2019',' 84601.34','ARCO VALORACIONES'),
		T_TIPO_DATA('6762400','','15/07/2019',' 83899.30','ARCO VALORACIONES'),
		T_TIPO_DATA('6762401','','26/07/2019',' 52961.32','ARCO VALORACIONES'),
		T_TIPO_DATA('6762402','','14/08/2019',' 194184.33','ARCO VALORACIONES'),
		T_TIPO_DATA('6764233','','15/07/2019',' 110016.34','ARCO VALORACIONES'),
		T_TIPO_DATA('6767799','','15/07/2019',' 174578.33','ARCO VALORACIONES'),
		T_TIPO_DATA('6767808','','15/07/2019',' 70981.00','ARCO VALORACIONES'),
		T_TIPO_DATA('6767940','','19/07/2019',' 119750.79','ARCO VALORACIONES'),
		T_TIPO_DATA('6775896','','14/08/2019',' 49945.93','ARCO VALORACIONES'),
		T_TIPO_DATA('6775897','','30/08/2019',' 61123.61','ARCO VALORACIONES'),
		T_TIPO_DATA('6775901','','30/08/2019',' 6107.09','ARCO VALORACIONES'),
		T_TIPO_DATA('6775906','','15/07/2019',' 69328.40','ARCO VALORACIONES'),
		T_TIPO_DATA('6775911','','14/08/2019',' 6107.09','ARCO VALORACIONES'),
		T_TIPO_DATA('6775915','','14/08/2019',' 6137.69','ARCO VALORACIONES'),
		T_TIPO_DATA('6775916','','30/08/2019',' 6107.09','ARCO VALORACIONES'),
		T_TIPO_DATA('6775918','','30/08/2019',' 33838.61','ARCO VALORACIONES'),
		T_TIPO_DATA('6775922','','14/08/2019',' 6107.09','ARCO VALORACIONES'),
		T_TIPO_DATA('6776330','','14/08/2019',' 102145.28','ARCO VALORACIONES'),
		T_TIPO_DATA('6800124','','14/08/2019',' 8567.14','ARCO VALORACIONES'),
		T_TIPO_DATA('6800131','','18/07/2019',' 321775.34','ARCO VALORACIONES'),
		T_TIPO_DATA('6803464','','14/08/2019',' 5637.14','ARCO VALORACIONES'),
		T_TIPO_DATA('6810469','','15/07/2019',' 91853.64','ARCO VALORACIONES'),
		T_TIPO_DATA('6813871','','19/07/2019',' 111247.36','ARCO VALORACIONES'),
		T_TIPO_DATA('6814469','','14/08/2019',' 212735.81','ARCO VALORACIONES'),
		T_TIPO_DATA('6815902','','15/07/2019',' 122241.11','ARCO VALORACIONES'),
		T_TIPO_DATA('6817106','','14/08/2019',' 164244.58','ARCO VALORACIONES'),
		T_TIPO_DATA('6817109','','19/07/2019',' 132960.66','ARCO VALORACIONES'),
		T_TIPO_DATA('6826980','','30/08/2019',' 41875.66','ARCO VALORACIONES'),
		T_TIPO_DATA('6826983','','14/08/2019',' 6137.69','ARCO VALORACIONES'),
		T_TIPO_DATA('6828850','','26/07/2019',' 84836.40','ARCO VALORACIONES'),
		T_TIPO_DATA('6831681','','14/08/2019',' 5807.40','ARCO VALORACIONES'),
		T_TIPO_DATA('6831684','','15/07/2019',' 90407.95','ARCO VALORACIONES'),
		T_TIPO_DATA('6831689','','14/08/2019',' 87642.65','ARCO VALORACIONES'),
		T_TIPO_DATA('6831762','','18/07/2019',' 83561.15','ARCO VALORACIONES'),
		T_TIPO_DATA('6840015','','14/08/2019',' 6137.69','ARCO VALORACIONES'),
		T_TIPO_DATA('6840016','','14/08/2019',' 6107.09','ARCO VALORACIONES'),
		T_TIPO_DATA('6840018','','14/08/2019',' 35496.07','ARCO VALORACIONES'),
		T_TIPO_DATA('6840019','','14/08/2019',' 36150.32','ARCO VALORACIONES'),
		T_TIPO_DATA('6840020','','14/08/2019',' 6107.09','ARCO VALORACIONES'),
		T_TIPO_DATA('6840022','','30/08/2019',' 58853.55','ARCO VALORACIONES'),
		T_TIPO_DATA('6841482','','15/07/2019',' 207304.56','ARCO VALORACIONES'),
		T_TIPO_DATA('6950335','','30/08/2019',' 8315.25','ARCO VALORACIONES'),
		T_TIPO_DATA('6950336','','30/08/2019',' 8315.25','ARCO VALORACIONES'),
		T_TIPO_DATA('6950337','','30/08/2019',' 8315.25','ARCO VALORACIONES'),
		T_TIPO_DATA('6950339','','26/07/2019',' 42601.73','ARCO VALORACIONES'),
		T_TIPO_DATA('6950340','','26/07/2019',' 7987.04','ARCO VALORACIONES'),
		T_TIPO_DATA('6950341','','26/07/2019',' 30448.63','ARCO VALORACIONES'),
		T_TIPO_DATA('6950343','','14/08/2019',' 59133.42','ARCO VALORACIONES'),
		T_TIPO_DATA('6950344','','15/07/2019',' 110931.31','ARCO VALORACIONES'),
		T_TIPO_DATA('6950345','','15/07/2019',' 96687.34','ARCO VALORACIONES'),
		T_TIPO_DATA('6950346','','19/07/2019',' 5302.96','ARCO VALORACIONES'),
		T_TIPO_DATA('6950347','','14/08/2019',' 482380.20','ARCO VALORACIONES'),
		T_TIPO_DATA('6962192','','14/08/2019',' 82513.93','ARCO VALORACIONES'),
		T_TIPO_DATA('6962193','','14/08/2019',' 8566.43','ARCO VALORACIONES'),
		T_TIPO_DATA('6962194','','30/08/2019',' 30643.24','ARCO VALORACIONES'),
		T_TIPO_DATA('6962195','','14/08/2019',' 5851.35','ARCO VALORACIONES'),
		T_TIPO_DATA('6962196','','26/07/2019',' 50594.85','ARCO VALORACIONES'),
		T_TIPO_DATA('6962197','','26/07/2019',' 7998.91','ARCO VALORACIONES'),
		T_TIPO_DATA('6967731','','15/07/2019',' 167339.51','ARCO VALORACIONES'),
		T_TIPO_DATA('6979120','','19/07/2019',' 108450.54','ARCO VALORACIONES'),
		T_TIPO_DATA('7007132','','15/07/2019',' 141856.56','ARCO VALORACIONES'),
		T_TIPO_DATA('7007134','','14/08/2019',' 6137.69','ARCO VALORACIONES'),
		T_TIPO_DATA('7011996','','19/07/2019',' 86112.47','ARCO VALORACIONES'),
		T_TIPO_DATA('7011997','','14/08/2019',' 50074.56','ARCO VALORACIONES'),
		T_TIPO_DATA('7011998','','14/08/2019',' 8567.14','ARCO VALORACIONES'),
		T_TIPO_DATA('7012907','','22/07/2019',' 97645.73','ARCO VALORACIONES'),
		T_TIPO_DATA('7015170','','14/08/2019',' 187706.02','ARCO VALORACIONES'),
		T_TIPO_DATA('7029113','','14/08/2019',' 160092.51','ARCO VALORACIONES'),
		T_TIPO_DATA('7030295','','14/08/2019',' 12464.12','ARCO VALORACIONES'),
		T_TIPO_DATA('7030296','','15/07/2019',' 97485.66','ARCO VALORACIONES'),
		T_TIPO_DATA('7031952','','15/07/2019',' 153832.09','ARCO VALORACIONES'),
		T_TIPO_DATA('7073193','','15/07/2019',' 31224.19','ARCO VALORACIONES'),
		T_TIPO_DATA('7073194','','15/07/2019',' 10670.28','ARCO VALORACIONES'),
		T_TIPO_DATA('7075193','','15/07/2019',' 372258.11','ARCO VALORACIONES'),
		T_TIPO_DATA('7075194','','26/07/2019',' 132552.79','ARCO VALORACIONES'),
		T_TIPO_DATA('7075195','','15/07/2019',' 132552.79','ARCO VALORACIONES'),
		T_TIPO_DATA('7075808','','19/07/2019',' 25722.59','ARCO VALORACIONES'),
		T_TIPO_DATA('7101843','','15/07/2019',' 100885.34','ARCO VALORACIONES'),
		T_TIPO_DATA('7225642','','04/07/2019',' 144944.25','ARCO VALORACIONES'),
		T_TIPO_DATA('7225643','','04/07/2019',' 50677.26','ARCO VALORACIONES'),
		T_TIPO_DATA('7226179','','22/07/2019',' 67738.55','ARCO VALORACIONES'),
		T_TIPO_DATA('7226967','','30/08/2019',' 67665.32','ARCO VALORACIONES')
		); 
    V_TMP_TIPO_DATA T_TIPO_DATA;
    
BEGIN	
	
    DBMS_OUTPUT.PUT_LINE('[INICIO] ');


    FOR I IN V_TIPO_DATA.FIRST .. V_TIPO_DATA.LAST
      LOOP
      
        V_TMP_TIPO_DATA := V_TIPO_DATA(I);
    	ACT_NUM_ACTIVO := TRIM(V_TMP_TIPO_DATA(1));
       	EXECUTE IMMEDIATE 'SELECT COUNT(1) FROM '||V_ESQUEMA||'.ACT_ACTIVO WHERE ACT_NUM_ACTIVO = '||ACT_NUM_ACTIVO INTO V_KOUNT;
  			  
		IF V_KOUNT > 0 THEN 
	  			  
			EXECUTE IMMEDIATE 'SELECT ACT_ID FROM '||V_ESQUEMA||'.ACT_ACTIVO WHERE ACT_NUM_ACTIVO = '||ACT_NUM_ACTIVO INTO ACT_ID;
			
			EXECUTE IMMEDIATE 'SELECT BIE_ID FROM '||V_ESQUEMA||'.ACT_ACTIVO WHERE ACT_NUM_ACTIVO = '||ACT_NUM_ACTIVO INTO BIE_ID;
			
			EXECUTE IMMEDIATE 'SELECT '||V_ESQUEMA||'.S_BIE_VALORACIONES.NEXTVAL FROM DUAL' INTO NUM_SECUENCIA_VAL;
			
			EXECUTE IMMEDIATE 'SELECT '||V_ESQUEMA||'.S_ACT_TAS_TASACION.NEXTVAL FROM DUAL' INTO NUM_SECUENCIA_TAS;
	
			V_SQL := 'INSERT INTO '||V_ESQUEMA||'.'||V_TABLA_1||' (BIE_ID, BIE_VAL_ID, BIE_FECHA_VALOR_TASACION, FECHACREAR, 
			USUARIOCREAR, VERSION, BORRADO)
					  SELECT '''||BIE_ID||''', 
							 '''||NUM_SECUENCIA_VAL||''',
							 TO_DATE('''||TRIM(V_TMP_TIPO_DATA(3))||''', ''DD/MM/RR''),
							 SYSDATE,
							 '''||V_USUARIO||''',
							 0,
							 0
					  FROM DUAL';
			EXECUTE IMMEDIATE V_SQL;
			
			DBMS_OUTPUT.PUT_LINE('INSERTADO EL ACTIVO '||ACT_NUM_ACTIVO||' EN '||V_TABLA_1);
			
			V_SQL := 'INSERT INTO '||V_ESQUEMA||'.'||V_TABLA_2||' (ACT_ID, BIE_VAL_ID, TAS_ID, DD_TTS_ID, TAS_NOMBRE_TASADOR, FECHACREAR, 
			USUARIOCREAR, VERSION, BORRADO, TAS_FECHA_INI_TASACION, TAS_IMPORTE_TAS_FIN)
					  SELECT '''||ACT_ID||''',
							 '''||NUM_SECUENCIA_VAL||''',
							 '''||NUM_SECUENCIA_TAS||''',
							 (SELECT DD_TTS_ID FROM '||V_ESQUEMA||'.DD_TTS_TIPO_TASACION WHERE DD_TTS_CODIGO = ''03''),
							 '''||TRIM(V_TMP_TIPO_DATA(5))||''',
							 SYSDATE,
							 '''||V_USUARIO||''',
							 0,
							 0,
							 TO_DATE('''||TRIM(V_TMP_TIPO_DATA(3))||''', ''DD/MM/RR''),
							 TO_NUMBER('''||TRIM(V_TMP_TIPO_DATA(4))||''',''99999999.99'')
					  FROM DUAL';
			EXECUTE IMMEDIATE V_SQL;
			
			DBMS_OUTPUT.PUT_LINE('INSERTADO EL ACTIVO '||ACT_NUM_ACTIVO||' EN '||V_TABLA_2);
			
			V_COUNT_UPDATE := V_COUNT_UPDATE + 1;
				
		ELSE
			
			DBMS_OUTPUT.PUT_LINE('[INFO] El activo '||ACT_NUM_ACTIVO||' no existe!');
			
		END IF;
		
      END LOOP;
    COMMIT;

    DBMS_OUTPUT.PUT_LINE('[INFO] Se han insertado en total '||V_COUNT_UPDATE||' registros en la tabla '||V_TABLA_1);
    DBMS_OUTPUT.PUT_LINE('[INFO] Se han insertado en total '||V_COUNT_UPDATE||' registros en la tabla '||V_TABLA_2);
   

EXCEPTION
     WHEN OTHERS THEN
          err_num := SQLCODE;
          err_msg := SQLERRM;

          DBMS_OUTPUT.put_line('[ERROR] Se ha producido un error en la ejecución:'||TO_CHAR(err_num));
          DBMS_OUTPUT.put_line('-----------------------------------------------------------'); 
          DBMS_OUTPUT.put_line(err_msg);

          ROLLBACK;
          RAISE;          

END;
/
EXIT
