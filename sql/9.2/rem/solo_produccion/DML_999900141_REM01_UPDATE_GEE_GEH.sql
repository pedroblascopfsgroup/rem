--/*
--##########################################
--## AUTOR=PABLO MESEGUER
--## FECHA_CREACION=20170919
--## ARTEFACTO=online
--## VERSION_ARTEFACTO=9.2
--## INCIDENCIA_LINK=HREOS-2851
--## PRODUCTO=NO
--##
--## Finalidad: Actualización de gestores comerciales
--## INSTRUCCIONES:
--## VERSIONES:
--##        0.1 Versión inicial
--##########################################
--*/


WHENEVER SQLERROR EXIT SQL.SQLCODE;
SET SERVEROUTPUT ON; 
SET DEFINE OFF;


DECLARE
    V_MSQL VARCHAR2(32000 CHAR); -- Sentencia a ejecutar     
    V_ESQUEMA VARCHAR2(25 CHAR):= '#ESQUEMA#'; -- Configuracion Esquema
    V_ESQUEMA_M VARCHAR2(25 CHAR):= '#ESQUEMA_MASTER#'; -- Configuracion Esquema Master
    V_SQL VARCHAR2(4000 CHAR); -- Vble. para consulta que valida la existencia de una tabla.
    V_NUM_TABLAS NUMBER(16); -- Vble. para validar la existencia de una tabla.   
    ERR_NUM NUMBER(25);  -- Vble. auxiliar para registrar errores en el script.
    ERR_MSG VARCHAR2(1024 CHAR); -- Vble. auxiliar para registrar errores en el script.
	
    V_TEXT1 VARCHAR2(2400 CHAR); -- Vble. auxiliar
    V_ENTIDAD_ID NUMBER(16);
    V_ID NUMBER(16);
    V_SEQ_GEH NUMBER(16);
	V_TIPO_ID NUMBER(16); --Vle para el id DD_TTR_TIPO_TRABAJO
    
    
    TYPE T_TIPO_DATA IS TABLE OF VARCHAR2(150);
    TYPE T_ARRAY_DATA IS TABLE OF T_TIPO_DATA;
    V_TIPO_DATA T_ARRAY_DATA := T_ARRAY_DATA(
    	--			ACT_ID	
    	T_TIPO_DATA('2868'),
		T_TIPO_DATA('2229'),
		T_TIPO_DATA('3691'),
		T_TIPO_DATA('46076'),
		T_TIPO_DATA('49434'),
		T_TIPO_DATA('48204'),
		T_TIPO_DATA('37258'),
		T_TIPO_DATA('46362'),
		T_TIPO_DATA('1299'),
		T_TIPO_DATA('2945'),
		T_TIPO_DATA('46119'),
		T_TIPO_DATA('1278'),
		T_TIPO_DATA('2937'),
		T_TIPO_DATA('1387'),
		T_TIPO_DATA('1386'),
		T_TIPO_DATA('833'),
		T_TIPO_DATA('46110'),
		T_TIPO_DATA('12786'),
		T_TIPO_DATA('6228'),
		T_TIPO_DATA('42680'),
		T_TIPO_DATA('6222'),
		T_TIPO_DATA('1285'),
		T_TIPO_DATA('46414'),
		T_TIPO_DATA('13359'),
		T_TIPO_DATA('37177'),
		T_TIPO_DATA('46412'),
		T_TIPO_DATA('46120'),
		T_TIPO_DATA('2225'),
		T_TIPO_DATA('13363'),
		T_TIPO_DATA('46436'),
		T_TIPO_DATA('12802'),
		T_TIPO_DATA('46106'),
		T_TIPO_DATA('3396'),
		T_TIPO_DATA('13366'),
		T_TIPO_DATA('46118'),
		T_TIPO_DATA('46364'),
		T_TIPO_DATA('46077'),
		T_TIPO_DATA('42879'),
		T_TIPO_DATA('42847'),
		T_TIPO_DATA('2228'),
		T_TIPO_DATA('3530'),
		T_TIPO_DATA('48080'),
		T_TIPO_DATA('37739'),
		T_TIPO_DATA('48184'),
		T_TIPO_DATA('198'),
		T_TIPO_DATA('39395'),
		T_TIPO_DATA('3591'),
		T_TIPO_DATA('46125'),
		T_TIPO_DATA('37195'),
		T_TIPO_DATA('46084'),
		T_TIPO_DATA('46400'),
		T_TIPO_DATA('2867'),
		T_TIPO_DATA('42887'),
		T_TIPO_DATA('13485'),
		T_TIPO_DATA('647'),
		T_TIPO_DATA('2926'),
		T_TIPO_DATA('37174'),
		T_TIPO_DATA('46373'),
		T_TIPO_DATA('37818'),
		T_TIPO_DATA('45960'),
		T_TIPO_DATA('37213'),
		T_TIPO_DATA('13368'),
		T_TIPO_DATA('1283'),
		T_TIPO_DATA('46426'),
		T_TIPO_DATA('49414'),
		T_TIPO_DATA('37730'),
		T_TIPO_DATA('46369'),
		T_TIPO_DATA('37229'),
		T_TIPO_DATA('2813'),
		T_TIPO_DATA('3427'),
		T_TIPO_DATA('12803'),
		T_TIPO_DATA('48196'),
		T_TIPO_DATA('1399'),
		T_TIPO_DATA('37810'),
		T_TIPO_DATA('49413'),
		T_TIPO_DATA('12784'),
		T_TIPO_DATA('1396'),
		T_TIPO_DATA('3081'),
		T_TIPO_DATA('3449'),
		T_TIPO_DATA('46117'),
		T_TIPO_DATA('12785'),
		T_TIPO_DATA('13369'),
		T_TIPO_DATA('3231'),
		T_TIPO_DATA('46063'),
		T_TIPO_DATA('1118'),
		T_TIPO_DATA('3579'),
		T_TIPO_DATA('13370'),
		T_TIPO_DATA('42848'),
		T_TIPO_DATA('46093'),
		T_TIPO_DATA('1272'),
		T_TIPO_DATA('2232'),
		T_TIPO_DATA('49410'),
		T_TIPO_DATA('49330'),
		T_TIPO_DATA('3575'),
		T_TIPO_DATA('37727'),
		T_TIPO_DATA('47852'),
		T_TIPO_DATA('38561'),
		T_TIPO_DATA('1393'),
		T_TIPO_DATA('37980'),
		T_TIPO_DATA('1914'),
		T_TIPO_DATA('1311'),
		T_TIPO_DATA('2925'),
		T_TIPO_DATA('37819'),
		T_TIPO_DATA('47853'),
		T_TIPO_DATA('37732'),
		T_TIPO_DATA('37824'),
		T_TIPO_DATA('37745'),
		T_TIPO_DATA('3594'),
		T_TIPO_DATA('38859'),
		T_TIPO_DATA('39024'),
		T_TIPO_DATA('2954'),
		T_TIPO_DATA('42849'),
		T_TIPO_DATA('2866'),
		T_TIPO_DATA('3715'),
		T_TIPO_DATA('51423'),
		T_TIPO_DATA('46101'),
		T_TIPO_DATA('3299'),
		T_TIPO_DATA('2531'),
		T_TIPO_DATA('12791'),
		T_TIPO_DATA('3050'),
		T_TIPO_DATA('46085'),
		T_TIPO_DATA('3688'),
		T_TIPO_DATA('46083'),
		T_TIPO_DATA('3356'),
		T_TIPO_DATA('5650'),
		T_TIPO_DATA('49420'),
		T_TIPO_DATA('1279'),
		T_TIPO_DATA('46094'),
		T_TIPO_DATA('12796'),
		T_TIPO_DATA('48186'),
		T_TIPO_DATA('2856'),
		T_TIPO_DATA('4824'),
		T_TIPO_DATA('470'),
		T_TIPO_DATA('46100'),
		T_TIPO_DATA('2098'),
		T_TIPO_DATA('38207'),
		T_TIPO_DATA('46361'),
		T_TIPO_DATA('2314'),
		T_TIPO_DATA('42842'),
		T_TIPO_DATA('3354'),
		T_TIPO_DATA('2227'),
		T_TIPO_DATA('39288'),
		T_TIPO_DATA('12777'),
		T_TIPO_DATA('435'),
		T_TIPO_DATA('46113'),
		T_TIPO_DATA('2990'),
		T_TIPO_DATA('1016'),
		T_TIPO_DATA('1397'),
		T_TIPO_DATA('42877'),
		T_TIPO_DATA('46092'),
		T_TIPO_DATA('46062'),
		T_TIPO_DATA('13371'),
		T_TIPO_DATA('37724'),
		T_TIPO_DATA('3501'),
		T_TIPO_DATA('37812'),
		T_TIPO_DATA('42853'),
		T_TIPO_DATA('1309'),
		T_TIPO_DATA('48189'),
		T_TIPO_DATA('48193'),
		T_TIPO_DATA('1103'),
		T_TIPO_DATA('1270'),
		T_TIPO_DATA('3472'),
		T_TIPO_DATA('48210'),
		T_TIPO_DATA('1400'),
		T_TIPO_DATA('12804'),
		T_TIPO_DATA('441'),
		T_TIPO_DATA('2311'),
		T_TIPO_DATA('3355'),
		T_TIPO_DATA('46068'),
		T_TIPO_DATA('1280'),
		T_TIPO_DATA('46379'),
		T_TIPO_DATA('1310'),
		T_TIPO_DATA('491'),
		T_TIPO_DATA('45962'),
		T_TIPO_DATA('12778'),
		T_TIPO_DATA('46409'),
		T_TIPO_DATA('13355'),
		T_TIPO_DATA('46403'),
		T_TIPO_DATA('3592'),
		T_TIPO_DATA('649'),
		T_TIPO_DATA('1302'),
		T_TIPO_DATA('46405'),
		T_TIPO_DATA('42841'),
		T_TIPO_DATA('13488'),
		T_TIPO_DATA('42880'),
		T_TIPO_DATA('37257'),
		T_TIPO_DATA('37722'),
		T_TIPO_DATA('13354'),
		T_TIPO_DATA('2333'),
		T_TIPO_DATA('46122'),
		T_TIPO_DATA('49637'),
		T_TIPO_DATA('2695'),
		T_TIPO_DATA('38883'),
		T_TIPO_DATA('42856'),
		T_TIPO_DATA('37736'),
		T_TIPO_DATA('48180'),
		T_TIPO_DATA('3500'),
		T_TIPO_DATA('37734'),
		T_TIPO_DATA('2111'),
		T_TIPO_DATA('2712'),
		T_TIPO_DATA('46368'),
		T_TIPO_DATA('2235'),
		T_TIPO_DATA('43817'),
		T_TIPO_DATA('45967'),
		T_TIPO_DATA('2417'),
		T_TIPO_DATA('1307'),
		T_TIPO_DATA('37744'),
		T_TIPO_DATA('37245'),
		T_TIPO_DATA('49412'),
		T_TIPO_DATA('42851'),
		T_TIPO_DATA('43820'),
		T_TIPO_DATA('39194'),
		T_TIPO_DATA('13367'),
		T_TIPO_DATA('37822'),
		T_TIPO_DATA('49631'),
		T_TIPO_DATA('1772'),
		T_TIPO_DATA('3397'),
		T_TIPO_DATA('1269'),
		T_TIPO_DATA('755'),
		T_TIPO_DATA('37250'),
		T_TIPO_DATA('37246'),
		T_TIPO_DATA('37729'),
		T_TIPO_DATA('3578'),
		T_TIPO_DATA('2534'),
		T_TIPO_DATA('13486'),
		T_TIPO_DATA('37809'),
		T_TIPO_DATA('2957'),
		T_TIPO_DATA('37738'),
		T_TIPO_DATA('1113'),
		T_TIPO_DATA('37981'),
		T_TIPO_DATA('6232'),
		T_TIPO_DATA('39016'),
		T_TIPO_DATA('6227'),
		T_TIPO_DATA('37742'),
		T_TIPO_DATA('45965'),
		T_TIPO_DATA('1385'),
		T_TIPO_DATA('46130'),
		T_TIPO_DATA('39615'),
		T_TIPO_DATA('1112'),
		T_TIPO_DATA('492'),
		T_TIPO_DATA('48199'),
		T_TIPO_DATA('46402'),
		T_TIPO_DATA('42884'),
		T_TIPO_DATA('39385'),
		T_TIPO_DATA('45966'),
		T_TIPO_DATA('12793'),
		T_TIPO_DATA('46372'),
		T_TIPO_DATA('2119'),
		T_TIPO_DATA('46366'),
		T_TIPO_DATA('3529'),
		T_TIPO_DATA('1321'),
		T_TIPO_DATA('46381'),
		T_TIPO_DATA('1105'),
		T_TIPO_DATA('46374'),
		T_TIPO_DATA('12781'),
		T_TIPO_DATA('38894'),
		T_TIPO_DATA('13358'),
		T_TIPO_DATA('648'),
		T_TIPO_DATA('48192'),
		T_TIPO_DATA('46098'),
		T_TIPO_DATA('2985'),
		T_TIPO_DATA('46128'),
		T_TIPO_DATA('306'),
		T_TIPO_DATA('46115'),
		T_TIPO_DATA('49421'),
		T_TIPO_DATA('13362'),
		T_TIPO_DATA('42873'),
		T_TIPO_DATA('3693'),
		T_TIPO_DATA('2974'),
		T_TIPO_DATA('48188'),
		T_TIPO_DATA('46424'),
		T_TIPO_DATA('46380'),
		T_TIPO_DATA('1119'),
		T_TIPO_DATA('3447'),
		T_TIPO_DATA('1267'),
		T_TIPO_DATA('46367'),
		T_TIPO_DATA('39702'),
		T_TIPO_DATA('39319'),
		T_TIPO_DATA('38879'),
		T_TIPO_DATA('48212'),
		T_TIPO_DATA('1286'),
		T_TIPO_DATA('13361'),
		T_TIPO_DATA('3711'),
		T_TIPO_DATA('46088'),
		T_TIPO_DATA('13380'),
		T_TIPO_DATA('2418'),
		T_TIPO_DATA('2946'),
		T_TIPO_DATA('1029'),
		T_TIPO_DATA('46071'),
		T_TIPO_DATA('48207'),
		T_TIPO_DATA('2533'),
		T_TIPO_DATA('3444'),
		T_TIPO_DATA('1123'),
		T_TIPO_DATA('2132'),
		T_TIPO_DATA('42854'),
		T_TIPO_DATA('2336'),
		T_TIPO_DATA('48191'),
		T_TIPO_DATA('49418'),
		T_TIPO_DATA('45963'),
		T_TIPO_DATA('5911'),
		T_TIPO_DATA('42876'),
		T_TIPO_DATA('46067'),
		T_TIPO_DATA('42844'),
		T_TIPO_DATA('3181'),
		T_TIPO_DATA('3395'),
		T_TIPO_DATA('1282'),
		T_TIPO_DATA('39340'),
		T_TIPO_DATA('565'),
		T_TIPO_DATA('37814'),
		T_TIPO_DATA('3577'),
		T_TIPO_DATA('46434'),
		T_TIPO_DATA('2135'),
		T_TIPO_DATA('46091'),
		T_TIPO_DATA('2986'),
		T_TIPO_DATA('46401'),
		T_TIPO_DATA('37741'),
		T_TIPO_DATA('1035'),
		T_TIPO_DATA('48187'),
		T_TIPO_DATA('439'),
		T_TIPO_DATA('3446'),
		T_TIPO_DATA('42883'),
		T_TIPO_DATA('49629'),
		T_TIPO_DATA('49435'),
		T_TIPO_DATA('46066'),
		T_TIPO_DATA('37740'),
		T_TIPO_DATA('37820'),
		T_TIPO_DATA('46423'),
		T_TIPO_DATA('1289'),
		T_TIPO_DATA('1268'),
		T_TIPO_DATA('562'),
		T_TIPO_DATA('46109'),
		T_TIPO_DATA('45961'),
		T_TIPO_DATA('38708'),
		T_TIPO_DATA('46104'),
		T_TIPO_DATA('1281'),
		T_TIPO_DATA('12800'),
		T_TIPO_DATA('48206'),
		T_TIPO_DATA('1320'),
		T_TIPO_DATA('3576'),
		T_TIPO_DATA('13352'),
		T_TIPO_DATA('46107'),
		T_TIPO_DATA('13489'),
		T_TIPO_DATA('13374'),
		T_TIPO_DATA('13375'),
		T_TIPO_DATA('49433'),
		T_TIPO_DATA('2133'),
		T_TIPO_DATA('3445'),
		T_TIPO_DATA('2310'),
		T_TIPO_DATA('46074'),
		T_TIPO_DATA('48198'),
		T_TIPO_DATA('37726'),
		T_TIPO_DATA('46408'),
		T_TIPO_DATA('761'),
		T_TIPO_DATA('49426'),
		T_TIPO_DATA('39650'),
		T_TIPO_DATA('2099'),
		T_TIPO_DATA('1192'),
		T_TIPO_DATA('1389'),
		T_TIPO_DATA('4701'),
		T_TIPO_DATA('3689'),
		T_TIPO_DATA('12801'),
		T_TIPO_DATA('43790'),
		T_TIPO_DATA('44440'),
		T_TIPO_DATA('12787'),
		T_TIPO_DATA('46427'),
		T_TIPO_DATA('48205'),
		T_TIPO_DATA('1392'),
		T_TIPO_DATA('12792'),
		T_TIPO_DATA('3331'),
		T_TIPO_DATA('39074'),
		T_TIPO_DATA('46376'),
		T_TIPO_DATA('1122'),
		T_TIPO_DATA('37982'),
		T_TIPO_DATA('40420'),
		T_TIPO_DATA('46073'),
		T_TIPO_DATA('1750'),
		T_TIPO_DATA('37728'),
		T_TIPO_DATA('1104'),
		T_TIPO_DATA('748'),
		T_TIPO_DATA('2236'),
		T_TIPO_DATA('46422'),
		T_TIPO_DATA('2958'),
		T_TIPO_DATA('264'),
		T_TIPO_DATA('2011'),
		T_TIPO_DATA('48190'),
		T_TIPO_DATA('3714'),
		T_TIPO_DATA('37816'),
		T_TIPO_DATA('38830'),
		T_TIPO_DATA('6226'),
		T_TIPO_DATA('49329'),
		T_TIPO_DATA('48178'),
		T_TIPO_DATA('49326'),
		T_TIPO_DATA('3451'),
		T_TIPO_DATA('46417'),
		T_TIPO_DATA('1101'),
		T_TIPO_DATA('3695'),
		T_TIPO_DATA('1298'),
		T_TIPO_DATA('46096'),
		T_TIPO_DATA('2129'),
		T_TIPO_DATA('46086'),
		T_TIPO_DATA('46095'),
		T_TIPO_DATA('13356'),
		T_TIPO_DATA('49328'),
		T_TIPO_DATA('37723'),
		T_TIPO_DATA('42875'),
		T_TIPO_DATA('478'),
		T_TIPO_DATA('37235'),
		T_TIPO_DATA('6225'),
		T_TIPO_DATA('1265'),
		T_TIPO_DATA('42872'),
		T_TIPO_DATA('12805'),
		T_TIPO_DATA('2234'),
		T_TIPO_DATA('1106'),
		T_TIPO_DATA('2134'),
		T_TIPO_DATA('12806'),
		T_TIPO_DATA('634'),
		T_TIPO_DATA('46411'),
		T_TIPO_DATA('6187'),
		T_TIPO_DATA('1297'),
		T_TIPO_DATA('12782'),
		T_TIPO_DATA('563'),
		T_TIPO_DATA('12779'),
		T_TIPO_DATA('42881'),
		T_TIPO_DATA('13376'),
		T_TIPO_DATA('6224'),
		T_TIPO_DATA('2991'),
		T_TIPO_DATA('49423'),
		T_TIPO_DATA('13490'),
		T_TIPO_DATA('3049'),
		T_TIPO_DATA('38208'),
		T_TIPO_DATA('2331'),
		T_TIPO_DATA('1751'),
		T_TIPO_DATA('3593'),
		T_TIPO_DATA('46435'),
		T_TIPO_DATA('1287'),
		T_TIPO_DATA('48208'),
		T_TIPO_DATA('47851'),
		T_TIPO_DATA('13373'),
		T_TIPO_DATA('1686'),
		T_TIPO_DATA('13487'),
		T_TIPO_DATA('40421'),
		T_TIPO_DATA('2604'),
		T_TIPO_DATA('38562'),
		T_TIPO_DATA('46103'),
		T_TIPO_DATA('37725'),
		T_TIPO_DATA('38966'),
		T_TIPO_DATA('46121'),
		T_TIPO_DATA('49432'),
		T_TIPO_DATA('323'),
		T_TIPO_DATA('39468'),
		T_TIPO_DATA('12795'),
		T_TIPO_DATA('49411'),
		T_TIPO_DATA('525'),
		T_TIPO_DATA('46112'),
		T_TIPO_DATA('2557'),
		T_TIPO_DATA('46421'),
		T_TIPO_DATA('3048'),
		T_TIPO_DATA('49425'),
		T_TIPO_DATA('1120'),
		T_TIPO_DATA('2406'),
		T_TIPO_DATA('1288'),
		T_TIPO_DATA('3300'),
		T_TIPO_DATA('39533'),
		T_TIPO_DATA('13379'),
		T_TIPO_DATA('37821'),
		T_TIPO_DATA('37983'),
		T_TIPO_DATA('747'),
		T_TIPO_DATA('37823'),
		T_TIPO_DATA('46370'),
		T_TIPO_DATA('3471'),
		T_TIPO_DATA('440'),
		T_TIPO_DATA('1390'),
		T_TIPO_DATA('2130'),
		T_TIPO_DATA('2855'),
		T_TIPO_DATA('46105'),
		T_TIPO_DATA('2334'),
		T_TIPO_DATA('49417'),
		T_TIPO_DATA('1303'),
		T_TIPO_DATA('12788'),
		T_TIPO_DATA('37746'),
		T_TIPO_DATA('38854'),
		T_TIPO_DATA('48197'),
		T_TIPO_DATA('3710'),
		T_TIPO_DATA('42845'),
		T_TIPO_DATA('37192'),
		T_TIPO_DATA('46070'),
		T_TIPO_DATA('13360'),
		T_TIPO_DATA('3690'),
		T_TIPO_DATA('3214'),
		T_TIPO_DATA('46078'),
		T_TIPO_DATA('46415'),
		T_TIPO_DATA('48203'),
		T_TIPO_DATA('436'),
		T_TIPO_DATA('37219'),
		T_TIPO_DATA('46407'),
		T_TIPO_DATA('46127'),
		T_TIPO_DATA('46102'),
		T_TIPO_DATA('1114'),
		T_TIPO_DATA('1301'),
		T_TIPO_DATA('1116'),
		T_TIPO_DATA('2857'),
		T_TIPO_DATA('46363'),
		T_TIPO_DATA('46378'),
		T_TIPO_DATA('42852'),
		T_TIPO_DATA('12780'),
		T_TIPO_DATA('13377'),
		T_TIPO_DATA('46097'),
		T_TIPO_DATA('48195'),
		T_TIPO_DATA('46090'),
		T_TIPO_DATA('49419'),
		T_TIPO_DATA('13378'),
		T_TIPO_DATA('39027'),
		T_TIPO_DATA('1752'),
		T_TIPO_DATA('38090'),
		T_TIPO_DATA('3448'),
		T_TIPO_DATA('46116'),
		T_TIPO_DATA('4823'),
		T_TIPO_DATA('490'),
		T_TIPO_DATA('46079'),
		T_TIPO_DATA('6223'),
		T_TIPO_DATA('48213'),
		T_TIPO_DATA('48202'),
		T_TIPO_DATA('37178'),
		T_TIPO_DATA('12783'),
		T_TIPO_DATA('37255'),
		T_TIPO_DATA('6189'),
		T_TIPO_DATA('48179'),
		T_TIPO_DATA('37737'),
		T_TIPO_DATA('46111'),
		T_TIPO_DATA('46126'),
		T_TIPO_DATA('46114'),
		T_TIPO_DATA('46365'),
		T_TIPO_DATA('13382'),
		T_TIPO_DATA('39192'),
		T_TIPO_DATA('49429'),
		T_TIPO_DATA('48201'),
		T_TIPO_DATA('2869'),
		T_TIPO_DATA('46377'),
		T_TIPO_DATA('48185'),
		T_TIPO_DATA('42846'),
		T_TIPO_DATA('1915'),
		T_TIPO_DATA('37735'),
		T_TIPO_DATA('37817'),
		T_TIPO_DATA('3330'),
		T_TIPO_DATA('3094'),
		T_TIPO_DATA('46080'),
		T_TIPO_DATA('46413'),
		T_TIPO_DATA('45964'),
		T_TIPO_DATA('48211'),
		T_TIPO_DATA('2617'),
		T_TIPO_DATA('3426'),
		T_TIPO_DATA('3301'),
		T_TIPO_DATA('46418'),
		T_TIPO_DATA('546'),
		T_TIPO_DATA('48209'),
		T_TIPO_DATA('46360'),
		T_TIPO_DATA('3713'),
		T_TIPO_DATA('437'),
		T_TIPO_DATA('46371'),
		T_TIPO_DATA('1115'),
		T_TIPO_DATA('1117'),
		T_TIPO_DATA('13357'),
		T_TIPO_DATA('1395'),
		T_TIPO_DATA('38089'),
		T_TIPO_DATA('6186'),
		T_TIPO_DATA('3694'),
		T_TIPO_DATA('37815'),
		T_TIPO_DATA('2313'),
		T_TIPO_DATA('39630'),
		T_TIPO_DATA('12799'),
		T_TIPO_DATA('49416'),
		T_TIPO_DATA('12797'),
		T_TIPO_DATA('2226'),
		T_TIPO_DATA('1388'),
		T_TIPO_DATA('46375'),
		T_TIPO_DATA('49636'),
		T_TIPO_DATA('2671'),
		T_TIPO_DATA('37733'),
		T_TIPO_DATA('2438'),
		T_TIPO_DATA('2118'),
		T_TIPO_DATA('3945'),
		T_TIPO_DATA('1266'),
		T_TIPO_DATA('2642'),
		T_TIPO_DATA('2131'),
		T_TIPO_DATA('46124'),
		T_TIPO_DATA('6188'),
		T_TIPO_DATA('46129'),
		T_TIPO_DATA('1271'),
		T_TIPO_DATA('49427'),
		T_TIPO_DATA('3574'),
		T_TIPO_DATA('1284'),
		T_TIPO_DATA('39057'),
		T_TIPO_DATA('3064'),
		T_TIPO_DATA('1102'),
		T_TIPO_DATA('48181'),
		T_TIPO_DATA('37811'),
		T_TIPO_DATA('6229'),
		T_TIPO_DATA('3076'),
		T_TIPO_DATA('37813'),
		T_TIPO_DATA('1121'),
		T_TIPO_DATA('46087'),
		T_TIPO_DATA('1308'),
		T_TIPO_DATA('1273'),
		T_TIPO_DATA('646'),
		T_TIPO_DATA('46089'),
		T_TIPO_DATA('46065'),
		T_TIPO_DATA('3443'),
		T_TIPO_DATA('46419'),
		T_TIPO_DATA('2258'),
		T_TIPO_DATA('1019'),
		T_TIPO_DATA('3329'),
		T_TIPO_DATA('3692'),
		T_TIPO_DATA('49424'),
		T_TIPO_DATA('12789'),
		T_TIPO_DATA('564'),
		T_TIPO_DATA('49430'),
		T_TIPO_DATA('2012'),
		T_TIPO_DATA('37212'),
		T_TIPO_DATA('12790'),
		T_TIPO_DATA('3450'),
		T_TIPO_DATA('1391'),
		T_TIPO_DATA('37825'),
		T_TIPO_DATA('2713'),
		T_TIPO_DATA('2332'),
		T_TIPO_DATA('48183'),
		T_TIPO_DATA('48200'),
		T_TIPO_DATA('46075'),
		T_TIPO_DATA('1916'),
		T_TIPO_DATA('48182'),
		T_TIPO_DATA('48214'),
		T_TIPO_DATA('46082'),
		T_TIPO_DATA('49428'),
		T_TIPO_DATA('49431'),
		T_TIPO_DATA('1319'),
		T_TIPO_DATA('42874'),
		T_TIPO_DATA('13364'),
		T_TIPO_DATA('46081'),
		T_TIPO_DATA('4667'),
		T_TIPO_DATA('2653'),
		T_TIPO_DATA('46064'),
		T_TIPO_DATA('48194'),
		T_TIPO_DATA('13381'),
		T_TIPO_DATA('2335'),
		T_TIPO_DATA('1322'),
		T_TIPO_DATA('46404'),
		T_TIPO_DATA('12794'),
		T_TIPO_DATA('2137'),
		T_TIPO_DATA('49415'),
		T_TIPO_DATA('46072'),
		T_TIPO_DATA('42878'),
		T_TIPO_DATA('488'),
		T_TIPO_DATA('37211'),
		T_TIPO_DATA('46069'),
		T_TIPO_DATA('37216'),
		T_TIPO_DATA('50106'),
		T_TIPO_DATA('2979'),
		T_TIPO_DATA('3398'),
		T_TIPO_DATA('3047'),
		T_TIPO_DATA('49327'),
		T_TIPO_DATA('12798'),
		T_TIPO_DATA('38091'),
		T_TIPO_DATA('13353'),
		T_TIPO_DATA('46406'),
		T_TIPO_DATA('46099'),
		T_TIPO_DATA('2138'),
		T_TIPO_DATA('1398'),
		T_TIPO_DATA('3712'),
		T_TIPO_DATA('37743'),
		T_TIPO_DATA('3473'),
		T_TIPO_DATA('566'),
		T_TIPO_DATA('3528'),
		T_TIPO_DATA('13372'),
		T_TIPO_DATA('37731'),
		T_TIPO_DATA('46123'),
		T_TIPO_DATA('49422'),
		T_TIPO_DATA('13365'),
		T_TIPO_DATA('46108'),
		T_TIPO_DATA('65191'),
		T_TIPO_DATA('65188'),
		T_TIPO_DATA('65224'),
		T_TIPO_DATA('65232'),
		T_TIPO_DATA('69952'),
		T_TIPO_DATA('65175'),
		T_TIPO_DATA('65158'),
		T_TIPO_DATA('65201'),
		T_TIPO_DATA('67520'),
		T_TIPO_DATA('67528'),
		T_TIPO_DATA('66078'),
		T_TIPO_DATA('69438'),
		T_TIPO_DATA('67521'),
		T_TIPO_DATA('69441'),
		T_TIPO_DATA('65178'),
		T_TIPO_DATA('66072'),
		T_TIPO_DATA('69446'),
		T_TIPO_DATA('65179'),
		T_TIPO_DATA('65160'),
		T_TIPO_DATA('67531'),
		T_TIPO_DATA('65033'),
		T_TIPO_DATA('65173'),
		T_TIPO_DATA('69622'),
		T_TIPO_DATA('65206'),
		T_TIPO_DATA('65028'),
		T_TIPO_DATA('67523'),
		T_TIPO_DATA('69617'),
		T_TIPO_DATA('65214'),
		T_TIPO_DATA('67516'),
		T_TIPO_DATA('65226'),
		T_TIPO_DATA('66076'),
		T_TIPO_DATA('67536'),
		T_TIPO_DATA('67541'),
		T_TIPO_DATA('65150'),
		T_TIPO_DATA('65034'),
		T_TIPO_DATA('65218'),
		T_TIPO_DATA('65207'),
		T_TIPO_DATA('65172'),
		T_TIPO_DATA('65168'),
		T_TIPO_DATA('65199'),
		T_TIPO_DATA('65154'),
		T_TIPO_DATA('65165'),
		T_TIPO_DATA('65185'),
		T_TIPO_DATA('67529'),
		T_TIPO_DATA('65233'),
		T_TIPO_DATA('65219'),
		T_TIPO_DATA('65186'),
		T_TIPO_DATA('69447'),
		T_TIPO_DATA('67518'),
		T_TIPO_DATA('69448'),
		T_TIPO_DATA('65193'),
		T_TIPO_DATA('65037'),
		T_TIPO_DATA('65137'),
		T_TIPO_DATA('65120'),
		T_TIPO_DATA('65040'),
		T_TIPO_DATA('65126'),
		T_TIPO_DATA('69444'),
		T_TIPO_DATA('65036'),
		T_TIPO_DATA('65225'),
		T_TIPO_DATA('65181'),
		T_TIPO_DATA('69953'),
		T_TIPO_DATA('65220'),
		T_TIPO_DATA('65167'),
		T_TIPO_DATA('67530'),
		T_TIPO_DATA('65032'),
		T_TIPO_DATA('65217'),
		T_TIPO_DATA('69620'),
		T_TIPO_DATA('69452'),
		T_TIPO_DATA('65038'),
		T_TIPO_DATA('65210'),
		T_TIPO_DATA('67535'),
		T_TIPO_DATA('65227'),
		T_TIPO_DATA('65192'),
		T_TIPO_DATA('67515'),
		T_TIPO_DATA('69615'),
		T_TIPO_DATA('67513'),
		T_TIPO_DATA('65203'),
		T_TIPO_DATA('69623'),
		T_TIPO_DATA('69616'),
		T_TIPO_DATA('65231'),
		T_TIPO_DATA('67514'),
		T_TIPO_DATA('65229'),
		T_TIPO_DATA('67542'),
		T_TIPO_DATA('65155'),
		T_TIPO_DATA('65215'),
		T_TIPO_DATA('65212'),
		T_TIPO_DATA('65149'),
		T_TIPO_DATA('67519'),
		T_TIPO_DATA('69950'),
		T_TIPO_DATA('65230'),
		T_TIPO_DATA('69614'),
		T_TIPO_DATA('67538'),
		T_TIPO_DATA('67527'),
		T_TIPO_DATA('65223'),
		T_TIPO_DATA('67517'),
		T_TIPO_DATA('66073'),
		T_TIPO_DATA('65184'),
		T_TIPO_DATA('65176'),
		T_TIPO_DATA('65202'),
		T_TIPO_DATA('69445'),
		T_TIPO_DATA('65190'),
		T_TIPO_DATA('65198'),
		T_TIPO_DATA('69440'),
		T_TIPO_DATA('69612'),
		T_TIPO_DATA('65208'),
		T_TIPO_DATA('65204'),
		T_TIPO_DATA('65196'),
		T_TIPO_DATA('65187'),
		T_TIPO_DATA('71250'),
		T_TIPO_DATA('65031'),
		T_TIPO_DATA('69450'),
		T_TIPO_DATA('65164'),
		T_TIPO_DATA('65216'),
		T_TIPO_DATA('65030'),
		T_TIPO_DATA('67534'),
		T_TIPO_DATA('65180'),
		T_TIPO_DATA('69618'),
		T_TIPO_DATA('65029'),
		T_TIPO_DATA('65205'),
		T_TIPO_DATA('67537'),
		T_TIPO_DATA('65174'),
		T_TIPO_DATA('65195'),
		T_TIPO_DATA('65035'),
		T_TIPO_DATA('65221'),
		T_TIPO_DATA('65222'),
		T_TIPO_DATA('69954'),
		T_TIPO_DATA('69619'),
		T_TIPO_DATA('65039'),
		T_TIPO_DATA('65189'),
		T_TIPO_DATA('65171'),
		T_TIPO_DATA('65166'),
		T_TIPO_DATA('65124'),
		T_TIPO_DATA('65159'),
		T_TIPO_DATA('65169'),
		T_TIPO_DATA('65197'),
		T_TIPO_DATA('65177'),
		T_TIPO_DATA('67526'),
		T_TIPO_DATA('69611'),
		T_TIPO_DATA('69443'),
		T_TIPO_DATA('69949'),
		T_TIPO_DATA('65211'),
		T_TIPO_DATA('65194'),
		T_TIPO_DATA('65228'),
		T_TIPO_DATA('65200'),
		T_TIPO_DATA('69951'),
		T_TIPO_DATA('65183'),
		T_TIPO_DATA('69451'),
		T_TIPO_DATA('67525'),
		T_TIPO_DATA('67540'),
		T_TIPO_DATA('69948'),
		T_TIPO_DATA('67524'),
		T_TIPO_DATA('67522'),
		T_TIPO_DATA('67539'),
		T_TIPO_DATA('67532'),
		T_TIPO_DATA('69621'),
		T_TIPO_DATA('65148'),
		T_TIPO_DATA('65182'),
		T_TIPO_DATA('67533'),
		T_TIPO_DATA('66071'),
		T_TIPO_DATA('69613'),
		T_TIPO_DATA('69449'),
		T_TIPO_DATA('69442'),
		T_TIPO_DATA('69439'),
		T_TIPO_DATA('65163'),
		T_TIPO_DATA('65213'),
		T_TIPO_DATA('69610'),
		T_TIPO_DATA('65209')
	); 
    V_TMP_TIPO_DATA T_TIPO_DATA;
    
BEGIN	
	
	DBMS_OUTPUT.PUT_LINE('[INICIO] ');

	 
    -- LOOP para insertar los valores en DD_STR_SUBTIPO_TRABAJO -----------------------------------------------------------------
    DBMS_OUTPUT.PUT_LINE('[INFO]: UPDATE EN ACT_PVE_PROVEEDOR] ');
    FOR I IN V_TIPO_DATA.FIRST .. V_TIPO_DATA.LAST
      LOOP
      
        V_TMP_TIPO_DATA := V_TIPO_DATA(I);
    
        --Comprobamos el dato a insertar
        V_SQL := 'SELECT COUNT(1) FROM '||V_ESQUEMA||'.ACT_ACTIVO WHERE ACT_ID = '||TRIM(V_TMP_TIPO_DATA(1))||'';
        EXECUTE IMMEDIATE V_SQL INTO V_NUM_TABLAS;
        
        --Si existe realizamos otra comprobacion
        IF V_NUM_TABLAS > 0 THEN		

			DBMS_OUTPUT.PUT_LINE('[INFO]: MODIFICAMOS EL GESTOR COMERCIAL EN LA GEE PARA EL ACTIVO '''|| TRIM(V_TMP_TIPO_DATA(1)) ||''' ');
			V_MSQL := 'MERGE INTO '||V_ESQUEMA||'.GEE_GESTOR_ENTIDAD GEE
						USING (
							SELECT DISTINCT GEE.GEE_ID FROM REM01.GAC_GESTOR_ADD_ACTIVO GAC 
							INNER JOIN '||V_ESQUEMA||'.GEE_GESTOR_ENTIDAD GEE ON GEE.GEE_ID = GAC.GEE_ID
							INNER JOIN '||V_ESQUEMA_M||'.DD_TGE_TIPO_GESTOR TGE ON TGE.DD_TGE_ID = GEE.DD_TGE_ID
							WHERE TGE.DD_TGE_CODIGO = ''GCOM''
							AND GAC.ACT_ID = '||TRIM(V_TMP_TIPO_DATA(1))||'
						) AUX
						ON (GEE.GEE_ID = AUX.GEE_ID)
						WHEN MATCHED THEN UPDATE SET
						GEE.USU_ID = (SELECT USU.USU_ID FROM '||V_ESQUEMA_M||'.USU_USUARIOS USU WHERE USU.USU_USERNAME = ''palcocer''),
						GEE.USUARIOMODIFICAR = ''HREOS-2851'',
						GEE.FECHAMODIFICAR = SYSDATE
						';
			EXECUTE IMMEDIATE V_MSQL;
			
			
			DBMS_OUTPUT.PUT_LINE('[INFO]: MODIFICAMOS LA FECHA_HASTA EN LA GEH PARA EL ACTIVO '''|| TRIM(V_TMP_TIPO_DATA(1)) ||''' ');
			V_MSQL := 'MERGE INTO '||V_ESQUEMA||'.GEH_GESTOR_ENTIDAD_HIST GEH
						USING (
							SELECT DISTINCT GEH.GEH_ID FROM REM01.GAH_GESTOR_ACTIVO_HISTORICO GAH 
							INNER JOIN '||V_ESQUEMA||'.GEH_GESTOR_ENTIDAD_HIST GEH ON GEH.GEH_ID = GAH.GEH_ID
							INNER JOIN '||V_ESQUEMA_M||'.DD_TGE_TIPO_GESTOR TGE ON TGE.DD_TGE_ID = GEH.DD_TGE_ID
							WHERE TGE.DD_TGE_CODIGO = ''GCOM''
							AND GAH.ACT_ID = '||TRIM(V_TMP_TIPO_DATA(1))||'
							AND GEH.GEH_FECHA_HASTA IS NULL							
						) AUX
						ON (GEH.GEH_ID = AUX.GEH_ID)
						WHEN MATCHED THEN UPDATE SET
						GEH.GEH_FECHA_HASTA = SYSDATE,
						GEH.USUARIOMODIFICAR = ''HREOS-2851'',
						GEH.FECHAMODIFICAR = SYSDATE
						';
			EXECUTE IMMEDIATE V_MSQL;
			
			DBMS_OUTPUT.PUT_LINE('[INFO]: INICIAMOS EL PROCESO PARA REALIZAR LOS NUEVOS INSERTS EN GEH Y GAH ');
			V_MSQL := 'SELECT '||V_ESQUEMA||'.S_GEH_GESTOR_ENTIDAD_HIST.NEXTVAL FROM DUAL';
			EXECUTE IMMEDIATE V_MSQL INTO V_SEQ_GEH;
			
			V_MSQL := 'INSERT INTO '||V_ESQUEMA||'.GEH_GESTOR_ENTIDAD_HIST(GEH_ID, USU_ID, DD_TGE_ID, GEH_FECHA_DESDE, VERSION, USUARIOCREAR, FECHACREAR, BORRADO)
						(SELECT
						'||V_SEQ_GEH||',
						(SELECT USU.USU_ID FROM '||V_ESQUEMA_M||'.USU_USUARIOS USU WHERE USU.USU_USERNAME = ''palcocer''),
						(SELECT TGE.DD_TGE_ID FROM '||V_ESQUEMA_M||'.DD_TGE_TIPO_GESTOR TGE WHERE TGE.DD_TGE_CODIGO = ''GCOM''),
						SYSDATE,
						0,
						''HREOS-2851'',
						SYSDATE,
						0
						FROM DUAL
						)
			'		;
			EXECUTE IMMEDIATE V_MSQL;
			DBMS_OUTPUT.PUT_LINE('[INFO]: INSERTADO CORRECTAMENTE EN GEH ');
			
			V_MSQL := 'INSERT INTO '||V_ESQUEMA||'.GAH_GESTOR_ACTIVO_HISTORICO(GEH_ID, ACT_ID)
						(SELECT
						'||V_SEQ_GEH||',
						'||TRIM(V_TMP_TIPO_DATA(1))||'
						FROM DUAL
						)
			'		;
			EXECUTE IMMEDIATE V_MSQL;
			DBMS_OUTPUT.PUT_LINE('[INFO]: INSERTADO CORRECTAMENTE EN GAH ');
			
		--El activo no existe
		ELSE
			  DBMS_OUTPUT.PUT_LINE('[INFO]: EL ACT_ID '''||TRIM(V_TMP_TIPO_DATA(1))||''' NO EXISTE');
		END IF;
		
    END LOOP;
    COMMIT;
    DBMS_OUTPUT.PUT_LINE('[FIN]: TABLA ACT_PVE_PROVEEDOR ACTUALIZADA CORRECTAMENTE ');
   

EXCEPTION
     WHEN OTHERS THEN
          err_num := SQLCODE;
          err_msg := SQLERRM;

          DBMS_OUTPUT.put_line('[ERROR] Se ha producido un error en la ejecución:'||TO_CHAR(err_num));
          DBMS_OUTPUT.put_line('-----------------------------------------------------------'); 
          DBMS_OUTPUT.put_line(err_msg);

          ROLLBACK;
          RAISE;          

END;

/

EXIT


