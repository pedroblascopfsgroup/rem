--/*
--#########################################
--## AUTOR=DAP
--## FECHA_CREACION=20171005
--## ARTEFACTO=batch
--## VERSION_ARTEFACTO=0.1
--## INCIDENCIA_LINK=HREOS-2878
--## PRODUCTO=NO
--## 
--## Finalidad: Proceso de copiado de tablas de MIG_SAREB
--##            
--## INSTRUCCIONES:  
--## VERSIONES:
--##        0.1 Versión inicial
--#########################################
--*/

--Para permitir la visualización de texto en un bloque PL/SQL utilizando DBMS_OUTPUT.PUT_LINE
WHENEVER SQLERROR EXIT SQL.SQLCODE;
SET SERVEROUTPUT ON;
SET DEFINE OFF;

DECLARE

  V_ESQUEMA VARCHAR2(25 CHAR):= '#ESQUEMA#';-- '#ESQUEMA#'; -- Configuracion Esquema
  V_ESQUEMA_M VARCHAR2(25 CHAR):= '#ESQUEMA_MASTER#';-- '#ESQUEMA_MASTER#'; -- Configuracion Esquema Master
  ERR_NUM NUMBER;-- Numero de errores
  ERR_MSG VARCHAR2(2048);-- Mensaje de error

BEGIN
    
    DBMS_OUTPUT.PUT_LINE('[INICIO] Copiado de tablas MIGRACION SAREB en REM.');

    EXECUTE IMMEDIATE 'CREATE TABLE #ESQUEMA#.MIG_ADJ_JUDICIAL_SR AS SELECT * FROM #ESQUEMA#.MIG_ADJ_JUDICIAL';
    EXECUTE IMMEDIATE 'CREATE TABLE #ESQUEMA#.MIG_ADJ_NO_JUDICIAL_SR AS SELECT * FROM #ESQUEMA#.MIG_ADJ_NO_JUDICIAL';
    EXECUTE IMMEDIATE 'CREATE TABLE #ESQUEMA#.MIG_ACA_CABECERA_SR AS SELECT * FROM #ESQUEMA#.MIG_ACA_CABECERA';
    EXECUTE IMMEDIATE 'CREATE TABLE #ESQUEMA#.MIG_ADA_DATOS_ADI_SR AS SELECT * FROM #ESQUEMA#.MIG_ADA_DATOS_ADI';
    EXECUTE IMMEDIATE 'CREATE TABLE #ESQUEMA#.MIG_APL_PLANDINVENTAS_SR AS SELECT * FROM #ESQUEMA#.MIG_APL_PLANDINVENTAS';
    EXECUTE IMMEDIATE 'CREATE TABLE #ESQUEMA#.MIG_APC_PRECIO_SR AS SELECT * FROM #ESQUEMA#.MIG_APC_PRECIO';
    EXECUTE IMMEDIATE 'CREATE TABLE #ESQUEMA#.MIG2_ACT_PRP_SR AS SELECT * FROM #ESQUEMA#.MIG2_ACT_PRP';
    EXECUTE IMMEDIATE 'CREATE TABLE #ESQUEMA#.MIG2_ACT_ACTIVO_SR AS SELECT * FROM #ESQUEMA#.MIG2_ACT_ACTIVO';
    EXECUTE IMMEDIATE 'CREATE TABLE #ESQUEMA#.MIG2_ACQ_ACTIVO_ALQUILER_SR AS SELECT * FROM #ESQUEMA#.MIG2_ACQ_ACTIVO_ALQUILER';
    EXECUTE IMMEDIATE 'CREATE TABLE #ESQUEMA#.MIG2_ACH_ACTIVOS_HITO_SR AS SELECT * FROM #ESQUEMA#.MIG2_ACH_ACTIVOS_HITO';
    EXECUTE IMMEDIATE 'CREATE TABLE #ESQUEMA#.MIG_ATI_TITULO_SR AS SELECT * FROM #ESQUEMA#.MIG_ATI_TITULO';
    EXECUTE IMMEDIATE 'CREATE TABLE #ESQUEMA#.MIG_ADD_ADMISION_DOC_SR AS SELECT * FROM #ESQUEMA#.MIG_ADD_ADMISION_DOC';
    EXECUTE IMMEDIATE 'CREATE TABLE #ESQUEMA#.MIG2_AGR_AGRUPACIONES_SR AS SELECT * FROM #ESQUEMA#.MIG2_AGR_AGRUPACIONES';
    EXECUTE IMMEDIATE 'CREATE TABLE #ESQUEMA#.MIG_AAA_AGRUPACION_ACTIVO_SR AS SELECT * FROM #ESQUEMA#.MIG_AAA_AGRUPACION_ACTIVO';
    EXECUTE IMMEDIATE 'CREATE TABLE #ESQUEMA#.MIG_AAG_AGRUPACIONES_SR AS SELECT * FROM #ESQUEMA#.MIG_AAG_AGRUPACIONES';
    EXECUTE IMMEDIATE 'CREATE TABLE #ESQUEMA#.MIG_ACA_CALIDADES_ACTIVO_SR AS SELECT * FROM #ESQUEMA#.MIG_ACA_CALIDADES_ACTIVO';
    EXECUTE IMMEDIATE 'CREATE TABLE #ESQUEMA#.MIG_ACA_CARGAS_ACTIVO_SR AS SELECT * FROM #ESQUEMA#.MIG_ACA_CARGAS_ACTIVO';
    EXECUTE IMMEDIATE 'CREATE TABLE #ESQUEMA#.MIG_ACA_CATASTRO_ACTIVO_SR AS SELECT * FROM #ESQUEMA#.MIG_ACA_CATASTRO_ACTIVO';
    EXECUTE IMMEDIATE 'CREATE TABLE #ESQUEMA#.MIG2_CLC_CLIENTE_COMERCIAL_SR AS SELECT * FROM #ESQUEMA#.MIG2_CLC_CLIENTE_COMERCIAL';
    EXECUTE IMMEDIATE 'CREATE TABLE #ESQUEMA#.MIG2_GEX_GASTOS_EXPEDIENTE_SR AS SELECT * FROM #ESQUEMA#.MIG2_GEX_GASTOS_EXPEDIENTE';
    EXECUTE IMMEDIATE 'CREATE TABLE #ESQUEMA#.MIG2_COM_COMPRADORES_SR AS SELECT * FROM #ESQUEMA#.MIG2_COM_COMPRADORES';
    EXECUTE IMMEDIATE 'CREATE TABLE #ESQUEMA#.MIG2_CEX_COMPRADOR_EXPEDIEN_SR AS SELECT * FROM #ESQUEMA#.MIG2_CEX_COMPRADOR_EXPEDIENTE';
    EXECUTE IMMEDIATE 'CREATE TABLE #ESQUEMA#.MIG_CPC_PROP_CABECERA_SR AS SELECT * FROM #ESQUEMA#.MIG_CPC_PROP_CABECERA';
    EXECUTE IMMEDIATE 'CREATE TABLE #ESQUEMA#.MIG2_ACT_COE_CONDICION_ESPE_SR AS SELECT * FROM #ESQUEMA#.MIG2_ACT_COE_CONDICIONES_ESPEC';
    EXECUTE IMMEDIATE 'CREATE TABLE #ESQUEMA#.MIG2_COE_CONDICIONA_OFR_ACP_SR AS SELECT * FROM #ESQUEMA#.MIG2_COE_CONDICIONAN_OFR_ACEP';
    EXECUTE IMMEDIATE 'CREATE TABLE #ESQUEMA#.MIG2_GDE_GASTOS_DET_ECONOMI_SR AS SELECT * FROM #ESQUEMA#.MIG2_GDE_GASTOS_DET_ECONOMICO';
    EXECUTE IMMEDIATE 'CREATE TABLE #ESQUEMA#.MIG_AEP_ENTIDAD_PROVEEDOR_SR AS SELECT * FROM #ESQUEMA#.MIG_AEP_ENTIDAD_PROVEEDOR';
    EXECUTE IMMEDIATE 'CREATE TABLE #ESQUEMA#.MIG2_FOR_FORMALIZACIONES_SR AS SELECT * FROM #ESQUEMA#.MIG2_FOR_FORMALIZACIONES';
    EXECUTE IMMEDIATE 'CREATE TABLE #ESQUEMA#.MIG2_GIM_GASTOS_IMPUGNACION_SR AS SELECT * FROM #ESQUEMA#.MIG2_GIM_GASTOS_IMPUGNACION';
    EXECUTE IMMEDIATE 'CREATE TABLE #ESQUEMA#.MIG2_GIC_GASTOS_INFO_CONTAB_SR AS SELECT * FROM #ESQUEMA#.MIG2_GIC_GASTOS_INFO_CONTABI';
    EXECUTE IMMEDIATE 'CREATE TABLE #ESQUEMA#.MIG2_GPV_ACT_TBJ_SR AS SELECT * FROM #ESQUEMA#.MIG2_GPV_ACT_TBJ';
    EXECUTE IMMEDIATE 'CREATE TABLE #ESQUEMA#.MIG2_GPV_GASTOS_PROVEEDORES_SR AS SELECT * FROM #ESQUEMA#.MIG2_GPV_GASTOS_PROVEEDORES';
    EXECUTE IMMEDIATE 'CREATE TABLE #ESQUEMA#.MIG2_GPR_PROVISION_GASTOS_SR AS SELECT * FROM #ESQUEMA#.MIG2_GPR_PROVISION_GASTOS';
    EXECUTE IMMEDIATE 'CREATE TABLE #ESQUEMA#.MIG2_GGE_GASTOS_GESTION_SR AS SELECT * FROM #ESQUEMA#.MIG2_GGE_GASTOS_GESTION';
    EXECUTE IMMEDIATE 'CREATE TABLE #ESQUEMA#.MIG2_GEA_GESTORES_ACTIVOS_SR AS SELECT * FROM #ESQUEMA#.MIG2_GEA_GESTORES_ACTIVOS';
    EXECUTE IMMEDIATE 'CREATE TABLE #ESQUEMA#.MIG2_GEO_GESTORES_OFERTAS_SR AS SELECT * FROM #ESQUEMA#.MIG2_GEO_GESTORES_OFERTAS';
    EXECUTE IMMEDIATE 'CREATE TABLE #ESQUEMA#.MIG2_GRU_GRUPOS_USUARIOS_SR AS SELECT * FROM #ESQUEMA#.MIG2_GRU_GRUPOS_USUARIOS';
    EXECUTE IMMEDIATE 'CREATE TABLE #ESQUEMA#.MIG2_ACT_HVA_HIST_VALORACIO_SR AS SELECT * FROM #ESQUEMA#.MIG2_ACT_HVA_HIST_VALORACIONES';
    EXECUTE IMMEDIATE 'CREATE TABLE #ESQUEMA#.MIG2_ACT_HEP_HIST_EST_PUBLI_SR AS SELECT * FROM #ESQUEMA#.MIG2_ACT_HEP_HIST_EST_PUBLI';
    EXECUTE IMMEDIATE 'CREATE TABLE #ESQUEMA#.MIG_AIA_INFCOMERCIAL_ACT_SR AS SELECT * FROM #ESQUEMA#.MIG_AIA_INFCOMERCIAL_ACT';
    EXECUTE IMMEDIATE 'CREATE TABLE #ESQUEMA#.MIG_AID_INFCOMERCIAL_DISTR_SR AS SELECT * FROM #ESQUEMA#.MIG_AID_INFCOMERCIAL_DISTR';
    EXECUTE IMMEDIATE 'CREATE TABLE #ESQUEMA#.MIG_ALA_LLAVES_ACTIVO_SR AS SELECT * FROM #ESQUEMA#.MIG_ALA_LLAVES_ACTIVO';
    EXECUTE IMMEDIATE 'CREATE TABLE #ESQUEMA#.MIG_AML_MOVIMIENTOS_LLAVE_SR AS SELECT * FROM #ESQUEMA#.MIG_AML_MOVIMIENTOS_LLAVE';
    EXECUTE IMMEDIATE 'CREATE TABLE #ESQUEMA#.MIG_AOA_OBSERVACIONES_ACTIV_SR AS SELECT * FROM #ESQUEMA#.MIG_AOA_OBSERVACIONES_ACTIVOS';
    EXECUTE IMMEDIATE 'CREATE TABLE #ESQUEMA#.MIG_AOA_OBSERVACION_AGRUP_SR AS SELECT * FROM #ESQUEMA#.MIG_AOA_OBSERVACION_AGRUP';
    EXECUTE IMMEDIATE 'CREATE TABLE #ESQUEMA#.MIG2_OFA_OFERTAS_ACTIVO_SR AS SELECT * FROM #ESQUEMA#.MIG2_OFA_OFERTAS_ACTIVO';
    EXECUTE IMMEDIATE 'CREATE TABLE #ESQUEMA#.MIG2_OFR_OFERTAS_SR AS SELECT * FROM #ESQUEMA#.MIG2_OFR_OFERTAS';
    EXECUTE IMMEDIATE 'CREATE TABLE #ESQUEMA#.MIG2_OBF_OBSERVACIONES_OFER_SR AS SELECT * FROM #ESQUEMA#.MIG2_OBF_OBSERVACIONES_OFERTAS';
    EXECUTE IMMEDIATE 'CREATE TABLE #ESQUEMA#.MIG2_PAC_PERIMETRO_ACTIVO_SR AS SELECT * FROM #ESQUEMA#.MIG2_PAC_PERIMETRO_ACTIVO';
    EXECUTE IMMEDIATE 'CREATE TABLE #ESQUEMA#.MIG2_POS_POSICIONAMIENTO_SR AS SELECT * FROM #ESQUEMA#.MIG2_POS_POSICIONAMIENTO';
    EXECUTE IMMEDIATE 'CREATE TABLE #ESQUEMA#.MIG_APT_PRESUPUESTO_TRABAJO_SR AS SELECT * FROM #ESQUEMA#.MIG_APT_PRESUPUESTO_TRABAJO';
    EXECUTE IMMEDIATE 'CREATE TABLE #ESQUEMA#.MIG_APA_PROP_ACTIVO_SR AS SELECT * FROM #ESQUEMA#.MIG_APA_PROP_ACTIVO';
    EXECUTE IMMEDIATE 'CREATE TABLE #ESQUEMA#.MIG_APC_PROP_CABECERA_SR AS SELECT * FROM #ESQUEMA#.MIG_APC_PROP_CABECERA';
    EXECUTE IMMEDIATE 'CREATE TABLE #ESQUEMA#.MIG2_PRO_PROPIETARIOS_SR AS SELECT * FROM #ESQUEMA#.MIG2_PRO_PROPIETARIOS';
    EXECUTE IMMEDIATE 'CREATE TABLE #ESQUEMA#.MIG2_PRH_PROP_HIST_SR AS SELECT * FROM #ESQUEMA#.MIG2_PRH_PROP_HIST';
    EXECUTE IMMEDIATE 'CREATE TABLE #ESQUEMA#.MIG2_PRP_PROPUESTAS_PRECIOS_SR AS SELECT * FROM #ESQUEMA#.MIG2_PRP_PROPUESTAS_PRECIOS';
    EXECUTE IMMEDIATE 'CREATE TABLE #ESQUEMA#.MIG2_PVC_PROVEEDOR_CONTACTO_SR AS SELECT * FROM #ESQUEMA#.MIG2_PVC_PROVEEDOR_CONTACTO';
    EXECUTE IMMEDIATE 'CREATE TABLE #ESQUEMA#.MIG2_PVE_PROVEEDORES_SR AS SELECT * FROM #ESQUEMA#.MIG2_PVE_PROVEEDORES';
    EXECUTE IMMEDIATE 'CREATE TABLE #ESQUEMA#.MIG2_PRD_PROVEEDOR_DIRECCIO_SR AS SELECT * FROM #ESQUEMA#.MIG2_PRD_PROVEEDOR_DIRECCION';
    EXECUTE IMMEDIATE 'CREATE TABLE #ESQUEMA#.MIG2_RES_RESERVAS_SR AS SELECT * FROM #ESQUEMA#.MIG2_RES_RESERVAS';
    EXECUTE IMMEDIATE 'CREATE TABLE #ESQUEMA#.MIG2_SUB_SUBSANACIONES_SR AS SELECT * FROM #ESQUEMA#.MIG2_SUB_SUBSANACIONES';
    EXECUTE IMMEDIATE 'CREATE TABLE #ESQUEMA#.MIG_ATA_TASACIONES_ACTIVO_SR AS SELECT * FROM #ESQUEMA#.MIG_ATA_TASACIONES_ACTIVO';
    EXECUTE IMMEDIATE 'CREATE TABLE #ESQUEMA#.MIG2_OFR_TIA_TITULARES_ADI_SR AS SELECT * FROM #ESQUEMA#.MIG2_OFR_TIA_TITULARES_ADI';
    EXECUTE IMMEDIATE 'CREATE TABLE #ESQUEMA#.MIG_ATR_TRABAJO_SR AS SELECT * FROM #ESQUEMA#.MIG_ATR_TRABAJO';
    EXECUTE IMMEDIATE 'CREATE TABLE #ESQUEMA#.MIG2_USU_USUARIOS_SR AS SELECT * FROM #ESQUEMA#.MIG2_USU_USUARIOS';
    EXECUTE IMMEDIATE 'CREATE TABLE #ESQUEMA#.MIG2_VIS_VISITAS_SR AS SELECT * FROM #ESQUEMA#.MIG2_VIS_VISITAS';
    EXECUTE IMMEDIATE 'CREATE TABLE #ESQUEMA#.MIG_UPDATE_CAMPOS_SR AS SELECT * FROM #ESQUEMA#.MIG_UPDATE_CAMPOS';

    DBMS_OUTPUT.PUT_LINE('[FIN] Copiado de tablas MIGRACION SAREB en REM.');

EXCEPTION
    WHEN OTHERS THEN
      DBMS_OUTPUT.PUT_LINE('[ERROR] Se ha producido un error en la ejecución:'||TO_CHAR(SQLCODE));
      DBMS_OUTPUT.PUT_LINE('-----------------------------------------------------------');
      DBMS_OUTPUT.PUT_LINE(SQLERRM);
      ROLLBACK;
      RAISE;
END;
/
EXIT