--/*
--##########################################
--## AUTOR=Pablo Meseguer
--## FECHA_CREACION=20171114
--## ARTEFACTO=online
--## VERSION_ARTEFACTO=9.2
--## INCIDENCIA_LINK=RECOVERY_9933
--## PRODUCTO=NO
--##
--## Finalidad: Insercion en la TMP_APROV_DACIONES
--## INSTRUCCIONES:
--## VERSIONES:
--##        0.1 Versión inicial
--##########################################
--*/


WHENEVER SQLERROR EXIT SQL.SQLCODE;
SET SERVEROUTPUT ON; 
SET DEFINE OFF;


DECLARE
    V_MSQL VARCHAR2(32000 CHAR); -- Sentencia a ejecutar     
    V_ESQUEMA VARCHAR2(25 CHAR):= 'PFSREM'; -- Configuracion Esquema
    V_ESQUEMA_M VARCHAR2(25 CHAR):= '#ESQUEMA_MASTER#'; -- Configuracion Esquema Master
    V_SQL VARCHAR2(4000 CHAR); -- Vble. para consulta que valida la existencia de una tabla.
    V_NUM_TABLAS NUMBER(16); -- Vble. para validar la existencia de una tabla.   
    ERR_NUM NUMBER(25);  -- Vble. auxiliar para registrar errores en el script.
    ERR_MSG VARCHAR2(1024 CHAR); -- Vble. auxiliar para registrar errores en el script.
	
    V_TEXT1 VARCHAR2(2400 CHAR); -- Vble. auxiliar
    V_ENTIDAD_ID NUMBER(16);
    V_ID NUMBER(16);
    V_SEQ_GEH NUMBER(16);
	V_TIPO_ID NUMBER(16); --Vle para el id DD_TTR_TIPO_TRABAJO
    
    
    TYPE T_TIPO_DATA IS TABLE OF VARCHAR2(150);
    TYPE T_ARRAY_DATA IS TABLE OF T_TIPO_DATA;
    V_TIPO_DATA T_ARRAY_DATA := T_ARRAY_DATA(
    	--		BIE_ENTIDAD_ID	
		T_TIPO_DATA('146618'),
		T_TIPO_DATA('174671'),
		T_TIPO_DATA('69408'),
		T_TIPO_DATA('69086'),
		T_TIPO_DATA('160988'),
		T_TIPO_DATA('152798'),
		T_TIPO_DATA('174553'),
		T_TIPO_DATA('179822'),
		T_TIPO_DATA('160989'),
		T_TIPO_DATA('127688'),
		T_TIPO_DATA('128581'),
		T_TIPO_DATA('128582'),
		T_TIPO_DATA('125682'),
		T_TIPO_DATA('105436'),
		T_TIPO_DATA('125869'),
		T_TIPO_DATA('104899'),
		T_TIPO_DATA('128583'),
		T_TIPO_DATA('128723'),
		T_TIPO_DATA('125714'),
		T_TIPO_DATA('128724'),
		T_TIPO_DATA('125809'),
		T_TIPO_DATA('128810'),
		T_TIPO_DATA('129005'),
		T_TIPO_DATA('127508'),
		T_TIPO_DATA('105122'),
		T_TIPO_DATA('105437'),
		T_TIPO_DATA('128584'),
		T_TIPO_DATA('127560'),
		T_TIPO_DATA('128585'),
		T_TIPO_DATA('104900'),
		T_TIPO_DATA('128811'),
		T_TIPO_DATA('127689'),
		T_TIPO_DATA('127561'),
		T_TIPO_DATA('127690'),
		T_TIPO_DATA('125683'),
		T_TIPO_DATA('125870'),
		T_TIPO_DATA('128725'),
		T_TIPO_DATA('125684'),
		T_TIPO_DATA('125810'),
		T_TIPO_DATA('128726'),
		T_TIPO_DATA('127362'),
		T_TIPO_DATA('128727'),
		T_TIPO_DATA('105438'),
		T_TIPO_DATA('128812'),
		T_TIPO_DATA('105512'),
		T_TIPO_DATA('129006'),
		T_TIPO_DATA('125685'),
		T_TIPO_DATA('105123'),
		T_TIPO_DATA('127363'),
		T_TIPO_DATA('127562'),
		T_TIPO_DATA('105439'),
		T_TIPO_DATA('105693'),
		T_TIPO_DATA('125715'),
		T_TIPO_DATA('127509'),
		T_TIPO_DATA('127510'),
		T_TIPO_DATA('105440'),
		T_TIPO_DATA('128586'),
		T_TIPO_DATA('125716'),
		T_TIPO_DATA('105441'),
		T_TIPO_DATA('128813'),
		T_TIPO_DATA('104901'),
		T_TIPO_DATA('127691'),
		T_TIPO_DATA('125686'),
		T_TIPO_DATA('104902'),
		T_TIPO_DATA('125717'),
		T_TIPO_DATA('127563'),
		T_TIPO_DATA('128587'),
		T_TIPO_DATA('127511'),
		T_TIPO_DATA('128588'),
		T_TIPO_DATA('105124'),
		T_TIPO_DATA('125871'),
		T_TIPO_DATA('125718'),
		T_TIPO_DATA('105694'),
		T_TIPO_DATA('104903'),
		T_TIPO_DATA('128589'),
		T_TIPO_DATA('125872'),
		T_TIPO_DATA('105442'),
		T_TIPO_DATA('104904'),
		T_TIPO_DATA('125687'),
		T_TIPO_DATA('127512'),
		T_TIPO_DATA('105125'),
		T_TIPO_DATA('127692'),
		T_TIPO_DATA('128728'),
		T_TIPO_DATA('127364'),
		T_TIPO_DATA('127564'),
		T_TIPO_DATA('128590'),
		T_TIPO_DATA('125688'),
		T_TIPO_DATA('105126'),
		T_TIPO_DATA('104905'),
		T_TIPO_DATA('127513'),
		T_TIPO_DATA('105695'),
		T_TIPO_DATA('127565'),
		T_TIPO_DATA('125811'),
		T_TIPO_DATA('127693'),
		T_TIPO_DATA('129007'),
		T_TIPO_DATA('127694'),
		T_TIPO_DATA('105696'),
		T_TIPO_DATA('105443'),
		T_TIPO_DATA('127566'),
		T_TIPO_DATA('127514'),
		T_TIPO_DATA('128729'),
		T_TIPO_DATA('128814'),
		T_TIPO_DATA('128730'),
		T_TIPO_DATA('121863'),
		T_TIPO_DATA('192715'),
		T_TIPO_DATA('181544'),
		T_TIPO_DATA('121496'),
		T_TIPO_DATA('118631'),
		T_TIPO_DATA('185086'),
		T_TIPO_DATA('193650'),
		T_TIPO_DATA('121065'),
		T_TIPO_DATA('199093'),
		T_TIPO_DATA('172829'),
		T_TIPO_DATA('154160'),
		T_TIPO_DATA('139179'),
		T_TIPO_DATA('174028'),
		T_TIPO_DATA('160802'),
		T_TIPO_DATA('160755'),
		T_TIPO_DATA('160756'),
		T_TIPO_DATA('174108'),
		T_TIPO_DATA('174109'),
		T_TIPO_DATA('174209'),
		T_TIPO_DATA('174580'),
		T_TIPO_DATA('174110'),
		T_TIPO_DATA('171396'),
		T_TIPO_DATA('160913'),
		T_TIPO_DATA('65516'),
		T_TIPO_DATA('174212'),
		T_TIPO_DATA('65517'),
		T_TIPO_DATA('65186'),
		T_TIPO_DATA('65187'),
		T_TIPO_DATA('171331'),
		T_TIPO_DATA('171332'),
		T_TIPO_DATA('65423'),
		T_TIPO_DATA('65188'),
		T_TIPO_DATA('171036'),
		T_TIPO_DATA('171632'),
		T_TIPO_DATA('161187'),
		T_TIPO_DATA('179440'),
		T_TIPO_DATA('179719'),
		T_TIPO_DATA('117909'),
		T_TIPO_DATA('119259'),
		T_TIPO_DATA('100662'),
		T_TIPO_DATA('119015'),
		T_TIPO_DATA('151663'),
		T_TIPO_DATA('170477'),
		T_TIPO_DATA('65895'),
		T_TIPO_DATA('73707'),
		T_TIPO_DATA('124834'),
		T_TIPO_DATA('77609'),
		T_TIPO_DATA('6846857'),
		T_TIPO_DATA('6847071'),
		T_TIPO_DATA('6846992'),
		T_TIPO_DATA('6846681'),
		T_TIPO_DATA('6846841'),
		T_TIPO_DATA('6846971'),
		T_TIPO_DATA('6846697'),
		T_TIPO_DATA('86440'),
		T_TIPO_DATA('79864'),
		T_TIPO_DATA('81640'),
		T_TIPO_DATA('69849'),
		T_TIPO_DATA('80367'),
		T_TIPO_DATA('69798'),
		T_TIPO_DATA('70001'),
		T_TIPO_DATA('79865'),
		T_TIPO_DATA('75851'),
		T_TIPO_DATA('75777'),
		T_TIPO_DATA('70002'),
		T_TIPO_DATA('79866'),
		T_TIPO_DATA('80208'),
		T_TIPO_DATA('81444'),
		T_TIPO_DATA('80209'),
		T_TIPO_DATA('69616'),
		T_TIPO_DATA('81877'),
		T_TIPO_DATA('75454'),
		T_TIPO_DATA('69617'),
		T_TIPO_DATA('69799'),
		T_TIPO_DATA('81878'),
		T_TIPO_DATA('76160'),
		T_TIPO_DATA('75852'),
		T_TIPO_DATA('75853'),
		T_TIPO_DATA('75324'),
		T_TIPO_DATA('81879'),
		T_TIPO_DATA('75854'),
		T_TIPO_DATA('81641'),
		T_TIPO_DATA('76161'),
		T_TIPO_DATA('79867'),
		T_TIPO_DATA('75855'),
		T_TIPO_DATA('69800'),
		T_TIPO_DATA('75325'),
		T_TIPO_DATA('75326'),
		T_TIPO_DATA('75778'),
		T_TIPO_DATA('76162'),
		T_TIPO_DATA('69801'),
		T_TIPO_DATA('80119'),
		T_TIPO_DATA('80210'),
		T_TIPO_DATA('75327'),
		T_TIPO_DATA('69802'),
		T_TIPO_DATA('69803'),
		T_TIPO_DATA('75779'),
		T_TIPO_DATA('70003'),
		T_TIPO_DATA('75780'),
		T_TIPO_DATA('75328'),
		T_TIPO_DATA('70004'),
		T_TIPO_DATA('81722'),
		T_TIPO_DATA('80120'),
		T_TIPO_DATA('75781'),
		T_TIPO_DATA('70005'),
		T_TIPO_DATA('75329'),
		T_TIPO_DATA('76163'),
		T_TIPO_DATA('69618'),
		T_TIPO_DATA('80121'),
		T_TIPO_DATA('75782'),
		T_TIPO_DATA('69850'),
		T_TIPO_DATA('76164'),
		T_TIPO_DATA('156450'),
		T_TIPO_DATA('159237'),
		T_TIPO_DATA('124333'),
		T_TIPO_DATA('124113'),
		T_TIPO_DATA('128987'),
		T_TIPO_DATA('124114'),
		T_TIPO_DATA('123734'),
		T_TIPO_DATA('123151'),
		T_TIPO_DATA('124334'),
		T_TIPO_DATA('123878'),
		T_TIPO_DATA('128597'),
		T_TIPO_DATA('123152'),
		T_TIPO_DATA('128627'),
		T_TIPO_DATA('128988'),
		T_TIPO_DATA('122558'),
		T_TIPO_DATA('128628'),
		T_TIPO_DATA('128538'),
		T_TIPO_DATA('122757'),
		T_TIPO_DATA('107770'),
		T_TIPO_DATA('128629'),
		T_TIPO_DATA('107385'),
		T_TIPO_DATA('124115'),
		T_TIPO_DATA('122640'),
		T_TIPO_DATA('107771'),
		T_TIPO_DATA('107386'),
		T_TIPO_DATA('124116'),
		T_TIPO_DATA('124335'),
		T_TIPO_DATA('128630'),
		T_TIPO_DATA('107772'),
		T_TIPO_DATA('122559'),
		T_TIPO_DATA('107387'),
		T_TIPO_DATA('128989'),
		T_TIPO_DATA('128631'),
		T_TIPO_DATA('128539'),
		T_TIPO_DATA('128632'),
		T_TIPO_DATA('123153'),
		T_TIPO_DATA('128540'),
		T_TIPO_DATA('123909'),
		T_TIPO_DATA('122560'),
		T_TIPO_DATA('107388'),
		T_TIPO_DATA('107773'),
		T_TIPO_DATA('128598'),
		T_TIPO_DATA('122758'),
		T_TIPO_DATA('123910'),
		T_TIPO_DATA('128633'),
		T_TIPO_DATA('128599'),
		T_TIPO_DATA('128541'),
		T_TIPO_DATA('123911'),
		T_TIPO_DATA('107389'),
		T_TIPO_DATA('128542'),
		T_TIPO_DATA('123154'),
		T_TIPO_DATA('122869'),
		T_TIPO_DATA('123155'),
		T_TIPO_DATA('107390'),
		T_TIPO_DATA('107499'),
		T_TIPO_DATA('128990'),
		T_TIPO_DATA('107391'),
		T_TIPO_DATA('107500'),
		T_TIPO_DATA('122870'),
		T_TIPO_DATA('128543'),
		T_TIPO_DATA('107392'),
		T_TIPO_DATA('107501'),
		T_TIPO_DATA('122641'),
		T_TIPO_DATA('122642'),
		T_TIPO_DATA('123735'),
		T_TIPO_DATA('107502'),
		T_TIPO_DATA('123736'),
		T_TIPO_DATA('128991'),
		T_TIPO_DATA('128634'),
		T_TIPO_DATA('128544'),
		T_TIPO_DATA('128600'),
		T_TIPO_DATA('123156'),
		T_TIPO_DATA('107774'),
		T_TIPO_DATA('107775'),
		T_TIPO_DATA('123912'),
		T_TIPO_DATA('122643'),
		T_TIPO_DATA('128745'),
		T_TIPO_DATA('107776'),
		T_TIPO_DATA('107393'),
		T_TIPO_DATA('128992'),
		T_TIPO_DATA('107357'),
		T_TIPO_DATA('107777'),
		T_TIPO_DATA('122561'),
		T_TIPO_DATA('123157'),
		T_TIPO_DATA('128993'),
		T_TIPO_DATA('107394'),
		T_TIPO_DATA('128545'),
		T_TIPO_DATA('122871'),
		T_TIPO_DATA('128994'),
		T_TIPO_DATA('124336'),
		T_TIPO_DATA('128601'),
		T_TIPO_DATA('107778'),
		T_TIPO_DATA('122562'),
		T_TIPO_DATA('122644'),
		T_TIPO_DATA('107503'),
		T_TIPO_DATA('122563'),
		T_TIPO_DATA('128602'),
		T_TIPO_DATA('128746'),
		T_TIPO_DATA('128603'),
		T_TIPO_DATA('122795'),
		T_TIPO_DATA('122564'),
		T_TIPO_DATA('123737'),
		T_TIPO_DATA('123913'),
		T_TIPO_DATA('99009'),
		T_TIPO_DATA('86469'),
		T_TIPO_DATA('98927'),
		T_TIPO_DATA('86661'),
		T_TIPO_DATA('97179'),
		T_TIPO_DATA('86470'),
		T_TIPO_DATA('96866'),
		T_TIPO_DATA('99211'),
		T_TIPO_DATA('99010'),
		T_TIPO_DATA('86471'),
		T_TIPO_DATA('98928'),
		T_TIPO_DATA('87128'),
		T_TIPO_DATA('91333'),
		T_TIPO_DATA('99452'),
		T_TIPO_DATA('86662'),
		T_TIPO_DATA('86472'),
		T_TIPO_DATA('90866'),
		T_TIPO_DATA('99453'),
		T_TIPO_DATA('98929'),
		T_TIPO_DATA('98930'),
		T_TIPO_DATA('87129'),
		T_TIPO_DATA('86401'),
		T_TIPO_DATA('86534'),
		T_TIPO_DATA('97180'),
		T_TIPO_DATA('87130'),
		T_TIPO_DATA('97181'),
		T_TIPO_DATA('86473'),
		T_TIPO_DATA('87131'),
		T_TIPO_DATA('87132'),
		T_TIPO_DATA('86474'),
		T_TIPO_DATA('91334'),
		T_TIPO_DATA('91335'),
		T_TIPO_DATA('91336'),
		T_TIPO_DATA('90932')
	); 
    V_TMP_TIPO_DATA T_TIPO_DATA;
    
BEGIN	
	
	DBMS_OUTPUT.PUT_LINE('[INICIO] ');

	 
    -- LOOP para insertar los valores en TMP_APROV_DACIONES -----------------------------------------------------------------
    DBMS_OUTPUT.PUT_LINE('[INICIO] '||V_ESQUEMA||'.TMP_APROV_DACIONES... Empezando a insertar datos en la tabla TMP_APROV_DACIONES');
    FOR I IN V_TIPO_DATA.FIRST .. V_TIPO_DATA.LAST
      LOOP
      
        V_TMP_TIPO_DATA := V_TIPO_DATA(I);
    
   		V_MSQL := 'INSERT INTO '||V_ESQUEMA||'.TMP_APROV_DACIONES(BIE_ENTIDAD_ID)
			  VALUES('||V_TMP_TIPO_DATA(1)||')';
		EXECUTE IMMEDIATE V_MSQL;
		DBMS_OUTPUT.PUT_LINE('INSERTANDO BIE_ENTIDAD_ID: '''||V_TMP_TIPO_DATA(1)||'''');
		
    END LOOP;
    COMMIT;
    DBMS_OUTPUT.PUT_LINE('[FIN] '||V_ESQUEMA||'.TMP_APROV_DACIONES... Datos de la tabla insertados');
   

EXCEPTION
     WHEN OTHERS THEN
          err_num := SQLCODE;
          err_msg := SQLERRM;

          DBMS_OUTPUT.put_line('[ERROR] Se ha producido un error en la ejecución:'||TO_CHAR(err_num));
          DBMS_OUTPUT.put_line('-----------------------------------------------------------'); 
          DBMS_OUTPUT.put_line(err_msg);

          ROLLBACK;
          RAISE;          

END;

/

EXIT


