--/*
--##########################################
--## AUTOR=Sergio Ortuño
--## FECHA_CREACION=20171227
--## ARTEFACTO=online
--## VERSION_ARTEFACTO=9.2.20
--## INCIDENCIA_LINK=HRNIVDOS-7254
--## PRODUCTO=NO
--## Finalidad: Limpieza de bienes
--##           
--## INSTRUCCIONES: Configurar las variables necesarias en el principio del DECLARE
--## VERSIONES:
--##        0.1 Versión inicial
--##########################################
--*/

WHENEVER SQLERROR EXIT SQL.SQLCODE;
SET SERVEROUTPUT ON;
SET DEFINE OFF;

DECLARE
	V_MSQL VARCHAR2(32000 CHAR); 
	V_ESQUEMA VARCHAR2(25 CHAR):= '#ESQUEMA#'; 
	V_ESQUEMA_M VARCHAR2(25 CHAR):= '#ESQUEMA_MASTER#'; 
	V_NUM_EXISTE NUMBER(16);  
	ERR_NUM NUMBER(25); 
	ERR_MSG VARCHAR2(1024 CHAR); 

BEGIN

	DBMS_OUTPUT.PUT_LINE('[INFO] Comienzo del punto 1');	

	V_MSQL := 'UPDATE '||V_ESQUEMA||'.ACT_ACTIVO SET ACT_NUM_ACTIVO_SAREB = ''655066'', FECHAMODIFICAR = SYSDATE, USUARIOMODIFICAR = ''HRNIVDOS-7254'' WHERE ACT_NUM_ACTIVO = 192028';
	

	DBMS_OUTPUT.PUT_LINE('[INFO] Actualizado el primer activo');
	EXECUTE IMMEDIATE V_MSQL;

	V_MSQL := 'UPDATE '||V_ESQUEMA||'.ACT_ACTIVO SET ACT_NUM_ACTIVO_SAREB = ''9009689'', FECHAMODIFICAR = SYSDATE, USUARIOMODIFICAR = ''HRNIVDOS-7254'' WHERE ACT_NUM_ACTIVO = 190769';

	DBMS_OUTPUT.PUT_LINE('[INFO] Actualizado el segundo activo');
	EXECUTE IMMEDIATE V_MSQL;


	DBMS_OUTPUT.PUT_LINE('[INFO] Comienzo del punto 2');

	V_MSQL := 'UPDATE '||V_ESQUEMA||'.ACT_ACTIVO SET ACT_NUM_ACTIVO_UVEM = 30045848, FECHAMODIFICAR = SYSDATE, USUARIOMODIFICAR = ''HRNIVDOS-7254'' WHERE ACT_NUM_ACTIVO = 62927';

	DBMS_OUTPUT.PUT_LINE('[INFO] Actualizado el tercer activo');
	EXECUTE IMMEDIATE V_MSQL;


	DBMS_OUTPUT.PUT_LINE('[INFO] Comienzo del punto 3');

	V_MSQL := 'UPDATE '||V_ESQUEMA||'.ACT_ACTIVO SET ACT_NUM_ACTIVO = 190022, FECHAMODIFICAR = SYSDATE, USUARIOMODIFICAR = ''HRNIVDOS-7254'' WHERE ACT_NUM_ACTIVO_REM = 122847';

	DBMS_OUTPUT.PUT_LINE('[INFO] Actualizado el cuarto activo');
	EXECUTE IMMEDIATE V_MSQL;

	V_MSQL := 'UPDATE '||V_ESQUEMA||'.ACT_ACTIVO SET ACT_NUM_ACTIVO = 191743, FECHAMODIFICAR = SYSDATE, USUARIOMODIFICAR = ''HRNIVDOS-7254'' WHERE ACT_NUM_ACTIVO_REM = 122851';

	DBMS_OUTPUT.PUT_LINE('[INFO] Actualizado el quinto activo');
	EXECUTE IMMEDIATE V_MSQL;


	COMMIT;

	DBMS_OUTPUT.PUT_LINE('[INFO] Terminada la recodificacion');

EXCEPTION
	WHEN OTHERS THEN
		ERR_NUM := SQLCODE;
		ERR_MSG := SQLERRM;
		DBMS_OUTPUT.PUT_LINE('[ERROR] Se ha producido un error en la ejecución:'||TO_CHAR(ERR_NUM));
		DBMS_OUTPUT.PUT_LINE('-----------------------------------------------------------');
		DBMS_OUTPUT.PUT_LINE(ERR_MSG);
		ROLLBACK;
		RAISE;

END;
/

EXIT;
