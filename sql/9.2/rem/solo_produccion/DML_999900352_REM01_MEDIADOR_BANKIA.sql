--/*
--#########################################
--## AUTOR=JINLI, HU
--## FECHA_CREACION=20181009
--## ARTEFACTO=batch
--## VERSION_ARTEFACTO=?
--## INCIDENCIA_LINK=REMVIP-2204
--## PRODUCTO=NO
--## 
--## Finalidad: 
--## INSTRUCCIONES:  
--## VERSIONES:
--##        0.1 Versión inicial
--#########################################
--*/
--Para permitir la visualización de texto en un bloque PL/SQL utilizando DBMS_OUTPUT.PUT_LINE
WHENEVER SQLERROR EXIT SQL.SQLCODE;
SET SERVEROUTPUT ON;
SET DEFINE OFF;

DECLARE

	V_TABLA VARCHAR2(30 CHAR) := 'ACT_ICO_INFO_COMERCIAL'; -- Variable para tabla de salida para el borrado
	V_ESQUEMA VARCHAR2(25 CHAR):= 'REM01';-- '#ESQUEMA#'; -- Configuracion Esquema
	V_ESQUEMA_M VARCHAR2(25 CHAR):= 'REMMASTER';-- '#ESQUEMA_MASTER#'; -- Configuracion Esquema Master
	ERR_NUM NUMBER;-- Numero de errores
	ERR_MSG VARCHAR2(2048);-- Mensaje de error
	V_SQL VARCHAR2(32767 CHAR);
	PL_OUTPUT VARCHAR2(32000 CHAR);
	V_USUARIO VARCHAR2(50 CHAR) := 'REMVIP-2204';

BEGIN
	
	PL_OUTPUT := '[INICIO]'||CHR(10);

	V_SQL := 'UPDATE '||V_ESQUEMA||'.'||V_TABLA||'
			  SET ICO_MEDIADOR_ID = (SELECT PVE_ID FROM '||V_ESQUEMA||'.ACT_PVE_PROVEEDOR WHERE PVE_COD_REM = ''2264''),
			  USUARIOMODIFICAR = ''REMVIP-2204'',
			  FECHAMODIFICAR = SYSDATE
			  WHERE ACT_ID IN (SELECT ACT.ACT_ID FROM ACT_ACTIVO ACT WHERE ACT_NUM_ACTIVO_REM IN(
																						''276208'',
																						''288475'',
																						''278217'',
																						''289066'',
																						''288144'',
																						''290058'',
																						''293568'',
																						''287852'',
																						''283376'',
																						''293286'',
																						''278459'',
																						''277887'',
																						''279263'',
																						''283565'',
																						''282779'',
																						''277041'',
																						''293647'',
																						''281280'',
																						''280888'',
																						''284802'',
																						''281032'',
																						''283781'',
																						''285134'',
																						''284002'',
																						''282503'',
																						''289444'',
																						''286707'',
																						''288188'',
																						''277538'',
																						''276308'',
																						''277891'',
																						''290212'',
																						''276839'',
																						''289518'',
																						''279674'',
																						''286722'',
																						''277343'',
																						''285757'',
																						''289645'',
																						''289449'',
																						''288838'',
																						''285521'',
																						''277379'',
																						''278739'',
																						''283600'',
																						''288514'',
																						''277787'',
																						''284625'',
																						''276713'',
																						''287406'',
																						''283201'',
																						''281325'',
																						''283626'',
																						''277911'',
																						''284651'',
																						''289209'',
																						''286932'',
																						''285167'',
																						''277841'',
																						''282456'',
																						''281551'',
																						''283585'',
																						''285259'',
																						''277426'',
																						''284710'',
																						''290275'',
																						''278337'',
																						''277932'',
																						''287072'',
																						''285561'',
																						''285838'',
																						''287725'',
																						''285741'',
																						''277037'',
																						''278694'',
																						''279336'',
																						''283773'',
																						''281972'',
																						''284015'',
																						''277194'',
																						''277202'',
																						''289700'',
																						''276445'',
																						''277074'',
																						''279353'',
																						''279749'',
																						''285102'',
																						''284295'',
																						''277685'',
																						''284422'',
																						''277190'',
																						''282573'',
																						''276491'',
																						''285924'',
																						''280240'',
																						''288847'',
																						''276363'',
																						''278563'',
																						''285122'',
																						''290601'',
																						''279010'',
																						''282798'',
																						''286294'',
																						''285589'',
																						''282579'',
																						''293196'',
																						''284918'',
																						''289237'',
																						''283054'',
																						''285718'',
																						''287199'',
																						''281897'',
																						''284545'',
																						''286127'',
																						''283257'',
																						''279325'',
																						''278339'',
																						''281760'',
																						''286805'',
																						''284207'',
																						''290493'',
																						''285336'',
																						''278517'',
																						''282809'',
																						''289077'',
																						''284963'',
																						''287933'',
																						''283491'',
																						''283485'',
																						''277047'',
																						''285018'',
																						''285229'',
																						''281009'',
																						''276394'',
																						''288416'',
																						''288156'',
																						''287441'',
																						''276996'',
																						''285598'',
																						''284205'',
																						''284996'',
																						''293325'',
																						''283628'',
																						''278031'',
																						''277521'',
																						''293580'',
																						''290338'',
																						''293539'',
																						''282073'',
																						''287708'',
																						''289063'',
																						''293207'',
																						''281587'',
																						''287747'',
																						''282711'',
																						''288582'',
																						''281320'',
																						''282848'',
																						''289174'',
																						''284877'',
																						''282409'',
																						''283488'',
																						''283199'',
																						''278608'',
																						''284451'',
																						''276809'',
																						''277320'',
																						''288040'',
																						''287342'',
																						''276612'',
																						''278923'',
																						''276964'',
																						''287009'',
																						''288349'',
																						''286506'',
																						''281699'',
																						''277929'',
																						''280466'',
																						''277752'',
																						''279372'',
																						''279191'',
																						''286419'',
																						''289267'',
																						''276957'',
																						''276659'',
																						''293623'',
																						''290889'',
																						''283194'',
																						''285286'',
																						''276243'',
																						''282648'',
																						''288642'',
																						''280588'',
																						''290623'',
																						''288544'',
																						''280760'',
																						''286106'',
																						''276602'',
																						''289814'',
																						''284593'',
																						''283993'',
																						''287749'',
																						''290030'',
																						''283008'',
																						''276099'',
																						''279960'',
																						''278514'',
																						''283490'',
																						''287867'',
																						''279861'',
																						''290205'',
																						''278229'',
																						''277625'',
																						''282378'',
																						''287003'',
																						''286328'',
																						''293174'',
																						''288224'',
																						''277080'',
																						''288042'',
																						''277523'',
																						''286320'',
																						''280990'',
																						''276890'',
																						''293094'',
																						''293482'',
																						''278562'',
																						''281880'',
																						''282064'',
																						''284141'')
						)
	';
	
	EXECUTE IMMEDIATE V_SQL;

	COMMIT;

	PL_OUTPUT := PL_OUTPUT || '[FIN]'||CHR(10);
	DBMS_OUTPUT.PUT_LINE(PL_OUTPUT);

EXCEPTION
    WHEN OTHERS THEN
      PL_OUTPUT := PL_OUTPUT ||'[ERROR] Se ha producido un error en la ejecución:'||TO_CHAR(SQLCODE)||CHR(10);
      PL_OUTPUT := PL_OUTPUT ||'-----------------------------------------------------------'||CHR(10);
      PL_OUTPUT := PL_OUTPUT ||SQLERRM||CHR(10);
      PL_OUTPUT := PL_OUTPUT ||V_SQL||CHR(10);
      DBMS_OUTPUT.PUT_LINE(PL_OUTPUT);
      ROLLBACK;
      RAISE;
END;
/
EXIT;
