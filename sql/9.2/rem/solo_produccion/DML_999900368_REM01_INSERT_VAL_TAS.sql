--/*
--#########################################
--## AUTOR=JINLI HU
--## FECHA_CREACION=20181021
--## ARTEFACTO=batch
--## VERSION_ARTEFACTO=9.2
--## INCIDENCIA_LINK=REMVIP-2207
--## PRODUCTO=NO
--## 
--## Finalidad: 
--##            
--## INSTRUCCIONES:  
--## VERSIONES:
--##        0.1 Versión inicial
--#########################################
--*/
--Para permitir la visualización de texto en un bloque PL/SQL utilizando DBMS_OUTPUT.PUT_LINE
WHENEVER SQLERROR EXIT SQL.SQLCODE;
SET SERVEROUTPUT ON;
SET DEFINE OFF;

DECLARE
    V_SQL VARCHAR2(32000 CHAR); -- Sentencia a ejecutar         
    V_ESQUEMA VARCHAR2(25 CHAR):= 'REM01'; --'#ESQUEMA#'; -- Configuracion Esquema
    V_ESQUEMA_M VARCHAR2(25 CHAR):= 'REMMASTER'; --'#ESQUEMA_MASTER#'; -- Configuracion Esquema Master
    V_TABLA_1 VARCHAR2(25 CHAR):= 'BIE_VALORACIONES';
    V_TABLA_2 VARCHAR2(25 CHAR):= 'ACT_TAS_TASACION';
    V_COUNT NUMBER(16); -- Vble. para contar.
    V_KOUNT NUMBER(16); -- Vble. para kontar.
    V_COUNT_UPDATE NUMBER(16):= 0; -- Vble. para contar updates
    ERR_NUM NUMBER(25);  -- Vble. auxiliar para registrar errores en el script.
    ERR_MSG VARCHAR2(1024 CHAR); -- Vble. auxiliar para registrar errores en el script.
    V_USUARIO VARCHAR2(32 CHAR):= 'REMVIP-2207';

	ACT_NUM_ACTIVO NUMBER(16);
	ACT_ID NUMBER(16);
	NUM_SECUENCIA_VAL NUMBER(16);
	NUM_SECUENCIA_TAS NUMBER(16);
	BIE_ID NUMBER(16);

    TYPE T_JBV IS TABLE OF VARCHAR2(32000);
    TYPE T_ARRAY_JBV IS TABLE OF T_JBV; 
	
	V_JBV T_ARRAY_JBV := T_ARRAY_JBV(
		T_JBV('6044004',	'82458.8',	    '25/07/2018'),
		T_JBV('6044009',	'124223.52',	'27/07/2018'),
		T_JBV('6044011',	'52816.01',	    '12/09/2018'),
		T_JBV('6044012',	'56989.38',	    '27/08/2018'),
		T_JBV('6044013',	'49884.12',	    '25/07/2018'),
		T_JBV('6044016',	'103231.39',	'31/07/2018'),
		T_JBV('6044020',	'111457.71',	'02/08/2018'),
		T_JBV('6044021',	'31949.29',	    '26/07/2018'),
		T_JBV('6044024',	'120946.22',	'27/09/2018'),
		T_JBV('6044026',	'224854.37',	'25/07/2018'),
		T_JBV('6044029',	'71112.98',	    '30/07/2018'),
		T_JBV('6044030',	'327338.06',	'28/09/2018'),
		T_JBV('6044032',	'107913.51',	'24/07/2018'),
		T_JBV('6044033',	'17700',	    '29/08/2018'),
		T_JBV('6044034',	'137873.54',	'31/07/2018'),
		T_JBV('6044035',	'182830.49',	'03/08/2018'),
		T_JBV('6044036',	'88361.87',	    '02/08/2018'),
		T_JBV('6044039',	'15970.67',	    '27/07/2018'),
		T_JBV('6044042',	'67682.08',	    '25/07/2018'),
		T_JBV('6044046',	'114959.43',	'02/10/2018'),
		T_JBV('6044047',	'170825.22',	'13/09/2018'),
		T_JBV('6044054',	'84706.32',	    '02/08/2018'),
		T_JBV('6044057',	'33880.48',	    '02/10/2018'),
		T_JBV('6044071',	'148702.11',	'31/07/2018'),
		T_JBV('6044073',	'75791.9',	    '29/07/2018'),
		T_JBV('6044078',	'42905.22',	    '12/08/2018'),
		T_JBV('6044079',	'99763.81',	    '24/07/2018'),
		T_JBV('6044080',	'102595.2',	    '30/07/2018'),
		T_JBV('6044081',	'60948.42',	    '30/08/2018'),
		T_JBV('6044082',	'98994.76',	    '29/07/2018'),
		T_JBV('6044083',	'136655.35',	'24/07/2018'),
		T_JBV('6044085',	'78552.75',	    '24/07/2018'),
		T_JBV('6044088',	'260098.8',	    '26/07/2018'),
		T_JBV('6044089',	'117153.9',	    '26/07/2018'),
		T_JBV('6044091',	'37365.87',	    '24/08/2018'),
		T_JBV('6044092',	'49911.99',	    '01/08/2018'),
		T_JBV('6044096',	'7778.41',	    '24/08/2018'),
		T_JBV('6044098',	'20686.4',	    '24/09/2018'),
		T_JBV('6044101',	'112879.78',	'30/08/2018'),
		T_JBV('6044102',	'65751.45',	    '01/10/2018'),
		T_JBV('6044103',	'83715.44',	    '31/07/2018'),
		T_JBV('6044104',	'78209.28',	    '27/07/2018'),
		T_JBV('6044105',	'76635.77',	    '30/07/2018'),
		T_JBV('6044106',	'86000.79',	    '07/08/2018'),
		T_JBV('6044111',	'209608',	    '11/09/2018'),
		T_JBV('6044112',	'74415.8',	    '31/07/2018'),
		T_JBV('6044114',	'193154.23',	'25/07/2018'),
		T_JBV('6044116',	'124016.76',	'27/07/2018'),
		T_JBV('6044120',	'181485.56',	'27/07/2018'),
		T_JBV('6044121',	'15970.67',	    '27/07/2018'),
		T_JBV('6044123',	'152298.55',	'26/07/2018'),
		T_JBV('6044129',	'15657.44',	    '23/08/2018'),
		T_JBV('6044137',	'16047.93',	    '24/09/2018'),
		T_JBV('6044169',	'54974.44',	    '31/07/2018'),
		T_JBV('6044170',	'92462.7',	    '24/07/2018'),
		T_JBV('6044171',	'39300.6',	    '02/08/2018'),
		T_JBV('6044172',	'3180.79',	    '12/09/2018'),
		T_JBV('6044174',	'83583.84',	    '14/09/2018'),
		T_JBV('6044175',	'121658.6',	    '02/08/2018'),
		T_JBV('6044177',	'105038.91',	'24/08/2018'),
		T_JBV('6044179',	'111135.64',	'03/08/2018'),
		T_JBV('6044180',	'113077.44',	'27/07/2018'),
		T_JBV('6044187',	'61689.47',	    '05/09/2018'),
		T_JBV('6044188',	'226482.92',	'01/08/2018'),
		T_JBV('6044189',	'13379.75',	    '01/08/2018'),
		T_JBV('6044190',	'78117.21',	    '30/07/2018'),
		T_JBV('6044191',	'78184.6',	    '30/07/2018'),
		T_JBV('6044194',	'94948.11',	    '08/10/2018'),
		T_JBV('6044195',	'219167.78',	'17/09/2018'),
		T_JBV('6044199',	'309849.16',	'21/08/2018'),
		T_JBV('6044201',	'233057.52',	'02/08/2018'),
		T_JBV('6044204',	'308441.9',	    '25/07/2018'),
		T_JBV('6044205',	'17700',	    '03/09/2018'),
		T_JBV('6044208',	'184234.36',	'02/08/2018'),
		T_JBV('6044220',	'188593.77',	'01/08/2018'),
		T_JBV('6044221',	'105882.3',	    '07/08/2018'),
		T_JBV('6044224',	'165544.2',	    '01/08/2018'),
		T_JBV('6044226',	'48025.91',	    '30/07/2018'),
		T_JBV('6044230',	'102855.6',	    '16/08/2018'),
		T_JBV('6044234',	'160326.6',	    '24/07/2018'),
		T_JBV('6044259',	'73597.49',	    '31/07/2018'),
		T_JBV('6044260',	'40648.14',	    '25/09/2018'),
		T_JBV('6044263',	'69181.28',	    '06/08/2018'),
		T_JBV('6044264',	'51395.7',	    '17/08/2018'),
		T_JBV('6044266',	'135658.19',	'13/09/2018'),
		T_JBV('6044271',	'113002.4',	    '02/08/2018'),
		T_JBV('6044275',	'76871.43',	    '31/07/2018'),
		T_JBV('6044277',	'52387.46',	    '03/08/2018'),
		T_JBV('6044278',	'107824.64',	'26/07/2018'),
		T_JBV('6044281',	'77246.59',	    '30/07/2018'),
		T_JBV('6044284',	'135542.86',	'26/09/2018'),
		T_JBV('6044291',	'45518.11',	    '26/07/2018'),
		T_JBV('6044292',	'84438.75',	    '25/07/2018'),
		T_JBV('6044293',	'73321.45',	    '31/07/2018'),
		T_JBV('6044294',	'308062.92',	'26/07/2018'),
		T_JBV('6044296',	'482354.6',	    '27/07/2018'),
		T_JBV('6044298',	'254090.64',	'27/07/2018'),
		T_JBV('6044299',	'124214.23',	'29/08/2018'),
		T_JBV('6044301',	'458507.71',	'03/08/2018'),
		T_JBV('6044306',	'259302.2',	    '27/08/2018'),
		T_JBV('6044311',	'200763.29',	'23/08/2018'),
		T_JBV('6044313',	'200874.88',	'06/08/2018'),
		T_JBV('6044317',	'226918.05',	'31/07/2018'),
		T_JBV('6044318',	'62986.32',	    '27/07/2018'),
		T_JBV('6044319',	'53821.57',	    '29/07/2018'),
		T_JBV('6044321',	'103026.58',	'02/08/2018'),
		T_JBV('6044322',	'77033.88',	    '03/08/2018'),
		T_JBV('6084929',	'45620.51',	    '24/07/2018'),
		T_JBV('6084930',	'38888.85',	    '24/07/2018'),
		T_JBV('6084934',	'83258.56',	    '07/08/2018'),
		T_JBV('6084935',	'81849.34',	    '26/07/2018'),
		T_JBV('6084941',	'296039.64',	'24/07/2018'),
		T_JBV('6084942',	'306173.28',	'24/07/2018'),
		T_JBV('6084947',	'219635.1',	    '26/07/2018'),
		T_JBV('6084948',	'123789.6',	    '25/07/2018'),
		T_JBV('6084949',	'436022.22',	'25/07/2018'),
		T_JBV('6084954',	'114985.16',	'26/07/2018'),
		T_JBV('6084959',	'103273.87',	'27/07/2018'),
		T_JBV('6084964',	'126658.8',	    '27/07/2018'),
		T_JBV('6084965',	'1234.41',	    '27/07/2018'),
		T_JBV('6084966',	'10679.36',	    '27/07/2018'),
		T_JBV('6084970',	'252033.24',	'20/09/2018'),
		T_JBV('6084980',	'78075.29',	    '26/07/2018'),
		T_JBV('6084986',	'119124.23',	'01/10/2018'),
		T_JBV('6084991',	'74756.13',	    '02/08/2018'),
		T_JBV('6084992',	'80303.98',	    '31/07/2018'),
		T_JBV('6084993',	'109490.7',	    '30/07/2018'),
		T_JBV('6084994',	'47415.68',	    '31/07/2018'),
		T_JBV('6085003',	'210531.52',	'30/07/2018'),
		T_JBV('6127801',	'59161.48',	    '27/08/2018'),
		T_JBV('6128432',	'95564.23',	    '23/07/2018'),
		T_JBV('6525061',	'42945.81',	    '16/08/2018'),
		T_JBV('6707082',	'136228.8',	    '24/07/2018'),
		T_JBV('6762165',	'57932.1',	    '26/07/2018'),
		T_JBV('6762166',	'99474.48',	    '25/07/2018'),
		T_JBV('6762167',	'454342.26',	'29/08/2018'),
		T_JBV('6762169',	'6303.17',	    '16/08/2018'),
		T_JBV('6762170',	'35898.64',	    '24/09/2018'),
		T_JBV('6762171',	'6659.97',	    '20/08/2018'),
		T_JBV('6762173',	'65978.05',	    '20/08/2018'),
		T_JBV('6762174',	'770.85',	    '20/08/2018'),
		T_JBV('6762175',	'6474.65',	    '17/08/2018'),
		T_JBV('6762177',	'38009.6',	    '30/07/2018'),
		T_JBV('6762179',	'6548.81',	    '17/08/2018'),
		T_JBV('6762181',	'26376.41',	    '30/07/2018'),
		T_JBV('6762182',	'6474.65',	    '17/08/2018'),
		T_JBV('6762184',	'6548.81',	    '17/08/2018'),
		T_JBV('6762185',	'36657.21',	    '27/08/2018'),
		T_JBV('6762187',	'6548.81',	    '17/08/2018'),
		T_JBV('6762188',	'465287.03',	'31/07/2018'),
		T_JBV('6762189',	'36379.22',	    '30/08/2018'),
		T_JBV('6762190',	'27038.86',	    '01/08/2018'),
		T_JBV('6762191',	'6407.45',	    '20/08/2018'),
		T_JBV('6762193',	'153040.8',	    '25/07/2018'),
		T_JBV('6762194',	'6407.45',	    '22/08/2018'),
		T_JBV('6762196',	'74696.07',	    '06/08/2018'),
		T_JBV('6762198',	'51744.18',	    '23/07/2018'),
		T_JBV('6762199',	'52612.71',	    '30/07/2018'),
		T_JBV('6762201',	'66263.22',	    '17/08/2018'),
		T_JBV('6762202',	'126966.83',	'28/08/2018'),
		T_JBV('6762203',	'16216.5',	    '30/07/2018'),
		T_JBV('6762207',	'83452.32',	    '29/07/2018'),
		T_JBV('6762208',	'18000.23',	    '26/07/2018'),
		T_JBV('6762209',	'77964.7',	    '26/07/2018'),
		T_JBV('6762210',	'55067.08',	    '26/07/2018'),
		T_JBV('6762211',	'1893.38',	    '06/08/2018'),
		T_JBV('6762212',	'79042.64',	    '06/08/2018'),
		T_JBV('6762213',	'377280.65',	'28/08/2018'),
		T_JBV('6762214',	'5905.59',	    '06/08/2018'),
		T_JBV('6762215',	'45382.08',	    '26/07/2018'),
		T_JBV('6762217',	'6356.47',	    '20/08/2018'),
		T_JBV('6762220',	'126864.9',	    '25/07/2018'),
		T_JBV('6762222',	'6407.45',	    '20/08/2018'),
		T_JBV('6762223',	'97600.83',	    '25/07/2018'),
		T_JBV('6762224',	'376976.39',	'21/08/2018'),
		T_JBV('6762225',	'175466.22',	'03/08/2018'),
		T_JBV('6762227',	'8662.1',	    '26/07/2018'),
		T_JBV('6762228',	'110706.54',	'30/07/2018'),
		T_JBV('6762230',	'57909.06',	    '30/07/2018'),
		T_JBV('6762232',	'114720.24',	'05/10/2018'),
		T_JBV('6762234',	'122251.9',	    '05/10/2018'),
		T_JBV('6762235',	'94731.04',	    '06/08/2018'),
		T_JBV('6762239',	'38483.36',	    '25/07/2018'),
		T_JBV('6762243',	'159623.39',	'29/08/2018'),
		T_JBV('6762246',	'110364.41',	'25/07/2018'),
		T_JBV('6762247',	'118093.56',	'27/07/2018'),
		T_JBV('6762248',	'7525.65',	    '31/07/2018'),
		T_JBV('6762249',	'67149.36',	    '31/07/2018'),
		T_JBV('6762250',	'72882.79',	    '26/07/2018'),
		T_JBV('6762251',	'130947.6',	    '30/07/2018'),
		T_JBV('6762256',	'113006.78',	'31/07/2018'),
		T_JBV('6762257',	'48129.97',	    '06/08/2018'),
		T_JBV('6762259',	'76648.67',	    '16/08/2018'),
		T_JBV('6762260',	'64321.2',	    '25/07/2018'),
		T_JBV('6762264',	'191744.78',	'02/08/2018'),
		T_JBV('6762265',	'111044.35',	'25/07/2018'),
		T_JBV('6762267',	'113940.63',	'06/08/2018'),
		T_JBV('6762268',	'20830.26',	    '24/07/2018'),
		T_JBV('6762270',	'35405.14',	    '30/08/2018'),
		T_JBV('6762271',	'106770.93',	'01/08/2018'),
		T_JBV('6762272',	'206238.08',	'30/07/2018'),
		T_JBV('6762273',	'89159.4',	    '24/07/2018'),
		T_JBV('6762274',	'130645.03',	'19/09/2018'),
		T_JBV('6762277',	'109512',	    '30/07/2018'),
		T_JBV('6762278',	'49551.29',	    '04/09/2018'),
		T_JBV('6762279',	'114029.29',	'02/08/2018'),
		T_JBV('6762280',	'43683',	    '02/08/2018'),
		T_JBV('6762281',	'150837.23',	'27/07/2018'),
		T_JBV('6762282',	'92573.83',	    '16/08/2018'),
		T_JBV('6762285',	'72423.94',	    '31/07/2018'),
		T_JBV('6762291',	'46316.58',	    '20/08/2018'),
		T_JBV('6762293',	'336531.94',	'24/07/2018'),
		T_JBV('6762295',	'122048.5',	    '30/07/2018'),
		T_JBV('6762296',	'81050.24',	    '31/07/2018'),
		T_JBV('6762302',	'80632.8',	    '31/07/2018'),
		T_JBV('6762303',	'5563.63',	    '26/07/2018'),
		T_JBV('6762306',	'100698.61',	'26/07/2018'),
		T_JBV('6762307',	'106118.81',	'06/08/2018'),
		T_JBV('6762308',	'41808.76',	    '29/08/2018'),
		T_JBV('6762309',	'6548.81',	    '20/08/2018'),
		T_JBV('6762310',	'214244',	    '29/07/2018'),
		T_JBV('6762311',	'6203.52',	    '20/08/2018'),
		T_JBV('6762312',	'35901.4',	    '30/08/2018'),
		T_JBV('6762313',	'169741.61',	'29/07/2018'),
		T_JBV('6762314',	'11327.76',	    '29/07/2018'),
		T_JBV('6762315',	'5066.76',	    '24/07/2018'),
		T_JBV('6762317',	'186226.5',	    '27/07/2018'),
		T_JBV('6762318',	'197247.44',	'27/07/2018'),
		T_JBV('6762319',	'22792.44',	    '25/07/2018'),
		T_JBV('6762320',	'124196.84',	'24/07/2018'),
		T_JBV('6762323',	'145255.46',	'28/09/2018'),
		T_JBV('6762326',	'41479.45',	    '20/09/2018'),
		T_JBV('6762328',	'50358.63',	    '29/08/2018'),
		T_JBV('6762330',	'5910.35',	    '02/08/2018'),
		T_JBV('6762335',	'76491.4',	    '26/07/2018'),
		T_JBV('6762336',	'236362.06',	'09/08/2018'),
		T_JBV('6762337',	'59966.38',	    '01/08/2018'),
		T_JBV('6762339',	'204265.22',	'08/08/2018'),
		T_JBV('6762340',	'22775.19',	    '17/09/2018'),
		T_JBV('6762341',	'10878.42',	    '31/07/2018'),
		T_JBV('6762342',	'131093.11',	'24/07/2018'),
		T_JBV('6762346',	'201693.19',	'27/07/2018'),
		T_JBV('6762348',	'42522',	    '25/07/2018'),
		T_JBV('6762350',	'104324.73',	'28/09/2018'),
		T_JBV('6762353',	'113881.88',	'24/07/2018'),
		T_JBV('6762355',	'6407.45',	    '20/08/2018'),
		T_JBV('6762357',	'6407.45',	    '20/08/2018'),
		T_JBV('6762361',	'6548.81',	    '20/08/2018'),
		T_JBV('6762362',	'68129.27',	    '17/09/2018'),
		T_JBV('6762365',	'266404.54',	'25/07/2018'),
		T_JBV('6762366',	'234279.5',	    '30/07/2018'),
		T_JBV('6762369',	'170633.85',	'25/07/2018'),
		T_JBV('6762373',	'6453.8',	    '20/08/2018'),
		T_JBV('6762375',	'60026.52',	    '26/07/2018'),
		T_JBV('6762376',	'365242.5',	    '30/07/2018'),
		T_JBV('6762377',	'46477.36',	    '14/09/2018'),
		T_JBV('6762381',	'60859.64',	    '01/10/2018'),
		T_JBV('6762384',	'96071.23',	    '03/10/2018'),
		T_JBV('6762385',	'128160.24',	'26/09/2018'),
		T_JBV('6762387',	'106804.75',	'19/09/2018'),
		T_JBV('6762389',	'428149.49',	'25/07/2018'),
		T_JBV('6762390',	'78050.68',	    '25/07/2018'),
		T_JBV('6762391',	'51374.78',	    '01/08/2018'),
		T_JBV('6762392',	'5350.94',	    '24/07/2018'),
		T_JBV('6762393',	'76184.24',	    '30/07/2018'),
		T_JBV('6762396',	'87043.24',	    '24/07/2018'),
		T_JBV('6762397',	'78097.15',	    '24/07/2018'),
		T_JBV('6762398',	'57938.19',	    '17/09/2018'),
		T_JBV('6762399',	'83565.65',	    '30/07/2018'),
		T_JBV('6762400',	'82757.54',	    '30/07/2018'),
		T_JBV('6762401',	'76393.22',	    '30/07/2018'),
		T_JBV('6764233',	'114595.51',	'30/07/2018'),
		T_JBV('6764557',	'131958.53',	'27/09/2018'),
		T_JBV('6767799',	'155899.98',	'31/07/2018'),
		T_JBV('6767808',	'64463.87',	    '03/08/2018'),
		T_JBV('6767940',	'95861.17',	    '31/07/2018'),
		T_JBV('6775897',	'69993.72',	    '19/09/2018'),
		T_JBV('6775901',	'6474.65',	    '20/08/2018'),
		T_JBV('6775906',	'60353.45',	    '26/07/2018'),
		T_JBV('6775911',	'6474.65',	    '20/08/2018'),
		T_JBV('6775915',	'6551.39',	    '20/08/2018'),
		T_JBV('6775916',	'6598.54',	    '20/08/2018'),
		T_JBV('6775918',	'43693.21',	    '20/09/2018'),
		T_JBV('6775922',	'6518.73',	    '20/08/2018'),
		T_JBV('6779875',	'7473.25',	    '20/09/2018'),
		T_JBV('6779879',	'153961.02',	'20/09/2018'),
		T_JBV('6788173',	'516630.6',	    '30/08/2018'),
		T_JBV('6788176',	'121516.5',	    '05/09/2018'),
		T_JBV('6800131',	'271105.76',	'27/07/2018'),
		T_JBV('6809964',	'191523.16',	'25/07/2018'),
		T_JBV('6810469',	'86618.48',	    '24/07/2018'),
		T_JBV('6813871',	'111040.8',	    '24/07/2018'),
		T_JBV('6814469',	'202556.9',	    '25/07/2018'),
		T_JBV('6815902',	'118297.05',	'25/07/2018'),
		T_JBV('6815904',	'140677.55',	'24/07/2018'),
		T_JBV('6817106',	'160865.28',	'25/07/2018'),
		T_JBV('6817109',	'116779.68',	'30/07/2018'),
		T_JBV('6817110',	'105941.3',	    '12/09/2018'),
		T_JBV('6824998',	'54109.14',	    '25/07/2018'),
		T_JBV('6826983',	'6551.39',	    '20/08/2018'),
		T_JBV('6828850',	'65137.52',	    '24/07/2018'),
		T_JBV('6831684',	'89565.05',	    '25/07/2018'),
		T_JBV('6840015',	'7703.86',	    '14/08/2018'),
		T_JBV('6840016',	'7699.13',	    '14/08/2018'),
		T_JBV('6840018',	'41555.06',	    '17/08/2018'),
		T_JBV('6840019',	'41768',	    '16/08/2018'),
		T_JBV('6840020',	'7687.36',	    '14/08/2018'),
		T_JBV('6840022',	'67904.73',	    '20/08/2018'),
		T_JBV('6950339',	'37757.51',	    '26/07/2018'),
		T_JBV('6950340',	'5556.11',	    '26/07/2018'),
		T_JBV('6950341',	'29786.19',	    '22/08/2018'),
		T_JBV('6950344',	'108896.58',	'01/08/2018'),
		T_JBV('6950345',	'96096.84',	    '25/07/2018'),
		T_JBV('6950346',	'4833.01',	    '25/07/2018'),
		T_JBV('6950347',	'519029.18',	'31/07/2018'),
		T_JBV('6950348',	'77056.59',	    '01/10/2018'),
		T_JBV('6962192',	'82095.43',	    '01/10/2018'),
		T_JBV('6962193',	'8571.51',	    '02/10/2018'),
		T_JBV('6962194',	'42487.06',	    '24/07/2018'),
		T_JBV('6962195',	'5656.67',	    '24/07/2018'),
		T_JBV('6962196',	'48579.89',	    '24/07/2018'),
		T_JBV('6962197',	'5656.67',	    '25/07/2018'),
		T_JBV('6967731',	'192014.7',	    '03/08/2018'),
		T_JBV('6979120',	'98730.96',	    '25/07/2018'),
		T_JBV('7007130',	'108785.02',	'18/10/2018'),
		T_JBV('7007131',	'192525.61',	'25/09/2018'),
		T_JBV('7007132',	'138466.25',	'30/07/2018'),
		T_JBV('7007133',	'44178.64',	    '25/07/2018'),
		T_JBV('7007134',	'6765.02',	    '25/07/2018'),
		T_JBV('7011996',	'85728.05',	    '17/09/2018'),
		T_JBV('7012907',	'97941.73',	    '02/10/2018'),
		T_JBV('7020235',	'49543.59',	    '18/10/2018'));
	V_TMP_JBV T_JBV;
	
BEGIN

	FOR I IN V_JBV.FIRST .. V_JBV.LAST
	
	LOOP
 
	V_TMP_JBV := V_JBV(I);
	
  	ACT_NUM_ACTIVO := TRIM(V_TMP_JBV(1));
  			  
  	EXECUTE IMMEDIATE 'SELECT COUNT(1) FROM '||V_ESQUEMA||'.ACT_ACTIVO WHERE ACT_NUM_ACTIVO = '||ACT_NUM_ACTIVO INTO V_KOUNT;
  			  
	IF V_KOUNT > 0 THEN 
  			  
		EXECUTE IMMEDIATE 'SELECT ACT_ID FROM '||V_ESQUEMA||'.ACT_ACTIVO WHERE ACT_NUM_ACTIVO = '||ACT_NUM_ACTIVO INTO ACT_ID;
		
		EXECUTE IMMEDIATE 'SELECT BIE_ID FROM '||V_ESQUEMA||'.ACT_ACTIVO WHERE ACT_NUM_ACTIVO = '||ACT_NUM_ACTIVO INTO BIE_ID;
		
		EXECUTE IMMEDIATE 'SELECT '||V_ESQUEMA||'.S_BIE_VALORACIONES.NEXTVAL FROM DUAL' INTO NUM_SECUENCIA_VAL;
		
		EXECUTE IMMEDIATE 'SELECT '||V_ESQUEMA||'.S_ACT_TAS_TASACION.NEXTVAL FROM DUAL' INTO NUM_SECUENCIA_TAS;

		V_SQL := 'INSERT INTO '||V_ESQUEMA||'.'||V_TABLA_1||' (BIE_ID, BIE_VAL_ID, BIE_FECHA_VALOR_TASACION, FECHACREAR, 
		USUARIOCREAR, VERSION, BORRADO)
				  SELECT '''||BIE_ID||''', 
						 '''||NUM_SECUENCIA_VAL||''',
						 TO_DATE('''||TRIM(V_TMP_JBV(3))||''', ''DD/MM/RR''),
						 SYSDATE,
						 '''||V_USUARIO||''',
						 0,
						 0
				  FROM DUAL';
		EXECUTE IMMEDIATE V_SQL;
		
		DBMS_OUTPUT.PUT_LINE('INSERTADO EL ACTIVO '||ACT_NUM_ACTIVO||' EN '||V_TABLA_1);
		
		V_SQL := 'INSERT INTO '||V_ESQUEMA||'.'||V_TABLA_2||' (ACT_ID, BIE_VAL_ID, TAS_ID, DD_TTS_ID, TAS_NOMBRE_TASADOR, FECHACREAR, 
		USUARIOCREAR, VERSION, BORRADO, TAS_FECHA_INI_TASACION, TAS_IMPORTE_TAS_FIN)
				  SELECT '''||ACT_ID||''',
						 '''||NUM_SECUENCIA_VAL||''',
						 '''||NUM_SECUENCIA_TAS||''',
						 (SELECT DD_TTS_ID FROM '||V_ESQUEMA||'.DD_TTS_TIPO_TASACION WHERE DD_TTS_CODIGO = ''03''),
						 ''GESTION DE VALORACIONES Y TASACIONES SA'',
						 SYSDATE,
						 '''||V_USUARIO||''',
						 0,
						 0,
						 TO_DATE('''||TRIM(V_TMP_JBV(3))||''', ''DD/MM/RR''),
						 '''||TRIM(V_TMP_JBV(2))||'''
				  FROM DUAL';
		EXECUTE IMMEDIATE V_SQL;
		
		DBMS_OUTPUT.PUT_LINE('INSERTADO EL ACTIVO '||ACT_NUM_ACTIVO||' EN '||V_TABLA_2);
		
		V_COUNT_UPDATE := V_COUNT_UPDATE + 1;
	
	ELSE
		
		DBMS_OUTPUT.PUT_LINE('[INFO] El activo '||ACT_NUM_ACTIVO||' no existe!');
		
	END IF;
	
	END LOOP;			    
    
	COMMIT;

    DBMS_OUTPUT.PUT_LINE('[INFO] Se han insertado en total '||V_COUNT_UPDATE||' registros en la tabla '||V_TABLA_1);
    DBMS_OUTPUT.PUT_LINE('[INFO] Se han insertado en total '||V_COUNT_UPDATE||' registros en la tabla '||V_TABLA_2);

EXCEPTION
    WHEN OTHERS THEN
      DBMS_OUTPUT.PUT_LINE('[ERROR] Se ha producido un error en la ejecución:'||TO_CHAR(SQLCODE));
      DBMS_OUTPUT.PUT_LINE('-----------------------------------------------------------');
      DBMS_OUTPUT.PUT_LINE(SQLERRM);
      ROLLBACK;
      RAISE;
END;
/
EXIT;
