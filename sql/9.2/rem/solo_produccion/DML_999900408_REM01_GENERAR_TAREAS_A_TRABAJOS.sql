--/*
--###########################################
--## AUTOR=Guillermo Llidó Parra
--## FECHA_CREACION=20181115
--## ARTEFACTO=online
--## VERSION_ARTEFACTO=9.2
--## INCIDENCIA_LINK=REMVIP-2536
--## PRODUCTO=NO
--## 
--## Finalidad: Generar tareas a trabajos sin tareas
--##			
--## INSTRUCCIONES:  
--## VERSIONES:
--##        0.1 Versión inicial
--###########################################
----*/


WHENEVER SQLERROR EXIT SQL.SQLCODE;
SET SERVEROUTPUT ON; 
SET DEFINE OFF;

DECLARE
  V_MSQL VARCHAR2(32000 CHAR); -- Sentencia a ejecutar     
  V_ESQUEMA VARCHAR2(25 CHAR):= '#ESQUEMA#'; -- Configuracion Esquema
  V_ESQUEMA_M VARCHAR2(25 CHAR):= '#ESQUEMA_MASTER#'; -- Configuracion Esquema Master
  V_SQL VARCHAR2(4000 CHAR); -- Vble. para consulta que valida la existencia de una tabla.
  V_NUM_TABLAS NUMBER(16); -- Vble. para validar la existencia de una tabla.   
  ERR_NUM NUMBER(25);  -- Vble. auxiliar para registrar errores en el script.
  ERR_MSG VARCHAR2(1024 CHAR); -- Vble. auxiliar para registrar errores en el script.
  V_USUARIO VARCHAR2(100 CHAR) := 'REMVIP-2536';
  PL_OUTPUT VARCHAR2(32000 CHAR);
	
    
BEGIN	
	
	DBMS_OUTPUT.PUT_LINE('[INICIO] ');

	#ESQUEMA#.REPOSICIONAMIENTO_TRABAJO(V_USUARIO,'154502,149583,155374,163535,164289,149583,163750,167255,163829,165489,162791,163454,163748,163929,164906,147086,147226,147366,147057,147342,165479,147428,155247,155280,156260,157379,157445,157609,163786,164486,147147,147343,153695,154156,153861,157324,157541,157568,157644,158109,158334,158204,158466,158585,158586,158618,158626,158793,158994,159281,159272,159439,159242,159353,159607,159355,159331,159744,159686,159437,159513,159813,159851,159841,159949,160179,159484,163059,154238,167547,151822,146330,154352,157974,155681,157783,159038,159474,162316,162160,162997,163118,163304,163407,163415,163705,163740,163958,163943,164341,164713,164296,164853,168353,153235,164691,163330,151098,151208,152076,153033,151107,154181,146456,164665,147207,147518,147569,147785,147835,148041,148538,148545,148618,148948,148980,149471,150077,149716,150445,150837,150882,150935,151363,151399,151516,151267,151668,151702,151307,151801,151720,151721,151785,151691,151976,151974,151971,151978,151943,151964,151966,152019,152167,152107,152208,152365,152392,152423,152376,152500,152653,152641,152483,151916,152994,152912,152961,153057,153131,153019,153113,153144,153115,153279,149885,153755,154912,155784,156077,158636,150811,147242,153597,158674,156563,163553,150331,155711,156563,157903,158615,160191,160625,163813,163774,166258,166486,169044,148785,149364,150737,152772,151341,160632,146980,163160,159508,161450,148350,152303,168563,168869,166725,169295,169277,169775,169009,169960,168083,168983,156351,112451,158120,147780,162911,168441,168887,168941,169377,161983','ResultadoTarificada',PL_OUTPUT);
	DBMS_OUTPUT.PUT_LINE(PL_OUTPUT);

EXCEPTION

   WHEN OTHERS THEN
        err_num := SQLCODE;
        err_msg := SQLERRM;

        DBMS_OUTPUT.put_line('[ERROR] Se ha producido un error en la ejecución:'||TO_CHAR(err_num));
        DBMS_OUTPUT.put_line('-----------------------------------------------------------'); 
        DBMS_OUTPUT.put_line(err_msg);

        ROLLBACK;
        RAISE;          

END;

/

EXIT
