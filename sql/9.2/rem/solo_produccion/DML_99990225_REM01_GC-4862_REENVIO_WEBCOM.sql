--/*
--###########################################
--## AUTOR=JESSICA SAMPERE
--## FECHA_CREACION=20180124
--## ARTEFACTO=online
--## VERSION_ARTEFACTO=2.0.12
--## INCIDENCIA_LINK=REMNIVDOS-3462
--## PRODUCTO=NO
--## 
--## Finalidad: Marcar para reenviar entidades del detector de cambios
--##			
--## INSTRUCCIONES:  
--## VERSIONES:
--##        0.1 Versión inicial
--###########################################
----*/



WHENEVER SQLERROR EXIT SQL.SQLCODE;
SET SERVEROUTPUT ON; 
SET DEFINE OFF;


DECLARE
  V_MSQL VARCHAR2(32000 CHAR); -- Sentencia a ejecutar     
  V_ESQUEMA VARCHAR2(25 CHAR):= '#ESQUEMA#'; -- Configuracion Esquema
  V_ESQUEMA_M VARCHAR2(25 CHAR):= '#ESQUEMA_MASTER#'; -- Configuracion Esquema Master
  V_SQL VARCHAR2(4000 CHAR); -- Vble. para consulta que valida la existencia de una tabla.
  V_NUM_TABLAS NUMBER(16); -- Vble. para validar la existencia de una tabla.   
  ERR_NUM NUMBER(25);  -- Vble. auxiliar para registrar errores en el script.
  ERR_MSG VARCHAR2(1024 CHAR); -- Vble. auxiliar para registrar errores en el script.
  
  TYPE T_TIPO_DATA IS TABLE OF VARCHAR2(150);
  TYPE T_ARRAY_DATA IS TABLE OF T_TIPO_DATA;
  --TYPE T_TIPO_DATA_PRV IS TABLE OF VARCHAR2(150);
  --TYPE T_ARRAY_DATA_PRV IS TABLE OF T_TIPO_DATA_PRV;




--------------------------------------------------------------
-- INICIO ZONA PARA EDITAR            ------------------------
--------------------------------------------------------------

 V_TIPO_DATA T_ARRAY_DATA := T_ARRAY_DATA(
  -- Cada ACTIVO en un T_TIPO_DATA
	T_TIPO_DATA('169168'),
	T_TIPO_DATA('158172'),
	T_TIPO_DATA('174990'),
	T_TIPO_DATA('70280'),
	T_TIPO_DATA('169557'),
	T_TIPO_DATA('158341'),
	T_TIPO_DATA('174252'),
	T_TIPO_DATA('169014'),
	T_TIPO_DATA('169015'),
	T_TIPO_DATA('69933'),
	T_TIPO_DATA('69934'),
	T_TIPO_DATA('169016'),
	T_TIPO_DATA('70281'),
	T_TIPO_DATA('169214'),
	T_TIPO_DATA('6129869'),
	T_TIPO_DATA('6129870'),
	T_TIPO_DATA('6129871'),
	T_TIPO_DATA('6129876'),
	T_TIPO_DATA('174655'),
	T_TIPO_DATA('70099'),
	T_TIPO_DATA('174772'),
	T_TIPO_DATA('168696'),
	T_TIPO_DATA('158890'),
	T_TIPO_DATA('174993'),
	T_TIPO_DATA('174253'),
	T_TIPO_DATA('6129872'),
	T_TIPO_DATA('6129873'),
	T_TIPO_DATA('6129879'),
	T_TIPO_DATA('6129880'),
	T_TIPO_DATA('6129881'),
	T_TIPO_DATA('6129882'),
	T_TIPO_DATA('6129883'),
	T_TIPO_DATA('6129893'),
	T_TIPO_DATA('6129884'),
	T_TIPO_DATA('6129885'),
	T_TIPO_DATA('6129886'),
	T_TIPO_DATA('6129887'),
	T_TIPO_DATA('6129888'),
	T_TIPO_DATA('6129890'),
	T_TIPO_DATA('6129891'),
	T_TIPO_DATA('6129875'),
	T_TIPO_DATA('185470'),
	T_TIPO_DATA('181688'),
	T_TIPO_DATA('193477'),
	T_TIPO_DATA('193235'),
	T_TIPO_DATA('193049'),
	T_TIPO_DATA('185194'),
	T_TIPO_DATA('185471'),
	T_TIPO_DATA('193050'),
	T_TIPO_DATA('193135'),
	T_TIPO_DATA('185023'),
	T_TIPO_DATA('193412'),
	T_TIPO_DATA('192776'),
	T_TIPO_DATA('193478'),
	T_TIPO_DATA('185024'),
	T_TIPO_DATA('193479'),
	T_TIPO_DATA('193413'),
	T_TIPO_DATA('185472'),
	T_TIPO_DATA('193480'),
	T_TIPO_DATA('181689'),
	T_TIPO_DATA('185025'),
	T_TIPO_DATA('185026'),
	T_TIPO_DATA('193236'),
	T_TIPO_DATA('193052'),
	T_TIPO_DATA('185195'),
	T_TIPO_DATA('181690'),
	T_TIPO_DATA('193053'),
	T_TIPO_DATA('193054'),
	T_TIPO_DATA('193252'),
	T_TIPO_DATA('193253'),
	T_TIPO_DATA('192869'),
	T_TIPO_DATA('193055'),
	T_TIPO_DATA('193481'),
	T_TIPO_DATA('185473'),
	T_TIPO_DATA('185196'),
	T_TIPO_DATA('181519'),
	T_TIPO_DATA('181691'),
	T_TIPO_DATA('193136'),
	T_TIPO_DATA('193056'),
	T_TIPO_DATA('181520'),
	T_TIPO_DATA('181848'),
	T_TIPO_DATA('193482'),
	T_TIPO_DATA('192870'),
	T_TIPO_DATA('193237'),
	T_TIPO_DATA('185027'),
	T_TIPO_DATA('181521'),
	T_TIPO_DATA('192777'),
	T_TIPO_DATA('193057'),
	T_TIPO_DATA('193254'),
	T_TIPO_DATA('185028'),
	T_TIPO_DATA('185131'),
	T_TIPO_DATA('193414'),
	T_TIPO_DATA('944156'),
	T_TIPO_DATA('934993'),
	T_TIPO_DATA('192871'),
	T_TIPO_DATA('185132'),
	T_TIPO_DATA('942587'),
	T_TIPO_DATA('181424'),
	T_TIPO_DATA('181693'),
	T_TIPO_DATA('941439'),
	T_TIPO_DATA('193238'),
	T_TIPO_DATA('185474'),
	T_TIPO_DATA('938285'),
	T_TIPO_DATA('935069'),
	T_TIPO_DATA('193285'),
	T_TIPO_DATA('193483'),
	T_TIPO_DATA('193415'),
	T_TIPO_DATA('192981'),
	T_TIPO_DATA('185197'),
	T_TIPO_DATA('933975'),
	T_TIPO_DATA('193051'),
	T_TIPO_DATA('181523'),
	T_TIPO_DATA('945328'),
	T_TIPO_DATA('181426'),
	T_TIPO_DATA('192983'),
	T_TIPO_DATA('193239'),
	T_TIPO_DATA('185133'),
	T_TIPO_DATA('193484'),
	T_TIPO_DATA('181524'),
	T_TIPO_DATA('181525'),
	T_TIPO_DATA('185029'),
	T_TIPO_DATA('193286'),
	T_TIPO_DATA('193138'),
	T_TIPO_DATA('185030'),
	T_TIPO_DATA('193287'),
	T_TIPO_DATA('193416'),
	T_TIPO_DATA('193485'),
	T_TIPO_DATA('193288'),
	T_TIPO_DATA('181695'),
	T_TIPO_DATA('193240'),
	T_TIPO_DATA('193139'),
	T_TIPO_DATA('185476'),
	T_TIPO_DATA('193289'),
	T_TIPO_DATA('193576'),
	T_TIPO_DATA('181526'),
	T_TIPO_DATA('185477'),
	T_TIPO_DATA('181696'),
	T_TIPO_DATA('193577'),
	T_TIPO_DATA('193317'),
	T_TIPO_DATA('193417'),
	T_TIPO_DATA('181697'),
	T_TIPO_DATA('185478'),
	T_TIPO_DATA('193318'),
	T_TIPO_DATA('193319'),
	T_TIPO_DATA('185031'),
	T_TIPO_DATA('185479'),
	T_TIPO_DATA('193241'),
	T_TIPO_DATA('193242'),
	T_TIPO_DATA('181527'),
	T_TIPO_DATA('193058'),
	T_TIPO_DATA('185033'),
	T_TIPO_DATA('193320'),
	T_TIPO_DATA('181698'),
	T_TIPO_DATA('185198'),
	T_TIPO_DATA('193578'),
	T_TIPO_DATA('185134'),
	T_TIPO_DATA('181528'),
	T_TIPO_DATA('181699'),
	T_TIPO_DATA('192778'),
	T_TIPO_DATA('192779'),
	T_TIPO_DATA('193418'),
	T_TIPO_DATA('181529'),
	T_TIPO_DATA('193419'),
	T_TIPO_DATA('192780'),
	T_TIPO_DATA('193579'),
	T_TIPO_DATA('192984'),
	T_TIPO_DATA('192985'),
	T_TIPO_DATA('193290'),
	T_TIPO_DATA('181427'),
	T_TIPO_DATA('181850'),
	T_TIPO_DATA('181530'),
	T_TIPO_DATA('185034'),
	T_TIPO_DATA('181428'),
	T_TIPO_DATA('193420'),
	T_TIPO_DATA('181851'),
	T_TIPO_DATA('193243'),
	T_TIPO_DATA('193291'),
	T_TIPO_DATA('181531'),
	T_TIPO_DATA('185200'),
	T_TIPO_DATA('193292'),
	T_TIPO_DATA('193421'),
	T_TIPO_DATA('181700'),
	T_TIPO_DATA('185480'),
	T_TIPO_DATA('185035'),
	T_TIPO_DATA('185201'),
	T_TIPO_DATA('185481'),
	T_TIPO_DATA('181852'),
	T_TIPO_DATA('185482'),
	T_TIPO_DATA('192986'),
	T_TIPO_DATA('181459'),
	T_TIPO_DATA('88474'),
	T_TIPO_DATA('88728'),
	T_TIPO_DATA('88729'),
	T_TIPO_DATA('88818'),
	T_TIPO_DATA('88819'),
	T_TIPO_DATA('88820'),
	T_TIPO_DATA('89203'),
	T_TIPO_DATA('90695'),
	T_TIPO_DATA('93960'),
	T_TIPO_DATA('94223'),
	T_TIPO_DATA('100061'),
	T_TIPO_DATA('100113'),
	T_TIPO_DATA('100114'),
	T_TIPO_DATA('100314'),
	T_TIPO_DATA('100315'),
	T_TIPO_DATA('136633'),
	T_TIPO_DATA('142722'),
	T_TIPO_DATA('136867'),
	T_TIPO_DATA('153497'),
	T_TIPO_DATA('162952'),
	T_TIPO_DATA('163265'),
	T_TIPO_DATA('153029'),
	T_TIPO_DATA('142255'),
	T_TIPO_DATA('153030'),
	T_TIPO_DATA('142385'),
	T_TIPO_DATA('200290'),
	T_TIPO_DATA('142386'),
	T_TIPO_DATA('163496'),
	T_TIPO_DATA('153064'),
	T_TIPO_DATA('136594'),
	T_TIPO_DATA('142739'),
	T_TIPO_DATA('155387'),
	T_TIPO_DATA('155388'),
	T_TIPO_DATA('136816'),
	T_TIPO_DATA('155496'),
	T_TIPO_DATA('153177'),
	T_TIPO_DATA('152903'),
	T_TIPO_DATA('142516'),
	T_TIPO_DATA('155334'),
	T_TIPO_DATA('65922'),
	T_TIPO_DATA('155179'),
	T_TIPO_DATA('155180'),
	T_TIPO_DATA('155641'),
	T_TIPO_DATA('155181'),
	T_TIPO_DATA('155182'),
	T_TIPO_DATA('142864'),
	T_TIPO_DATA('153171'),
	T_TIPO_DATA('155379'),
	T_TIPO_DATA('142865'),
	T_TIPO_DATA('142389'),
	T_TIPO_DATA('155380'),
	T_TIPO_DATA('152962'),
	T_TIPO_DATA('136814'),
	T_TIPO_DATA('136815'),
	T_TIPO_DATA('142522'),
	T_TIPO_DATA('153173'),
	T_TIPO_DATA('142736'),
	T_TIPO_DATA('136420'),
	T_TIPO_DATA('142868'),
	T_TIPO_DATA('142869'),
	T_TIPO_DATA('19377'),
	T_TIPO_DATA('19381'),
	T_TIPO_DATA('19382'),
	T_TIPO_DATA('19397'),
	T_TIPO_DATA('19401'),
	T_TIPO_DATA('19403'),
	T_TIPO_DATA('103145'),
	T_TIPO_DATA('103259'),
	T_TIPO_DATA('122580'),
	T_TIPO_DATA('103093'),
	T_TIPO_DATA('122792'),
	T_TIPO_DATA('120156'),
	T_TIPO_DATA('103094'),
	T_TIPO_DATA('122615'),
	T_TIPO_DATA('120339'),
	T_TIPO_DATA('122616'),
	T_TIPO_DATA('125946'),
	T_TIPO_DATA('120340'),
	T_TIPO_DATA('123176'),
	T_TIPO_DATA('120157'),
	T_TIPO_DATA('122617'),
	T_TIPO_DATA('164766'),
	T_TIPO_DATA('135597'),
	T_TIPO_DATA('164767'),
	T_TIPO_DATA('164768'),
	T_TIPO_DATA('147442'),
	T_TIPO_DATA('142924'),
	T_TIPO_DATA('155106'),
	T_TIPO_DATA('155134'),
	T_TIPO_DATA('155135'),
	T_TIPO_DATA('164928'),
	T_TIPO_DATA('164929'),
	T_TIPO_DATA('147175'),
	T_TIPO_DATA('142925'),
	T_TIPO_DATA('164742'),
	T_TIPO_DATA('164743'),
	T_TIPO_DATA('139897'),
	T_TIPO_DATA('161758'),
	T_TIPO_DATA('151431'),
	T_TIPO_DATA('151583'),
	T_TIPO_DATA('151853'),
	T_TIPO_DATA('151584'),
	T_TIPO_DATA('151854'),
	T_TIPO_DATA('143552'),
	T_TIPO_DATA('161759'),
	T_TIPO_DATA('139595'),
	T_TIPO_DATA('143783'),
	T_TIPO_DATA('139898'),
	T_TIPO_DATA('143784'),
	T_TIPO_DATA('143785'),
	T_TIPO_DATA('143786'),
	T_TIPO_DATA('144027'),
	T_TIPO_DATA('161515'),
	T_TIPO_DATA('151432'),
	T_TIPO_DATA('162155'),
	T_TIPO_DATA('144028'),
	T_TIPO_DATA('151855'),
	T_TIPO_DATA('161548'),
	T_TIPO_DATA('137174'),
	T_TIPO_DATA('137500'),
	T_TIPO_DATA('143826'),
	T_TIPO_DATA('143827'),
	T_TIPO_DATA('154085'),
	T_TIPO_DATA('178994'),
	T_TIPO_DATA('113287'),
	T_TIPO_DATA('106299'),
	T_TIPO_DATA('181278'),
	T_TIPO_DATA('190403'),
	T_TIPO_DATA('181060'),
	T_TIPO_DATA('193118'),
	T_TIPO_DATA('181156'),
	T_TIPO_DATA('193119'),
	T_TIPO_DATA('181157'),
	T_TIPO_DATA('181158'),
	T_TIPO_DATA('193120'),
	T_TIPO_DATA('190404'),
	T_TIPO_DATA('194754'),
	T_TIPO_DATA('190505'),
	T_TIPO_DATA('194120'),
	T_TIPO_DATA('181061'),
	T_TIPO_DATA('190445'),
	T_TIPO_DATA('192938'),
	T_TIPO_DATA('191026'),
	T_TIPO_DATA('194307'),
	T_TIPO_DATA('190506'),
	T_TIPO_DATA('181282'),
	T_TIPO_DATA('190508'),
	T_TIPO_DATA('191027'),
	T_TIPO_DATA('190406'),
	T_TIPO_DATA('181734'),
	T_TIPO_DATA('181284'),
	T_TIPO_DATA('193192'),
	T_TIPO_DATA('194308'),
	T_TIPO_DATA('190405'),
	T_TIPO_DATA('181062'),
	T_TIPO_DATA('67556'),
	T_TIPO_DATA('81823'),
	T_TIPO_DATA('81824'),
	T_TIPO_DATA('72678'),
	T_TIPO_DATA('74573'),
	T_TIPO_DATA('72988'),
	T_TIPO_DATA('72679'),
	T_TIPO_DATA('74812'),
	T_TIPO_DATA('81825'),
	T_TIPO_DATA('67557'),
	T_TIPO_DATA('73078'),
	T_TIPO_DATA('67478'),
	T_TIPO_DATA('74467'),
	T_TIPO_DATA('73079'),
	T_TIPO_DATA('68134'),
	T_TIPO_DATA('148596'),
	T_TIPO_DATA('160090'),
	T_TIPO_DATA('148092'),
	T_TIPO_DATA('160350'),
	T_TIPO_DATA('161053'),
	T_TIPO_DATA('148348'),
	T_TIPO_DATA('148441'),
	T_TIPO_DATA('161057'),
	T_TIPO_DATA('84902'),
	T_TIPO_DATA('91529'),
	T_TIPO_DATA('85086'),
	T_TIPO_DATA('85087'),
	T_TIPO_DATA('85088'),
	T_TIPO_DATA('85883'),
	T_TIPO_DATA('85605'),
	T_TIPO_DATA('85177'),
	T_TIPO_DATA('91886'),
	T_TIPO_DATA('85884'),
	T_TIPO_DATA('82475'),
	T_TIPO_DATA('85023'),
	T_TIPO_DATA('85024'),
	T_TIPO_DATA('85606'),
	T_TIPO_DATA('85178'),
	T_TIPO_DATA('86002'),
	T_TIPO_DATA('85025'),
	T_TIPO_DATA('85607'),
	T_TIPO_DATA('82476'),
	T_TIPO_DATA('91797'),
	T_TIPO_DATA('84903'),
	T_TIPO_DATA('82864'),
	T_TIPO_DATA('91798'),
	T_TIPO_DATA('85885'),
	T_TIPO_DATA('82736'),
	T_TIPO_DATA('85026'),
	T_TIPO_DATA('85089'),
	T_TIPO_DATA('85027'),
	T_TIPO_DATA('85028'),
	T_TIPO_DATA('85090'),
	T_TIPO_DATA('91887'),
	T_TIPO_DATA('85179'),
	T_TIPO_DATA('91799'),
	T_TIPO_DATA('82477'),
	T_TIPO_DATA('181048'),
	T_TIPO_DATA('181720'),
	T_TIPO_DATA('181179'),
	T_TIPO_DATA('194184'),
	T_TIPO_DATA('189149'),
	T_TIPO_DATA('190222'),
	T_TIPO_DATA('190490'),
	T_TIPO_DATA('181042'),
	T_TIPO_DATA('190283'),
	T_TIPO_DATA('181181'),
	T_TIPO_DATA('192841'),
	T_TIPO_DATA('193448'),
	T_TIPO_DATA('194679'),
	T_TIPO_DATA('118175'),
	T_TIPO_DATA('194185'),
	T_TIPO_DATA('181143'),
	T_TIPO_DATA('181043'),
	T_TIPO_DATA('190491'),
	T_TIPO_DATA('193449'),
	T_TIPO_DATA('194186'),
	T_TIPO_DATA('181044'),
	T_TIPO_DATA('192978'),
	T_TIPO_DATA('190492'),
	T_TIPO_DATA('193174'),
	T_TIPO_DATA('193450'),
	T_TIPO_DATA('194680'),
	T_TIPO_DATA('192979'),
	T_TIPO_DATA('194681'),
	T_TIPO_DATA('194292'),
	T_TIPO_DATA('190284'),
	T_TIPO_DATA('190224'),
	T_TIPO_DATA('181721'),
	T_TIPO_DATA('194682'),
	T_TIPO_DATA('192980'),
	T_TIPO_DATA('194187'),
	T_TIPO_DATA('181182'),
	T_TIPO_DATA('194293'),
	T_TIPO_DATA('193175'),
	T_TIPO_DATA('181144'),
	T_TIPO_DATA('192843'),
	T_TIPO_DATA('190493'),
	T_TIPO_DATA('190494'),
	T_TIPO_DATA('190495'),
	T_TIPO_DATA('181722'),
	T_TIPO_DATA('194683'),
	T_TIPO_DATA('194294'),
	T_TIPO_DATA('181183'),
	T_TIPO_DATA('192844'),
	T_TIPO_DATA('181145'),
	T_TIPO_DATA('192845'),
	T_TIPO_DATA('193176'),
	T_TIPO_DATA('191017'),
	T_TIPO_DATA('181047'),
	T_TIPO_DATA('187995'),
	T_TIPO_DATA('893545'),
	T_TIPO_DATA('198181'),
	T_TIPO_DATA('195745'),
	T_TIPO_DATA('847744'),
	T_TIPO_DATA('853731'),
	T_TIPO_DATA('876101'),
	T_TIPO_DATA('195584'),
	T_TIPO_DATA('920508193'),
	T_TIPO_DATA('778338'),
	T_TIPO_DATA('187990'),
	T_TIPO_DATA('198182'),
	T_TIPO_DATA('869423'),
	T_TIPO_DATA('860692'),
	T_TIPO_DATA('188044'),
	T_TIPO_DATA('195928'),
	T_TIPO_DATA('854457'),
	T_TIPO_DATA('841442'),
	T_TIPO_DATA('849047'),
	T_TIPO_DATA('852180'),
	T_TIPO_DATA('198341'),
	T_TIPO_DATA('883955'),
	T_TIPO_DATA('920510'),
	T_TIPO_DATA('912254'),
	T_TIPO_DATA('834170'),
	T_TIPO_DATA('93685'),
	T_TIPO_DATA('916749'),
	T_TIPO_DATA('889261'),
	T_TIPO_DATA('849567'),
	T_TIPO_DATA('194513'),
	T_TIPO_DATA('195583'),
	T_TIPO_DATA('195478'),
	T_TIPO_DATA('198240'),
	T_TIPO_DATA('195479'),
	T_TIPO_DATA('195744'),
	T_TIPO_DATA('187989'),
	T_TIPO_DATA('198018'),
	T_TIPO_DATA('198237'),
	T_TIPO_DATA('187943'),
	T_TIPO_DATA('198727'),
	T_TIPO_DATA('194966'),
	T_TIPO_DATA('194967'),
	T_TIPO_DATA('198242'),
	T_TIPO_DATA('194879'),
	T_TIPO_DATA('187996'),
	T_TIPO_DATA('195480'),
	T_TIPO_DATA('157706'),
	T_TIPO_DATA('133072'),
	T_TIPO_DATA('133244'),
	T_TIPO_DATA('133448'),
	T_TIPO_DATA('148929'),
	T_TIPO_DATA('146162'),
	T_TIPO_DATA('133071'),
	T_TIPO_DATA('148841'),
	T_TIPO_DATA('157931'),
	T_TIPO_DATA('157929'),
	T_TIPO_DATA('146427'),
	T_TIPO_DATA('133702'),
	T_TIPO_DATA('145743'),
	T_TIPO_DATA('145744'),
	T_TIPO_DATA('145983'),
	T_TIPO_DATA('148952'),
	T_TIPO_DATA('148840'),
	T_TIPO_DATA('146164'),
	T_TIPO_DATA('133447'),
	T_TIPO_DATA('157488'),
	T_TIPO_DATA('182368'),
	T_TIPO_DATA('157251'),
	T_TIPO_DATA('153527'),
	T_TIPO_DATA('6128282'),
	T_TIPO_DATA('6128283'),
	T_TIPO_DATA('6128275'),
	T_TIPO_DATA('6128297'),
	T_TIPO_DATA('6128298'),
	T_TIPO_DATA('6128284'),
	T_TIPO_DATA('6128285'),
	T_TIPO_DATA('6128307'),
	T_TIPO_DATA('150828'),
	T_TIPO_DATA('136316'),
	T_TIPO_DATA('158933')


  ); 


  /*
  V_TIPO_DATA_PRV T_ARRAY_DATA_PRV := T_ARRAY_DATA_PRV(
  -- Cada PROVEEDOR en un T_TIPO_DATA
	);
*/

--------------------------------------------------------------
-- FIN ZONA PARA EDITAR               ------------------------
--------------------------------------------------------------




  V_TMP_TIPO_DATA T_TIPO_DATA;
  --V_TMP_TIPO_DATA_PRV T_TIPO_DATA_PRV;
  
BEGIN	

 DBMS_OUTPUT.PUT_LINE('[INICIO] ');


 
   -- LOOP para marcar activos a reenviar por el detector de cambios
 -----------------------------------------------------------------
   FOR I IN V_TIPO_DATA.FIRST .. V_TIPO_DATA.LAST
     LOOP
    
       V_TMP_TIPO_DATA := V_TIPO_DATA(I);
       
       -------------------------------------------------
       --Comprobamos que el activo existe--
       -------------------------------------------------
       
       DBMS_OUTPUT.PUT_LINE('[INFO]: MARCADO PARA REENVIAR ACTIVO: '''|| TRIM(V_TMP_TIPO_DATA(1)) ||'''');


       V_SQL := 'SELECT COUNT(1) FROM '||V_ESQUEMA||'.SWH_STOCK_ACT_WEBCOM_HIST WHERE ID_ACTIVO_HAYA = '''||TRIM(V_TMP_TIPO_DATA(1))||'''';
       EXECUTE IMMEDIATE V_SQL INTO V_NUM_TABLAS;
       
       --Si existe, se borra
       IF V_NUM_TABLAS > 0 THEN				         
		
            DBMS_OUTPUT.PUT_LINE('[INFO]: BORRAMOS EL REGISTRO '''|| TRIM(V_TMP_TIPO_DATA(1)) ||''' EN SWH_STOCK_ACT_WEBCOM_HIST');
            V_MSQL := 'DELETE FROM '||V_ESQUEMA||'.SWH_STOCK_ACT_WEBCOM_HIST WHERE ID_ACTIVO_HAYA = '||V_TMP_TIPO_DATA(1);

          	EXECUTE IMMEDIATE V_MSQL;
        
          	DBMS_OUTPUT.PUT_LINE('[INFO]: ACTIVO '''|| TRIM(V_TMP_TIPO_DATA(1)) ||''' MARCADO PARA REENVIAR');
			
       --Si no existe, se informa
       ELSE
     
        DBMS_OUTPUT.PUT_LINE('[INFO]: EL ACTIVO '''|| TRIM(V_TMP_TIPO_DATA(1)) ||''' NO EXISTE, NO SE MARCARÁ PARA REENVIAR');   
        
       END IF;
      
		
    END LOOP;
    
   COMMIT;
   
   DBMS_OUTPUT.PUT_LINE('[FIN]: PROCESO FINALIZADO CORRECTAMENTE ');
 

EXCEPTION

   WHEN OTHERS THEN
        err_num := SQLCODE;
        err_msg := SQLERRM;

        DBMS_OUTPUT.put_line('[ERROR] Se ha producido un error en la ejecución:'||TO_CHAR(err_num));
        DBMS_OUTPUT.put_line('-----------------------------------------------------------'); 
        DBMS_OUTPUT.put_line(err_msg);

        ROLLBACK;
        RAISE;          

END;

/

EXIT