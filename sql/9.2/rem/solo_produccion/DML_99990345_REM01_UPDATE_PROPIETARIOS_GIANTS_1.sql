--/*
--#########################################
--## AUTOR=SIMEON SHOPOV
--## FECHA_CREACION=20180612
--## ARTEFACTO=batch
--## VERSION_ARTEFACTO=2.0.17
--## INCIDENCIA_LINK=REMVIP-1049
--## PRODUCTO=NO
--## 
--## Finalidad: 
--##            
--## INSTRUCCIONES:  
--## VERSIONES:
--##        0.1 Versión inicial
--#########################################
--*/
--Para permitir la visualización de texto en un bloque PL/SQL utilizando DBMS_OUTPUT.PUT_LINE
WHENEVER SQLERROR EXIT SQL.SQLCODE;
SET SERVEROUTPUT ON;
SET DEFINE OFF;

DECLARE
    V_SQL VARCHAR2(32000 CHAR); -- Sentencia a ejecutar         
    V_ESQUEMA VARCHAR2(25 CHAR):= 'REM01'; --'#ESQUEMA#'; -- Configuracion Esquema
    V_ESQUEMA_M VARCHAR2(25 CHAR):= 'REMMASTER'; --'#ESQUEMA_MASTER#'; -- Configuracion Esquema Master
    V_TABLA VARCHAR2(25 CHAR):= 'ACT_ACTIVO';
    V_COUNT NUMBER(16); -- Vble. para contar.
    V_COUNT_UPDATE NUMBER(16):= 0; -- Vble. para contar updates
    ERR_NUM NUMBER(25);  -- Vble. auxiliar para registrar errores en el script.
    ERR_MSG VARCHAR2(1024 CHAR); -- Vble. auxiliar para registrar errores en el script.
    V_USUARIO VARCHAR2(32 CHAR):= 'REMVIP-1049';
	
	PROPIETARIO VARCHAR2(56 CHAR) := 'G-GIANTS REO I, S.L.';

	ACT_NUM_ACTIVO NUMBER(16);
	
    TYPE T_JBV IS TABLE OF VARCHAR2(32000);
    TYPE T_ARRAY_JBV IS TABLE OF T_JBV; 
	
	V_JBV T_ARRAY_JBV := T_ARRAY_JBV(
		  T_JBV(5948164)
		, T_JBV(6970978)
		, T_JBV(6970979)
		, T_JBV(6970980)
		, T_JBV(6970981)
		, T_JBV(6970985)
		, T_JBV(6970987)
		, T_JBV(6970988)
		, T_JBV(6970989)
		, T_JBV(6970990)
		, T_JBV(6970991)
		, T_JBV(6970992)
		, T_JBV(6970993)
		, T_JBV(6970994)
		, T_JBV(6970995)
		, T_JBV(6970997)
		, T_JBV(6971242)
		, T_JBV(6971243)
		, T_JBV(6971244)
		, T_JBV(6971246)
		, T_JBV(6971247)
		, T_JBV(6971248)
		, T_JBV(6970999)
		, T_JBV(6971058)
		, T_JBV(6971059)
		, T_JBV(6971062)
		, T_JBV(6971063)
		, T_JBV(6971065)
		, T_JBV(6971068)
		, T_JBV(6971074)
		, T_JBV(6971075)
		, T_JBV(6971076)
		, T_JBV(6971077)
		, T_JBV(6971078)
		, T_JBV(6971079)
		, T_JBV(6971080)
		, T_JBV(6971083)
		, T_JBV(6971084)
		, T_JBV(6971085)
		, T_JBV(6971000)
		, T_JBV(6971002)
		, T_JBV(6971004)
		, T_JBV(6971007)
		, T_JBV(6971008)
		, T_JBV(6970009)
		, T_JBV(6971009)
		, T_JBV(6971010)
		, T_JBV(6971011)
		, T_JBV(6971012)
		, T_JBV(6970949)
		, T_JBV(6970950)
		, T_JBV(6970953)
		, T_JBV(6970954)
		, T_JBV(6970955)
		, T_JBV(6970956)
		, T_JBV(6970957)
		, T_JBV(6970958)
		, T_JBV(6970962)
		, T_JBV(6970963)
		, T_JBV(6970965)
		, T_JBV(6970967)
		, T_JBV(6970968)
		, T_JBV(6970074)
		, T_JBV(6971164)
		, T_JBV(6970042)
		, T_JBV(6971166)
		, T_JBV(6971168)
		, T_JBV(6971171)
		, T_JBV(6971172)
		, T_JBV(6971173)
		, T_JBV(6971174)
		, T_JBV(6971176)
		, T_JBV(6971177)
		, T_JBV(6971178)
		, T_JBV(6971179)
		, T_JBV(6971180)
		, T_JBV(6971181)
		, T_JBV(6971182)
		, T_JBV(6971183)
		, T_JBV(6971185)
		, T_JBV(6971186)
		, T_JBV(6971187)
		, T_JBV(6971188)
		, T_JBV(6971189)
		, T_JBV(6971192)
		, T_JBV(6971194)
		, T_JBV(6971195)
		, T_JBV(6971086)
		, T_JBV(6971087)
		, T_JBV(6971088)
		, T_JBV(6971249)
		, T_JBV(6971250)
		, T_JBV(6971252)
		, T_JBV(6971253)
		, T_JBV(6971013)
		, T_JBV(6971014)
		, T_JBV(6971015)
		, T_JBV(6971016)
		, T_JBV(6971017)
		, T_JBV(6971018)
		, T_JBV(6971019)
		, T_JBV(6971020)
		, T_JBV(6971021)
		, T_JBV(6971089)
		, T_JBV(6971090)
		, T_JBV(6971091)
		, T_JBV(6971092)
		, T_JBV(6971093)
		, T_JBV(6971094)
		, T_JBV(6970041)
		, T_JBV(6971095)
		, T_JBV(6970010)
		, T_JBV(6971100)
		, T_JBV(6971101)
		, T_JBV(6971102)
		, T_JBV(6970072)
		, T_JBV(6971105)
		, T_JBV(6971107)
		, T_JBV(6971108)
		, T_JBV(6971109)
		, T_JBV(6970007)
		, T_JBV(6971110)
		, T_JBV(6971111)
		, T_JBV(6971113)
		, T_JBV(6971114)
		, T_JBV(6971115)
		, T_JBV(6971116)
		, T_JBV(6970080)
		, T_JBV(6971314)
		, T_JBV(6971315)
		, T_JBV(6970081)
		, T_JBV(6971317)
		, T_JBV(6971320)
		, T_JBV(6971321)
		, T_JBV(6971322)
		, T_JBV(6971323)
		, T_JBV(6971324)
		, T_JBV(6971327)
		, T_JBV(6971328)
		, T_JBV(6971329)
		, T_JBV(6971330)
		, T_JBV(6971333)
		, T_JBV(6971334)
		, T_JBV(6971335)
		, T_JBV(6970082)
		, T_JBV(6971336)
		, T_JBV(6971338)
		, T_JBV(6970083)
		, T_JBV(6971339)
		, T_JBV(6971119)
		, T_JBV(6971120)
		, T_JBV(6971122)
		, T_JBV(6971127)
		, T_JBV(6971128)
		, T_JBV(6971129)
		, T_JBV(6971130)
		, T_JBV(6971132)
		, T_JBV(6970165)
		, T_JBV(6970166)
		, T_JBV(6971536)
		, T_JBV(6971538)
		, T_JBV(6971539)
		, T_JBV(6971541)
		, T_JBV(6971542)
		, T_JBV(6970005)
		, T_JBV(6970097)
		, T_JBV(6971543)
		, T_JBV(6971544)
		, T_JBV(6970167)
		, T_JBV(6971545)
		, T_JBV(6971550)
		, T_JBV(6971551)
		, T_JBV(6971492)
		, T_JBV(6971493)
		, T_JBV(6970157)
		, T_JBV(6970158)
		, T_JBV(6971506)
		, T_JBV(6971507)
		, T_JBV(6971508)
		, T_JBV(6971511)
		, T_JBV(6971512)
		, T_JBV(6971513)
		, T_JBV(6971515)
		, T_JBV(6971516)
		, T_JBV(6971519)
		, T_JBV(6971520)
		, T_JBV(6970093)
		, T_JBV(6971521)
		, T_JBV(6971522)
		, T_JBV(6970160)
		, T_JBV(6971341)
		, T_JBV(6971342)
		, T_JBV(6971343)
		, T_JBV(6971344)
		, T_JBV(6971345)
		, T_JBV(6971354)
		, T_JBV(6971355)
		, T_JBV(6971356)
		, T_JBV(6971358)
		, T_JBV(6971359)
		, T_JBV(6970103)
		, T_JBV(6970104)
		, T_JBV(6970105)
		, T_JBV(6970106)
		, T_JBV(6970107)
		, T_JBV(6971494)
		, T_JBV(6971495)
		, T_JBV(6971496)
		, T_JBV(6970151)
		, T_JBV(6970152)
		, T_JBV(6971499)
		, T_JBV(6971500)
		, T_JBV(6970013)
		, T_JBV(6971504)
		, T_JBV(6971505)
		, T_JBV(6970154)
		, T_JBV(6970155)
		, T_JBV(6970156)
		, T_JBV(6971022)
		, T_JBV(6971026)
		, T_JBV(6971028)
		, T_JBV(6971031)
		, T_JBV(6971032)
		, T_JBV(6971033)
		, T_JBV(6971034)
		, T_JBV(6971035)
		, T_JBV(6971036)
		, T_JBV(6971039)
		, T_JBV(6971134)
		, T_JBV(6971135)
		, T_JBV(6971136)
		, T_JBV(6971137)
		, T_JBV(6971140)
		, T_JBV(6971141)
		, T_JBV(6971142)
		, T_JBV(6970073)
		, T_JBV(6971145)
		, T_JBV(6971146)
		, T_JBV(6971147)
		, T_JBV(6971148)
		, T_JBV(6971149)
		, T_JBV(6971155)
		, T_JBV(6971156)
		, T_JBV(6971157)
		, T_JBV(6971158)
		, T_JBV(6971159)
		, T_JBV(6971160)
		, T_JBV(6971254)
		, T_JBV(6971255)
		, T_JBV(6971257)
		, T_JBV(6971258)
		, T_JBV(6971261)
		, T_JBV(6971262)
		, T_JBV(6971265)
		, T_JBV(6971266)
		, T_JBV(6971267)
		, T_JBV(6971268)
		, T_JBV(6971269)
		, T_JBV(6971270)
		, T_JBV(6971271)
		, T_JBV(6971272)
		, T_JBV(6971273)
		, T_JBV(6971274)
		, T_JBV(6971279)
		, T_JBV(6971280)
		, T_JBV(6971281)
		, T_JBV(6971282)
		, T_JBV(6971283)
		, T_JBV(6971284)
		, T_JBV(6971042)
		, T_JBV(6971045)
		, T_JBV(6971046)
		, T_JBV(6971049)
		, T_JBV(6971050)
		, T_JBV(6971051)
		, T_JBV(6971052)
		, T_JBV(6971053)
		, T_JBV(6971054)
		, T_JBV(6970868)
		, T_JBV(6970877)
		, T_JBV(6970878)
		, T_JBV(6970880)
		, T_JBV(6971162)
		, T_JBV(6970119)
		, T_JBV(6970120)
		, T_JBV(6971361)
		, T_JBV(6971362)
		, T_JBV(6971363)
		, T_JBV(6971364)
		, T_JBV(6971365)
		, T_JBV(6971366)
		, T_JBV(6971368)
		, T_JBV(6971369)
		, T_JBV(6971370)
		, T_JBV(6971371)
		, T_JBV(6971372)
		, T_JBV(6971373)
		, T_JBV(6970084)
		, T_JBV(6971374)
		, T_JBV(6970108)
		, T_JBV(6970109)
		, T_JBV(6970110)
		, T_JBV(6970111)
		, T_JBV(6970112)
		, T_JBV(6970113)
		, T_JBV(6970114)
		, T_JBV(6970115)
		, T_JBV(6969995)
		, T_JBV(6970117)
		, T_JBV(6970118)
		, T_JBV(6971468)
		, T_JBV(6970146)
		, T_JBV(6970881)
		, T_JBV(6970882)
		, T_JBV(6970883)
		, T_JBV(6970885)
		, T_JBV(6970887)
		, T_JBV(6970888)
		, T_JBV(6970889)
		, T_JBV(6970890)
		, T_JBV(6970891)
		, T_JBV(6969967)
		, T_JBV(6970893)
		, T_JBV(6970894)
		, T_JBV(6970895)
		, T_JBV(6971376)
		, T_JBV(6971378)
		, T_JBV(6971379)
		, T_JBV(6970121)
		, T_JBV(6970122)
		, T_JBV(6970123)
		, T_JBV(6970125)
		, T_JBV(6970126)
		, T_JBV(6971217)
		, T_JBV(6971218)
		, T_JBV(6971220)
		, T_JBV(6971221)
		, T_JBV(6970898)
		, T_JBV(6970899)
		, T_JBV(6970900)
		, T_JBV(6970901)
		, T_JBV(6970902)
		, T_JBV(6970904)
		, T_JBV(6970905)
		, T_JBV(6970906)
		, T_JBV(6970070)
		, T_JBV(6970907)
		, T_JBV(6970908)
		, T_JBV(6970909)
		, T_JBV(6970910)
		, T_JBV(6970071)
		, T_JBV(6970912)
		, T_JBV(6971223)
		, T_JBV(6970076)
		, T_JBV(6971225)
		, T_JBV(6971226)
		, T_JBV(6971227)
		, T_JBV(6971228)
		, T_JBV(6971229)
		, T_JBV(6971230)
		, T_JBV(6971231)
		, T_JBV(6971234)
		, T_JBV(6971235)
		, T_JBV(6971236)
		, T_JBV(6971237)
		, T_JBV(6971239)
		, T_JBV(6971240)
		, T_JBV(6971241)
		, T_JBV(6971285)
		, T_JBV(6971286)
		, T_JBV(6970004)
		, T_JBV(6971287)
		, T_JBV(6971288)
		, T_JBV(6971289)
		, T_JBV(6971291)
		, T_JBV(6971292)
		, T_JBV(6971293)
		, T_JBV(6971294)
		, T_JBV(6971295)
		, T_JBV(6971296)
		, T_JBV(6971297)
		, T_JBV(6971298)
		, T_JBV(6971300)
		, T_JBV(6971302)
		, T_JBV(6971303)
		, T_JBV(6971304)
		, T_JBV(6971305)
		, T_JBV(6971306)
		, T_JBV(6971307)
		, T_JBV(6971308)
		, T_JBV(6971311)
		, T_JBV(6971312)
		, T_JBV(6970008)
		, T_JBV(6970919)
		, T_JBV(6970920)
		, T_JBV(6970922)
		, T_JBV(6970923)
		, T_JBV(6970924)
		, T_JBV(6970925)
		, T_JBV(6970930)
		, T_JBV(6970931)
		, T_JBV(6970932)
		, T_JBV(6970935)
		, T_JBV(6970936)
		, T_JBV(6970940)
		, T_JBV(6970002)
		, T_JBV(6970944)
		, T_JBV(6970945)
		, T_JBV(6970947)
		, T_JBV(6970948)
		, T_JBV(6970147)
		, T_JBV(6971475)
		, T_JBV(6971477)
		, T_JBV(6970148)
		, T_JBV(6969969)
		, T_JBV(6971479)
		, T_JBV(6971480)
		, T_JBV(6971481)
		, T_JBV(6971482)
		, T_JBV(6971485)
		, T_JBV(6971486)
		, T_JBV(6971487)
		, T_JBV(6971488)
		, T_JBV(6970096)
		, T_JBV(6971532)
		, T_JBV(6971533)
		, T_JBV(6971534)
		, T_JBV(6970163)
		, T_JBV(6970164)
		, T_JBV(6970098)
		, T_JBV(6971554)
		, T_JBV(6971555)
		, T_JBV(6971557)
		, T_JBV(6971558)
		, T_JBV(6970168)
		, T_JBV(6971560)
		, T_JBV(6971561)
		, T_JBV(6970170)
		, T_JBV(6970171)
		, T_JBV(6970175)
		, T_JBV(6970176)
		, T_JBV(6970179)
		, T_JBV(6970192)
		, T_JBV(6970193)
		, T_JBV(6971571)
		, T_JBV(6971572)
		, T_JBV(6971573)
		, T_JBV(6971574)
		, T_JBV(6971575)
		, T_JBV(6971576)
		, T_JBV(6971577)
		, T_JBV(6971578)
		, T_JBV(6970195)
		, T_JBV(6970196)
		, T_JBV(6970198)
		, T_JBV(6970199)
		, T_JBV(6971664)
		, T_JBV(6971665)
		, T_JBV(6971666)
		, T_JBV(6970161)
		, T_JBV(6970162)
		, T_JBV(6970094)
		, T_JBV(6971523)
		, T_JBV(6971529)
		, T_JBV(6971530)
		, T_JBV(6970128)
		, T_JBV(6970129)
		, T_JBV(6971382)
		, T_JBV(6971383)
		, T_JBV(6971384)
		, T_JBV(6971385)
		, T_JBV(6971386)
		, T_JBV(6971392)
		, T_JBV(6971393)
		, T_JBV(6971394)
		, T_JBV(6971395)
		, T_JBV(6970203)
		, T_JBV(6970204)
		, T_JBV(6970205)
		, T_JBV(6971581)
		, T_JBV(6971582)
		, T_JBV(6970014)
		, T_JBV(6970015)
		, T_JBV(6971586)
		, T_JBV(6971587)
		, T_JBV(6971588)
		, T_JBV(6970206)
		, T_JBV(6970208)
		, T_JBV(6970209)
		, T_JBV(6970211)
		, T_JBV(6970740)
		, T_JBV(6970744)
		, T_JBV(6970747)
		, T_JBV(6970748)
		, T_JBV(6970749)
		, T_JBV(6970750)
		, T_JBV(6970752)
		, T_JBV(6970754)
		, T_JBV(6970808)
		, T_JBV(6970809)
		, T_JBV(6970811)
		, T_JBV(6970812)
		, T_JBV(6970814)
		, T_JBV(6970815)
		, T_JBV(6970818)
		, T_JBV(6970819)
		, T_JBV(6970821)
		, T_JBV(6970825)
		, T_JBV(6970828)
		, T_JBV(6971396)
		, T_JBV(6971398)
		, T_JBV(6971401)
		, T_JBV(6971408)
		, T_JBV(6971409)
		, T_JBV(6971410)
		, T_JBV(6970131)
		, T_JBV(6970132)
		, T_JBV(6970134)
		, T_JBV(6970135)
		, T_JBV(6970136)
		, T_JBV(6970137)
		, T_JBV(6971562)
		, T_JBV(6971564)
		, T_JBV(6971565)
		, T_JBV(6971566)
		, T_JBV(6971567)
		, T_JBV(6971568)
		, T_JBV(6970099)
		, T_JBV(6970183)
		, T_JBV(6970184)
		, T_JBV(6970025)
		, T_JBV(6970387)
		, T_JBV(6970388)
		, T_JBV(6970389)
		, T_JBV(6970390)
		, T_JBV(6970391)
		, T_JBV(6970392)
		, T_JBV(6970393)
		, T_JBV(6970396)
		, T_JBV(6970397)
		, T_JBV(6970398)
		, T_JBV(6970399)
		, T_JBV(6970400)
		, T_JBV(6970401)
		, T_JBV(6970402)
		, T_JBV(6970403)
		, T_JBV(6970404)
		, T_JBV(6970405)
		, T_JBV(6970406)
		, T_JBV(6970408)
		, T_JBV(6970409)
		, T_JBV(6970831)
		, T_JBV(6970832)
		, T_JBV(6970833)
		, T_JBV(6970755)
		, T_JBV(6970757)
		, T_JBV(6970759)
		, T_JBV(6970761)
		, T_JBV(6970065)
		, T_JBV(6971414)
		, T_JBV(6971416)
		, T_JBV(6971417)
		, T_JBV(6970085)
		, T_JBV(6971419)
		, T_JBV(6971420)
		, T_JBV(6971421)
		, T_JBV(6971422)
		, T_JBV(6971425)
		, T_JBV(6971428)
		, T_JBV(6971429)
		, T_JBV(6971430)
		, T_JBV(6971431)
		, T_JBV(6970012)
		, T_JBV(6971432)
		, T_JBV(6971433)
		, T_JBV(6971434)
		, T_JBV(6971436)
		, T_JBV(6970213)
		, T_JBV(6970214)
		, T_JBV(6970215)
		, T_JBV(6970216)
		, T_JBV(6970217)
		, T_JBV(6970218)
		, T_JBV(6970219)
		, T_JBV(6970220)
		, T_JBV(6970221)
		, T_JBV(6970222)
		, T_JBV(6970225)
		, T_JBV(6970226)
		, T_JBV(6970227)
		, T_JBV(6970411)
		, T_JBV(6969962)
		, T_JBV(6970466)
		, T_JBV(6970469)
		, T_JBV(6970470)
		, T_JBV(6970471)
		, T_JBV(6970473)
		, T_JBV(6970474)
		, T_JBV(6970477)
		, T_JBV(6970478)
		, T_JBV(6970479)
		, T_JBV(6970480)
		, T_JBV(6970481)
		, T_JBV(6970482)
		, T_JBV(6970486)
		, T_JBV(6970487)
		, T_JBV(6970488)
		, T_JBV(6970055)
		, T_JBV(6970489)
		, T_JBV(6971437)
		, T_JBV(6971438)
		, T_JBV(6971439)
		, T_JBV(6971440)
		, T_JBV(6971446)
		, T_JBV(6971447)
		, T_JBV(6971448)
		, T_JBV(6970139)
		, T_JBV(6970140)
		, T_JBV(6970141)
		, T_JBV(6970142)
		, T_JBV(6971449)
		, T_JBV(6971451)
		, T_JBV(6970143)
		, T_JBV(6970230)
		, T_JBV(6970231)
		, T_JBV(6970232)
		, T_JBV(6970233)
		, T_JBV(6970236)
		, T_JBV(6970048)
		, T_JBV(6970237)
		, T_JBV(6970240)
		, T_JBV(6970242)
		, T_JBV(6970243)
		, T_JBV(6970244)
		, T_JBV(6970245)
		, T_JBV(6970246)
		, T_JBV(6970490)
		, T_JBV(6970412)
		, T_JBV(6970413)
		, T_JBV(6970414)
		, T_JBV(6970415)
		, T_JBV(6970419)
		, T_JBV(6970420)
		, T_JBV(6970421)
		, T_JBV(6970425)
		, T_JBV(6970426)
		, T_JBV(6970427)
		, T_JBV(6970428)
		, T_JBV(6970429)
		, T_JBV(6970430)
		, T_JBV(6970431)
		, T_JBV(6970434)
		, T_JBV(6970435)
		, T_JBV(6970763)
		, T_JBV(6970764)
		, T_JBV(6970765)
		, T_JBV(6970766)
		, T_JBV(6970767)
		, T_JBV(6970772)
		, T_JBV(6970774)
		, T_JBV(6970775)
		, T_JBV(6970776)
		, T_JBV(6970777)
		, T_JBV(6970779)
		, T_JBV(6970781)
		, T_JBV(6970782)
		, T_JBV(6970784)
		, T_JBV(6970785)
		, T_JBV(6970786)
		, T_JBV(6970787)
		, T_JBV(6970788)
		, T_JBV(6970791)
		, T_JBV(6971452)
		, T_JBV(6971454)
		, T_JBV(6970090)
		, T_JBV(6970091)
		, T_JBV(6971456)
		, T_JBV(6971457)
		, T_JBV(6971458)
		, T_JBV(6971459)
		, T_JBV(6971460)
		, T_JBV(6971461)
		, T_JBV(6971462)
		, T_JBV(6971463)
		, T_JBV(6971464)
		, T_JBV(6971465)
		, T_JBV(6970265)
		, T_JBV(6970266)
		, T_JBV(6970436)
		, T_JBV(6970438)
		, T_JBV(6970439)
		, T_JBV(6970440)
		, T_JBV(6970441)
		, T_JBV(6970462)
		, T_JBV(6970463)
		, T_JBV(6970027)
		, T_JBV(6970464)
		, T_JBV(6970465)
		, T_JBV(6970361)
		, T_JBV(6970369)
		, T_JBV(6969998)
		, T_JBV(6970424)
		, T_JBV(6970372)
		, T_JBV(6970468)
		, T_JBV(6970503)
		, T_JBV(6970537)
		, T_JBV(6970518)
		, T_JBV(6970552)
		, T_JBV(6970555)
		, T_JBV(6970585)
		, T_JBV(6970530)
		, T_JBV(6970558)
		, T_JBV(6970267)
		, T_JBV(6970268)
		, T_JBV(6970269)
		, T_JBV(6970270)
		, T_JBV(6970272)
		, T_JBV(6970276)
		, T_JBV(6970277)
		, T_JBV(6970280)
		, T_JBV(6970292)
		, T_JBV(6970294)
		, T_JBV(6970295)
		, T_JBV(6970296)
		, T_JBV(6970297)
		, T_JBV(6970298)
		, T_JBV(6970284)
		, T_JBV(6970285)
		, T_JBV(6970286)
		, T_JBV(6970287)
		, T_JBV(6970288)
		, T_JBV(6970248)
		, T_JBV(6970249)
		, T_JBV(6971590)
		, T_JBV(6971591)
		, T_JBV(6970253)
		, T_JBV(6970254)
		, T_JBV(6969990)
		, T_JBV(6970100)
		, T_JBV(6971592)
		, T_JBV(6971593)
		, T_JBV(6971594)
		, T_JBV(6971596)
		, T_JBV(6970299)
		, T_JBV(6970300)
		, T_JBV(6970301)
		, T_JBV(6970302)
		, T_JBV(6970305)
		, T_JBV(6970306)
		, T_JBV(6970308)
		, T_JBV(6970309)
		, T_JBV(6970310)
		, T_JBV(6970311)
		, T_JBV(6970312)
		, T_JBV(6971624)
		, T_JBV(6970675)
		, T_JBV(6970676)
		, T_JBV(6970678)
		, T_JBV(6970679)
		, T_JBV(6970680)
		, T_JBV(6970681)
		, T_JBV(6970682)
		, T_JBV(6970683)
		, T_JBV(6970000)
		, T_JBV(6970686)
		, T_JBV(6970688)
		, T_JBV(6970690)
		, T_JBV(6970691)
		, T_JBV(6970692)
		, T_JBV(6970696)
		, T_JBV(6970697)
		, T_JBV(6970314)
		, T_JBV(6970315)
		, T_JBV(6970316)
		, T_JBV(6970318)
		, T_JBV(6970319)
		, T_JBV(6970320)
		, T_JBV(6970321)
		, T_JBV(6970323)
		, T_JBV(6970049)
		, T_JBV(6970325)
		, T_JBV(6970334)
		, T_JBV(6970340)
		, T_JBV(6970341)
		, T_JBV(6970342)
		, T_JBV(6970646)
		, T_JBV(6970602)
		, T_JBV(6970629)
		, T_JBV(6970664)
		, T_JBV(6970685)
		, T_JBV(6970623)
		, T_JBV(6970677)
		, T_JBV(6970689)
		, T_JBV(6970804)
		, T_JBV(6970695)
		, T_JBV(6970807)
		, T_JBV(6970810)
		, T_JBV(6970345)
		, T_JBV(6970346)
		, T_JBV(6970348)
		, T_JBV(6970349)
		, T_JBV(6970350)
		, T_JBV(6970351)
		, T_JBV(6970352)
		, T_JBV(6970353)
		, T_JBV(6970355)
		, T_JBV(6970356)
		, T_JBV(6970359)
		, T_JBV(6970360)
		, T_JBV(6970362)
		, T_JBV(6970366)
		, T_JBV(6970367)
		, T_JBV(6970368)
		, T_JBV(6970052)
		, T_JBV(6970793)
		, T_JBV(6970795)
		, T_JBV(6970796)
		, T_JBV(6970001)
		, T_JBV(6970798)
		, T_JBV(6970799)
		, T_JBV(6970800)
		, T_JBV(6970801)
		, T_JBV(6970802)
		, T_JBV(6970803)
		, T_JBV(6970805)
		, T_JBV(6970806)
		, T_JBV(6970616)
		, T_JBV(6970617)
		, T_JBV(6970618)
		, T_JBV(6970619)
		, T_JBV(6970621)
		, T_JBV(6970622)
		, T_JBV(6970630)
		, T_JBV(6970631)
		, T_JBV(6970375)
		, T_JBV(6970376)
		, T_JBV(6970377)
		, T_JBV(6970378)
		, T_JBV(6970379)
		, T_JBV(6970380)
		, T_JBV(6970053)
		, T_JBV(6970381)
		, T_JBV(6970382)
		, T_JBV(6970383)
		, T_JBV(6970384)
		, T_JBV(6970594)
		, T_JBV(6970599)
		, T_JBV(6970600)
		, T_JBV(6970604)
		, T_JBV(6970606)
		, T_JBV(6970864)
		, T_JBV(6970228)
		, T_JBV(6970354)
		, T_JBV(6970410)
		, T_JBV(6970317)
		, T_JBV(6970324)
		, T_JBV(6970322)
		, T_JBV(6970422)
		, T_JBV(6970060)
		, T_JBV(6970491)
		, T_JBV(6970495)
		, T_JBV(6970496)
		, T_JBV(6970497)
		, T_JBV(6970499)
		, T_JBV(6970502)
		, T_JBV(6969976)
		, T_JBV(6970504)
		, T_JBV(6970506)
		, T_JBV(6970006)
		, T_JBV(6970720)
		, T_JBV(6970834)
		, T_JBV(6970835)
		, T_JBV(6970836)
		, T_JBV(6970837)
		, T_JBV(6970839)
		, T_JBV(6970840)
		, T_JBV(6970842)
		, T_JBV(6970508)
		, T_JBV(6969999)
		, T_JBV(6970511)
		, T_JBV(6970512)
		, T_JBV(6970514)
		, T_JBV(6970515)
		, T_JBV(6970517)
		, T_JBV(6969971)
		, T_JBV(6970519)
		, T_JBV(6970520)
		, T_JBV(6970522)
		, T_JBV(6970524)
		, T_JBV(6970525)
		, T_JBV(6970526)
		, T_JBV(6970057)
		, T_JBV(6970527)
		, T_JBV(6970528)
		, T_JBV(6970529)
		, T_JBV(6970644)
		, T_JBV(6970645)
		, T_JBV(6970652)
		, T_JBV(6970653)
		, T_JBV(6970656)
		, T_JBV(6970657)
		, T_JBV(6970658)
		, T_JBV(6970661)
		, T_JBV(6970662)
		, T_JBV(6970665)
		, T_JBV(6970666)
		, T_JBV(6971597)
		, T_JBV(6971598)
		, T_JBV(6971600)
		, T_JBV(6970016)
		, T_JBV(6970532)
		, T_JBV(6970533)
		, T_JBV(6970534)
		, T_JBV(6971629)
		, T_JBV(6971630)
		, T_JBV(6971631)
		, T_JBV(6971632)
		, T_JBV(6969972)
		, T_JBV(6970536)
		, T_JBV(6970539)
		, T_JBV(6970540)
		, T_JBV(6970541)
		, T_JBV(6970542)
		, T_JBV(6970543)
		, T_JBV(6970545)
		, T_JBV(6970546)
		, T_JBV(6970547)
		, T_JBV(6971634)
		, T_JBV(6970551)
		, T_JBV(6970553)
		, T_JBV(6971602)
		, T_JBV(6970101)
		, T_JBV(6971603)
		, T_JBV(6971604)
		, T_JBV(6970554)
		, T_JBV(6970058)
		, T_JBV(6970559)
		, T_JBV(6970560)
		, T_JBV(6970561)
		, T_JBV(6970565)
		, T_JBV(6970566)
		, T_JBV(6970567)
		, T_JBV(6970568)
		, T_JBV(6970569)
		, T_JBV(6970570)
		, T_JBV(6970575)
		, T_JBV(6970576)
		, T_JBV(6969973)
		, T_JBV(6969996)
		, T_JBV(6970289)
		, T_JBV(6970290)
		, T_JBV(6971553)
		, T_JBV(6971605)
		, T_JBV(6971606)
		, T_JBV(6971609)
		, T_JBV(6971610)
		, T_JBV(6971611)
		, T_JBV(6970257)
		, T_JBV(6970258)
		, T_JBV(6970259)
		, T_JBV(6970260)
		, T_JBV(6970261)
		, T_JBV(6970263)
		, T_JBV(6970264)
		, T_JBV(6970385)
		, T_JBV(6970386)
		, T_JBV(6970582)
		, T_JBV(6970583)
		, T_JBV(6970586)
		, T_JBV(6970588)
		, T_JBV(6970589)
		, T_JBV(6970593)
		, T_JBV(6969963)
		, T_JBV(6971636)
		, T_JBV(6971637)
		, T_JBV(6971638)
		, T_JBV(6971639)
		, T_JBV(6971640)
		, T_JBV(6971641)
		, T_JBV(6971642)
		, T_JBV(6971643)
		, T_JBV(6971644)
		, T_JBV(6971645)
		, T_JBV(6971646)
		, T_JBV(6971647)
		, T_JBV(6971648)
		, T_JBV(6971649)
		, T_JBV(6971650)
		, T_JBV(6971651)
		, T_JBV(6971652)
		, T_JBV(6971653)
		, T_JBV(6971658)
		, T_JBV(6971659)
		, T_JBV(6971661)
		, T_JBV(6971073)
		, T_JBV(6970986)
		, T_JBV(6970003)
		, T_JBV(6971112)
		, T_JBV(6971082)
		, T_JBV(6971103)
		, T_JBV(6971027)
		, T_JBV(6971106)
		, T_JBV(6971150)
		, T_JBV(6971161)
		, T_JBV(6971170)
		, T_JBV(6971169)
		, T_JBV(6971175)
		, T_JBV(6971278)
		, T_JBV(6971259)
		, T_JBV(6971310)
		, T_JBV(6971264)
		, T_JBV(6971299)
		, T_JBV(6971326)
		, T_JBV(6970078)
		, T_JBV(6971277)
		, T_JBV(6971319)
		, T_JBV(6971377)
		, T_JBV(6971367)
		, T_JBV(6971400)
		, T_JBV(6971353)
		, T_JBV(6971450)
		, T_JBV(6970086)
		, T_JBV(6970011)
		, T_JBV(6971357)
		, T_JBV(6971426)
		, T_JBV(6971466)
		, T_JBV(6971467)
		, T_JBV(6971527)
		, T_JBV(6971514)
		, T_JBV(6971503)
		, T_JBV(6971547)
		, T_JBV(6970095)
		, T_JBV(6971537)
		, T_JBV(6971535)
		, T_JBV(6971556)
		, T_JBV(6971579)
		, T_JBV(6971585)
		, T_JBV(6971570)
		, T_JBV(6971625)
		, T_JBV(6971595)
		, T_JBV(6971660)
		, T_JBV(6971628)
		, T_JBV(6971663)
		, T_JBV(6971657)
		, T_JBV(6971635)
		, T_JBV(6971655)
		, T_JBV(6971656)
		, T_JBV(6970505)
		, T_JBV(6971654)
		, T_JBV(6971662)
		, T_JBV(6971633)
		, T_JBV(6971540)
		, T_JBV(6971423)
		, T_JBV(6971444)
		, T_JBV(6971391)
		, T_JBV(6971411)
		, T_JBV(6971340)
		, T_JBV(6971318)
		, T_JBV(6971222)
		, T_JBV(6971139)
		, T_JBV(6971081)
		, T_JBV(6970984)
		, T_JBV(6970964)
		, T_JBV(6970921)
		, T_JBV(6970886)
		, T_JBV(6970879)
		, T_JBV(6970817)
		, T_JBV(6970778)
		, T_JBV(6970663)
		, T_JBV(6970374)
		, T_JBV(6970054)
		, T_JBV(6970344)
		, T_JBV(6970278)
		, T_JBV(6970169)
		, T_JBV(6970116)
		, T_JBV(6970813)
		, T_JBV(6970816)
		, T_JBV(6970769)
		, T_JBV(6970823)
		, T_JBV(6970838)
		, T_JBV(6970827)
		, T_JBV(6970841)
		, T_JBV(6970066)
		, T_JBV(6970762)
		, T_JBV(6970966)
		, T_JBV(6970884)
		, T_JBV(6970876)
		, T_JBV(6970933)
		, T_JBV(6970897)
		, T_JBV(6970934)
		, T_JBV(6970982)
		, T_JBV(6971072)
		, T_JBV(6971047)
		, T_JBV(6970926)
		, T_JBV(6970896)
	); 
V_TMP_JBV T_JBV;
BEGIN

 
 FOR I IN V_JBV.FIRST .. V_JBV.LAST
 LOOP
 
 V_TMP_JBV := V_JBV(I);
 			  ACT_NUM_ACTIVO := TRIM(V_TMP_JBV(1));

			EXECUTE IMMEDIATE 'SELECT COUNT(1) FROM '||V_ESQUEMA||'.ACT_PAC_PROPIETARIO_ACTIVO PAC
								JOIN '||V_ESQUEMA||'.ACT_ACTIVO ACT ON ACT.ACT_ID = PAC.ACT_ID
								WHERE ACT.ACT_NUM_ACTIVO = '||ACT_NUM_ACTIVO||'' INTO V_COUNT;
								
			IF V_COUNT = 0 THEN 								
				V_SQL := 'INSERT INTO '||V_ESQUEMA||'.ACT_PAC_PROPIETARIO_ACTIVO (
				  PAC_ID
				, ACT_ID
				, PRO_ID
				, PAC_PORC_PROPIEDAD
				, USUARIOCREAR
				, FECHACREAR
				) VALUES (
				 '||V_ESQUEMA||'.S_ACT_PAC_PROPIETARIO_ACTIVO.NEXTVAL
				, (SELECT ACT_ID FROM '||V_ESQUEMA||'.ACT_ACTIVO WHERE ACT_NUM_ACTIVO = '||ACT_NUM_ACTIVO||')
				, (SELECT PRO_ID FROM '||V_ESQUEMA||'.ACT_PRO_PROPIETARIO WHERE PRO_NOMBRE = '''||PROPIETARIO||''')
				, 100
				, '''||V_USUARIO||'''
				, SYSDATE
				)
			';
			DBMS_OUTPUT.PUT_LINE(V_SQL);
				EXECUTE IMMEDIATE V_SQL;
		
			DBMS_OUTPUT.PUT_LINE('Asignado el activo '||ACT_NUM_ACTIVO||' al propietario '||PROPIETARIO||'');			
		
			ELSE
			
				V_SQL := 'UPDATE '||V_ESQUEMA||'.ACT_PAC_PROPIETARIO_ACTIVO
							SET 
							  PRO_ID = (SELECT PRO_ID FROM '||V_ESQUEMA||'.ACT_PRO_PROPIETARIO WHERE PRO_NOMBRE = '''||PROPIETARIO||''')
							, USUARIOMODIFICAR = '''||V_USUARIO||'''
							, FECHAMODIFICAR = SYSDATE
							, PAC_PORC_PROPIEDAD = 100
							WHERE ACT_ID = (SELECT ACT_ID FROM '||V_ESQUEMA||'.ACT_ACTIVO WHERE ACT_NUM_ACTIVO = '||ACT_NUM_ACTIVO||')
			';
			DBMS_OUTPUT.PUT_LINE(V_SQL);
				EXECUTE IMMEDIATE V_SQL;
				DBMS_OUTPUT.PUT_LINE('Cambiado el activo '||ACT_NUM_ACTIVO||' al propietario '||PROPIETARIO||'');			
			END IF;
			
			IF SQL%ROWCOUNT > 0 THEN
					V_COUNT_UPDATE := V_COUNT_UPDATE + 1;
				END IF;

 END LOOP;			    
    
        DBMS_OUTPUT.PUT_LINE('[INFO] Puestos en total '||V_COUNT_UPDATE||' propietarios');
    
	COMMIT;

EXCEPTION
    WHEN OTHERS THEN
      DBMS_OUTPUT.PUT_LINE('[ERROR] Se ha producido un error en la ejecución:'||TO_CHAR(SQLCODE));
      DBMS_OUTPUT.PUT_LINE('-----------------------------------------------------------');
      DBMS_OUTPUT.PUT_LINE(SQLERRM);
      ROLLBACK;
      RAISE;
END;
/
EXIT;
