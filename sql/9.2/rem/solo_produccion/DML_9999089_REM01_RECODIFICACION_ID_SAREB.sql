--/*
--#########################################
--## AUTOR=SIMEON SHOPOV
--## FECHA_CREACION=20180416
--## ARTEFACTO=batch
--## VERSION_ARTEFACTO=2.0.17
--## INCIDENCIA_LINK=REMVIP-505
--## PRODUCTO=NO
--## 
--## Finalidad: 
--##            
--## INSTRUCCIONES:  
--## VERSIONES:
--##        0.1 Versión inicial
--#########################################
--*/
--Para permitir la visualización de texto en un bloque PL/SQL utilizando DBMS_OUTPUT.PUT_LINE
WHENEVER SQLERROR EXIT SQL.SQLCODE;
SET SERVEROUTPUT ON;
SET DEFINE OFF;

DECLARE
    V_SQL VARCHAR2(32000 CHAR); -- Sentencia a ejecutar         
    V_ESQUEMA VARCHAR2(25 CHAR):= 'REM01'; --'#ESQUEMA#'; -- Configuracion Esquema
    V_ESQUEMA_M VARCHAR2(25 CHAR):= 'REMMASTER'; --'#ESQUEMA_MASTER#'; -- Configuracion Esquema Master
    V_TABLA VARCHAR2(25 CHAR):= 'ACT_ACTIVO';
    --V_COUNT NUMBER(16); -- Vble. para contar.
    V_COUNT_UPDATE NUMBER(16):= 0; -- Vble. para contar updates
    ERR_NUM NUMBER(25);  -- Vble. auxiliar para registrar errores en el script.
    ERR_MSG VARCHAR2(1024 CHAR); -- Vble. auxiliar para registrar errores en el script.
    V_USUARIO VARCHAR2(32 CHAR):= 'REMVIP-505';

	ACT_NUM_ACTIVO NUMBER(16);
	ACT_NUM_ACTIVO_SAREB VARCHAR2(55 CHAR);

    TYPE T_JBV IS TABLE OF VARCHAR2(32000);
    TYPE T_ARRAY_JBV IS TABLE OF T_JBV; 
	
	V_JBV T_ARRAY_JBV := T_ARRAY_JBV(
		  T_JBV(200768,549351)
		, T_JBV(184213,712024)
		, T_JBV(183783,697496)
		, T_JBV(183601,727120)
		, T_JBV(183527,680103)
		, T_JBV(180606,695093)
		, T_JBV(180080,648131)
		, T_JBV(179053,648132)
		, T_JBV(174868,566891)
		, T_JBV(162155,571652)
		, T_JBV(161759,547564)
		, T_JBV(161758,564830)
		, T_JBV(161548,547566)
		, T_JBV(161515,564832)
		, T_JBV(158448,562453)
		, T_JBV(158319,566003)
		, T_JBV(151877,569559)
		, T_JBV(151855,539016)
		, T_JBV(151854,564831)
		, T_JBV(151853,544016)
		, T_JBV(151584,556964)
		, T_JBV(151583,550257)
		, T_JBV(151432,530405)
		, T_JBV(151431,553895)
		, T_JBV(149103,569560)
		, T_JBV(144028,542671)
		, T_JBV(144027,547565)
		, T_JBV(143786,550260)
		, T_JBV(143785,535363)
		, T_JBV(143784,544018)
		, T_JBV(143783,550259)
		, T_JBV(143552,550258)
		, T_JBV(139898,556965)
		, T_JBV(139897,567902)
		, T_JBV(139595,544017)
		, T_JBV(137621,558534)
		, T_JBV(137351,536575)
		, T_JBV(131805,717865)
		, T_JBV(131804,717864)
		, T_JBV(131803,652541)
		, T_JBV(113506,713640)
		, T_JBV(113505,682418)
		, T_JBV(113209,682417)
		, T_JBV(113208,644804)
		, T_JBV(113161,653998)
		, T_JBV(113160,644805)
		, T_JBV(112633,703835)
		, T_JBV(112386,653996)
		, T_JBV(112164,652948)
		, T_JBV(112123,653997)
		, T_JBV(112122,722544)
		, T_JBV(112072,699706)
		, T_JBV(112071,676317)
		, T_JBV(111939,659693)
		, T_JBV(111938,649825)
		, T_JBV(110699,700937)
		, T_JBV(110283,682419)
		, T_JBV(110244,736926)
		, T_JBV(110243,728673)
		, T_JBV(110174,667468)
		, T_JBV(109611,703834)
		, T_JBV(107710,644806)
		, T_JBV(107236,649826)
		, T_JBV(107235,719604)
		, T_JBV(103189,686089)
		, T_JBV(103188,721592)
		, T_JBV(103112,648718)
		, T_JBV(100208,659689)
		, T_JBV(100207,659688)
		, T_JBV(100206,693199)
		, T_JBV(99977,722542)
		, T_JBV(99946,653995)
		, T_JBV(99888,719603)
		, T_JBV(99887,682415)
		, T_JBV(99886,736924)
		, T_JBV(99885,653993)
		, T_JBV(99755,684879)
		, T_JBV(99754,728671)
		, T_JBV(99753,736923)
		, T_JBV(99752,684876)
		, T_JBV(99508,713637)
		, T_JBV(99407,719599)
		, T_JBV(99406,684878)
		, T_JBV(99405,728670)
		, T_JBV(94637,667467)
		, T_JBV(94636,736925)
		, T_JBV(94635,693198)
		, T_JBV(94202,676315)
		, T_JBV(94201,704657)
		, T_JBV(94200,722540)
		, T_JBV(94199,644802)
		, T_JBV(94198,676312)
		, T_JBV(94197,649822)
		, T_JBV(94196,736920)
		, T_JBV(94195,722539)
		, T_JBV(94194,676310)
		, T_JBV(93978,676316)
		, T_JBV(93977,699702)
		, T_JBV(93976,682412)
		, T_JBV(93975,676311)
		, T_JBV(93974,722538)
		, T_JBV(93973,693196)
		, T_JBV(93940,699703)
		, T_JBV(93939,682414)
		, T_JBV(93858,644803)
		, T_JBV(90513,722543)
		, T_JBV(90512,722541)
		, T_JBV(90511,736922)
		, T_JBV(90510,693197)
		, T_JBV(90509,728669)
		, T_JBV(90450,659690)
		, T_JBV(90449,653992)
		, T_JBV(90243,728668)
		, T_JBV(90242,736921)
		, T_JBV(89993,676314)
		, T_JBV(89992,719602)
		, T_JBV(89991,719601)
		, T_JBV(89990,719600)
		, T_JBV(89989,713636)
		, T_JBV(89736,699701)
		, T_JBV(89401,680104)
		, T_JBV(89400,702059)
		, T_JBV(88979,695094)
		, T_JBV(88865,712025)
		, T_JBV(88864,708997)
		, T_JBV(88742,699704)
		, T_JBV(88741,713639)
		, T_JBV(88740,653994)
		, T_JBV(88739,682413)
		, T_JBV(88738,659687)
		, T_JBV(88737,728667)
		, T_JBV(88736,719598)
		, T_JBV(88718,728672)
		, T_JBV(88717,713638)
		, T_JBV(88716,649824)
		, T_JBV(88715,649823)
		, T_JBV(88459,693201)
		, T_JBV(88458,684877)
		, T_JBV(88457,684875)
		, T_JBV(88456,644801)
		, T_JBV(88455,649724)
		, T_JBV(88420,676313)
		, T_JBV(88419,653991)
		, T_JBV(88217,699705)
		, T_JBV(88216,659691)
		, T_JBV(88215,704658)
		, T_JBV(88214,693200)
		, T_JBV(88213,684880)
		, T_JBV(88212,704656)
		, T_JBV(84474,697497)
		, T_JBV(79998,702060)
		, T_JBV(79997,658492)
		, T_JBV(79996,732687)
		, T_JBV(79543,702058)
	); 
	V_TMP_JBV T_JBV;
BEGIN


 
 FOR I IN V_JBV.FIRST .. V_JBV.LAST
 LOOP
 
 V_TMP_JBV := V_JBV(I);
  			  ACT_NUM_ACTIVO := TRIM(V_TMP_JBV(1));
 			  ACT_NUM_ACTIVO_SAREB := TRIM(V_TMP_JBV(2));
			
	

		V_SQL := 'UPDATE '||V_ESQUEMA||'.'||V_TABLA||' SET
					 ACT_NUM_ACTIVO_SAREB = '''||ACT_NUM_ACTIVO_SAREB||'''
				   , USUARIOMODIFICAR = '''||V_USUARIO||'''
				   , FECHAMODIFICAR = SYSDATE
				   WHERE ACT_NUM_ACTIVO = '||ACT_NUM_ACTIVO||'
					';


				EXECUTE IMMEDIATE V_SQL;
			    DBMS_OUTPUT.PUT_LINE('Puesto el ACT_NUM_ACTIVO_SAREB A '||ACT_NUM_ACTIVO_SAREB||' EN EL ACTIVO CON ID_HAYA '||ACT_NUM_ACTIVO);
				V_COUNT_UPDATE := V_COUNT_UPDATE + 1;

 END LOOP;			    
    
	COMMIT;

    DBMS_OUTPUT.PUT_LINE('[INFO] Se han updateado en total '||V_COUNT_UPDATE||' registros');

EXCEPTION
    WHEN OTHERS THEN
      DBMS_OUTPUT.PUT_LINE('[ERROR] Se ha producido un error en la ejecución:'||TO_CHAR(SQLCODE));
      DBMS_OUTPUT.PUT_LINE('-----------------------------------------------------------');
      DBMS_OUTPUT.PUT_LINE(SQLERRM);
      ROLLBACK;
      RAISE;
END;
/
EXIT;
