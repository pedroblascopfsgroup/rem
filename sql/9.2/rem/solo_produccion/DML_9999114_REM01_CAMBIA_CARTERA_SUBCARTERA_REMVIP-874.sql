--/*
--#########################################
--## AUTOR=DAP
--## FECHA_CREACION=20180601
--## ARTEFACTO=batch
--## VERSION_ARTEFACTO=2.0.17
--## INCIDENCIA_LINK=REMVIP-874
--## PRODUCTO=NO
--## 
--## Finalidad: 
--##            
--## INSTRUCCIONES:  
--## VERSIONES:
--##        0.1 Versión inicial
--#########################################
--*/
--Para permitir la visualización de texto en un bloque PL/SQL utilizando DBMS_OUTPUT.PUT_LINE
WHENEVER SQLERROR EXIT SQL.SQLCODE;
SET SERVEROUTPUT ON;
SET DEFINE OFF;

DECLARE

    V_ESQUEMA VARCHAR2(50 CHAR) := '#ESQUEMA#';
    V_MSQL VARCHAR2(4000 CHAR);
    V_CRA_DESC VARCHAR2(200 CHAR);
    V_SCR_DESC VARCHAR2(200 CHAR);
    TYPE T_ACT IS TABLE OF VARCHAR2(240 CHAR);
    TYPE T_ARRAY IS TABLE OF T_ACT;
    V_USUARIO VARCHAR2(50 CHAR) := 'REMVIP-874';
    V_ARRAY T_ARRAY := T_ARRAY (
        T_ACT(6762404, '03'),
        T_ACT(6762784, '03'),
        T_ACT(6762949, '03'),
        T_ACT(6764227, '03'),
        T_ACT(6764614, '03'),
        T_ACT(6765346, '03'),
        T_ACT(6767807, '03'),
        T_ACT(6767950, '03'),
        T_ACT(6767951, '03'),
        T_ACT(6767958, '03'),
        T_ACT(6768247, '03'),
        T_ACT(6768251, '03'),
        T_ACT(6768263, '03'),
        T_ACT(6768568, '03'),
        T_ACT(6768571, '03'),
        T_ACT(6770842, '03'),
        T_ACT(6773664, '03'),
        T_ACT(6773671, '03'),
        T_ACT(6774019, '03'),
        T_ACT(6774028, '03'),
        T_ACT(6774044, '03'),
        T_ACT(6775907, '03'),
        T_ACT(6776316, '03'),
        T_ACT(6776499, '03'),
        T_ACT(6776503, '03'),
        T_ACT(6779880, '03'),
        T_ACT(6781345, '03'),
        T_ACT(6782693, '03'),
        T_ACT(6782701, '03'),
        T_ACT(6782723, '03'),
        T_ACT(6782913, '03'),
        T_ACT(6782920, '03'),
        T_ACT(6782925, '03'),
        T_ACT(6782929, '03'),
        T_ACT(6782931, '03'),
        T_ACT(6785827, '03'),
        T_ACT(6785828, '03'),
        T_ACT(6786761, '03'),
        T_ACT(6786764, '03'),
        T_ACT(6786765, '03'),
        T_ACT(6786766, '03'),
        T_ACT(6786767, '03'),
        T_ACT(6786768, '03'),
        T_ACT(6786769, '03'),
        T_ACT(6787769, '03'),
        T_ACT(6787772, '03'),
        T_ACT(6788091, '03'),
        T_ACT(6788171, '03'),
        T_ACT(6788364, '03'),
        T_ACT(6788665, '03'),
        T_ACT(6788666, '03'),
        T_ACT(6788671, '03'),
        T_ACT(6788672, '03'),
        T_ACT(6788674, '03'),
        T_ACT(6788675, '03'),
        T_ACT(6788676, '03'),
        T_ACT(6788678, '03'),
        T_ACT(6788680, '03'),
        T_ACT(6788683, '03'),
        T_ACT(6788838, '03'),
        T_ACT(6788862, '03'),
        T_ACT(6788940, '03'),
        T_ACT(6788957, '03'),
        T_ACT(6789188, '03'),
        T_ACT(6789207, '03'),
        T_ACT(6789222, '03'),
        T_ACT(6789418, '03'),
        T_ACT(6789431, '03'),
        T_ACT(6789450, '03'),
        T_ACT(6789455, '03'),
        T_ACT(6791353, '03'),
        T_ACT(6791397, '03'),
        T_ACT(6791406, '03'),
        T_ACT(6791801, '03'),
        T_ACT(6791851, '03'),
        T_ACT(6791873, '03'),
        T_ACT(6793556, '03'),
        T_ACT(6793557, '03'),
        T_ACT(6793559, '03'),
        T_ACT(6793560, '03'),
        T_ACT(6795437, '03'),
        T_ACT(6795438, '03'),
        T_ACT(6795442, '03'),
        T_ACT(6795443, '03'),
        T_ACT(6795446, '03'),
        T_ACT(6795448, '03'),
        T_ACT(6795449, '03'),
        T_ACT(6796023, '03'),
        T_ACT(6796024, '03'),
        T_ACT(6796027, '03'),
        T_ACT(6796262, '03'),
        T_ACT(6796809, '03'),
        T_ACT(6796811, '03'),
        T_ACT(6796824, '03'),
        T_ACT(6796836, '03'),
        T_ACT(6796840, '03'),
        T_ACT(6797111, '03'),
        T_ACT(6797121, '03'),
        T_ACT(6797131, '03'),
        T_ACT(6797137, '03'),
        T_ACT(6797138, '03'),
        T_ACT(6797155, '03'),
        T_ACT(6798255, '03'),
        T_ACT(6798262, '03'),
        T_ACT(6798749, '03'),
        T_ACT(6798751, '03'),
        T_ACT(6798752, '03'),
        T_ACT(6798771, '03'),
        T_ACT(6798772, '03'),
        T_ACT(6798778, '03'),
        T_ACT(6798786, '03'),
        T_ACT(6800140, '03'),
        T_ACT(6800299, '03'),
        T_ACT(6801436, '03'),
        T_ACT(6801438, '03'),
        T_ACT(6801569, '03'),
        T_ACT(6801571, '03'),
        T_ACT(6803442, '03'),
        T_ACT(6803450, '03'),
        T_ACT(6803459, '03'),
        T_ACT(6803462, '03'),
        T_ACT(6803504, '03'),
        T_ACT(6803994, '03'),
        T_ACT(6804139, '03'),
        T_ACT(6804140, '03'),
        T_ACT(6804144, '03'),
        T_ACT(6804145, '03'),
        T_ACT(6804146, '03'),
        T_ACT(6804148, '03'),
        T_ACT(6809829, '03'),
        T_ACT(6809839, '03'),
        T_ACT(6809843, '03'),
        T_ACT(6809846, '03'),
        T_ACT(6809848, '03'),
        T_ACT(6809853, '03'),
        T_ACT(6809855, '03'),
        T_ACT(6809882, '03'),
        T_ACT(6809884, '03'),
        T_ACT(6809885, '03'),
        T_ACT(6809889, '03'),
        T_ACT(6809897, '03'),
        T_ACT(6809902, '03'),
        T_ACT(6809916, '03'),
        T_ACT(6809923, '03'),
        T_ACT(6809943, '03'),
        T_ACT(6809955, '03'),
        T_ACT(6809967, '03'),
        T_ACT(6809969, '03'),
        T_ACT(6810477, '03'),
        T_ACT(6810923, '03'),
        T_ACT(6811063, '03'),
        T_ACT(6811064, '03'),
        T_ACT(6811065, '03'),
        T_ACT(6811597, '03'),
        T_ACT(6811599, '03'),
        T_ACT(6811956, '03'),
        T_ACT(6811957, '03'),
        T_ACT(6812100, '03'),
        T_ACT(6813849, '03'),
        T_ACT(6813858, '03'),
        T_ACT(6814456, '03'),
        T_ACT(6814912, '03'),
        T_ACT(6815071, '03'),
        T_ACT(6818269, '03'),
        T_ACT(6819279, '03'),
        T_ACT(6825058, '03'),
        T_ACT(6825083, '03'),
        T_ACT(6826904, '03'),
        T_ACT(6826979, '03'),
        T_ACT(6827861, '03'),
        T_ACT(6830860, '03'),
        T_ACT(6830879, '03'),
        T_ACT(6830896, '03'),
        T_ACT(6844328, '03'),
        T_ACT(6844331, '03'),
        T_ACT(6844333, '03'),
        T_ACT(6886511, '03'),
        T_ACT(6891001, '03'),
        T_ACT(6891834, '03'),
        T_ACT(6934328, '03'),
        T_ACT(6950332, '03'),
        T_ACT(6950333, '03'),
        T_ACT(6950334, '03'),
        T_ACT(6957221, '03'),
        T_ACT(6962199, '03'),
        T_ACT(6962200, '03'),
        T_ACT(6811603, '01'),
        T_ACT(6811604, '01'),
        T_ACT(6811605, '01'),
        T_ACT(6811606, '01'),
        T_ACT(6811607, '01'),
        T_ACT(6811608, '01'),
        T_ACT(6811609, '01'),
        T_ACT(6811610, '01'),
        T_ACT(6811611, '01'),
        T_ACT(6811612, '01'),
        T_ACT(6811613, '01'),
        T_ACT(6811614, '01'),
        T_ACT(6811615, '01'),
        T_ACT(6811616, '01'),
        T_ACT(6811617, '01'),
        T_ACT(6811618, '01'),
        T_ACT(6811619, '01'),
        T_ACT(6811620, '01'),
        T_ACT(6811621, '01'),
        T_ACT(6811622, '01'),
        T_ACT(6811623, '01'),
        T_ACT(6889261, '01'),
        T_ACT(6889262, '01'),
        T_ACT(6889263, '01'),
        T_ACT(6889264, '01'),
        T_ACT(6889265, '01'),
        T_ACT(6889266, '01'),
        T_ACT(6889267, '01'),
        T_ACT(6889268, '01'),
        T_ACT(6889269, '01'),
        T_ACT(6889270, '01')
    );
    V_TMP_ACT T_ACT;

    PL_OUTPUT VARCHAR2(32000 CHAR);

BEGIN

    FOR I IN V_ARRAY.FIRST .. V_ARRAY.LAST
    LOOP

    V_MSQL := '';
    EXECUTE IMMEDIATE V_MSQL;
    PL_OUTPUT := PL_OUTPUT || ' [INFO] Activo ' || V_TMP_ACT(1) || ' cambiado de la cartera ' ||
        
    END LOOP;
    
EXCEPTION
    WHEN OTHERS THEN
        PL_OUTPUT := PL_OUTPUT || '[ERROR] Se ha producido un error en la ejecución: ' || TO_CHAR(SQLCODE) || CHR(10);
        PL_OUTPUT := PL_OUTPUT || '-----------------------------------------------------------' || CHR(10);
        PL_OUTPUT := PL_OUTPUT || SQLERRM || CHR(10);
        DBMS_OUTPUT.PUT_LINE(PL_OUTPUT);
        ROLLBACK;
        RAISE;
END;
/
EXIT;