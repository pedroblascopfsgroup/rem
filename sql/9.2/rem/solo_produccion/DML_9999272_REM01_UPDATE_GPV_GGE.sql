--/*
--##########################################
--## AUTOR=PABLO MESEGUER
--## FECHA_CREACION=20190117
--## ARTEFACTO=online
--## VERSION_ARTEFACTO=9.2
--## INCIDENCIA_LINK=REMVIP-2918
--## PRODUCTO=NO
--##
--## Finalidad: Actualización de gestores comerciales
--## INSTRUCCIONES:
--## VERSIONES:
--##        0.1 Versión inicial
--##########################################
--*/


WHENEVER SQLERROR EXIT SQL.SQLCODE;
SET SERVEROUTPUT ON; 
SET DEFINE OFF;


DECLARE
    V_MSQL VARCHAR2(32000 CHAR); -- Sentencia a ejecutar     
    V_ESQUEMA VARCHAR2(25 CHAR):= '#ESQUEMA#'; -- Configuracion Esquema
    V_ESQUEMA_M VARCHAR2(25 CHAR):= '#ESQUEMA_MASTER#'; -- Configuracion Esquema Master
    V_SQL VARCHAR2(4000 CHAR); -- Vble. para consulta que valida la existencia de una tabla.
    V_NUM_TABLAS NUMBER(16); -- Vble. para validar la existencia de una tabla.   
    ERR_NUM NUMBER(25);  -- Vble. auxiliar para registrar errores en el script.
    ERR_MSG VARCHAR2(1024 CHAR); -- Vble. auxiliar para registrar errores en el script.
	
    V_TEXT1 VARCHAR2(2400 CHAR); -- Vble. auxiliar
    V_ENTIDAD_ID NUMBER(16);
    V_ID NUMBER(16);
    V_SEQ_GEH NUMBER(16);
	V_TIPO_ID NUMBER(16); --Vle para el id DD_TTR_TIPO_TRABAJO
    
    
    TYPE T_TIPO_DATA IS TABLE OF VARCHAR2(150);
    TYPE T_ARRAY_DATA IS TABLE OF T_TIPO_DATA;
    V_TIPO_DATA T_ARRAY_DATA := T_ARRAY_DATA(
    	--			ACT_ID	
    	T_TIPO_DATA('3726310','01/11/18'),
		T_TIPO_DATA('3744431','01/07/18'),
		T_TIPO_DATA('3744431','01/10/18'),
		T_TIPO_DATA('3792546','01/11/18'),
		T_TIPO_DATA('4519222','01/01/18'),
		T_TIPO_DATA('4519222','01/02/18'),
		T_TIPO_DATA('4519222','01/03/18'),
		T_TIPO_DATA('4519222','01/04/18'),
		T_TIPO_DATA('4519222','01/05/18'),
		T_TIPO_DATA('4519222','01/06/18'),
		T_TIPO_DATA('4519222','01/07/18'),
		T_TIPO_DATA('4519222','01/08/18'),
		T_TIPO_DATA('4519222','01/09/18'),
		T_TIPO_DATA('4519222','01/10/18'),
		T_TIPO_DATA('4519222','01/11/18'),
		T_TIPO_DATA('4621008','02/01/18'),
		T_TIPO_DATA('4621008','02/02/18'),
		T_TIPO_DATA('4621008','02/04/18'),
		T_TIPO_DATA('4621008','02/08/18'),
		T_TIPO_DATA('4621008','02/09/18'),
		T_TIPO_DATA('4790372','01/07/18'),
		T_TIPO_DATA('4790372','02/07/18'),
		T_TIPO_DATA('4902530','01/11/18'),
		T_TIPO_DATA('5146506','01/07/18'),
		T_TIPO_DATA('5171805','01/10/18'),
		T_TIPO_DATA('5171805','01/11/18'),
		T_TIPO_DATA('5275242','01/11/18'),
		T_TIPO_DATA('5429015','01/07/18'),
		T_TIPO_DATA('5550320','01/01/18'),
		T_TIPO_DATA('5550320','01/04/18'),
		T_TIPO_DATA('5882090','01/11/18'),
		T_TIPO_DATA('6109470','01/11/18'),
		T_TIPO_DATA('6130383','01/11/18'),
		T_TIPO_DATA('6399750','01/05/18'),
		T_TIPO_DATA('6550708','01/11/18'),
		T_TIPO_DATA('6593001','01/11/18'),
		T_TIPO_DATA('6628303','01/03/18'),
		T_TIPO_DATA('6628303','01/06/18'),
		T_TIPO_DATA('9100230','01/11/18'),
		T_TIPO_DATA('9119090','01/01/18'),
		T_TIPO_DATA('9119090','01/02/18'),
		T_TIPO_DATA('9119090','01/04/18'),
		T_TIPO_DATA('9119090','01/05/18'),
		T_TIPO_DATA('9119090','01/07/18'),
		T_TIPO_DATA('9119090','01/08/18'),
		T_TIPO_DATA('9154555','01/10/18'),
		T_TIPO_DATA('9159133','01/11/18'),
		T_TIPO_DATA('9167691','01/11/18'),
		T_TIPO_DATA('9214319','01/11/18'),
		T_TIPO_DATA('9241325','01/10/18'),
		T_TIPO_DATA('9264861','01/09/18'),
		T_TIPO_DATA('9264861','02/09/18'),
		T_TIPO_DATA('9766602','01/11/18'),
		T_TIPO_DATA('10040272','01/11/18'),
		T_TIPO_DATA('10046014','01/11/18'),
		T_TIPO_DATA('10600655','02/11/18'),
		T_TIPO_DATA('10602128','01/11/18'),
		T_TIPO_DATA('10683090','01/07/18'),
		T_TIPO_DATA('10683090','01/10/18'),
		T_TIPO_DATA('10742176','01/11/18'),
		T_TIPO_DATA('10956540','01/11/18'),
		T_TIPO_DATA('11156573','01/11/18'),
		T_TIPO_DATA('11156690','01/11/18'),
		T_TIPO_DATA('11231236','01/11/18'),
		T_TIPO_DATA('11459765','01/11/18'),
		T_TIPO_DATA('11498410','01/11/18'),
		T_TIPO_DATA('11705878','01/11/18'),
		T_TIPO_DATA('11919756','01/11/18'),
		T_TIPO_DATA('11972973','01/11/18'),
		T_TIPO_DATA('11985407','01/11/18'),
		T_TIPO_DATA('12075503','01/11/18'),
		T_TIPO_DATA('12075737','01/01/18'),
		T_TIPO_DATA('12075737','01/03/18'),
		T_TIPO_DATA('12075737','01/04/18'),
		T_TIPO_DATA('12075737','01/05/18'),
		T_TIPO_DATA('12075737','01/07/18'),
		T_TIPO_DATA('12075737','01/10/18'),
		T_TIPO_DATA('12119204','01/11/18'),
		T_TIPO_DATA('12492822','01/11/18'),
		T_TIPO_DATA('12575267','01/11/18'),
		T_TIPO_DATA('12578858','01/04/18'),
		T_TIPO_DATA('12578858','01/05/18'),
		T_TIPO_DATA('12578858','01/06/18'),
		T_TIPO_DATA('12578858','01/07/18'),
		T_TIPO_DATA('12578858','01/08/18'),
		T_TIPO_DATA('12685825','01/11/18'),
		T_TIPO_DATA('12885754','01/11/18'),
		T_TIPO_DATA('12888022','01/11/18'),
		T_TIPO_DATA('12897492','01/11/18'),
		T_TIPO_DATA('12915875','01/11/18'),
		T_TIPO_DATA('12943073','01/11/18'),
		T_TIPO_DATA('13005485','01/11/18'),
		T_TIPO_DATA('13135034','01/11/18'),
		T_TIPO_DATA('13154202','02/11/18'),
		T_TIPO_DATA('13200017','01/11/18'),
		T_TIPO_DATA('13227939','01/11/18'),
		T_TIPO_DATA('13229529','01/11/18'),
		T_TIPO_DATA('13272346','01/11/18'),
		T_TIPO_DATA('13272697','01/11/18'),
		T_TIPO_DATA('13432250','01/11/18'),
		T_TIPO_DATA('13455669','01/11/18'),
		T_TIPO_DATA('13652493','01/10/18'),
		T_TIPO_DATA('14146248','01/11/18'),
		T_TIPO_DATA('14203510','01/11/18'),
		T_TIPO_DATA('14203744','01/11/18'),
		T_TIPO_DATA('14222912','01/10/18'),
		T_TIPO_DATA('14708338','01/11/18'),
		T_TIPO_DATA('14872656','02/11/18'),
		T_TIPO_DATA('14890912','01/11/18'),
		T_TIPO_DATA('14930461','01/11/18'),
		T_TIPO_DATA('14978421','01/11/18'),
		T_TIPO_DATA('15411782','01/05/18'),
		T_TIPO_DATA('15411782','01/06/18'),
		T_TIPO_DATA('15411782','01/08/18'),
		T_TIPO_DATA('15411782','01/09/18'),
		T_TIPO_DATA('15421579','01/11/18'),
		T_TIPO_DATA('15456754','01/11/18'),
		T_TIPO_DATA('15497457','01/11/18'),
		T_TIPO_DATA('15529285','01/11/18'),
		T_TIPO_DATA('15529303','01/11/18'),
		T_TIPO_DATA('15608334','01/11/18'),
		T_TIPO_DATA('15615026','01/11/18'),
		T_TIPO_DATA('15746324','01/11/18'),
		T_TIPO_DATA('15787144','01/11/18'),
		T_TIPO_DATA('15791451','01/11/18'),
		T_TIPO_DATA('15889360','01/11/18'),
		T_TIPO_DATA('15914318','01/08/18'),
		T_TIPO_DATA('16020090','01/11/18'),
		T_TIPO_DATA('16383405','01/11/18'),
		T_TIPO_DATA('16566242','01/11/18'),
		T_TIPO_DATA('17613843','01/02/18'),
		T_TIPO_DATA('17613843','01/05/18'),
		T_TIPO_DATA('17613843','01/08/18'),
		T_TIPO_DATA('17613843','01/09/18'),
		T_TIPO_DATA('17613843','01/11/18'),
		T_TIPO_DATA('18561603','01/11/18'),
		T_TIPO_DATA('18600123','01/11/18'),
		T_TIPO_DATA('18608760','01/11/18'),
		T_TIPO_DATA('18615218','01/11/18'),
		T_TIPO_DATA('18623776','01/01/18'),
		T_TIPO_DATA('18623776','01/02/18'),
		T_TIPO_DATA('18623776','01/04/18'),
		T_TIPO_DATA('18623776','01/07/18'),
		T_TIPO_DATA('18623776','01/08/18'),
		T_TIPO_DATA('18623776','01/09/18'),
		T_TIPO_DATA('18623776','01/10/18'),
		T_TIPO_DATA('18623776','01/11/18'),
		T_TIPO_DATA('18638403','01/11/18'),
		T_TIPO_DATA('18638403','01/11/18'),
		T_TIPO_DATA('18640517','01/11/18'),
		T_TIPO_DATA('18697578','01/04/18'),
		T_TIPO_DATA('18697578','01/07/18'),
		T_TIPO_DATA('19057164','01/11/18'),
		T_TIPO_DATA('19086597','01/11/18'),
		T_TIPO_DATA('19153422','01/11/18'),
		T_TIPO_DATA('19304072','01/09/18'),
		T_TIPO_DATA('19304324','01/11/18'),
		T_TIPO_DATA('19344115','01/11/18'),
		T_TIPO_DATA('19404698','01/11/18'),
		T_TIPO_DATA('19429725','01/01/18'),
		T_TIPO_DATA('19429725','01/07/18'),
		T_TIPO_DATA('19429725','01/10/18'),
		T_TIPO_DATA('19593206','01/11/18'),
		T_TIPO_DATA('19604879','01/11/18'),
		T_TIPO_DATA('19627344','01/11/18'),
		T_TIPO_DATA('19718131','01/11/18'),
		T_TIPO_DATA('19729677','01/07/18'),
		T_TIPO_DATA('20277465','01/11/18'),
		T_TIPO_DATA('20304616','01/10/18'),
		T_TIPO_DATA('20304616','01/11/18'),
		T_TIPO_DATA('20418570','01/11/18'),
		T_TIPO_DATA('20485133','01/10/18'),
		T_TIPO_DATA('20485970','01/11/18'),
		T_TIPO_DATA('20669854','01/11/18'),
		T_TIPO_DATA('20728220','01/02/18'),
		T_TIPO_DATA('20748165','01/05/18'),
		T_TIPO_DATA('20748165','01/08/18'),
		T_TIPO_DATA('20748165','01/11/18'),
		T_TIPO_DATA('20825858','01/11/18'),
		T_TIPO_DATA('20828477','01/11/18'),
		T_TIPO_DATA('20885846','01/11/18'),
		T_TIPO_DATA('20974440','01/11/18'),
		T_TIPO_DATA('20975469','01/11/18'),
		T_TIPO_DATA('20987693','01/11/18'),
		T_TIPO_DATA('21268014','01/09/18'),
		T_TIPO_DATA('21379835','01/11/18'),
		T_TIPO_DATA('21963516','01/11/18'),
		T_TIPO_DATA('21968076','01/11/18'),
		T_TIPO_DATA('21995217','01/11/18'),
		T_TIPO_DATA('22001948','01/11/18'),
		T_TIPO_DATA('22006877','01/11/18'),
		T_TIPO_DATA('22018498','01/11/18'),
		T_TIPO_DATA('22018498','01/11/18'),
		T_TIPO_DATA('22041973','01/11/18'),
		T_TIPO_DATA('22052565','01/11/18'),
		T_TIPO_DATA('22060772','01/11/18'),
		T_TIPO_DATA('22068689','01/11/18'),
		T_TIPO_DATA('22069853','01/11/18'),
		T_TIPO_DATA('22074721','01/11/18'),
		T_TIPO_DATA('22145311','01/11/18'),
		T_TIPO_DATA('22153032','01/11/18'),
		T_TIPO_DATA('22211557','01/11/18'),
		T_TIPO_DATA('22294478','01/01/18'),
		T_TIPO_DATA('24164985','01/07/18'),
		T_TIPO_DATA('24754642','01/11/18'),
		T_TIPO_DATA('24842558','01/11/18'),
		T_TIPO_DATA('26172042','01/11/18'),
		T_TIPO_DATA('26530420','01/11/18'),
		T_TIPO_DATA('27149927','01/11/18'),
		T_TIPO_DATA('27149927','01/11/18'),
		T_TIPO_DATA('28543243','01/11/18'),
		T_TIPO_DATA('28589847','02/11/18'),
		T_TIPO_DATA('28692662','01/11/18'),
		T_TIPO_DATA('28841488','01/11/18'),
		T_TIPO_DATA('28872412','01/04/18'),
		T_TIPO_DATA('28872412','01/07/18'),
		T_TIPO_DATA('28932878','01/11/18'),
		T_TIPO_DATA('29229323','01/11/18'),
		T_TIPO_DATA('29310837','01/05/18'),
		T_TIPO_DATA('29310837','01/11/18'),
		T_TIPO_DATA('29839762','01/11/18'),
		T_TIPO_DATA('30162243','01/02/18'),
		T_TIPO_DATA('30162243','01/05/18'),
		T_TIPO_DATA('30162243','01/11/18'),
		T_TIPO_DATA('31098326','01/11/18'),
		T_TIPO_DATA('31183623','01/04/18'),
		T_TIPO_DATA('31183623','01/06/18'),
		T_TIPO_DATA('31183623','01/08/18'),
		T_TIPO_DATA('31183623','01/09/18'),
		T_TIPO_DATA('31183623','01/10/18'),
		T_TIPO_DATA('31183623','01/11/18'),
		T_TIPO_DATA('31183623','01/11/18'),
		T_TIPO_DATA('31188318','01/01/18'),
		T_TIPO_DATA('31188318','01/02/18'),
		T_TIPO_DATA('31188318','01/07/18'),
		T_TIPO_DATA('31188318','01/09/18'),
		T_TIPO_DATA('31267097','01/06/18'),
		T_TIPO_DATA('31384950','01/11/18'),
		T_TIPO_DATA('31410937','01/01/18'),
		T_TIPO_DATA('31410937','02/01/18'),
		T_TIPO_DATA('31410937','01/07/18'),
		T_TIPO_DATA('31410937','01/10/18'),
		T_TIPO_DATA('31410937','02/10/18'),
		T_TIPO_DATA('32344341','01/11/18'),
		T_TIPO_DATA('32344458','01/11/18'),
		T_TIPO_DATA('32344692','01/11/18'),
		T_TIPO_DATA('32352917','01/07/18'),
		T_TIPO_DATA('32358875','01/06/18'),
		T_TIPO_DATA('32358875','01/08/18'),
		T_TIPO_DATA('32359067','01/06/18'),
		T_TIPO_DATA('32359067','01/08/18'),
		T_TIPO_DATA('32359067','01/08/18'),
		T_TIPO_DATA('32359184','01/08/18'),
		T_TIPO_DATA('32359184','01/08/18'),
		T_TIPO_DATA('32359184','01/09/18'),
		T_TIPO_DATA('32359319','01/11/18'),
		T_TIPO_DATA('32359436','01/08/18'),
		T_TIPO_DATA('32387957','01/08/18'),
		T_TIPO_DATA('32387957','01/09/18'),
		T_TIPO_DATA('32400187','01/09/18'),
		T_TIPO_DATA('32400205','01/09/18'),
		T_TIPO_DATA('32400556','01/09/18'),
		T_TIPO_DATA('32403778','01/01/18'),
		T_TIPO_DATA('32410470','01/10/18'),
		T_TIPO_DATA('32419551','01/11/18'),
		T_TIPO_DATA('32419785','01/11/18'),
		T_TIPO_DATA('32419803','01/11/18'),
		T_TIPO_DATA('32423255','01/02/18'),
		T_TIPO_DATA('32423255','01/05/18'),
		T_TIPO_DATA('32423255','01/08/18'),
		T_TIPO_DATA('32423372','01/03/18'),
		T_TIPO_DATA('32423372','01/08/18'),
		T_TIPO_DATA('32423372','01/09/18'),
		T_TIPO_DATA('32436760','01/01/18'),
		T_TIPO_DATA('32436760','01/04/18'),
		T_TIPO_DATA('32436760','01/05/18'),
		T_TIPO_DATA('32436760','01/07/18'),
		T_TIPO_DATA('32436760','01/09/18'),
		T_TIPO_DATA('32436760','01/10/18'),
		T_TIPO_DATA('32453501','01/11/18'),
		T_TIPO_DATA('32453501','02/11/18'),
		T_TIPO_DATA('32465959','01/11/18'),
		T_TIPO_DATA('32470089','01/01/18'),
		T_TIPO_DATA('32470089','01/06/18'),
		T_TIPO_DATA('32470089','01/07/18'),
		T_TIPO_DATA('32470089','01/10/18'),
		T_TIPO_DATA('32470224','01/04/18'),
		T_TIPO_DATA('32470224','01/07/18'),
		T_TIPO_DATA('32470224','01/10/18'),
		T_TIPO_DATA('32502538','01/08/18'),
		T_TIPO_DATA('33245249','01/07/18'),
		T_TIPO_DATA('33245249','01/10/18'),
		T_TIPO_DATA('33245483','01/07/18'),
		T_TIPO_DATA('33365352','01/08/18'),
		T_TIPO_DATA('33365352','01/09/18'),
		T_TIPO_DATA('33492633','01/11/18'),
		T_TIPO_DATA('33492867','01/11/18'),
		T_TIPO_DATA('33492984','01/11/18'),
		T_TIPO_DATA('33493428','01/11/18'),
		T_TIPO_DATA('33493662','01/11/18'),
		T_TIPO_DATA('33503955','01/11/18'),
		T_TIPO_DATA('33528361','01/03/18'),
		T_TIPO_DATA('33533346','01/01/18'),
		T_TIPO_DATA('33533346','01/03/18'),
		T_TIPO_DATA('33533346','01/08/18'),
		T_TIPO_DATA('33558238','01/11/18'),
		T_TIPO_DATA('33558589','01/11/18'),
		T_TIPO_DATA('33570752','01/11/18'),
		T_TIPO_DATA('33570752','01/11/18'),
		T_TIPO_DATA('33579716','01/10/18'),
		T_TIPO_DATA('33584818','01/08/18'),
		T_TIPO_DATA('33584818','01/09/18'),
		T_TIPO_DATA('33586642','01/07/18'),
		T_TIPO_DATA('33611582','01/10/18'),
		T_TIPO_DATA('33611834','01/10/18'),
		T_TIPO_DATA('33611951','01/10/18'),
		T_TIPO_DATA('33628870','01/11/18'),
		T_TIPO_DATA('33629179','01/01/18'),
		T_TIPO_DATA('33629179','01/02/18'),
		T_TIPO_DATA('33629179','01/03/18'),
		T_TIPO_DATA('33629179','01/04/18'),
		T_TIPO_DATA('33629179','01/06/18'),
		T_TIPO_DATA('33629179','01/07/18'),
		T_TIPO_DATA('33629179','01/08/18'),
		T_TIPO_DATA('33629179','01/10/18'),
		T_TIPO_DATA('33629179','01/11/18'),
		T_TIPO_DATA('33638064','01/09/18'),
		T_TIPO_DATA('33638064','01/09/18'),
		T_TIPO_DATA('33654010','01/04/18'),
		T_TIPO_DATA('33654010','01/07/18'),
		T_TIPO_DATA('33656320','01/01/18'),
		T_TIPO_DATA('33656320','01/02/18'),
		T_TIPO_DATA('33656320','01/03/18'),
		T_TIPO_DATA('33656320','01/04/18'),
		T_TIPO_DATA('33656320','01/05/18'),
		T_TIPO_DATA('33656320','01/07/18'),
		T_TIPO_DATA('33656320','01/08/18'),
		T_TIPO_DATA('33656320','01/09/18'),
		T_TIPO_DATA('33656320','01/10/18'),
		T_TIPO_DATA('33656320','01/11/18'),
		T_TIPO_DATA('33659659','01/08/18'),
		T_TIPO_DATA('33659659','01/09/18'),
		T_TIPO_DATA('33669708','02/04/18'),
		T_TIPO_DATA('33669708','01/05/18'),
		T_TIPO_DATA('33669708','01/08/18'),
		T_TIPO_DATA('33669708','01/11/18'),
		T_TIPO_DATA('33670172','01/02/18'),
		T_TIPO_DATA('33670172','01/08/18'),
		T_TIPO_DATA('33670172','01/11/18'),
		T_TIPO_DATA('33670289','01/01/18'),
		T_TIPO_DATA('33670289','01/08/18'),
		T_TIPO_DATA('33670892','01/11/18'),
		T_TIPO_DATA('33692562','01/01/18'),
		T_TIPO_DATA('33692562','01/02/18'),
		T_TIPO_DATA('33692562','01/08/18'),
		T_TIPO_DATA('33692562','01/09/18'),
		T_TIPO_DATA('33702252','01/01/18'),
		T_TIPO_DATA('33702252','01/02/18'),
		T_TIPO_DATA('33702252','01/03/18'),
		T_TIPO_DATA('33702252','01/03/18'),
		T_TIPO_DATA('33702252','01/04/18'),
		T_TIPO_DATA('33702252','01/05/18'),
		T_TIPO_DATA('33702252','01/06/18'),
		T_TIPO_DATA('33702252','01/06/18'),
		T_TIPO_DATA('33702252','01/07/18'),
		T_TIPO_DATA('33702252','01/08/18'),
		T_TIPO_DATA('33702252','01/08/18'),
		T_TIPO_DATA('33702252','01/09/18'),
		T_TIPO_DATA('33702252','01/09/18'),
		T_TIPO_DATA('33702252','01/10/18'),
		T_TIPO_DATA('33702252','01/10/18'),
		T_TIPO_DATA('33702252','01/11/18'),
		T_TIPO_DATA('33704796','01/11/18'),
		T_TIPO_DATA('33715523','01/11/18'),
		T_TIPO_DATA('33717347','01/09/18'),
		T_TIPO_DATA('33720508','01/03/18'),
		T_TIPO_DATA('33720508','01/06/18'),
		T_TIPO_DATA('33720508','01/09/18'),
		T_TIPO_DATA('33731820','01/11/18'),
		T_TIPO_DATA('33784630','01/11/18'),
		T_TIPO_DATA('33884536','01/09/18')
	); 
    V_TMP_TIPO_DATA T_TIPO_DATA;
    
BEGIN	
	
	DBMS_OUTPUT.PUT_LINE('[INICIO] ');

	 
    -- LOOP para updatear los valores en GPV_GASTOS_PROVEEDOR -----------------------------------------------------------------
    DBMS_OUTPUT.PUT_LINE('[INFO]: UPDATE EN GPV_GASTOS_PROVEEDOR] ');
    FOR I IN V_TIPO_DATA.FIRST .. V_TIPO_DATA.LAST
      LOOP
      
        V_TMP_TIPO_DATA := V_TIPO_DATA(I);
    
        --Comprobamos el dato a updatear
        V_SQL := 'SELECT COUNT(1)
					FROM '||V_ESQUEMA||'.GPV_GASTOS_PROVEEDOR GPV
					INNER JOIN '||V_ESQUEMA||'.PRG_PROVISION_GASTOS PRG ON PRG.PRG_ID = GPV.PRG_ID
					INNER JOIN '||V_ESQUEMA||'.GPV_ACT GPV_ACT ON GPV_ACT.GPV_ID = GPV.GPV_ID
					INNER JOIN '||V_ESQUEMA||'.ACT_ACTIVO ACT ON ACT.ACT_ID = GPV_ACT.ACT_ID
					WHERE PRG.PRG_NUM_PROVISION = 181221728
					AND ACT.ACT_NUM_ACTIVO_UVEM = '''|| TRIM(V_TMP_TIPO_DATA(1)) ||'''
					AND TO_DATE(GPV.GPV_FECHA_EMISION, ''DD/MM/YY'') = TO_DATE('''|| TRIM(V_TMP_TIPO_DATA(2)) ||''', ''DD/MM/YY'')';
        EXECUTE IMMEDIATE V_SQL INTO V_NUM_TABLAS;
        
        --Si existe realizamos otra comprobacion
        IF V_NUM_TABLAS > 0 THEN		

			DBMS_OUTPUT.PUT_LINE('[INFO]: MODIFICAMOS EL USUARIO BORRAR DEL GASTO PARA MARCARLO  '''|| TRIM(V_TMP_TIPO_DATA(1)) ||''' ');
			V_MSQL := 'UPDATE '||V_ESQUEMA||'.GPV_GASTOS_PROVEEDOR GPV
						SET USUARIOBORRAR = ''REMVIP-2918''
						WHERE GPV.GPV_ID IN
							(
							SELECT GPV1.GPV_ID
							FROM '||V_ESQUEMA||'.GPV_GASTOS_PROVEEDOR GPV1
							INNER JOIN '||V_ESQUEMA||'.PRG_PROVISION_GASTOS PRG ON PRG.PRG_ID = GPV1.PRG_ID
							INNER JOIN '||V_ESQUEMA||'.GPV_ACT GPV_ACT ON GPV_ACT.GPV_ID = GPV1.GPV_ID
							INNER JOIN '||V_ESQUEMA||'.ACT_ACTIVO ACT ON ACT.ACT_ID = GPV_ACT.ACT_ID
							WHERE PRG.PRG_NUM_PROVISION = 181221728
							AND ACT.ACT_NUM_ACTIVO_UVEM = '''|| TRIM(V_TMP_TIPO_DATA(1)) ||'''
							AND TO_DATE(GPV1.GPV_FECHA_EMISION, ''DD/MM/YY'') = TO_DATE('''|| TRIM(V_TMP_TIPO_DATA(2)) ||''', ''DD/MM/YY'')
							)';
			EXECUTE IMMEDIATE V_MSQL;		
			DBMS_OUTPUT.PUT_LINE('[INFO]: GASTO MARCADO CORRECTAMENTE '''|| TRIM(V_TMP_TIPO_DATA(1)) ||''', '''|| TRIM(V_TMP_TIPO_DATA(2)) ||'''');
			
		ELSE
			  DBMS_OUTPUT.PUT_LINE('[INFO]: EL GASTO NO EXISTE');
		END IF;
		
    END LOOP;
    
    DBMS_OUTPUT.PUT_LINE('[INFO]: QUITAMOS LA FECHA DE ENVIO A PROPIETARIO DE LOS GASTOS');
			V_MSQL := 'UPDATE '||V_ESQUEMA||'.GGE_GASTOS_GESTION GGE
						SET
						GGE.GGE_FECHA_ENVIO_PRPTRIO = NULL,
						GGE.USUARIOMODIFICAR = ''REMVIP-2918'',
						GGE.FECHAMODIFICAR = SYSDATE
						WHERE EXISTS (
							SELECT 1
							FROM '||V_ESQUEMA||'.GPV_GASTOS_PROVEEDOR GPV1
							INNER JOIN '||V_ESQUEMA||'.PRG_PROVISION_GASTOS PRG ON PRG.PRG_ID = GPV1.PRG_ID
							WHERE PRG.PRG_NUM_PROVISION = 181221728
							AND GPV1.USUARIOBORRAR IS NULL
							AND GGE.GPV_ID = GPV1.GPV_ID)';
	EXECUTE IMMEDIATE V_MSQL;		
	DBMS_OUTPUT.PUT_LINE('[INFO]: FECHA DE ENVIO A PROPIETARIO  ELIMINADA PARA '||SQL%ROWCOUNT||' GASTOS');
    
    DBMS_OUTPUT.PUT_LINE('[INFO]: SACAMOS LOS GASTOS DE LA PROVISION Y CAMBIAMOS SU ESTADO');
			V_MSQL := 'UPDATE '||V_ESQUEMA||'.GPV_GASTOS_PROVEEDOR GPV
						SET
						GPV.PRG_ID = NULL,
						GPV.DD_EGA_ID = (SELECT DD_EGA_ID FROM '||V_ESQUEMA||'.DD_EGA_ESTADOS_GASTO WHERE DD_EGA_CODIGO = ''01''),
						GPV.USUARIOMODIFICAR = ''REMVIP-2918'',
						GPV.FECHAMODIFICAR = SYSDATE
						WHERE EXISTS (
							SELECT 1
							FROM '||V_ESQUEMA||'.GPV_GASTOS_PROVEEDOR GPV1
							INNER JOIN '||V_ESQUEMA||'.PRG_PROVISION_GASTOS PRG ON PRG.PRG_ID = GPV1.PRG_ID
							WHERE PRG.PRG_NUM_PROVISION = 181221728
							AND GPV1.USUARIOBORRAR IS NULL
							AND GPV.GPV_ID = GPV1.GPV_ID)';
	EXECUTE IMMEDIATE V_MSQL;		
	DBMS_OUTPUT.PUT_LINE('[INFO]: GASTOS SACADOS DE PROVISION Y MARCADOS COMO PENDIENTES DE AUTORIZAR: '||SQL%ROWCOUNT||'');
    
    DBMS_OUTPUT.PUT_LINE('[INFO]: MODIFICAMOS EL USUARIO BORRAR DEL LOS GASTOS PARA DESMARCARLOS');
	V_MSQL := 'UPDATE '||V_ESQUEMA||'.GPV_GASTOS_PROVEEDOR GPV
	   		   SET USUARIOBORRAR = NULL 
			   WHERE USUARIOBORRAR = ''REMVIP-2918''';
	EXECUTE IMMEDIATE V_MSQL;
	DBMS_OUTPUT.PUT_LINE('[INFO]: GASTOS DESMARCADOS CORRECTAMENTE: '||SQL%ROWCOUNT||'');
    
    COMMIT;
    DBMS_OUTPUT.PUT_LINE('[FIN]: TABLA '||V_ESQUEMA||'.GPV_GASTOS_PROVEEDOR ACTUALIZADA CORRECTAMENTE');   

EXCEPTION
     WHEN OTHERS THEN
          err_num := SQLCODE;
          err_msg := SQLERRM;

          DBMS_OUTPUT.put_line('[ERROR] Se ha producido un error en la ejecución:'||TO_CHAR(err_num));
          DBMS_OUTPUT.put_line('-----------------------------------------------------------'); 
          DBMS_OUTPUT.put_line(err_msg);

          ROLLBACK;
          RAISE;          

END;

/

EXIT


