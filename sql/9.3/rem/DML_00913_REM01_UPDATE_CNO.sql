--/*
--##########################################
--## AUTOR=Vicente Martinez Cifre
--## FECHA_CREACION=20210924
--## ARTEFACTO=online
--## VERSION_ARTEFACTO=9.2
--## INCIDENCIA_LINK=HREOS-15311
--## PRODUCTO=NO
--##
--## Finalidad: Script que añade los datos del array en DD_CNO_CN_OCUPACIONAL
--## INSTRUCCIONES:
--## VERSIONES:
--##        0.1 Versión inicial
--##########################################
--*/


WHENEVER SQLERROR EXIT SQL.SQLCODE;
SET SERVEROUTPUT ON; 
SET DEFINE OFF;

DECLARE
    V_MSQL VARCHAR2(32000 CHAR); -- Sentencia a ejecutar     
    V_ESQUEMA VARCHAR2(25 CHAR):= '#ESQUEMA#'; -- Configuracion Esquema
    V_ESQUEMA_M VARCHAR2(25 CHAR):= '#ESQUEMA_MASTER#'; -- Configuracion Esquema Master
    V_SQL VARCHAR2(4000 CHAR); -- Vble. para consulta que valida la existencia de una tabla.
    V_NUM_TABLAS NUMBER(16); -- Vble. para validar la existencia de una tabla.   
    ERR_NUM NUMBER(25);  -- Vble. auxiliar para registrar errores en el script.
    ERR_MSG VARCHAR2(1024 CHAR); -- Vble. auxiliar para registrar errores en el script.
	
    V_ID NUMBER(16);
    V_TABLA VARCHAR2(50 CHAR):= 'DD_CNO_CN_OCUPACIONAL';
    V_CHARS VARCHAR2(3 CHAR):= 'CNO';
    V_USUARIO VARCHAR2(25 CHAR):= 'HREOS-15311';
    TYPE T_TIPO_DATA IS TABLE OF VARCHAR2(150);
    TYPE T_ARRAY_DATA IS TABLE OF T_TIPO_DATA;
    V_TIPO_DATA T_ARRAY_DATA := T_ARRAY_DATA(
            -- CODIGO  			DESCRIPCION     DESCRIPCION_LARGA   OCULTAR
      T_TIPO_DATA('1113', 'Directores de organizaciones de interés social'),
      T_TIPO_DATA('1429', 'Directores y gerentes de empresas de catering y otras empresas de restauración'),
      T_TIPO_DATA('1501', 'Directores y gerentes de empresas de actividades recreativas, culturales y deportivas'),
      T_TIPO_DATA('1509', 'Directores y gerentes de empresas de gestión de residuos y de otras empresas de servicios no clasificados bajo otros epígrafes'),
      T_TIPO_DATA('2130', 'Veterinarios'),
      T_TIPO_DATA('2140', 'Farmacéuticos'),
      T_TIPO_DATA('2151', 'Odontólogos y estomatólogos'),
      T_TIPO_DATA('2152', 'Fisioterapeutas'),
      T_TIPO_DATA('2153', 'Dietistas y nutricionistas'),
      T_TIPO_DATA('2154', 'Logopedas'),
      T_TIPO_DATA('2155', 'Ópticos-optometristas'),
      T_TIPO_DATA('2156', 'Terapeutas ocupacionales'),
      T_TIPO_DATA('2157', 'Podólogos'),
      T_TIPO_DATA('2158', 'Profesionales de la salud y la higiene laboral y ambiental'),
      T_TIPO_DATA('2159', 'Profesionales de la salud no clasificados bajo otros epígrafes'),
      T_TIPO_DATA('2210', 'Profesores de universidades y otra enseñanza superior (excepto formación profesional)'),
      T_TIPO_DATA('2411', 'Físicos y astrónomos'),
      T_TIPO_DATA('2412', 'Meteorólogos'),
      T_TIPO_DATA('2413', 'Químicos'),
      T_TIPO_DATA('2414', 'Geólogos y geofísicos'),
      T_TIPO_DATA('2415', 'Matemáticos y actuarios'),
      T_TIPO_DATA('2416', 'Estadísticos'),
      T_TIPO_DATA('2421', 'Biólogos, botánicos, zoólogos y afines'),
      T_TIPO_DATA('2422', 'Ingenieros agrónomos'),
      T_TIPO_DATA('2423', 'Ingenieros de montes'),
      T_TIPO_DATA('2424', 'Ingenieros técnicos agrícolas'),
      T_TIPO_DATA('2425', 'Ingenieros técnicos forestales y del medio natural'),
      T_TIPO_DATA('2426', 'Profesionales de la protección ambiental'),
      T_TIPO_DATA('2427', 'Enólogos'),
      T_TIPO_DATA('2431', 'Ingenieros industriales y de producción'),
      T_TIPO_DATA('2432', 'Ingenieros en construcción y obra civil'),
      T_TIPO_DATA('2433', 'Ingenieros mecánicos'),
      T_TIPO_DATA('2434', 'Ingenieros aeronáuticos'),
      T_TIPO_DATA('2435', 'Ingenieros químicos'),
      T_TIPO_DATA('2436', 'Ingenieros de minas, metalúrgicos y afines'),
      T_TIPO_DATA('2437', 'Ingenieros ambientales'),
      T_TIPO_DATA('2439', 'Ingenieros no clasificados bajo otros epígrafes'),
      T_TIPO_DATA('2441', 'Ingenieros en electricidad'),
      T_TIPO_DATA('2442', 'Ingenieros electrónicos'),
      T_TIPO_DATA('2443', 'Ingenieros en telecomunicaciones'),
      T_TIPO_DATA('2451', 'Arquitectos (excepto arquitectos paisajistas y urbanistas)'),
      T_TIPO_DATA('2452', 'Arquitectos paisajistas'),
      T_TIPO_DATA('2453', 'Urbanistas e ingenieros de tráfico'),
      T_TIPO_DATA('2454', 'Ingenieros geógrafos y cartógrafos'),
      T_TIPO_DATA('2461', 'Ingenieros técnicos industriales y de producción'),
      T_TIPO_DATA('2462', 'Ingenieros técnicos de obras públicas'),
      T_TIPO_DATA('2463', 'Ingenieros técnicos mecánicos'),
      T_TIPO_DATA('2464', 'Ingenieros técnicos aeronáuticos'),
      T_TIPO_DATA('2465', 'Ingenieros técnicos químicos'),
      T_TIPO_DATA('2466', 'Ingenieros técnicos de minas, metalúrgicos y afines'),
      T_TIPO_DATA('2469', 'Ingenieros técnicos no clasificados bajo otros epígrafes'),
      T_TIPO_DATA('2471', 'Ingenieros técnicos en electricidad'),
      T_TIPO_DATA('2472', 'Ingenieros técnicos en electrónica'),
      T_TIPO_DATA('2473', 'Ingenieros técnicos en telecomunicaciones'),
      T_TIPO_DATA('2481', 'Arquitectos técnicos y técnicos urbanistas'),
      T_TIPO_DATA('2482', 'Diseñadores de productos y de prendas'),
      T_TIPO_DATA('2483', 'Ingenieros técnicos en topografía'),
      T_TIPO_DATA('2484', 'Diseñadores gráficos y multimedia'),
      T_TIPO_DATA('2511', 'Abogados'),
      T_TIPO_DATA('2512', 'Fiscales'),
      T_TIPO_DATA('2513', 'Jueces y magistrados'),
      T_TIPO_DATA('2591', 'Notarios y registradores'),
      T_TIPO_DATA('2592', 'Procuradores'),
      T_TIPO_DATA('2599', 'Profesionales del derecho no clasificados bajo otros epígrafes'),
      T_TIPO_DATA('2611', 'Especialistas en contabilidad'),
      T_TIPO_DATA('2612', 'Asesores financieros y en inversiones'),
      T_TIPO_DATA('2613', 'Analistas financieros'),
      T_TIPO_DATA('2621', 'Analistas de gestión y organización'),
      T_TIPO_DATA('2622', 'Especialistas en administración de política de empresas'),
      T_TIPO_DATA('2623', 'Especialistas de la Administración Pública'),
      T_TIPO_DATA('2624', 'Especialistas en políticas y servicios de personal y afines'),
      T_TIPO_DATA('2625', 'Especialistas en formación de personal'),
      T_TIPO_DATA('2630', 'Técnicos de empresas y actividades turísticas'),
      T_TIPO_DATA('2640', 'Profesionales de ventas técnicas y médicas (excepto las TIC)'),
      T_TIPO_DATA('2651', 'Profesionales de la publicidad y la comercialización'),
      T_TIPO_DATA('2652', 'Profesionales de relaciones públicas'),
      T_TIPO_DATA('2653', 'Profesionales de la venta de tecnologías de la información y las comunicaciones'),
      T_TIPO_DATA('2711', 'Analistas de sistemas'),
      T_TIPO_DATA('2712', 'Analistas y diseñadores de software'),
      T_TIPO_DATA('2713', 'Analistas, programadores y diseñadores Web y multimedia'),
      T_TIPO_DATA('2719', 'Analistas y diseñadores de software y multimedia no clasificados bajo otros epígrafes'),
      T_TIPO_DATA('2721', 'Diseñadores y administradores de bases de datos'),
      T_TIPO_DATA('2722', 'Administradores de sistemas y redes'),
      T_TIPO_DATA('2723', 'Analistas de redes informáticas'),
      T_TIPO_DATA('2729', 'Especialistas en bases de datos y en redes informáticas no clasificados bajo otros epígrafes'),
      T_TIPO_DATA('2810', 'Economistas'),
      T_TIPO_DATA('2821', 'Sociólogos, geógrafos, antropólogos, arqueólogos y afines'),
      T_TIPO_DATA('2822', 'Filósofos, historiadores y profesionales en ciencias políticas'),
      T_TIPO_DATA('2823', 'Psicólogos'),
      T_TIPO_DATA('2824', 'Profesionales del trabajo y la educación social'),
      T_TIPO_DATA('2825', 'Agentes de igualdad de oportunidades entre mujeres y hombres'),
      T_TIPO_DATA('2830', 'Sacerdotes de las distintas religiones'),
      T_TIPO_DATA('2911', 'Archivistas y conservadores de museos'),
      T_TIPO_DATA('2912', 'Bibliotecarios, documentalistas y afines'),
      T_TIPO_DATA('2921', 'Escritores'),
      T_TIPO_DATA('2922', 'Periodistas'),
      T_TIPO_DATA('2923', 'Filólogos, intérpretes y traductores'),
      T_TIPO_DATA('2931', 'Artistas de artes plásticas y visuales'),
      T_TIPO_DATA('2932', 'Compositores, músicos y cantantes'),
      T_TIPO_DATA('2933', 'Coreógrafos y bailarines'),
      T_TIPO_DATA('2934', 'Directores de cine, de teatro y afines'),
      T_TIPO_DATA('2935', 'Actores'),
      T_TIPO_DATA('2936', 'Locutores de radio, televisión y otros presentadores'),
      T_TIPO_DATA('2937', 'Profesionales de espectáculos taurinos'),
      T_TIPO_DATA('2939', 'Artistas creativos e interpretativos no clasificados bajo otros epígrafes'),
      T_TIPO_DATA('3110', 'Delineantes y dibujantes técnicos'),
      T_TIPO_DATA('3121', 'Técnicos en ciencias físicas y químicas'),
      T_TIPO_DATA('3122', 'Técnicos en construcción'),
      T_TIPO_DATA('3123', 'Técnicos en electricidad'),
      T_TIPO_DATA('3124', 'Técnicos en electrónica (excepto electromedicina)'),
      T_TIPO_DATA('3125', 'Técnicos en electrónica, especialidad en electromedicina'),
      T_TIPO_DATA('3126', 'Técnicos en mecánica'),
      T_TIPO_DATA('3127', 'Técnicos y analistas de laboratorio en química industrial'),
      T_TIPO_DATA('3128', 'Técnicos en metalurgia y minas'),
      T_TIPO_DATA('3129', 'Otros técnicos de las ciencias físicas, químicas, medioambientales y de las ingenierías'),
      T_TIPO_DATA('3131', 'Técnicos en instalaciones de producción de energía'),
      T_TIPO_DATA('3132', 'Técnicos en instalaciones de tratamiento de residuos, de aguas y otros operadores en plantas similares'),
      T_TIPO_DATA('3133', 'Técnicos en control de instalaciones de procesamiento de productos químicos'),
      T_TIPO_DATA('3134', 'Técnicos de refinerías de petróleo y gas natural'),
      T_TIPO_DATA('3135', 'Técnicos en control de procesos de producción de metales'),
      T_TIPO_DATA('3139', 'Técnicos en control de procesos no clasificados bajo otros epígrafes'),
      T_TIPO_DATA('3141', 'Técnicos en ciencias biológicas (excepto en áreas sanitarias)'),
      T_TIPO_DATA('3142', 'Técnicos agropecuarios'),
      T_TIPO_DATA('3143', 'Técnicos forestales y del medio natural'),
      T_TIPO_DATA('3151', 'Jefes y oficiales de máquinas'),
      T_TIPO_DATA('3152', 'Capitanes y oficiales de puente'),
      T_TIPO_DATA('3153', 'Pilotos de aviación y profesionales afines'),
      T_TIPO_DATA('3154', 'Controladores de tráfico aéreo'),
      T_TIPO_DATA('3155', 'Técnicos en seguridad aeronáutica'),
      T_TIPO_DATA('3160', 'Técnicos de control de calidad de las ciencias físicas, químicas y de las ingenierías'),
      T_TIPO_DATA('3201', 'Supervisores en ingeniería de minas'),
      T_TIPO_DATA('3202', 'Supervisores de la construcción'),
      T_TIPO_DATA('3203', 'Supervisores de industrias alimenticias y del tabaco'),
      T_TIPO_DATA('3204', 'Supervisores de industrias química y farmacéutica'),
      T_TIPO_DATA('3205', 'Supervisores de industrias de transformación de plásticos, caucho y resinas naturales'),
      T_TIPO_DATA('3206', 'Supervisores de industrias de la madera y pastero papeleras'),
      T_TIPO_DATA('3207', 'Supervisores de la producción en industrias de artes gráficas y en la fabricación de productos de papel'),
      T_TIPO_DATA('3209', 'Supervisores de otras industrias manufactureras'),
      T_TIPO_DATA('3311', 'Técnicos en radioterapia'),
      T_TIPO_DATA('3312', 'Técnicos en imagen para el diagnóstico'),
      T_TIPO_DATA('3313', 'Técnicos en anatomía patológica y citología'),
      T_TIPO_DATA('3314', 'Técnicos en laboratorio de diagnóstico clínico'),
      T_TIPO_DATA('3315', 'Técnicos en ortoprótesis'),
      T_TIPO_DATA('3316', 'Técnicos en prótesis dentales'),
      T_TIPO_DATA('3317', 'Técnicos en audioprótesis'),
      T_TIPO_DATA('3321', 'Técnicos superiores en higiene bucodental'),
      T_TIPO_DATA('3322', 'Técnicos superiores en documentación sanitaria'),
      T_TIPO_DATA('3323', 'Técnicos superiores en dietética'),
      T_TIPO_DATA('3324', 'Técnicos en optometría'),
      T_TIPO_DATA('3325', 'Ayudantes fisioterapeutas'),
      T_TIPO_DATA('3326', 'Técnicos en prevención de riesgos laborales y salud ambiental'),
      T_TIPO_DATA('3327', 'Ayudantes de veterinaria'),
      T_TIPO_DATA('3329', 'Técnicos de la sanidad no clasificados bajo otros epígrafes'),
      T_TIPO_DATA('3331', 'Profesionales de la acupuntura, la naturopatía, la homeopatía, la medicina tradicional china y la ayurveda'),
      T_TIPO_DATA('3339', 'Otros profesionales de las terapias alternativas'),
      T_TIPO_DATA('3401', 'Profesionales de apoyo e intermediarios de cambio, bolsa y finanzas'),
      T_TIPO_DATA('3402', 'Comerciales de préstamos y créditos'),
      T_TIPO_DATA('3403', 'Tenedores de libros'),
      T_TIPO_DATA('3404', 'Profesionales de apoyo en servicios estadísticos, matemáticos y afines'),
      T_TIPO_DATA('3405', 'Tasadores'),
      T_TIPO_DATA('3510', 'Agentes y representantes comerciales'),
      T_TIPO_DATA('3521', 'Mediadores y agentes de seguros'),
      T_TIPO_DATA('3522', 'Agentes de compras'),
      T_TIPO_DATA('3523', 'Consignatarios'),
      T_TIPO_DATA('3531', 'Representantes de aduanas'),
      T_TIPO_DATA('3532', 'Organizadores de conferencias y eventos'),
      T_TIPO_DATA('3533', 'Agentes o intermediarios en la contratación de la mano de obra (excepto representantes de espectáculos)'),
      T_TIPO_DATA('3534', 'Agentes y administradores de la propiedad inmobiliaria'),
      T_TIPO_DATA('3535', 'Portavoces y agentes de relaciones públicas'),
      T_TIPO_DATA('3539', 'Representantes artísticos y deportivos y otros agentes de servicios comerciales no clasificados bajo otros epígrafes'),
      T_TIPO_DATA('3611', 'Supervisores de secretaría'),
      T_TIPO_DATA('3612', 'Asistentes jurídico-legales'),
      T_TIPO_DATA('3613', 'Asistentes de dirección y administrativos'),
      T_TIPO_DATA('3614', 'Secretarios de centros médicos o clínicas'),
      T_TIPO_DATA('3621', 'Profesionales de apoyo de la Administración Pública de tributos'),
      T_TIPO_DATA('3622', 'Profesionales de apoyo de la Administración Pública de servicios sociales'),
      T_TIPO_DATA('3623', 'Profesionales de apoyo de la Administración Pública de servicios de expedición de licencias'),
      T_TIPO_DATA('3629', 'Otros profesionales de apoyo de la Administración Pública para tareas de inspección y control y tareas similares'),
      T_TIPO_DATA('3631', 'Técnicos de la policía nacional, autonómica y local'),
      T_TIPO_DATA('3632', 'Suboficiales de la guardia civil'),
      T_TIPO_DATA('3711', 'Profesionales de apoyo de servicios jurídicos y servicios similares'),
      T_TIPO_DATA('3712', 'Detectives privados'),
      T_TIPO_DATA('3713', 'Profesionales de apoyo al trabajo y a la educación social'),
      T_TIPO_DATA('3714', 'Promotores de igualdad de oportunidades entre mujeres y hombres'),
      T_TIPO_DATA('3715', 'Animadores comunitarios'),
      T_TIPO_DATA('3716', 'Auxiliares laicos de las religiones'),
      T_TIPO_DATA('3721', 'Atletas y deportistas'),
      T_TIPO_DATA('3722', 'Entrenadores y árbitros de actividades deportivas'),
      T_TIPO_DATA('3723', 'Instructores de actividades deportivas'),
      T_TIPO_DATA('3724', 'Monitores de actividades recreativas y de entretenimiento'),
      T_TIPO_DATA('3731', 'Fotógrafos'),
      T_TIPO_DATA('3732', 'Diseñadores y decoradores de interior'),
      T_TIPO_DATA('3733', 'Técnicos en galerías de arte, museos y bibliotecas'),
      T_TIPO_DATA('3734', 'Chefs'),
      T_TIPO_DATA('3739', 'Otros técnicos y profesionales de apoyo de actividades culturales y artísticas'),
      T_TIPO_DATA('3811', 'Técnicos en operaciones de sistemas informáticos'),
      T_TIPO_DATA('3812', 'Técnicos en asistencia al usuario de tecnologías de la información'),
      T_TIPO_DATA('3813', 'Técnicos en redes'),
      T_TIPO_DATA('3814', 'Técnicos de la Web'),
      T_TIPO_DATA('3820', 'Programadores informáticos'),
      T_TIPO_DATA('3831', 'Técnicos de grabación audiovisual'),
      T_TIPO_DATA('3832', 'Técnicos de radiodifusión'),
      T_TIPO_DATA('3833', 'Técnicos de ingeniería de las telecomunicaciones'),
      T_TIPO_DATA('4113', 'Empleados de oficina de servicios estadísticos, financieros y bancarios'),
      T_TIPO_DATA('4121', 'Empleados de control de abastecimientos e inventario'),
      T_TIPO_DATA('4122', 'Empleados de oficina de servicios de apoyo a la producción'),
      T_TIPO_DATA('4123', 'Empleados de logística y transporte de pasajeros y mercancías'),
      T_TIPO_DATA('4210', 'Empleados de bibliotecas y archivos'),
      T_TIPO_DATA('4221', 'Empleados de servicios de correos (excepto empleados de mostrador)'),
      T_TIPO_DATA('4222', 'Codificadores y correctores de imprenta'),
      T_TIPO_DATA('4223', 'Empleados de servicio de personal'),
      T_TIPO_DATA('4309', 'Empleados administrativos sin tareas de atención al público no clasificados bajo otros epígrafes'),
      T_TIPO_DATA('4411', 'Empleados de información al usuario'),
      T_TIPO_DATA('4412', 'Recepcionistas (excepto de hoteles)'),
      T_TIPO_DATA('4421', 'Empleados de agencias de viajes'),
      T_TIPO_DATA('4422', 'Recepcionistas de hoteles'),
      T_TIPO_DATA('4423', 'Telefonistas'),
      T_TIPO_DATA('4424', 'Teleoperadores'),
      T_TIPO_DATA('4430', 'Agentes de encuestas'),
      T_TIPO_DATA('4441', 'Cajeros de bancos y afines'),
      T_TIPO_DATA('4442', 'Empleados de venta de apuestas'),
      T_TIPO_DATA('4443', 'Empleados de sala de juegos y afines'),
      T_TIPO_DATA('4444', 'Empleados de casas de empeño y de préstamos'),
      T_TIPO_DATA('4445', 'Cobradores de facturas, deudas y empleados afines'),
      T_TIPO_DATA('4446', 'Empleados de mostrador de correos'),
      T_TIPO_DATA('4500', 'Empleados administrativos con tareas de atención al público no clasificados bajo otros epígrafes'),
      T_TIPO_DATA('5000', 'Camareros y cocineros propietarios'),
      T_TIPO_DATA('5110', 'Cocineros asalariados'),
      T_TIPO_DATA('5120', 'Camareros asalariados'),
      T_TIPO_DATA('5210', 'Jefes de sección de tiendas y almacenes'),
      T_TIPO_DATA('5220', 'Vendedores en tiendas y almacenes'),
      T_TIPO_DATA('5300', 'Comerciantes propietarios de tiendas'),
      T_TIPO_DATA('5411', 'Vendedores en quioscos'),
      T_TIPO_DATA('5412', 'Vendedores en mercados ocasionales y mercadillos'),
      T_TIPO_DATA('5420', 'Operadores de telemarketing'),
      T_TIPO_DATA('5430', 'Expendedores de gasolineras'),
      T_TIPO_DATA('5491', 'Vendedores a domicilio'),
      T_TIPO_DATA('5492', 'Promotores de venta'),
      T_TIPO_DATA('5493', 'Modelos de moda, arte y publicidad'),
      T_TIPO_DATA('5499', 'Vendedores no clasificados bajo otros epígrafes'),
      T_TIPO_DATA('5500', 'Cajeros y taquilleros (excepto bancos)'),
      T_TIPO_DATA('5611', 'Auxiliares de enfermería hospitalaria'),
      T_TIPO_DATA('5612', 'Auxiliares de enfermería de atención primaria'),
      T_TIPO_DATA('5621', 'Técnicos auxiliares de farmacia'),
      T_TIPO_DATA('5622', 'Técnicos de emergencias sanitarias'),
      T_TIPO_DATA('5710', 'Trabajadores de los cuidados personales a domicilio'),
      T_TIPO_DATA('5721', 'Cuidadores de niños en guarderías y centros educativos'),
      T_TIPO_DATA('5722', 'Cuidadores de niños en domicilios'),
      T_TIPO_DATA('5811', 'Peluqueros'),
      T_TIPO_DATA('5812', 'Especialistas en tratamientos de estética, bienestar y afines'),
      T_TIPO_DATA('5821', 'Auxiliares de vuelo y camareros de avión, barco y tren'),
      T_TIPO_DATA('5822', 'Revisores y cobradores de transporte terrestre'),
      T_TIPO_DATA('5823', 'Acompañantes turísticos'),
      T_TIPO_DATA('5824', 'Azafatos de tierra'),
      T_TIPO_DATA('5825', 'Guías de turismo'),
      T_TIPO_DATA('5831', 'Supervisores de mantenimiento y limpieza en oficinas, hoteles y otros establecimientos'),
      T_TIPO_DATA('5832', 'Mayordomos del servicio doméstico'),
      T_TIPO_DATA('5833', 'Conserjes de edificios'),
      T_TIPO_DATA('5840', 'Trabajadores propietarios de pequeños alojamientos'),
      T_TIPO_DATA('5891', 'Asistentes personales o personas de compañía'),
      T_TIPO_DATA('5892', 'Empleados de pompas fúnebres y embalsamadores'),
      T_TIPO_DATA('5893', 'Cuidadores de animales y adiestradores'),
      T_TIPO_DATA('5894', 'Instructores de autoescuela'),
      T_TIPO_DATA('5895', 'Astrólogos, adivinadores y afines'),
      T_TIPO_DATA('5899', 'Trabajadores de servicios personales no clasificados bajo otros epígrafes'),
      T_TIPO_DATA('5910', 'Guardias civiles'),
      T_TIPO_DATA('5921', 'Policías nacionales'),
      T_TIPO_DATA('5922', 'Policías autonómicos'),
      T_TIPO_DATA('5923', 'Policías locales'),
      T_TIPO_DATA('5931', 'Bomberos (excepto forestales)'),
      T_TIPO_DATA('5932', 'Bomberos forestales'),
      T_TIPO_DATA('5941', 'Vigilantes de seguridad y similares habilitados para ir armados'),
      T_TIPO_DATA('5942', 'Auxiliares de vigilante de seguridad y similares no habilitados para ir armados'),
      T_TIPO_DATA('5991', 'Vigilantes de prisiones'),
      T_TIPO_DATA('5992', 'Bañistas-socorristas'),
      T_TIPO_DATA('5993', 'Agentes forestales y medioambientales'),
      T_TIPO_DATA('5999', 'Trabajadores de los servicios de protección y seguridad no clasificados bajo otros epígrafes'),
      T_TIPO_DATA('6110', 'Trabajadores cualificados en actividades agrícolas (excepto en huertas, invernaderos, viveros y jardines)'),
      T_TIPO_DATA('6120', 'Trabajadores cualificados en huertas, invernaderos, viveros y jardines'),
      T_TIPO_DATA('6202', 'Trabajadores cualificados en actividades ganaderas de ovino y caprino'),
      T_TIPO_DATA('6300', 'Trabajadores cualificados en actividades agropecuarias mixtas'),
      T_TIPO_DATA('6410', 'Trabajadores cualificados en actividades forestales y del medio natural'),
      T_TIPO_DATA('6421', 'Trabajadores cualificados en la acuicultura'),
      T_TIPO_DATA('6422', 'Pescadores de aguas costeras y aguas dulces'),
      T_TIPO_DATA('6423', 'Pescadores de altura'),
      T_TIPO_DATA('6430', 'Trabajadores cualificados en actividades cinegéticas'),
      T_TIPO_DATA('7111', 'Encofradores y operarios de puesta en obra de hormigón'),
      T_TIPO_DATA('7191', 'Mantenedores de edificios'),
      T_TIPO_DATA('7192', 'Instaladores de fachadas técnicas'),
      T_TIPO_DATA('7193', 'Instaladores de sistemas de impermeabilización en edificios'),
      T_TIPO_DATA('7199', 'Otros trabajadores de las obras estructurales de construcción no clasificados bajo otros epígrafes'),
      T_TIPO_DATA('7292', 'Instaladores de material aislante térmico y de insonorización'),
      T_TIPO_DATA('7322', 'Trabajadores de la fabricación de herramientas, mecánico-ajustadores, modelistas, matriceros y afines'),
      T_TIPO_DATA('7709', 'Catadores y clasificadores de alimentos y bebidas'),
      T_TIPO_DATA('7891', 'Buceadores'),
      T_TIPO_DATA('7892', 'Pegadores'),
      T_TIPO_DATA('7893', 'Clasificadores y probadores de productos (excepto alimentos, bebidas y tabaco)'),
      T_TIPO_DATA('7894', 'Fumigadores y otros controladores de plagas y malas hierbas'),
      T_TIPO_DATA('7899', 'Oficiales, operarios y artesanos de otros oficios no clasificados bajo otros epígrafes'),
      T_TIPO_DATA('8133', 'Operadores de laboratorios fotográficos y afines'),
      T_TIPO_DATA('8170', 'Operadores de máquinas de lavandería y tintorería'),
      T_TIPO_DATA('8201', 'Ensambladores de maquinaria mecánica'),
      T_TIPO_DATA('8202', 'Ensambladores de equipos eléctricos y electrónicos'),
      T_TIPO_DATA('8209', 'Montadores y ensambladores no clasificados en otros epígrafes'),
      T_TIPO_DATA('8321', 'Operadores de maquinaria agrícola móvil'),
      T_TIPO_DATA('8322', 'Operadores de maquinaria forestal móvil'),
      T_TIPO_DATA('8340', 'Marineros de puente, marineros de máquinas y afines'),
      T_TIPO_DATA('8411', 'Conductores propietarios de automóviles, taxis y furgonetas'),
      T_TIPO_DATA('8412', 'Conductores asalariados de automóviles, taxis y furgonetas'),
      T_TIPO_DATA('8431', 'Conductores propietarios de camiones'),
      T_TIPO_DATA('8432', 'Conductores asalariados de camiones'),
      T_TIPO_DATA('9100', 'Empleados domésticos'),
      T_TIPO_DATA('9210', 'Personal de limpieza de oficinas, hoteles y otros establecimientos similares'),
      T_TIPO_DATA('9221', 'Limpiadores en seco a mano y afines'),
      T_TIPO_DATA('9222', 'Limpiadores de vehículos'),
      T_TIPO_DATA('9223', 'Limpiadores de ventanas'),
      T_TIPO_DATA('9229', 'Otro personal de limpieza'),
      T_TIPO_DATA('9310', 'Ayudantes de cocina'),
      T_TIPO_DATA('9320', 'Preparadores de comidas rápidas'),
      T_TIPO_DATA('9410', 'Vendedores callejeros'),
      T_TIPO_DATA('9420', 'Repartidores de publicidad, limpiabotas y otros trabajadores de oficios callejeros'),
      T_TIPO_DATA('9431', 'Ordenanzas'),
      T_TIPO_DATA('9432', 'Mozos de equipaje y afines'),
      T_TIPO_DATA('9433', 'Repartidores, recadistas y mensajeros a pie'),
      T_TIPO_DATA('9434', 'Lectores de contadores y recaudadores de máquinas recreativas y expendedoras'),
      T_TIPO_DATA('9441', 'Recogedores de residuos'),
      T_TIPO_DATA('9442', 'Clasificadores de desechos, operarios de punto limpio y recogedores de chatarra'),
      T_TIPO_DATA('9443', 'Barrenderos y afines'),
      T_TIPO_DATA('9490', 'Otras ocupaciones elementales'),
      T_TIPO_DATA('9511', 'Peones agrícolas (excepto en huertas, invernaderos, viveros y jardines)'),
      T_TIPO_DATA('9512', 'Peones agrícolas en huertas, invernaderos, viveros y jardines'),
      T_TIPO_DATA('9520', 'Peones ganaderos'),
      T_TIPO_DATA('9530', 'Peones agropecuarios'),
      T_TIPO_DATA('9541', 'Peones de la pesca'),
      T_TIPO_DATA('9542', 'Peones de la acuicultura'),
      T_TIPO_DATA('9543', 'Peones forestales y de la caza'),
      T_TIPO_DATA('9601', 'Peones de obras públicas'),
      T_TIPO_DATA('9602', 'Peones de la construcción de edificios'),
      T_TIPO_DATA('9603', 'Peones de la minería, canteras y otras industrias extractivas'),
      T_TIPO_DATA('9700', 'Peones de las industrias manufactureras'),
      T_TIPO_DATA('9811', 'Peones del transporte de mercancías y descargadores'),
      T_TIPO_DATA('9812', 'Conductores de vehículos de tracción animal para el transporte de personas y similares'),
      T_TIPO_DATA('9820', 'Reponedores'),
      T_TIPO_DATA('0000', 'Sin información'),
      T_TIPO_DATA('0001', 'Estudiante'),
      T_TIPO_DATA('0002', 'Desempleado'),
      T_TIPO_DATA('0003', 'Tareas domésticas no retribuidas'),
      T_TIPO_DATA('0004', 'Jubilado/Pensionista'),
      T_TIPO_DATA('0005', 'Rentista'),
      T_TIPO_DATA('0011', 'Oficiales de las fuerzas armadas'),
      T_TIPO_DATA('0012', 'Suboficiales de las fuerzas armadas'),
      T_TIPO_DATA('0020', 'Tropa y marinería de las fuerzas armadas'),
      T_TIPO_DATA('1111', 'Miembros del poder ejecutivo (nacional, autonómico y local) y del poder legislativo'),
      T_TIPO_DATA('1112', 'Personal directivo de la Administración Pública'),
      T_TIPO_DATA('1120', 'Directores generales y presidentes ejecutivos'),
      T_TIPO_DATA('1211', 'Directores financieros'),
      T_TIPO_DATA('1212', 'Directores de recursos humanos'),
      T_TIPO_DATA('1219', 'Directores de políticas y planificación y de otros departamentos administrativos no clasificados bajo otros epígrafes'),
      T_TIPO_DATA('1221', 'Directores comerciales y de ventas'),
      T_TIPO_DATA('1222', 'Directores de publicidad y relaciones públicas'),
      T_TIPO_DATA('1223', 'Directores de investigación y desarrollo'),
      T_TIPO_DATA('1311', 'Directores de producción de explotaciones agropecuarias y forestales'),
      T_TIPO_DATA('1312', 'Directores de producción de explotaciones pesqueras y acuícolas'),
      T_TIPO_DATA('1313', 'Directores de industrias manufactureras'),
      T_TIPO_DATA('1314', 'Directores de explotaciones mineras'),
      T_TIPO_DATA('1315', 'Directores de empresas de abastecimiento, transporte, distribución y afines'),
      T_TIPO_DATA('1316', 'Directores de empresas de construcción'),
      T_TIPO_DATA('1321', 'Directores de servicios de tecnologías de la información y las comunicaciones (TIC)'),
      T_TIPO_DATA('1322', 'Directores de servicios sociales para niños'),
      T_TIPO_DATA('1323', 'Directores-gerentes de centros sanitarios'),
      T_TIPO_DATA('1324', 'Directores de servicios sociales para personas mayores'),
      T_TIPO_DATA('1325', 'Directores de otros servicios sociales'),
      T_TIPO_DATA('1326', 'Directores de servicios de educación'),
      T_TIPO_DATA('1327', 'Directores de sucursales de bancos, de servicios financieros y de seguros'),
      T_TIPO_DATA('1329', 'Directores de otras empresas de servicios profesionales no clasificados bajo otros epígrafes'),
      T_TIPO_DATA('1411', 'Directores y gerentes de hoteles'),
      T_TIPO_DATA('1419', 'Directores y gerentes de otras empresas de servicios de alojamiento'),
      T_TIPO_DATA('1421', 'Directores y gerentes de restaurantes'),
      T_TIPO_DATA('1422', 'Directores y gerentes de bares, cafeterías y similares'),
      T_TIPO_DATA('1431', 'Directores y gerentes de empresas de comercio al por mayor'),
      T_TIPO_DATA('1432', 'Directores y gerentes de empresas de comercio al por menor'),
      T_TIPO_DATA('2111', 'Médicos de familia'),
      T_TIPO_DATA('2112', 'Otros médicos especialistas'),
      T_TIPO_DATA('2121', 'Enfermeros no especializados'),
      T_TIPO_DATA('2122', 'Enfermeros especializados (excepto matronos)'),
      T_TIPO_DATA('2123', 'Matronos'),
      T_TIPO_DATA('2220', 'Profesores de formación profesional (materias específicas)'),
      T_TIPO_DATA('2230', 'Profesores de enseñanza secundaria (excepto materias específicas de formación profesional)'),
      T_TIPO_DATA('2240', 'Profesores de enseñanza primaria'),
      T_TIPO_DATA('2251', 'Maestros de educación infantil'),
      T_TIPO_DATA('2252', 'Técnicos en educación infantil'),
      T_TIPO_DATA('2311', 'Profesores de educación especial'),
      T_TIPO_DATA('2312', 'Técnicos educadores de educación especial'),
      T_TIPO_DATA('2321', 'Especialistas en métodos didácticos y pedagógicos'),
      T_TIPO_DATA('2322', 'Profesores de enseñanza no reglada de idiomas'),
      T_TIPO_DATA('2323', 'Profesores de enseñanza no reglada de música y danza'),
      T_TIPO_DATA('2324', 'Profesores de enseñanza no reglada de artes'),
      T_TIPO_DATA('2325', 'Instructores en tecnologías de la información en enseñanza no reglada'),
      T_TIPO_DATA('2326', 'Profesionales de la educación ambiental'),
      T_TIPO_DATA('2329', 'Profesores y profesionales de la enseñanza no clasificados bajo otros epígrafes'),
      T_TIPO_DATA('4111', 'Empleados de contabilidad'),
      T_TIPO_DATA('4112', 'Empleados de control de personal y nóminas'),
      T_TIPO_DATA('4301', 'Grabadores de datos'),
      T_TIPO_DATA('5629', 'Trabajadores de los cuidados a las personas en servicios de salud no clasificados bajo otros epígrafes'),
      T_TIPO_DATA('6201', 'Trabajadores cualificados en actividades ganaderas de vacuno'),
      T_TIPO_DATA('6203', 'Trabajadores cualificados en actividades ganaderas de porcino'),
      T_TIPO_DATA('6204', 'Trabajadores cualificados en apicultura y sericicultura'),
      T_TIPO_DATA('6205', 'Trabajadores cualificados en la avicultura y la cunicultura'),
      T_TIPO_DATA('6209', 'Trabajadores cualificados en actividades ganaderas no clasificados bajo otros epígrafes'),
      T_TIPO_DATA('7112', 'Montadores de prefabricados estructurales (sólo hormigón)'),
      T_TIPO_DATA('7121', 'Albañiles'),
      T_TIPO_DATA('7122', 'Canteros, tronzadores, labrantes y grabadores de piedras'),
      T_TIPO_DATA('7131', 'Carpinteros (excepto ebanistas)'),
      T_TIPO_DATA('7132', 'Instaladores de cerramientos metálicos y carpinteros metálicos (excepto montadores de estructuras metálicas)'),
      T_TIPO_DATA('7211', 'Escayolistas'),
      T_TIPO_DATA('7212', 'Aplicadores de revestimientos de pasta y mortero'),
      T_TIPO_DATA('7221', 'Fontaneros'),
      T_TIPO_DATA('7222', 'Montadores-instaladores de gas en edificios'),
      T_TIPO_DATA('7223', 'Instaladores de conductos en obra pública'),
      T_TIPO_DATA('7231', 'Pintores y empapeladores'),
      T_TIPO_DATA('7232', 'Pintores en las industrias manufactureras'),
      T_TIPO_DATA('7240', 'Soladores, colocadores de parquet y afines'),
      T_TIPO_DATA('7250', 'Mecánicos-instaladores de refrigeración y climatización'),
      T_TIPO_DATA('7291', 'Montadores de cubiertas'),
      T_TIPO_DATA('7293', 'Cristaleros'),
      T_TIPO_DATA('7294', 'Montadores-instaladores de placas de energía solar'),
      T_TIPO_DATA('7295', 'Personal de limpieza de fachadas de edificios y chimeneas'),
      T_TIPO_DATA('7311', 'Moldeadores y macheros'),
      T_TIPO_DATA('7312', 'Soldadores y oxicortadores'),
      T_TIPO_DATA('7313', 'Chapistas y caldereros'),
      T_TIPO_DATA('7314', 'Montadores de estructuras metálicas'),
      T_TIPO_DATA('7315', 'Montadores de estructuras cableadas y empalmadores de cables'),
      T_TIPO_DATA('7321', 'Herreros y forjadores'),
      T_TIPO_DATA('7323', 'Ajustadores y operadores de máquinas-herramienta'),
      T_TIPO_DATA('7324', 'Pulidores de metales y afiladores de herramientas'),
      T_TIPO_DATA('7401', 'Mecánicos y ajustadores de vehículos de motor'),
      T_TIPO_DATA('7402', 'Mecánicos y ajustadores de motores de avión'),
      T_TIPO_DATA('7403', 'Mecánicos y ajustadores de maquinaria agrícola e industrial'),
      T_TIPO_DATA('7404', 'Mecánicos y ajustadores de maquinaria naval y ferroviaria'),
      T_TIPO_DATA('7405', 'Reparadores de bicicletas y afines'),
      T_TIPO_DATA('7510', 'Electricistas de la construcción y afines'),
      T_TIPO_DATA('7521', 'Mecánicos y reparadores de equipos eléctricos'),
      T_TIPO_DATA('7522', 'Instaladores y reparadores de líneas eléctricas'),
      T_TIPO_DATA('7531', 'Mecánicos y reparadores de equipos electrónicos'),
      T_TIPO_DATA('7532', 'Instaladores y reparadores en electromedicina'),
      T_TIPO_DATA('7533', 'Instaladores y reparadores en tecnologías de la información y las comunicaciones'),
      T_TIPO_DATA('7611', 'Relojeros y mecánicos de instrumentos de precisión'),
      T_TIPO_DATA('7612', 'Lutieres y similares; afinadores de instrumentos musicales'),
      T_TIPO_DATA('7613', 'Joyeros, orfebres y plateros'),
      T_TIPO_DATA('7614', 'Trabajadores de la cerámica, alfareros y afines'),
      T_TIPO_DATA('7615', 'Sopladores, modeladores, laminadores, cortadores y pulidores de vidrio'),
      T_TIPO_DATA('7616', 'Rotulistas, grabadores de vidrio, pintores decorativos de artículos diversos'),
      T_TIPO_DATA('7617', 'Artesanos en madera y materiales similares; cesteros, bruceros y trabajadores afines'),
      T_TIPO_DATA('7618', 'Artesanos en tejidos, cueros y materiales similares, preparadores de fibra y tejedores con telares artesanos o de tejidos de punto y afines'),
      T_TIPO_DATA('7619', 'Artesanos no clasificados bajo otros epígrafes'),
      T_TIPO_DATA('7621', 'Trabajadores de procesos de preimpresión'),
      T_TIPO_DATA('7622', 'Trabajadores de procesos de impresión'),
      T_TIPO_DATA('7623', 'Trabajadores de procesos de encuadernación'),
      T_TIPO_DATA('7701', 'Matarifes y trabajadores de las industrias cárnicas'),
      T_TIPO_DATA('7702', 'Trabajadores de las industrias del pescado'),
      T_TIPO_DATA('7703', 'Panaderos, pasteleros y confiteros'),
      T_TIPO_DATA('7704', 'Trabajadores del tratamiento de la leche y elaboración de productos lácteos (incluidos helados)'),
      T_TIPO_DATA('7705', 'Trabajadores conserveros de frutas y hortalizas y trabajadores de la elaboración de bebidas no alcohólicas'),
      T_TIPO_DATA('7706', 'Trabajadores de la elaboración de bebidas alcohólicas distintas del vino'),
      T_TIPO_DATA('7707', 'Trabajadores de la elaboración del vino'),
      T_TIPO_DATA('7708', 'Preparadores y elaboradores del tabaco y sus productos'),
      T_TIPO_DATA('7811', 'Trabajadores del tratamiento de la madera'),
      T_TIPO_DATA('7812', 'Ajustadores y operadores de máquinas para trabajar la madera'),
      T_TIPO_DATA('7820', 'Ebanistas y trabajadores afines'),
      T_TIPO_DATA('7831', 'Sastres, modistos, peleteros y sombrereros'),
      T_TIPO_DATA('7832', 'Patronistas para productos en textil y piel'),
      T_TIPO_DATA('7833', 'Cortadores de tejidos, cuero, piel y otros materiales'),
      T_TIPO_DATA('7834', 'Costureros a mano, bordadores y afines'),
      T_TIPO_DATA('7835', 'Tapiceros, colchoneros y afines'),
      T_TIPO_DATA('7836', 'Curtidores y preparadores de pieles'),
      T_TIPO_DATA('7837', 'Zapateros y afines'),
      T_TIPO_DATA('8111', 'Mineros y otros operadores en instalaciones mineras'),
      T_TIPO_DATA('8112', 'Operadores en instalaciones para la preparación de minerales y rocas'),
      T_TIPO_DATA('8113', 'Sondistas y trabajadores afines'),
      T_TIPO_DATA('8114', 'Operadores de maquinaria para fabricar productos derivados de minerales no metálicos'),
      T_TIPO_DATA('8121', 'Operadores en instalaciones para la obtención y transformación de metales'),
      T_TIPO_DATA('8122', 'Operadores de máquinas pulidoras, galvanizadoras y recubridoras de metales'),
      T_TIPO_DATA('8131', 'Operadores en plantas industriales químicas'),
      T_TIPO_DATA('8132', 'Operadores de máquinas para fabricar productos farmacéuticos, cosméticos y afines'),
      T_TIPO_DATA('8141', 'Operadores de máquinas para fabricar productos de caucho y derivados de resinas naturales'),
      T_TIPO_DATA('8142', 'Operadores de máquinas para fabricar productos de material plástico'),
      T_TIPO_DATA('8143', 'Operadores de máquinas para fabricar productos de papel y cartón'),
      T_TIPO_DATA('8144', 'Operadores de serrerías, de máquinas de fabricación de tableros y de instalaciones afines para el tratamiento de la madera y el corcho'),
      T_TIPO_DATA('8145', 'Operadores en instalaciones para la preparación de pasta de papel y fabricación de papel'),
      T_TIPO_DATA('8151', 'Operadores de máquinas para preparar fibras, hilar y devanar'),
      T_TIPO_DATA('8152', 'Operadores de telares y otras máquinas tejedoras'),
      T_TIPO_DATA('8153', 'Operadores de máquinas de coser y bordar'),
      T_TIPO_DATA('8154', 'Operadores de máquinas de blanquear, teñir, estampar y acabar textiles'),
      T_TIPO_DATA('8155', 'Operadores de máquinas para tratar pieles y cuero'),
      T_TIPO_DATA('8156', 'Operadores de máquinas para la fabricación del calzado, marroquinería y guantería de piel'),
      T_TIPO_DATA('8159', 'Operadores de máquinas para fabricar productos textiles no clasificados bajo otros epígrafes'),
      T_TIPO_DATA('8160', 'Operadores de máquinas para elaborar productos alimenticios, bebidas y tabaco'),
      T_TIPO_DATA('8191', 'Operadores de hornos e instalaciones de vidriería y cerámica'),
      T_TIPO_DATA('8192', 'Operadores de calderas y máquinas de vapor'),
      T_TIPO_DATA('8193', 'Operadores de máquinas de embalaje, embotellamiento y etiquetado'),
      T_TIPO_DATA('8199', 'Operadores de instalaciones y maquinaria fijas no clasificados bajo otros epígrafes'),
      T_TIPO_DATA('8311', 'Maquinistas de locomotoras'),
      T_TIPO_DATA('8312', 'Agentes de maniobras ferroviarias'),
      T_TIPO_DATA('8331', 'Operadores de maquinaria de movimientos de tierras y equipos similares'),
      T_TIPO_DATA('8332', 'Operadores de grúas, montacargas y de maquinaria similar de movimiento de materiales'),
      T_TIPO_DATA('8333', 'Operadores de carretillas elevadoras'),
      T_TIPO_DATA('8420', 'Conductores de autobuses y tranvías'),
      T_TIPO_DATA('8440', 'Conductores de motocicletas y ciclomotores')

    ); 
    V_TMP_TIPO_DATA T_TIPO_DATA;
   
BEGIN	

    -- Primero borramos los valores de la tabla

    V_MSQL := 'DELETE FROM '||V_ESQUEMA||'.'||V_TABLA||'';
    EXECUTE IMMEDIATE V_MSQL;
	 
    -- LOOP para insertar los valores -----------------------------------------------------------------

    FOR I IN V_TIPO_DATA.FIRST .. V_TIPO_DATA.LAST
      LOOP

      V_TMP_TIPO_DATA := V_TIPO_DATA(I);
    	
      --Comprobamos el dato a insertar
      V_SQL := 'SELECT COUNT(1) FROM '||V_ESQUEMA||'.'||V_TABLA||' WHERE DD_'||V_CHARS||'_CODIGO = '''||TRIM(V_TMP_TIPO_DATA(1))||'''';
      EXECUTE IMMEDIATE V_SQL INTO V_NUM_TABLAS;
      
      --Si existe lo modificamos
      IF V_NUM_TABLAS > 0 THEN				
        
        DBMS_OUTPUT.PUT_LINE('[INFO]: MODIFICAMOS EL REGISTRO '''|| TRIM(V_TMP_TIPO_DATA(1)) ||'''');
        V_MSQL := '
          UPDATE '|| V_ESQUEMA ||'.'||V_TABLA||' 
          SET 
            DD_'||V_CHARS||'_DESCRIPCION = '''||TRIM(V_TMP_TIPO_DATA(2))||''',
            DD_'||V_CHARS||'_DESCRIPCION_LARGA = '''||TRIM(V_TMP_TIPO_DATA(2))||''',
	    USUARIOMODIFICAR = '''||V_USUARIO||''',
            FECHAMODIFICAR = SYSDATE
			    WHERE DD_'||V_CHARS||'_CODIGO = '''||TRIM(V_TMP_TIPO_DATA(1))||'''
			    ';
        EXECUTE IMMEDIATE V_MSQL;
        DBMS_OUTPUT.PUT_LINE('[INFO]: REGISTRO MODIFICADO CORRECTAMENTE');
        
      --Si no existe, lo insertamos   
      ELSE
              DBMS_OUTPUT.PUT_LINE('[INFO]: INSERTAMOS EL REGISTRO '''|| TRIM(V_TMP_TIPO_DATA(1)) ||'''');   
        V_MSQL := 'SELECT '|| V_ESQUEMA ||'.S_'||V_TABLA||'.NEXTVAL FROM DUAL';
        EXECUTE IMMEDIATE V_MSQL INTO V_ID;	
        
        V_MSQL := '
          	INSERT INTO '|| V_ESQUEMA ||'.'||V_TABLA||' (
				DD_'||V_CHARS||'_ID, DD_'||V_CHARS||'_CODIGO, DD_'||V_CHARS||'_DESCRIPCION, DD_'||V_CHARS||'_DESCRIPCION_LARGA, 
				VERSION, USUARIOCREAR, FECHACREAR)
          	SELECT 
	            '|| V_ID || ',
	            '''||V_TMP_TIPO_DATA(1)||''',
	            '''||V_TMP_TIPO_DATA(2)||''',
	            '''||TRIM(V_TMP_TIPO_DATA(2))||''',
	            0, '''||V_USUARIO||''', SYSDATE FROM DUAL';
        EXECUTE IMMEDIATE V_MSQL;
        DBMS_OUTPUT.PUT_LINE('[INFO]: REGISTRO INSERTADO CORRECTAMENTE');
      
      END IF;

    END LOOP;
  COMMIT;
   

EXCEPTION
     WHEN OTHERS THEN
          err_num := SQLCODE;
          err_msg := SQLERRM;

          DBMS_OUTPUT.put_line(V_MSQL);
          DBMS_OUTPUT.put_line('[ERROR] Se ha producido un error en la ejecución:'||TO_CHAR(err_num));
          DBMS_OUTPUT.put_line('-----------------------------------------------------------'); 
          DBMS_OUTPUT.put_line(err_msg);

          ROLLBACK;
          RAISE;          

END;

/

EXIT
