--/*
--##########################################
--## AUTOR=Jesus Jativa
--## FECHA_CREACION=20210609
--## ARTEFACTO=online
--## VERSION_ARTEFACTO=9.3
--## INCIDENCIA_LINK=HREOS-14267
--## PRODUCTO=NO
--##
--## Finalidad: Insert en tabla .
--## INSTRUCCIONES:
--## VERSIONES:
--##        0.1 Versión inicial
--##########################################
--*/

--Para permitir la visualización de texto en un bloque PL/SQL utilizando DBMS_OUTPUT.PUT_LINE

WHENEVER SQLERROR EXIT SQL.SQLCODE;
SET SERVEROUTPUT ON;
SET DEFINE OFF;


DECLARE
    V_MSQL VARCHAR2(32000 CHAR); -- Sentencia a ejecutar     
    V_ESQUEMA VARCHAR2(25 CHAR):= '#ESQUEMA#'; -- Configuracion Esquema
    V_ESQUEMA_M VARCHAR2(25 CHAR):= '#ESQUEMA_MASTER#'; -- Configuracion Esquema Master
    V_SQL VARCHAR2(4000 CHAR); -- Vble. para consulta que valida la existencia de una tabla.
    V_SQL_NORDEN VARCHAR2(4000 CHAR); -- Vble. para consulta del siguente ORDEN TFI para una tarea.
    V_NUM_NORDEN NUMBER(16); -- Vble. para indicar el siguiente orden en TFI para una tarea.
    V_NUM_ENLACES NUMBER(16); -- Vble. para indicar no. de enlaces en TFI
    V_NUM_TABLAS NUMBER(16); -- Vble. para validar la existencia de una tabla.   
    ERR_NUM NUMBER(25);  -- Vble. auxiliar para registrar errores en el script.
    ERR_MSG VARCHAR2(1024 CHAR); -- Vble. auxiliar para registrar errores en el script.
    table_count number(3); -- Vble. para validar la existencia de las Tablas.
	V_ID NUMBER(16); -- Vble. auxiliar para almacenar temporalmente el numero de la sequencia.
    V_TEXT1 VARCHAR2(2400 CHAR); -- Vble. auxiliar
    V_ENTIDAD_ID NUMBER(16);
	V_TEXT_TABLA VARCHAR2(2400 CHAR) := 'DD_CNO_CN_OCUPACIONAL'; -- Vble. auxiliar para almacenar el nombre de la tabla de ref.
    V_CODIGO_TABLA VARCHAR2(3 CHAR) := 'CNO';
	V_USUARIO VARCHAR2(32 CHAR) := 'HREOS-14267';

    
    TYPE T_TIPO_DATA IS TABLE OF VARCHAR2(150);
    TYPE T_ARRAY_DATA IS TABLE OF T_TIPO_DATA;
    V_TIPO_DATA T_ARRAY_DATA := T_ARRAY_DATA(
T_TIPO_DATA('X1010',	'PERSONAS EN BUSCA DE SU PRIMER EMPLEO',	'PERSONAS EN BUSCA DE SU PRIMER EMPLEO'),
T_TIPO_DATA('X2010',	'PERSONAS CON OCUPACIONES NO ESPECIFICAS',	'PERSONAS CON OCUPACIONES NO ESPECIFICAS'),
T_TIPO_DATA('X3010',	'PERSONAS EN BUSCA DE EMPLEO',	'PERSONAS EN BUSCA DE EMPLEO'),
T_TIPO_DATA('Y0010',	'PROFESIONAL DE LAS FUERZAS ARMADAS',	'PROFESIONAL DE LAS FUERZAS ARMADAS'),
T_TIPO_DATA('ZZZ10',	'AMA DE CASA',	'AMA DE CASA'),
T_TIPO_DATA('ZZZ20',	'JUBILADO, PENSIONISTA, RENTISTA',	'JUBILADO, PENSIONISTA, RENTISTA'),
T_TIPO_DATA('ZZZ30',	'ESTUDIANTE',	'ESTUDIANTE'),
T_TIPO_DATA('ZZZ40',	'SERVICIO MILITAR',	'SERVICIO MILITAR'),
T_TIPO_DATA('01110',	'QUIMICO',	'QUIMICO'),
T_TIPO_DATA('01210',	'FISICO',	'FISICO'),
T_TIPO_DATA('01310',	'GEOFISICO GEOLOGO METEOROLOGO ASTRONOMO',	'GEOFISICO GEOLOGO METEOROLOGO ASTRONOMO'),
T_TIPO_DATA('01410',	'TECNICO EN QUIMICA, FISICA, GEOLOGIA',	'TECNICO EN QUIMICA, FISICA, GEOLOGIA'),
T_TIPO_DATA('02010',	'ARQUITECTO',	'ARQUITECTO'),
T_TIPO_DATA('02110',	'INGENIERO DE CAMINOS, CANALES Y PUERTOS',	'INGENIERO DE CAMINOS, CANALES Y PUERTOS'),
T_TIPO_DATA('02210',	'INGENIERO DE TELECOMUNICACIONES',	'INGENIERO DE TELECOMUNICACIONES'),
T_TIPO_DATA('02310',	'INGENIERO INDUSTRIAL',	'INGENIERO INDUSTRIAL'),
T_TIPO_DATA('02410',	'INGENIERO NAVAL',	'INGENIERO NAVAL'),
T_TIPO_DATA('02510',	'INGENIERO AERONAUTICO',	'INGENIERO AERONAUTICO'),
T_TIPO_DATA('02600',	'RESTO INGENIEROS SUPERIORES',	'RESTO INGENIEROS SUPERIORES'),
T_TIPO_DATA('03010',	'ARQUITECTO TECNICO, APAREJADOR',	'ARQUITECTO TECNICO, APAREJADOR'),
T_TIPO_DATA('03110',	'INGENIERO TECNICO OBRAS PUBLICAS',	'INGENIERO TECNICO OBRAS PUBLICAS'),
T_TIPO_DATA('03210',	'INGENIERO TECNICO DE TELECOMUNICACIONES',	'INGENIERO TECNICO DE TELECOMUNICACIONES'),
T_TIPO_DATA('03310',	'INGENIERO TECNICO INDUSTRIAL',	'INGENIERO TECNICO INDUSTRIAL'),
T_TIPO_DATA('03400',	'RESTO INGENIEROS TECNICOS Y TOPOGRAFOS',	'RESTO INGENIEROS TECNICOS Y TOPOGRAFOS'),
T_TIPO_DATA('03910',	'DIBUJANTE, DELINEANTE, CARTOGRAFO',	'DIBUJANTE, DELINEANTE, CARTOGRAFO'),
T_TIPO_DATA('04110',	'PILOTO Y OFICIAL DE NAVEGACION AEREA',	'PILOTO Y OFICIAL DE NAVEGACION AEREA'),
T_TIPO_DATA('04210',	'CAPITAN PILOTO OFICIAL MARINA MERCANTE',	'CAPITAN PILOTO OFICIAL MARINA MERCANTE'),
T_TIPO_DATA('05110',	'BIOLOGO, BOTANICO, ZOOLOGO, OCEANOGRAFO',	'BIOLOGO, BOTANICO, ZOOLOGO, OCEANOGRAFO'),
T_TIPO_DATA('05200',	'BIOQUIMICO, FARMACOLOGO',	'BIOQUIMICO, FARMACOLOGO'),
T_TIPO_DATA('06110',	'MEDICO, MEDICO INSS, PEDIATRA',	'MEDICO, MEDICO INSS, PEDIATRA'),
T_TIPO_DATA('06111',	'CIRUJANO Y TRAUMATOLOGO',	'CIRUJANO Y TRAUMATOLOGO'),
T_TIPO_DATA('06119',	'MEDICO ESPECIALISTA',	'MEDICO ESPECIALISTA'),
T_TIPO_DATA('06510',	'VETERINARIO, PARASITOLOGO',	'VETERINARIO, PARASITOLOGO'),
T_TIPO_DATA('06710',	'FARMACEUTICO',	'FARMACEUTICO'),
T_TIPO_DATA('06810',	'DIETETICO, BROMATOLOGO',	'DIETETICO, BROMATOLOGO'),
T_TIPO_DATA('07110',	'PRACTICANTE, ENFERMERO, ATS',	'PRACTICANTE, ENFERMERO, ATS'),
T_TIPO_DATA('07200',	'FISIOTERAPEUTA, ATS',	'FISIOTERAPEUTA, ATS'),
T_TIPO_DATA('07510',	'AUXILIAR DE CLINICA, SANITARIO',	'AUXILIAR DE CLINICA, SANITARIO'),
T_TIPO_DATA('07610',	'OPTICO',	'OPTICO'),
T_TIPO_DATA('07910',	'AUXILIAR MEDICINA, FARMACIA, VETERINARIA',	'AUXILIAR MEDICINA, FARMACIA, VETERINARIA'),
T_TIPO_DATA('08100',	'ESTADISTICO, DEMOGRAFO, MATEMATICO',	'ESTADISTICO, DEMOGRAFO, MATEMATICO'),
T_TIPO_DATA('08410',	'TECNICO DE SISTEMAS INFORMATICOS',	'TECNICO DE SISTEMAS INFORMATICOS'),
T_TIPO_DATA('08511',	'PROGRAMADOR DE ORDENADORES',	'PROGRAMADOR DE ORDENADORES'),
T_TIPO_DATA('09010',	'ECONOMISTA',	'ECONOMISTA'),
T_TIPO_DATA('11000',	'DIPLOMADO EN CIENCIAS EMPRESARIALES',	'DIPLOMADO EN CIENCIAS EMPRESARIALES'),
T_TIPO_DATA('11090',	'CONTABLE',	'CONTABLE'),
T_TIPO_DATA('12120',	'ABOGADO',	'ABOGADO'),
T_TIPO_DATA('12130',	'PROCURADOR DE LOS TRIBUNALES',	'PROCURADOR DE LOS TRIBUNALES'),
T_TIPO_DATA('12200',	'FISCAL Y SECRETARIO JUDICIAL',	'FISCAL Y SECRETARIO JUDICIAL'),
T_TIPO_DATA('12210',	'MAGISTRADO Y JUEZ',	'MAGISTRADO Y JUEZ'),
T_TIPO_DATA('12300',	'NOTARIO, CORREDOR DE COMERCIO',	'NOTARIO, CORREDOR DE COMERCIO'),
T_TIPO_DATA('12320',	'REGISTRADOR DE LA PROPIEDAD',	'REGISTRADOR DE LA PROPIEDAD'),
T_TIPO_DATA('12410',	'LETRADO, ASESOR JURIDICO',	'LETRADO, ASESOR JURIDICO'),
T_TIPO_DATA('12910',	'ASESOR JURIDICO',	'ASESOR JURIDICO'),
T_TIPO_DATA('12990',	'OTROS PROFESIONALES DEL DERECHO',	'OTROS PROFESIONALES DEL DERECHO'),
T_TIPO_DATA('13000',	'PROFESOR PREESCOLAR, JARDIN INFANCIA',	'PROFESOR PREESCOLAR, JARDIN INFANCIA'),
T_TIPO_DATA('13110',	'PROFESOR DE UNIVERSIDAD, COLEGIO MAYOR',	'PROFESOR DE UNIVERSIDAD, COLEGIO MAYOR'),
T_TIPO_DATA('13210',	'PROFESOR DE ENSE#ANZA MEDIA',	'PROFESOR DE ENSE#ANZA MEDIA'),
T_TIPO_DATA('13310',	'PROFESOR DE EDUCACION GENERAL BASICA',	'PROFESOR DE EDUCACION GENERAL BASICA'),
T_TIPO_DATA('13910',	'PROFESOR DE ENSE#ANZAS VARIAS',	'PROFESOR DE ENSE#ANZAS VARIAS'),
T_TIPO_DATA('14000',	'SACERDOTE, MISIONERO SEGLAR, CATEQUISTA',	'SACERDOTE, MISIONERO SEGLAR, CATEQUISTA'),
T_TIPO_DATA('15000',	'ESCRITOR, POETA, CRITICO',	'ESCRITOR, POETA, CRITICO'),
T_TIPO_DATA('15210',	'PERIODISTA, REDACTOR',	'PERIODISTA, REDACTOR'),
T_TIPO_DATA('16000',	'FOTOGRAFO, ESCULTOR, PINTOR, GRABADOR',	'FOTOGRAFO, ESCULTOR, PINTOR, GRABADOR'),
T_TIPO_DATA('16210',	'DECORADOR, ILUSTRADOR, DISE#ADOR',	'DECORADOR, ILUSTRADOR, DISE#ADOR'),
T_TIPO_DATA('17000',	'ARTISTAS Y PROFESIONALES DE ESPECTACULOS',	'ARTISTAS Y PROFESIONALES DE ESPECTACULOS'),
T_TIPO_DATA('17120',	'PROFESOR ORQUESTA MUSICO INSTRUMENTISTA',	'PROFESOR ORQUESTA MUSICO INSTRUMENTISTA'),
T_TIPO_DATA('18000',	'PROFESIONALES DEL DEPORTE',	'PROFESIONALES DEL DEPORTE'),
T_TIPO_DATA('19000',	'OTROS PROFESIONALES Y TECNICOS',	'OTROS PROFESIONALES Y TECNICOS'),
T_TIPO_DATA('19210',	'GEOGRAFO, HISTORIADOR, ARQUEOLOGO',	'GEOGRAFO, HISTORIADOR, ARQUEOLOGO'),
T_TIPO_DATA('19211',	'PROFESIONAL CIENCIAS POLITICAS, SICOLOGO',	'PROFESIONAL CIENCIAS POLITICAS, SICOLOGO'),
T_TIPO_DATA('19400',	'ESPECIALISTAS ASUNTOS DE PERSONAL',	'ESPECIALISTAS ASUNTOS DE PERSONAL'),
T_TIPO_DATA('19610',	'TECNICO PUBLICIDAD, RELACIONES PUBLICAS',	'TECNICO PUBLICIDAD, RELACIONES PUBLICAS'),
T_TIPO_DATA('19900',	'AGENTE DE PROPIEDAD INDUSTRIAL',	'AGENTE DE PROPIEDAD INDUSTRIAL'),
T_TIPO_DATA('20000',	'MIEMBRO DE ORGANOS DE GOBIERNO',	'MIEMBRO DE ORGANOS DE GOBIERNO'),
T_TIPO_DATA('21110',	'DIRECTOR GENERAL Y GERENTE DE EMPRESA',	'DIRECTOR GENERAL Y GERENTE DE EMPRESA'),
T_TIPO_DATA('21210',	'DIRECTOR, JEFE DEPARTAMENTO SUCURSAL',	'DIRECTOR, JEFE DEPARTAMENTO SUCURSAL'),
T_TIPO_DATA('31110',	'JEFE OFICINAS ADMINISTRATIVAS',	'JEFE OFICINAS ADMINISTRATIVAS'),
T_TIPO_DATA('32010',	'TAQUIGRAFO, MECANOGRAFO Y SIMILAR',	'TAQUIGRAFO, MECANOGRAFO Y SIMILAR'),
T_TIPO_DATA('33110',	'EMPLEADO DE CONTABILIDAD Y CAJA',	'EMPLEADO DE CONTABILIDAD Y CAJA'),
T_TIPO_DATA('33900',	'ADMDOR, FINCAS, PATRONATO APUESTAS',	'ADMDOR, FINCAS, PATRONATO APUESTAS'),
T_TIPO_DATA('33920',	'ADMINISTRADOR DE LOTERIA Y EXPENDEDOR',	'ADMINISTRADOR DE LOTERIA Y EXPENDEDOR'),
T_TIPO_DATA('34010',	'OPERADOR DE MAQUINAS CONTABLES, DATOS',	'OPERADOR DE MAQUINAS CONTABLES, DATOS'),
T_TIPO_DATA('35010',	'JEFE E INSPECTOR DE COMUNICACIONES',	'JEFE E INSPECTOR DE COMUNICACIONES'),
T_TIPO_DATA('36010',	'JEFE DE TREN, REVISOR Y COBRADOR',	'JEFE DE TREN, REVISOR Y COBRADOR'),
T_TIPO_DATA('37010',	'CARTERO, ORDENANZA Y RECADERO',	'CARTERO, ORDENANZA Y RECADERO'),
T_TIPO_DATA('38010',	'OPERADOR TELECOMUNICACIONES, TELEFONISTA',	'OPERADOR TELECOMUNICACIONES, TELEFONISTA'),
T_TIPO_DATA('39110',	'PERSONAL DE ALMACENAMIENTO DE MERCANCIAS',	'PERSONAL DE ALMACENAMIENTO DE MERCANCIAS'),
T_TIPO_DATA('39310',	'PERSONAL ADMINISTRATIVO',	'PERSONAL ADMINISTRATIVO'),
T_TIPO_DATA('39410',	'RECEPCIONISTA Y AGENTE DE VIAJES',	'RECEPCIONISTA Y AGENTE DE VIAJES'),
T_TIPO_DATA('39500',	'EMPLEADO DE BIBLIOTECA Y DE ARCHIVO',	'EMPLEADO DE BIBLIOTECA Y DE ARCHIVO'),
T_TIPO_DATA('40010',	'DIRECTOR Y GERENTE DE COMERCIO',	'DIRECTOR Y GERENTE DE COMERCIO'),
T_TIPO_DATA('42010',	'JEFE/AGENTE COMPRAS/VENTAS',	'JEFE/AGENTE COMPRAS/VENTAS'),
T_TIPO_DATA('43110',	'AGENTE E INSPECTOR TECNICO DE VENTAS',	'AGENTE E INSPECTOR TECNICO DE VENTAS'),
T_TIPO_DATA('43210',	'VIAJANTE Y REPRESENTANTE DE COMERCIO',	'VIAJANTE Y REPRESENTANTE DE COMERCIO'),
T_TIPO_DATA('44000',	'AGENTE INMOBILIARIO, PUBLICIDAD, BOLSA Y',	'AGENTE INMOBILIARIO, PUBLICIDAD, BOLSA Y'),
T_TIPO_DATA('44110',	'AGENTE DE CAMBIO Y BOLSA, ASESORES',	'AGENTE DE CAMBIO Y BOLSA, ASESORES'),
T_TIPO_DATA('44210',	'AGENTE COLEGIADO INMOBILIARIO',	'AGENTE COLEGIADO INMOBILIARIO'),
T_TIPO_DATA('44220',	'AGENTE DE SEGUROS',	'AGENTE DE SEGUROS'),
T_TIPO_DATA('44330',	'INTERMEDIARIO PROMOTOR DE EDIFICACIONES',	'INTERMEDIARIO PROMOTOR DE EDIFICACIONES'),
T_TIPO_DATA('45010',	'VENDEDOR Y DEPENDIENTE DE COMERCIO',	'VENDEDOR Y DEPENDIENTE DE COMERCIO'),
T_TIPO_DATA('49010',	'OTROS VENDEDORES Y COMERCIANTES',	'OTROS VENDEDORES Y COMERCIANTES'),
T_TIPO_DATA('50010',	'EMPRESARIO Y GERENTE DE HOSTELERIA',	'EMPRESARIO Y GERENTE DE HOSTELERIA'),
T_TIPO_DATA('52010',	'ENCARGADO DE PERSONAL SERVICIO DOMESTICO',	'ENCARGADO DE PERSONAL SERVICIO DOMESTICO'),
T_TIPO_DATA('53010',	'COCINERO Y CAMARERO',	'COCINERO Y CAMARERO'),
T_TIPO_DATA('54010',	'PERSONAL SERVICIO DOMESTICO, SIMILARES',	'PERSONAL SERVICIO DOMESTICO, SIMILARES'),
T_TIPO_DATA('55010',	'PERSONAL DEL CUIDADO DE EDIFICIOS',	'PERSONAL DEL CUIDADO DE EDIFICIOS'),
T_TIPO_DATA('56010',	'TRABAJADOR DE LA LIMPIEZA DE ROPA',	'TRABAJADOR DE LA LIMPIEZA DE ROPA'),
T_TIPO_DATA('57010',	'PERSONAL PELUQUERIA, BELLEZA Y SIMILARES',	'PERSONAL PELUQUERIA, BELLEZA Y SIMILARES'),
T_TIPO_DATA('58010',	'PERSONAL DE LOS SERVICIOS DE SEGURIDAD',	'PERSONAL DE LOS SERVICIOS DE SEGURIDAD'),
T_TIPO_DATA('59000',	'INTERPRETE, PERSONAL DE APUESTAS',	'INTERPRETE, PERSONAL DE APUESTAS'),
T_TIPO_DATA('59210',	'TRABAJADOR DE POMPAS FUNEBRES',	'TRABAJADOR DE POMPAS FUNEBRES'),
T_TIPO_DATA('59910',	'OTRO PERSONAL DE SERVICIOS, AZAFATAS',	'OTRO PERSONAL DE SERVICIOS, AZAFATAS'),
T_TIPO_DATA('60000',	'DIRECTOR GERENTE DE EXPLOTACION AGRARIA',	'DIRECTOR GERENTE DE EXPLOTACION AGRARIA'),
T_TIPO_DATA('62010',	'PERSONAL DE LA AGRICULTURA Y GANADERIA',	'PERSONAL DE LA AGRICULTURA Y GANADERIA'),
T_TIPO_DATA('70010',	'JEFE DE TALLER Y SIMILAR',	'JEFE DE TALLER Y SIMILAR'),
T_TIPO_DATA('71010',	'TRABAJADOR DE LA EXTRACCION DE MINERALES',	'TRABAJADOR DE LA EXTRACCION DE MINERALES'),
T_TIPO_DATA('72010',	'TRABAJADOR SIDEROMETALURGICO',	'TRABAJADOR SIDEROMETALURGICO'),
T_TIPO_DATA('73010',	'TRABAJADOR TRATAMIENTO MADERA Y PAPEL',	'TRABAJADOR TRATAMIENTO MADERA Y PAPEL'),
T_TIPO_DATA('74010',	'TRABAJADOR DE PRODUCTOS QUIMICOS',	'TRABAJADOR DE PRODUCTOS QUIMICOS'),
T_TIPO_DATA('75010',	'TRABAJADOR TEXTIL Y SIMILAR',	'TRABAJADOR TEXTIL Y SIMILAR'),
T_TIPO_DATA('76010',	'PERSONAL DEL TRATAMIENTO DE PIELES',	'PERSONAL DEL TRATAMIENTO DE PIELES'),
T_TIPO_DATA('77010',	'PERSONAL DE ELABORACION DE COMESTIBLES',	'PERSONAL DE ELABORACION DE COMESTIBLES'),
T_TIPO_DATA('78010',	'PERSONAL DE LA ELABORACION DEL TABACO',	'PERSONAL DE LA ELABORACION DEL TABACO'),
T_TIPO_DATA('79010',	'TRABAJADOR DEL CORTE Y CONFECCION',	'TRABAJADOR DEL CORTE Y CONFECCION'),
T_TIPO_DATA('80010',	'TRABAJADOR DEL CALZADO Y CUERO',	'TRABAJADOR DEL CALZADO Y CUERO'),
T_TIPO_DATA('81010',	'TRABAJADOR DEL MUEBLE Y MADERA',	'TRABAJADOR DEL MUEBLE Y MADERA'),
T_TIPO_DATA('82010',	'TRABAJADOR DE LA PIEDRA Y MARMOL',	'TRABAJADOR DE LA PIEDRA Y MARMOL'),
T_TIPO_DATA('83010',	'TRABAJADOR DEL METAL',	'TRABAJADOR DEL METAL'),
T_TIPO_DATA('84010',	'MECANICO, MONTADOR, AJUSTADOR MAQUINARIA',	'MECANICO, MONTADOR, AJUSTADOR MAQUINARIA'),
T_TIPO_DATA('85010',	'ELECTRICISTA Y TECNICO ELECTRONICO',	'ELECTRICISTA Y TECNICO ELECTRONICO'),
T_TIPO_DATA('86010',	'OPERADOR DE EQUIPOS DE IMAGEN Y SONIDO',	'OPERADOR DE EQUIPOS DE IMAGEN Y SONIDO'),
T_TIPO_DATA('87010',	'FONTANERO, CHAPISTA, SOLDADOR Y SIMILAR',	'FONTANERO, CHAPISTA, SOLDADOR Y SIMILAR'),
T_TIPO_DATA('88010',	'TRABAJADOR DE JOYERIA Y PLATERIA',	'TRABAJADOR DE JOYERIA Y PLATERIA'),
T_TIPO_DATA('89010',	'TRABAJADOR DEL VIDRIO Y CERAMICA',	'TRABAJADOR DEL VIDRIO Y CERAMICA'),
T_TIPO_DATA('90000',	'ARTESANO Y TRABAJADOR ASIMILADO',	'ARTESANO Y TRABAJADOR ASIMILADO'),
T_TIPO_DATA('92010',	'TRABAJADOR DE LAS ARTES GRAFICAS',	'TRABAJADOR DE LAS ARTES GRAFICAS'),
T_TIPO_DATA('93010',	'PINTOR, ROTULISTA',	'PINTOR, ROTULISTA'),
T_TIPO_DATA('95010',	'TRABAJADOR DE CONSTRUCCION E INSTALADOR',	'TRABAJADOR DE CONSTRUCCION E INSTALADOR'),
T_TIPO_DATA('96010',	'OPERADOR DE MAQUINAS FIJAS',	'OPERADOR DE MAQUINAS FIJAS'),
T_TIPO_DATA('97000',	'INSTALADOR CABLES, APARATOS DE ELEVACION',	'INSTALADOR CABLES, APARATOS DE ELEVACION'),
T_TIPO_DATA('97010',	'TRABAJADOR DE CARGA-DESCARGA, ENVASADOR',	'TRABAJADOR DE CARGA-DESCARGA, ENVASADOR'),
T_TIPO_DATA('98000',	'CONDUCTOR MAQUINAS CONSTRUCCION AGRICOLA',	'CONDUCTOR MAQUINAS CONSTRUCCION AGRICOLA'),
T_TIPO_DATA('98010',	'CONDUCTOR DE LOS MEDIOS DE TRANSPORTE',	'CONDUCTOR DE LOS MEDIOS DE TRANSPORTE'),
T_TIPO_DATA('99010',	'TRABAJADOR NO CLASIFICADO OTROS GRUPOS',	'TRABAJADOR NO CLASIFICADO OTROS GRUPOS')
    ); 
    V_TMP_TIPO_DATA T_TIPO_DATA;
    
BEGIN
DBMS_OUTPUT.PUT_LINE('[INICIO]');


    DBMS_OUTPUT.PUT_LINE('[INFO]: INSERCION EN '||V_TEXT_TABLA);
    FOR I IN V_TIPO_DATA.FIRST .. V_TIPO_DATA.LAST
      LOOP

        V_TMP_TIPO_DATA := V_TIPO_DATA(I);

        --Comprobar el dato a insertar.
        V_MSQL := 'SELECT COUNT(1) FROM '||V_ESQUEMA||'.'||V_TEXT_TABLA||' WHERE DD_'||V_CODIGO_TABLA||'_CODIGO = '''||TRIM(V_TMP_TIPO_DATA(1))||'''';
        EXECUTE IMMEDIATE V_MSQL INTO V_NUM_TABLAS;

        IF V_NUM_TABLAS > 0 THEN				
          -- Si existe se modifica.
          DBMS_OUTPUT.PUT_LINE('[INFO]: MODIFICAR EL REGISTRO '''|| TRIM(V_TMP_TIPO_DATA(1)) ||'''');
       	  V_MSQL := 'UPDATE '|| V_ESQUEMA ||'.'||V_TEXT_TABLA||' '||
                    'SET DD_'||V_CODIGO_TABLA||'_DESCRIPCION = '''||TRIM(V_TMP_TIPO_DATA(2))||''''|| 
					', DD_'||V_CODIGO_TABLA||'_DESCRIPCION_LARGA = '''||TRIM(V_TMP_TIPO_DATA(3))||''''||
					', USUARIOMODIFICAR = '''||V_USUARIO||''' , FECHAMODIFICAR = SYSDATE '||
					'WHERE DD_'||V_CODIGO_TABLA||'_CODIGO = '''||TRIM(V_TMP_TIPO_DATA(1))||'''';
          EXECUTE IMMEDIATE V_MSQL;
          DBMS_OUTPUT.PUT_LINE('[INFO]: REGISTRO MODIFICADO CORRECTAMENTE');

       ELSE
       	-- Si no existe se inserta.
          DBMS_OUTPUT.PUT_LINE('[INFO]: INSERTAR EL REGISTRO '''|| TRIM(V_TMP_TIPO_DATA(1)) ||'''');
  
          V_MSQL := 'INSERT INTO '||V_ESQUEMA||'.'||V_TEXT_TABLA||' (
                      DD_'||V_CODIGO_TABLA||'_ID, DD_'||V_CODIGO_TABLA||'_CODIGO, DD_'||V_CODIGO_TABLA||'_DESCRIPCION, DD_'||V_CODIGO_TABLA||'_DESCRIPCION_LARGA, USUARIOCREAR, FECHACREAR) VALUES
                      (S_'||V_TEXT_TABLA||'.NEXTVAL,  '''||V_TMP_TIPO_DATA(1)||''','''||TRIM(V_TMP_TIPO_DATA(2))||''','''||TRIM(V_TMP_TIPO_DATA(3))||''', '''||V_USUARIO||''',SYSDATE)';
          EXECUTE IMMEDIATE V_MSQL;
          DBMS_OUTPUT.PUT_LINE('[INFO]: REGISTRO INSERTADO CORRECTAMENTE');

       END IF;
      END LOOP;
      
    COMMIT;
    DBMS_OUTPUT.PUT_LINE('[FIN]: DICCIONARIO '||V_TEXT_TABLA||' ACTUALIZADO CORRECTAMENTE ');

EXCEPTION
     WHEN OTHERS THEN
          ERR_NUM := SQLCODE;
          ERR_MSG := SQLERRM;
          DBMS_OUTPUT.put_line('[ERROR] Se ha producido un error en la ejecución:'||TO_CHAR(ERR_NUM));
          DBMS_OUTPUT.put_line('-----------------------------------------------------------'); 
          DBMS_OUTPUT.put_line(ERR_MSG);
          ROLLBACK;
          RAISE;   
END;
/
EXIT;
