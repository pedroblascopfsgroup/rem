--/*
--##########################################
--## AUTOR=Daniel Algaba
--## FECHA_CREACION=20211110
--## ARTEFACTO=batch
--## VERSION_ARTEFACTO=9.3
--## INCIDENCIA_LINK=HREOS-16321
--## PRODUCTO=NO
--##
--## Finalidad: 
--## INSTRUCCIONES:
--## VERSIONES:
--##        0.1 Versión inicial
--##########################################
--*/

WHENEVER SQLERROR EXIT SQL.SQLCODE;
SET SERVEROUTPUT ON; 
SET DEFINE OFF;


DECLARE
    V_MSQL VARCHAR2(32000 CHAR); -- Sentencia a ejecutar     
    V_ESQUEMA VARCHAR2(25 CHAR):= '#ESQUEMA#'; -- Configuracion Esquema
    V_ESQUEMA_M VARCHAR2(25 CHAR):= '#ESQUEMA_MASTER#'; -- Configuracion Esquema Master
    V_SQL VARCHAR2(4000 CHAR); -- Vble. para consulta que valida la existencia de una tabla.
    V_NUM_TABLAS NUMBER(16); -- Vble. para validar la existencia de una tabla.   
    ERR_NUM NUMBER(25);  -- Vble. auxiliar para registrar errores en el script.
    ERR_MSG VARCHAR2(1024 CHAR); -- Vble. auxiliar para registrar errores en el script.
    V_ID NUMBER(16); -- Vble. auxiliar para almacenar temporalmente el numero de la sequencia.
    V_TEXT_TABLA VARCHAR2(2400 CHAR) := 'BIE_LOCALIZACION'; -- Vble. auxiliar para almacenar el nombre de la tabla de ref.

    TYPE T_TIPO_DATA IS TABLE OF VARCHAR2(150);
    TYPE T_ARRAY_DATA IS TABLE OF T_TIPO_DATA;
    V_TIPO_DATA T_ARRAY_DATA := T_ARRAY_DATA(
      T_TIPO_DATA('0001','89001425','08223','TERRASSA','C/TURIA Nº 2, 7º 4ª','','',''),
      T_TIPO_DATA('0015','89006658','17300','BLANES','AVDA. EUROPA, 19, ESC. B, BX-2, PK 14-15','','','00003'),
      T_TIPO_DATA('0015','89006660','17300','BLANES','EUROPA','','19','00003'),
      T_TIPO_DATA('0015','89006849','46758','GANDIA','CL BASSES 4','','',''),
      T_TIPO_DATA('0015','89006947','28021','MADRID','C/ GODELLA, 35,37,39 Y 41','','','00007'),
      T_TIPO_DATA('0015','89006993','08225','TERRASSA','CARRETERA DE MATADEPERA 151 APARC. 23','','','00007'),
      T_TIPO_DATA('0015','89006996','08225','TERRASSA','CARRETERA DE MATADEPERA 151 3?4?','','','00007'),
      T_TIPO_DATA('0001','89002422','36960','SANXENXO','c/forjan-adigna s/n','','','00007'),
      T_TIPO_DATA('0001','89002476','08620','SANT VICENÇ DELS HORTS','PIRINEUS 3','','','00007'),
      T_TIPO_DATA('0001','89002481','07420','POBLA (SA)','FRED 1','','','00007'),
      T_TIPO_DATA('0015','89007742','25005','LLEIDA','CORTS CATALANES 23','','','00007'),
      T_TIPO_DATA('0001','89000826','18014','ALHAMA DE GRANADA','PRDTA.J.MA.CARULLA, 10 3º A','','',''),
      T_TIPO_DATA('0001','89002547','38320','SAN CRISTÓBAL DE LA LAGUNA','NARCISO DE VERA (ED. TAMAIMO)','','91','00007'),
      T_TIPO_DATA('0015','89008278','17411','VIDRERES','URB. AIGUAVIVA. PARK. PARCEL.LA ZA-8','','','00007'),
      T_TIPO_DATA('0001','89000234','28981','PARLA','jerusale 8  2  a','','',''),
      T_TIPO_DATA('0001','89002582','28350','CIEMPOZUELOS','CARETOS 1','','1-C',''),
      T_TIPO_DATA('0001','89000274','08269','NAVÀS','EDIFICI ESCOLES CONVENT','','',''),
      T_TIPO_DATA('0015','89008787','46530','PUÇOL','CL JOSE ALFONSO,5 5','','',''),
      T_TIPO_DATA('0001','89002606','17600','FIGUERES','VERGE 12','','','00007'),
      T_TIPO_DATA('0015','89008852','35509','ARRECIFE','CORBETA 44 PLAYA HONDA','','44','00007'),
      T_TIPO_DATA('0015','89008859','21730','ALMONTE','OTROS SECTOR P LC2','','','00007'),
      T_TIPO_DATA('0001','89002622','35627','PÁJARA','FUENTE DE HIJA 8 PTA. 5','','','00007'),
      T_TIPO_DATA('0001','89001694','12004','CASTELLÓN DE LA PLANA/CASTELLÓ DE LA PLA','CL MAESTRO ALBENIZ 9-1-A','','',''),
      T_TIPO_DATA('0015','89009511','43713','SANT JAUME DELS DOMENYS','LLORET DE AUSTRALIA, 7- CASA','','','00007'),
      T_TIPO_DATA('0001','89001732','08530','GARRIGA (LA)','C/. PINS, 20   BAIXOS 1ª','','',''),
      T_TIPO_DATA('0001','89002764','46710','GANDIA','CL PARTIDA RODAFAM 58 0','','','00007'),
      T_TIPO_DATA('0001','89001781','35107','SAN BARTOLOMÉ DE TIRAJANA','JUAN ORTEGA GUEDES 22','','',''),
      T_TIPO_DATA('0015','89010293','17600','FIGUERES','C/ COMPOSITOR SERRA Nº 6  2-1 00005','','','00007'),
      T_TIPO_DATA('0001','89002787','46760','TAVERNES DE LA VALLDIGNA','CL DE LES FONTETES DE CANTUS 19','','','00007'),
      T_TIPO_DATA('0015','89010336','08187','GRANOLLERS','CL MARE DE DEU DEL ROSER S/N','','',''),
      T_TIPO_DATA('0015','89010340','08187','GRANOLLERS','CL MARE DE DEU DEL ROSER S/N','','',''),
      T_TIPO_DATA('0001','89002796','43202','REUS','LEON 3','','','00007'),
      T_TIPO_DATA('0001','89002799','07011','PALMA','JOAN MUNTANER I BUJOSA 2','','','00007'),
      T_TIPO_DATA('0015','89010457','41120','DOS HERMANAS','CL JUAN SEABSTIAN EL CANO , 5 5 0 5','','','00007'),
      T_TIPO_DATA('0015','89010807','43840','VILA-SECA','RESCAT 11','','','00007'),
      T_TIPO_DATA('0015','89010900','08880','CUBELLES','C/ Sumella, 32','','','00007'),
      T_TIPO_DATA('0015','89010907','08880','CUBELLES','C/ Sumella, 32','','','00007'),
      T_TIPO_DATA('0015','89010910','08880','CUBELLES','C/ Sumella, 32 Bajos 2ª','','','00007'),
      T_TIPO_DATA('0001','89002843','08800','VILANOVA I LA GELTRÚ','C/ Hernani, 13 bis nº 1','','','00007'),
      T_TIPO_DATA('0001','89002853','45211','RECAS','CL C 000','','','00007'),
      T_TIPO_DATA('0015','89011369','40190','BERNUY DE PORREROS','REAL 46','','','00007'),
      T_TIPO_DATA('0015','89011373','40190','BERNUY DE PORREROS','REAL 46','','','00007'),
      T_TIPO_DATA('0015','89011381','40190','BERNUY DE PORREROS','REAL 46','','','00007'),
      T_TIPO_DATA('0015','89011385','40190','BERNUY DE PORREROS','REAL 46','','','00007'),
      T_TIPO_DATA('0015','89011388','40190','BERNUY DE PORREROS','REAL 46','','','00007'),
      T_TIPO_DATA('0015','89011392','40190','BERNUY DE PORREROS','REAL 46','','','00007'),
      T_TIPO_DATA('0001','89001903','17310','LLORET DE MAR','C/POTOSI S/N LOCAL P.B. 2','','',''),
      T_TIPO_DATA('0015','89011475','46727','REAL DE GANDÍA','GANDÍA 42','','','00003'),
      T_TIPO_DATA('0001','89002909','28232','ROZAS DE MADRID (LAS)','PASAJE S 10-A POLIGONO INDUSTRIAL EUROPOLIS SECT PASAJE S 10','','','00021'),
      T_TIPO_DATA('0001','89001067','08191','RUBÍ','san jorge 32','','',''),
      T_TIPO_DATA('0001','89001068','08191','RUBÍ','buenaventura josa s/n easc a 1 3','','',''),
      T_TIPO_DATA('0001','89002943','17600','FIGUERES','TARRAGONA 2','','','00007'),
      T_TIPO_DATA('0015','89011821','43205','REUS','BAHIA BLANCA 2','','','00007'),
      T_TIPO_DATA('0015','89011824','43205','REUS','BAHIA BLANCA 2-4-6','','','00007'),
      T_TIPO_DATA('0015','89012016','29639','BENALMÁDENA','TORCAL (HACIENDA LA PALOMA) 29','','','00007'),
      T_TIPO_DATA('0015','89012018','29639','BENALMÁDENA','RESIDENCIAL BENALMAR XXI SN','','','00007'),
      T_TIPO_DATA('0001','89001949','23370','ORCERA','AL ALDEA VALDEMARÍN BAJO 1 0','','',''),
      T_TIPO_DATA('0001','89001950','23370','ORCERA','AL VALDEMARIN 1 0','','',''),
      T_TIPO_DATA('0001','89002976','35530','TEGUISE','1','','',''),
      T_TIPO_DATA('0015','89012260','07004','PALMA','A BUNYOLA 4','','',''),
      T_TIPO_DATA('0001','89012362','04620','VERA','AL CA#ADA SAN JULIAN 000 0','','','00007'),
      T_TIPO_DATA('0015','89012394','08211','CASTELLAR DEL VALLÈS','prat de la riba 30','','','00007'),
      T_TIPO_DATA('0015','89012485','41003','SEVILLA','Alberto Lista 5','','','00007'),
      T_TIPO_DATA('0001','89003008','28340','VALDEMORO','ANDALUCIA 5','','','00003'),
      T_TIPO_DATA('0015','89012565','38108','ROSARIO (EL)','EL SORONDONGO 2','','','00007'),
      T_TIPO_DATA('0001','89003034','35330','TEROR','Presbítero Antonio Guerra','','','00007'),
      T_TIPO_DATA('0001','89003041','28053','MADRID','CORDILLERA DE CUERA 3','','','00007'),
      T_TIPO_DATA('0015','89012873','28590','VILLAREJO DE SALVANÉS','C/LIRIOS 2, 2º A','','',''),
      T_TIPO_DATA('0001','89003050','35629','TUINEJE','TAMARETILLA 18 VVDA. 3','','','00007'),
      T_TIPO_DATA('0015','89013145','41927','MAIRENA DEL ALJARAFE','MAR BALTICO, URB SIMON VERDE 13','','','00007'),
      T_TIPO_DATA('0015','89013149','41927','MAIRENA DEL ALJARAFE','PLAZA DE GARAGE 00005','','','00007'),
      T_TIPO_DATA('0015','89013151','41927','MAIRENA DEL ALJARAFE','SIMON VERDE 13 C ESC 2 00005','','','00007'),
      T_TIPO_DATA('0015','89013154','07680','MANACOR','ECONOMO PEDRO GELABERT 64','','','00007'),
      T_TIPO_DATA('0015','89013155','07500','MANACOR','C/ ECONOMO PEDRO GELABERT, 62','','','00007'),
      T_TIPO_DATA('0001','89002063','23370','ORCERA','Valdemarín, término municipal de Orcera','','',''),
      T_TIPO_DATA('0001','89002064','23370','ORCERA','LOS CANTONES, término municipal de ORCERA','','',''),
      T_TIPO_DATA('0001','89002065','23370','ORCERA','EL CISCAL, DE ORCERA','','',''),
      T_TIPO_DATA('0001','89002066','23370','ORCERA','EL CISCALILLO, término municipal de ORCERA','','',''),
      T_TIPO_DATA('0001','89002068','23370','ORCERA','LOS PRADOS, término municipal de ORCERA','','',''),
      T_TIPO_DATA('0001','89002070','12320','SANT JORDI/SAN JORGE','AL GOLF PANORAMICA 1, CONJUNTO RESIDENCIAL SAN JORGE','','',''),
      T_TIPO_DATA('0001','89002090','46980','PATERNA','CL SANTISSIM CRIST DE LA FE 23','','',''),
      T_TIPO_DATA('0015','89013367','02006','ALBACETE','DEL AMANECER esquina Calle ACUARIO 15','','','00007'),
      T_TIPO_DATA('0001','89003119','04621','VERA','CAÑADA DE JULIAN','','',''),
      T_TIPO_DATA('0001','89002100','29630','BENALMÁDENA','Entidad número cuarenta y dos, vivienda H-1, del portal dos,','','',''),
      T_TIPO_DATA('0015','89013448','28350','CIEMPOZUELOS','LAS MORERAS 4','','','00007'),
      T_TIPO_DATA('0001','89003146','46021','VALENCIA','REPUBLICA ARGENTINA 3','','','00007'),
      T_TIPO_DATA('0001','89003164','45500','TORRIJOS','AVDA PLAZA DE TOROS 4, 3ºA 00004','','','00003'),
      T_TIPO_DATA('0015','89013983','35110','SANTA LUCÍA DE TIRAJANA','LENTINI 3','','','00007'),
      T_TIPO_DATA('0015','89014073','15174','CULLEREDO','A Zapateira, Parcela 212 del Polígono 16 de Culleredo','','',''),
      T_TIPO_DATA('0015','89014080','15174','CULLEREDO','A ZAPATEIRA PARCELA 205 DEL POLIGONO 16 DE CULLEREDO','','',''),
      T_TIPO_DATA('0015','89014287','28915','LEGANÉS','DEL REY JUAN CARLOS I. 63','','','00003'),
      T_TIPO_DATA('0015','89014426','45190','NAMBROCA','VVDA UNIFAMILIAR AISLADA PAR 55 MANZANA4','','',''),
      T_TIPO_DATA('0001','89002197','46520','SAGUNTO/SAGUNT','c. teodoro llorente, 167 8','','',''),
      T_TIPO_DATA('0001','89003239','08186','GRANOLLERS','GAVINA 1 W','','','00007'),
      T_TIPO_DATA('0001','89001320','28770','COLMENAR VIEJO','DEL MADROÑO','','','00007'),
      T_TIPO_DATA('0001','89001321','28770','COLMENAR VIEJO','DEL MADROÑO','','','00007'),
      T_TIPO_DATA('0015','89014515','28770','COLMENAR VIEJO','DEL MADROÑO','','','00007'),
      T_TIPO_DATA('0015','89014517','28770','COLMENAR VIEJO','DEL MADROÑO','','','00007'),
      T_TIPO_DATA('0015','89014522','28770','COLMENAR VIEJO','DEL MADROÑO','','','00007'),
      T_TIPO_DATA('0015','89014526','28770','COLMENAR VIEJO','MADROÑO','','','00041'),
      T_TIPO_DATA('0015','89014534','28041','MADRID','RESINA, PARCELAS 1.1.6.N','','','00007'),
      T_TIPO_DATA('0001','89003258','08830','SANT BOI DE LLOBREGAT','CAMPS BLANCS 126-127.','','','00007'),
      T_TIPO_DATA('0001','89003259','08830','SANT BOI DE LLOBREGAT','CAMPS BLANCS 126-127','','','00007'),
      T_TIPO_DATA('0001','89014716','31560','AZAGRA','CL MAYOR 33','','','00007'),
      T_TIPO_DATA('0015','89014720','17310','LLORET DE MAR','PASSAPERA 17','','','00007'),
      T_TIPO_DATA('0001','89002225','07184','CALVIÀ','CL AV/MALLORCA GOLF DE BENDINAT 170','','',''),
      T_TIPO_DATA('0001','89002226','07184','CALVIÀ','CL AV/MALLORCA 17 GOLF DE BENDINA 17 0','','',''),
      T_TIPO_DATA('0001','89002227','07184','CALVIÀ','CL AV/MALLORCA 17, GOLF DE BENDIN 17 0','','',''),
      T_TIPO_DATA('0001','89003277','12200','ONDA','rio turia 11 00011','','','00007'),
      T_TIPO_DATA('0015','89014839','29320','CAMPILLOS','CAMINO SAUCEJO, PLAN UR-1, NAVE 70','','',''),
      T_TIPO_DATA('0015','89014858','11130','CHICLANA DE LA FRONTERA','DE VILLAMARTIN SN','','','00009'),
      T_TIPO_DATA('0015','89014898','16410','HORCAJO DE SANTIAGO','VIRGEN DE LAS ANGUSTIAS 2','','','00007'),
      T_TIPO_DATA('0015','89014905','16410','HORCAJO DE SANTIAGO','VIRGEN DE LAS ANGUSTIAS 2','','','00007'),
      T_TIPO_DATA('0015','89014958','46192','CARLET','TRAS LA SIERRA,POLIGONO 22 PARCELA 558','','','00007'),
      T_TIPO_DATA('0015','89014973','08130','SANTA PERPÈTUA DE MOGODA','RAMON D?ABADAL 57','','','00007'),
      T_TIPO_DATA('0015','89014986','03700','DÉNIA','PARTIDA REAL  POLIGONO 33 PARCELA 46 SN','','',''),
      T_TIPO_DATA('0015','89015021','46500','SAGUNTO/SAGUNT','VILA A CONILLERA, POLIG 97, PARC 69 Y 70 SN','','',''),
      T_TIPO_DATA('0015','89015057','08902','HOSPITALET DE LLOBREGAT (L'''')','calle de la uva','','54',''),
      T_TIPO_DATA('0001','89003316','08410','MONTORNÈS DEL VALLÈS','SIS DE DECEMBRE','','','00007'),
      T_TIPO_DATA('0001','89003332','17600','FIGUERES','MARIGNANE 28','','','00003'),
      T_TIPO_DATA('0015','89015532','45600','TALAVERA DE LA REINA','INDUSTRIAL TORREHIERRO PARCELA 34 SN','','','00080'),
      T_TIPO_DATA('0015','89015775','25600','BALAGUER','LLEIDA 1  1º IZDA','','',''),
      T_TIPO_DATA('0001','89003357','17310','LLORET DE MAR','URB. STA. CLOTILDE, PARCELA 16 TRAS','','','00007'),
      T_TIPO_DATA('0001','89003359','08635','MARTORELL','MASIA BACH, PARCELA 3-M SN','','','00041'),
      T_TIPO_DATA('0001','89003360','08635','SANTA COLOMA DE FARNERS','MASIA BACH, PARCELA 2-M SN','','','00007'),
      T_TIPO_DATA('0001','89003363','08635','SANT ESTEVE SESROVIRES','MASIA BACH, CALLE L, PARCELA 2HHP 25','','','00080'),
      T_TIPO_DATA('0001','89003364','08635','SANT ESTEVE SESROVIRES','MASIA BACH, CALLE L, PARCELA 3HHP','','','00080'),
      T_TIPO_DATA('0001','89003365','08635','SANT ESTEVE SESROVIRES','CALLE L','','','00007'),
      T_TIPO_DATA('0001','89003366','08635','SANT ESTEVE SESROVIRES','MASIA BACH.CALLE L   PARCELA 5HHP 19','','','00041'),
      T_TIPO_DATA('0015','89015835','46760','TAVERNES DE LA VALLDIGNA','CL DEL PAPA JOAN XXIII 23 23','','','00007'),
      T_TIPO_DATA('0015','89015939','17412','MAÇANET DE LA SELVA','CALLE ONYAR,123 00123','','','00007'),
      T_TIPO_DATA('0015','89016197','13160','TORRALBA DE CALATRAVA','LA VEGA FASE II','','','00080'),
      T_TIPO_DATA('0015','89016326','08620','SANT VICENÇ DELS HORTS','DEL DALT 21','','','00007'),
      T_TIPO_DATA('0015','89016355','26131','LAGUNILLA DEL JUBERA','ARRABAL 28','','','00007'),
      T_TIPO_DATA('0001','89016357','04638','MOJÁCAR','Calle Finisterre  RESIDENCIAL TERRAZAS DEL GOLF','','','00007'),
      T_TIPO_DATA('0015','89016370','26500','CALAHORRA','RIFONDO R-2D3-4-5 SN','','','00080'),
      T_TIPO_DATA('0015','89016380','03801','ALCOY/ALCOI','VERGE DAGOST','','6','00007'),
      T_TIPO_DATA('0001','89003404','41710','UTRERA','CL cronista manuel morales 6 6','','','00007'),
      T_TIPO_DATA('0001','89003406','12540','VILA-REAL','CL Vicent Amoros 55 55','','','00007'),
      T_TIPO_DATA('0015','89016456','28034','MADRID','AFUERAS A VALVERDE 21','','','00007'),
      T_TIPO_DATA('0001','89003408','17006','GIRONA','C/MONTSENY 77 ENTLO.2.','','','00007'),
      T_TIPO_DATA('0015','89016475','28053','MADRID','PUERTO DE BALBARAN 11','','','00007'),
      T_TIPO_DATA('0001','89003431','17242','QUART','SANT FELIU, POLIGON PLA DE L''''ILLA 3','','','00011'),
      T_TIPO_DATA('0015','89016642','41015','SEVILLA','camino de los toros 5 4-b','','','00007'),
      T_TIPO_DATA('0015','89016745','08186','LLIÇÀ D''''AMUNT','ANSELM CLAVE 4,6 Y 8','','','00007'),
      T_TIPO_DATA('0001','89016787','08700','IGUALADA','TRINITAT','','7','00007'),
      T_TIPO_DATA('0015','89016806','05412','SAN ESTEBAN DEL VALLE','PARAJE PEDRERA 1','','',''),
      T_TIPO_DATA('0001','89003453','28031','MADRID','Fuentespina 35','','','00007'),
      T_TIPO_DATA('0015','89016841','43205','REUS','AV PAÏSOS CATALANS 166','','','00007'),
      T_TIPO_DATA('0001','89003465','16500','HUETE','C/CHORRO, 17 17','','','00007'),
      T_TIPO_DATA('0015','89016926','17410','SILS','ANTONI GAUDI 27','','','00007'),
      T_TIPO_DATA('0015','89016939','41008','SEVILLA','REAL DE LA JARA 12','','','00007'),
      T_TIPO_DATA('0015','89016990','17230','PALAMÓS','ROGER DE LLURIA, S/N, BAJOS 1','','','00007'),
      T_TIPO_DATA('0001','89003482','06200','ALMENDRALEJO','LA PAZ 3','','','00003'),
      T_TIPO_DATA('0015','89017035','40560','FUENTERREBOLLO','GENERALISMO 43','','','00003'),
      T_TIPO_DATA('0015','89017050','13005','CIUDAD REAL','ctra.carrion calatrava, 6 bq 1 pt 2 3 A','','','00007'),
      T_TIPO_DATA('0015','89017061','18512','GUADIX','LAS LOMAS CORTIJO LA PESETILLA','','POL','00007'),
      T_TIPO_DATA('0015','89017064','18512','GUADIX','RAMBLA DE GOBERNADOR CORTIJO LA PESETILLA','','POL','00007'),
      T_TIPO_DATA('0015','89017068','18512','GUADIX','SITIO DE BENITO CORTIJO LA PESETILLA','','POL','00007'),
      T_TIPO_DATA('0015','89017069','11100','SAN FERNANDO','JUAN RAMON JIMENEZ 00003','','','00007'),
      T_TIPO_DATA('0015','89017080','41006','SEVILLA','LEBRELES  1','','','00007'),
      T_TIPO_DATA('0015','89017145','46023','VALENCIA','BALEARES 63','','','00003'),
      T_TIPO_DATA('0015','89017164','45900','ALMOROX','VALCARRILLO 59','','','00041'),
      T_TIPO_DATA('0001','89003516','35625','PÁJARA','TAIFA','','4','00007'),
      T_TIPO_DATA('0001','89003527','30520','JUMILLA','ECHEGARAY SN','','','00007'),
      T_TIPO_DATA('0015','89017261','45593','BARGAS','Avenida Pardo, 5 3-A','','','00007'),
      T_TIPO_DATA('0015','89017280','03739','JÁVEA/XÀBIA','CANCAMSALADES UMBRIA MANZANA 13','','',''),
      T_TIPO_DATA('0015','89017292','07010','PALMA','PUIG DE ALARO 12','','','00007'),
      T_TIPO_DATA('0015','89017322','08640','OLESA DE MONTSERRAT','Sant Jose Oriol 20','','','00007'),
      T_TIPO_DATA('0015','89017332','28140','FUENTE EL SAZ DE JARAMA','AVDA DEL PILAR 32 32','','','00007'),
      T_TIPO_DATA('0015','89017359','11100','SAN FERNANDO','SAN MIGUEL 11','','','00007'),
      T_TIPO_DATA('0001','89003541','03010','ALICANTE/ALACANT','ceramica y olof palme, n 4 00088','','','00007'),
      T_TIPO_DATA('0001','89003544','17487','CASTELLÓ D''''EMPÚRIES','FLAMICELL  30','','','00022'),
      T_TIPO_DATA('0015','89017447','11407','JEREZ DE LA FRONTERA','CL. RACIMO Nº 4 7D; POL.S, BENITO','','','00007'),
      T_TIPO_DATA('0015','89017483','41830','HUÉVAR DEL ALJARAFE','ROSALIA DE CASTRO 15','','','00007'),
      T_TIPO_DATA('0015','89017491','30600','ARCHENA','ALFONSO X EL SABIO 00015','','','00007'),
      T_TIPO_DATA('0015','89017513','05480','CANDELEDA','ROSALIA DE CASTRO 4','','4','00007'),
      T_TIPO_DATA('0015','89017516','11402','JEREZ DE LA FRONTERA','BIZCOCHEROS 2','','','00007'),
      T_TIPO_DATA('0015','89017609','28630','VILLA DEL PRADO','RAMON Y CAJAL 1','','','00007'),
      T_TIPO_DATA('0015','89017656','19174','VALDEAVERUELO','ENCINAS 55','','','00007'),
      T_TIPO_DATA('0001','89003582','35600','PUERTO DEL ROSARIO','Pelayo, nº 6, Sótano, Parking','','','00007'),
      T_TIPO_DATA('0001','89003583','35600','PUERTO DEL ROSARIO','PELAYO 6','','','00007'),
      T_TIPO_DATA('0015','89017761','08227','TERRASSA','CL PAU CASALS 8','','','00007'),
      T_TIPO_DATA('0015','89017790','41300','RINCONADA (LA)','FRANCISCO RIVERA PAQUIRRI, 2, 1ºA 00002','','','00007'),
      T_TIPO_DATA('0015','89017799','40500','RIAZA','CL LA CAVA 16 00016','','','00007'),
      T_TIPO_DATA('0001','89017812','07660','FELANITX','dels comellars','','','00007'),
      T_TIPO_DATA('0001','89003611','45310','VILLATOBAS','culebrina, 7','','','00007'),
      T_TIPO_DATA('0015','89017851','28691','VILLANUEVA DE LA CAÑADA','VIENTO 14','','','00007'),
      T_TIPO_DATA('0015','89017854','11300','LÍNEA DE LA CONCEPCIÓN (LA)','GRANADA 54','','','00007'),
      T_TIPO_DATA('0015','89017857','17256','PALS','CALLE DALT 4','','','00007'),
      T_TIPO_DATA('0001','89003613','03730','JÁVEA/XÀBIA','CL UMBRIA CANSALADES SECTOR A 000 0','','','00007'),
      T_TIPO_DATA('0015','89017897','12170','SANT MATEU','ILDEFONSO ALEU 13 FASE V D-6','','','00007'),
      T_TIPO_DATA('0001','89003622','28850','TORREJÓN DE ARDOZ','CHILE 2','','','00007'),
      T_TIPO_DATA('0015','89017922','28029','MADRID','CAPITAN BLANCO ARGIBAY 174','','','00007'),
      T_TIPO_DATA('0015','89017952','45180','SESEÑA','C/ ARTESA, 28 00028','','','00007'),
      T_TIPO_DATA('0001','89003633','08700','IGUALADA','C/ Santa Ana, 11, 4º','','','00007'),
      T_TIPO_DATA('0015','89017971','41006','SEVILLA','CL COSTA Y LLOBERA 81','','','00007'),
      T_TIPO_DATA('0015','89017986','45291','COBEJA','ALMIBAR, 2, 2º A','','','00007'),
      T_TIPO_DATA('0015','89018045','28850','TORREJÓN DE ARDOZ','pamplona 5','','','00007'),
      T_TIPO_DATA('0015','89018069','04648','PULPÍ','SAGITARIO 2','','','00007'),
      T_TIPO_DATA('0015','89018115','35420','MOYA','CUEVAS DE SAN BARTOLOME 10','','','00080'),
      T_TIPO_DATA('0015','89018134','35018','PALMAS DE GRAN CANARIA (LAS)','JERUSALEN 24','','','00007'),
      T_TIPO_DATA('0015','89018147','07760','CIUTADELLA DE MENORCA','SANT JORDI','','','00039'),
      T_TIPO_DATA('0015','89018154','46370','CHIVA','HORNO DE ABAJO 13','','','00007'),
      T_TIPO_DATA('0001','89003653','17800','OLOT','MOSSEN JACINT VERDAGUER 10','','','00007'),
      T_TIPO_DATA('0015','89018257','28903','GETAFE','CACERES','','','00007'),
      T_TIPO_DATA('0001','89003662','29631','BENALMÁDENA','SANTANGELO NORTE, SECTOR SP-2 PARCELA P-19 SN','','','00041'),
      T_TIPO_DATA('0015','89018291','08402','GRANOLLERS','C/CALDERON DE LA BARCA, 2-4 1ºC','','','00007'),
      T_TIPO_DATA('0015','89018293','08401','GRANOLLERS','AVDA. SAN ESTEBAN, 18 2ºA','','','00007'),
      T_TIPO_DATA('0001','89003679','04620','VERA','AL PARCELA 7, P.P.RC-5E 000','','','00007'),
      T_TIPO_DATA('0015','89018407','03450','BANYERES DE MARIOLA','PARTIDA MOLINO DE FORCALL Nº 35','','','00007'),
      T_TIPO_DATA('0001','89003683','12005','CASTELLÓN DE LA PLANA/CASTELLÓ DE LA PLA','VALENCIA 43','','','00003'),
      T_TIPO_DATA('0001','89003692','46980','PATERNA','CIUDAD REAL','','','00007'),
      T_TIPO_DATA('0015','89018493','28027','MADRID','DONOSTIARRA 1','','','00003'),
      T_TIPO_DATA('0015','89018500','28850','TORREJÓN DE ARDOZ','calle virgen del pilar 11 5 dcha','','','00007'),
      T_TIPO_DATA('0001','89018539','04770','ADRA','Fabricas o Carretera Nacional N-340','','','00007'),
      T_TIPO_DATA('0001','89003708','41927','MAIRENA DEL ALJARAFE','calle Toledo 8','','','00007'),
      T_TIPO_DATA('0001','89003712','07181','CALVIÀ','MALLORCA GOLF DE BENDINAT 170','','','00003'),
      T_TIPO_DATA('0001','89003713','07181','CALVIÀ','MALLORCA GOLF DE BENDINAT 170','','','00003'),
      T_TIPO_DATA('0015','89018584','21400','AYAMONTE','CL URBANIZACION COSTA ESURI, RAGO 13 0','','','00007'),
      T_TIPO_DATA('0015','89018594','41702','DOS HERMANAS','VEINTIOCHO DE FEBRERO  nº8, Locales 7 y 10. 110','','','00003'),
      T_TIPO_DATA('0015','89018596','41702','DOS HERMANAS','VEINTIOCHO DE FEBRERO  nº8, Locales 7 y 10. 8','','','00003'),
      T_TIPO_DATA('0015','89018615','41530','MORÓN DE LA FRONTERA','C/ JAZMIN, 4','','','00007'),
      T_TIPO_DATA('0001','89018620','03330','CREVILLENT','MEDITERRANI','','3','00007'),
      T_TIPO_DATA('0001','89018622','46400','CULLERA','LA PAZ','','12','00007'),
      T_TIPO_DATA('0001','89018633','28047','MADRID','ALEJANDRINA MORÁN','','15','00007'),
      T_TIPO_DATA('0001','89018636','39200','REINOSA','GENERAL MOLA','','27','00007'),
      T_TIPO_DATA('0001','89018641','39011','SANTANDER','ACACIAS I','','24','00007'),
      T_TIPO_DATA('0001','89018644','21550','PUEBLA DE GUZMÁN','CABEZO','','60','00007'),
      T_TIPO_DATA('0001','89018647','12540','VILA-REAL','LLEO XIII','','91','00007'),
      T_TIPO_DATA('0001','89018650','23330','VILLANUEVA DEL ARZOBISPO','GOLETA','','7','00007'),
      T_TIPO_DATA('0001','89018652','30500','MOLINA DE SEGURA','MASEGOSA','','40','00007'),
      T_TIPO_DATA('0001','89018655','30500','MOLINA DE SEGURA','MASEGOSA','','40','00007'),
      T_TIPO_DATA('0001','89018658','46011','VALENCIA','PADRE VELASCO','','9','00007'),
      T_TIPO_DATA('0001','89018664','35500','ARRECIFE','PARANA','','9','00007'),
      T_TIPO_DATA('0001','89018665','35500','ARRECIFE','PARANA','','9',''),
      T_TIPO_DATA('0001','89018667','35500','ARRECIFE','PARANA','','9','00007'),
      T_TIPO_DATA('0001','89018677','46164','PEDRALBA','VILLAMARCHANTE','','62',''),
      T_TIPO_DATA('0001','89018681','46164','PEDRALBA','VILAMARCHANTE','','62','00007'),
      T_TIPO_DATA('0001','89018684','41710','UTRERA','CIBELES','','7','00007'),
      T_TIPO_DATA('0015','89018701','35013','PALMAS DE GRAN CANARIA (LAS)','PARQUE CENTRAL 11','','','00003'),
      T_TIPO_DATA('3148','89018734','46900','TORRENT','','','','00007'),
      T_TIPO_DATA('0015','89018752','46700','GANDIA','CADI','','','00007'),
      T_TIPO_DATA('0015','89018754','46700','GANDIA','ALCADI','','','00007'),
      T_TIPO_DATA('0001','89003722','45224','YUNCOS','FELIPE II 11','','','00007'),
      T_TIPO_DATA('0015','89018783','26258','CIRUEÑA','LA RIOJA 112','','','00041'),
      T_TIPO_DATA('0001','89003732','01008','VITORIA-GASTEIZ','ADRIANO VI 14','','','00007'),
      T_TIPO_DATA('0001','89003737','07008','PALMA','PICO DE ALMANZOR','','3','00007'),
      T_TIPO_DATA('0015','89018854','26124','RASILLO DE CAMEROS (EL)','SOMERA 25','','','00007'),
      T_TIPO_DATA('0015','89018862','28017','MADRID','salinas 4 b izda 4','','','00007'),
      T_TIPO_DATA('0001','89003743','12590','ALMENARA','RESIDENCIAL PONT DE L''''ARENA (PACELA 4) SN','','','00041'),
      T_TIPO_DATA('0001','89003744','28350','CIEMPOZUELOS','SECTOR S19B 9','','','00080'),
      T_TIPO_DATA('0015','89018896','41006','SEVILLA','Aguila Perdicera  4','','','00007'),
      T_TIPO_DATA('0001','89003753','07007','PALMA','CARDENAL ROSSELL 100','','','00007'),
      T_TIPO_DATA('0015','89018945','07500','MANACOR','PARE ANDREU FERNANDEZ 8','','','00007'),
      T_TIPO_DATA('0015','89018948','26120','ALBELDA DE IREGUA','RIO MIGUEL','','','00007'),
      T_TIPO_DATA('0015','89018951','26120','ALBELDA DE IREGUA','RIO MIGUEL','','4','00007'),
      T_TIPO_DATA('0001','89003759','11205','ALGECIRAS','JARDINES DEL ROCIO','','',''),
      T_TIPO_DATA('0001','89003760','11205','ALGECIRAS','JARDINES DEL ROCIO','','',''),
      T_TIPO_DATA('0015','89018993','28821','COSLADA','CALLE TRAFALGAR 2 2','','-','00007'),
      T_TIPO_DATA('0015','89018995','07011','PALMA','C/CAP BLANC, 5, ESC. 5 PLT 1 PT A 9 00005','','','00007'),
      T_TIPO_DATA('0001','89003764','46700','GANDIA','PARC DE LA ESTACIO 2','','','00025'),
      T_TIPO_DATA('0001','89003766','46440','VALENCIA','llauradors 56','','','00007'),
      T_TIPO_DATA('0015','89019075','28980','PARLA','C/LEGANES 29,4B','','','00007'),
      T_TIPO_DATA('0001','89003774','07200','FELANITX','CL RAFAL MULI O MARINA 336 0','','','00007'),
      T_TIPO_DATA('0001','89003782','08290','MONTCADA I REIXAC','CONRERIA 41','','','00007'),
      T_TIPO_DATA('0015','89019117','38300','OROTAVA (LA)','Leonor Monteverde, Edificio Acevi?o 25','','','00041'),
      T_TIPO_DATA('0015','89019132','46017','VALENCIA','CANÓNIGO ROGELIO CHILLIDA 9','','','00025'),
      T_TIPO_DATA('0001','89003791','08495','FOGARS DE LA SELVA','URB. REGENTS PARK, PARC 125','','','00041'),
      T_TIPO_DATA('0001','89003799','41320','CANTILLANA','NUESTRA SEÑORA DE LA SOLIDAD 38','','1','00003'),
      T_TIPO_DATA('0001','89003800','41320','CANTILLANA','NUESTRA SEÑORA DE LA SOLIDAD 38','','1','00003'),
      T_TIPO_DATA('0015','89019210','17004','GIRONA','GIRONA, CRTA. BARCELONA 129-133 PARKING 80','','','00007'),
      T_TIPO_DATA('0001','89003805','17480','ROSES','POETA MARQUINA 9','','','00007'),
      T_TIPO_DATA('0001','89003810','17220','SANT FELIU DE GUÍXOLS','CL ERES 78','','','00007'),
      T_TIPO_DATA('0001','89003812','33600','MIERES','CLARA CAMPOAMOR 8','','','00007'),
      T_TIPO_DATA('0001','89003816','28901','GETAFE','FUENLABRADA 19','','','00007'),
      T_TIPO_DATA('0001','89003838','35400','ARUCAS','ALCALDE SUAREZ FRANCHY 15','','','00007'),
      T_TIPO_DATA('0001','89003845','46025','VALENCIA','MONTDUVER 17','','','00007'),
      T_TIPO_DATA('0015','89020706','04850','CANTORIA','EL PULPITO','','',''),
      T_TIPO_DATA('0015','89022762','05002','ÁVILA','Nuestra Sra Sonsoles 4','','','00007'),
      T_TIPO_DATA('0015','89022767','28053','MADRID','CALLE CAMPIÑA 16','','','00007'),
      T_TIPO_DATA('0015','89022788','17300','BLANES','CARRER ESMERALDA 4','','','00007'),
      T_TIPO_DATA('0001','89004668','45910','ALDEA EN CABO','SIERRA DE ANTEQUERA 375','','','00007'),
      T_TIPO_DATA('0001','89004676','08445','CÀNOVES I SAMALÚS','LLUIS MILLET 73','','','00007'),
      T_TIPO_DATA('0015','89022880','03140','GUARDAMAR DEL SEGURA','LA RAMBLA 22','','','00007'),
      T_TIPO_DATA('0015','89022883','04716','EJIDO (EL)','JOSE MIRA 12','','','00007'),
      T_TIPO_DATA('0015','89022933','46114','VINALESA','ROLL DEL CARRAIXET 2','','','00022'),
      T_TIPO_DATA('0015','89022936','46113','MONCADA','ROLL DEL CARRAIXET 17','','','00022'),
      T_TIPO_DATA('0015','89022959','12596','TORREBLANCA','L ALJUB 71','','','00007'),
      T_TIPO_DATA('0015','89023111','08922','SANTA COLOMA DE GRAMENET','SAN JOAQUIN 123','','','00007'),
      T_TIPO_DATA('0001','89004706','30740','SAN PEDRO DEL PINATAR','VALLE DE ANDORRA 2013','','','00007'),
      T_TIPO_DATA('0001','89004708','04700','EJIDO (EL)','ALMENDRO 3','','','00007'),
      T_TIPO_DATA('0001','89004710','41927','MAIRENA DEL ALJARAFE','HERMANAS MIRABAL T3','','','00007'),
      T_TIPO_DATA('0001','89004711','41927','MAIRENA DEL ALJARAFE','PISA (PARC. T3 DUPLICADO N) SN','','','00041'),
      T_TIPO_DATA('0001','89004712','41220','BURGUILLOS','CARMEN LAFFON 3','','4','00003'),
      T_TIPO_DATA('0015','89023171','46970','ALAQUÀS','calle buenos aires 8','','',''),
      T_TIPO_DATA('0015','89023198','08290','CERDANYOLA DEL VALLÈS','BONA-SORT 38','','','00007'),
      T_TIPO_DATA('0015','89023269','41009','SEVILLA','CAZALLA DE LA SIERRA 9','','','00007'),
      T_TIPO_DATA('0001','89004728','35600','OLIVA (LA)','LA VINAGRERA 7','','','00007'),
      T_TIPO_DATA('0001','89004733','06700','VILLANUEVA DE LA SERENA','ARIAS MONTANO 13','','','00007'),
      T_TIPO_DATA('0001','89004741','07300','INCA','MARE DE DEU DE GRACIA 93','','','00007'),
      T_TIPO_DATA('0015','89023332','03730','JÁVEA/XÀBIA','ausias march 4','','','00007'),
      T_TIPO_DATA('0001','89004748','06200','ALMENDRALEJO','NICOLAS MEGIAS 00000','','','00007'),
      T_TIPO_DATA('0001','89004757','28931','MÓSTOLES','AMERICA 5','','','00007'),
      T_TIPO_DATA('0001','89004760','07350','BINISSALEM','ANSELM TURMEDA -','','','00007'),
      T_TIPO_DATA('0001','89004761','06800','MÉRIDA','Avda. marques de paterna,s/n','','','00007'),
      T_TIPO_DATA('0001','89004772','46970','TORRENT','san juan de ribera 4','','','00007'),
      T_TIPO_DATA('0001','89004777','12500','VINARÒS','PI XII','','','00003'),
      T_TIPO_DATA('0001','89004778','28021','MADRID','Rocafort  64','','','00007'),
      T_TIPO_DATA('0015','89023662','43820','CALAFELL','carrerada d''''en ralet 144','','','00007'),
      T_TIPO_DATA('0001','89004782','41510','MAIRENA DEL ALCOR','CLARA CAMPOAMOR','','','00007'),
      T_TIPO_DATA('0001','89004787','46117','BÉTERA','CL CALLE CHULILLA 1 0','','','00007'),
      T_TIPO_DATA('0015','89023829','41006','SEVILLA','PARROCO ANTONIO GOMEZ VILLALOBOS 4','','','00007'),
      T_TIPO_DATA('0001','89004815','03130','SANTA POLA','ESCANDINAVIA (URB. GRAN ALACANT) 37','','','00003'),
      T_TIPO_DATA('0001','89004027','30360','UNIÓN (LA)','MINA VULCANO','','H1-','00007'),
      T_TIPO_DATA('3148','89018734','46900','TORRENT','MALVARROSA','','','00007')
    ); 
    V_TMP_TIPO_DATA T_TIPO_DATA;

BEGIN	

	DBMS_OUTPUT.PUT_LINE('[INICIO]');


    -- LOOP para insertar los valores --
    DBMS_OUTPUT.PUT_LINE('[INFO]: INSERCION EN '||V_TEXT_TABLA);
    FOR I IN V_TIPO_DATA.FIRST .. V_TIPO_DATA.LAST
      LOOP

        V_TMP_TIPO_DATA := V_TIPO_DATA(I);
       	-- Si no existe se inserta.
          DBMS_OUTPUT.PUT_LINE('[INFO]: INSERTAR EL REGISTRO DEL ACTIVO '''|| TRIM(V_TMP_TIPO_DATA(2)) ||'''');
          V_MSQL := 'MERGE INTO '||V_ESQUEMA||'.'||V_TEXT_TABLA||' BIE_LOC
                      USING (
                          SELECT 
                          BIE_LOC.BIE_LOC_ID
                          , '''||TRIM(V_TMP_TIPO_DATA(5))||''' BIE_LOC_NOMBRE_VIA
                          FROM '||V_ESQUEMA||'.ACT_ACTIVO ACT 
                          JOIN '||V_ESQUEMA||'.BIE_BIEN BIE ON ACT.BIE_ID = BIE.BIE_ID AND BIE.BORRADO = 0
                          LEFT JOIN '||V_ESQUEMA||'.BIE_LOCALIZACION BIE_LOC ON BIE_LOC.BIE_ID = BIE.BIE_ID AND BIE_LOC.BORRADO = 0
                          WHERE ACT.BORRADO = 0
                          AND ACT.ACT_NUM_ACTIVO_CAIXA = '''||TRIM(V_TMP_TIPO_DATA(2))||'''
                      ) AUX
                      ON (BIE_LOC.BIE_LOC_ID = AUX.BIE_LOC_ID)
                      WHEN MATCHED THEN
                      UPDATE SET 
                          BIE_LOC.BIE_LOC_NOMBRE_VIA = NVL(AUX.BIE_LOC_NOMBRE_VIA, BIE_LOC.BIE_LOC_NOMBRE_VIA)
                          , BIE_LOC.USUARIOMODIFICAR = ''HREOS-16321''
                          , BIE_LOC.FECHAMODIFICAR = SYSDATE';
          EXECUTE IMMEDIATE V_MSQL;
          DBMS_OUTPUT.PUT_LINE('[INFO]: REGISTRO INSERTADO CORRECTAMENTE:' || SQL%ROWCOUNT);

      END LOOP;
    COMMIT;
    DBMS_OUTPUT.PUT_LINE('[FIN]: TABLA '||V_TEXT_TABLA||' ACTUALIZADA CORRECTAMENTE ');


EXCEPTION
     WHEN OTHERS THEN
          err_num := SQLCODE;
          err_msg := SQLERRM;

          DBMS_OUTPUT.put_line('[ERROR] Se ha producido un error en la ejecución:'||TO_CHAR(err_num));
          DBMS_OUTPUT.put_line('-----------------------------------------------------------'); 
          DBMS_OUTPUT.put_line(err_msg);

          ROLLBACK;
          RAISE;          

END;

/

EXIT
