--/*
--#########################################
--## AUTOR=VIOREL REMUS OVIDIU
--## FECHA_CREACION=20191111
--## ARTEFACTO=batch
--## VERSION_ARTEFACTO=9.3
--## INCIDENCIA_LINK=REMVIP-5713
--## PRODUCTO=NO
--## 
--## Finalidad: 
--##			
--## INSTRUCCIONES:  
--## VERSIONES:
--##        0.1 Versión inicial
--#########################################
--*/

--Para permitir la visualización de texto en un bloque PL/SQL utilizando DBMS_OUTPUT.PUT_LINE

WHENEVER SQLERROR EXIT SQL.SQLCODE;
SET SERVEROUTPUT ON;
SET DEFINE OFF;

DECLARE
   ERR_NUM NUMBER(25);  -- Vble. auxiliar para registrar errores en el script.
   ERR_MSG VARCHAR2(1024 CHAR); -- Vble. auxiliar para registrar errores en el script.
   V_ESQUEMA VARCHAR2(25 CHAR):= '#ESQUEMA#'; -- Configuracion Esquema
   V_ESQUEMA_M VARCHAR2(25 CHAR):= '#ESQUEMA_MASTER#'; -- Configuracion Esquema Master
   V_USUARIOMODIFICAR VARCHAR(100 CHAR):= 'REMVIP-5713';
   V_PAR VARCHAR( 3200 CHAR );
   V_PAR_2 VARCHAR( 3200 CHAR );
   V_PAR_3 VARCHAR( 3200 CHAR );
   V_RET VARCHAR( 3200 CHAR );  	
  
BEGIN
  
   DBMS_OUTPUT.put_line('[INICIO]');
       

   V_PAR := '10784159,
10785593,
10785594,
10785595,
10785652,
10785653,
10785654,
10785697,
10786757,
10786799,
10786498,
10784161,
10784344,
10784294,
10786516,
10786463,
10784350,
10787880,
10785520,
10783896,
10785522,
10784272,
10784106,
10786345,
10786711,
10784150,
10786654,
10786704,
10783994,
10786561,
10786873,
10786481,
10786802,
10786573,
10786564,
10786529,
10784115,
10786792,
10784080,
10786497,
10785526,
10786569,
10783971,
10784143,
10787742,
10784333,
10787101,
10786602,
10784083,
10784064,
10783993,
10784145,
10786509,
10786725,
10786719,
10784087,
10786689,
10785530,
10785531,
10786506,
10783933,
10786536,
10786869,
10786531,
10786872,
10786618,
10786788,
10785533,
10785534,
10786787,
10785535,
10786786,
10786570,
10786819,
10784095,
10786588,
10786890,
10785579,
10785580,
10784060,
10784134,
10786562,
10786336,
10787803,
10786678,
10786721,
10784125,
10786875,
10786760,
10834036,
10783978,
10786675,
10786343,
10786683,
10784129,
10786673,
10834009,
10786344,
10834028,
10787787,
10784128,
10787777,
10786728,
10786543,
10786856,
10786567,
10787714,
10787740,
10787794,
10787884,
10787752,
10787728,
10786613,
10786849,
10783966,
10786691,
10787851,
10785584,
10784414,
10783903,
10787198,
10787033,
10787133,
10787155,
10784020,
10783995,
10787804,
10785597,
10785645,
10785585,
10783920,
10784089,
10785643,
10786519,
10787037,
10785592,
10785620,
10787822,
10785600,
10785650,
10785655,
10787806,
10785587,
10785656,
10785657,
10785658,
10785659,
10785589,
10785590,
10785660,
10785661,
10784072,
10784062,
10785662,
10783979,
10785663,
10784049,
10784055,
10784085,
10785664,
10785665,
10785666,
10785667,
10785668,
10785669,
10785670,
10785671,
10785591,
10785624,
10785626,
10785683,
10785540,
10787026,
10787036,
10787148,
10787145,
10787031,
10787078,
10787051,
10787152,
10787194,
10787049,
10787107,
10787095,
10787151,
10787003,
10787123,
10787197,
10787006,
10787028,
10787034,
10787090,
10787014,
10787077,
10787056,
10787119,
10787127,
10787157,
10787000,
10787106,
10787204,
10787137,
10787180,
10787105,
10786884,
10786538,
10786851,
10786477,
10786662,
10786733,
10787052,
10787196,
10787853,
10787778,
10786779,
10786740,
10786660,
10786571,
10786592,
10786829,
10786746,
10784169,
10785674,
10785611,
10786576,
10834034,
10786551,
10786479,
10787182,
10787066,
10787111,
10787041,
10787240,
10786351,
10784354,
10786999,
10785640,
10785641,
10785528,
10785772,
10785537,
10786493,
10786825,
10786699,
10787809,
10787059,
10787046,
10787135,
10786577,
10787749,
10787769,
10787883,
10787068,
10783902,
10785351,
10785675,
10785634,
10786540,
10786759,
10786530,
10786923,
10786921,
10786920,
10786859,
10786661,
10786512,
10786706,
10786632,
10785532,
10784337,
10787181,
10787060,
10787190,
10786628,
10786490,
10786837,
10786838,
10786625,
10786778,
10786466,
10786703,
10786681,
10834008,
10786525,
10786716,
10786492,
10786556,
10786475,
10786646,
10786803,
10786636,
10786458,
10786542,
10786601,
10786902,
10783891,
10784027,
10786903,
10786904,
10786905,
10786906,
10786907,
10786908,
10786909,
10786910,
10786911,
10786912,
10786918,
10785598,
10787004,
10787807,
10786702,
10786789,
10786510,
10786524,
10786494,
10787210,
10785677,
10785704
';	

V_PAR_2 := '10786742,
10786705,
10786842,
10786503,
10784319,
10784274,
10784359,
10784144,
10783928,
10784267,
10787839,
10783953,
10786501,
10834027,
10787862,
10784113,
10784057,
10784363,
10784160,
10787131,
10787783,
10787734,
10787857,
10787877,
10787801,
10787754,
10834030,
10787362,
10787166,
10787231,
10787230,
10786784,
10786847,
10786893,
10786894,
10786895,
10786896,
10786897,
10786898,
10786899,
10786900,
10786785,
10786537,
10787852,
10787900,
10786342,
10786669,
10786848,
10834011,
10786469,
10784264,
10785603,
10784013,
10784352,
10787856,
10787848,
10786473,
10786697,
10786349,
10787176,
10787186,
10786610,
10834033,
10786693,
10786614,
10787762,
10787844,
10786593,
10784349,
10784172,
10787731,
10786338,
10786717,
10784090,
10786587,
10786545,
10786820,
10786877,
10786603,
10786626,
10786781,
10786341,
10786594,
10783936,
10786604,
10784023,
10783967,
10786738,
10786710,
10783907,
10786511,
10784008,
10786724,
10786749,
10786635,
10786651,
10786700,
10786769,
10785609,
10787183,
10784317,
10784353,
10787048,
10786857,
10787147,
10784136,
10785774,
10784284,
10784262,
10785613,
10785614,
10783957,
10785615,
10785616,
10783960,
10784275,
10784180,
10784074,
10784258,
10783954,
10784336,
10784270,
10784283,
10785696,
10786677,
10787798,
10786915,
10786916,
10783906,
10784345,
10784109,
10783926,
10783970,
10784070,
10783904,
10785639,
10785606,
10785607,
10785608,
10783894,
10787745,
10785642,
10785586,
10785582,
10784305,
10787833,
10787724,
10787897,
10784039,
10784059,
10783892,
10784088,
10784164,
10784253,
10787885,
10787172,
10787058,
10785525,
10785529,
10785621,
10785618,
10785538,
10785539,
10787093,
10784257,
10784306,
10784355,
10787064,
10787080,
10785622,
10834025,
10787235,
10787234,
10787001,
10784073,
10783938,
10785547,
10787842,
10784026,
10784282,
10786814,
10784334,
10784278,
10784339,
10783895,
10787743,
10784058,
10783952,
10784005,
10783918,
10784320,
10784147,
10784132,
10784030,
10784133,
10784139,
10784151,
10783991,
10784308,
10784266,
10787763,
10787836,
10786756,
10786664,
10784183,
10784021,
10787047,
10787364,
10787012,
10785625,
10787120,
10784003,
10786615,
10787019,
10787355,
10787126,
10787191,
10786348,
10786346,
10785627,
10785628,
10784114,
10787104,
10787098,
10786672,
10787113,
10786337,
10784170,
10784171,
10783929,
10784063,
10784309,
10785521,
10785527,
10785536,
10785583,
10785612,
10785617,
10785623,
10786347,
10785685,
10786676,
10786523,
10787050,
10787177,
10787209,
10787766,
10784033,
10786797,
10786655,
10787865,
10786480,
10786868,
10786518,
10784122,
10786650,
10786750,
10786727,
10785544,
10785632,
10785644,
10785633,
10786557,
10786565,
10786459,
10784167,
10784298,
10784285,
10784273,
10786741,
10785599,
10785646,
10785651,
10785711,
10787161,
10787125,
10787007,
10787205,
10787201,
10787024,
10787164,
10787203,
10787146,
10787873,
10785596,
10786504,
10783931,
10786544,
10786830,
10786722,
10787767,
10786680,
10786534,
10784179,
10784286,
10786823,
10784158,
10784301,
10786807,
10786574,
10786483,
10786813,
10786653,
10787115,
10785610,
10787360,
10786339,
10786714,
10787890,
10787715,
10787847,
10785672,
10787727,
10787759,
10787870,
10787824,
10787820,
10787867,
10784028,
10787861';

V_PAR_3 := '10787864,
10787780,
10787774,
10787718,
10787782,
10785602,
10784131,
10785673,
10784356,
10786774,
10785686,
10784093,
10785707,
10785708,
10834026,
10787726,
10784071,
10784357,
10787114,
10787128,
10787784,
10787904,
10784135,
10787723,
10787887,
10787721,
10787871,
10787725,
10787737,
10787719,
10787881,
10783939,
10787750,
10787713,
10787802,
10787775,
10787814,
10787756,
10787902,
10787751,
10787818,
10787122,
10784148,
10784052,
10787139,
10784299,
10786882,
10786606,
10786790,
10787103,
10784312,
10787118,
10787110,
10787163,
10787017,
10785635,
10785636,
10785637,
10785638,
10787070,
10784047,
10787018,
10783963,
10783972,
10785679,
10783969,
10784162,
10784121,
10785680,
10784149,
10785681,
10787071,
10787178,
10787021,
10787083,
10786763,
10787141,
10787108,
10787020,
10787136,
10783900,
10786550,
10787134,
10785678,
10786833,
10785684,
10785705,
10785706,
10785712,
10785713,
10784084,
10784032,
10785687,
10785688,
10785548,
10785549,
10785689,
10785550,
10786694,
10786612,
10786885,
10787907,
10787808,
10787838,
10783958,
10787879,
10784126,
10787092,
10787081,
10785690,
10787030,
10787038,
10786695,
10785682,
10787040,
10787065,
10787074,
10787029,
10787121,
10787039,
10785649,
10834032,
10786888,
10784108,
10784138,
10784371,
10784372,
10785694,
10783998,
10784351,
10784321,
10786487,
10786862,
10786850,
10786609,
10786555,
10786764,
10787168,
10786795,
10786462,
10786546,
10786718,
10787855,
10784415,
10787846,
10787903,
10787889,
10787896,
10787850,
10785698,
10787800,
10787886,
10787760,
10787717,
10787891,
10787746,
10787765,
10784076,
10787788,
10787826,
10784300,
10785701,
10785702,
10786752,
10787100,
10785691,
10785692,
10784332,
10785703,
10784146,
10784290,
10786598,
10784081,
10784213,
10784187,
10784186,
10784276,
10787043,
10786578,
10785631,
10786854,
10785647,
10785648,
10785699,
10785700,
10785542,
10785629,
10785709,
10785710,
10785630,
10787143,
10787053,
10783898,
10784137,
10784265,
10787013,
10784094,
10784295,
10786508,
10787032,
10787174,
10784342,
10787162,
10786806,
10786465,
10786616,
10786572,
10786917,
10785619,
10784004,
10785676,
10785541,
10786486,
10787849,
10787179,
10786809,
10785604,
10785605,
10786839,
10786800,
10784124,
10787772,
10787738,
10783992,
10784012,
10786340,
10786350,
10786674,
10786656,
10786527,
10834031,
10786549,
10786878,
10785543,
10786793,
10786541,
10834037,
10786865,
10786876,
10786914,
10787091,
10786804,
10786690,
10786558,
10786489,
10786637,
10785523,
10785524,
10783980,
10785588,
10787153,
10787171,
10784329,
10784075,
10784127,
10787085,
10786663,
10787757,
10787790,
10787733,
10786464,
10786495,
10786496,
10785545,
10785546,
10786754,
10786796,
10786712,
10786743,
10786591,
10787753,
10787758,
10787741,
10787739,
10787905,
10787812,
10787823,
10787872,
10787799,
10787352,
10787099,
10787094,
10787222,
10785581,
10786600,
10784362,
10786827,
10786879,
10786748,
10786874,
10834029,
10834035,
10785693,
10785695,
10786753,
10786776,
10786863,
10786620,
10786835,
10786817,
10786471,
10786684,
10784297,
10784348,
10784174,
10784318,
10784269,
10784289,
10786640,
10786597,
10786547,
10786735,
10786913,
10785601,
10784281,
10783919,
10783962
';

   REM01.SP_EXT_REENVIO_GASTO ( V_PAR , V_USUARIOMODIFICAR, V_RET );
   DBMS_OUTPUT.PUT_LINE( V_RET );

    REM01.SP_EXT_REENVIO_GASTO ( V_PAR_2 , V_USUARIOMODIFICAR, V_RET );
   DBMS_OUTPUT.PUT_LINE( V_RET );

   REM01.SP_EXT_REENVIO_GASTO ( V_PAR_3 , V_USUARIOMODIFICAR, V_RET );
   DBMS_OUTPUT.PUT_LINE( V_RET );

   DBMS_OUTPUT.PUT_LINE(' [INFO] Reenviado gastos ');
   DBMS_OUTPUT.PUT_LINE('[FIN] ');
    
   COMMIT;

EXCEPTION
   WHEN OTHERS THEN
        ERR_NUM := SQLCODE;
        ERR_MSG := SQLERRM;
        DBMS_OUTPUT.put_line('[ERROR] Se ha producido un error en la ejecución:'||TO_CHAR(ERR_NUM));
        DBMS_OUTPUT.put_line('-----------------------------------------------------------'); 
        DBMS_OUTPUT.put_line(ERR_MSG);
        ROLLBACK;
        RAISE;   
END;
/
EXIT;
