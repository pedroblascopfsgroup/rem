--/*
--###########################################
--## AUTOR=Viorel Remus Ovidiu
--## FECHA_CREACION=20191219
--## ARTEFACTO=online
--## VERSION_ARTEFACTO=9.3
--## INCIDENCIA_LINK=REMVIP-6057
--## PRODUCTO=NO
--## 
--## Finalidad: INCLUIR ACTIVOS EN AGRUPACIONES
--##			
--## INSTRUCCIONES:  
--## VERSIONES:
--##        0.1 Versión inicial
--###########################################
----*/


WHENEVER SQLERROR EXIT SQL.SQLCODE;
SET SERVEROUTPUT ON; 
SET DEFINE OFF;

DECLARE
  V_MSQL VARCHAR2(32000 CHAR); -- Sentencia a ejecutar     
  V_ESQUEMA VARCHAR2(25 CHAR):= '#ESQUEMA#'; -- Configuracion Esquema
  V_ESQUEMA_M VARCHAR2(25 CHAR):= '#ESQUEMA_MASTER#'; -- Configuracion Esquema Master
  V_SQL VARCHAR2(4000 CHAR); -- Vble. para consulta que valida la existencia de una tabla.
  V_NUM_TABLAS NUMBER(16); -- Vble. para validar la existencia de una tabla.   
  ERR_NUM NUMBER(25);  -- Vble. auxiliar para registrar errores en el script.
  ERR_MSG VARCHAR2(1024 CHAR); -- Vble. auxiliar para registrar errores en el script.
  V_COMMIT NUMBER(16):= 0;
  V_COUNT_ACT NUMBER(16):= 0;
  V_COUNT_AGR NUMBER(16):= 0;
  V_COUNT_AGA NUMBER(16):= 0;
  V_USUARIO VARCHAR2(100 CHAR) := 'REMVIP-6057';
  
  TYPE T_TIPO_DATA IS TABLE OF VARCHAR2(150);
  TYPE T_ARRAY_DATA IS TABLE OF T_TIPO_DATA;
    
    V_TIPO_DATA T_ARRAY_DATA := T_ARRAY_DATA(
    -- 	 		Agrupacion  , Activo 
	 	T_TIPO_DATA('1000018624','7062962'),
		T_TIPO_DATA('1000018624','7062954'),
		T_TIPO_DATA('1000018624','7062928'),
		T_TIPO_DATA('1000018624','7063279'),
		T_TIPO_DATA('1000018624','7062890'),
		T_TIPO_DATA('1000018624','7063288'),
		T_TIPO_DATA('1000018624','7063304'),
		T_TIPO_DATA('1000018624','7063124'),
		T_TIPO_DATA('1000018624','7063285'),
		T_TIPO_DATA('1000018624','7062959'),
		T_TIPO_DATA('1000018624','7063291'),
		T_TIPO_DATA('1000018624','7062963'),
		T_TIPO_DATA('1000018624','7062951'),
		T_TIPO_DATA('1000018624','7062881'),
		T_TIPO_DATA('1000018624','7062958'),
		T_TIPO_DATA('1000018624','7063315'),
		T_TIPO_DATA('1000018624','7063305'),
		T_TIPO_DATA('1000018624','7063301'),
		T_TIPO_DATA('1000018624','7063333'),
		T_TIPO_DATA('1000018624','7062912'),
		T_TIPO_DATA('1000018624','7063294'),
		T_TIPO_DATA('1000018624','7063286'),
		T_TIPO_DATA('1000018624','7062918'),
		T_TIPO_DATA('1000018624','7062935'),
		T_TIPO_DATA('1000018624','7062970'),
		T_TIPO_DATA('1000018624','7063281'),
		T_TIPO_DATA('1000018624','7062920'),
		T_TIPO_DATA('1000018624','7062945'),
		T_TIPO_DATA('1000018624','7063302'),
		T_TIPO_DATA('1000018624','7063300'),
		T_TIPO_DATA('1000018624','7063298'),
		T_TIPO_DATA('1000018624','7063313'),
		T_TIPO_DATA('1000018624','7063058'),
		T_TIPO_DATA('1000018624','7063303'),
		T_TIPO_DATA('1000018624','7062923'),
		T_TIPO_DATA('1000018624','7063296'),
		T_TIPO_DATA('1000018624','7062885'),
		T_TIPO_DATA('1000018624','7062882'),
		T_TIPO_DATA('1000018624','7062900'),
		T_TIPO_DATA('1000018624','7063327'),
		T_TIPO_DATA('1000018624','7062949'),
		T_TIPO_DATA('1000018624','7063335'),
		T_TIPO_DATA('1000018624','7062895'),
		T_TIPO_DATA('1000018624','7062925'),
		T_TIPO_DATA('1000018624','7062878'),
		T_TIPO_DATA('1000018624','7063329'),
		T_TIPO_DATA('1000018624','7062910'),
		T_TIPO_DATA('1000018624','7062944'),
		T_TIPO_DATA('1000018624','7062931'),
		T_TIPO_DATA('1000018624','7063212'),
		T_TIPO_DATA('1000018624','7062883'),
		T_TIPO_DATA('1000018624','7063091'),
		T_TIPO_DATA('1000018624','7063326'),
		T_TIPO_DATA('1000018624','7063316'),
		T_TIPO_DATA('1000018624','7063283'),
		T_TIPO_DATA('1000018624','7062937'),
		T_TIPO_DATA('1000018624','7063334'),
		T_TIPO_DATA('1000018624','7063201'),
		T_TIPO_DATA('1000018624','7063245'),
		T_TIPO_DATA('1000018624','7062888'),
		T_TIPO_DATA('1000018624','7062950'),
		T_TIPO_DATA('1000018624','7062960'),
		T_TIPO_DATA('1000018624','7062877'),
		T_TIPO_DATA('1000018624','7062924'),
		T_TIPO_DATA('1000018624','7063234'),
		T_TIPO_DATA('1000018624','7062899'),
		T_TIPO_DATA('1000018624','7063331'),
		T_TIPO_DATA('1000018624','7062953'),
		T_TIPO_DATA('1000018624','7062947'),
		T_TIPO_DATA('1000018624','7063328'),
		T_TIPO_DATA('1000018624','7062948'),
		T_TIPO_DATA('1000018624','7062933'),
		T_TIPO_DATA('1000018624','7062934'),
		T_TIPO_DATA('1000018624','7062921'),
		T_TIPO_DATA('1000018624','7063289'),
		T_TIPO_DATA('1000018624','7063168'),
		T_TIPO_DATA('1000018624','7063146'),
		T_TIPO_DATA('1000018624','7062927'),
		T_TIPO_DATA('1000018624','7062926'),
		T_TIPO_DATA('1000018624','7063190'),
		T_TIPO_DATA('1000018624','7062913'),
		T_TIPO_DATA('1000018624','7063314'),
		T_TIPO_DATA('1000018624','7062941'),
		T_TIPO_DATA('1000018624','7063280'),
		T_TIPO_DATA('1000018624','7063256'),
		T_TIPO_DATA('1000018624','7063003'),
		T_TIPO_DATA('1000018624','7062929'),
		T_TIPO_DATA('1000018624','7062909'),
		T_TIPO_DATA('1000018624','7063157'),
		T_TIPO_DATA('1000018624','7062902'),
		T_TIPO_DATA('1000018624','7062936'),
		T_TIPO_DATA('1000018624','7062917'),
		T_TIPO_DATA('1000018624','7062891'),
		T_TIPO_DATA('1000018624','7062908'),
		T_TIPO_DATA('1000018624','7063330'),
		T_TIPO_DATA('1000018624','7062942'),
		T_TIPO_DATA('1000018624','7063080'),
		T_TIPO_DATA('1000018624','7062904'),
		T_TIPO_DATA('1000018624','7062961'),
		T_TIPO_DATA('1000018624','7063036'),
		T_TIPO_DATA('1000018624','7063332'),
		T_TIPO_DATA('1000018624','7063323'),
		T_TIPO_DATA('1000018624','7063069'),
		T_TIPO_DATA('1000018624','7062886'),
		T_TIPO_DATA('1000018624','7062914'),
		T_TIPO_DATA('1000018624','7063324'),
		T_TIPO_DATA('1000018624','7063312'),
		T_TIPO_DATA('1000018624','7062943'),
		T_TIPO_DATA('1000018624','7063047'),
		T_TIPO_DATA('1000018624','7062955'),
		T_TIPO_DATA('1000018624','7062919'),
		T_TIPO_DATA('1000018624','7063179'),
		T_TIPO_DATA('1000018624','7062956'),
		T_TIPO_DATA('1000018624','7063025'),
		T_TIPO_DATA('1000018624','7063325'),
		T_TIPO_DATA('1000018624','7062893'),
		T_TIPO_DATA('1000018624','7062892'),
		T_TIPO_DATA('1000018624','7062932'),
		T_TIPO_DATA('1000018624','7062911'),
		T_TIPO_DATA('1000018624','7062907'),
		T_TIPO_DATA('1000018624','7062880'),
		T_TIPO_DATA('1000018624','7063322'),
		T_TIPO_DATA('1000018624','7063282'),
		T_TIPO_DATA('1000018624','7062903'),
		T_TIPO_DATA('1000018624','7062887'),
		T_TIPO_DATA('1000018624','7062952'),
		T_TIPO_DATA('1000018624','7062940'),
		T_TIPO_DATA('1000018624','7063297'),
		T_TIPO_DATA('1000018624','7062922'),
		T_TIPO_DATA('1000018624','7063267'),
		T_TIPO_DATA('1000018624','7062897'),
		T_TIPO_DATA('1000018624','7063223'),
		T_TIPO_DATA('1000018624','7063321'),
		T_TIPO_DATA('1000018624','7062884'),
		T_TIPO_DATA('1000018624','7063319'),
		T_TIPO_DATA('1000018624','7063309'),
		T_TIPO_DATA('1000018624','7063320'),
		T_TIPO_DATA('1000018624','7062981'),
		T_TIPO_DATA('1000018624','7063311'),
		T_TIPO_DATA('1000018624','7063308'),
		T_TIPO_DATA('1000018624','7063310'),
		T_TIPO_DATA('1000018624','7062915'),
		T_TIPO_DATA('1000018624','7062898'),
		T_TIPO_DATA('1000018624','7063278'),
		T_TIPO_DATA('1000018624','7062916'),
		T_TIPO_DATA('1000018624','7062930'),
		T_TIPO_DATA('1000018624','7063318'),
		T_TIPO_DATA('1000018624','7062901'),
		T_TIPO_DATA('1000018624','7062939'),
		T_TIPO_DATA('1000018624','7063317'),
		T_TIPO_DATA('1000018624','7063295'),
		T_TIPO_DATA('1000018624','7062896'),
		T_TIPO_DATA('1000018624','7063307'),
		T_TIPO_DATA('1000018624','7063306'),
		T_TIPO_DATA('1000018624','7062906'),
		T_TIPO_DATA('1000018624','7062905'),
		T_TIPO_DATA('1000018624','7062938'),
		T_TIPO_DATA('1000018624','7063292'),
		T_TIPO_DATA('1000018624','7063102'),
		T_TIPO_DATA('1000018624','7062957'),
		T_TIPO_DATA('1000018624','7062889'),
		T_TIPO_DATA('1000018624','7062894'),
		T_TIPO_DATA('1000018624','7063299'),
		T_TIPO_DATA('1000018624','7063287'),
		T_TIPO_DATA('1000018624','7063284'),
		T_TIPO_DATA('1000018624','7063293'),
		T_TIPO_DATA('1000018624','7063290'),
		T_TIPO_DATA('1000018624','7063113'),
		T_TIPO_DATA('1000018624','7062946'),
		T_TIPO_DATA('1000018624','7063215'),
		T_TIPO_DATA('1000018624','7063213'),
		T_TIPO_DATA('1000018624','7063077'),
		T_TIPO_DATA('1000018624','7062972'),
		T_TIPO_DATA('1000018624','7063082'),
		T_TIPO_DATA('1000018624','7063078'),
		T_TIPO_DATA('1000018624','7062971'),
		T_TIPO_DATA('1000018624','7063116'),
		T_TIPO_DATA('1000018624','7063040'),
		T_TIPO_DATA('1000018624','7062976'),
		T_TIPO_DATA('1000018624','7063106'),
		T_TIPO_DATA('1000018624','7063133'),
		T_TIPO_DATA('1000018624','7063090'),
		T_TIPO_DATA('1000018624','7063107'),
		T_TIPO_DATA('1000018624','7062965'),
		T_TIPO_DATA('1000018624','7062985'),
		T_TIPO_DATA('1000018624','7063149'),
		T_TIPO_DATA('1000018624','7062977'),
		T_TIPO_DATA('1000018624','7063170'),
		T_TIPO_DATA('1000018624','7063132'),
		T_TIPO_DATA('1000018624','7063159'),
		T_TIPO_DATA('1000018624','7063154'),
		T_TIPO_DATA('1000018624','7063176'),
		T_TIPO_DATA('1000018624','7063120'),
		T_TIPO_DATA('1000018624','7063048'),
		T_TIPO_DATA('1000018624','7063150'),
		T_TIPO_DATA('1000018624','7063051'),
		T_TIPO_DATA('1000018624','7063109'),
		T_TIPO_DATA('1000018624','7063084'),
		T_TIPO_DATA('1000018624','7063099'),
		T_TIPO_DATA('1000018624','7063111'),
		T_TIPO_DATA('1000018624','7063140'),
		T_TIPO_DATA('1000018624','7063188'),
		T_TIPO_DATA('1000018624','7062964'),
		T_TIPO_DATA('1000018624','7062967'),
		T_TIPO_DATA('1000018624','7062993'),
		T_TIPO_DATA('1000018624','7062994'),
		T_TIPO_DATA('1000018624','7062995'),
		T_TIPO_DATA('1000018624','7062996'),
		T_TIPO_DATA('1000018624','7062997'),
		T_TIPO_DATA('1000018624','7062998'),
		T_TIPO_DATA('1000018624','7062999'),
		T_TIPO_DATA('1000018624','7063000'),
		T_TIPO_DATA('1000018624','7063001'),
		T_TIPO_DATA('1000018624','7063002'),
		T_TIPO_DATA('1000018624','7063004'),
		T_TIPO_DATA('1000018624','7063005'),
		T_TIPO_DATA('1000018624','7063006'),
		T_TIPO_DATA('1000018624','7063007'),
		T_TIPO_DATA('1000018624','7063008'),
		T_TIPO_DATA('1000018624','7063009'),
		T_TIPO_DATA('1000018624','7063010'),
		T_TIPO_DATA('1000018624','7063011'),
		T_TIPO_DATA('1000018624','7063012'),
		T_TIPO_DATA('1000018624','7063013'),
		T_TIPO_DATA('1000018624','7063167'),
		T_TIPO_DATA('1000018624','7063155'),
		T_TIPO_DATA('1000018624','7063062'),
		T_TIPO_DATA('1000018624','7062990'),
		T_TIPO_DATA('1000018624','7063134'),
		T_TIPO_DATA('1000018624','7063164'),
		T_TIPO_DATA('1000018624','7063066'),
		T_TIPO_DATA('1000018624','7063083'),
		T_TIPO_DATA('1000018624','7063015'),
		T_TIPO_DATA('1000018624','7063016'),
		T_TIPO_DATA('1000018624','7063017'),
		T_TIPO_DATA('1000018624','7063018'),
		T_TIPO_DATA('1000018624','7063019'),
		T_TIPO_DATA('1000018624','7063020'),
		T_TIPO_DATA('1000018624','7063021'),
		T_TIPO_DATA('1000018624','7063022'),
		T_TIPO_DATA('1000018624','7063023'),
		T_TIPO_DATA('1000018624','7063024'),
		T_TIPO_DATA('1000018624','7063026'),
		T_TIPO_DATA('1000018624','7063027'),
		T_TIPO_DATA('1000018624','7063028'),
		T_TIPO_DATA('1000018624','7063030'),
		T_TIPO_DATA('1000018624','7063039'),
		T_TIPO_DATA('1000018624','7063072'),
		T_TIPO_DATA('1000018624','7063114'),
		T_TIPO_DATA('1000018624','7063117'),
		T_TIPO_DATA('1000018624','7063127'),
		T_TIPO_DATA('1000018624','7063143'),
		T_TIPO_DATA('1000018624','7063147'),
		T_TIPO_DATA('1000018624','7063148'),
		T_TIPO_DATA('1000018624','7063129'),
		T_TIPO_DATA('1000018624','7063108'),
		T_TIPO_DATA('1000018624','7063141'),
		T_TIPO_DATA('1000018624','7063138'),
		T_TIPO_DATA('1000018624','7063184'),
		T_TIPO_DATA('1000018624','7063100'),
		T_TIPO_DATA('1000018624','7063104'),
		T_TIPO_DATA('1000018624','7063121'),
		T_TIPO_DATA('1000018624','7062989'),
		T_TIPO_DATA('1000018624','7063038'),
		T_TIPO_DATA('1000018624','7062966'),
		T_TIPO_DATA('1000018624','7062988'),
		T_TIPO_DATA('1000018624','7062968'),
		T_TIPO_DATA('1000018624','7062979'),
		T_TIPO_DATA('1000018624','7063063'),
		T_TIPO_DATA('1000018624','7063043'),
		T_TIPO_DATA('1000018624','7063050'),
		T_TIPO_DATA('1000018624','7063183'),
		T_TIPO_DATA('1000018624','7063087'),
		T_TIPO_DATA('1000018624','7063199'),
		T_TIPO_DATA('1000018624','7063052'),
		T_TIPO_DATA('1000018624','7063044'),
		T_TIPO_DATA('1000018624','7062987'),
		T_TIPO_DATA('1000018624','7062980'),
		T_TIPO_DATA('1000018624','7063071'),
		T_TIPO_DATA('1000018624','7063119'),
		T_TIPO_DATA('1000018624','7063185'),
		T_TIPO_DATA('1000018624','7063193'),
		T_TIPO_DATA('1000018624','7062984'),
		T_TIPO_DATA('1000018624','7063103'),
		T_TIPO_DATA('1000018624','7063041'),
		T_TIPO_DATA('1000018624','7063174'),
		T_TIPO_DATA('1000018624','7063142'),
		T_TIPO_DATA('1000018624','7063097'),
		T_TIPO_DATA('1000018624','7063029'),
		T_TIPO_DATA('1000018624','7063130'),
		T_TIPO_DATA('1000018624','7063092'),
		T_TIPO_DATA('1000018624','7063195'),
		T_TIPO_DATA('1000018624','7063187'),
		T_TIPO_DATA('1000018624','7063131'),
		T_TIPO_DATA('1000018624','7063112'),
		T_TIPO_DATA('1000018624','7063105'),
		T_TIPO_DATA('1000018624','7063053'),
		T_TIPO_DATA('1000018624','7063037'),
		T_TIPO_DATA('1000018624','7063123'),
		T_TIPO_DATA('1000018624','7063115'),
		T_TIPO_DATA('1000018624','7063198'),
		T_TIPO_DATA('1000018624','7063162'),
		T_TIPO_DATA('1000018624','7063171'),
		T_TIPO_DATA('1000018624','7063172'),
		T_TIPO_DATA('1000018624','7063178'),
		T_TIPO_DATA('1000018624','7063203'),
		T_TIPO_DATA('1000018624','7063204'),
		T_TIPO_DATA('1000018624','7063200'),
		T_TIPO_DATA('1000018624','7063122'),
		T_TIPO_DATA('1000018624','7063175'),
		T_TIPO_DATA('1000018624','7063073'),
		T_TIPO_DATA('1000018624','7063196'),
		T_TIPO_DATA('1000018624','7063034'),
		T_TIPO_DATA('1000018624','7063088'),
		T_TIPO_DATA('1000018624','7063068'),
		T_TIPO_DATA('1000018624','7063128'),
		T_TIPO_DATA('1000018624','7063074'),
		T_TIPO_DATA('1000018624','7063035'),
		T_TIPO_DATA('1000018624','7063070'),
		T_TIPO_DATA('1000018624','7063096'),
		T_TIPO_DATA('1000018624','7063094'),
		T_TIPO_DATA('1000018624','7063160'),
		T_TIPO_DATA('1000018624','7063189'),
		T_TIPO_DATA('1000018624','7063202'),
		T_TIPO_DATA('1000018624','7063136'),
		T_TIPO_DATA('1000018624','7062978'),
		T_TIPO_DATA('1000018624','7063180'),
		T_TIPO_DATA('1000018624','7063064'),
		T_TIPO_DATA('1000018624','7062975'),
		T_TIPO_DATA('1000018624','7063033'),
		T_TIPO_DATA('1000018624','7063086'),
		T_TIPO_DATA('1000018624','7063177'),
		T_TIPO_DATA('1000018624','7063118'),
		T_TIPO_DATA('1000018624','7063125'),
		T_TIPO_DATA('1000018624','7063089'),
		T_TIPO_DATA('1000018624','7063137'),
		T_TIPO_DATA('1000018624','7063197'),
		T_TIPO_DATA('1000018624','7063194'),
		T_TIPO_DATA('1000018624','7063067'),
		T_TIPO_DATA('1000018624','7062983'),
		T_TIPO_DATA('1000018624','7063032'),
		T_TIPO_DATA('1000018624','7063182'),
		T_TIPO_DATA('1000018624','7063126'),
		T_TIPO_DATA('1000018624','7063055'),
		T_TIPO_DATA('1000018624','7063158'),
		T_TIPO_DATA('1000018624','7063153'),
		T_TIPO_DATA('1000018624','7063065'),
		T_TIPO_DATA('1000018624','7062973'),
		T_TIPO_DATA('1000018624','7062969'),
		T_TIPO_DATA('1000018624','7063056'),
		T_TIPO_DATA('1000018624','7063098'),
		T_TIPO_DATA('1000018624','7063191'),
		T_TIPO_DATA('1000018624','7063075'),
		T_TIPO_DATA('1000018624','7062986'),
		T_TIPO_DATA('1000018624','7063144'),
		T_TIPO_DATA('1000018624','7063181'),
		T_TIPO_DATA('1000018624','7063101'),
		T_TIPO_DATA('1000018624','7063192'),
		T_TIPO_DATA('1000018624','7063059'),
		T_TIPO_DATA('1000018624','7063156'),
		T_TIPO_DATA('1000018624','7063139'),
		T_TIPO_DATA('1000018624','7063145'),
		T_TIPO_DATA('1000018624','7063045'),
		T_TIPO_DATA('1000018624','7063095'),
		T_TIPO_DATA('1000018624','7063110'),
		T_TIPO_DATA('1000018624','7063081'),
		T_TIPO_DATA('1000018624','7063173'),
		T_TIPO_DATA('1000018624','7063057'),
		T_TIPO_DATA('1000018624','7063166'),
		T_TIPO_DATA('1000018624','7063060'),
		T_TIPO_DATA('1000018624','7063031'),
		T_TIPO_DATA('1000018624','7063076'),
		T_TIPO_DATA('1000018624','7063046'),
		T_TIPO_DATA('1000018624','7063163'),
		T_TIPO_DATA('1000018624','7063161'),
		T_TIPO_DATA('1000018624','7063151'),
		T_TIPO_DATA('1000018624','7063042'),
		T_TIPO_DATA('1000018624','7063049'),
		T_TIPO_DATA('1000018624','7063152'),
		T_TIPO_DATA('1000018624','7063169'),
		T_TIPO_DATA('1000018624','7063186'),
		T_TIPO_DATA('1000018624','7063165'),
		T_TIPO_DATA('1000018624','7063061'),
		T_TIPO_DATA('1000018624','7063240'),
		T_TIPO_DATA('1000018624','7063255'),
		T_TIPO_DATA('1000018624','7063222'),
		T_TIPO_DATA('1000018624','7063221'),
		T_TIPO_DATA('1000018624','7063224'),
		T_TIPO_DATA('1000018624','7063219'),
		T_TIPO_DATA('1000018624','7063236'),
		T_TIPO_DATA('1000018624','7063276'),
		T_TIPO_DATA('1000018624','7063277'),
		T_TIPO_DATA('1000018624','7063225'),
		T_TIPO_DATA('1000018624','7063272'),
		T_TIPO_DATA('1000018624','7063268'),
		T_TIPO_DATA('1000018624','7063207'),
		T_TIPO_DATA('1000018624','7063254'),
		T_TIPO_DATA('1000018624','7063264'),
		T_TIPO_DATA('1000018624','7063252'),
		T_TIPO_DATA('1000018624','7063231'),
		T_TIPO_DATA('1000018624','7063242'),
		T_TIPO_DATA('1000018624','7063258'),
		T_TIPO_DATA('1000018624','7063246'),
		T_TIPO_DATA('1000018624','7063228'),
		T_TIPO_DATA('1000018624','7063227'),
		T_TIPO_DATA('1000018624','7063220'),
		T_TIPO_DATA('1000018624','7063209'),
		T_TIPO_DATA('1000018624','7063230'),
		T_TIPO_DATA('1000018624','7063226'),
		T_TIPO_DATA('1000018624','7063244'),
		T_TIPO_DATA('1000018624','7063229'),
		T_TIPO_DATA('1000018624','7063233'),
		T_TIPO_DATA('1000018624','7063232'),
		T_TIPO_DATA('1000018624','7063210'),
		T_TIPO_DATA('1000018624','7063262'),
		T_TIPO_DATA('1000018624','7063248'),
		T_TIPO_DATA('1000018624','7063249'),
		T_TIPO_DATA('1000018624','7063238'),
		T_TIPO_DATA('1000018624','7063218'),
		T_TIPO_DATA('1000018624','7063241'),
		T_TIPO_DATA('1000018624','7063243'),
		T_TIPO_DATA('1000018624','7063206'),
		T_TIPO_DATA('1000018624','7063250'),
		T_TIPO_DATA('1000018624','7063247'),
		T_TIPO_DATA('1000018624','7063208'),
		T_TIPO_DATA('1000018624','7063237'),
		T_TIPO_DATA('1000018624','7063265'),
		T_TIPO_DATA('1000018624','7063259'),
		T_TIPO_DATA('1000018624','7063211'),
		T_TIPO_DATA('1000018624','7063205'),
		T_TIPO_DATA('1000018624','7063261'),
		T_TIPO_DATA('1000018624','7063273'),
		T_TIPO_DATA('1000018624','7063235'),
		T_TIPO_DATA('1000018624','7063251'),
		T_TIPO_DATA('1000018624','7063257'),
		T_TIPO_DATA('1000018624','7063260'),
		T_TIPO_DATA('1000018624','7063263'),
		T_TIPO_DATA('1000018624','7063266'),
		T_TIPO_DATA('1000018624','7063269'),
		T_TIPO_DATA('1000018624','7063270'),
		T_TIPO_DATA('1000018624','7063271'),
		T_TIPO_DATA('1000018624','7063253'),
		T_TIPO_DATA('1000018624','7063275')
	); 
    V_TMP_TIPO_DATA T_TIPO_DATA;
    
BEGIN	
	
	DBMS_OUTPUT.PUT_LINE('[INICIO] ');

	 
    -- LOOP para actualizar los valores en ACT_TBJ_TRABAJO -----------------------------------------------------------------
    DBMS_OUTPUT.PUT_LINE('[INFO]: INSERT ACT_ID EN AGA');
    FOR I IN V_TIPO_DATA.FIRST .. V_TIPO_DATA.LAST
      LOOP

	V_COMMIT := V_COMMIT + 1;
        V_TMP_TIPO_DATA := V_TIPO_DATA(I);
		
	-- COmprobamos si la agrupacion existe
	V_SQL := 'SELECT COUNT(1) FROM '||V_ESQUEMA||'.ACT_AGR_AGRUPACION
	          WHERE AGR_NUM_AGRUP_REM = '||TRIM(V_TMP_TIPO_DATA(1))||'';
				
        EXECUTE IMMEDIATE V_SQL INTO V_COUNT_AGR;
        
        --Comprobamos si el activo existe
        V_SQL := 'SELECT COUNT(1) FROM '||V_ESQUEMA||'.ACT_ACTIVO 
		  WHERE ACT_NUM_ACTIVO =  '||TRIM(V_TMP_TIPO_DATA(2))||'';
				
        EXECUTE IMMEDIATE V_SQL INTO V_COUNT_ACT;
        
        IF V_COUNT_AGR = 1 THEN		
			
		IF V_COUNT_ACT = 1 THEN
			
		
			V_SQL := 'SELECT COUNT(1) FROM '||V_ESQUEMA||'.ACT_AGA_AGRUPACION_ACTIVO
				  WHERE ACT_ID = (SELECT ACT_ID FROM '||V_ESQUEMA||'.ACT_ACTIVO WHERE ACT_NUM_ACTIVO = '||TRIM(V_TMP_TIPO_DATA(2))||' )
				  AND AGR_ID = (SELECT AGR_ID FROM '||V_ESQUEMA||'.ACT_AGR_AGRUPACION WHERE AGR_NUM_AGRUP_REM = '||TRIM(V_TMP_TIPO_DATA(1))||' )';
								
			EXECUTE IMMEDIATE V_SQL INTO V_COUNT_AGA;
				
				IF V_COUNT_AGA = 0 THEN
								
					V_MSQL := 'INSERT INTO '||V_ESQUEMA||'.ACT_AGA_AGRUPACION_ACTIVO (
									AGA_ID,
									AGR_ID,
									ACT_ID,
									AGA_FECHA_INCLUSION,
									AGA_PRINCIPAL,
									VERSION,
									USUARIOCREAR,
									FECHACREAR,
									BORRADO
								) VALUES (
									'||V_ESQUEMA||'.S_ACT_AGA_AGRUPACION_ACTIVO.NEXTVAL,
									(SELECT AGR_ID FROM '||V_ESQUEMA||'.ACT_AGR_AGRUPACION WHERE AGR_NUM_AGRUP_REM = '||TRIM(V_TMP_TIPO_DATA(1))||' ),
									(SELECT ACT_ID FROM '||V_ESQUEMA||'.ACT_ACTIVO WHERE ACT_NUM_ACTIVO = '||TRIM(V_TMP_TIPO_DATA(2))||' ),
									SYSDATE,
									0,
									0,
									'''||V_USUARIO||''',
									SYSDATE,
									0
								)';
												

					EXECUTE IMMEDIATE V_MSQL;

					DBMS_OUTPUT.PUT_LINE('[INFO]: SE HA INSERTADO EN LA AGRUPACIÓN '''||TRIM(V_TMP_TIPO_DATA(1))||'''EL ACTIVO '''||TRIM(V_TMP_TIPO_DATA(2))||'''');
								
				ELSE
					DBMS_OUTPUT.PUT_LINE('[ERROR]:  AGRUPACION '''||TRIM(V_TMP_TIPO_DATA(1))||''' YA TIENE EL ACTIVO '''||TRIM(V_TMP_TIPO_DATA(2))||'''');
				END IF;
				
			ELSE 
				DBMS_OUTPUT.PUT_LINE('[ERROR]:  EL ACTIVO '''||TRIM(V_TMP_TIPO_DATA(2))||' NO EXISTE');
			END IF;
		
		ELSE
			  DBMS_OUTPUT.PUT_LINE('[ERROR]:  LA AGRUPACION '''||TRIM(V_TMP_TIPO_DATA(1))||' NO EXISTE');
		END IF;
		
    END LOOP;
    COMMIT;
    DBMS_OUTPUT.PUT_LINE('[FIN]:  LOS ACTIVOS SE HAN AÑADIDO EN LAS AGRUPACIONES');

EXCEPTION

   WHEN OTHERS THEN
        err_num := SQLCODE;
        err_msg := SQLERRM;

        DBMS_OUTPUT.put_line('[ERROR] Se ha producido un error en la ejecución:'||TO_CHAR(err_num));
        DBMS_OUTPUT.put_line('-----------------------------------------------------------'); 
        DBMS_OUTPUT.put_line(err_msg);

        ROLLBACK;
        RAISE;          

END;

/

EXIT
