--/*
--######################################### 
--## AUTOR=Viorel Remus Ovidiu
--## FECHA_CREACION=20200217
--## ARTEFACTO=online
--## VERSION_ARTEFACTO=9.3
--## INCIDENCIA_LINK=REMVIP-6112
--## PRODUCTO=NO
--## 
--## Finalidad:
--##            
--## INSTRUCCIONES:  
--## VERSIONES:
--##        0.1 Versión inicial
--#########################################
--*/

--Para permitir la visualización de texto en un bloque PL/SQL utilizando DBMS_OUTPUT.PUT_LINE

WHENEVER SQLERROR EXIT SQL.SQLCODE;
SET SERVEROUTPUT ON; 
SET DEFINE OFF;
alter session set NLS_NUMERIC_CHARACTERS = '.,';

DECLARE
	V_MSQL VARCHAR2(32000 CHAR); -- Sentencia a ejecutar    
	V_ESQUEMA VARCHAR2(25 CHAR):= '#ESQUEMA#'; -- #ESQUEMA# Configuracion Esquema
	V_ESQUEMA_M VARCHAR2(25 CHAR):= '#ESQUEMA_MASTER#'; -- #ESQUEMA_MASTER# Configuracion Esquema Master 
	ERR_NUM NUMBER(25);  -- Vble. auxiliar para registrar errores en el script.
	ERR_MSG VARCHAR2(1024 CHAR); -- Vble. auxiliar para registrar errores en el script.
	V_USUARIOBORRAR VARCHAR2(50 CHAR) := 'REMVIP-6112';
	
BEGIN
    DBMS_OUTPUT.PUT_LINE('[INICIO]');
	

	--OFERTA 90201979

	V_MSQL := 'UPDATE REM01.OFR_OFERTAS SET OFR_IMPORTE = 442650.07,
		USUARIOMODIFICAR = ''REMVIP-6112'',
		FECHAMODIFICAR = SYSDATE 
		WHERE OFR_NUM_OFERTA = 90201979';

	EXECUTE IMMEDIATE V_MSQL;

	DBMS_OUTPUT.PUT_LINE('[INFO] Se han actualizado  '||SQL%ROWCOUNT||' registros .');

	V_MSQL := 'DELETE FROM REM01.ACT_OFR WHERE OFR_ID = 495728 AND ACT_ID = 78011';

	EXECUTE IMMEDIATE V_MSQL;

	DBMS_OUTPUT.PUT_LINE('[INFO] Se han actualizado  '||SQL%ROWCOUNT||' registros .');

	V_MSQL := 'UPDATE REM01.ACT_AGA_AGRUPACION_ACTIVO 
		SET USUARIOBORRAR = ''REMVIP-6112'',
		FECHABORRAR = SYSDATE, 
		BORRADO = 1 
		WHERE ACT_ID = 78011 AND AGR_ID = 76692';

	EXECUTE IMMEDIATE V_MSQL;

	DBMS_OUTPUT.PUT_LINE('[INFO] Se han actualizado  '||SQL%ROWCOUNT||' registros .');

	V_MSQL := 'UPDATE REM01.ECO_EXPEDIENTE_COMERCIAL SET ECO_BLOQUEADO = 0, 
		USUARIOMODIFICAR = ''REMVIP-6112'',
		FECHAMODIFICAR = SYSDATE 
		WHERE ECO_NUM_EXPEDIENTE = 172164';

	EXECUTE IMMEDIATE V_MSQL;

	DBMS_OUTPUT.PUT_LINE('[INFO] Se han actualizado  '||SQL%ROWCOUNT||' registros .');
	
	DBMS_OUTPUT.PUT_LINE('[INFO] Se han actualizado la oferta 90201979');


	--OFERTA 90235488

	V_MSQL := 'UPDATE REM01.OFR_OFERTAS SET OFR_IMPORTE = 1162202.73,
		USUARIOMODIFICAR = ''REMVIP-6112'',
		FECHAMODIFICAR = SYSDATE 
		WHERE OFR_NUM_OFERTA = 90235488';

	EXECUTE IMMEDIATE V_MSQL;

	DBMS_OUTPUT.PUT_LINE('[INFO] Se han actualizado  '||SQL%ROWCOUNT||' registros .');

	V_MSQL := 'DELETE FROM REM01.ACT_OFR WHERE OFR_ID = 530849 AND ACT_ID = 76826';

	EXECUTE IMMEDIATE V_MSQL;

	DBMS_OUTPUT.PUT_LINE('[INFO] Se han actualizado  '||SQL%ROWCOUNT||' registros .');

	V_MSQL := 'UPDATE REM01.ACT_AGA_AGRUPACION_ACTIVO 
		SET USUARIOBORRAR = ''REMVIP-6112'',
		FECHABORRAR = SYSDATE, 
		BORRADO = 1 
		WHERE ACT_ID = 76826 AND AGR_ID = 88399';

	EXECUTE IMMEDIATE V_MSQL;

	DBMS_OUTPUT.PUT_LINE('[INFO] Se han actualizado  '||SQL%ROWCOUNT||' registros .');

	V_MSQL := 'UPDATE REM01.ECO_EXPEDIENTE_COMERCIAL SET ECO_BLOQUEADO = 0, 
		USUARIOMODIFICAR = ''REMVIP-6112'',
		FECHAMODIFICAR = SYSDATE 
		WHERE ECO_NUM_EXPEDIENTE = 192625';

	EXECUTE IMMEDIATE V_MSQL;

	DBMS_OUTPUT.PUT_LINE('[INFO] Se han actualizado  '||SQL%ROWCOUNT||' registros .');
	
	DBMS_OUTPUT.PUT_LINE('[INFO] Se han actualizado la oferta 90235488');



	--OFERTA 90200877

	V_MSQL := 'UPDATE REM01.OFR_OFERTAS SET OFR_IMPORTE = 50000,
		USUARIOMODIFICAR = ''REMVIP-6112'',
		FECHAMODIFICAR = SYSDATE 
		WHERE OFR_NUM_OFERTA = 90200877';

	EXECUTE IMMEDIATE V_MSQL;

	DBMS_OUTPUT.PUT_LINE('[INFO] Se han actualizado  '||SQL%ROWCOUNT||' registros .');

	V_MSQL := 'DELETE FROM REM01.ACT_OFR WHERE OFR_ID = 494615 AND ACT_ID = 76769';

	EXECUTE IMMEDIATE V_MSQL;

	DBMS_OUTPUT.PUT_LINE('[INFO] Se han actualizado  '||SQL%ROWCOUNT||' registros .');

	V_MSQL := 'UPDATE REM01.ACT_AGA_AGRUPACION_ACTIVO 
		SET USUARIOBORRAR = ''REMVIP-6112'',
		FECHABORRAR = SYSDATE, 
		BORRADO = 1 
		WHERE ACT_ID = 76769 AND AGR_ID = 76559';

	EXECUTE IMMEDIATE V_MSQL;

	DBMS_OUTPUT.PUT_LINE('[INFO] Se han actualizado  '||SQL%ROWCOUNT||' registros .');

	V_MSQL := 'UPDATE REM01.ECO_EXPEDIENTE_COMERCIAL SET ECO_BLOQUEADO = 0, 
		USUARIOMODIFICAR = ''REMVIP-6112'',
		FECHAMODIFICAR = SYSDATE 
		WHERE ECO_NUM_EXPEDIENTE = 171562';

	EXECUTE IMMEDIATE V_MSQL;

	DBMS_OUTPUT.PUT_LINE('[INFO] Se han actualizado  '||SQL%ROWCOUNT||' registros .');
	
	DBMS_OUTPUT.PUT_LINE('[INFO] Se han actualizado la oferta 90200877');




	--OFERTA 90200881

	V_MSQL := 'UPDATE REM01.OFR_OFERTAS SET OFR_IMPORTE = 692738.65,
		USUARIOMODIFICAR = ''REMVIP-6112'',
		FECHAMODIFICAR = SYSDATE 
		WHERE OFR_NUM_OFERTA = 90200881';

	EXECUTE IMMEDIATE V_MSQL;

	DBMS_OUTPUT.PUT_LINE('[INFO] Se han actualizado  '||SQL%ROWCOUNT||' registros .');

	V_MSQL := 'DELETE FROM REM01.ACT_OFR WHERE OFR_ID = 494619 AND ACT_ID = 270498';

	EXECUTE IMMEDIATE V_MSQL;

	DBMS_OUTPUT.PUT_LINE('[INFO] Se han actualizado  '||SQL%ROWCOUNT||' registros .');

	V_MSQL := 'UPDATE REM01.ACT_AGA_AGRUPACION_ACTIVO 
		SET USUARIOBORRAR = ''REMVIP-6112'',
		FECHABORRAR = SYSDATE, 
		BORRADO = 1 
		WHERE ACT_ID = 270498 AND AGR_ID = 76563';

	EXECUTE IMMEDIATE V_MSQL;

	DBMS_OUTPUT.PUT_LINE('[INFO] Se han actualizado  '||SQL%ROWCOUNT||' registros .');

	V_MSQL := 'UPDATE REM01.ECO_EXPEDIENTE_COMERCIAL SET ECO_BLOQUEADO = 0, 
		USUARIOMODIFICAR = ''REMVIP-6112'',
		FECHAMODIFICAR = SYSDATE 
		WHERE ECO_NUM_EXPEDIENTE = 171564';

	EXECUTE IMMEDIATE V_MSQL;

	DBMS_OUTPUT.PUT_LINE('[INFO] Se han actualizado  '||SQL%ROWCOUNT||' registros .');
	
	DBMS_OUTPUT.PUT_LINE('[INFO] Se han actualizado la oferta 90200881');


	--OFERTA 90201958

	V_MSQL := 'UPDATE REM01.OFR_OFERTAS SET OFR_IMPORTE = 1631491.93,
		USUARIOMODIFICAR = ''REMVIP-6112'',
		FECHAMODIFICAR = SYSDATE 
		WHERE OFR_NUM_OFERTA = 90201958';

	EXECUTE IMMEDIATE V_MSQL;

	DBMS_OUTPUT.PUT_LINE('[INFO] Se han actualizado  '||SQL%ROWCOUNT||' registros .');

	V_MSQL := 'DELETE FROM REM01.ACT_OFR WHERE (OFR_ID = 495707 AND ACT_ID = 105558) OR (OFR_ID = 495707 AND ACT_ID = 120774) OR (OFR_ID = 495707 AND ACT_ID = 120868)';

	EXECUTE IMMEDIATE V_MSQL;

	DBMS_OUTPUT.PUT_LINE('[INFO] Se han actualizado  '||SQL%ROWCOUNT||' registros .');

	V_MSQL := 'UPDATE REM01.ACT_AGA_AGRUPACION_ACTIVO 
		SET USUARIOBORRAR = ''REMVIP-6112'',
		FECHABORRAR = SYSDATE, 
		BORRADO = 1 
		WHERE (AGR_ID = 76560 AND ACT_ID = 105558) OR (AGR_ID = 76560 AND ACT_ID = 120774) OR (AGR_ID = 76560 AND ACT_ID = 120868)';

	EXECUTE IMMEDIATE V_MSQL;

	DBMS_OUTPUT.PUT_LINE('[INFO] Se han actualizado  '||SQL%ROWCOUNT||' registros .');

	V_MSQL := 'UPDATE REM01.ECO_EXPEDIENTE_COMERCIAL SET ECO_BLOQUEADO = 0, 
		USUARIOMODIFICAR = ''REMVIP-6112'',
		FECHAMODIFICAR = SYSDATE 
		WHERE ECO_NUM_EXPEDIENTE = 172156';

	EXECUTE IMMEDIATE V_MSQL;

	DBMS_OUTPUT.PUT_LINE('[INFO] Se han actualizado  '||SQL%ROWCOUNT||' registros .');
	
	DBMS_OUTPUT.PUT_LINE('[INFO] Se han actualizado la oferta 90201958');


	--OFERTA 90235496

	V_MSQL := 'UPDATE REM01.OFR_OFERTAS SET OFR_IMPORTE = 1452233.56,
		USUARIOMODIFICAR = ''REMVIP-6112'',
		FECHAMODIFICAR = SYSDATE 
		WHERE OFR_NUM_OFERTA = 90235496';

	EXECUTE IMMEDIATE V_MSQL;

	DBMS_OUTPUT.PUT_LINE('[INFO] Se han actualizado  '||SQL%ROWCOUNT||' registros .');

	V_MSQL := 'DELETE FROM REM01.ACT_OFR WHERE (OFR_ID = 530857 AND ACT_ID = 96722) 
			OR (OFR_ID = 530857 AND ACT_ID = 98977) 
			OR (OFR_ID = 530857 AND ACT_ID = 98643) 
			OR (OFR_ID = 530857 AND ACT_ID = 109052) 
			OR (OFR_ID = 530857 AND ACT_ID = 108920) 
			OR (OFR_ID = 530857 AND ACT_ID = 270558) 
			OR (OFR_ID = 530857 AND ACT_ID = 271744)';

	EXECUTE IMMEDIATE V_MSQL;

	DBMS_OUTPUT.PUT_LINE('[INFO] Se han actualizado  '||SQL%ROWCOUNT||' registros .');

	V_MSQL := 'UPDATE REM01.ACT_AGA_AGRUPACION_ACTIVO 
		SET USUARIOBORRAR = ''REMVIP-6112'',
		FECHABORRAR = SYSDATE, 
		BORRADO = 1 
		WHERE (AGR_ID = 88172 AND ACT_ID = 96722) 
			OR (AGR_ID = 88172 AND ACT_ID = 98977) 
			OR (AGR_ID = 88172 AND ACT_ID = 98643) 
			OR (AGR_ID = 88172 AND ACT_ID = 109052) 
			OR (AGR_ID = 88172 AND ACT_ID = 108920) 
			OR (AGR_ID = 88172 AND ACT_ID = 270558) 
			OR (AGR_ID = 88172 AND ACT_ID = 271744)';

	EXECUTE IMMEDIATE V_MSQL;

	DBMS_OUTPUT.PUT_LINE('[INFO] Se han actualizado  '||SQL%ROWCOUNT||' registros .');

	V_MSQL := 'UPDATE REM01.ECO_EXPEDIENTE_COMERCIAL SET ECO_BLOQUEADO = 0, 
		USUARIOMODIFICAR = ''REMVIP-6112'',
		FECHAMODIFICAR = SYSDATE 
		WHERE ECO_NUM_EXPEDIENTE = 192641';

	EXECUTE IMMEDIATE V_MSQL;

	DBMS_OUTPUT.PUT_LINE('[INFO] Se han actualizado  '||SQL%ROWCOUNT||' registros .');
	
	DBMS_OUTPUT.PUT_LINE('[INFO] Se han actualizado la oferta 90235496');


	--OFERTA 90235485

	V_MSQL := 'UPDATE REM01.OFR_OFERTAS SET OFR_IMPORTE = 4517266.91,
		USUARIOMODIFICAR = ''REMVIP-6112'',
		FECHAMODIFICAR = SYSDATE 
		WHERE OFR_NUM_OFERTA = 90235485';

	EXECUTE IMMEDIATE V_MSQL;

	DBMS_OUTPUT.PUT_LINE('[INFO] Se han actualizado  '||SQL%ROWCOUNT||' registros .');

	V_MSQL := 'DELETE FROM REM01.ACT_OFR WHERE (OFR_ID = 530846 AND ACT_ID = 76705) 
			OR (OFR_ID = 530846 AND ACT_ID = 99481) 
			OR (OFR_ID = 530846 AND ACT_ID = 106312) 
			OR (OFR_ID = 530846 AND ACT_ID = 120877) 
			OR (OFR_ID = 530846 AND ACT_ID = 271751) 
			OR (OFR_ID = 530846 AND ACT_ID = 345616)';

	EXECUTE IMMEDIATE V_MSQL;

	DBMS_OUTPUT.PUT_LINE('[INFO] Se han actualizado  '||SQL%ROWCOUNT||' registros .');

	V_MSQL := 'UPDATE REM01.ACT_AGA_AGRUPACION_ACTIVO 
		SET USUARIOBORRAR = ''REMVIP-6112'',
		FECHABORRAR = SYSDATE, 
		BORRADO = 1 
		WHERE (AGR_ID = 88182 AND ACT_ID = 76705) 
			OR (AGR_ID = 88182 AND ACT_ID = 99481) 
			OR (AGR_ID = 88182 AND ACT_ID = 106312) 
			OR (AGR_ID = 88182 AND ACT_ID = 120877) 
			OR (AGR_ID = 88182 AND ACT_ID = 271751) 
			OR (AGR_ID = 88182 AND ACT_ID = 345616)';

	EXECUTE IMMEDIATE V_MSQL;

	DBMS_OUTPUT.PUT_LINE('[INFO] Se han actualizado  '||SQL%ROWCOUNT||' registros .');

	V_MSQL := 'UPDATE REM01.ECO_EXPEDIENTE_COMERCIAL SET ECO_BLOQUEADO = 0, 
		USUARIOMODIFICAR = ''REMVIP-6112'',
		FECHAMODIFICAR = SYSDATE 
		WHERE ECO_NUM_EXPEDIENTE = 192617';

	EXECUTE IMMEDIATE V_MSQL;

	DBMS_OUTPUT.PUT_LINE('[INFO] Se han actualizado  '||SQL%ROWCOUNT||' registros .');
	
	DBMS_OUTPUT.PUT_LINE('[INFO] Se han actualizado la oferta 90235485');



	--OFERTA 90235528

	V_MSQL := 'UPDATE REM01.OFR_OFERTAS SET OFR_IMPORTE = 425224.66,
		USUARIOMODIFICAR = ''REMVIP-6112'',
		FECHAMODIFICAR = SYSDATE 
		WHERE OFR_NUM_OFERTA = 90235528';

	EXECUTE IMMEDIATE V_MSQL;

	DBMS_OUTPUT.PUT_LINE('[INFO] Se han actualizado  '||SQL%ROWCOUNT||' registros .');

	V_MSQL := 'DELETE FROM REM01.ACT_OFR WHERE (OFR_ID = 530889 AND ACT_ID = 77664) 
			OR (OFR_ID = 530889 AND ACT_ID = 78037) 
			';

	EXECUTE IMMEDIATE V_MSQL;

	DBMS_OUTPUT.PUT_LINE('[INFO] Se han actualizado  '||SQL%ROWCOUNT||' registros .');

	V_MSQL := 'UPDATE REM01.ACT_AGA_AGRUPACION_ACTIVO 
		SET USUARIOBORRAR = ''REMVIP-6112'',
		FECHABORRAR = SYSDATE, 
		BORRADO = 1 
		WHERE (AGR_ID = 88533 AND ACT_ID = 77664) 
			OR (AGR_ID = 88533 AND ACT_ID = 78037) 
			';

	EXECUTE IMMEDIATE V_MSQL;

	DBMS_OUTPUT.PUT_LINE('[INFO] Se han actualizado  '||SQL%ROWCOUNT||' registros .');

	V_MSQL := 'UPDATE REM01.ECO_EXPEDIENTE_COMERCIAL SET ECO_BLOQUEADO = 0, 
		USUARIOMODIFICAR = ''REMVIP-6112'',
		FECHAMODIFICAR = SYSDATE 
		WHERE ECO_NUM_EXPEDIENTE = 192658';

	EXECUTE IMMEDIATE V_MSQL;

	DBMS_OUTPUT.PUT_LINE('[INFO] Se han actualizado  '||SQL%ROWCOUNT||' registros .');
	
	DBMS_OUTPUT.PUT_LINE('[INFO] Se han actualizado la oferta 90235528');


	--OFERTA 90201109

	V_MSQL := 'UPDATE REM01.OFR_OFERTAS SET OFR_IMPORTE = 582206.05,
		USUARIOMODIFICAR = ''REMVIP-6112'',
		FECHAMODIFICAR = SYSDATE 
		WHERE OFR_NUM_OFERTA = 90201109';

	EXECUTE IMMEDIATE V_MSQL;

	DBMS_OUTPUT.PUT_LINE('[INFO] Se han actualizado  '||SQL%ROWCOUNT||' registros .');

	V_MSQL := 'DELETE FROM REM01.ACT_OFR WHERE (OFR_ID = 494849 AND ACT_ID = 94598) 
			OR (OFR_ID = 494849 AND ACT_ID = 94060) 
			OR (OFR_ID = 494849 AND ACT_ID = 120571) 
			';

	EXECUTE IMMEDIATE V_MSQL;

	DBMS_OUTPUT.PUT_LINE('[INFO] Se han actualizado  '||SQL%ROWCOUNT||' registros .');

	V_MSQL := 'UPDATE REM01.ACT_AGA_AGRUPACION_ACTIVO 
		SET USUARIOBORRAR = ''REMVIP-6112'',
		FECHABORRAR = SYSDATE, 
		BORRADO = 1 
		WHERE (AGR_ID = 76999 AND ACT_ID = 94598) 
			OR (AGR_ID = 76999 AND ACT_ID = 94060) 
			OR (AGR_ID = 76999 AND ACT_ID = 120571) 
			';

	EXECUTE IMMEDIATE V_MSQL;

	DBMS_OUTPUT.PUT_LINE('[INFO] Se han actualizado  '||SQL%ROWCOUNT||' registros .');

	V_MSQL := 'UPDATE REM01.ECO_EXPEDIENTE_COMERCIAL SET ECO_BLOQUEADO = 0, 
		USUARIOMODIFICAR = ''REMVIP-6112'',
		FECHAMODIFICAR = SYSDATE 
		WHERE ECO_NUM_EXPEDIENTE = 171665';

	EXECUTE IMMEDIATE V_MSQL;

	DBMS_OUTPUT.PUT_LINE('[INFO] Se han actualizado  '||SQL%ROWCOUNT||' registros .');
	
	DBMS_OUTPUT.PUT_LINE('[INFO] Se han actualizado la oferta 90201109');

    COMMIT;

	DBMS_OUTPUT.PUT_LINE('[FIN]');
  
EXCEPTION
	WHEN OTHERS THEN 
	    DBMS_OUTPUT.PUT_LINE('KO!');
	    ERR_NUM := SQLCODE;
	    ERR_MSG := SQLERRM;
	    
	    DBMS_OUTPUT.PUT_LINE('[ERROR] Se ha producido un error en la ejecución:'||TO_CHAR(ERR_NUM));
	    DBMS_OUTPUT.PUT_LINE('-----------------------------------------------------------'); 
	    DBMS_OUTPUT.PUT_LINE(err_msg);
	    
	    ROLLBACK;
	    RAISE;          

END;
/
EXIT;
