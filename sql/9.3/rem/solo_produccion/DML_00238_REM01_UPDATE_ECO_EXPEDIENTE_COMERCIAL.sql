--/*
--##########################################
--## AUTOR=Alberto Flores
--## FECHA_CREACION=20200408
--## ARTEFACTO=online
--## VERSION_ARTEFACTO=9.3
--## INCIDENCIA_LINK=REMVIP-6903
--## PRODUCTO=SI
--##
--## Finalidad: Script que actualiza de forma masiva el campo ECO_FECHA_CONT_PROPIETARIO de las ofertas dadas. 
--## INSTRUCCIONES:
--## VERSIONES:
--## 		0.1 Versi√≥n inicial
--##########################################
--*/

WHENEVER SQLERROR EXIT SQL.SQLCODE;
SET SERVEROUTPUT ON; 
SET DEFINE OFF;

DECLARE
	V_MSQL VARCHAR2(4000 CHAR);
	V_SQL VARCHAR2(4000 CHAR);
	V_ESQUEMA VARCHAR2(25 CHAR):= '#ESQUEMA#'; -- Configuracion Esquema
	V_ESQUEMA_M VARCHAR2(25 CHAR):= '#ESQUEMA_MASTER#'; -- Configuracion Esquema Master
	V_NUM NUMBER(16); -- Vble. para validar la existencia de un registro.
	err_num NUMBER; -- Numero de errores
	err_msg VARCHAR2(2048); -- Mensaje de error
	V_USR VARCHAR2(30 CHAR) := 'REMVIP-6903'; -- USUARIOCREAR/USUARIOMODIFICAR.
	
	TYPE T_ACT IS TABLE OF VARCHAR2(50);
	TYPE T_ARRAY_ACT IS TABLE OF T_ACT; 
	V_ACT T_ARRAY_ACT := T_ARRAY_ACT(   
		T_ACT('71471161', '23/01/2018'), 	T_ACT('71882601', '24/07/2013'), 	T_ACT('90000006', '15/03/2018'), 	T_ACT('70809997', '09/02/2018'),
		T_ACT('71107158', '23/01/2018'), 	T_ACT('71547914', '17/01/2018'), 	T_ACT('71633403', '10/01/2018'), 	T_ACT('90110004', '14/11/2018'),
		T_ACT('90113176', '21/01/2019'), 	T_ACT('90119920', '17/01/2019'), 	T_ACT('90125782', '16/01/2019'), 	T_ACT('90196528', '16/07/2019'),
		T_ACT('90000261', '22/02/2018'), 	T_ACT('90000377', '15/02/2018'), 	T_ACT('90000426', '10/01/2018'), 	T_ACT('90000620', '13/02/2018'),
		T_ACT('90001074', '15/02/2018'), 	T_ACT('90001115', '14/03/2018'), 	T_ACT('90001407', '11/01/2018'), 	T_ACT('90001447', '10/01/2018'),
		T_ACT('90001454', '09/01/2018'), 	T_ACT('90001529', '21/02/2018'), 	T_ACT('90002030', '12/01/2018'), 	T_ACT('90002186', '22/01/2018'),
		T_ACT('90002507', '23/01/2018'), 	T_ACT('90003219', '24/01/2018'), 	T_ACT('90003287', '13/02/2018'), 	T_ACT('90003307', '21/03/2018'),
		T_ACT('90003368', '26/01/2018'), 	T_ACT('90003582', '22/03/2018'), 	T_ACT('90003754', '19/03/2018'), 	T_ACT('90004132', '19/03/2018'),
		T_ACT('90004265', '16/01/2018'), 	T_ACT('90004488', '08/03/2018'), 	T_ACT('90004711', '09/02/2018'), 	T_ACT('90004744', '10/04/2018'),
		T_ACT('90005129', '23/01/2018'), 	T_ACT('90005467', '14/02/2018'), 	T_ACT('90005518', '09/02/2018'), 	T_ACT('90005555', '17/04/2018'),
		T_ACT('90006453', '12/02/2018'), 	T_ACT('90006455', '26/01/2018'), 	T_ACT('90006691', '24/04/2018'), 	T_ACT('90006707', '12/02/2018'),
		T_ACT('90007023', '12/02/2018'), 	T_ACT('90007077', '22/01/2018'), 	T_ACT('90007484', '13/02/2018'), 	T_ACT('90007582', '14/02/2018'),
		T_ACT('90007591', '22/01/2018'), 	T_ACT('90007741', '19/01/2018'), 	T_ACT('90008673', '21/02/2018'), 	T_ACT('90009057', '16/02/2018'),
		T_ACT('90009451', '16/01/2018'), 	T_ACT('90010008', '15/03/2018'), 	T_ACT('90010383', '19/03/2018'), 	T_ACT('90010838', '12/03/2018'),
		T_ACT('90011034', '16/03/2018'), 	T_ACT('90011466', '15/02/2018'), 	T_ACT('90011523', '23/04/2018'), 	T_ACT('90011739', '22/02/2018'),
		T_ACT('90011842', '13/03/2018'), 	T_ACT('90011907', '20/03/2018'), 	T_ACT('90012335', '16/03/2018'), 	T_ACT('90012380', '09/04/2018'),
		T_ACT('90012505', '16/02/2018'), 	T_ACT('90012531', '09/05/2018'), 	T_ACT('90012805', '16/03/2018'), 	T_ACT('90012919', '21/02/2018'),
		T_ACT('90012949', '12/03/2018'), 	T_ACT('90013022', '09/04/2018'), 	T_ACT('90013094', '14/02/2018'), 	T_ACT('90013127', '12/02/2018'),
		T_ACT('90013345', '19/03/2018'), 	T_ACT('90013750', '12/02/2018'), 	T_ACT('90013940', '14/02/2018'), 	T_ACT('90014280', '26/01/2018'),
		T_ACT('90014439', '12/03/2018'), 	T_ACT('90014676', '15/02/2018'), 	T_ACT('90000115', '11/01/2018'), 	T_ACT('90001209', '13/02/2018'),
		T_ACT('90001231', '15/02/2018'), 	T_ACT('90001260', '16/02/2018'), 	T_ACT('90001420', '19/02/2018'), 	T_ACT('90001575', '12/01/2018'),
		T_ACT('90002116', '15/02/2018'), 	T_ACT('90002850', '23/01/2018'), 	T_ACT('90002899', '13/02/2018'), 	T_ACT('90003071', '23/01/2018'),
		T_ACT('90003149', '21/02/2018'), 	T_ACT('90003412', '26/01/2018'), 	T_ACT('90003581', '20/04/2018'), 	T_ACT('90003649', '23/01/2018'),
		T_ACT('90003671', '12/02/2018'), 	T_ACT('90003744', '23/01/2018'), 	T_ACT('90003749', '16/04/2018'), 	T_ACT('90003756', '14/03/2018'),
		T_ACT('90003976', '21/02/2018'), 	T_ACT('90004017', '15/03/2018'), 	T_ACT('90004121', '10/05/2018'), 	T_ACT('90004125', '22/01/2018'),
		T_ACT('90004336', '24/01/2018'), 	T_ACT('90004629', '24/01/2018'), 	T_ACT('90005010', '15/02/2018'), 	T_ACT('90005202', '12/02/2018'),
		T_ACT('90005230', '25/01/2018'), 	T_ACT('90005560', '22/01/2018'), 	T_ACT('90006853', '26/01/2018'), 	T_ACT('90007588', '11/01/2018'),
		T_ACT('90007892', '15/02/2018'), 	T_ACT('90008162', '14/02/2018'), 	T_ACT('90008509', '21/02/2018'), 	T_ACT('90008668', '23/01/2018'),
		T_ACT('90008703', '18/01/2018'), 	T_ACT('90008969', '23/01/2018'), 	T_ACT('90009716', '14/02/2018'), 	T_ACT('90009734', '19/03/2018'),
		T_ACT('90009808', '10/04/2018'), 	T_ACT('90010290', '14/02/2018'), 	T_ACT('90010341', '14/02/2018'), 	T_ACT('90010441', '21/02/2018'),
		T_ACT('90010522', '19/02/2018'), 	T_ACT('90010544', '11/06/2018'), 	T_ACT('90010615', '23/04/2018'), 	T_ACT('90010871', '24/01/2018'),
		T_ACT('90010936', '13/03/2018'), 	T_ACT('90011764', '25/01/2018'), 	T_ACT('90011866', '19/02/2018'), 	T_ACT('90011887', '16/02/2018'),
		T_ACT('90012230', '16/02/2018'), 	T_ACT('90012760', '12/02/2018'), 	T_ACT('90013986', '26/01/2018'), 	T_ACT('90014016', '23/01/2018'),
		T_ACT('90014118', '26/01/2018'), 	T_ACT('90014407', '13/03/2018'), 	T_ACT('90014438', '12/03/2018'), 	T_ACT('90014535', '21/02/2018'),
		T_ACT('90014969', '12/02/2018'), 	T_ACT('90014989', '08/03/2018'), 	T_ACT('90015556', '17/04/2018'), 	T_ACT('90015582', '16/03/2018'),
		T_ACT('90131331', '28/12/2018'), 	T_ACT('90132531', '18/01/2019'), 	T_ACT('90133116', '16/01/2019'), 	T_ACT('90133883', '23/01/2019'),
		T_ACT('90134868', '26/12/2018'), 	T_ACT('90135126', '18/01/2019'), 	T_ACT('90136210', '21/01/2019'), 	T_ACT('54929214', '28/12/2015'),
		T_ACT('54969725', '19/11/2015'), 	T_ACT('90015513', '10/05/2018'), 	T_ACT('90015572', '15/02/2018'), 	T_ACT('90015599', '15/03/2018'),
		T_ACT('90015817', '14/02/2018'), 	T_ACT('90016551', '16/03/2018'), 	T_ACT('90016615', '21/02/2018'), 	T_ACT('90016751', '20/03/2018'),
		T_ACT('90017034', '16/02/2018'), 	T_ACT('90017035', '20/03/2018'), 	T_ACT('90017122', '21/02/2018'), 	T_ACT('90017261', '15/02/2018'),
		T_ACT('90017433', '16/04/2018'), 	T_ACT('90017509', '16/03/2018'), 	T_ACT('90017580', '20/03/2018'), 	T_ACT('90017764', '08/03/2018'),
		T_ACT('90017821', '14/02/2018'), 	T_ACT('90017996', '22/02/2018'), 	T_ACT('90018773', '08/03/2018'), 	T_ACT('90018787', '11/04/2018'),
		T_ACT('90018795', '22/03/2018'), 	T_ACT('90018946', '21/03/2018'), 	T_ACT('90019111', '21/05/2018'), 	T_ACT('90019137', '21/03/2018'),
		T_ACT('90019226', '12/03/2018'), 	T_ACT('90019831', '19/03/2018'), 	T_ACT('90019902', '17/04/2018'), 	T_ACT('90020027', '13/03/2018'),
		T_ACT('90020536', '22/02/2018'), 	T_ACT('90021253', '18/04/2018'), 	T_ACT('90021301', '19/03/2018'), 	T_ACT('90021611', '16/02/2018'),
		T_ACT('90021715', '22/02/2018'), 	T_ACT('90022664', '13/04/2018'), 	T_ACT('90022691', '22/03/2018'), 	T_ACT('90022695', '18/04/2018'),
		T_ACT('90022893', '22/03/2018'), 	T_ACT('90022969', '13/04/2018'), 	T_ACT('90023679', '18/04/2018'), 	T_ACT('90024241', '21/03/2018'),
		T_ACT('90024578', '19/03/2018'), 	T_ACT('90024612', '08/03/2018'), 	T_ACT('90024749', '20/04/2018'), 	T_ACT('90025174', '18/05/2018'),
		T_ACT('90025412', '12/04/2018'), 	T_ACT('90025418', '13/04/2018'), 	T_ACT('90025452', '16/03/2018'), 	T_ACT('90026122', '11/05/2018'),
		T_ACT('90026298', '24/04/2018'), 	T_ACT('90026583', '17/05/2018'), 	T_ACT('90026643', '13/04/2018'), 	T_ACT('90027096', '14/05/2018'),
		T_ACT('90027468', '22/03/2018'), 	T_ACT('90027526', '23/04/2018'), 	T_ACT('90028493', '20/04/2018'), 	T_ACT('90028556', '17/04/2018'),
		T_ACT('90028580', '22/03/2018'), 	T_ACT('90029631', '18/04/2018'), 	T_ACT('90030002', '18/04/2018'), 	T_ACT('90030010', '16/04/2018'),
		T_ACT('90030407', '18/04/2018'), 	T_ACT('90030630', '18/04/2018'), 	T_ACT('90030647', '14/05/2018'), 	T_ACT('90030788', '24/04/2018'),
		T_ACT('90031098', '23/04/2018'), 	T_ACT('90031231', '17/04/2018'), 	T_ACT('90031702', '23/04/2018'), 	T_ACT('90034428', '18/04/2018'),
		T_ACT('90034520', '11/04/2018'), 	T_ACT('90035683', '18/04/2018'), 	T_ACT('90035697', '07/05/2018'), 	T_ACT('90035912', '14/05/2018'),
		T_ACT('90036956', '18/05/2018'), 	T_ACT('90016305', '21/05/2018'), 	T_ACT('90016557', '19/02/2018'), 	T_ACT('90016750', '14/02/2018'),
		T_ACT('90016779', '16/03/2018'), 	T_ACT('90016942', '15/03/2018'), 	T_ACT('90016954', '09/03/2018'), 	T_ACT('90017058', '16/03/2018'),
		T_ACT('90017178', '14/02/2018'), 	T_ACT('90017243', '21/03/2018'), 	T_ACT('90017490', '09/03/2018'), 	T_ACT('90017619', '09/03/2018'),
		T_ACT('90017658', '19/03/2018'), 	T_ACT('90017981', '02/03/2018'), 	T_ACT('90018172', '20/03/2018'), 	T_ACT('90018256', '13/03/2018'),
		T_ACT('90018816', '12/03/2018'), 	T_ACT('90019547', '20/03/2018'), 	T_ACT('90019618', '18/04/2018'), 	T_ACT('90019756', '19/03/2018'),
		T_ACT('90019995', '19/03/2018'), 	T_ACT('90020121', '13/04/2018'), 	T_ACT('90020542', '19/03/2018'), 	T_ACT('90021050', '22/03/2018'),
		T_ACT('90021096', '22/03/2018'), 	T_ACT('90021372', '14/02/2018'), 	T_ACT('90021598', '08/03/2018'), 	T_ACT('90021774', '16/04/2018'),
		T_ACT('90021811', '09/04/2018'), 	T_ACT('90021970', '19/02/2018'), 	T_ACT('90022098', '16/03/2018'), 	T_ACT('90022659', '19/03/2018'),
		T_ACT('90023309', '20/03/2018'), 	T_ACT('90023693', '13/04/2018'), 	T_ACT('90023941', '22/03/2018'), 	T_ACT('90025154', '07/05/2018'),
		T_ACT('90025169', '21/03/2018'), 	T_ACT('90025476', '21/02/2018'), 	T_ACT('90025818', '09/04/2018'), 	T_ACT('90025867', '18/04/2018'),
		T_ACT('90025949', '16/03/2018'), 	T_ACT('90026036', '21/03/2018'), 	T_ACT('90026165', '17/05/2018'), 	T_ACT('90026404', '18/04/2018'),
		T_ACT('90026443', '16/04/2018'), 	T_ACT('90026693', '16/03/2018'), 	T_ACT('90026963', '20/03/2018'), 	T_ACT('90027041', '19/03/2018'),
		T_ACT('90027047', '16/05/2018'), 	T_ACT('90027154', '23/04/2018'), 	T_ACT('90027328', '21/03/2018'), 	T_ACT('90027782', '11/04/2018'),
		T_ACT('90028470', '23/04/2018'), 	T_ACT('90029791', '22/03/2018'), 	T_ACT('90030151', '20/03/2018'), 	T_ACT('90030190', '22/03/2018'),
		T_ACT('90030223', '23/05/2018'), 	T_ACT('90030498', '07/05/2018'), 	T_ACT('90030677', '19/03/2018'), 	T_ACT('90031138', '18/04/2018'),
		T_ACT('90031681', '22/03/2018'), 	T_ACT('90032235', '14/05/2018'), 	T_ACT('90032421', '19/04/2018'), 	T_ACT('90032520', '14/05/2018'),
		T_ACT('90033341', '15/05/2018'), 	T_ACT('90033917', '17/04/2018'), 	T_ACT('90034134', '20/04/2018'), 	T_ACT('90034236', '21/05/2018'),
		T_ACT('90034840', '16/05/2018'), 	T_ACT('90035077', '18/04/2018'), 	T_ACT('90035415', '18/05/2018'), 	T_ACT('90036033', '21/03/2018'),
		T_ACT('90036059', '11/04/2018'), 	T_ACT('90036197', '18/04/2018'), 	T_ACT('90036225', '11/05/2018'), 	T_ACT('90036444', '23/04/2018'),
		T_ACT('90036728', '22/03/2018'), 	T_ACT('90036901', '20/04/2018'), 	T_ACT('90037845', '15/03/2018'), 	T_ACT('90038196', '23/05/2018'),
		T_ACT('90153720', '06/02/2019'), 	T_ACT('90158162', '19/04/2019'), 	T_ACT('64121324', '12/03/2018'), 	T_ACT('65101370', '13/07/2018'),
		T_ACT('90201153', '07/02/2020'), 	T_ACT('90036960', '11/05/2018'), 	T_ACT('90037430', '24/05/2018'), 	T_ACT('90038866', '07/05/2018'),
		T_ACT('90041305', '11/05/2018'), 	T_ACT('90044039', '10/04/2018'), 	T_ACT('90044639', '10/05/2018'), 	T_ACT('90044859', '09/04/2018'),
		T_ACT('90045026', '15/06/2018'), 	T_ACT('90045394', '15/06/2018'), 	T_ACT('90045449', '11/05/2018'), 	T_ACT('90045671', '07/05/2018'),
		T_ACT('90045756', '07/05/2018'), 	T_ACT('90046722', '12/06/2018'), 	T_ACT('90047891', '19/06/2018'), 	T_ACT('90047916', '14/06/2018'),
		T_ACT('90049050', '21/03/2019'), 	T_ACT('90049263', '16/05/2018'), 	T_ACT('90050084', '08/05/2018'), 	T_ACT('90050219', '15/06/2018'),
		T_ACT('90053488', '24/05/2018'), 	T_ACT('90055442', '22/05/2018'), 	T_ACT('90056539', '13/06/2018'), 	T_ACT('90039462', '16/05/2018'),
		T_ACT('90040861', '15/05/2018'), 	T_ACT('90041329', '15/05/2018'), 	T_ACT('90041330', '17/05/2018'), 	T_ACT('90042793', '15/06/2018'),
		T_ACT('90042811', '15/06/2018'), 	T_ACT('90044073', '18/05/2018'), 	T_ACT('90045474', '22/05/2018'), 	T_ACT('90046240', '18/05/2018'),
		T_ACT('90047739', '31/07/2018'), 	T_ACT('90047836', '08/05/2018'), 	T_ACT('90049629', '20/04/2018'), 	T_ACT('90049631', '20/04/2018'),
		T_ACT('90050002', '21/05/2018'), 	T_ACT('90050578', '15/06/2018'), 	T_ACT('90052703', '11/06/2018'), 	T_ACT('90053637', '14/06/2018'),
		T_ACT('90054787', '20/06/2018'), 	T_ACT('90055713', '18/06/2018'), 	T_ACT('90056998', '15/06/2018'), 	T_ACT('90180833', '30/04/2019'),
		T_ACT('70383587', '14/02/2018'), 	T_ACT('71705480', '15/01/2018'), 	T_ACT('71845673', '22/01/2018'), 	T_ACT('90223124', '17/01/2020'),
		T_ACT('90223763', '12/02/2020'), 	T_ACT('90057369', '12/06/2018'), 	T_ACT('90066733', '27/04/2018'), 	T_ACT('90068076', '04/06/2018'),
		T_ACT('54971002', '18/11/2015'), 	T_ACT('90201224', '13/06/2018'), 	T_ACT('90215352', '23/09/2019'), 	T_ACT('90000731', '12/01/2018'),
		T_ACT('90000782', '08/02/2018'), 	T_ACT('90000918', '08/02/2018'), 	T_ACT('90001023', '15/02/2018'), 	T_ACT('90001332', '14/02/2018'),
		T_ACT('90001661', '12/01/2018'), 	T_ACT('90001957', '15/03/2018'), 	T_ACT('90002322', '09/01/2018'), 	T_ACT('90002382', '09/02/2018'),
		T_ACT('90002457', '21/02/2018'), 	T_ACT('90002635', '22/01/2018'), 	T_ACT('90002940', '26/01/2018'), 	T_ACT('90002994', '16/02/2018'),
		T_ACT('90003078', '09/02/2018'), 	T_ACT('90003206', '25/01/2018'), 	T_ACT('90003247', '09/02/2018'), 	T_ACT('90003269', '24/01/2018'),
		T_ACT('90003588', '14/02/2018'), 	T_ACT('90004088', '10/01/2018'), 	T_ACT('90004257', '15/02/2018'), 	T_ACT('90004532', '09/04/2018'),
		T_ACT('90004704', '14/02/2018'), 	T_ACT('90004924', '22/01/2018'), 	T_ACT('90006171', '20/02/2018'), 	T_ACT('90006530', '23/01/2018'),
		T_ACT('90007052', '19/03/2018'), 	T_ACT('90007630', '15/02/2018'), 	T_ACT('90007720', '12/02/2018'), 	T_ACT('90007736', '15/02/2018'),
		T_ACT('90007857', '19/02/2018'), 	T_ACT('90007941', '15/03/2018'), 	T_ACT('90008237', '21/02/2018'), 	T_ACT('90008253', '12/02/2018'),
		T_ACT('90008682', '14/02/2018'), 	T_ACT('90008886', '16/02/2018'), 	T_ACT('90008977', '23/01/2018'), 	T_ACT('90009065', '22/01/2018'),
		T_ACT('90009234', '20/02/2018'), 	T_ACT('90009696', '12/02/2018'), 	T_ACT('90009723', '20/02/2018'), 	T_ACT('90009768', '24/04/2018'),
		T_ACT('90010112', '12/02/2018'), 	T_ACT('90010146', '13/04/2018'), 	T_ACT('90010203', '16/03/2018'), 	T_ACT('90010325', '14/02/2018'),
		T_ACT('90010578', '22/01/2018'), 	T_ACT('90010970', '14/02/2018'), 	T_ACT('90011096', '09/04/2018'), 	T_ACT('90011316', '12/02/2018'),
		T_ACT('90011321', '09/02/2018'), 	T_ACT('90011405', '26/01/2018'), 	T_ACT('90011770', '23/01/2018'), 	T_ACT('90011807', '20/02/2018'),
		T_ACT('90012237', '26/01/2018'), 	T_ACT('90012327', '13/02/2018'), 	T_ACT('90012453', '10/04/2018'), 	T_ACT('90012766', '13/02/2018'),
		T_ACT('90012842', '15/03/2018'), 	T_ACT('90012857', '21/03/2018'), 	T_ACT('90012858', '13/03/2018'), 	T_ACT('90013281', '12/02/2018'),
		T_ACT('90013406', '15/02/2018'), 	T_ACT('90014048', '12/03/2018'), 	T_ACT('90014117', '13/03/2018'), 	T_ACT('90014496', '14/02/2018'),
		T_ACT('90014834', '26/01/2018'), 	T_ACT('90014842', '21/02/2018'), 	T_ACT('90014861', '16/02/2018'), 	T_ACT('90014882', '13/03/2018'),
		T_ACT('90014889', '14/02/2018'), 	T_ACT('90015118', '14/03/2018'), 	T_ACT('90015423', '12/01/2018'), 	T_ACT('90235557', '23/01/2020'),
		T_ACT('90236084', '17/12/2019'), 	T_ACT('90093871', '02/03/2018'), 	T_ACT('90093891', '13/03/2018'), 	T_ACT('90093944', '15/03/2018'),
		T_ACT('90093952', '15/03/2018'), 	T_ACT('90093957', '15/03/2018'), 	T_ACT('90093974', '15/03/2018'), 	T_ACT('90094070', '22/03/2018'),
		T_ACT('90094124', '26/03/2018'), 	T_ACT('90094133', '06/04/2018'), 	T_ACT('90094148', '06/04/2018'), 	T_ACT('90094226', '08/05/2018'),
		T_ACT('90094233', '13/06/2018'), 	T_ACT('90094251', '28/06/2018'), 	T_ACT('90093293', '13/02/2018'), 	T_ACT('90093333', '02/03/2018'),
		T_ACT('90093873', '02/03/2018'), 	T_ACT('90093880', '02/03/2018'), 	T_ACT('90093884', '02/03/2018'), 	T_ACT('90093889', '02/03/2018'),
		T_ACT('90093907', '13/03/2018'), 	T_ACT('90093920', '13/03/2018'), 	T_ACT('90093921', '13/03/2018'), 	T_ACT('90094044', '19/03/2018'),
		T_ACT('90094047', '20/03/2018'), 	T_ACT('90094052', '20/03/2018'), 	T_ACT('90094111', '22/03/2018'), 	T_ACT('90094128', '05/04/2018'),
		T_ACT('90094131', '05/04/2018'), 	T_ACT('90094160', '06/04/2018'), 	T_ACT('90094170', '12/04/2018'), 	T_ACT('90094183', '20/04/2018'),
		T_ACT('90094247', '20/06/2018'), 	T_ACT('90097539', '21/03/2019'), 	T_ACT('90099445', '18/01/2018'), 	T_ACT('90099591', '21/03/2018'),
		T_ACT('90099739', '26/06/2018'), 	T_ACT('90102904', '22/11/2018'), 	T_ACT('90222054', '17/02/2020'), 	T_ACT('90015795', '16/04/2018'),
		T_ACT('90016017', '22/02/2018'), 	T_ACT('90016091', '14/02/2018'), 	T_ACT('90016872', '20/03/2018'), 	T_ACT('90017417', '14/02/2018'),
		T_ACT('90017850', '21/02/2018'), 	T_ACT('90017900', '22/02/2018'), 	T_ACT('90018202', '22/03/2018'), 	T_ACT('90018608', '15/03/2018'),
		T_ACT('90018765', '10/04/2018'), 	T_ACT('90019100', '15/03/2018'), 	T_ACT('90019548', '14/05/2018'), 	T_ACT('90019836', '14/05/2018'),
		T_ACT('90019891', '13/03/2018'), 	T_ACT('90019895', '22/02/2018'), 	T_ACT('90020185', '17/04/2018'), 	T_ACT('90020991', '08/03/2018'),
		T_ACT('90021018', '22/02/2018'), 	T_ACT('90021324', '10/04/2018'), 	T_ACT('90021767', '16/02/2018'), 	T_ACT('90022070', '17/05/2018'),
		T_ACT('90022417', '19/03/2018'), 	T_ACT('90022647', '24/04/2018'), 	T_ACT('90022797', '15/02/2018'), 	T_ACT('90022854', '22/02/2018'),
		T_ACT('90022914', '22/05/2018'), 	T_ACT('90023083', '24/04/2018'), 	T_ACT('90023337', '13/03/2018'), 	T_ACT('90023549', '13/04/2018'),
		T_ACT('90023611', '21/03/2018'), 	T_ACT('90023634', '14/02/2018'), 	T_ACT('90023700', '13/03/2018'), 	T_ACT('90024946', '08/03/2018'),
		T_ACT('90025162', '21/03/2018'), 	T_ACT('90025272', '13/04/2018'), 	T_ACT('90025427', '15/03/2018'), 	T_ACT('90025450', '23/04/2018'),
		T_ACT('90025958', '08/06/2018'), 	T_ACT('90026106', '21/03/2018'), 	T_ACT('90026341', '14/06/2018'), 	T_ACT('90026662', '19/03/2018'),
		T_ACT('90027157', '17/04/2018'), 	T_ACT('90028003', '10/04/2018'), 	T_ACT('90028007', '11/05/2018'), 	T_ACT('90028090', '17/04/2018'),
		T_ACT('90028117', '18/04/2018'), 	T_ACT('90029603', '15/06/2018'), 	T_ACT('90030497', '23/04/2018'), 	T_ACT('90030643', '14/05/2018'),
		T_ACT('90031810', '10/04/2018'), 	T_ACT('90031834', '22/03/2018'), 	T_ACT('90032005', '16/04/2018'), 	T_ACT('90032005', '17/04/2018'),
		T_ACT('90032386', '24/05/2018'), 	T_ACT('90032511', '17/04/2018'), 	T_ACT('90032696', '09/05/2018'), 	T_ACT('90032890', '22/02/2018'),
		T_ACT('90033964', '19/04/2018'), 	T_ACT('90034091', '16/05/2018'), 	T_ACT('90034325', '21/03/2018'), 	T_ACT('90034395', '18/04/2018'),
		T_ACT('90035036', '11/04/2018'), 	T_ACT('90036510', '15/05/2018'), 	T_ACT('90036621', '24/05/2018'), 	T_ACT('90036698', '15/05/2018'),
		T_ACT('90037036', '08/05/2018'), 	T_ACT('90037052', '24/05/2018'), 	T_ACT('90037061', '12/06/2018'), 	T_ACT('90037505', '10/05/2018'),
		T_ACT('90099549', '23/02/2018'), 	T_ACT('90099552', '26/02/2018'), 	T_ACT('90099575', '28/02/2018'), 	T_ACT('90099728', '26/06/2018'),
		T_ACT('90099734', '26/06/2018'), 	T_ACT('90106012', '20/11/2018'), 	T_ACT('90107843', '23/11/2018'), 	T_ACT('90112663', '24/10/2018'),
		T_ACT('90115552', '20/12/2018'), 	T_ACT('90117013', '03/08/2018'), 	T_ACT('90120928', '20/07/2018'), 	T_ACT('90123405', '14/12/2018'),
		T_ACT('90113848', '20/11/2018'), 	T_ACT('90120035', '18/01/2018'), 	T_ACT('90122902', '23/11/2018'), 	T_ACT('90125039', '19/02/2019'),
		T_ACT('90128698', '14/12/2018'), 	T_ACT('90235496', '23/01/2020'), 	T_ACT('90235496', '24/01/2020'), 	T_ACT('90241013', '19/03/2020'),
		T_ACT('90038367', '07/05/2018'), 	T_ACT('90038443', '19/07/2018'), 	T_ACT('90038884', '21/05/2018'), 	T_ACT('90041045', '18/04/2018'),
		T_ACT('90041125', '16/05/2018'), 	T_ACT('90041191', '21/05/2018'), 	T_ACT('90041301', '22/05/2018'), 	T_ACT('90044773', '08/05/2018'),
		T_ACT('90046599', '11/05/2018'), 	T_ACT('90046947', '11/06/2018'), 	T_ACT('90046948', '18/05/2018'), 	T_ACT('90047453', '14/06/2018'),
		T_ACT('90047749', '09/07/2018'), 	T_ACT('90047929', '17/05/2018'), 	T_ACT('90048639', '21/05/2018'), 	T_ACT('90050162', '11/05/2018'),
		T_ACT('90053037', '15/06/2018'), 	T_ACT('90053643', '20/06/2018'), 	T_ACT('90054497', '15/05/2018'), 	T_ACT('90055389', '07/06/2018'),
		T_ACT('71591030', '23/01/2018'), 	T_ACT('71685390', '15/01/2018'), 	T_ACT('72051135', '17/01/2018'), 	T_ACT('90126272', '28/12/2018'),
		T_ACT('90131062', '19/12/2018'), 	T_ACT('90134417', '18/12/2018'), 	T_ACT('90134636', '26/12/2018'), 	T_ACT('90139378', '28/12/2018'),
		T_ACT('90134478', '23/01/2019'), 	T_ACT('90135485', '21/01/2019'), 	T_ACT('90147684', '27/02/2019'), 	T_ACT('90151266', '06/03/2019'),
		T_ACT('90000802', '17/01/2018'), 	T_ACT('90001401', '14/03/2018'), 	T_ACT('90001888', '12/02/2018'), 	T_ACT('90002402', '23/01/2018'),
		T_ACT('90002455', '12/02/2018'), 	T_ACT('90002817', '11/01/2018'), 	T_ACT('90002851', '13/02/2018'), 	T_ACT('90003270', '09/02/2018'),
		T_ACT('90003346', '26/01/2018'), 	T_ACT('90003491', '25/01/2018'), 	T_ACT('90003516', '13/03/2018'), 	T_ACT('90003629', '16/01/2018'),
		T_ACT('90003826', '26/01/2018'), 	T_ACT('90003932', '14/03/2018'), 	T_ACT('90004053', '09/02/2018'), 	T_ACT('90004135', '10/01/2018'),
		T_ACT('90004168', '08/02/2018'), 	T_ACT('90004232', '12/02/2018'), 	T_ACT('90004589', '15/03/2018'), 	T_ACT('90004940', '09/02/2018'),
		T_ACT('90005048', '22/01/2018'), 	T_ACT('90005383', '24/05/2018'), 	T_ACT('90005589', '14/03/2018'), 	T_ACT('90005750', '13/02/2018'),
		T_ACT('90006099', '25/01/2018'), 	T_ACT('90006391', '23/01/2018'), 	T_ACT('90006404', '09/02/2018'), 	T_ACT('90006454', '21/02/2018'),
		T_ACT('90006971', '16/01/2018'), 	T_ACT('90006972', '15/02/2018'), 	T_ACT('90007078', '12/02/2018'), 	T_ACT('90007223', '14/02/2018'),
		T_ACT('90007334', '19/07/2018'), 	T_ACT('90007443', '15/03/2018'), 	T_ACT('90007551', '16/01/2018'), 	T_ACT('90008658', '15/02/2018'),
		T_ACT('90008993', '12/02/2018'), 	T_ACT('90009059', '15/02/2018'), 	T_ACT('90009667', '22/02/2018'), 	T_ACT('90009771', '22/02/2018'),
		T_ACT('90009950', '16/02/2018'), 	T_ACT('90010115', '15/03/2018'), 	T_ACT('90010190', '08/03/2018'), 	T_ACT('90010581', '09/02/2018'),
		T_ACT('90010652', '26/01/2018'), 	T_ACT('90010666', '23/05/2018'), 	T_ACT('90010813', '18/05/2018'), 	T_ACT('90011346', '21/02/2018'),
		T_ACT('90012013', '22/01/2018'), 	T_ACT('90012998', '15/02/2018'), 	T_ACT('90013291', '19/03/2018'), 	T_ACT('90013447', '09/02/2018'),
		T_ACT('90013477', '21/02/2018'), 	T_ACT('90013584', '15/02/2018'), 	T_ACT('90013734', '11/04/2018'), 	T_ACT('90013735', '13/03/2018'),
		T_ACT('90014059', '22/02/2018'), 	T_ACT('90014406', '19/03/2018'), 	T_ACT('90014499', '19/03/2018'), 	T_ACT('90014527', '20/02/2018'),
		T_ACT('90014772', '21/02/2018'), 	T_ACT('90014779', '13/03/2018'), 	T_ACT('90154329', '22/02/2019'), 	T_ACT('90156431', '14/03/2019'),
		T_ACT('90168162', '14/03/2019'), 	T_ACT('90172846', '21/05/2019'), 	T_ACT('90168932', '29/04/2019'), 	T_ACT('90093894', '13/03/2018'),
		T_ACT('90093900', '13/03/2018'), 	T_ACT('90093923', '15/03/2018'), 	T_ACT('90093950', '15/03/2018'), 	T_ACT('90094027', '16/03/2018'),
		T_ACT('90094055', '20/03/2018'), 	T_ACT('90094115', '22/03/2018'), 	T_ACT('90094166', '12/04/2018'), 	T_ACT('90094189', '20/04/2018'),
		T_ACT('90094195', '20/04/2018'), 	T_ACT('90094199', '20/04/2018'), 	T_ACT('90094230', '11/05/2018'), 	T_ACT('90094239', '20/06/2018'),
		T_ACT('90015453', '16/03/2018'), 	T_ACT('90015499', '21/02/2018'), 	T_ACT('90015577', '22/02/2018'), 	T_ACT('90015590', '14/02/2018'),
		T_ACT('90015729', '21/02/2018'), 	T_ACT('90015823', '07/03/2018'), 	T_ACT('90016900', '11/05/2018'), 	T_ACT('90017019', '08/03/2018'),
		T_ACT('90017571', '18/04/2018'), 	T_ACT('90017589', '16/04/2018'), 	T_ACT('90017610', '19/03/2018'), 	T_ACT('90017621', '16/03/2018'),
		T_ACT('90017785', '09/04/2018'), 	T_ACT('90017800', '16/02/2018'), 	T_ACT('90017871', '20/03/2018'), 	T_ACT('90018088', '22/02/2018'),
		T_ACT('90018169', '20/03/2018'), 	T_ACT('90018502', '09/03/2018'), 	T_ACT('90018564', '21/02/2018'), 	T_ACT('90019510', '02/03/2018'),
		T_ACT('90019565', '16/04/2018'), 	T_ACT('90019924', '07/03/2018'), 	T_ACT('90019926', '16/03/2018'), 	T_ACT('90020013', '17/04/2018'),
		T_ACT('90020078', '17/04/2018'), 	T_ACT('90020134', '13/03/2018'), 	T_ACT('90020152', '13/03/2018'), 	T_ACT('90020157', '13/03/2018'),
		T_ACT('90020812', '13/03/2018'), 	T_ACT('90021219', '18/04/2018'), 	T_ACT('90021437', '15/03/2018'), 	T_ACT('90021481', '16/03/2018'),
		T_ACT('90021647', '19/03/2018'), 	T_ACT('90022220', '19/03/2018'), 	T_ACT('90022286', '09/04/2018'), 	T_ACT('90022532', '07/05/2018'),
		T_ACT('90023246', '15/05/2018'), 	T_ACT('90023601', '16/03/2018'), 	T_ACT('90023633', '21/03/2018'), 	T_ACT('90023940', '07/03/2018'),
		T_ACT('90023943', '21/03/2018'), 	T_ACT('90023967', '20/03/2018'), 	T_ACT('90024295', '22/02/2018'), 	T_ACT('90024470', '19/03/2018'),
		T_ACT('90024785', '20/03/2018'), 	T_ACT('90024785', '09/04/2018'), 	T_ACT('90024820', '19/03/2018'), 	T_ACT('90024953', '11/04/2018'),
		T_ACT('90025960', '22/05/2018'), 	T_ACT('90026046', '17/04/2018'), 	T_ACT('90026065', '07/03/2018'), 	T_ACT('90026137', '07/03/2018'),
		T_ACT('90026140', '20/03/2018'), 	T_ACT('90026145', '19/03/2018'), 	T_ACT('90026296', '24/04/2018'), 	T_ACT('90026610', '15/05/2018'),
		T_ACT('90026783', '12/04/2018'), 	T_ACT('90027161', '20/04/2018'), 	T_ACT('90027293', '11/06/2018'), 	T_ACT('90027449', '18/04/2018'),
		T_ACT('90027652', '09/04/2018'), 	T_ACT('90027760', '07/03/2018'), 	T_ACT('90028313', '16/04/2018'), 	T_ACT('90028324', '19/03/2018'),
		T_ACT('90029817', '11/04/2018'), 	T_ACT('90030484', '17/04/2018'), 	T_ACT('90030908', '16/05/2018'), 	T_ACT('90031553', '14/05/2018'),
		T_ACT('90031730', '20/04/2018'), 	T_ACT('90031768', '20/03/2018'), 	T_ACT('90032300', '20/04/2018'), 	T_ACT('90032782', '18/04/2018'),
		T_ACT('90033528', '23/04/2018'), 	T_ACT('90033560', '15/05/2018'), 	T_ACT('90033752', '07/05/2018'), 	T_ACT('90034089', '16/05/2018'),
		T_ACT('90034222', '13/04/2018'), 	T_ACT('90034675', '18/04/2018'), 	T_ACT('90035075', '17/04/2018'), 	T_ACT('90036161', '21/05/2018'),
		T_ACT('90036420', '07/05/2018'), 	T_ACT('90036424', '18/04/2018'), 	T_ACT('90036480', '10/04/2018'), 	T_ACT('90036783', '16/04/2018'),
		T_ACT('90037194', '23/05/2018'), 	T_ACT('90037205', '07/05/2018'), 	T_ACT('90037282', '24/04/2018'), 	T_ACT('90037382', '11/06/2018'),
		T_ACT('90037968', '27/03/2018'), 	T_ACT('90038146', '15/05/2018'), 	T_ACT('90038910', '17/04/2018'), 	T_ACT('90039089', '17/05/2018'),
		T_ACT('90039377', '18/05/2018'), 	T_ACT('90039536', '11/05/2018'), 	T_ACT('90185992', '16/05/2019'), 	T_ACT('90196101', '07/08/2019'),
		T_ACT('90196541', '11/10/2019'), 	T_ACT('90203084', '09/09/2019'), 	T_ACT('90099455', '06/02/2018'), 	T_ACT('90099457', '06/02/2018'),
		T_ACT('90099461', '09/02/2018'), 	T_ACT('90099536', '12/02/2018'), 	T_ACT('90099537', '12/02/2018'), 	T_ACT('90099570', '27/02/2018'),
		T_ACT('90099573', '27/02/2018'), 	T_ACT('90099577', '28/02/2018'), 	T_ACT('90099579', '28/02/2018'), 	T_ACT('90099583', '06/03/2018'),
		T_ACT('90099737', '26/06/2018'), 	T_ACT('90099747', '27/07/2018'), 	T_ACT('90107248', '21/12/2018'), 	T_ACT('90114749', '11/02/2019'),
		T_ACT('90120018', '18/01/2018'), 	T_ACT('90120598', '20/12/2018'), 	T_ACT('90042670', '12/06/2018'), 	T_ACT('90043009', '23/05/2018'),
		T_ACT('90043207', '08/05/2018'), 	T_ACT('90044140', '21/05/2018'), 	T_ACT('90044375', '22/05/2018'), 	T_ACT('90044852', '22/05/2018'),
		T_ACT('90045201', '18/05/2018'), 	T_ACT('90045743', '07/05/2018'), 	T_ACT('90045765', '15/06/2018'), 	T_ACT('90046077', '17/05/2018'),
		T_ACT('90046345', '18/05/2018'), 	T_ACT('90047748', '08/05/2018'), 	T_ACT('90048242', '08/05/2018'), 	T_ACT('90048404', '07/06/2018'),
		T_ACT('90048682', '20/04/2018'), 	T_ACT('90048686', '18/06/2018'), 	T_ACT('90048707', '11/05/2018'), 	T_ACT('90048875', '24/05/2018'),
		T_ACT('90050192', '08/06/2018'), 	T_ACT('90050407', '24/05/2018'), 	T_ACT('90051283', '21/05/2018'), 	T_ACT('90051470', '11/06/2018'),
		T_ACT('90053523', '15/06/2018'), 	T_ACT('90054649', '14/06/2018'), 	T_ACT('90054811', '16/05/2018'), 	T_ACT('90219167', '13/11/2019'),
		T_ACT('90069170', '25/07/2018'), 	T_ACT('90227970', '20/01/2020'), 	T_ACT('90224929', '16/12/2019'), 	T_ACT('90229292', '08/01/2019'),
		T_ACT('90234816', '20/12/2019'), 	T_ACT('90235890', '24/01/2020'), 	T_ACT('90128532', '20/02/2019'), 	T_ACT('90130732', '10/01/2019'),
		T_ACT('54970189', '14/12/2015'), 	T_ACT('54935696', '14/12/2015'), 	T_ACT('61137373', '11/09/2018'), 	T_ACT('90085791', '20/09/2018'),
		T_ACT('90093280', '07/02/2018'), 	T_ACT('90093895', '13/03/2018'), 	T_ACT('90093897', '13/03/2018'), 	T_ACT('90093927', '15/03/2018'),
		T_ACT('90093934', '15/03/2018'), 	T_ACT('90093940', '15/03/2018'), 	T_ACT('90093971', '15/03/2018'), 	T_ACT('90094105', '22/03/2018'),
		T_ACT('90094116', '23/03/2018'), 	T_ACT('90094156', '06/04/2018'), 	T_ACT('90094163', '12/04/2018'), 	T_ACT('90094244', '20/06/2018'),
		T_ACT('90094252', '27/07/2018'), 	T_ACT('90094256', '27/07/2018'), 	T_ACT('90099436', '05/01/2018'), 	T_ACT('90099544', '22/02/2018'),
		T_ACT('90099559', '26/02/2018'), 	T_ACT('90099587', '09/03/2018'), 	T_ACT('90099712', '21/03/2018'), 	T_ACT('90099717', '26/03/2018'),
		T_ACT('90099723', '27/03/2018'), 	T_ACT('90099743', '28/06/2018'), 	T_ACT('90234303', '12/02/2020'), 	T_ACT('90234917', '27/09/2019'),
		T_ACT('90238064', '18/03/2020'), 	T_ACT('90240172', '23/01/2020'), 	T_ACT('90240183', '23/01/2020'), 	T_ACT('90242352', '24/01/2020'),
		T_ACT('90242363', '24/01/2020'), 	T_ACT('90237256', '12/03/2020'), 	T_ACT('90238039', '21/02/2020'), 	T_ACT('90158457', '31/01/2019'),
		T_ACT('90165399', '18/02/2019'), 	T_ACT('65623290', '08/03/2018')
	); 
	V_TMP_ACT T_ACT;

BEGIN
	DBMS_OUTPUT.PUT_LINE('[INICIO] Actualizaci√≥n masiva de campos:');

	FOR I IN V_ACT.FIRST .. V_ACT.LAST LOOP
		V_TMP_ACT := V_ACT(I);
		
		V_MSQL := 'SELECT COUNT(*) FROM OFR_OFERTAS WHERE OFR_NUM_OFERTA = '||V_TMP_ACT(1)||'';
		EXECUTE IMMEDIATE V_MSQL INTO V_NUM;
		
		IF V_NUM > 0 THEN
			
			EXECUTE IMMEDIATE 'MERGE INTO '||V_ESQUEMA||'.ECO_EXPEDIENTE_COMERCIAL ECO 
			USING(
				SELECT T1.OFR_ID FROM '||V_ESQUEMA||'.ECO_EXPEDIENTE_COMERCIAL T1
				JOIN '||V_ESQUEMA||'.OFR_OFERTAS OFR ON OFR.OFR_ID = T1.OFR_ID AND OFR.OFR_NUM_OFERTA = '||V_TMP_ACT(1)||'
			) T2
			ON (
				ECO.OFR_ID = T2.OFR_ID
			)
			WHEN MATCHED THEN UPDATE SET
				ECO.ECO_FECHA_CONT_PROPIETARIO = '''||V_TMP_ACT(2)||''', 
				ECO.USUARIOMODIFICAR = '''||V_USR||''',
				ECO.FECHAMODIFICAR = SYSDATE
			';
			
			DBMS_OUTPUT.PUT_LINE('	[INFO] Actualizada la oferta '||V_TMP_ACT(1)||' con ECO_FECHA_CONT_PROPIETARIO = '''||V_TMP_ACT(2)||'''.');
		ELSE
			DBMS_OUTPUT.PUT_LINE('	[WRN] No existe la oferta '||V_TMP_ACT(1)||'.');
		END IF;
	END LOOP;
	
	--ROLLBACK;
	COMMIT;

EXCEPTION
	WHEN OTHERS THEN
		ERR_NUM := SQLCODE;
		ERR_MSG := SQLERRM;
		DBMS_OUTPUT.put_line('[ERROR] Se ha producido un error en la ejecuci√≥n:'||TO_CHAR(ERR_NUM));
		DBMS_OUTPUT.put_line('-----------------------------------------------------------'); 
		DBMS_OUTPUT.put_line(ERR_MSG);
		ROLLBACK;
		RAISE;   
END;

/

EXIT;
