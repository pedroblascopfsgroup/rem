--/*
--#########################################
--## AUTOR=GUILLEM REY
--## FECHA_CREACION=20200417
--## ARTEFACTO=migracion
--## VERSION_ARTEFACTO=9.3
--## INCIDENCIA_LINK=REMVIP-7036
--## PRODUCTO=NO
--## 
--## Finalidad:
--##                    
--## INSTRUCCIONES:  
--## VERSIONES:
--##        0.1 Versión inicial
--#########################################
--*/

--Para permitir la visualización de texto en un bloque PL/SQL utilizando DBMS_OUTPUT.PUT_LINE

WHENEVER SQLERROR EXIT SQL.SQLCODE;
SET SERVEROUTPUT ON; 
SET DEFINE OFF;

DECLARE
    V_MSQL VARCHAR2(32000 CHAR); -- Sentencia a ejecutar    
    V_ESQUEMA VARCHAR2(25 CHAR):= '#ESQUEMA#'; -- Configuracion Esquemas
    V_ESQUEMA_M VARCHAR2(25 CHAR):= '#ESQUEMA_MASTER#'; -- Configuracion Esquema Master
    V_SQL VARCHAR2(4000 CHAR); -- Vble. para consulta que valida la existencia de una tabla.
    V_NUM_TABLAS NUMBER(16); -- Vble. para validar la existencia de una tabla.
    V_NUM_FILAS NUMBER(16); -- Vble. para validar la existencia de un registro.
    ERR_NUM NUMBER(25);  -- Vble. auxiliar para registrar errores en el script.
    ERR_MSG VARCHAR2(1024 CHAR); -- Vble. auxiliar para registrar errores en el script.
    PL_OUTPUT VARCHAR2(32000 char);
    
    V_USUARIO VARCHAR(50 CHAR):= 'REMVIP-7036';
    OFR_NUM_OFERTA NUMBER(16);
    TAP_CODIGO VARCHAR2(50 CHAR);
    ECO_NUM_EXPEDIENTE NUMBER(16);
    TRA_ID NUMBER(16);

BEGIN
    
    DBMS_OUTPUT.put_line('[INICIO]');


#ESQUEMA#.REPOSICIONAMIENTO_TRABAJO (''||V_USUARIO||'',
       '916660300001,
	916660200001,
	916660100001,
	916659800001,
	916659700001,
	916659700002,
	916659300001,
	916659300002,
	916659300003,
	916210700001,
	916659200001,
	916214200001,
	916215200001,
	916659000001,
	916658900001,
	916215600001,
	916658500001,
	916658000001,
	916658000002,
	916216200001,
	916654600001,
	916653600001,
	916652100001,
	916651100001,
	916650800001,
	916649800001,
	916649700001,
	916645600001,
	916644900001,
	916644500001,
	916643800001,
	916643700001,
	916643100001,
	916641000001,
	916640600001,
	916640200001,
	916640100001,
	916640000001,
	916639600001,
	916217100001,
	916639500001,
	916219000001,
	916220100001,
	916220200001,
	916639000001,
	916638600001,
	916638400001,
	916223600001,
	916638300001,
	916638200001,
	916224600001,
	916637800001,
	916637700001,
	916637600001,
	916637500001,
	916637500002,
	916225300001,
	916637400001,
	916225900001,
	916637000001,
	916636900001,
	916227400001,
	916227600001,
	916232000001,
	916232100001,
	916233200001,
	916233500001,
	916233500002,
	916233600001,
	916233600002,
	916233700001,
	916233700002,
	916233800001,
	916233800002,
	916233900001,
	916233900002,
	916234100001,
	916236300001,
	916633800001,
	916633500001,
	916633000001,
	916632400001,
	916632200001,
	916632100001,
	916237100001,
	916238300001,
	916239500001,
	916239600001,
	916631900001,
	916631900002,
	916631800001,
	916631800002,
	916631800003,
	916631700001,
	916631600001,
	916240300001,
	916631000001,
	916240900001,
	916244200001,
	916244600001,
	916630700001,
	916630600001,
	916630500001,
	916630200001,
	916630100001,
	916629900001,
	916247900001,
	916249300001,
	916249600001,
	916249800001,
	916628100001,
	916626300001,
	916626300002,
	916252900001,
	916625300001,
	916624500001,
	916254000001,
	916624000001,
	916623900001,
	916623600001,
	916254300001,
	916623500001,
	916256600001,
	916257100001,
	916622500001,
	916257700001,
	916622400001,
	916258300001,
	916621300001,
	916621000001,
	916260600001,
	916261600001,
	916271000001,
	916271000002,
	916271000003,
	916275400001,
	916276100001,
	916277500001,
	916619800001,
	916278200001,
	916278400001,
	916281700001,
	916619200001,
	916619200002,
	916619000001,
	916618900001,
	916281900001,
	916282900001,
	916283300001,
	916284300001,
	916285000001,
	916615800001,
	916286400001,
	916286500001,
	916286600001,
	916287500001,
	916288800001,
	916288900001,
	916289000001,
	916290200001,
	916291400001,
	916291500001,
	916615700001,
	916291900001,
	916292700001,
	916293200001,
	916615200001,
	916293800001,
	916614700001,
	916296200001,
	916304600001,
	916305000001,
	916305300001,
	916614400001,
	916306000001,
	916307000001,
	916307700001,
	916613600001,
	916308000001,
	916613100001,
	916612800001,
	916612600001,
	916612500001,
	916612400001,
	916612000001,
	916611900001,
	916311300001,
	916311500001,
	916611800001,
	916312600001,
	916312600002,
	916312600003,
	916312600004,
	916313200001,
	916611500001,
	916611400001,
	916611300001,
	916611200001,
	916611100001,
	916611000001,
	916315200001,
	916316300001,
	916316300002,
	916316300003,
	916610700001,
	916316400001,
	916316400002,
	916316400003,
	916316600001,
	916316600002,
	916316600003,
	916317000001,
	916317000002,
	916317000003,
	916317200001,
	916317200002,
	916317200003,
	916317400001,
	916317400002,
	916317400003,
	916317500001,
	916317500002,
	916317500003,
	916317700001,
	916317700002,
	916317700003,
	916317800001,
	916317800002,
	916317800003,
	916321300001,
	916324300001,
	916335200001,
	916336400001,
	916341100001,
	916341200001,
	916341300001,
	916343600001,
	916344100001,
	916344400001,
	916346600001,
	916347500001,
	916610000001,
	916347900001,
	916348100001,
	916350100001,
	916609100001,
	916350700001,
	916607800001,
	916607800002,
	916607600001,
	916351100001,
	916351500001,
	916353300001,
	916606900001,
	916606700001,
	916606300001,
	916605400001,
	916353700001,
	916354100001,
	916354400001,
	916354400002,
	916605200001,
	916354700001,
	916355300001,
	916355600001,
	916355600002,
	916604300001,
	916603900001,
	916355800001,
	916356700001,
	916601800001,
	916358300001,
	916360000001,
	916599900001,
	916361600001,
	916362400001,
	916363400001,
	916365300001,
	916365600001,
	916365700001,
	916365900001,
	916366000001,
	916366200001,
	916368200001,
	916368700001,
	916368800001,
	916369500001,
	916369800001,
	916371000001,
	916371100001,
	916371300001,
	916598600001,
	916598500001,
	916598300001,
	916598300002,
	916372000001,
	916598000001,
	916598000002,
	916597900001,
	916597800001,
	916597700001,
	916373600001,
	916597200001,
	916373800001,
	916596200001,
	916596100001,
	916375300001,
	916375700001,
	916595700001,
	916595400001,
	916376700001,
	916595300001,
	916376900001,
	916380900001,
	916594000001,
	916381900001,
	916593800001,
	916593600001,
	916593100001,
	916592900001,
	916592700001,
	916592600001,
	916592500001,
	916592100001,
	916591800001,
	916591600001,
	916591400001,
	916591300001,
	916591100001,
	916590800001,
	916590700001,
	916590600001,
	916590500001,
	916590400001,
	916590300001,
	916590100001,
	916588100001,
	916587500001,
	916382400001,
	916382500001,
	916383000001,
	916383200001,
	916384500001,
	916386400001,
	916386900001,
	916586900001,
	916586400001,
	916586300001,
	916387500001,
	916586200001,
	916586100001,
	916586000001,
	916585800001,
	916584700001,
	916584100001,
	916584000001,
	916583900001,
	916583500001,
	916583200001,
	916582700001,
	916582500001,
	916582400001,
	916582200001,
	916582100001,
	916582000001,
	916581800001,
	916581600001,
	916388200001,
	916579100001,
	916388700001,
	916389900001,
	916390100001,
	916391400001,
	916576100001,
	916575100001,
	916574800001,
	916574100001,
	916574000001,
	916573700001,
	916573700002,
	916571600001,
	916571500001,
	916571400001,
	916392700001,
	916571100001,
	916393200001,
	916570900001,
	916568300001,
	916567700001,
	916567700002,
	916393700001,
	916393700002,
	916393900001,
	916393900002,
	916394000001,
	916395600001,
	916396000001,
	916396300001,
	916565800001,
	916397200001,
	916564900001,
	916564800001,
	916564500001,
	916397500001,
	916397700001,
	916397800001,
	916563300001,
	916563200001,
	916562900001,
	916397900001,
	916398100001,
	916561800001,
	916561400001,
	916398200001,
	916399200001,
	916560600001,
	916399400001,
	916399500001,
	916399600001,
	916400200001,
	916560000001,
	916400900001,
	916401500001,
	916558700001,
	916558700002,
	916558700003,
	916558700004,
	916558600001,
	916558200001,
	916557900001,
	916401900001,
	916556400001,
	916404700001,
	916555900001,
	916405700001,
	916405700002,
	916406100001,
	916555700001,
	916406200001,
	916554800001,
	916554700001,
	916554100001,
	916553900001,
	916553800001,
	916553700001,
	916553600001,
	916407700001,
	916407800001,
	916552100001,
	916552000001,
	916551700001,
	916551600001,
	916551500001,
	916550600001,
	916550500001,
	916550400001,
	916550300001,
	916550200001,
	916550100001,
	916550000001,
	916549900001,
	916549800001,
	916549700001,
	916549600001,
	916549500001,
	916549400001,
	916549300001,
	916549200001,
	916549100001,
	916548900001,
	916548700001,
	916548300001,
	916548300002,
	916545200001,
	916544800001,
	916544600001,
	916544400001,
	916544200001,
	916543900001,
	916542800001,
	916542600001,
	916542400001,
	916541600001,
	916541300001,
	916541100001,
	916541000001,
	916540900001,
	916540800001,
	916540700001,
	916540600001,
	916540500001,
	916540400001,
	916540300001,
	916540200001,
	916540100001,
	916540000001,
	916539900001,
	916539800001,
	916539700001,
	916539600001,
	916539500001,
	916539400001,
	916539300001,
	916539200001,
	916539100001,
	916539000001,
	916538900001,
	916538700001,
	916538500001,
	916538400001,
	916538200001,
	916538100001,
	916538000001,
	916537900001,
	916537800001,
	916537700001,
	916537600001,
	916537400001,
	916537200001,
	916536900001,
	916536700001,
	916536500001,
	916536200001,
	916407900001,
	916536000001,
	916532300001,
	916531000001,
	916530500001,
	916530300001,
	916530000001,
	916529800001,
	916529600001,
	916529500001,
	916529300001,
	916529200001,
	916529000001,
	916528700001,
	916528500001,
	916528400001,
	916528200001,
	916528000001,
	916527900001,
	916527800001,
	916527200001,
	916408100001,
	916522500001,
	916522300001,
	916522100001,
	916521900001,
	916521700001,
	916521600001,
	916521400001,
	916521200001,
	916521100001,
	916521000001,
	916520600001,
	916520500001,
	916520400001,
	916520300001,
	916520200001,
	916520000001,
	916519900001,
	916519800001,
	916519600001,
	916519500001,
	916519400001,
	916519200001,
	916519000001,
	916518900001,
	916518800001,
	916518700001,
	916518600001,
	916518500001,
	916518400001,
	916518300001,
	916518100001,
	916517900001,
	916517600001,
	916517500001,
	916517400001,
	916517300001,
	916517200001,
	916517000001,
	916516900001,
	916516700001,
	916516600001,
	916516500001,
	916516400001,
	916516300001,
	916516200001,
	916516200002,
	916516100001,
	916516000001,
	916515900001,
	916515800001,
	916515700001,
	916515600001,
	916515500001,
	916515400001,
	916515300001,
	916515200001,
	916515100001,
	916515000001,
	916514900001,
	916514800001,
	916514700001,
	916514500001,
	916514000001,
	916513700001,
	916408200001,
	916513600001,
	916513400001,
	916513300001,
	916513000001,
	916512900001,
	916512800001,
	916512600001,
	916408500001,
	916408700001,
	916408800001,
	916408900001,
	916512200001,
	916511600001,
	916511400001,
	916409000001,
	916511200001,
	916510800001,
	916510700001,
	916409200001,
	916409200002,
	916510500001,
	916510200001,
	916510100001,
	916509300001,
	916508900001,
	916409600001,
	916409600002,
	916508800001,
	916508200001,
	916410200001,
	916410300001,
	916410500001,
	916410700001,
	916507300001,
	916410800001,
	916411000001,
	916411100001,
	916506600001,
	916506500001,
	916506400001,
	916411200001,
	916506000001,
	916505600001,
	916505200001,
	916505100001,
	916504700001,
	916504600001,
	916411300001,
	916504100001,
	916504000001,
	916411400001,
	916502900001,
	916501900001,
	916411600001,
	916501400001,
	916501400002,
	916412400001,
	916500300001,
	916500200001,
	916415400001,
	916499800001,
	916497900001,
	916497600001,
	916497500001,
	916497400001,
	916497100001,
	916496600001,
	916496300001,
	916495100001,
	916494900001,
	916494900002,
	916494700001,
	916494600001,
	916494500001,
	916494300001,
	916494300002,
	916493900001,
	916493400001,
	916493300001,
	916415500001,
	916416000001,
	916492900001,
	916416400001,
	916492800001,
	916492500001,
	916491900001,
	916491800001,
	916491700001,
	916491400001,
	916491400002,
	916491300001,
	916416800001,
	916417600001,
	916418000001,
	916487800001,
	916487500001,
	916418200001,
	916487000001,
	916419100001,
	916483800001,
	916483200001,
	916419200001,
	916419200002,
	916482600001,
	916482500001,
	916420100001,
	916420700001,
	916421000001,
	916482300001,
	916423400001,
	916423900001,
	916482000001,
	916424700001,
	916425400001,
	916481800001,
	916481700001,
	916481600001,
	916481300001,
	916481200001,
	916481100001,
	916480800001,
	916480700001,
	916480500001,
	916480100001,
	916478400001,
	916478300001,
	916477700001,
	916477400001,
	916477200001,
	916426100001,
	916476900001,
	916476600001,
	916426900001,
	916427200001,
	916427700001,
	916475000001,
	916427900001,
	916428000001,
	916474700001,
	916428800001,
	916474600001,
	916474500001,
	916431000001,
	916474100001,
	916473800001,
	916473700001,
	916431200001,
	916472700001,
	916472600001,
	916431300001,
	916432000001,
	916472200001,
	916472200002,
	916472200003,
	916472000001,
	916471000001,
	916432100001,
	916470400001,
	916470300001,
	916470000001,
	916469500001,
	916433300001,
	916469100001,
	916468900001,
	916468800001,
	916468700001,
	916468300001,
	916468200001,
	916468100001,
	916467300001,
	916434900001,
	916467200001,
	916435100001,
	916435200001,
	916435400001,
	916466800001,
	916466500001,
	916466000001,
	916465900001,
	916465800001,
	916465700001,
	916465600001,
	916465500001,
	916465100001,
	916465100002,
	916464500001,
	916464300001,
	916464200001,
	916464100001,
	916463700001,
	916463500001,
	916462600001,
	916436200001,
	916461700001,
	916436800001,
	916461200001,
	916460900001,
	916460800001,
	916460700001,
	916460600001,
	916460500001,
	916460100001,
	916459900001,
	916459500001,
	916459400001,
	916459000001,
	916458700001,
	916458400001,
	916457800001,
	916456800001,
	916456700001,
	916456700002,
	916456700003,
	916456500001,
	916455500001,
	916436900001,
	916455000001,
	916454600001,
	916437000001,
	916438600001,
	916452300001,
	916452000001,
	916439900001,
	916451200001,
	916451000001,
	916450900001,
	916450500001,
	916450000001,
	916449400001,
	916447200001,
	916446800001,
	916445200001,
	916445100001,
	916445000001,
	916443500001,
	916443300001,
	916442600001,
	916441800001,
	916441400001,
	916441000001,
	916440900001,
	916440500001'
        , 'T004_ResultadoTarificada');
        
        #ESQUEMA#.ALTA_BPM_INSTANCES(''||V_USUARIO||'', PL_OUTPUT);
    
	COMMIT;
 DBMS_OUTPUT.put_line('[OK]');
 DBMS_OUTPUT.put_line('[FIN]');
EXCEPTION
     WHEN OTHERS THEN
          ERR_NUM := SQLCODE;
          ERR_MSG := SQLERRM;
          DBMS_OUTPUT.put_line('[ERROR] Se ha producido un error en la ejecución:'||TO_CHAR(ERR_NUM));
          DBMS_OUTPUT.put_line('-----------------------------------------------------------'); 
          DBMS_OUTPUT.put_line(ERR_MSG);
          ROLLBACK;
          RAISE;   
END;
/
EXIT;