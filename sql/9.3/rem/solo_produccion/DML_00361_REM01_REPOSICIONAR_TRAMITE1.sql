--/*
--#########################################
--## AUTOR=PIER GOTTA
--## FECHA_CREACION=20200630
--## ARTEFACTO=online
--## VERSION_ARTEFACTO=9.3
--## INCIDENCIA_LINK=REMVIP-7504
--## PRODUCTO=NO
--## 
--## Finalidad:
--##                    
--## INSTRUCCIONES:  
--## VERSIONES:
--##        0.1 Versión inicial
--#########################################
--*/

--Para permitir la visualización de texto en un bloque PL/SQL utilizando DBMS_OUTPUT.PUT_LINE

WHENEVER SQLERROR EXIT SQL.SQLCODE;
SET SERVEROUTPUT ON; 
SET DEFINE OFF;

DECLARE
    V_MSQL VARCHAR2(32000 CHAR); -- Sentencia a ejecutar    
    V_ESQUEMA VARCHAR2(25 CHAR):= '#ESQUEMA#'; -- Configuracion Esquemas
    V_ESQUEMA_M VARCHAR2(25 CHAR):= '#ESQUEMA_MASTER#'; -- Configuracion Esquema Master
    V_SQL VARCHAR2(4000 CHAR); -- Vble. para consulta que valida la existencia de una tabla.
    V_NUM_TABLAS NUMBER(16); -- Vble. para validar la existencia de una tabla.
    V_NUM_FILAS NUMBER(16); -- Vble. para validar la existencia de un registro.
    ERR_NUM NUMBER(25);  -- Vble. auxiliar para registrar errores en el script.
    ERR_MSG VARCHAR2(1024 CHAR); -- Vble. auxiliar para registrar errores en el script.
    PL_OUTPUT VARCHAR2(32000 char);
    
    V_USUARIO VARCHAR(50 CHAR):= 'REMVIP-7504';
    OFR_NUM_OFERTA NUMBER(16);
    TAP_CODIGO VARCHAR2(50 CHAR);
    ECO_NUM_EXPEDIENTE NUMBER(16);
    TRA_ID NUMBER(16);

BEGIN
    
    DBMS_OUTPUT.put_line('[INICIO]');


#ESQUEMA#.REPOSICIONAMIENTO_TRABAJO(''||V_USUARIO||'',
       TRIM('150178,
106780,
31846,
46676,
52021,
55367,
56002,
56642,
56977,
57650,
63397,
76018,
77320,
77501,
78875,
79470,
81670,
82116,
82502,
87617,
87824,
89633,
90218,
90484,
90652,
90725,
91558,
91877,
92115,
92597,
93034,
93052,
93053,
93327,
96098,
96206,
96341,
97181,
97996,
98156,
98315,
98385,
98418,
98440,
98689,
99522,
99906,
99912,
99944,
100031,
100902,
100906,
101091,
101598,
102647,
102922,
103040,
103651,
103786,
103916,
103929,
104034,
104585,
104585,
104585,
105338,
105600,
105968,
106231,
106301,
107353,
107353,
107371,
108040,
108095,
108263,
108263,
108383,
108741,
108915,
109023,
109376,
109468,
109483,
109543,
110254,
110256,
110267,
110318,
110319,
110351,
110364,
110437,
110443,
110481,
110485,
110520,
110582,
110716,
110877,
110909,
110947,
111083,
111384,
112002,
112018,
112019,
112020,
112021,
112022,
112023,
112025,
112026,
112027,
112028,
112029,
112030,
112031,
112033,
112035,
112036,
112037,
112038,
112163,
112204,
112451,
113221,
114981,
116212,
116607,
116648,
118005,
118457,
118610,
118944,
119155,
119244,
119343,
119368,
119448,
119548,
119715,
119761,
119787,
119924,
119944,
120030,
120033,
120034,
120180,
120270,
120274,
120340,
120373,
121394,
122865,
123106,
123382,
124624,
124637,
127107,
127736,
127991,
128047,
128235,
130346,
130656,
130962,
131638,
131695,
131795,
132273,
132623,
133530,
133956,
133999,
134850,
135193,
135266,
135396,
136211,
136249,
136324,
136324,
136370,
136623,
136648,
136660,
136739,
137651,
137651,
137651,
138017,
138548,
138776,
138778,
138852,
138866,
138870,
138893,
138963,
138964,
138982,
139041,
139051,
139073,
139090,
139246,
139261,
139398,
139456,
139653,
139967,
139990,
139990,
139990,
140007,
140007,
140069,
140141,
140757,
141092,
141195,
141236,
141411,
141656,
141752,
141830,
141900,
142190,
142238,
142265,
142270,
142387,
142449,
142948,
142965,
143021,
143698,
143808,
144055,
144056,
144208,
144256,
144352,
144386,
144533,
144571,
144666,
144790,
144790,
144790,
144892,
144914,
145233,
145363,
145604,
146330,
146456,
146463,
146704,
146750,
146980,
146984,
147009,
147009,
147011,
147057,
147095,
147095,
147132,
147155,
147155,
147207,
147251,
147336,
147342,
147343,
147389,
147431,
147431,
147480,
147480,
147543,
147543,
147590,
147618,
147632,
147634,
147634,
147675,
147688,
147694,
147694,
147771,
147785,
147810,
147833,
147835,
147840,
147840,
147883,
147888,
147889,
147890,
147899,
147926,
147986,
148002,
148002,
148041,
148062,
148067,
148067,
148080,
148081,
148087,
148100,
148116,
148129,
148199,
148269,
148269,
148269,
148273,
148273,
148305,
148407,
148407,
148441,
148455,
148455,
148488,
148527,
148527,
148527,
148538,
148539,
148539,
148545,
148546,
148570,
148585,
148585,
148592,
148592,
148592,
148609,
148610,
148613,
148614,
148614,
148614,
148614,
148615,
148618,
148643,
148643,
148646,
148646,
148649,
148674,
148677,
148677,
148699,
148699,
148699,
148719,
148719,
148719,
148720,
148720,
148720,
148727,
148765,
148779,
148825,
148825,
148825,
148840,
148877,
148877,
148896,
148896,
148900,
148901,
148901,
148901,
148924,
148924,
148924,
148937,
148937,
148943,
148943,
148969,
148969,
148980,
149000,
149100,
149124,
149124,
149209,
149209,
149223,
149226,
149226,
149226,
149270,
149270,
149308,
149308,
149308,
149308,
149324,
149324,
149324,
149329,
149364,
149376,
149376,
149379,
149379,
149381,
149381,
149384,
149402,
149440,
149471,
149474,
149490,
149494,
149501,
149501,
149527,
149527,
149527,
149527,
149527,
149539,
149583,
149695,
149713,
149716,
149717,
149724,
149773,
149783,
149885,
149901,
149934,
149958,
149994,
150009,
150009,
150009,
150059,
150060,
150066,
150114,
150114,
150115,
150115,
150119,
150136,
150175,
150181,
150181,
150182,
150231,
150244,
150249,
150268,
150313,
150321,
150323,
150328,
150330,
150330,
150349,
150364,
150365,
150365,
150365,
150365,
150365,
150365,
150365,
150365,
150365,
150371,
150371,
150387,
150392,
150428,
150428,
150428,
150428,
150431,
150431,
150445,
150497,
150497,
150512,
150512,
150532,
150607,
150663,
150714,
150717,
150738,
150740,
150756,
150756,
150756,
150756,
150756,
150773,
150778,
150778,
150778,
150837,
150838,
151097,
151097,
151105,
151105,
151105,
151105,
151107,
151114,
151124,
151133,
151140,
151148,
151153,
151153,
151153,
151157,
151159,
151191,
151194,
151208,
151328,
151328,
151328,
151329,
151336,
151341,
151343,
151363,
151399,
151429,
151453,
151453,
151461,
151516,
151531,
151531,
151543,
151547,
151560,
151577,
151582,
151597,
151619,
151647,
151651,
151651,
151654,
151658,
151665,
151665,
151680,
151685,
151685,
151687,
151687,
151691,
151693,
151785,
151796,
151796,
151801,
151810,
151829,
151835,
151836,
151836,
151863
')
        , 'T004_ResultadoTarificada');
        
        #ESQUEMA#.ALTA_BPM_INSTANCES(''||V_USUARIO||'', PL_OUTPUT);
    
	COMMIT;
 DBMS_OUTPUT.put_line('[OK]');
 DBMS_OUTPUT.put_line('[FIN]');
EXCEPTION
     WHEN OTHERS THEN
          ERR_NUM := SQLCODE;
          ERR_MSG := SQLERRM;
          DBMS_OUTPUT.put_line('[ERROR] Se ha producido un error en la ejecución:'||TO_CHAR(ERR_NUM));
          DBMS_OUTPUT.put_line('-----------------------------------------------------------'); 
          DBMS_OUTPUT.put_line(ERR_MSG);
          ROLLBACK;
          RAISE;   
END;
/
EXIT;
