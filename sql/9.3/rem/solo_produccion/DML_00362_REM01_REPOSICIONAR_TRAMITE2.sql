--/*
--#########################################
--## AUTOR=PIER GOTTA
--## FECHA_CREACION=20200630
--## ARTEFACTO=online
--## VERSION_ARTEFACTO=9.3
--## INCIDENCIA_LINK=REMVIP-7504
--## PRODUCTO=NO
--## 
--## Finalidad:
--##                    
--## INSTRUCCIONES:  
--## VERSIONES:
--##        0.1 Versión inicial
--#########################################
--*/

--Para permitir la visualización de texto en un bloque PL/SQL utilizando DBMS_OUTPUT.PUT_LINE

WHENEVER SQLERROR EXIT SQL.SQLCODE;
SET SERVEROUTPUT ON; 
SET DEFINE OFF;

DECLARE
    V_MSQL VARCHAR2(32000 CHAR); -- Sentencia a ejecutar    
    V_ESQUEMA VARCHAR2(25 CHAR):= '#ESQUEMA#'; -- Configuracion Esquemas
    V_ESQUEMA_M VARCHAR2(25 CHAR):= '#ESQUEMA_MASTER#'; -- Configuracion Esquema Master
    V_SQL VARCHAR2(4000 CHAR); -- Vble. para consulta que valida la existencia de una tabla.
    V_NUM_TABLAS NUMBER(16); -- Vble. para validar la existencia de una tabla.
    V_NUM_FILAS NUMBER(16); -- Vble. para validar la existencia de un registro.
    ERR_NUM NUMBER(25);  -- Vble. auxiliar para registrar errores en el script.
    ERR_MSG VARCHAR2(1024 CHAR); -- Vble. auxiliar para registrar errores en el script.
    PL_OUTPUT VARCHAR2(32000 char);
    
    V_USUARIO VARCHAR(50 CHAR):= 'REMVIP-7504';
    OFR_NUM_OFERTA NUMBER(16);
    TAP_CODIGO VARCHAR2(50 CHAR);
    ECO_NUM_EXPEDIENTE NUMBER(16);
    TRA_ID NUMBER(16);

BEGIN
    
    DBMS_OUTPUT.put_line('[INICIO]');


#ESQUEMA#.REPOSICIONAMIENTO_TRABAJO(''||V_USUARIO||'',
       TRIM('

151943,
151953,
151971,
151974,
151976,
151986,
152019,
152025,
152107,
152167,
152242,
152306,
152365,
152379,
152392,
152393,
152420,
152425,
152483,
152511,
152521,
152522,
152556,
152571,
152591,
152641,
152653,
152664,
152684,
152727,
152728,
152751,
152772,
152806,
152806,
152822,
152836,
152837,
152882,
152908,
152912,
152932,
152994,
153016,
153019,
153033,
153113,
153115,
153144,
153235,
153247,
153299,
153299,
153325,
153356,
153356,
153377,
153497,
153551,
153568,
153597,
153609,
153658,
153664,
153670,
153695,
153755,
153775,
153784,
153826,
153826,
153861,
153900,
153900,
153926,
154026,
154028,
154033,
154056,
154181,
154184,
154189,
154238,
154245,
154263,
154299,
154328,
154352,
154502,
154545,
154664,
154664,
154686,
154687,
154767,
154803,
154852,
154912,
154945,
154975,
154981,
155013,
155033,
155054,
155062,
155069,
155154,
155200,
155247,
155280,
155374,
155397,
155616,
155630,
155630,
155683,
155711,
155719,
155731,
155784,
155859,
155963,
156059,
156077,
156103,
156195,
156260,
156260,
156478,
156503,
156549,
156563,
156591,
156596,
156596,
156628,
156667,
156667,
157324,
157385,
157463,
157527,
157528,
157541,
157568,
157601,
157644,
157645,
157648,
157649,
157649,
157651,
157656,
157815,
157903,
157996,
157996,
158010,
158033,
158073,
158103,
158120,
158204,
158213,
158297,
158339,
158358,
158384,
158384,
158454,
158472,
158560,
158561,
158612,
158615,
158618,
158618,
158626,
158634,
158663,
158673,
158737,
158806,
158821,
158825,
158939,
158946,
158994,
159045,
159056,
159083,
159084,
159103,
159146,
159157,
159195,
159218,
159242,
159272,
159277,
159286,
159313,
159333,
159366,
159474,
159477,
159490,
159513,
159589,
159607,
159670,
159686,
159744,
159763,
159797,
159803,
159851,
159910,
159923,
159949,
159968,
159973,
159974,
160147,
160191,
160256,
160259,
160270,
160270,
160281,
160323,
160324,
160324,
160510,
160625,
160632,
160720,
160816,
160817,
160818,
160822,
160926,
160988,
161346,
161383,
161446,
161450,
161544,
161585,
161611,
161614,
161693,
161759,
161777,
161840,
161840,
161851,
161853,
161855,
161855,
161922,
161945,
161983,
162032,
162121,
162121,
162126,
162160,
162314,
162375,
162379,
162474,
162536,
162599,
162673,
162791,
162851,
162911,
162965,
162997,
163059,
163120,
163138,
163155,
163224,
163312,
163331,
163391,
163415,
163454,
163454,
163521,
163525,
163525,
163526,
163539,
163587,
163711,
163769,
163774,
163786,
163790,
163794,
163805,
163807,
163826,
163830,
163835,
163918,
163929,
163943,
163958,
163958,
164043,
164270,
164289,
164298,
164315,
164486,
164547,
164603,
164613,
164665,
164688,
164713,
164744,
164754,
164760,
164808,
164829,
164829,
164845,
164862,
164885,
164933,
164939,
164943,
164963,
164965,
164971,
164979,
165040,
165048,
165059,
165069,
165079,
165083,
165083,
165083,
165083,
165083,
165083,
165083,
165083,
165083,
165083,
165083,
165083,
165083,
165083,
165083,
165083,
165083,
165083,
165083,
165083,
165083,
165083,
165083,
165083,
165083,
165083,
165083,
165083,
165083,
165206,
165255,
165266,
165299,
165334,
165360,
165361,
165378,
165387,
165425,
165445,
165489,
165500,
165518,
165531,
165533,
165537,
165587,
165617,
165683,
165688,
165790,
165808,
165979,
166011,
166011,
166018,
166024,
166025,
166069,
166070,
166072,
166128,
166130,
166214,
166237,
166258,
166263,
166307,
166308,
166348,
166355,
166366,
166423,
166486,
166504,
166507,
166516,
166517,
166543,
166622,
166640,
166693,
166693,
166724,
166745,
166926,
167103,
167105,
167255,
167261,
167297,
167416,
167424,
167450,
167450,
167546,
167547,
167548,
167555,
167569,
167595,
167609,
167663,
167668,
167710,
167717,
167815,
167816,
167819,
167860,
167860,
167864,
167867,
167898,
167924,
167928,
168057,
168108,
168129,
168166,
168301,
168353,
168362,
168392,
168392,
168460,
168479,
168753,
168941,
168988,
169003,
169009,
169044,
169055,
169277,
169279,
169295,
169377,
169425,
169565,
169595,
169627,
169721,
169731,
169775,
169912,
169960,
170490,
170847,
166717,
9000039530,
9000040016,
9000040564,
9000041428,
9000041612,
9000042180,
9000042557,
9000045018,
9000046089,
9000046232,
9000046583,
9000053521,
147338,
150751,
148498,
158198,
151716,
151925,
157386,
159356,
162865,
166717,
9000040849,
168311,
9000046939
')
        , 'T004_ResultadoTarificada');
        
        #ESQUEMA#.ALTA_BPM_INSTANCES(''||V_USUARIO||'', PL_OUTPUT);
    
	COMMIT;
 DBMS_OUTPUT.put_line('[OK]');
 DBMS_OUTPUT.put_line('[FIN]');
EXCEPTION
     WHEN OTHERS THEN
          ERR_NUM := SQLCODE;
          ERR_MSG := SQLERRM;
          DBMS_OUTPUT.put_line('[ERROR] Se ha producido un error en la ejecución:'||TO_CHAR(ERR_NUM));
          DBMS_OUTPUT.put_line('-----------------------------------------------------------'); 
          DBMS_OUTPUT.put_line(ERR_MSG);
          ROLLBACK;
          RAISE;   
END;
/
EXIT;
