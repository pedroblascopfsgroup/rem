--/*
--##########################################
--## AUTOR=PIER GOTTA
--## FECHA_CREACION=20200630
--## ARTEFACTO=online
--## VERSION_ARTEFACTO=9.3
--## INCIDENCIA_LINK=REMVIP-7504
--## PRODUCTO=NO
--##
--## Finalidad: Script que reposiciona trabajos.
--## INSTRUCCIONES:
--## VERSIONES:
--##        0.1 Versi√≥n inicial
--##########################################
--*/
WHENEVER SQLERROR EXIT SQL.SQLCODE;
SET SERVEROUTPUT ON; 
SET DEFINE OFF;


DECLARE
    V_MSQL VARCHAR2(32000 CHAR); -- Sentencia a ejecutar     
    V_ESQUEMA VARCHAR2(25 CHAR):= '#ESQUEMA#'; -- Configuracion Esquema
    V_ESQUEMA_M VARCHAR2(25 CHAR):= '#ESQUEMA_MASTER#'; -- Configuracion Esquema Master
    V_SQL VARCHAR2(4000 CHAR); -- Vble. para consulta que valida la existencia de una tabla.
    V_NUM_TABLAS NUMBER(16); -- Vble. para validar la existencia de una tabla.   
    ERR_NUM NUMBER(25);  -- Vble. auxiliar para registrar errores en el script.
    ERR_MSG VARCHAR2(1024 CHAR); -- Vble. auxiliar para registrar errores en el script.
	
    V_TEXT1 VARCHAR2(2400 CHAR); -- Vble. auxiliar
    V_ENTIDAD_ID NUMBER(16);
    V_ID NUMBER(16);
    
    TYPE T_TIPO_DATA IS TABLE OF VARCHAR2(150);
    TYPE T_ARRAY_DATA IS TABLE OF T_TIPO_DATA;
    V_TIPO_DATA T_ARRAY_DATA := T_ARRAY_DATA(

			T_TIPO_DATA(150178),
			T_TIPO_DATA(106780),
			T_TIPO_DATA(31846),
			T_TIPO_DATA(46676),
			T_TIPO_DATA(52021),
			T_TIPO_DATA(55367),
			T_TIPO_DATA(56002),
			T_TIPO_DATA(56642),
			T_TIPO_DATA(56977),
			T_TIPO_DATA(57650),
			T_TIPO_DATA(63397),
			T_TIPO_DATA(76018),
			T_TIPO_DATA(77320),
			T_TIPO_DATA(77501),
			T_TIPO_DATA(78875),
			T_TIPO_DATA(79470),
			T_TIPO_DATA(81670),
			T_TIPO_DATA(82116),
			T_TIPO_DATA(82502),
			T_TIPO_DATA(87617),
			T_TIPO_DATA(87824),
			T_TIPO_DATA(89633),
			T_TIPO_DATA(90218),
			T_TIPO_DATA(90484),
			T_TIPO_DATA(90652),
			T_TIPO_DATA(90725),
			T_TIPO_DATA(91558),
			T_TIPO_DATA(91877),
			T_TIPO_DATA(92115),
			T_TIPO_DATA(92597),
			T_TIPO_DATA(93034),
			T_TIPO_DATA(93052),
			T_TIPO_DATA(93053),
			T_TIPO_DATA(93327),
			T_TIPO_DATA(96098),
			T_TIPO_DATA(96206),
			T_TIPO_DATA(96341),
			T_TIPO_DATA(97181),
			T_TIPO_DATA(97996),
			T_TIPO_DATA(98156),
			T_TIPO_DATA(98315),
			T_TIPO_DATA(98385),
			T_TIPO_DATA(98418),
			T_TIPO_DATA(98440),
			T_TIPO_DATA(98689),
			T_TIPO_DATA(99522),
			T_TIPO_DATA(99906),
			T_TIPO_DATA(99912),
			T_TIPO_DATA(99944),
			T_TIPO_DATA(100031),
			T_TIPO_DATA(100902),
			T_TIPO_DATA(100906),
			T_TIPO_DATA(101091),
			T_TIPO_DATA(101598),
			T_TIPO_DATA(102647),
			T_TIPO_DATA(102922),
			T_TIPO_DATA(103040),
			T_TIPO_DATA(103651),
			T_TIPO_DATA(103786),
			T_TIPO_DATA(103916),
			T_TIPO_DATA(103929),
			T_TIPO_DATA(104034),
			T_TIPO_DATA(104585),
			T_TIPO_DATA(105338),
			T_TIPO_DATA(105600),
			T_TIPO_DATA(105968),
			T_TIPO_DATA(106231),
			T_TIPO_DATA(106301),
			T_TIPO_DATA(107353),
			T_TIPO_DATA(107371),
			T_TIPO_DATA(108040),
			T_TIPO_DATA(108095),
			T_TIPO_DATA(108263),
			T_TIPO_DATA(108383),
			T_TIPO_DATA(108741),
			T_TIPO_DATA(108915),
			T_TIPO_DATA(109023),
			T_TIPO_DATA(109376),
			T_TIPO_DATA(109468),
			T_TIPO_DATA(109483),
			T_TIPO_DATA(109543),
			T_TIPO_DATA(110254),
			T_TIPO_DATA(110256),
			T_TIPO_DATA(110267),
			T_TIPO_DATA(110318),
			T_TIPO_DATA(110319),
			T_TIPO_DATA(110351),
			T_TIPO_DATA(110364),
			T_TIPO_DATA(110437),
			T_TIPO_DATA(110443),
			T_TIPO_DATA(110481),
			T_TIPO_DATA(110485),
			T_TIPO_DATA(110520),
			T_TIPO_DATA(110582),
			T_TIPO_DATA(110716),
			T_TIPO_DATA(110877),
			T_TIPO_DATA(110909),
			T_TIPO_DATA(110947),
			T_TIPO_DATA(111083),
			T_TIPO_DATA(111384),
			T_TIPO_DATA(112002),
			T_TIPO_DATA(112018),
			T_TIPO_DATA(112019),
			T_TIPO_DATA(112020),
			T_TIPO_DATA(112021),
			T_TIPO_DATA(112022),
			T_TIPO_DATA(112023),
			T_TIPO_DATA(112025),
			T_TIPO_DATA(112026),
			T_TIPO_DATA(112027),
			T_TIPO_DATA(112028),
			T_TIPO_DATA(112029),
			T_TIPO_DATA(112030),
			T_TIPO_DATA(112031),
			T_TIPO_DATA(112033),
			T_TIPO_DATA(112035),
			T_TIPO_DATA(112036),
			T_TIPO_DATA(112037),
			T_TIPO_DATA(112038),
			T_TIPO_DATA(112163),
			T_TIPO_DATA(112204),
			T_TIPO_DATA(112451),
			T_TIPO_DATA(113221),
			T_TIPO_DATA(114981),
			T_TIPO_DATA(116212),
			T_TIPO_DATA(116607),
			T_TIPO_DATA(116648),
			T_TIPO_DATA(118005),
			T_TIPO_DATA(118457),
			T_TIPO_DATA(118610),
			T_TIPO_DATA(118944),
			T_TIPO_DATA(119155),
			T_TIPO_DATA(119244),
			T_TIPO_DATA(119343),
			T_TIPO_DATA(119368),
			T_TIPO_DATA(119448),
			T_TIPO_DATA(119548),
			T_TIPO_DATA(119715),
			T_TIPO_DATA(119761),
			T_TIPO_DATA(119787),
			T_TIPO_DATA(119924),
			T_TIPO_DATA(119944),
			T_TIPO_DATA(120030),
			T_TIPO_DATA(120033),
			T_TIPO_DATA(120034),
			T_TIPO_DATA(120180),
			T_TIPO_DATA(120270),
			T_TIPO_DATA(120274),
			T_TIPO_DATA(120340),
			T_TIPO_DATA(120373),
			T_TIPO_DATA(121394),
			T_TIPO_DATA(122865),
			T_TIPO_DATA(123106),
			T_TIPO_DATA(123382),
			T_TIPO_DATA(124624),
			T_TIPO_DATA(124637),
			T_TIPO_DATA(127107),
			T_TIPO_DATA(127736),
			T_TIPO_DATA(127991),
			T_TIPO_DATA(128047),
			T_TIPO_DATA(128235),
			T_TIPO_DATA(130346),
			T_TIPO_DATA(130656),
			T_TIPO_DATA(130962),
			T_TIPO_DATA(131638),
			T_TIPO_DATA(131695),
			T_TIPO_DATA(131795),
			T_TIPO_DATA(132273),
			T_TIPO_DATA(132623),
			T_TIPO_DATA(133530),
			T_TIPO_DATA(133956),
			T_TIPO_DATA(133999),
			T_TIPO_DATA(134850),
			T_TIPO_DATA(135193),
			T_TIPO_DATA(135266),
			T_TIPO_DATA(135396),
			T_TIPO_DATA(136211),
			T_TIPO_DATA(136249),
			T_TIPO_DATA(136324),
			T_TIPO_DATA(136324),
			T_TIPO_DATA(136370),
			T_TIPO_DATA(136623),
			T_TIPO_DATA(136648),
			T_TIPO_DATA(136660),
			T_TIPO_DATA(136739),
			T_TIPO_DATA(137651),
			T_TIPO_DATA(137651),
			T_TIPO_DATA(137651),
			T_TIPO_DATA(138017),
			T_TIPO_DATA(138548),
			T_TIPO_DATA(138776),
			T_TIPO_DATA(138778),
			T_TIPO_DATA(138852),
			T_TIPO_DATA(138866),
			T_TIPO_DATA(138870),
			T_TIPO_DATA(138893),
			T_TIPO_DATA(138963),
			T_TIPO_DATA(138964),
			T_TIPO_DATA(138982),
			T_TIPO_DATA(139041),
			T_TIPO_DATA(139051),
			T_TIPO_DATA(139073),
			T_TIPO_DATA(139090),
			T_TIPO_DATA(139246),
			T_TIPO_DATA(139261),
			T_TIPO_DATA(139398),
			T_TIPO_DATA(139456),
			T_TIPO_DATA(139653),
			T_TIPO_DATA(139967),
			T_TIPO_DATA(139990),
			T_TIPO_DATA(140007),
			T_TIPO_DATA(140069),
			T_TIPO_DATA(140141),
			T_TIPO_DATA(140757),
			T_TIPO_DATA(141092),
			T_TIPO_DATA(141195),
			T_TIPO_DATA(141236),
			T_TIPO_DATA(141411),
			T_TIPO_DATA(141656),
			T_TIPO_DATA(141752),
			T_TIPO_DATA(141830),
			T_TIPO_DATA(141900),
			T_TIPO_DATA(142190),
			T_TIPO_DATA(142238),
			T_TIPO_DATA(142265),
			T_TIPO_DATA(142270),
			T_TIPO_DATA(142387),
			T_TIPO_DATA(142449),
			T_TIPO_DATA(142948),
			T_TIPO_DATA(142965),
			T_TIPO_DATA(143021),
			T_TIPO_DATA(143698),
			T_TIPO_DATA(143808),
			T_TIPO_DATA(144055),
			T_TIPO_DATA(144056),
			T_TIPO_DATA(144208),
			T_TIPO_DATA(144256),
			T_TIPO_DATA(144352),
			T_TIPO_DATA(144386),
			T_TIPO_DATA(144533),
			T_TIPO_DATA(144571),
			T_TIPO_DATA(144666),
			T_TIPO_DATA(144790),
			T_TIPO_DATA(144892),
			T_TIPO_DATA(144914),
			T_TIPO_DATA(145233),
			T_TIPO_DATA(145363),
			T_TIPO_DATA(145604),
			T_TIPO_DATA(146330),
			T_TIPO_DATA(146456),
			T_TIPO_DATA(146463),
			T_TIPO_DATA(146704),
			T_TIPO_DATA(146750),
			T_TIPO_DATA(146980),
			T_TIPO_DATA(146984),
			T_TIPO_DATA(147009),
			T_TIPO_DATA(147011),
			T_TIPO_DATA(147057),
			T_TIPO_DATA(147095),
			T_TIPO_DATA(147095),
			T_TIPO_DATA(147132),
			T_TIPO_DATA(147155),
			T_TIPO_DATA(147207),
			T_TIPO_DATA(147251),
			T_TIPO_DATA(147336),
			T_TIPO_DATA(147342),
			T_TIPO_DATA(147343),
			T_TIPO_DATA(147389),
			T_TIPO_DATA(147431),
			T_TIPO_DATA(147431),
			T_TIPO_DATA(147480),
			T_TIPO_DATA(147543),
			T_TIPO_DATA(147590),
			T_TIPO_DATA(147618),
			T_TIPO_DATA(147632),
			T_TIPO_DATA(147634),
			T_TIPO_DATA(147675),
			T_TIPO_DATA(147688),
			T_TIPO_DATA(147694),
			T_TIPO_DATA(147771),
			T_TIPO_DATA(147785),
			T_TIPO_DATA(147810),
			T_TIPO_DATA(147833),
			T_TIPO_DATA(147835),
			T_TIPO_DATA(147840),
			T_TIPO_DATA(147883),
			T_TIPO_DATA(147888),
			T_TIPO_DATA(147889),
			T_TIPO_DATA(147890),
			T_TIPO_DATA(147899),
			T_TIPO_DATA(147926),
			T_TIPO_DATA(147986),
			T_TIPO_DATA(148002),
			T_TIPO_DATA(148041),
			T_TIPO_DATA(148062),
			T_TIPO_DATA(148067),
			T_TIPO_DATA(148080),
			T_TIPO_DATA(148081),
			T_TIPO_DATA(148087),
			T_TIPO_DATA(148100),
			T_TIPO_DATA(148116),
			T_TIPO_DATA(148129),
			T_TIPO_DATA(148199),
			T_TIPO_DATA(148269),
			T_TIPO_DATA(148273),
			T_TIPO_DATA(148305),
			T_TIPO_DATA(148407),
			T_TIPO_DATA(148441),
			T_TIPO_DATA(148455),
			T_TIPO_DATA(148488),
			T_TIPO_DATA(148527),
			T_TIPO_DATA(148538),
			T_TIPO_DATA(148539),
			T_TIPO_DATA(148545),
			T_TIPO_DATA(148546),
			T_TIPO_DATA(148570),
			T_TIPO_DATA(148585),
			T_TIPO_DATA(148585),
			T_TIPO_DATA(148592),
			T_TIPO_DATA(148592),
			T_TIPO_DATA(148609),
			T_TIPO_DATA(148610),
			T_TIPO_DATA(148613),
			T_TIPO_DATA(148614),
			T_TIPO_DATA(148615),
			T_TIPO_DATA(148618),
			T_TIPO_DATA(148643),
			T_TIPO_DATA(148646),
			T_TIPO_DATA(148649),
			T_TIPO_DATA(148674),
			T_TIPO_DATA(148677),
			T_TIPO_DATA(148699),
			T_TIPO_DATA(148719),
			T_TIPO_DATA(148719),
			T_TIPO_DATA(148719),
			T_TIPO_DATA(148720),
			T_TIPO_DATA(148727),
			T_TIPO_DATA(148765),
			T_TIPO_DATA(148779),
			T_TIPO_DATA(148825),
			T_TIPO_DATA(148840),
			T_TIPO_DATA(148877),
			T_TIPO_DATA(148896),
			T_TIPO_DATA(148900),
			T_TIPO_DATA(148901),
			T_TIPO_DATA(148924),
			T_TIPO_DATA(148937),
			T_TIPO_DATA(148943),
			T_TIPO_DATA(148969),
			T_TIPO_DATA(148980),
			T_TIPO_DATA(148982),
			T_TIPO_DATA(149000),
			T_TIPO_DATA(149100),
			T_TIPO_DATA(149124),
			T_TIPO_DATA(149209),
			T_TIPO_DATA(149223),
			T_TIPO_DATA(149226),
			T_TIPO_DATA(149270),
			T_TIPO_DATA(149308),
			T_TIPO_DATA(149308),
			T_TIPO_DATA(149324),
			T_TIPO_DATA(149329),
			T_TIPO_DATA(149364),
			T_TIPO_DATA(149376),
			T_TIPO_DATA(149379),
			T_TIPO_DATA(149381),
			T_TIPO_DATA(149384),
			T_TIPO_DATA(149402),
			T_TIPO_DATA(149440),
			T_TIPO_DATA(149471),
			T_TIPO_DATA(149474),
			T_TIPO_DATA(149490),
			T_TIPO_DATA(149494),
			T_TIPO_DATA(149501),
			T_TIPO_DATA(149501),
			T_TIPO_DATA(149527),
			T_TIPO_DATA(149539),
			T_TIPO_DATA(149583),
			T_TIPO_DATA(149695),
			T_TIPO_DATA(149713),
			T_TIPO_DATA(149716),
			T_TIPO_DATA(149717),
			T_TIPO_DATA(149724),
			T_TIPO_DATA(149773),
			T_TIPO_DATA(149783),
			T_TIPO_DATA(149885),
			T_TIPO_DATA(149901),
			T_TIPO_DATA(149934),
			T_TIPO_DATA(149958),
			T_TIPO_DATA(149994),
			T_TIPO_DATA(150009),
			T_TIPO_DATA(150059),
			T_TIPO_DATA(150060),
			T_TIPO_DATA(150066),
			T_TIPO_DATA(150114),
			T_TIPO_DATA(150115),
			T_TIPO_DATA(150119),
			T_TIPO_DATA(150136),
			T_TIPO_DATA(150175),
			T_TIPO_DATA(150181),
			T_TIPO_DATA(150182),
			T_TIPO_DATA(150231),
			T_TIPO_DATA(150244),
			T_TIPO_DATA(150249),
			T_TIPO_DATA(150268),
			T_TIPO_DATA(150313),
			T_TIPO_DATA(150321),
			T_TIPO_DATA(150323),
			T_TIPO_DATA(150328),
			T_TIPO_DATA(150330),
			T_TIPO_DATA(150349),
			T_TIPO_DATA(150364),
			T_TIPO_DATA(150365),
			T_TIPO_DATA(150371),
			T_TIPO_DATA(150387),
			T_TIPO_DATA(150392),
			T_TIPO_DATA(150428),
			T_TIPO_DATA(150431),
			T_TIPO_DATA(150445),
			T_TIPO_DATA(150497),
			T_TIPO_DATA(150512),
			T_TIPO_DATA(150532),
			T_TIPO_DATA(150607),
			T_TIPO_DATA(150663),
			T_TIPO_DATA(150714),
			T_TIPO_DATA(150717),
			T_TIPO_DATA(150738),
			T_TIPO_DATA(150740),
			T_TIPO_DATA(150756),
			T_TIPO_DATA(150773),
			T_TIPO_DATA(150778),
			T_TIPO_DATA(150837),
			T_TIPO_DATA(150838),
			T_TIPO_DATA(151097),
			T_TIPO_DATA(151097),
			T_TIPO_DATA(151105),
			T_TIPO_DATA(151107),
			T_TIPO_DATA(151114),
			T_TIPO_DATA(151124),
			T_TIPO_DATA(151133),
			T_TIPO_DATA(151140),
			T_TIPO_DATA(151148),
			T_TIPO_DATA(151153),
			T_TIPO_DATA(151157),
			T_TIPO_DATA(151159),
			T_TIPO_DATA(151191),
			T_TIPO_DATA(151194),
			T_TIPO_DATA(151208),
			T_TIPO_DATA(151328),
			T_TIPO_DATA(151328),
			T_TIPO_DATA(151328),
			T_TIPO_DATA(151329),
			T_TIPO_DATA(151336),
			T_TIPO_DATA(151341),
			T_TIPO_DATA(151343),
			T_TIPO_DATA(151363),
			T_TIPO_DATA(151399),
			T_TIPO_DATA(151429),
			T_TIPO_DATA(151453),
			T_TIPO_DATA(151453),
			T_TIPO_DATA(151461),
			T_TIPO_DATA(151516),
			T_TIPO_DATA(151531),
			T_TIPO_DATA(151531),
			T_TIPO_DATA(151543),
			T_TIPO_DATA(151547),
			T_TIPO_DATA(151560),
			T_TIPO_DATA(151577),
			T_TIPO_DATA(151582),
			T_TIPO_DATA(151597),
			T_TIPO_DATA(151619),
			T_TIPO_DATA(151647),
			T_TIPO_DATA(151651),
			T_TIPO_DATA(151651),
			T_TIPO_DATA(151654),
			T_TIPO_DATA(151658),
			T_TIPO_DATA(151665),
			T_TIPO_DATA(151665),
			T_TIPO_DATA(151680),
			T_TIPO_DATA(151685),
			T_TIPO_DATA(151685),
			T_TIPO_DATA(151687),
			T_TIPO_DATA(151687),
			T_TIPO_DATA(151691),
			T_TIPO_DATA(151693),
			T_TIPO_DATA(151785),
			T_TIPO_DATA(151796),
			T_TIPO_DATA(151796),
			T_TIPO_DATA(151801),
			T_TIPO_DATA(151810),
			T_TIPO_DATA(151829),
			T_TIPO_DATA(151835),
			T_TIPO_DATA(151836),
			T_TIPO_DATA(151836),
			T_TIPO_DATA(151863),
			T_TIPO_DATA(151943),
			T_TIPO_DATA(151953),
			T_TIPO_DATA(151971),
			T_TIPO_DATA(151974),
			T_TIPO_DATA(151976),
			T_TIPO_DATA(151986),
			T_TIPO_DATA(152019),
			T_TIPO_DATA(152025),
			T_TIPO_DATA(152107),
			T_TIPO_DATA(152167),
			T_TIPO_DATA(152242),
			T_TIPO_DATA(152306),
			T_TIPO_DATA(152365),
			T_TIPO_DATA(152379),
			T_TIPO_DATA(152392),
			T_TIPO_DATA(152393),
			T_TIPO_DATA(152420),
			T_TIPO_DATA(152425),
			T_TIPO_DATA(152483),
			T_TIPO_DATA(152511),
			T_TIPO_DATA(152521),
			T_TIPO_DATA(152522),
			T_TIPO_DATA(152556),
			T_TIPO_DATA(152571),
			T_TIPO_DATA(152591),
			T_TIPO_DATA(152641),
			T_TIPO_DATA(152653),
			T_TIPO_DATA(152664),
			T_TIPO_DATA(152684),
			T_TIPO_DATA(152727),
			T_TIPO_DATA(152728),
			T_TIPO_DATA(152751),
			T_TIPO_DATA(152772),
			T_TIPO_DATA(152806),
			T_TIPO_DATA(152806),
			T_TIPO_DATA(152822),
			T_TIPO_DATA(152836),
			T_TIPO_DATA(152837),
			T_TIPO_DATA(152882),
			T_TIPO_DATA(152908),
			T_TIPO_DATA(152912),
			T_TIPO_DATA(152932),
			T_TIPO_DATA(152994),
			T_TIPO_DATA(153016),
			T_TIPO_DATA(153019),
			T_TIPO_DATA(153033),
			T_TIPO_DATA(153113),
			T_TIPO_DATA(153115),
			T_TIPO_DATA(153144),
			T_TIPO_DATA(153235),
			T_TIPO_DATA(153247),
			T_TIPO_DATA(153299),
			T_TIPO_DATA(153299),
			T_TIPO_DATA(153325),
			T_TIPO_DATA(153356),
			T_TIPO_DATA(153356),
			T_TIPO_DATA(153377),
			T_TIPO_DATA(153497),
			T_TIPO_DATA(153551),
			T_TIPO_DATA(153568),
			T_TIPO_DATA(153597),
			T_TIPO_DATA(153609),
			T_TIPO_DATA(153658),
			T_TIPO_DATA(153664),
			T_TIPO_DATA(153670),
			T_TIPO_DATA(153695),
			T_TIPO_DATA(153755),
			T_TIPO_DATA(153775),
			T_TIPO_DATA(153784),
			T_TIPO_DATA(153826),
			T_TIPO_DATA(153826),
			T_TIPO_DATA(153861),
			T_TIPO_DATA(153900),
			T_TIPO_DATA(153900),
			T_TIPO_DATA(153926),
			T_TIPO_DATA(154026),
			T_TIPO_DATA(154028),
			T_TIPO_DATA(154033),
			T_TIPO_DATA(154056),
			T_TIPO_DATA(154181),
			T_TIPO_DATA(154184),
			T_TIPO_DATA(154189),
			T_TIPO_DATA(154238),
			T_TIPO_DATA(154245),
			T_TIPO_DATA(154263),
			T_TIPO_DATA(154299),
			T_TIPO_DATA(154328),
			T_TIPO_DATA(154352),
			T_TIPO_DATA(154502),
			T_TIPO_DATA(154545),
			T_TIPO_DATA(154664),
			T_TIPO_DATA(154664),
			T_TIPO_DATA(154686),
			T_TIPO_DATA(154687),
			T_TIPO_DATA(154767),
			T_TIPO_DATA(154803),
			T_TIPO_DATA(154852),
			T_TIPO_DATA(154912),
			T_TIPO_DATA(154945),
			T_TIPO_DATA(154975),
			T_TIPO_DATA(154981),
			T_TIPO_DATA(155013),
			T_TIPO_DATA(155033),
			T_TIPO_DATA(155054),
			T_TIPO_DATA(155062),
			T_TIPO_DATA(155069),
			T_TIPO_DATA(155154),
			T_TIPO_DATA(155200),
			T_TIPO_DATA(155247),
			T_TIPO_DATA(155280),
			T_TIPO_DATA(155374),
			T_TIPO_DATA(155397),
			T_TIPO_DATA(155616),
			T_TIPO_DATA(155630),
			T_TIPO_DATA(155630),
			T_TIPO_DATA(155683),
			T_TIPO_DATA(155711),
			T_TIPO_DATA(155719),
			T_TIPO_DATA(155731),
			T_TIPO_DATA(155784),
			T_TIPO_DATA(155859),
			T_TIPO_DATA(155963),
			T_TIPO_DATA(156059),
			T_TIPO_DATA(156077),
			T_TIPO_DATA(156103),
			T_TIPO_DATA(156195),
			T_TIPO_DATA(156260),
			T_TIPO_DATA(156260),
			T_TIPO_DATA(156478),
			T_TIPO_DATA(156503),
			T_TIPO_DATA(156549),
			T_TIPO_DATA(156563),
			T_TIPO_DATA(156591),
			T_TIPO_DATA(156596),
			T_TIPO_DATA(156596),
			T_TIPO_DATA(156628),
			T_TIPO_DATA(156667),
			T_TIPO_DATA(156667),
			T_TIPO_DATA(157324),
			T_TIPO_DATA(157385),
			T_TIPO_DATA(157463),
			T_TIPO_DATA(157527),
			T_TIPO_DATA(157528),
			T_TIPO_DATA(157541),
			T_TIPO_DATA(157568),
			T_TIPO_DATA(157601),
			T_TIPO_DATA(157644),
			T_TIPO_DATA(157645),
			T_TIPO_DATA(157648),
			T_TIPO_DATA(157649),
			T_TIPO_DATA(157649),
			T_TIPO_DATA(157651),
			T_TIPO_DATA(157656),
			T_TIPO_DATA(157815),
			T_TIPO_DATA(157903),
			T_TIPO_DATA(157996),
			T_TIPO_DATA(157996),
			T_TIPO_DATA(158010),
			T_TIPO_DATA(158033),
			T_TIPO_DATA(158073),
			T_TIPO_DATA(158103),
			T_TIPO_DATA(158120),
			T_TIPO_DATA(158204),
			T_TIPO_DATA(158213),
			T_TIPO_DATA(158297),
			T_TIPO_DATA(158339),
			T_TIPO_DATA(158358),
			T_TIPO_DATA(158384),
			T_TIPO_DATA(158384),
			T_TIPO_DATA(158454),
			T_TIPO_DATA(158472),
			T_TIPO_DATA(158560),
			T_TIPO_DATA(158561),
			T_TIPO_DATA(158612),
			T_TIPO_DATA(158615),
			T_TIPO_DATA(158618),
			T_TIPO_DATA(158618),
			T_TIPO_DATA(158626),
			T_TIPO_DATA(158634),
			T_TIPO_DATA(158663),
			T_TIPO_DATA(158673),
			T_TIPO_DATA(158737),
			T_TIPO_DATA(158799),
			T_TIPO_DATA(158806),
			T_TIPO_DATA(158821),
			T_TIPO_DATA(158825),
			T_TIPO_DATA(158939),
			T_TIPO_DATA(158946),
			T_TIPO_DATA(158994),
			T_TIPO_DATA(159045),
			T_TIPO_DATA(159056),
			T_TIPO_DATA(159083),
			T_TIPO_DATA(159084),
			T_TIPO_DATA(159103),
			T_TIPO_DATA(159146),
			T_TIPO_DATA(159157),
			T_TIPO_DATA(159195),
			T_TIPO_DATA(159218),
			T_TIPO_DATA(159242),
			T_TIPO_DATA(159272),
			T_TIPO_DATA(159277),
			T_TIPO_DATA(159286),
			T_TIPO_DATA(159313),
			T_TIPO_DATA(159333),
			T_TIPO_DATA(159366),
			T_TIPO_DATA(159474),
			T_TIPO_DATA(159477),
			T_TIPO_DATA(159490),
			T_TIPO_DATA(159513),
			T_TIPO_DATA(159589),
			T_TIPO_DATA(159607),
			T_TIPO_DATA(159670),
			T_TIPO_DATA(159686),
			T_TIPO_DATA(159744),
			T_TIPO_DATA(159763),
			T_TIPO_DATA(159797),
			T_TIPO_DATA(159803),
			T_TIPO_DATA(159851),
			T_TIPO_DATA(159910),
			T_TIPO_DATA(159923),
			T_TIPO_DATA(159949),
			T_TIPO_DATA(159968),
			T_TIPO_DATA(159973),
			T_TIPO_DATA(159974),
			T_TIPO_DATA(160147),
			T_TIPO_DATA(160191),
			T_TIPO_DATA(160256),
			T_TIPO_DATA(160259),
			T_TIPO_DATA(160270),
			T_TIPO_DATA(160270),
			T_TIPO_DATA(160281),
			T_TIPO_DATA(160323),
			T_TIPO_DATA(160324),
			T_TIPO_DATA(160324),
			T_TIPO_DATA(160510),
			T_TIPO_DATA(160625),
			T_TIPO_DATA(160632),
			T_TIPO_DATA(160720),
			T_TIPO_DATA(160816),
			T_TIPO_DATA(160817),
			T_TIPO_DATA(160818),
			T_TIPO_DATA(160822),
			T_TIPO_DATA(160926),
			T_TIPO_DATA(160988),
			T_TIPO_DATA(161346),
			T_TIPO_DATA(161383),
			T_TIPO_DATA(161446),
			T_TIPO_DATA(161450),
			T_TIPO_DATA(161544),
			T_TIPO_DATA(161585),
			T_TIPO_DATA(161611),
			T_TIPO_DATA(161614),
			T_TIPO_DATA(161693),
			T_TIPO_DATA(161759),
			T_TIPO_DATA(161777),
			T_TIPO_DATA(161840),
			T_TIPO_DATA(161840),
			T_TIPO_DATA(161851),
			T_TIPO_DATA(161853),
			T_TIPO_DATA(161855),
			T_TIPO_DATA(161855),
			T_TIPO_DATA(161922),
			T_TIPO_DATA(161945),
			T_TIPO_DATA(161983),
			T_TIPO_DATA(162032),
			T_TIPO_DATA(162121),
			T_TIPO_DATA(162121),
			T_TIPO_DATA(162126),
			T_TIPO_DATA(162160),
			T_TIPO_DATA(162314),
			T_TIPO_DATA(162375),
			T_TIPO_DATA(162379),
			T_TIPO_DATA(162474),
			T_TIPO_DATA(162536),
			T_TIPO_DATA(162599),
			T_TIPO_DATA(162673),
			T_TIPO_DATA(162791),
			T_TIPO_DATA(162851),
			T_TIPO_DATA(162911),
			T_TIPO_DATA(162965),
			T_TIPO_DATA(162997),
			T_TIPO_DATA(163059),
			T_TIPO_DATA(163120),
			T_TIPO_DATA(163138),
			T_TIPO_DATA(163155),
			T_TIPO_DATA(163224),
			T_TIPO_DATA(163312),
			T_TIPO_DATA(163331),
			T_TIPO_DATA(163391),
			T_TIPO_DATA(163415),
			T_TIPO_DATA(163454),
			T_TIPO_DATA(163454),
			T_TIPO_DATA(163521),
			T_TIPO_DATA(163525),
			T_TIPO_DATA(163525),
			T_TIPO_DATA(163526),
			T_TIPO_DATA(163539),
			T_TIPO_DATA(163587),
			T_TIPO_DATA(163711),
			T_TIPO_DATA(163769),
			T_TIPO_DATA(163774),
			T_TIPO_DATA(163786),
			T_TIPO_DATA(163790),
			T_TIPO_DATA(163794),
			T_TIPO_DATA(163805),
			T_TIPO_DATA(163807),
			T_TIPO_DATA(163826),
			T_TIPO_DATA(163830),
			T_TIPO_DATA(163835),
			T_TIPO_DATA(163918),
			T_TIPO_DATA(163929),
			T_TIPO_DATA(163943),
			T_TIPO_DATA(163958),
			T_TIPO_DATA(163958),
			T_TIPO_DATA(164043),
			T_TIPO_DATA(164270),
			T_TIPO_DATA(164289),
			T_TIPO_DATA(164298),
			T_TIPO_DATA(164315),
			T_TIPO_DATA(164486),
			T_TIPO_DATA(164547),
			T_TIPO_DATA(164603),
			T_TIPO_DATA(164613),
			T_TIPO_DATA(164665),
			T_TIPO_DATA(164688),
			T_TIPO_DATA(164713),
			T_TIPO_DATA(164744),
			T_TIPO_DATA(164754),
			T_TIPO_DATA(164760),
			T_TIPO_DATA(164808),
			T_TIPO_DATA(164829),
			T_TIPO_DATA(164829),
			T_TIPO_DATA(164845),
			T_TIPO_DATA(164862),
			T_TIPO_DATA(164885),
			T_TIPO_DATA(164933),
			T_TIPO_DATA(164939),
			T_TIPO_DATA(164943),
			T_TIPO_DATA(164963),
			T_TIPO_DATA(164965),
			T_TIPO_DATA(164971),
			T_TIPO_DATA(164979),
			T_TIPO_DATA(165040),
			T_TIPO_DATA(165048),
			T_TIPO_DATA(165059),
			T_TIPO_DATA(165069),
			T_TIPO_DATA(165079),
			T_TIPO_DATA(165083),
			T_TIPO_DATA(165206),
			T_TIPO_DATA(165255),
			T_TIPO_DATA(165266),
			T_TIPO_DATA(165299),
			T_TIPO_DATA(165334),
			T_TIPO_DATA(165360),
			T_TIPO_DATA(165361),
			T_TIPO_DATA(165378),
			T_TIPO_DATA(165387),
			T_TIPO_DATA(165425),
			T_TIPO_DATA(165445),
			T_TIPO_DATA(165489),
			T_TIPO_DATA(165500),
			T_TIPO_DATA(165518),
			T_TIPO_DATA(165531),
			T_TIPO_DATA(165533),
			T_TIPO_DATA(165537),
			T_TIPO_DATA(165587),
			T_TIPO_DATA(165617),
			T_TIPO_DATA(165683),
			T_TIPO_DATA(165688),
			T_TIPO_DATA(165790),
			T_TIPO_DATA(165808),
			T_TIPO_DATA(165979),
			T_TIPO_DATA(166011),
			T_TIPO_DATA(166011),
			T_TIPO_DATA(166018),
			T_TIPO_DATA(166024),
			T_TIPO_DATA(166025),
			T_TIPO_DATA(166069),
			T_TIPO_DATA(166070),
			T_TIPO_DATA(166072),
			T_TIPO_DATA(166128),
			T_TIPO_DATA(166130),
			T_TIPO_DATA(166214),
			T_TIPO_DATA(166237),
			T_TIPO_DATA(166258),
			T_TIPO_DATA(166263),
			T_TIPO_DATA(166307),
			T_TIPO_DATA(166308),
			T_TIPO_DATA(166348),
			T_TIPO_DATA(166355),
			T_TIPO_DATA(166366),
			T_TIPO_DATA(166423),
			T_TIPO_DATA(166486),
			T_TIPO_DATA(166504),
			T_TIPO_DATA(166507),
			T_TIPO_DATA(166516),
			T_TIPO_DATA(166517),
			T_TIPO_DATA(166543),
			T_TIPO_DATA(166622),
			T_TIPO_DATA(166640),
			T_TIPO_DATA(166693),
			T_TIPO_DATA(166693),
			T_TIPO_DATA(166724),
			T_TIPO_DATA(166725),
			T_TIPO_DATA(166745),
			T_TIPO_DATA(166926),
			T_TIPO_DATA(167103),
			T_TIPO_DATA(167105),
			T_TIPO_DATA(167255),
			T_TIPO_DATA(167261),
			T_TIPO_DATA(167297),
			T_TIPO_DATA(167416),
			T_TIPO_DATA(167424),
			T_TIPO_DATA(167450),
			T_TIPO_DATA(167450),
			T_TIPO_DATA(167546),
			T_TIPO_DATA(167547),
			T_TIPO_DATA(167548),
			T_TIPO_DATA(167555),
			T_TIPO_DATA(167569),
			T_TIPO_DATA(167595),
			T_TIPO_DATA(167609),
			T_TIPO_DATA(167663),
			T_TIPO_DATA(167668),
			T_TIPO_DATA(167710),
			T_TIPO_DATA(167717),
			T_TIPO_DATA(167815),
			T_TIPO_DATA(167816),
			T_TIPO_DATA(167819),
			T_TIPO_DATA(167860),
			T_TIPO_DATA(167860),
			T_TIPO_DATA(167864),
			T_TIPO_DATA(167867),
			T_TIPO_DATA(167898),
			T_TIPO_DATA(167924),
			T_TIPO_DATA(167928),
			T_TIPO_DATA(168057),
			T_TIPO_DATA(168108),
			T_TIPO_DATA(168129),
			T_TIPO_DATA(168139),
			T_TIPO_DATA(168166),
			T_TIPO_DATA(168301),
			T_TIPO_DATA(168353),
			T_TIPO_DATA(168362),
			T_TIPO_DATA(168392),
			T_TIPO_DATA(168392),
			T_TIPO_DATA(168460),
			T_TIPO_DATA(168479),
			T_TIPO_DATA(168753),
			T_TIPO_DATA(168941),
			T_TIPO_DATA(168988),
			T_TIPO_DATA(169003),
			T_TIPO_DATA(169009),
			T_TIPO_DATA(169044),
			T_TIPO_DATA(169055),
			T_TIPO_DATA(169277),
			T_TIPO_DATA(169279),
			T_TIPO_DATA(169295),
			T_TIPO_DATA(169377),
			T_TIPO_DATA(169425),
			T_TIPO_DATA(169565),
			T_TIPO_DATA(169595),
			T_TIPO_DATA(169627),
			T_TIPO_DATA(169721),
			T_TIPO_DATA(169731),
			T_TIPO_DATA(169775),
			T_TIPO_DATA(169912),
			T_TIPO_DATA(169960),
			T_TIPO_DATA(170490),
			T_TIPO_DATA(170847),
			T_TIPO_DATA(166717),
			T_TIPO_DATA(9000039530),
			T_TIPO_DATA(9000040016),
			T_TIPO_DATA(9000040564),
			T_TIPO_DATA(9000041428),
			T_TIPO_DATA(9000041612),
			T_TIPO_DATA(9000042180),
			T_TIPO_DATA(9000042557),
			T_TIPO_DATA(9000045018),
			T_TIPO_DATA(9000046089),
			T_TIPO_DATA(9000046232),
			T_TIPO_DATA(9000046583),
			T_TIPO_DATA(9000053521),
			T_TIPO_DATA(147338),
			T_TIPO_DATA(150751),
			T_TIPO_DATA(148498),
			T_TIPO_DATA(158198),
			T_TIPO_DATA(151716),
			T_TIPO_DATA(151925),
			T_TIPO_DATA(157386),
			T_TIPO_DATA(159356),
			T_TIPO_DATA(162865),
			T_TIPO_DATA(166701),
			T_TIPO_DATA(166717),
			T_TIPO_DATA(9000040849),
			T_TIPO_DATA(168311),
			T_TIPO_DATA(9000046939)



    ); 
    V_TMP_TIPO_DATA T_TIPO_DATA;
    
BEGIN	
	
	DBMS_OUTPUT.PUT_LINE('[INICIO] ');

    DBMS_OUTPUT.PUT_LINE('[INFO]: INSERCION EN ACT_TRA_TRAMITE] ');
    FOR I IN V_TIPO_DATA.FIRST .. V_TIPO_DATA.LAST
      LOOP
      
        V_TMP_TIPO_DATA := V_TIPO_DATA(I);
    
        --Comprobamos el dato a insertar
        V_SQL := 'SELECT COUNT(1) FROM '||V_ESQUEMA||'.ACT_TBJ_TRABAJO WHERE TBJ_NUM_TRABAJO = '''||TRIM(V_TMP_TIPO_DATA(1))||'''';
        EXECUTE IMMEDIATE V_SQL INTO V_NUM_TABLAS;
        
        --Si existe lo modificamos
        IF V_NUM_TABLAS = 0 THEN				
          
          DBMS_OUTPUT.PUT_LINE('[INFO]: EL REGISTRO NO EXISTE '''|| TRIM(V_TMP_TIPO_DATA(1)) ||'''');
          
       --Si no existe, lo insertamos   
       ELSE
       
          DBMS_OUTPUT.PUT_LINE('[INFO]: UPDATEAMOS EL REGISTRO '''|| TRIM(V_TMP_TIPO_DATA(1)) ||'''');   	
    V_MSQL := 'UPDATE '||V_ESQUEMA||'.ACT_TBJ_TRABAJO 
		SET USU_ID = TBJ_RESPONSABLE_TRABAJO,
		USUARIOMODIFICAR = ''REMVIP-7504'',
		FECHAMODIFICAR = SYSDATE
		WHERE TBJ_RESPONSABLE_TRABAJO IS NOT NULL AND USU_ID IS NULL AND TBJ_NUM_TRABAJO = '''||TRIM(V_TMP_TIPO_DATA(1))||'''';
          EXECUTE IMMEDIATE V_MSQL;

    V_MSQL := 'UPDATE '||V_ESQUEMA||'.ACT_TBJ_TRABAJO 
		SET USU_ID = (SELECT USU_ID FROM '||V_ESQUEMA_M||'.USU_USUARIOS WHERE USU_USERNAME = ''grupgact''),
		USUARIOMODIFICAR = ''REMVIP-7504'',
		FECHAMODIFICAR = SYSDATE
		WHERE TBJ_RESPONSABLE_TRABAJO IS NULL AND USU_ID IS NULL AND TBJ_NUM_TRABAJO = '''||TRIM(V_TMP_TIPO_DATA(1))||'''';
          EXECUTE IMMEDIATE V_MSQL;

    V_MSQL := 'UPDATE '||V_ESQUEMA||'.ACT_TBJ_TRABAJO 
		SET TBJ_RESPONSABLE_TRABAJO = (SELECT USU_ID FROM '||V_ESQUEMA_M||'.USU_USUARIOS WHERE USU_USERNAME = ''grupgact''),
		USUARIOMODIFICAR = ''REMVIP-7504'',
		FECHAMODIFICAR = SYSDATE
		WHERE TBJ_NUM_TRABAJO = '''||TRIM(V_TMP_TIPO_DATA(1))||'''';
          EXECUTE IMMEDIATE V_MSQL;
          DBMS_OUTPUT.PUT_LINE('[INFO]: REGISTRO MODIFICADOS CORRECTAMENTE');
       
       END IF;

      END LOOP;
    COMMIT;
    DBMS_OUTPUT.PUT_LINE('[FIN]: HA ACABADO CORRECTAMENTE LA INSERCI√ìN DE EXPEDIENTES Y OFERTAS');
   

EXCEPTION
     WHEN OTHERS THEN
          err_num := SQLCODE;
          err_msg := SQLERRM;

          DBMS_OUTPUT.put_line('[ERROR] Se ha producido un error en la ejecuci√≥n:'||TO_CHAR(err_num));
          DBMS_OUTPUT.put_line('-----------------------------------------------------------'); 
          DBMS_OUTPUT.put_line(err_msg);

          ROLLBACK;
          RAISE;          

END;

/

EXIT
