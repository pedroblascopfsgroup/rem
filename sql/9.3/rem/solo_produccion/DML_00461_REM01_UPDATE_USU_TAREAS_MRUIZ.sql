--/*
--##########################################
--## AUTOR=Viorel Remus Ovidiu
--## FECHA_CREACION=20200923
--## ARTEFACTO=online
--## VERSION_ARTEFACTO=9.3
--## INCIDENCIA_LINK=REMVIP-8107
--## PRODUCTO=NO
--##
--## INSTRUCCIONES: actualizar superevisor de tareas a nesteban
--## VERSIONES:
--##        0.1 Versión inicial
--##########################################
--*/
WHENEVER SQLERROR EXIT SQL.SQLCODE;
SET SERVEROUTPUT ON; 
SET DEFINE OFF; 
DECLARE

    PL_OUTPUT VARCHAR2(32000 CHAR);
    V_MSQL VARCHAR2(32000 CHAR); -- Sentencia a ejecutar    
    V_ESQUEMA VARCHAR2(25 CHAR):= '#ESQUEMA#'; -- Configuracion Esquemas
    V_ESQUEMA_M VARCHAR2(25 CHAR):= '#ESQUEMA_MASTER#'; -- Configuracion Esquema Master
    V_SQL VARCHAR2(4000 CHAR); -- Vble. para consulta que valida la existencia de una tabla.
    V_NUM_TABLAS NUMBER(16); -- Vble. para validar la existencia de una tabla.
    V_NUM_FILAS NUMBER(16); -- Vble. para validar la existencia de un registro.
    V_NUM_FILAS_1 NUMBER(16); -- Vble. para validar la existencia de un registro.
    V_NUM_FILAS_2 NUMBER(16); -- Vble. para validar la existencia de un registro.
    V_NUM_FILAS_3 NUMBER(16); -- Vble. para validar la existencia de un registro.
    ERR_NUM NUMBER(25);  -- Vble. auxiliar para registrar errores en el script.
    ERR_MSG VARCHAR2(1024 CHAR); -- Vble. auxiliar para registrar errores en el script.
    V_USR VARCHAR2(30 CHAR) := 'REMVIP-8107'; -- USUARIOCREAR/USUARIOMODIFICAR.
    V_ECO_ID NUMBER(16); 
    
    TRA_ID NUMBER(16);
    TAR_ID NUMBER(16);
    TEX_ID NUMBER(16);
    ACT_ID NUMBER(16);
    USU_ID NUMBER(16);
    SUP_ID NUMBER(16);
    ECO_ID NUMBER(16);
    TEX_TOKEN NUMBER(16);

    SEQ_TAR_ID NUMBER(16);

    V_COUNT_UPDATE_1 NUMBER(16):= 0; -- Vble. para contar updates
    V_COUNT_UPDATE_2 NUMBER(16):= 0; -- Vble. para contar updates
    V_COUNT_UPDATE_3 NUMBER(16):= 0; -- Vble. para contar updates

    
    TYPE T_JBV IS TABLE OF VARCHAR2(32000);
    TYPE T_ARRAY_JBV IS TABLE OF T_JBV; 
	
	--TRA_ID , TAR_ID, ACT_ID, USU_ID, SUP_ID

	V_JBV T_ARRAY_JBV := T_ARRAY_JBV(
T_JBV(29005, 2992849,68418 ,53048 ,39748),
T_JBV(29007, 4436965,55981 ,53048 ,58058),
T_JBV(29097, 4710072,55984 ,53048 ,58058),
T_JBV(29098, 2992942,67591 ,53048 ,39748),
T_JBV(29105, 2992949,67605 ,53048 ,39748),
T_JBV(29124, 2992968,59163 ,53048 ,39748),
T_JBV(29141, 4710066,56011 ,53048 ,58058),
T_JBV(29150, 2992994,58544 ,39794 ,39955),
T_JBV(29153, 2992997,58931 ,53048 ,39748),
T_JBV(29177, 2993690,55124 ,53048 ,39748),
T_JBV(29206, 2993050,67613 ,53048 ,39748),
T_JBV(29226, 3068367,71822 ,39794 ,39955),
T_JBV(29231, 2993075,61716 ,53048 ,39748),
T_JBV(29273, 2993117,62246 ,53048 ,39748),
T_JBV(29294, 2993138,58822 ,53048 ,39748),
T_JBV(29298, 2993142,56010 ,53048 ,60582),
T_JBV(29304, 2993148,61508 ,53048 ,39748),
T_JBV(29375, 2993219,61714 ,53048 ,39748),
T_JBV(32709, 3017409,68359 ,53048 ,39748),
T_JBV(33056, 3018808,53752 ,39794 ,39955),
T_JBV(35969, 3022056,113102 ,53048 ,39748),
T_JBV(37244, 3027517,37206 ,39794 ,39992),
T_JBV(37245, 3027518,37206 ,39794 ,39992),
T_JBV(37903, 3029915,37206 ,39794 ,39992),
T_JBV(37904, 3029916,37206 ,39794 ,39992),
T_JBV(37906, 3029927,37206 ,39794 ,39992),
T_JBV(37971, 3030171,37206 ,39794 ,39992),
T_JBV(37972, 3030172,37206 ,39794 ,39992),
T_JBV(37973, 3030184,37206 ,39794 ,39992),
T_JBV(37974, 3030185,37206 ,39794 ,39992),
T_JBV(37975, 3030186,37206 ,39794 ,39992),
T_JBV(37976, 3030187,37206 ,39794 ,39992),
T_JBV(40586, 3039254,73763 ,87960 ,39955),
T_JBV(41109, 3040861,68366 ,53048 ,39748),
T_JBV(64874, 3067890,73460 ,39613 ,39305),
T_JBV(67190, 3078720,113056 ,39372 ,39748),
T_JBV(67483, 3079877,68363 ,53048 ,39748),
T_JBV(69972, 3089245,264 ,39794 ,39992),
T_JBV(72552, 3103551,46646 ,39794 ,39992),
T_JBV(74669, 3114774,72142 ,53048 ,39748),
T_JBV(74703, 3115003,72149 ,53048 ,39748),
T_JBV(74848, 3115929,42806 ,39360 ,60582),
T_JBV(79848, 3140607,42295 ,39278 ,39748),
T_JBV(81477, 3148974,260025 ,39372 ,39372),
T_JBV(88403, 4362553,253954 ,53048 ,58058),
T_JBV(90096, 3179926,65075 ,53048 ,39748),
T_JBV(90371, 3181276,42473 ,39278 ,39748),
T_JBV(90819, 3183802,38309 ,39372 ,39748),
T_JBV(92241, 3191133,65092 ,53048 ,39748),
T_JBV(92262, 3191300,65094 ,53048 ,39748),
T_JBV(105760, 3261747,68128 ,53048 ,39748),
T_JBV(107565, 4362560,253956 ,53048 ,58058),
T_JBV(114097, 3307699,5681 ,39680 ,39748),
T_JBV(117328, 3324050,72038 ,53048 ,39955),
T_JBV(118863, 3332267,5362 ,39680 ,39748),
T_JBV(128335, 3372659,67470 ,53048 ,39748),
T_JBV(141087, 3422608,4404 ,39680 ,39748),
T_JBV(144132, 3439112,260904 ,39372 ,39748),
T_JBV(145499, 3446734,67483 ,53048 ,39748),
T_JBV(154401, 3496782,38287 ,39372 ,39748),
T_JBV(154507, 3497499,44708 ,39680 ,39748),
T_JBV(158979, 3516019,72984 ,58047 ,39748),
T_JBV(174890, 3766486,2550 ,75086 ,39955),
T_JBV(176919, 3581268,291151 ,87960 ,39360),
T_JBV(176920, 3581269,291178 ,87960 ,39360),
T_JBV(177724, 3585057,273367 ,39372 ,39372),
T_JBV(182650, 3650895,74904 ,53048 ,39748),
T_JBV(182664, 3607393,74934 ,39278 ,39748),
T_JBV(182670, 3632968,74903 ,39278 ,39748),
T_JBV(188107, 3827171,74933 ,53048 ,39748),
T_JBV(188174, 3655308,74935 ,39278 ,39748),
T_JBV(188585, 3653993,74942 ,53048 ,39748),
T_JBV(191865, 3781590,74946 ,53048 ,39748),
T_JBV(192188, 3652735,49079 ,39372 ,39748),
T_JBV(192974, 3685143,74935 ,53048 ,39748),
T_JBV(205893, 3685334,38003 ,39708 ,39955),
T_JBV(222035, 3752247,292391 ,87960 ,58047),
T_JBV(222457, 3754427,66284 ,53048 ,39992),
T_JBV(223719, 3760004,66298 ,53048 ,39992),
T_JBV(226750, 3776295,290942 ,53048 ,39492),
T_JBV(228556, 3785751,253737 ,53048 ,39492),
T_JBV(228558, 3785762,253742 ,53048 ,39492),
T_JBV(233658, 3811446,123306 ,39360 ,39955),
T_JBV(233981, 3813321,123304 ,39794 ,39955),
T_JBV(237748, 3835221,62594 ,53048 ,39955),
T_JBV(237751, 3835237,69636 ,53048 ,39955),
T_JBV(244383, 3994482,74933 ,53048 ,39748),
T_JBV(246011, 3874875,70386 ,53048 ,39955),
T_JBV(252346, 3910977,69405 ,53048 ,39992),
T_JBV(261693, 4362565,123325 ,39587 ,39305),
T_JBV(264177, 4123049,42571 ,53048 ,58058),
T_JBV(266839, 3994497,74933 ,53048 ,39748),
T_JBV(275281, 4066095,74783 ,39708 ,39955),
T_JBV(275351, 4032623,271703 ,53048 ,39748),
T_JBV(275353, 4032653,271695 ,53048 ,39748),
T_JBV(275362, 4032680,271714 ,53048 ,39748),
T_JBV(275363, 4032718,271698 ,53048 ,39748),
T_JBV(275375, 4032762,271700 ,53048 ,39748),
T_JBV(275379, 4032793,271702 ,53048 ,39748),
T_JBV(275482, 4033388,294103 ,53048 ,39748),
T_JBV(275490, 4033427,294106 ,53048 ,39748),
T_JBV(275539, 4033755,294091 ,53048 ,39748),
T_JBV(275547, 4362573,294092 ,53048 ,58058),
T_JBV(277466, 4044743,56122 ,53048 ,39748),
T_JBV(280920, 4063585,292841 ,53048 ,39748),
T_JBV(284180, 4082262,292857 ,53048 ,39748),
T_JBV(285763, 4091735,332615 ,53048 ,58058),
T_JBV(285768, 4091776,332622 ,53048 ,58058),
T_JBV(285773, 4091809,332633 ,53048 ,58058),
T_JBV(285781, 4091831,332628 ,53048 ,58058),
T_JBV(285786, 4091876,57832 ,53048 ,58058),
T_JBV(285830, 4092038,332623 ,53048 ,58058),
T_JBV(285834, 4092036,332623 ,53048 ,58058),
T_JBV(285842, 4092115,332621 ,53048 ,58058),
T_JBV(285851, 4092148,332619 ,53048 ,58058),
T_JBV(285858, 4092198,332624 ,53048 ,58058),
T_JBV(285863, 4092216,332617 ,53048 ,58058),
T_JBV(285866, 4092233,332618 ,53048 ,58058),
T_JBV(285873, 4092267,332625 ,53048 ,58058),
T_JBV(304691, 4206371,272274 ,53048 ,58058),
T_JBV(304694, 4206401,272277 ,53048 ,58058),
T_JBV(304966, 4203308,1950 ,39900 ,58058),
T_JBV(312853, 4246195,4838 ,53048 ,58058),
T_JBV(313126, 4247895,265926 ,53048 ,58058),
T_JBV(313392, 4249196,4837 ,53048 ,58058),
T_JBV(314525, 4255044,349734 ,53048 ,58058),
T_JBV(320539, 4287146,3625 ,53048 ,58058),
T_JBV(327700, 4325374,265030 ,39372 ,58058),
T_JBV(328050, 4588308,262302 ,53048 ,58058),
T_JBV(329648, 4334162,332176 ,53048 ,58058),
T_JBV(336961, 4546452,44609 ,39900 ,58058),
T_JBV(337460, 4372131,263040 ,53048 ,58058),
T_JBV(340647, 4387381,275706 ,53048 ,58058),
T_JBV(340729, 4387400,275707 ,53048 ,58058),
T_JBV(340750, 4387368,275708 ,53048 ,58058),
T_JBV(340755, 4387361,275709 ,53048 ,58058),
T_JBV(340760, 4387341,275704 ,53048 ,58058),
T_JBV(340767, 4387226,275705 ,53048 ,58058),
T_JBV(343538, 4399656,332178 ,53048 ,58058),
T_JBV(344587, 4406751,68003 ,39372 ,58058),
T_JBV(346474, 4412932,45900 ,39372 ,58058),
T_JBV(354268, 4449250,49184 ,39900 ,58058),
T_JBV(354270, 4449257,49377 ,39900 ,58058),
T_JBV(356575, 4459943,38790 ,53048 ,58058),
T_JBV(363171, 4490939,13411 ,39900 ,58058),
T_JBV(365174, 4500174,49189 ,39372 ,58058),
T_JBV(367963, 4512073,49398 ,39372 ,58058),
T_JBV(368547, 4514970,45734 ,39372 ,58058),
T_JBV(370141, 4522476,45734 ,39372 ,58058),
T_JBV(370143, 4522479,45734 ,39372 ,58058),
T_JBV(370169, 4522599,45734 ,39372 ,58058),
T_JBV(375086, 4548390,38718 ,39372 ,58058),
T_JBV(378536, 4567500,272574 ,39372 ,58058),
T_JBV(378810, 4613661,73755 ,39451 ,58058),
T_JBV(384860, 4665450,49561 ,39372 ,58058),
T_JBV(387248, 4614005,5733 ,39372 ,58058),
T_JBV(387249, 4614008,5733 ,39372 ,58058),
T_JBV(387251, 4614012,5733 ,39372 ,58058),
T_JBV(387466, 4615725,325055 ,39372 ,58058),
T_JBV(389168, 4622851,5467 ,39372 ,58058),
T_JBV(394472, 4654698,331971 ,39372 ,58058),
T_JBV(401769, 4697831,292590 ,39372 ,58058),
T_JBV(402133, 4699554,412552 ,39372 ,58058),
T_JBV(409028, 4734869,45271 ,39372 ,58058),
T_JBV(412951, 4755060,263212 ,53048 ,76403),
T_JBV(416513, 4773232,422446 ,39900 ,39305),
T_JBV(422700, 4794796,430371 ,53048 ,58058),
T_JBV(422732, 4795014,430551 ,53048 ,58058),
T_JBV(425781, 4814598,271706 ,53048 ,58058),
T_JBV(427089, 4814608,271719 ,53048 ,58058),
T_JBV(428956, 4824413,270008 ,39372 ,58058),
T_JBV(438689, 4874548,42579 ,53048 ,58058),
T_JBV(442759, 4893286,46271 ,39900 ,58058),
T_JBV(443985, 4900209,270093 ,39372 ,58058),
T_JBV(445232, 4907769,53550 ,86303 ,60582),
T_JBV(446808, 4918622,73997 ,53048 ,39955),
T_JBV(455716, 5049075,73330 ,53048 ,39492),
T_JBV(455940, 4959018,421024 ,53048 ,58058),
T_JBV(458304, 4970367,73425 ,39451 ,39492),
T_JBV(464608, 5004837,267284 ,39451 ,58058),
T_JBV(464676, 5005268,73425 ,39451 ,39492),
T_JBV(466787, 5239436,412005 ,53048 ,58058),
T_JBV(471775, 5049036,40241 ,39900 ,39955),
T_JBV(472555, 5055819,422003 ,53048 ,39992),
T_JBV(561562, 5182135,437208 ,39613 ,39305),
T_JBV(569429, 5222749,265931 ,53048 ,58058),
T_JBV(569818, 5225464,39276 ,53048 ,39992),
T_JBV(573196, 5244737,38800 ,40085 ,39305),
T_JBV(576069, 5260849,435603 ,39372 ,39992),
T_JBV(576577, 5264157,51823 ,39900 ,58058),
T_JBV(577585, 5269229,409306 ,39372 ,58058),
T_JBV(582117, 5484651,264134 ,39372 ,39955),
T_JBV(586660, 5320145,264109 ,39372 ,39955),
T_JBV(586770, 5320844,421449 ,39900 ,39900),
T_JBV(587453, 5324610,5454 ,75962 ,60582),
T_JBV(588004, 5328501,5633 ,39372 ,58058),
T_JBV(589238, 5335661,411470 ,53048 ,39992),
T_JBV(589838, 5434409,2290 ,39372 ,39992),
T_JBV(590595, 5343378,74882 ,39900 ,58058),
T_JBV(591203, 5347043,37160 ,53048 ,39992),
T_JBV(592467, 5354163,389250 ,39372 ,39992),
T_JBV(594856, 5366238,42693 ,53048 ,58058),
T_JBV(595577, 5393950,389336 ,53048 ,58058),
T_JBV(595584, 5393960,389331 ,53048 ,58058),
T_JBV(595585, 5393955,389300 ,53048 ,58058),
T_JBV(596620, 5375641,356454 ,53048 ,39278),
T_JBV(596787, 5376453,4437 ,39900 ,39305),
T_JBV(600641, 5401001,409418 ,39328 ,39328),
T_JBV(600903, 5402553,430065 ,53048 ,39992),
T_JBV(600917, 5412116,388866 ,39372 ,39992),
T_JBV(601394, 5405972,389256 ,39900 ,39489),
T_JBV(602519, 5413188,74867 ,39900 ,58058),
T_JBV(603782, 5484297,350567 ,39372 ,39992),
T_JBV(605432, 5488286,350600 ,39372 ,39992),
T_JBV(605701, 5433562,271802 ,39372 ,58058),
T_JBV(605860, 5434566,354852 ,39900 ,58058),
T_JBV(605863, 5434573,2315 ,53048 ,39992),
T_JBV(606627, 5437723,122540 ,53048 ,39492),
T_JBV(606658, 5437947,73525 ,53048 ,39492),
T_JBV(606985, 5440335,2254 ,39900 ,39489),
T_JBV(607069, 5494721,346947 ,39372 ,39992),
T_JBV(607169, 5441591,73461 ,53048 ,39492),
T_JBV(607251, 5450309,355959 ,39372 ,39955),
T_JBV(607612, 5485949,412517 ,39372 ,39992),
T_JBV(607711, 5467733,272947 ,47964 ,39305),
T_JBV(608471, 5454385,354922 ,39900 ,39992),
T_JBV(608649, 5451037,430104 ,53048 ,39992),
T_JBV(608907, 5460039,427627 ,39900 ,39955),
T_JBV(608911, 5462851,427630 ,39900 ,39955),
T_JBV(608914, 5459646,427635 ,39900 ,39955),
T_JBV(609066, 5453300,430108 ,53048 ,39992),
T_JBV(609067, 5495081,344965 ,39372 ,39955),
T_JBV(609068, 5453304,430088 ,53048 ,39992),
T_JBV(609069, 5453307,430083 ,53048 ,39992),
T_JBV(609174, 5453884,265602 ,39900 ,39955),
T_JBV(609592, 5456266,430087 ,53048 ,39992),
T_JBV(609595, 5456278,430082 ,53048 ,39992),
T_JBV(610314, 5494229,419533 ,39372 ,39955),
T_JBV(610912, 5464936,409907 ,53048 ,39492),
T_JBV(611329, 5468489,292566 ,39372 ,39489),
T_JBV(611729, 5469733,346872 ,39372 ,39992),
T_JBV(611768, 5486870,389225 ,39372 ,39992),
T_JBV(611826, 5485962,350528 ,39372 ,39955),
T_JBV(611839, 5487002,389238 ,39372 ,39992),
T_JBV(611907, 5470864,292329 ,39372 ,39489),
T_JBV(611992, 5471228,292597 ,39372 ,39489),
T_JBV(612012, 5488147,1882 ,39372 ,39955),
T_JBV(612015, 5471321,389241 ,39372 ,39992),
T_JBV(612173, 5487030,74989 ,39372 ,39955),
T_JBV(612176, 5484658,346866 ,39372 ,39992),
T_JBV(612228, 5472404,435656 ,47964 ,39305),
T_JBV(612542, 5487394,12766 ,39372 ,39955),
T_JBV(612631, 5485967,4468 ,39372 ,39955),
T_JBV(612634, 5481849,346908 ,39372 ,39992),
T_JBV(612717, 5475306,334302 ,39372 ,39992),
T_JBV(612718, 5485374,46853 ,39372 ,39992),
T_JBV(612719, 5487182,4945 ,39372 ,39955),
T_JBV(612720, 5475314,354172 ,39372 ,39992),
T_JBV(612937, 5476628,265013 ,53048 ,53048),
T_JBV(613002, 5483600,53526 ,53048 ,39992),
T_JBV(613192, 5478551,1963 ,53048 ,39992),
T_JBV(613356, 5488729,3168 ,39900 ,39992),
T_JBV(613546, 5480612,50725 ,39900 ,39489),
T_JBV(613586, 5480998,46022 ,53048 ,39992),
T_JBV(613742, 5481721,417122 ,53048 ,39992),
T_JBV(613783, 5482064,390686 ,39900 ,39955),
T_JBV(613897, 5482776,427255 ,53048 ,39278),
T_JBV(613954, 5482925,292580 ,39372 ,39489),
T_JBV(613970, 5483020,264546 ,39372 ,39992),
T_JBV(614048, 5483647,53526 ,53048 ,39992),
T_JBV(614495, 5485971,39735 ,39372 ,39955),
T_JBV(614663, 5487070,152 ,53048 ,39278),
T_JBV(614701, 5487467,2641 ,53048 ,39992),
T_JBV(614857, 5488653,426564 ,39900 ,39955),
T_JBV(614916, 5488924,428466 ,39900 ,39489),
T_JBV(614969, 5489450,264134 ,39372 ,39955),
T_JBV(615359, 5491695,429053 ,53048 ,53048),
T_JBV(615388, 5491937,353814 ,39900 ,39955),
T_JBV(615445, 5492317,430083 ,53048 ,39992),
T_JBV(615504, 5492592,46827 ,53048 ,39992),
T_JBV(615584, 5493295,264563 ,39372 ,39992),
T_JBV(615591, 5493161,419534 ,53048 ,39992),
T_JBV(615934, 5495487,503143 ,53048 ,39992),
T_JBV(615956, 5495576,50767 ,39900 ,39489)

		); 
	V_TMP_JBV T_JBV;
    
BEGIN	
	DBMS_OUTPUT.PUT_LINE('[INICIO] ACTUALIZACION TRAMITES Y TAREAS');

	FOR I IN V_JBV.FIRST .. V_JBV.LAST
	
	LOOP
 
	V_TMP_JBV := V_JBV(I);
	
  	TRA_ID := TRIM(V_TMP_JBV(1));
  	
  	TAR_ID := TRIM(V_TMP_JBV(2));

	ACT_ID := TRIM(V_TMP_JBV(3));

	USU_ID := TRIM(V_TMP_JBV(4));

	SUP_ID := TRIM(V_TMP_JBV(5));
	
	--COMPROBAMOS SI EXISTE TAREA

		V_SQL := 'SELECT COUNT(*) FROM '||V_ESQUEMA||'.TAC_TAREAS_ACTIVOS WHERE TRA_ID = '||TRA_ID||' AND TAR_ID = '||TAR_ID||' AND ACT_ID = '||ACT_ID||'';
	
		EXECUTE IMMEDIATE V_SQL INTO V_NUM_FILAS_1;
	
		IF V_NUM_FILAS_1 > 0 THEN
	
			V_MSQL := 'UPDATE '||V_ESQUEMA||'.TAC_TAREAS_ACTIVOS 
					   SET SUP_ID = (SELECT USU_ID FROM REMMASTER.USU_USUARIOS WHERE USU_USERNAME = ''mruiz'') ,
					   USUARIOMODIFICAR = '''||V_USR||''',
					   FECHAMODIFICAR = SYSDATE 
					   WHERE TRA_ID = '||TRA_ID||' AND TAR_ID = '||TAR_ID||' AND ACT_ID = '||ACT_ID||'';
	

			EXECUTE IMMEDIATE V_MSQL;
	    
			DBMS_OUTPUT.PUT_LINE('[INFO] TRA_ID: '||TRA_ID||' ACTUALIZADO');
		
			V_COUNT_UPDATE_1 := V_COUNT_UPDATE_1 + 1;
		
		ELSE
		
			DBMS_OUTPUT.PUT_LINE('[INFO] REGISTRO NO EXISTE');
		
		END IF;
        
   	END LOOP;

	DBMS_OUTPUT.PUT_LINE('********************************************************************');

	DBMS_OUTPUT.PUT_LINE('[FIN] Se han updateado en total '||V_COUNT_UPDATE_1||' registros EN TAC_TAREAS_ACTIVOS');

	DBMS_OUTPUT.PUT_LINE('********************************************************************');

	DBMS_OUTPUT.PUT_LINE('[FIN] ');

	COMMIT;

EXCEPTION
     WHEN OTHERS THEN
          ERR_NUM := SQLCODE;
          ERR_MSG := SQLERRM;
          DBMS_OUTPUT.put_line('[ERROR] Se ha producido un error en la ejecución:'||TO_CHAR(ERR_NUM));
          DBMS_OUTPUT.put_line('-----------------------------------------------------------'); 
          DBMS_OUTPUT.put_line(ERR_MSG);
          ROLLBACK;
          RAISE;   
END;
/
EXIT;
