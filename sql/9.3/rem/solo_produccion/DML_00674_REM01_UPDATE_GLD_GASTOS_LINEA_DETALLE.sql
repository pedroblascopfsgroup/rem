--/*
--##########################################
--## AUTOR=Carlos Santos Vílchez
--## FECHA_CREACION=20210218
--## ARTEFACTO=online
--## VERSION_ARTEFACTO=9.3
--## INCIDENCIA_LINK=REMVIP-8816
--## PRODUCTO=NO
--##
--## Finalidad: Actualizar línea detalle
--## INSTRUCCIONES: 
--## VERSIONES:
--##        0.1 Version inicial
--##########################################
--*/

--Para permitir la visualización de texto en un bloque PL/SQL utilizando DBMS_OUTPUT.PUT_LINE

WHENEVER SQLERROR EXIT SQL.SQLCODE;
SET SERVEROUTPUT ON;
SET DEFINE OFF;


DECLARE
    V_MSQL VARCHAR2(32000 CHAR); -- Sentencia a ejecutar     
    V_ESQUEMA VARCHAR2(25 CHAR):= '#ESQUEMA#'; -- Configuracion Esquema
    V_ESQUEMA_M VARCHAR2(25 CHAR):= '#ESQUEMA_MASTER#'; -- Configuracion Esquema Master
    V_SQL VARCHAR2(4000 CHAR); -- Vble. para consulta que valida la existencia de una tabla.
    V_NUM_TABLAS NUMBER(16); -- Vble. para validar la existencia de una tabla.   
    ERR_NUM NUMBER(25);  -- Vble. auxiliar para registrar errores en el script.
    ERR_MSG VARCHAR2(1024 CHAR); -- Vble. auxiliar para registrar errores en el script.
	V_USUARIO VARCHAR2(50 CHAR) := 'REMVIP-8816';

    TYPE T_TIPO_DATA IS TABLE OF VARCHAR2(32000 CHAR);
    TYPE T_ARRAY_DATA IS TABLE OF T_TIPO_DATA;
    V_TIPO_DATA T_ARRAY_DATA := T_ARRAY_DATA(
		T_TIPO_DATA('12617048'),
		T_TIPO_DATA('12617049'),
		T_TIPO_DATA('12617050'),
		T_TIPO_DATA('12617051'),
		T_TIPO_DATA('12617052'),
		T_TIPO_DATA('12617053'),
		T_TIPO_DATA('12617054'),
		T_TIPO_DATA('12617055'),
		T_TIPO_DATA('12617056'),
		T_TIPO_DATA('12617057'),
		T_TIPO_DATA('12617058'),
		T_TIPO_DATA('12617059'),
		T_TIPO_DATA('12617060'),
		T_TIPO_DATA('12617061'),
		T_TIPO_DATA('12617062'),
		T_TIPO_DATA('12617063'),
		T_TIPO_DATA('12617064'),
		T_TIPO_DATA('12617065'),
		T_TIPO_DATA('12617066'),
		T_TIPO_DATA('12617067'),
		T_TIPO_DATA('12617068'),
		T_TIPO_DATA('12617069'),
		T_TIPO_DATA('12617070'),
		T_TIPO_DATA('12617071'),
		T_TIPO_DATA('12617113'),
		T_TIPO_DATA('12617114'),
		T_TIPO_DATA('12617115'),
		T_TIPO_DATA('12617116'),
		T_TIPO_DATA('12617117'),
		T_TIPO_DATA('12617118'),
		T_TIPO_DATA('12617119'),
		T_TIPO_DATA('12617120'),
		T_TIPO_DATA('12617121'),
		T_TIPO_DATA('12617122'),
		T_TIPO_DATA('12617123'),
		T_TIPO_DATA('12617124'),
		T_TIPO_DATA('12617125'),
		T_TIPO_DATA('12617126'),
		T_TIPO_DATA('12617127'),
		T_TIPO_DATA('12617128'),
		T_TIPO_DATA('12617129'),
		T_TIPO_DATA('12617130'),
		T_TIPO_DATA('12617131'),
		T_TIPO_DATA('12617132'),
		T_TIPO_DATA('12617133'),
		T_TIPO_DATA('12617134'),
		T_TIPO_DATA('12617135'),
		T_TIPO_DATA('12617136'),
		T_TIPO_DATA('12617137'),
		T_TIPO_DATA('12617138'),
		T_TIPO_DATA('12617139'),
		T_TIPO_DATA('12617140'),
		T_TIPO_DATA('12617141'),
		T_TIPO_DATA('12617142'),
		T_TIPO_DATA('12617143'),
		T_TIPO_DATA('12617144'),
		T_TIPO_DATA('12617145'),
		T_TIPO_DATA('12617146'),
		T_TIPO_DATA('12617147'),
		T_TIPO_DATA('12617148'),
		T_TIPO_DATA('12617149'),
		T_TIPO_DATA('12617150'),
		T_TIPO_DATA('12617151'),
		T_TIPO_DATA('12617152'),
		T_TIPO_DATA('12617153'),
		T_TIPO_DATA('12617154'),
		T_TIPO_DATA('12617155'),
		T_TIPO_DATA('12617156'),
		T_TIPO_DATA('12617157'),
		T_TIPO_DATA('12617158'),
		T_TIPO_DATA('12617159'),
		T_TIPO_DATA('12617160'),
		T_TIPO_DATA('12617161'),
		T_TIPO_DATA('12617162'),
		T_TIPO_DATA('12617163'),
		T_TIPO_DATA('12617164'),
		T_TIPO_DATA('12617165'),
		T_TIPO_DATA('12617166'),
		T_TIPO_DATA('12617167'),
		T_TIPO_DATA('12617168'),
		T_TIPO_DATA('12617169'),
		T_TIPO_DATA('12617170'),
		T_TIPO_DATA('12617171'),
		T_TIPO_DATA('12617172'),
		T_TIPO_DATA('12617173'),
		T_TIPO_DATA('12617175'),
		T_TIPO_DATA('12617176'),
		T_TIPO_DATA('12617177'),
		T_TIPO_DATA('12617178'),
		T_TIPO_DATA('12617179'),
		T_TIPO_DATA('12617186'),
		T_TIPO_DATA('12617187'),
		T_TIPO_DATA('12617188'),
		T_TIPO_DATA('12617189'),
		T_TIPO_DATA('12617190'),
		T_TIPO_DATA('12617191'),
		T_TIPO_DATA('12617192'),
		T_TIPO_DATA('12617193'),
		T_TIPO_DATA('12617194'),
		T_TIPO_DATA('12617195'),
		T_TIPO_DATA('12617196'),
		T_TIPO_DATA('12617197'),
		T_TIPO_DATA('12617198'),
		T_TIPO_DATA('12617199'),
		T_TIPO_DATA('12617200'),
		T_TIPO_DATA('12617201'),
		T_TIPO_DATA('12617202'),
		T_TIPO_DATA('12617203'),
		T_TIPO_DATA('12617204'),
		T_TIPO_DATA('12617205'),
		T_TIPO_DATA('12617206'),
		T_TIPO_DATA('12617207'),
		T_TIPO_DATA('12617208'),
		T_TIPO_DATA('12617209'),
		T_TIPO_DATA('12617210'),
		T_TIPO_DATA('12617211'),
		T_TIPO_DATA('12617212'),
		T_TIPO_DATA('12617213'),
		T_TIPO_DATA('12617214'),
		T_TIPO_DATA('12617215'),
		T_TIPO_DATA('12617312'),
		T_TIPO_DATA('12617313'),
		T_TIPO_DATA('12617314'),
		T_TIPO_DATA('12617315'),
		T_TIPO_DATA('12617316'),
		T_TIPO_DATA('12617317'),
		T_TIPO_DATA('12617318'),
		T_TIPO_DATA('12617319'),
		T_TIPO_DATA('12617320'),
		T_TIPO_DATA('12617321'),
		T_TIPO_DATA('12617322'),
		T_TIPO_DATA('12617323'),
		T_TIPO_DATA('12617324'),
		T_TIPO_DATA('12617325'),
		T_TIPO_DATA('12617326'),
		T_TIPO_DATA('12617327'),
		T_TIPO_DATA('12617328'),
		T_TIPO_DATA('12617329'),
		T_TIPO_DATA('12617330'),
		T_TIPO_DATA('12617331'),
		T_TIPO_DATA('12617332'),
		T_TIPO_DATA('12617333'),
		T_TIPO_DATA('12617334'),
		T_TIPO_DATA('12617335'),
		T_TIPO_DATA('12617336'),
		T_TIPO_DATA('12617337'),
		T_TIPO_DATA('12617338'),
		T_TIPO_DATA('12617339'),
		T_TIPO_DATA('12617340'),
		T_TIPO_DATA('12617341'),
		T_TIPO_DATA('12617342'),
		T_TIPO_DATA('12617343'),
		T_TIPO_DATA('12617344'),
		T_TIPO_DATA('12617345'),
		T_TIPO_DATA('12617346'),
		T_TIPO_DATA('12617347'),
		T_TIPO_DATA('12617348'),
		T_TIPO_DATA('12617349'),
		T_TIPO_DATA('12617350'),
		T_TIPO_DATA('12617351'),
		T_TIPO_DATA('12617352'),
		T_TIPO_DATA('12617353'),
		T_TIPO_DATA('12617354'),
		T_TIPO_DATA('12617355'),
		T_TIPO_DATA('12617356'),
		T_TIPO_DATA('12617357'),
		T_TIPO_DATA('12617359'),
		T_TIPO_DATA('12617360'),
		T_TIPO_DATA('12617361'),
		T_TIPO_DATA('12617362'),
		T_TIPO_DATA('12617363'),
		T_TIPO_DATA('12617364'),
		T_TIPO_DATA('12617365'),
		T_TIPO_DATA('12617366'),
		T_TIPO_DATA('12617367'),
		T_TIPO_DATA('12617368'),
		T_TIPO_DATA('12617369'),
		T_TIPO_DATA('12617370'),
		T_TIPO_DATA('12617371'),
		T_TIPO_DATA('12617372'),
		T_TIPO_DATA('12617373'),
		T_TIPO_DATA('12617374'),
		T_TIPO_DATA('12617375'),
		T_TIPO_DATA('12617376'),
		T_TIPO_DATA('12617377'),
		T_TIPO_DATA('12617378'),
		T_TIPO_DATA('12617379'),
		T_TIPO_DATA('12617380'),
		T_TIPO_DATA('12617381'),
		T_TIPO_DATA('12617382'),
		T_TIPO_DATA('12617383'),
		T_TIPO_DATA('12617384'),
		T_TIPO_DATA('12617385'),
		T_TIPO_DATA('12617386'),
		T_TIPO_DATA('12617387'),
		T_TIPO_DATA('12617388'),
		T_TIPO_DATA('12617389'),
		T_TIPO_DATA('12617390'),
		T_TIPO_DATA('12617391'),
		T_TIPO_DATA('12617392'),
		T_TIPO_DATA('12617393'),
		T_TIPO_DATA('12617394'),
		T_TIPO_DATA('12617395'),
		T_TIPO_DATA('12617396'),
		T_TIPO_DATA('12617397'),
		T_TIPO_DATA('12617398'),
		T_TIPO_DATA('12617399'),
		T_TIPO_DATA('12617400'),
		T_TIPO_DATA('12617401'),
		T_TIPO_DATA('12617402'),
		T_TIPO_DATA('12617403'),
		T_TIPO_DATA('12617404'),
		T_TIPO_DATA('12617405'),
		T_TIPO_DATA('12617406'),
		T_TIPO_DATA('12617407'),
		T_TIPO_DATA('12617408'),
		T_TIPO_DATA('12617409'),
		T_TIPO_DATA('12617410'),
		T_TIPO_DATA('12617411'),
		T_TIPO_DATA('12617412'),
		T_TIPO_DATA('12617413'),
		T_TIPO_DATA('12617414'),
		T_TIPO_DATA('12617415'),
		T_TIPO_DATA('12617416'),
		T_TIPO_DATA('12617417'),
		T_TIPO_DATA('12617418'),
		T_TIPO_DATA('12617419'),
		T_TIPO_DATA('12617420'),
		T_TIPO_DATA('12617421'),
		T_TIPO_DATA('12617422'),
		T_TIPO_DATA('12617423'),
		T_TIPO_DATA('12617424'),
		T_TIPO_DATA('12617425'),
		T_TIPO_DATA('12617426'),
		T_TIPO_DATA('12617427'),
		T_TIPO_DATA('12617428'),
		T_TIPO_DATA('12617429'),
		T_TIPO_DATA('12617430'),
		T_TIPO_DATA('12617431'),
		T_TIPO_DATA('12617432'),
		T_TIPO_DATA('12617433'),
		T_TIPO_DATA('12617434'),
		T_TIPO_DATA('12617435'),
		T_TIPO_DATA('12617436'),
		T_TIPO_DATA('12617437'),
		T_TIPO_DATA('12617438'),
		T_TIPO_DATA('12617439'),
		T_TIPO_DATA('12617440'),
		T_TIPO_DATA('12617441'),
		T_TIPO_DATA('12617442'),
		T_TIPO_DATA('12617443'),
		T_TIPO_DATA('12617444'),
		T_TIPO_DATA('12617445'),
		T_TIPO_DATA('12617446'),
		T_TIPO_DATA('12617447'),
		T_TIPO_DATA('12617448'),
		T_TIPO_DATA('12617449'),
		T_TIPO_DATA('12617450'),
		T_TIPO_DATA('12617451'),
		T_TIPO_DATA('12617452'),
		T_TIPO_DATA('12617453'),
		T_TIPO_DATA('12617454'),
		T_TIPO_DATA('12617455'),
		T_TIPO_DATA('12617456'),
		T_TIPO_DATA('12617457'),
		T_TIPO_DATA('12617458'),
		T_TIPO_DATA('12617459'),
		T_TIPO_DATA('12617460'),
		T_TIPO_DATA('12617461'),
		T_TIPO_DATA('12617462'),
		T_TIPO_DATA('12617463'),
		T_TIPO_DATA('12617464'),
		T_TIPO_DATA('12617465'),
		T_TIPO_DATA('12617466'),
		T_TIPO_DATA('12617467'),
		T_TIPO_DATA('12617468'),
		T_TIPO_DATA('12617469'),
		T_TIPO_DATA('12617470'),
		T_TIPO_DATA('12617471'),
		T_TIPO_DATA('12617609'),
		T_TIPO_DATA('12617610'),
		T_TIPO_DATA('12617611'),
		T_TIPO_DATA('12617612'),
		T_TIPO_DATA('12617613'),
		T_TIPO_DATA('12617614'),
		T_TIPO_DATA('12617615'),
		T_TIPO_DATA('12617616'),
		T_TIPO_DATA('12617617'),
		T_TIPO_DATA('12617618'),
		T_TIPO_DATA('12617619'),
		T_TIPO_DATA('12617620'),
		T_TIPO_DATA('12617621'),
		T_TIPO_DATA('12617622'),
		T_TIPO_DATA('12617623'),
		T_TIPO_DATA('12617624'),
		T_TIPO_DATA('12617625'),
		T_TIPO_DATA('12617626'),
		T_TIPO_DATA('12617627'),
		T_TIPO_DATA('12617628'),
		T_TIPO_DATA('12617629'),
		T_TIPO_DATA('12617630'),
		T_TIPO_DATA('12617631'),
		T_TIPO_DATA('12624304'),
		T_TIPO_DATA('12624305'),
		T_TIPO_DATA('12624306'),
		T_TIPO_DATA('12624307'),
		T_TIPO_DATA('12624308'),
		T_TIPO_DATA('12624516'),
		T_TIPO_DATA('12624534'),
		T_TIPO_DATA('12634912'),
		T_TIPO_DATA('12634915'),
		T_TIPO_DATA('12634918'),
		T_TIPO_DATA('12634919'),
		T_TIPO_DATA('12634921'),
		T_TIPO_DATA('12634922'),
		T_TIPO_DATA('12634923'),
		T_TIPO_DATA('12634925'),
		T_TIPO_DATA('12634929'),
		T_TIPO_DATA('12634930'),
		T_TIPO_DATA('12634931'),
		T_TIPO_DATA('12634934'),
		T_TIPO_DATA('12634935'),
		T_TIPO_DATA('12634936'),
		T_TIPO_DATA('12634937'),
		T_TIPO_DATA('12634938'),
		T_TIPO_DATA('12634939'),
		T_TIPO_DATA('12634940'),
		T_TIPO_DATA('12634941'),
		T_TIPO_DATA('12634946'),
		T_TIPO_DATA('12634947'),
		T_TIPO_DATA('12634948'),
		T_TIPO_DATA('12634949'),
		T_TIPO_DATA('12634953'),
		T_TIPO_DATA('12634968'),
		T_TIPO_DATA('12634969'),
		T_TIPO_DATA('12634971'),
		T_TIPO_DATA('12634972'),
		T_TIPO_DATA('12634973'),
		T_TIPO_DATA('12634974'),
		T_TIPO_DATA('12634975'),
		T_TIPO_DATA('12634977'),
		T_TIPO_DATA('12634978'),
		T_TIPO_DATA('12634979'),
		T_TIPO_DATA('12634980'),
		T_TIPO_DATA('12634981'),
		T_TIPO_DATA('12634982'),
		T_TIPO_DATA('12634983'),
		T_TIPO_DATA('12634984'),
		T_TIPO_DATA('12634985'),
		T_TIPO_DATA('12634987'),
		T_TIPO_DATA('12634988'),
		T_TIPO_DATA('12634989'),
		T_TIPO_DATA('12634990'),
		T_TIPO_DATA('12634991'),
		T_TIPO_DATA('12643643'),
		T_TIPO_DATA('12646438'),
		T_TIPO_DATA('12646439'),
		T_TIPO_DATA('12646440'),
		T_TIPO_DATA('12646441'),
		T_TIPO_DATA('12646442'),
		T_TIPO_DATA('12646443'),
		T_TIPO_DATA('12646444'),
		T_TIPO_DATA('12646445'),
		T_TIPO_DATA('12646446'),
		T_TIPO_DATA('12646447'),
		T_TIPO_DATA('12646448'),
		T_TIPO_DATA('12646449'),
		T_TIPO_DATA('12646450'),
		T_TIPO_DATA('12646451'),
		T_TIPO_DATA('12646452'),
		T_TIPO_DATA('12646453'),
		T_TIPO_DATA('12646454'),
		T_TIPO_DATA('12646455'),
		T_TIPO_DATA('12646456'),
		T_TIPO_DATA('12646457'),
		T_TIPO_DATA('12646458'),
		T_TIPO_DATA('12646459'),
		T_TIPO_DATA('12646460'),
		T_TIPO_DATA('12646461'),
		T_TIPO_DATA('12646462'),
		T_TIPO_DATA('12646463'),
		T_TIPO_DATA('12646464'),
		T_TIPO_DATA('12646465'),
		T_TIPO_DATA('12646466'),
		T_TIPO_DATA('12646467'),
		T_TIPO_DATA('12646468'),
		T_TIPO_DATA('12646469'),
		T_TIPO_DATA('12646470'),
		T_TIPO_DATA('12646471'),
		T_TIPO_DATA('12646472'),
		T_TIPO_DATA('12646473'),
		T_TIPO_DATA('12646474'),
		T_TIPO_DATA('12646475'),
		T_TIPO_DATA('12646476'),
		T_TIPO_DATA('12646477'),
		T_TIPO_DATA('12646478'),
		T_TIPO_DATA('12646479'),
		T_TIPO_DATA('12646480'),
		T_TIPO_DATA('12646481'),
		T_TIPO_DATA('12646482'),
		T_TIPO_DATA('12646483'),
		T_TIPO_DATA('12646484'),
		T_TIPO_DATA('12646485'),
		T_TIPO_DATA('12646486'),
		T_TIPO_DATA('12646487'),
		T_TIPO_DATA('12646488'),
		T_TIPO_DATA('12646489'),
		T_TIPO_DATA('12646490'),
		T_TIPO_DATA('12646491'),
		T_TIPO_DATA('12646492'),
		T_TIPO_DATA('12646493'),
		T_TIPO_DATA('12646494'),
		T_TIPO_DATA('12646495'),
		T_TIPO_DATA('12646496'),
		T_TIPO_DATA('12646497'),
		T_TIPO_DATA('12646498'),
		T_TIPO_DATA('12646499'),
		T_TIPO_DATA('12646500'),
		T_TIPO_DATA('12646501'),
		T_TIPO_DATA('12646502'),
		T_TIPO_DATA('12646503'),
		T_TIPO_DATA('12646504'),
		T_TIPO_DATA('12646505'),
		T_TIPO_DATA('12646506'),
		T_TIPO_DATA('12646507'),
		T_TIPO_DATA('12646508'),
		T_TIPO_DATA('12646509'),
		T_TIPO_DATA('12646510'),
		T_TIPO_DATA('12646511'),
		T_TIPO_DATA('12646512'),
		T_TIPO_DATA('12646513'),
		T_TIPO_DATA('12646514'),
		T_TIPO_DATA('12646515'),
		T_TIPO_DATA('12646516'),
		T_TIPO_DATA('12646517'),
		T_TIPO_DATA('12646518'),
		T_TIPO_DATA('12646519'),
		T_TIPO_DATA('12646520'),
		T_TIPO_DATA('12646521'),
		T_TIPO_DATA('12646522'),
		T_TIPO_DATA('12646523'),
		T_TIPO_DATA('12646524'),
		T_TIPO_DATA('12646525'),
		T_TIPO_DATA('12646526'),
		T_TIPO_DATA('12646527'),
		T_TIPO_DATA('12646528'),
		T_TIPO_DATA('12646529'),
		T_TIPO_DATA('12646530'),
		T_TIPO_DATA('12646531'),
		T_TIPO_DATA('12646532'),
		T_TIPO_DATA('12646533'),
		T_TIPO_DATA('12646534'),
		T_TIPO_DATA('12646535'),
		T_TIPO_DATA('12646536'),
		T_TIPO_DATA('12646537'),
		T_TIPO_DATA('12646538'),
		T_TIPO_DATA('12646539'),
		T_TIPO_DATA('12646540'),
		T_TIPO_DATA('12646541'),
		T_TIPO_DATA('12646542'),
		T_TIPO_DATA('12646543'),
		T_TIPO_DATA('12646544'),
		T_TIPO_DATA('12646545'),
		T_TIPO_DATA('12646546'),
		T_TIPO_DATA('12646547'),
		T_TIPO_DATA('12646548'),
		T_TIPO_DATA('12646549'),
		T_TIPO_DATA('12646550'),
		T_TIPO_DATA('12646551'),
		T_TIPO_DATA('12646552'),
		T_TIPO_DATA('12646639'),
		T_TIPO_DATA('12646714'),
		T_TIPO_DATA('12646715'),
		T_TIPO_DATA('12646716'),
		T_TIPO_DATA('12646717'),
		T_TIPO_DATA('12646718'),
		T_TIPO_DATA('12646719'),
		T_TIPO_DATA('12646720'),
		T_TIPO_DATA('12646721'),
		T_TIPO_DATA('12646722'),
		T_TIPO_DATA('12646723'),
		T_TIPO_DATA('12646724'),
		T_TIPO_DATA('12646725'),
		T_TIPO_DATA('12646726'),
		T_TIPO_DATA('12646727'),
		T_TIPO_DATA('12646728'),
		T_TIPO_DATA('12646729'),
		T_TIPO_DATA('12646730'),
		T_TIPO_DATA('12646731'),
		T_TIPO_DATA('12646732'),
		T_TIPO_DATA('12646733'),
		T_TIPO_DATA('12646734'),
		T_TIPO_DATA('12646735'),
		T_TIPO_DATA('12646736'),
		T_TIPO_DATA('12646737'),
		T_TIPO_DATA('12646738'),
		T_TIPO_DATA('12646739'),
		T_TIPO_DATA('12646740'),
		T_TIPO_DATA('12646741'),
		T_TIPO_DATA('12646742'),
		T_TIPO_DATA('12646743'),
		T_TIPO_DATA('12646744'),
		T_TIPO_DATA('12646745'),
		T_TIPO_DATA('12646746'),
		T_TIPO_DATA('12646747'),
		T_TIPO_DATA('12646748'),
		T_TIPO_DATA('12646749'),
		T_TIPO_DATA('12646750'),
		T_TIPO_DATA('12646751'),
		T_TIPO_DATA('12646752'),
		T_TIPO_DATA('12646753'),
		T_TIPO_DATA('12646754'),
		T_TIPO_DATA('12646755'),
		T_TIPO_DATA('12646756'),
		T_TIPO_DATA('12646757'),
		T_TIPO_DATA('12646758'),
		T_TIPO_DATA('12646759'),
		T_TIPO_DATA('12646760'),
		T_TIPO_DATA('12646761'),
		T_TIPO_DATA('12646762'),
		T_TIPO_DATA('12646763'),
		T_TIPO_DATA('12646764'),
		T_TIPO_DATA('12646765'),
		T_TIPO_DATA('12646766'),
		T_TIPO_DATA('12646767'),
		T_TIPO_DATA('12646768'),
		T_TIPO_DATA('12646769'),
		T_TIPO_DATA('12646770'),
		T_TIPO_DATA('12646771'),
		T_TIPO_DATA('12646772'),
		T_TIPO_DATA('12646773'),
		T_TIPO_DATA('12646774'),
		T_TIPO_DATA('12646775'),
		T_TIPO_DATA('12646776'),
		T_TIPO_DATA('12646777'),
		T_TIPO_DATA('12646778'),
		T_TIPO_DATA('12646779'),
		T_TIPO_DATA('12646780'),
		T_TIPO_DATA('12646781'),
		T_TIPO_DATA('12646782'),
		T_TIPO_DATA('12646783'),
		T_TIPO_DATA('12646784'),
		T_TIPO_DATA('12646785'),
		T_TIPO_DATA('12646786'),
		T_TIPO_DATA('12646787'),
		T_TIPO_DATA('12646788'),
		T_TIPO_DATA('12646789'),
		T_TIPO_DATA('12646790'),
		T_TIPO_DATA('12646791'),
		T_TIPO_DATA('12646792'),
		T_TIPO_DATA('12646793'),
		T_TIPO_DATA('12646794'),
		T_TIPO_DATA('12646795'),
		T_TIPO_DATA('12646796'),
		T_TIPO_DATA('12646797'),
		T_TIPO_DATA('12646798'),
		T_TIPO_DATA('12646799'),
		T_TIPO_DATA('12646800'),
		T_TIPO_DATA('12646801'),
		T_TIPO_DATA('12646802'),
		T_TIPO_DATA('12646803'),
		T_TIPO_DATA('12646804'),
		T_TIPO_DATA('12646805'),
		T_TIPO_DATA('12646806'),
		T_TIPO_DATA('12646807'),
		T_TIPO_DATA('12646808'),
		T_TIPO_DATA('12646809'),
		T_TIPO_DATA('12646810'),
		T_TIPO_DATA('12646811'),
		T_TIPO_DATA('12646812'),
		T_TIPO_DATA('12646813'),
		T_TIPO_DATA('12646814'),
		T_TIPO_DATA('12646815'),
		T_TIPO_DATA('12646816'),
		T_TIPO_DATA('12646817'),
		T_TIPO_DATA('12646818'),
		T_TIPO_DATA('12646819'),
		T_TIPO_DATA('12646820'),
		T_TIPO_DATA('12646821'),
		T_TIPO_DATA('12646822'),
		T_TIPO_DATA('12646823'),
		T_TIPO_DATA('12646824'),
		T_TIPO_DATA('12646825'),
		T_TIPO_DATA('12646826'),
		T_TIPO_DATA('12646827'),
		T_TIPO_DATA('12646828'),
		T_TIPO_DATA('12646829'),
		T_TIPO_DATA('12646830'),
		T_TIPO_DATA('12646831'),
		T_TIPO_DATA('12646832'),
		T_TIPO_DATA('12646833'),
		T_TIPO_DATA('12646834'),
		T_TIPO_DATA('12646835'),
		T_TIPO_DATA('12646836'),
		T_TIPO_DATA('12646837'),
		T_TIPO_DATA('12646838'),
		T_TIPO_DATA('12646839'),
		T_TIPO_DATA('12646840'),
		T_TIPO_DATA('12646841'),
		T_TIPO_DATA('12646842'),
		T_TIPO_DATA('12646843'),
		T_TIPO_DATA('12646844'),
		T_TIPO_DATA('12646845'),
		T_TIPO_DATA('12646846'),
		T_TIPO_DATA('12646847'),
		T_TIPO_DATA('12646848'),
		T_TIPO_DATA('12646849'),
		T_TIPO_DATA('12646850'),
		T_TIPO_DATA('12646851'),
		T_TIPO_DATA('12646852'),
		T_TIPO_DATA('12646853'),
		T_TIPO_DATA('12646854'),
		T_TIPO_DATA('12646855'),
		T_TIPO_DATA('12646856'),
		T_TIPO_DATA('12646857'),
		T_TIPO_DATA('12646858'),
		T_TIPO_DATA('12646859'),
		T_TIPO_DATA('12646860'),
		T_TIPO_DATA('12646861'),
		T_TIPO_DATA('12646862'),
		T_TIPO_DATA('12646863'),
		T_TIPO_DATA('12646864'),
		T_TIPO_DATA('12646865'),
		T_TIPO_DATA('12646866'),
		T_TIPO_DATA('12646867'),
		T_TIPO_DATA('12646868'),
		T_TIPO_DATA('12646869'),
		T_TIPO_DATA('12646870'),
		T_TIPO_DATA('12646871'),
		T_TIPO_DATA('12646872'),
		T_TIPO_DATA('12646873'),
		T_TIPO_DATA('12646874'),
		T_TIPO_DATA('12646875'),
		T_TIPO_DATA('12646876'),
		T_TIPO_DATA('12646877'),
		T_TIPO_DATA('12646878'),
		T_TIPO_DATA('12646879'),
		T_TIPO_DATA('12646880'),
		T_TIPO_DATA('12646881'),
		T_TIPO_DATA('12646882'),
		T_TIPO_DATA('12646883'),
		T_TIPO_DATA('12646884'),
		T_TIPO_DATA('12646885'),
		T_TIPO_DATA('12646886'),
		T_TIPO_DATA('12646887'),
		T_TIPO_DATA('12646888'),
		T_TIPO_DATA('12646889'),
		T_TIPO_DATA('12646890'),
		T_TIPO_DATA('12646891'),
		T_TIPO_DATA('12646892'),
		T_TIPO_DATA('12646893'),
		T_TIPO_DATA('12646894'),
		T_TIPO_DATA('12646895'),
		T_TIPO_DATA('12646896'),
		T_TIPO_DATA('12646897'),
		T_TIPO_DATA('12646898'),
		T_TIPO_DATA('12646899'),
		T_TIPO_DATA('12646900'),
		T_TIPO_DATA('12646901'),
		T_TIPO_DATA('12646902'),
		T_TIPO_DATA('12646903'),
		T_TIPO_DATA('12646904'),
		T_TIPO_DATA('12646905'),
		T_TIPO_DATA('12646906'),
		T_TIPO_DATA('12646907'),
		T_TIPO_DATA('12646908'),
		T_TIPO_DATA('12646909'),
		T_TIPO_DATA('12646910'),
		T_TIPO_DATA('12646911'),
		T_TIPO_DATA('12646912'),
		T_TIPO_DATA('12646913'),
		T_TIPO_DATA('12646914'),
		T_TIPO_DATA('12646915'),
		T_TIPO_DATA('12646916'),
		T_TIPO_DATA('12646917'),
		T_TIPO_DATA('12646918'),
		T_TIPO_DATA('12646919'),
		T_TIPO_DATA('12646920'),
		T_TIPO_DATA('12646921'),
		T_TIPO_DATA('12646922'),
		T_TIPO_DATA('12646923'),
		T_TIPO_DATA('12646924'),
		T_TIPO_DATA('12646925'),
		T_TIPO_DATA('12646926'),
		T_TIPO_DATA('12646927'),
		T_TIPO_DATA('12646928'),
		T_TIPO_DATA('12664189'),
		T_TIPO_DATA('12664190'),
		T_TIPO_DATA('12664191'),
		T_TIPO_DATA('12664192'),
		T_TIPO_DATA('12664193'),
		T_TIPO_DATA('12664194'),
		T_TIPO_DATA('12664195'),
		T_TIPO_DATA('12664196'),
		T_TIPO_DATA('12664197'),
		T_TIPO_DATA('12664198')
    ); 
    V_TMP_TIPO_DATA T_TIPO_DATA;
    
BEGIN
    
	DBMS_OUTPUT.PUT_LINE('[INICIO]');
    
	FOR I IN V_TIPO_DATA.FIRST .. V_TIPO_DATA.LAST
	LOOP
		V_TMP_TIPO_DATA := V_TIPO_DATA(I);

		V_MSQL := 'SELECT COUNT(1) FROM '||V_ESQUEMA||'.GPV_GASTOS_PROVEEDOR WHERE GPV_NUM_GASTO_HAYA = '''||V_TMP_TIPO_DATA(1)||''' ';
    	EXECUTE IMMEDIATE V_MSQL INTO V_NUM_TABLAS;	

    	IF V_NUM_TABLAS = 1 THEN
			
			V_MSQL := 'UPDATE '||V_ESQUEMA||'.GLD_GASTOS_LINEA_DETALLE SET
			GLD_APARTADO_BASE = ''05'',
			GLD_CAPITULO_BASE = ''15'',
			USUARIOMODIFICAR = '''||V_USUARIO||''',
			FECHAMODIFICAR = SYSDATE
			WHERE GPV_ID = (SELECT GPV_ID FROM '||V_ESQUEMA||'.GPV_GASTOS_PROVEEDOR WHERE GPV_NUM_GASTO_HAYA = '''||V_TMP_TIPO_DATA(1)||''')';                          
			EXECUTE IMMEDIATE V_MSQL;
			
			DBMS_OUTPUT.PUT_LINE('[INFO]: SE HA ACTUALIZADO LA LINEA DE DETALLE DEL GASTO '''||V_TMP_TIPO_DATA(1)||'''.');

		ELSE

			DBMS_OUTPUT.PUT_LINE('[INFO]: EL GASTO '''||V_TMP_TIPO_DATA(1)||''' NO EXISTE.');

		END IF;
			
	END LOOP;

	DBMS_OUTPUT.PUT_LINE('[FIN]');

    COMMIT;

EXCEPTION
     WHEN OTHERS THEN
          ERR_NUM := SQLCODE;
          ERR_MSG := SQLERRM;
          DBMS_OUTPUT.put_line('[ERROR] Se ha producido un error en la ejecución:'||TO_CHAR(ERR_NUM));
          DBMS_OUTPUT.put_line('-----------------------------------------------------------'); 
          DBMS_OUTPUT.put_line(ERR_MSG);
          ROLLBACK;
          RAISE;   
END;
/
EXIT;
