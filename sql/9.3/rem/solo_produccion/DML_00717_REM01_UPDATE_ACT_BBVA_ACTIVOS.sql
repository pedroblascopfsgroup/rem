--/*
--##########################################
--## AUTOR=IVAN REPISO
--## FECHA_CREACION=20210302
--## ARTEFACTO=online
--## VERSION_ARTEFACTO=9.3
--## INCIDENCIA_LINK=REMVIP-9109
--## PRODUCTO=NO
--##
--## Finalidad: Script informa codigo promocion BBVA
--## INSTRUCCIONES:
--## VERSIONES:
--##        0.1 Versi√≥n inicial
--##########################################
--*/

WHENEVER SQLERROR EXIT SQL.SQLCODE;
SET SERVEROUTPUT ON; 
SET DEFINE OFF;


DECLARE

    V_MSQL VARCHAR2(32000 CHAR); -- Sentencia a ejecutar.
    V_ESQUEMA VARCHAR2(25 CHAR):= '#ESQUEMA#'; -- Configuracion Esquema.
    V_ESQUEMA_M VARCHAR2(25 CHAR):= '#ESQUEMA_MASTER#'; -- Configuracion Esquema Master.
    ERR_NUM NUMBER(25);  -- Vble. auxiliar para registrar errores en el script.
    ERR_MSG VARCHAR2(1024 CHAR); -- Vble. auxiliar para registrar errores en el script.
    V_TEXT_TABLA VARCHAR2(27 CHAR) := 'ACT_BBVA_ACTIVOS'; -- Vble. auxiliar para almacenar el nombre de la tabla de ref.
    V_USU VARCHAR2(30 CHAR) := 'REMVIP-9109'; -- Vble. auxiliar para almacenar el nombre de usuario que modifica los registros.
	V_COUNT NUMBER(16);

    TYPE T_TIPO_DATA IS TABLE OF VARCHAR2(1024);
    TYPE T_ARRAY_DATA IS TABLE OF T_TIPO_DATA;

    V_TIPO_DATA T_ARRAY_DATA := T_ARRAY_DATA(
    
	T_TIPO_DATA(930,'077158-01'),
	T_TIPO_DATA(1342,'074151-01'),
	T_TIPO_DATA(1607,'070924-01'),
	T_TIPO_DATA(1645,'070676-01'),
	T_TIPO_DATA(1654,'077736-01'),
	T_TIPO_DATA(2084,'071288-01'),
	T_TIPO_DATA(2097,'072396-01'),
	T_TIPO_DATA(2249,'078608-01'),
	T_TIPO_DATA(2851,'055592-01'),
	T_TIPO_DATA(2897,'042494-01'),
	T_TIPO_DATA(3127,'042817-01'),
	T_TIPO_DATA(3972,'075057-01'),
	T_TIPO_DATA(4735,'044403-01'),
	T_TIPO_DATA(5022,'081848-01'),
	T_TIPO_DATA(8341,'106259-01'),
	T_TIPO_DATA(8537,'108091-01'),
	T_TIPO_DATA(8783,'108119-01'),
	T_TIPO_DATA(9080,'111751-01'),
	T_TIPO_DATA(10443,'117983-01'),
	T_TIPO_DATA(10775,'115797-01'),
	T_TIPO_DATA(11524,'123177-01'),
	T_TIPO_DATA(11828,'112843-01'),
	T_TIPO_DATA(11908,'120445-01'),
	T_TIPO_DATA(12243,'125399-01'),
	T_TIPO_DATA(13448,'118593-01'),
	T_TIPO_DATA(13866,'T00078-01'),
	T_TIPO_DATA(14187,'124670-01'),
	T_TIPO_DATA(14363,'122434-01'),
	T_TIPO_DATA(15118,'130551-01'),
	T_TIPO_DATA(15346,'130979-01'),
	T_TIPO_DATA(15522,'131155-01'),
	T_TIPO_DATA(15804,'131877-01'),
	T_TIPO_DATA(16298,'132365-01'),
	T_TIPO_DATA(16549,'133282-01'),
	T_TIPO_DATA(16655,'132569-03'),
	T_TIPO_DATA(16781,'133793-01'),
	T_TIPO_DATA(16862,'133875-01'),
	T_TIPO_DATA(16986,'134123-01'),
	T_TIPO_DATA(17152,'133870-01'),
	T_TIPO_DATA(17163,'134338-01'),
	T_TIPO_DATA(17198,'134412-01'),
	T_TIPO_DATA(17388,'134650-01'),
	T_TIPO_DATA(17751,'135324-01'),
	T_TIPO_DATA(17996,'135675-01'),
	T_TIPO_DATA(18073,'134961-01'),
	T_TIPO_DATA(18074,'134961-02'),
	T_TIPO_DATA(18591,'136863-01'),
	T_TIPO_DATA(18592,'136863-02'),
	T_TIPO_DATA(19335,'122626-01'),
	T_TIPO_DATA(20178,'138549-01'),
	T_TIPO_DATA(20209,'138603-01'),
	T_TIPO_DATA(20885,'139356-01'),
	T_TIPO_DATA(21077,'139624-01'),
	T_TIPO_DATA(21231,'139927-02'),
	T_TIPO_DATA(21580,'140479-01'),
	T_TIPO_DATA(21581,'140479-01'),
	T_TIPO_DATA(21582,'140479-01'),
	T_TIPO_DATA(21583,'140479-01'),
	T_TIPO_DATA(21584,'140479-01'),
	T_TIPO_DATA(21585,'140479-01'),
	T_TIPO_DATA(21586,'140479-01'),
	T_TIPO_DATA(21587,'140479-01'),
	T_TIPO_DATA(21588,'140479-01'),
	T_TIPO_DATA(21589,'140479-01'),
	T_TIPO_DATA(21590,'140479-01'),
	T_TIPO_DATA(21591,'140479-01'),
	T_TIPO_DATA(21592,'140479-01'),
	T_TIPO_DATA(21593,'140479-01'),
	T_TIPO_DATA(21594,'140479-01'),
	T_TIPO_DATA(21595,'140479-01'),
	T_TIPO_DATA(21596,'140479-01'),
	T_TIPO_DATA(21597,'140479-01'),
	T_TIPO_DATA(21598,'140479-01'),
	T_TIPO_DATA(21688,'140617-01'),
	T_TIPO_DATA(22086,'140832-01'),
	T_TIPO_DATA(22345,'141558-01'),
	T_TIPO_DATA(23132,'142686-01'),
	T_TIPO_DATA(23211,'142830-01'),
	T_TIPO_DATA(23213,'142830-01'),
	T_TIPO_DATA(23214,'142830-01'),
	T_TIPO_DATA(23215,'142830-01'),
	T_TIPO_DATA(23310,'128159-01'),
	T_TIPO_DATA(23990,'122563-01'),
	T_TIPO_DATA(24363,'144516-01'),
	T_TIPO_DATA(24773,'134653-01'),
	T_TIPO_DATA(26032,'145388-01'),
	T_TIPO_DATA(26033,'145388-01'),
	T_TIPO_DATA(26034,'145388-01'),
	T_TIPO_DATA(26035,'145388-01'),
	T_TIPO_DATA(26036,'145388-01'),
	T_TIPO_DATA(26037,'145388-01'),
	T_TIPO_DATA(26038,'145388-01'),
	T_TIPO_DATA(26039,'145388-01'),
	T_TIPO_DATA(26040,'145388-01'),
	T_TIPO_DATA(26041,'145388-01'),
	T_TIPO_DATA(26042,'145388-01'),
	T_TIPO_DATA(26043,'145388-01'),
	T_TIPO_DATA(26044,'145388-01'),
	T_TIPO_DATA(26045,'145388-01'),
	T_TIPO_DATA(26046,'145388-01'),
	T_TIPO_DATA(26047,'145388-01'),
	T_TIPO_DATA(26048,'145388-01'),
	T_TIPO_DATA(26049,'145388-01'),
	T_TIPO_DATA(26050,'145388-01'),
	T_TIPO_DATA(26051,'145388-01'),
	T_TIPO_DATA(26052,'145388-01'),
	T_TIPO_DATA(26053,'145388-01'),
	T_TIPO_DATA(26054,'145388-01'),
	T_TIPO_DATA(26055,'145388-01'),
	T_TIPO_DATA(26056,'145388-01'),
	T_TIPO_DATA(26057,'145388-01'),
	T_TIPO_DATA(26058,'145388-01'),
	T_TIPO_DATA(26059,'145388-01'),
	T_TIPO_DATA(26060,'145388-01'),
	T_TIPO_DATA(26061,'145388-01'),
	T_TIPO_DATA(26062,'145388-01'),
	T_TIPO_DATA(26063,'145388-01'),
	T_TIPO_DATA(26064,'145388-01'),
	T_TIPO_DATA(26065,'145388-01'),
	T_TIPO_DATA(26066,'145388-01'),
	T_TIPO_DATA(26067,'145388-01'),
	T_TIPO_DATA(26068,'145388-01'),
	T_TIPO_DATA(26069,'145388-01'),
	T_TIPO_DATA(26070,'145388-01'),
	T_TIPO_DATA(26071,'145388-01'),
	T_TIPO_DATA(26072,'145388-01'),
	T_TIPO_DATA(26073,'145388-01'),
	T_TIPO_DATA(26074,'145388-01'),
	T_TIPO_DATA(26075,'145388-01'),
	T_TIPO_DATA(26076,'145388-01'),
	T_TIPO_DATA(26077,'145388-01'),
	T_TIPO_DATA(26078,'145388-01'),
	T_TIPO_DATA(26079,'145388-01'),
	T_TIPO_DATA(26080,'145388-01'),
	T_TIPO_DATA(26081,'145388-01'),
	T_TIPO_DATA(26082,'145388-01'),
	T_TIPO_DATA(26083,'145388-01'),
	T_TIPO_DATA(26084,'145388-01'),
	T_TIPO_DATA(26085,'145388-01'),
	T_TIPO_DATA(26086,'145388-01'),
	T_TIPO_DATA(26087,'145388-01'),
	T_TIPO_DATA(26088,'145388-01'),
	T_TIPO_DATA(26089,'145388-01'),
	T_TIPO_DATA(26090,'145388-01'),
	T_TIPO_DATA(26091,'145388-01'),
	T_TIPO_DATA(26092,'145388-01'),
	T_TIPO_DATA(26093,'145388-01'),
	T_TIPO_DATA(26094,'145388-01'),
	T_TIPO_DATA(26095,'145388-01'),
	T_TIPO_DATA(26096,'145388-01'),
	T_TIPO_DATA(26097,'145388-01'),
	T_TIPO_DATA(26098,'145388-01'),
	T_TIPO_DATA(26099,'145388-01'),
	T_TIPO_DATA(26100,'145388-01'),
	T_TIPO_DATA(26101,'145388-01'),
	T_TIPO_DATA(26102,'145388-01'),
	T_TIPO_DATA(26103,'145388-01'),
	T_TIPO_DATA(26104,'145388-01'),
	T_TIPO_DATA(26105,'145388-01'),
	T_TIPO_DATA(26106,'145388-01'),
	T_TIPO_DATA(26107,'145388-01'),
	T_TIPO_DATA(26108,'145388-01'),
	T_TIPO_DATA(26109,'145388-01'),
	T_TIPO_DATA(26110,'145388-01'),
	T_TIPO_DATA(26111,'145388-01'),
	T_TIPO_DATA(26112,'145388-01'),
	T_TIPO_DATA(26113,'145388-01'),
	T_TIPO_DATA(26114,'145388-01'),
	T_TIPO_DATA(26115,'145388-01'),
	T_TIPO_DATA(26116,'145388-01'),
	T_TIPO_DATA(26117,'145388-01'),
	T_TIPO_DATA(26118,'145388-01'),
	T_TIPO_DATA(26119,'145388-01'),
	T_TIPO_DATA(26120,'145388-01'),
	T_TIPO_DATA(26121,'145388-01'),
	T_TIPO_DATA(26122,'145388-01'),
	T_TIPO_DATA(26123,'145388-01'),
	T_TIPO_DATA(26124,'145388-01'),
	T_TIPO_DATA(26125,'145388-01'),
	T_TIPO_DATA(26126,'145388-01'),
	T_TIPO_DATA(26127,'145388-01'),
	T_TIPO_DATA(26128,'145388-01'),
	T_TIPO_DATA(26129,'145388-01'),
	T_TIPO_DATA(26130,'145388-01'),
	T_TIPO_DATA(26131,'145388-01'),
	T_TIPO_DATA(26132,'145388-01'),
	T_TIPO_DATA(26133,'145388-01'),
	T_TIPO_DATA(26134,'145388-01'),
	T_TIPO_DATA(26135,'145388-01'),
	T_TIPO_DATA(26136,'145388-01'),
	T_TIPO_DATA(26137,'145388-01'),
	T_TIPO_DATA(26253,'145447-01'),
	T_TIPO_DATA(26422,'145433-27'),
	T_TIPO_DATA(26517,'145433-45'),
	T_TIPO_DATA(26618,'145433-57'),
	T_TIPO_DATA(26710,'145561-01'),
	T_TIPO_DATA(26807,'145625-01'),
	T_TIPO_DATA(26873,'145651-01'),
	T_TIPO_DATA(26927,'129304-01'),
	T_TIPO_DATA(26935,'129304-01'),
	T_TIPO_DATA(26936,'129304-01'),
	T_TIPO_DATA(27196,'145112-01'),
	T_TIPO_DATA(27366,'142238-01'),
	T_TIPO_DATA(27476,'117242-01'),
	T_TIPO_DATA(27664,'146085-01'),
	T_TIPO_DATA(27694,'146089-01'),
	T_TIPO_DATA(27696,'146103-01'),
	T_TIPO_DATA(27745,'146212-01'),
	T_TIPO_DATA(27774,'140875-01'),
	T_TIPO_DATA(27809,'146253-01'),
	T_TIPO_DATA(27886,'110806-01'),
	T_TIPO_DATA(27937,'110806-01'),
	T_TIPO_DATA(27999,'141836-01'),
	T_TIPO_DATA(28288,'146508-01'),
	T_TIPO_DATA(28572,'146606-01'),
	T_TIPO_DATA(28975,'146684-02'),
	T_TIPO_DATA(28993,'110659-01'),
	T_TIPO_DATA(29206,'146808-01'),
	T_TIPO_DATA(29503,'146830-01'),
	T_TIPO_DATA(29586,'146777-01'),
	T_TIPO_DATA(29664,'146936-01'),
	T_TIPO_DATA(29772,'146993-01'),
	T_TIPO_DATA(29773,'146993-01'),
	T_TIPO_DATA(29780,'146945-01'),
	T_TIPO_DATA(29970,'104157-03'),
	T_TIPO_DATA(30089,'147087-01'),
	T_TIPO_DATA(30143,'147137-01'),
	T_TIPO_DATA(30531,'146589-01'),
	T_TIPO_DATA(30572,'146978-01'),
	T_TIPO_DATA(30575,'147204-01'),
	T_TIPO_DATA(30613,'147314-01'),
	T_TIPO_DATA(30689,'104792-01'),
	T_TIPO_DATA(30717,'147154-01'),
	T_TIPO_DATA(31214,'147690-01'),
	T_TIPO_DATA(31243,'147703-01'),
	T_TIPO_DATA(31336,'147791-01'),
	T_TIPO_DATA(31465,'147836-01'),
	T_TIPO_DATA(31499,'147853-02'),
	T_TIPO_DATA(31500,'147853-02'),
	T_TIPO_DATA(31502,'147853-02'),
	T_TIPO_DATA(31504,'147853-02'),
	T_TIPO_DATA(31509,'108067-02'),
	T_TIPO_DATA(31616,'147906-01'),
	T_TIPO_DATA(31698,'U20012-01'),
	T_TIPO_DATA(32120,'U20125-01'),
	T_TIPO_DATA(34288,'C00821-01'),
	T_TIPO_DATA(34402,'C00974-01'),
	T_TIPO_DATA(34427,'C01002-01'),
	T_TIPO_DATA(36127,'C02821-01'),
	T_TIPO_DATA(37209,'C04122-01'),
	T_TIPO_DATA(39324,'C06554-01'),
	T_TIPO_DATA(39329,'C06563-01'),
	T_TIPO_DATA(39816,'C07117-01'),
	T_TIPO_DATA(40126,'C07474-01'),
	T_TIPO_DATA(40490,'C07873-01'),
	T_TIPO_DATA(40658,'C08067-01'),
	T_TIPO_DATA(41311,'C08804-01'),
	T_TIPO_DATA(41812,'C09394-01'),
	T_TIPO_DATA(43263,'C11074-01'),
	T_TIPO_DATA(44248,'C12322-01'),
	T_TIPO_DATA(46343,'H00627-01'),
	T_TIPO_DATA(46593,'H00887-01'),
	T_TIPO_DATA(46643,'H01026-01'),
	T_TIPO_DATA(46896,'H01422-01'),
	T_TIPO_DATA(47342,'H01927-01'),
	T_TIPO_DATA(47779,'H02529-01'),
	T_TIPO_DATA(48051,'H02805-01'),
	T_TIPO_DATA(48053,'H02805-01'),
	T_TIPO_DATA(48057,'H02805-01'),
	T_TIPO_DATA(48669,'H03695-01'),
	T_TIPO_DATA(48913,'H03949-01'),
	T_TIPO_DATA(49268,'H04469-01'),
	T_TIPO_DATA(49684,'H04711-01'),
	T_TIPO_DATA(49877,'H05037-01'),
	T_TIPO_DATA(50039,'H05192-01'),
	T_TIPO_DATA(50108,'H05358-01'),
	T_TIPO_DATA(50379,'H05875-01'),
	T_TIPO_DATA(50440,'H05960-01'),
	T_TIPO_DATA(50441,'H05960-01'),
	T_TIPO_DATA(50442,'H05960-01'),
	T_TIPO_DATA(50443,'H05960-01'),
	T_TIPO_DATA(50444,'H05960-01'),
	T_TIPO_DATA(50445,'H05960-01'),
	T_TIPO_DATA(50446,'H05960-01'),
	T_TIPO_DATA(50447,'H05960-01'),
	T_TIPO_DATA(50448,'H05960-01'),
	T_TIPO_DATA(50449,'H05960-01'),
	T_TIPO_DATA(50450,'H05960-01'),
	T_TIPO_DATA(50451,'H05960-01'),
	T_TIPO_DATA(50455,'H05960-01'),
	T_TIPO_DATA(50459,'H05960-01'),
	T_TIPO_DATA(50460,'H05960-01'),
	T_TIPO_DATA(50549,'H06099-01'),
	T_TIPO_DATA(50916,'H06550-01'),
	T_TIPO_DATA(51046,'H06748-01'),
	T_TIPO_DATA(51823,'H07856-01'),
	T_TIPO_DATA(51858,'H07875-01'),
	T_TIPO_DATA(51906,'H07906-01'),
	T_TIPO_DATA(51907,'H07906-01'),
	T_TIPO_DATA(52271,'H08422-01'),
	T_TIPO_DATA(52545,'H08892-01'),
	T_TIPO_DATA(52579,'H08966-01'),
	T_TIPO_DATA(52910,'H09492-01'),
	T_TIPO_DATA(52911,'H09492-01'),
	T_TIPO_DATA(52916,'H09492-01'),
	T_TIPO_DATA(52979,'H09593-01'),
	T_TIPO_DATA(52981,'H09598-01'),
	T_TIPO_DATA(53316,'H10423-01'),
	T_TIPO_DATA(53322,'H10434-01'),
	T_TIPO_DATA(53844,'H11574-01'),
	T_TIPO_DATA(54523,'H13689-02'),
	T_TIPO_DATA(54689,'H14108-01'),
	T_TIPO_DATA(54834,'H14628-01'),
	T_TIPO_DATA(55268,'H15511-01'),
	T_TIPO_DATA(55458,'H16430-01'),
	T_TIPO_DATA(56563,'U14001-01'),
	T_TIPO_DATA(63036,'P01758-01'),
	T_TIPO_DATA(64626,'P04389-01'),
	T_TIPO_DATA(64931,'P05005-01'),
	T_TIPO_DATA(73918,'Q77288-01'),
	T_TIPO_DATA(73919,'Q77288-01'),
	T_TIPO_DATA(75975,'100857-01'),
	T_TIPO_DATA(76246,'Q78810-01'),
	T_TIPO_DATA(80928,'Q80579-01'),
	T_TIPO_DATA(81129,'145433-06'),
	T_TIPO_DATA(81241,'Q80761-01'),
	T_TIPO_DATA(81463,'Q80925-01'),
	T_TIPO_DATA(81622,'Q80956-01'),
	T_TIPO_DATA(81802,'Q81121-01'),
	T_TIPO_DATA(82256,'Q81390-01'),
	T_TIPO_DATA(82500,'Q81518-01'),
	T_TIPO_DATA(82535,'Q81555-01'),
	T_TIPO_DATA(82828,'Q81638-01'),
	T_TIPO_DATA(84042,'Q82052-01'),
	T_TIPO_DATA(84050,'Q82056-01'),
	T_TIPO_DATA(84165,'Q82109-01'),
	T_TIPO_DATA(84374,'Q82225-01'),
	T_TIPO_DATA(84682,'Q82416-01'),
	T_TIPO_DATA(85029,'Q82553-01'),
	T_TIPO_DATA(85030,'Q82553-01'),
	T_TIPO_DATA(85031,'Q82553-01'),
	T_TIPO_DATA(85032,'Q82553-01'),
	T_TIPO_DATA(85033,'Q82553-01'),
	T_TIPO_DATA(85034,'Q82553-01'),
	T_TIPO_DATA(85035,'Q82553-01'),
	T_TIPO_DATA(85036,'Q82553-01'),
	T_TIPO_DATA(85037,'Q82553-01'),
	T_TIPO_DATA(85038,'Q82553-01'),
	T_TIPO_DATA(85039,'Q82553-01'),
	T_TIPO_DATA(85040,'Q82553-01'),
	T_TIPO_DATA(85041,'Q82553-01'),
	T_TIPO_DATA(85042,'Q82553-01'),
	T_TIPO_DATA(85043,'Q82553-01'),
	T_TIPO_DATA(85044,'Q82553-01'),
	T_TIPO_DATA(85045,'Q82553-01'),
	T_TIPO_DATA(85046,'Q82553-01'),
	T_TIPO_DATA(85047,'Q82553-01'),
	T_TIPO_DATA(85048,'Q82553-01'),
	T_TIPO_DATA(85049,'Q82553-01'),
	T_TIPO_DATA(85050,'Q82553-01'),
	T_TIPO_DATA(85051,'Q82553-01'),
	T_TIPO_DATA(85052,'Q82553-01'),
	T_TIPO_DATA(85053,'Q82553-01'),
	T_TIPO_DATA(85054,'Q82553-01'),
	T_TIPO_DATA(85055,'Q82553-01'),
	T_TIPO_DATA(85056,'Q82553-01'),
	T_TIPO_DATA(85057,'Q82553-01'),
	T_TIPO_DATA(85058,'Q82553-01'),
	T_TIPO_DATA(85059,'Q82553-01'),
	T_TIPO_DATA(85060,'Q82553-01'),
	T_TIPO_DATA(85061,'Q82553-01'),
	T_TIPO_DATA(85062,'Q82553-01'),
	T_TIPO_DATA(85063,'Q82553-01'),
	T_TIPO_DATA(85064,'Q82553-01'),
	T_TIPO_DATA(85065,'Q82553-01'),
	T_TIPO_DATA(85066,'Q82553-01'),
	T_TIPO_DATA(85067,'Q82553-01'),
	T_TIPO_DATA(85068,'Q82553-01'),
	T_TIPO_DATA(85069,'Q82553-01'),
	T_TIPO_DATA(85070,'Q82553-01'),
	T_TIPO_DATA(85071,'Q82553-01'),
	T_TIPO_DATA(85072,'Q82553-01'),
	T_TIPO_DATA(85073,'Q82553-01'),
	T_TIPO_DATA(85074,'Q82553-01'),
	T_TIPO_DATA(85075,'Q82553-01'),
	T_TIPO_DATA(85076,'Q82553-01'),
	T_TIPO_DATA(85077,'Q82553-01'),
	T_TIPO_DATA(85078,'Q82553-01'),
	T_TIPO_DATA(85079,'Q82553-01'),
	T_TIPO_DATA(85080,'Q82553-01'),
	T_TIPO_DATA(85081,'Q82553-01'),
	T_TIPO_DATA(85082,'Q82553-01'),
	T_TIPO_DATA(85083,'Q82553-01'),
	T_TIPO_DATA(85084,'Q82553-01'),
	T_TIPO_DATA(85085,'Q82553-01'),
	T_TIPO_DATA(85086,'Q82553-01'),
	T_TIPO_DATA(85087,'Q82553-01'),
	T_TIPO_DATA(85088,'Q82553-01'),
	T_TIPO_DATA(85089,'Q82553-01'),
	T_TIPO_DATA(85090,'Q82553-01'),
	T_TIPO_DATA(85091,'Q82553-01'),
	T_TIPO_DATA(85092,'Q82553-01'),
	T_TIPO_DATA(85093,'Q82553-01'),
	T_TIPO_DATA(85094,'Q82553-01'),
	T_TIPO_DATA(85095,'Q82553-01'),
	T_TIPO_DATA(85096,'Q82553-01'),
	T_TIPO_DATA(85097,'Q82553-01'),
	T_TIPO_DATA(85098,'Q82553-01'),
	T_TIPO_DATA(85099,'Q82553-01'),
	T_TIPO_DATA(85100,'Q82553-01'),
	T_TIPO_DATA(85101,'Q82553-01'),
	T_TIPO_DATA(85102,'Q82553-01'),
	T_TIPO_DATA(85103,'Q82553-01'),
	T_TIPO_DATA(85104,'Q82553-01'),
	T_TIPO_DATA(85105,'Q82553-01'),
	T_TIPO_DATA(85106,'Q82553-01'),
	T_TIPO_DATA(85107,'Q82553-01'),
	T_TIPO_DATA(85108,'Q82553-01'),
	T_TIPO_DATA(85109,'Q82553-01'),
	T_TIPO_DATA(85110,'Q82553-01'),
	T_TIPO_DATA(85111,'Q82553-01'),
	T_TIPO_DATA(85112,'Q82553-01'),
	T_TIPO_DATA(85113,'Q82553-01'),
	T_TIPO_DATA(85114,'Q82553-01'),
	T_TIPO_DATA(85115,'Q82553-01'),
	T_TIPO_DATA(85116,'Q82553-01'),
	T_TIPO_DATA(85117,'Q82553-01'),
	T_TIPO_DATA(85118,'Q82553-01'),
	T_TIPO_DATA(85119,'Q82553-01'),
	T_TIPO_DATA(85158,'R00001-01'),
	T_TIPO_DATA(85159,'H15145-01'),
	T_TIPO_DATA(85238,'H18061-01'),
	T_TIPO_DATA(85258,'H16287-01'),
	T_TIPO_DATA(85298,'H15954-01'),
	T_TIPO_DATA(85320,'H18359-01'),
	T_TIPO_DATA(85359,'H17049-01'),
	T_TIPO_DATA(85361,'H17098-01'),
	T_TIPO_DATA(85378,'H13081-01'),
	T_TIPO_DATA(85382,'H08855-01')); 
    V_TMP_TIPO_DATA T_TIPO_DATA;

BEGIN	

	DBMS_OUTPUT.PUT_LINE('[INICIO]');

	DBMS_OUTPUT.PUT_LINE('[INFO]: INFORMAR BBVA_COD_PROMOCION EN '||V_TEXT_TABLA);
	FOR I IN V_TIPO_DATA.FIRST .. V_TIPO_DATA.LAST
	LOOP
		V_TMP_TIPO_DATA := V_TIPO_DATA(I);

		V_MSQL:='SELECT COUNT(1) FROM '||V_ESQUEMA||'.'||V_TEXT_TABLA||' WHERE BBVA_ID = '||V_TMP_TIPO_DATA(1)||' AND BORRADO = 0';
		EXECUTE IMMEDIATE V_MSQL INTO V_COUNT;

		IF V_COUNT = 1 THEN

			V_MSQL:='SELECT COUNT(1) FROM '||V_ESQUEMA||'.'||V_TEXT_TABLA||' WHERE BBVA_ID = '||V_TMP_TIPO_DATA(1)||' AND BBVA_COD_PROMOCION = '''||V_TMP_TIPO_DATA(2)||'''';
			EXECUTE IMMEDIATE V_MSQL INTO V_COUNT;

			IF V_COUNT = 1 THEN

				V_MSQL := 'UPDATE '||V_ESQUEMA||'.'||V_TEXT_TABLA||' SET
				BBVA_COD_PROMOCION = '''||V_TMP_TIPO_DATA(2)||''',
				USUARIOMODIFICAR = '''||V_USU||''',
				FECHAMODIFICAR = SYSDATE
				WHERE BBVA_ID = '||V_TMP_TIPO_DATA(1)||'';
				EXECUTE IMMEDIATE V_MSQL;

				DBMS_OUTPUT.PUT_LINE('[INFO]: INFORMADO EL CODIGO PROMOCION BBVA PARA EL ACTIVO CON BBVA_ID '''||V_TMP_TIPO_DATA(1)||'''');

			ELSE

			DBMS_OUTPUT.PUT_LINE('[INFO]: EL ACTIVO CON BBVA_ID '''||V_TMP_TIPO_DATA(1)||''' YA TIENE INFORMADO EL CODIGO PROMOCION BBVA '''||V_TMP_TIPO_DATA(2)||'''');

			END IF;
		
		ELSE

			DBMS_OUTPUT.PUT_LINE('[INFO]: EL ACTIVO CON BBVA_ID '''||V_TMP_TIPO_DATA(1)||''' NO EXISTE O ESTA BORRADO');

		END IF;

	END LOOP;

	COMMIT;

	DBMS_OUTPUT.PUT_LINE('[FIN]');


EXCEPTION
		WHEN OTHERS THEN
			err_num := SQLCODE;
			err_msg := SQLERRM;

			DBMS_OUTPUT.put_line('[ERROR] Se ha producido un error en la ejecuci√≥n:'||TO_CHAR(err_num));
			DBMS_OUTPUT.put_line('-----------------------------------------------------------'); 
			DBMS_OUTPUT.put_line(err_msg);

			ROLLBACK;
			RAISE;          

END;

/

EXIT