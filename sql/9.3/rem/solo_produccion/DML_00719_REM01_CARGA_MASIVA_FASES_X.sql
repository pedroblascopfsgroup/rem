--/*
--##########################################
--## AUTOR=Carlos Santos Vílchez
--## FECHA_CREACION=20210303
--## ARTEFACTO=online
--## VERSION_ARTEFACTO=9.3
--## INCIDENCIA_LINK=REMVIP-9050
--## PRODUCTO=NO
--##
--## Finalidad: Script realiza una carga masiva de fases
--## INSTRUCCIONES:
--## VERSIONES:
--##        0.1 Versión inicial
--##########################################
--*/

WHENEVER SQLERROR EXIT SQL.SQLCODE;
SET SERVEROUTPUT ON; 
SET DEFINE OFF;


DECLARE

    V_MSQL VARCHAR2(32000 CHAR); -- Sentencia a ejecutar.
    V_ESQUEMA VARCHAR2(25 CHAR):= '#ESQUEMA#'; -- Configuracion Esquema.
    V_ESQUEMA_M VARCHAR2(25 CHAR):= '#ESQUEMA_MASTER#'; -- Configuracion Esquema Master.
    V_SQL VARCHAR2(4000 CHAR); -- Vble. para consulta que valida la existencia de una tabla.
    V_NUM_TABLAS NUMBER(16); -- Vble. para validar la existencia de una tabla.
    ERR_NUM NUMBER(25);  -- Vble. auxiliar para registrar errores en el script.
    ERR_MSG VARCHAR2(1024 CHAR); -- Vble. auxiliar para registrar errores en el script.
    V_NUM_SEQUENCE NUMBER(16); -- Vble. auxiliar para almacenar el número de secuencia actual.
    V_NUM NUMBER(16); -- Vble. auxiliar para almacenar el número de registros
    V_COUNT_INSERT NUMBER(16):= 0; -- Vble. para contar inserts
    V_TEXT_TABLA VARCHAR2(27 CHAR) := 'ACT_HFP_HIST_FASES_PUB'; -- Vble. auxiliar para almacenar el nombre de la tabla de ref.
    V_USU VARCHAR2(30 CHAR) := 'REMVIP-9050'; -- Vble. auxiliar para almacenar el nombre de usuario que modifica los registros.
	V_ACT_ID NUMBER(16);
	V_USU_ID NUMBER(16);
	V_COUNT NUMBER(16);

    TYPE T_TIPO_DATA IS TABLE OF VARCHAR2(1024);
    TYPE T_ARRAY_DATA IS TABLE OF T_TIPO_DATA;

    V_TIPO_DATA T_ARRAY_DATA := T_ARRAY_DATA(
    --	ACTIVO | FASE | SUBFASE | COMENTARIO
	T_TIPO_DATA('7040386','10','19','Calidad comprobada'),
	T_TIPO_DATA('7040387','10','19','Calidad comprobada'),
	T_TIPO_DATA('7040388','10','19','Calidad comprobada'),
	T_TIPO_DATA('7040389','10','19','Calidad comprobada'),
	T_TIPO_DATA('7040390','10','19','Calidad comprobada'),
	T_TIPO_DATA('7040391','10','19','Calidad comprobada'),
	T_TIPO_DATA('7040392','10','19','Calidad comprobada'),
	T_TIPO_DATA('7040393','10','19','Calidad comprobada'),
	T_TIPO_DATA('7040394','10','19','Calidad comprobada'),
	T_TIPO_DATA('7040395','10','19','Calidad comprobada'),
	T_TIPO_DATA('7040396','10','19','Calidad comprobada'),
	T_TIPO_DATA('7040397','10','19','Calidad comprobada'),
	T_TIPO_DATA('7040398','10','19','Calidad comprobada'),
	T_TIPO_DATA('7040399','10','19','Calidad comprobada'),
	T_TIPO_DATA('7040400','10','19','Calidad comprobada'),
	T_TIPO_DATA('7040401','10','19','Calidad comprobada'),
	T_TIPO_DATA('7040402','10','19','Calidad comprobada'),
	T_TIPO_DATA('7040403','10','19','Calidad comprobada'),
	T_TIPO_DATA('7040404','10','19','Calidad comprobada'),
	T_TIPO_DATA('7040405','10','19','Calidad comprobada'),
	T_TIPO_DATA('7040406','10','19','Calidad comprobada'),
	T_TIPO_DATA('7040407','10','19','Calidad comprobada'),
	T_TIPO_DATA('7040408','10','19','Calidad comprobada'),
	T_TIPO_DATA('7040409','10','19','Calidad comprobada'),
	T_TIPO_DATA('7040410','10','19','Calidad comprobada'),
	T_TIPO_DATA('7040411','10','19','Calidad comprobada'),
	T_TIPO_DATA('7040412','10','19','Calidad comprobada'),
	T_TIPO_DATA('7040413','10','19','Calidad comprobada'),
	T_TIPO_DATA('7040414','10','19','Calidad comprobada'),
	T_TIPO_DATA('7040415','10','19','Calidad comprobada'),
	T_TIPO_DATA('7040416','10','19','Calidad comprobada'),
	T_TIPO_DATA('7040417','10','19','Calidad comprobada'),
	T_TIPO_DATA('7040418','10','19','Calidad comprobada'),
	T_TIPO_DATA('7040419','10','19','Calidad comprobada'),
	T_TIPO_DATA('7050095','10','19','Calidad comprobada'),
	T_TIPO_DATA('7056737','10','19','Calidad comprobada'),
	T_TIPO_DATA('7056738','10','19','Calidad comprobada'),
	T_TIPO_DATA('7056741','10','19','Calidad comprobada'),
	T_TIPO_DATA('7056744','10','19','Calidad comprobada'),
	T_TIPO_DATA('7056745','10','19','Calidad comprobada'),
	T_TIPO_DATA('7056746','10','19','Calidad comprobada'),
	T_TIPO_DATA('7056747','10','19','Calidad comprobada'),
	T_TIPO_DATA('7056748','10','19','Calidad comprobada'),
	T_TIPO_DATA('7056749','10','19','Calidad comprobada'),
	T_TIPO_DATA('7056750','10','19','Calidad comprobada'),
	T_TIPO_DATA('7056751','10','19','Calidad comprobada'),
	T_TIPO_DATA('7056752','10','19','Calidad comprobada'),
	T_TIPO_DATA('7056753','10','19','Calidad comprobada'),
	T_TIPO_DATA('7056758','10','19','Calidad comprobada'),
	T_TIPO_DATA('7056761','10','19','Calidad comprobada'),
	T_TIPO_DATA('7056762','10','19','Calidad comprobada'),
	T_TIPO_DATA('7056763','10','19','Calidad comprobada'),
	T_TIPO_DATA('7056765','10','19','Calidad comprobada'),
	T_TIPO_DATA('7056766','10','19','Calidad comprobada'),
	T_TIPO_DATA('7056767','10','19','Calidad comprobada'),
	T_TIPO_DATA('7056768','10','19','Calidad comprobada'),
	T_TIPO_DATA('7056769','10','19','Calidad comprobada'),
	T_TIPO_DATA('7056770','10','19','Calidad comprobada'),
	T_TIPO_DATA('7056771','10','19','Calidad comprobada'),
	T_TIPO_DATA('7056772','10','19','Calidad comprobada'),
	T_TIPO_DATA('7242753','10','19','Calidad comprobada'),
	T_TIPO_DATA('7262915','10','19','Calidad comprobada'),
	T_TIPO_DATA('7270044','10','19','Calidad comprobada'),
	T_TIPO_DATA('7271158','10','19','Calidad comprobada'),
	T_TIPO_DATA('7271159','10','19','Calidad comprobada'),
	T_TIPO_DATA('7271160','10','19','Calidad comprobada'),
	T_TIPO_DATA('7271161','10','19','Calidad comprobada'),
	T_TIPO_DATA('7271162','10','19','Calidad comprobada'),
	T_TIPO_DATA('7271163','10','19','Calidad comprobada'),
	T_TIPO_DATA('7271164','10','19','Calidad comprobada'),
	T_TIPO_DATA('7271165','10','19','Calidad comprobada'),
	T_TIPO_DATA('7271166','10','19','Calidad comprobada'),
	T_TIPO_DATA('7271167','10','19','Calidad comprobada'),
	T_TIPO_DATA('7028006','10','19','Calidad comprobada'),
	T_TIPO_DATA('7028007','10','19','Calidad comprobada'),
	T_TIPO_DATA('7028028','10','19','Calidad comprobada'),
	T_TIPO_DATA('7028014','10','19','Calidad comprobada'),
	T_TIPO_DATA('7028010','10','19','Calidad comprobada'),
	T_TIPO_DATA('7028012','10','19','Calidad comprobada'),
	T_TIPO_DATA('7028011','10','19','Calidad comprobada'),
	T_TIPO_DATA('7028015','10','19','Calidad comprobada'),
	T_TIPO_DATA('7028018','10','19','Calidad comprobada'),
	T_TIPO_DATA('7028019','10','19','Calidad comprobada'),
	T_TIPO_DATA('7028005','10','19','Calidad comprobada'),
	T_TIPO_DATA('7028027','10','19','Calidad comprobada'),
	T_TIPO_DATA('7028023','10','19','Calidad comprobada'),
	T_TIPO_DATA('7267602','09','14','ORDEN CES'),
	T_TIPO_DATA('7267624','09','14','ORDEN CES'),
	T_TIPO_DATA('7267625','09','14','ORDEN CES'),
	T_TIPO_DATA('7267626','09','14','ORDEN CES'),
	T_TIPO_DATA('7267638','09','14','ORDEN CES'),
	T_TIPO_DATA('7267646','09','14','ORDEN CES'),
	T_TIPO_DATA('7267579','09','14','ORDEN CES'),
	T_TIPO_DATA('7267580','09','14','ORDEN CES'),
	T_TIPO_DATA('7267581','09','14','ORDEN CES'),
	T_TIPO_DATA('7267582','09','14','ORDEN CES'),
	T_TIPO_DATA('7267583','09','14','ORDEN CES'),
	T_TIPO_DATA('7267584','09','14','ORDEN CES'),
	T_TIPO_DATA('7267585','09','14','ORDEN CES'),
	T_TIPO_DATA('7267586','09','14','ORDEN CES'),
	T_TIPO_DATA('7267627','09','14','ORDEN CES'),
	T_TIPO_DATA('7267593','09','14','ORDEN CES'),
	T_TIPO_DATA('7267594','09','14','ORDEN CES'),
	T_TIPO_DATA('7266967','09','16','Con oferta, orden SONIA PEREZ'),
	T_TIPO_DATA('7266968','09','16','Con oferta, orden SONIA PEREZ'),
	T_TIPO_DATA('7266976','09','16','Con oferta, orden SONIA PEREZ'),
	T_TIPO_DATA('7266978','09','16','Con oferta, orden SONIA PEREZ'),
	T_TIPO_DATA('7266972','09','16','Con oferta, orden SONIA PEREZ'),
	T_TIPO_DATA('7266973','09','16','Con oferta, orden SONIA PEREZ'),
	T_TIPO_DATA('7266980','09','16','Con oferta, orden SONIA PEREZ'),
	T_TIPO_DATA('7266971','09','16','Con oferta, orden SONIA PEREZ'),
	T_TIPO_DATA('7266975','09','16','Con oferta, orden SONIA PEREZ'),
	T_TIPO_DATA('7266970','09','16','Con oferta, orden SONIA PEREZ'),
	T_TIPO_DATA('7266977','09','16','Con oferta, orden SONIA PEREZ'),
	T_TIPO_DATA('7266979','09','16','Con oferta, orden SONIA PEREZ'),
	T_TIPO_DATA('7266969','09','16','Con oferta, orden SONIA PEREZ'),
	T_TIPO_DATA('7266974','09','16','Con oferta, orden SONIA PEREZ'),
	T_TIPO_DATA('7322231','10','19','Equipo de calidad'),
	T_TIPO_DATA('7322232','10','19','Equipo de calidad'),
	T_TIPO_DATA('7322233','10','19','Equipo de calidad'),
	T_TIPO_DATA('7322234','10','19','Equipo de calidad'),
	T_TIPO_DATA('7322235','10','19','Equipo de calidad'),
	T_TIPO_DATA('7322236','10','19','Equipo de calidad'),
	T_TIPO_DATA('7322237','10','19','Equipo de calidad'),
	T_TIPO_DATA('7322238','10','19','Equipo de calidad'),
	T_TIPO_DATA('7322239','10','19','Equipo de calidad'),
	T_TIPO_DATA('7322240','10','19','Equipo de calidad'),
	T_TIPO_DATA('7322241','10','19','Equipo de calidad'),
	T_TIPO_DATA('7322242','10','19','Equipo de calidad'),
	T_TIPO_DATA('7322243','10','19','Equipo de calidad'),
	T_TIPO_DATA('7322244','10','19','Equipo de calidad'),
	T_TIPO_DATA('7322245','10','19','Equipo de calidad'),
	T_TIPO_DATA('7322246','10','19','Equipo de calidad'),
	T_TIPO_DATA('7322247','10','19','Equipo de calidad'),
	T_TIPO_DATA('7322248','10','19','Equipo de calidad'),
	T_TIPO_DATA('7322249','10','19','Equipo de calidad'),
	T_TIPO_DATA('7322250','10','19','Equipo de calidad'),
	T_TIPO_DATA('7322251','10','19','Equipo de calidad'),
	T_TIPO_DATA('7322252','10','19','Equipo de calidad'),
	T_TIPO_DATA('7322253','10','19','Equipo de calidad'),
	T_TIPO_DATA('7322254','10','19','Equipo de calidad'),
	T_TIPO_DATA('7322255','10','19','Equipo de calidad'),
	T_TIPO_DATA('7322256','10','19','Equipo de calidad'),
	T_TIPO_DATA('7322257','10','19','Equipo de calidad'),
	T_TIPO_DATA('7322258','10','19','Equipo de calidad'),
	T_TIPO_DATA('7322259','10','19','Equipo de calidad'),
	T_TIPO_DATA('7322260','10','19','Equipo de calidad'),
	T_TIPO_DATA('7322261','10','19','Equipo de calidad'),
	T_TIPO_DATA('7322262','10','19','Equipo de calidad'),
	T_TIPO_DATA('7322263','10','19','Equipo de calidad'),
	T_TIPO_DATA('7322264','10','19','Equipo de calidad'),
	T_TIPO_DATA('7322265','10','19','Equipo de calidad'),
	T_TIPO_DATA('7322266','10','19','Equipo de calidad'),
	T_TIPO_DATA('7322267','10','19','Equipo de calidad'),
	T_TIPO_DATA('7322268','10','19','Equipo de calidad'),
	T_TIPO_DATA('7322269','10','19','Equipo de calidad'),
	T_TIPO_DATA('7322270','10','19','Equipo de calidad'),
	T_TIPO_DATA('7322271','10','19','Equipo de calidad'),
	T_TIPO_DATA('7322272','10','19','Equipo de calidad'),
	T_TIPO_DATA('7322273','10','19','Equipo de calidad'),
	T_TIPO_DATA('7322274','10','19','Equipo de calidad'),
	T_TIPO_DATA('7322275','10','19','Equipo de calidad'),
	T_TIPO_DATA('7322276','10','19','Equipo de calidad'),
	T_TIPO_DATA('7322277','10','19','Equipo de calidad'),
	T_TIPO_DATA('7322278','10','19','Equipo de calidad'),
	T_TIPO_DATA('7322279','10','19','Equipo de calidad'),
	T_TIPO_DATA('7322280','10','19','Equipo de calidad'),
	T_TIPO_DATA('7322281','10','19','Equipo de calidad'),
	T_TIPO_DATA('7322282','10','19','Equipo de calidad'),
	T_TIPO_DATA('7322283','10','19','Equipo de calidad'),
	T_TIPO_DATA('7322284','10','19','Equipo de calidad'),
	T_TIPO_DATA('7322285','10','19','Equipo de calidad'),
	T_TIPO_DATA('7322286','10','19','Equipo de calidad'),
	T_TIPO_DATA('7322287','10','19','Equipo de calidad'),
	T_TIPO_DATA('7322288','10','19','Equipo de calidad'),
	T_TIPO_DATA('7322289','10','19','Equipo de calidad'),
	T_TIPO_DATA('7322290','10','19','Equipo de calidad'),
	T_TIPO_DATA('7322291','10','19','Equipo de calidad'),
	T_TIPO_DATA('7322292','10','19','Equipo de calidad'),
	T_TIPO_DATA('7322293','10','19','Equipo de calidad'),
	T_TIPO_DATA('7322294','10','19','Equipo de calidad'),
	T_TIPO_DATA('7322295','10','19','Equipo de calidad'),
	T_TIPO_DATA('7322296','10','19','Equipo de calidad'),
	T_TIPO_DATA('7322297','10','19','Equipo de calidad'),
	T_TIPO_DATA('7322298','10','19','Equipo de calidad'),
	T_TIPO_DATA('7322299','10','19','Equipo de calidad'),
	T_TIPO_DATA('7322300','10','19','Equipo de calidad'),
	T_TIPO_DATA('7322301','10','19','Equipo de calidad'),
	T_TIPO_DATA('7322302','10','19','Equipo de calidad'),
	T_TIPO_DATA('7322303','10','19','Equipo de calidad'),
	T_TIPO_DATA('7322304','10','19','Equipo de calidad'),
	T_TIPO_DATA('7322305','10','19','Equipo de calidad'),
	T_TIPO_DATA('7322306','10','19','Equipo de calidad'),
	T_TIPO_DATA('7322307','10','19','Equipo de calidad'),
	T_TIPO_DATA('7322308','10','19','Equipo de calidad'),
	T_TIPO_DATA('7322309','10','19','Equipo de calidad'),
	T_TIPO_DATA('7322310','10','19','Equipo de calidad'),
	T_TIPO_DATA('7322311','10','19','Equipo de calidad'),
	T_TIPO_DATA('7322312','10','19','Equipo de calidad'),
	T_TIPO_DATA('7322313','10','19','Equipo de calidad'),
	T_TIPO_DATA('7322314','10','19','Equipo de calidad'),
	T_TIPO_DATA('7322315','10','19','Equipo de calidad'),
	T_TIPO_DATA('7322316','10','19','Equipo de calidad'),
	T_TIPO_DATA('7322317','10','19','Equipo de calidad'),
	T_TIPO_DATA('7322318','10','19','Equipo de calidad'),
	T_TIPO_DATA('7322319','10','19','Equipo de calidad'),
	T_TIPO_DATA('7322320','10','19','Equipo de calidad'),
	T_TIPO_DATA('7322321','10','19','Equipo de calidad'),
	T_TIPO_DATA('7322322','10','19','Equipo de calidad'),
	T_TIPO_DATA('7322323','10','19','Equipo de calidad'),
	T_TIPO_DATA('7322324','10','19','Equipo de calidad'),
	T_TIPO_DATA('7322325','10','19','Equipo de calidad'),
	T_TIPO_DATA('7322326','10','19','Equipo de calidad'),
	T_TIPO_DATA('7322327','10','19','Equipo de calidad'),
	T_TIPO_DATA('7322328','10','19','Equipo de calidad'),
	T_TIPO_DATA('7322329','10','19','Equipo de calidad'),
	T_TIPO_DATA('7322330','10','19','Equipo de calidad'),
	T_TIPO_DATA('7322331','10','19','Equipo de calidad'),
	T_TIPO_DATA('7322332','10','19','Equipo de calidad'),
	T_TIPO_DATA('7322333','10','19','Equipo de calidad'),
	T_TIPO_DATA('7322334','10','19','Equipo de calidad'),
	T_TIPO_DATA('948365','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('126482','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('126131','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('125794','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('122005','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('121798','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('121499','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('121069','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('104381','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('104294','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('104231','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('104229','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('104021','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('6937737','09','18','Vinculado a inmueble no publicable matriz o sin información en premin'),
	T_TIPO_DATA('6744926','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('6744924','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('6744923','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('6744921','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('6744920','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('6744917','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('6744916','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('6744915','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('6744914','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('6744912','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('6744911','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('6744909','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('6346009','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('200194','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('200192','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('186638','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('186590','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('186396','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('184128','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('183458','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('183457','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('182532','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('181455','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('164322','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('160120','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('159791','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('158767','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('150178','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('150132','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('149468','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('146977','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('146949','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('146948','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('146883','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('146882','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('146489','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('144679','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('142393','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('142342','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('138310','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('137820','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('137721','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('137720','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('135462','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('135102','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('133595','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('133594','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('133148','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('133147','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('132867','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('95748','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('95061','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('85588','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('84364','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('78357','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('64595','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('63396','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('952128','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('951961','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('939682','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('937909','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('197578','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('197087','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('197086','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('197084','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('193009','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('189178','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('187102','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('186313','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('185807','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('182486','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('180883','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('177924','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('176206','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('175986','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('168435','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('167975','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('167830','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('161810','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('161809','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('161721','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('154574','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('153762','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('150579','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('148076','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('145224','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('145020','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('140214','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('139766','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('139642','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('139535','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('135260','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('134900','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('134822','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('134821','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('132213','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('131258','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('128602','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('123737','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('122870','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('116909','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('116792','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('116791','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('113487','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('113486','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('113289','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('113287','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('113206','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('113149','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('113145','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('112938','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('112375','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('111747','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('110339','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('110166','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('107665','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('107223','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('107222','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('107120','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('107119','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('107058','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('107057','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('107056','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('103515','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('100350','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('99185','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('95245','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('92957','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('90266','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('90046','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('84799','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('84087','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('82276','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('74227','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('72226','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('70148','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('64775','09','14','No cumple matriz o sin información en premin'),
	T_TIPO_DATA('163669','08','10','Sin precio o sin información en premin'),
	T_TIPO_DATA('165407','08','10','Sin precio o sin información en premin'),
	T_TIPO_DATA('165408','08','10','Sin precio o sin información en premin'),
	T_TIPO_DATA('6745613','08','10','Sin precio o sin información en premin'),
	T_TIPO_DATA('6745615','08','10','Sin precio o sin información en premin'),
	T_TIPO_DATA('6745626','08','10','Sin precio o sin información en premin'),
	T_TIPO_DATA('6745634','08','10','Sin precio o sin información en premin'),
	T_TIPO_DATA('6745635','08','10','Sin precio o sin información en premin'),
	T_TIPO_DATA('6745644','08','10','Sin precio o sin información en premin'),
	T_TIPO_DATA('6745645','08','10','Sin precio o sin información en premin'),
	T_TIPO_DATA('6745662','08','10','Sin precio o sin información en premin'),
	T_TIPO_DATA('176770','10','19','Profesional Definitivo'),
	T_TIPO_DATA('6745629','10','19','Profesional Terciario'),
	T_TIPO_DATA('6745647','10','19','Profesional Terciario'),
	T_TIPO_DATA('6745659','10','19','Profesional Terciario'),
	T_TIPO_DATA('72941','10','19','Sin precio o sin información en premin'),
	T_TIPO_DATA('104552','10','19','Sin precio o sin información en premin'),
	T_TIPO_DATA('104771','10','19','Sin precio o sin información en premin'),
	T_TIPO_DATA('113644','10','19','Sin precio o sin información en premin'),
	T_TIPO_DATA('113955','10','19','Sin precio o sin información en premin'),
	T_TIPO_DATA('114659','10','19','Sin precio o sin información en premin'),
	T_TIPO_DATA('115019','10','19','Sin precio o sin información en premin'),
	T_TIPO_DATA('118765','10','19','Sin precio o sin información en premin'),
	T_TIPO_DATA('119078','10','19','Sin precio o sin información en premin'),
	T_TIPO_DATA('119394','10','19','Sin precio o sin información en premin'),
	T_TIPO_DATA('120473','10','19','Sin precio o sin información en premin'),
	T_TIPO_DATA('128996','10','19','Sin precio o sin información en premin'),
	T_TIPO_DATA('132594','10','19','Sin precio o sin información en premin'),
	T_TIPO_DATA('132655','10','19','Sin precio o sin información en premin'),
	T_TIPO_DATA('132720','10','19','Sin precio o sin información en premin'),
	T_TIPO_DATA('132819','10','19','Sin precio o sin información en premin'),
	T_TIPO_DATA('132926','10','19','Sin precio o sin información en premin'),
	T_TIPO_DATA('132929','10','19','Sin precio o sin información en premin'),
	T_TIPO_DATA('132930','10','19','Sin precio o sin información en premin'),
	T_TIPO_DATA('132931','10','19','Sin precio o sin información en premin'),
	T_TIPO_DATA('133208','10','19','Sin precio o sin información en premin'),
	T_TIPO_DATA('133319','10','19','Sin precio o sin información en premin'),
	T_TIPO_DATA('133626','10','19','Sin precio o sin información en premin'),
	T_TIPO_DATA('138783','10','19','Sin precio o sin información en premin'),
	T_TIPO_DATA('138784','10','19','Sin precio o sin información en premin'),
	T_TIPO_DATA('138785','10','19','Sin precio o sin información en premin'),
	T_TIPO_DATA('138786','10','19','Sin precio o sin información en premin'),
	T_TIPO_DATA('138949','10','19','Sin precio o sin información en premin'),
	T_TIPO_DATA('139023','10','19','Sin precio o sin información en premin'),
	T_TIPO_DATA('139024','10','19','Sin precio o sin información en premin'),
	T_TIPO_DATA('142271','10','19','Sin precio o sin información en premin'),
	T_TIPO_DATA('144620','10','19','Sin precio o sin información en premin'),
	T_TIPO_DATA('144842','10','19','Sin precio o sin información en premin'),
	T_TIPO_DATA('144843','10','19','Sin precio o sin información en premin'),
	T_TIPO_DATA('144978','10','19','Sin precio o sin información en premin'),
	T_TIPO_DATA('144979','10','19','Sin precio o sin información en premin'),
	T_TIPO_DATA('145301','10','19','Sin precio o sin información en premin'),
	T_TIPO_DATA('145535','10','19','Sin precio o sin información en premin'),
	T_TIPO_DATA('145897','10','19','Sin precio o sin información en premin'),
	T_TIPO_DATA('146281','10','19','Sin precio o sin información en premin'),
	T_TIPO_DATA('146513','10','19','Sin precio o sin información en premin'),
	T_TIPO_DATA('147927','10','19','Sin precio o sin información en premin'),
	T_TIPO_DATA('147929','10','19','Sin precio o sin información en premin'),
	T_TIPO_DATA('148273','10','19','Sin precio o sin información en premin'),
	T_TIPO_DATA('154712','10','19','Sin precio o sin información en premin'),
	T_TIPO_DATA('154713','10','19','Sin precio o sin información en premin'),
	T_TIPO_DATA('156277','10','19','Sin precio o sin información en premin'),
	T_TIPO_DATA('156454','10','19','Sin precio o sin información en premin'),
	T_TIPO_DATA('156510','10','19','Sin precio o sin información en premin'),
	T_TIPO_DATA('156536','10','19','Sin precio o sin información en premin'),
	T_TIPO_DATA('156811','10','19','Sin precio o sin información en premin'),
	T_TIPO_DATA('163639','10','19','Sin precio o sin información en premin'),
	T_TIPO_DATA('164087','10','19','Sin precio o sin información en premin'),
	T_TIPO_DATA('168395','10','19','Sin precio o sin información en premin'),
	T_TIPO_DATA('168396','10','19','Sin precio o sin información en premin'),
	T_TIPO_DATA('175399','10','19','Sin precio o sin información en premin'),
	T_TIPO_DATA('175988','10','19','Sin precio o sin información en premin'),
	T_TIPO_DATA('176300','10','19','Sin precio o sin información en premin'),
	T_TIPO_DATA('185374','10','19','Sin precio o sin información en premin'),
	T_TIPO_DATA('185375','10','19','Sin precio o sin información en premin'),
	T_TIPO_DATA('185721','10','19','Sin precio o sin información en premin'),
	T_TIPO_DATA('186265','10','19','Sin precio o sin información en premin'),
	T_TIPO_DATA('186523','10','19','Sin precio o sin información en premin'),
	T_TIPO_DATA('186848','10','19','Sin precio o sin información en premin'),
	T_TIPO_DATA('187481','10','19','Sin precio o sin información en premin'),
	T_TIPO_DATA('188678','10','19','Sin precio o sin información en premin'),
	T_TIPO_DATA('188941','10','19','Sin precio o sin información en premin'),
	T_TIPO_DATA('197591','10','19','Sin precio o sin información en premin'),
	T_TIPO_DATA('6132973','10','19','Sin precio o sin información en premin'),
	T_TIPO_DATA('6752890','10','19','Sin precio o sin información en premin'),
	T_TIPO_DATA('63404','10','19','Sin precio o sin información en premin'),
	T_TIPO_DATA('64602','10','19','Sin precio o sin información en premin'),
	T_TIPO_DATA('64767','10','19','Sin precio o sin información en premin'),
	T_TIPO_DATA('65348','10','19','Sin precio o sin información en premin'),
	T_TIPO_DATA('72792','10','19','Sin precio o sin información en premin'),
	T_TIPO_DATA('99255','10','19','Sin precio o sin información en premin'),
	T_TIPO_DATA('106134','10','19','Sin precio o sin información en premin'),
	T_TIPO_DATA('118295','10','19','Sin precio o sin información en premin'),
	T_TIPO_DATA('136406','10','19','Sin precio o sin información en premin'),
	T_TIPO_DATA('136407','10','19','Sin precio o sin información en premin'),
	T_TIPO_DATA('136529','10','19','Sin precio o sin información en premin'),
	T_TIPO_DATA('136659','10','19','Sin precio o sin información en premin'),
	T_TIPO_DATA('141366','10','19','Sin precio o sin información en premin'),
	T_TIPO_DATA('142382','10','19','Sin precio o sin información en premin'),
	T_TIPO_DATA('142509','10','19','Sin precio o sin información en premin'),
	T_TIPO_DATA('142818','10','19','Sin precio o sin información en premin'),
	T_TIPO_DATA('142861','10','19','Sin precio o sin información en premin'),
	T_TIPO_DATA('148187','10','19','Sin precio o sin información en premin'),
	T_TIPO_DATA('148188','10','19','Sin precio o sin información en premin'),
	T_TIPO_DATA('153037','10','19','Sin precio o sin información en premin'),
	T_TIPO_DATA('155331','10','19','Sin precio o sin información en premin'),
	T_TIPO_DATA('155637','10','19','Sin precio o sin información en premin'),
	T_TIPO_DATA('155638','10','19','Sin precio o sin información en premin'),
	T_TIPO_DATA('158661','10','19','Sin precio o sin información en premin'),
	T_TIPO_DATA('164076','10','19','Sin precio o sin información en premin'),
	T_TIPO_DATA('170566','10','19','Sin precio o sin información en premin'),
	T_TIPO_DATA('170567','10','19','Sin precio o sin información en premin'),
	T_TIPO_DATA('170568','10','19','Sin precio o sin información en premin'),
	T_TIPO_DATA('170569','10','19','Sin precio o sin información en premin'),
	T_TIPO_DATA('170570','10','19','Sin precio o sin información en premin'),
	T_TIPO_DATA('170948','10','19','Sin precio o sin información en premin'),
	T_TIPO_DATA('170949','10','19','Sin precio o sin información en premin'),
	T_TIPO_DATA('189768','10','19','Sin precio o sin información en premin'),
	T_TIPO_DATA('189915','10','19','Sin precio o sin información en premin'),
	T_TIPO_DATA('190161','10','19','Sin precio o sin información en premin'),
	T_TIPO_DATA('196999','10','19','Sin precio o sin información en premin'),
	T_TIPO_DATA('197335','10','19','Sin precio o sin información en premin'),
	T_TIPO_DATA('6527615','10','19','Sin precio o sin información en premin')

    ); 
    V_TMP_TIPO_DATA T_TIPO_DATA;

BEGIN	

	DBMS_OUTPUT.PUT_LINE('[INICIO]');

	DBMS_OUTPUT.PUT_LINE('[INFO]: FINALIZAR FASE EN '||V_TEXT_TABLA);
	FOR I IN V_TIPO_DATA.FIRST .. V_TIPO_DATA.LAST
	LOOP
		V_TMP_TIPO_DATA := V_TIPO_DATA(I);

		V_MSQL:='SELECT COUNT(*) FROM '||V_ESQUEMA||'.ACT_ACTIVO WHERE ACT_NUM_ACTIVO = '||V_TMP_TIPO_DATA(1)||'';
		EXECUTE IMMEDIATE V_MSQL INTO V_COUNT;

		IF V_COUNT > 0 THEN

			V_MSQL:='SELECT ACT_ID FROM '||V_ESQUEMA||'.ACT_ACTIVO WHERE ACT_NUM_ACTIVO = '||V_TMP_TIPO_DATA(1)||'';
			EXECUTE IMMEDIATE V_MSQL INTO V_ACT_ID;

			V_MSQL:='SELECT USU_ID FROM '||V_ESQUEMA_M||'.USU_USUARIOS WHERE USU_USERNAME = ''SUPER''';
			EXECUTE IMMEDIATE V_MSQL INTO V_USU_ID;

			V_MSQL := 'UPDATE '||V_ESQUEMA||'.'||V_TEXT_TABLA||' SET
			HFP_FECHA_FIN = SYSDATE,
			USUARIOMODIFICAR = '''||V_USU||''',
			FECHAMODIFICAR = SYSDATE
			WHERE
			ACT_ID = '||V_ACT_ID||'
			AND HFP_FECHA_FIN IS NULL';
			EXECUTE IMMEDIATE V_MSQL;

			DBMS_OUTPUT.PUT_LINE('[INFO]: FASE FINALIZADA PARA EL ACTIVO: '||V_TMP_TIPO_DATA(1)||'');
				
			V_MSQL := 'INSERT INTO '||V_ESQUEMA||'.'||V_TEXT_TABLA||' (HFP_ID, ACT_ID, DD_FSP_ID, DD_SFP_ID, USU_ID, HFP_FECHA_INI, HFP_COMENTARIO, USUARIOCREAR, FECHACREAR)
			VALUES (
			'||V_ESQUEMA||'.S_'||V_TEXT_TABLA||'.NEXTVAL,
			'||V_ACT_ID||',
			(SELECT DD_FSP_ID FROM '||V_ESQUEMA||'.DD_FSP_FASE_PUBLICACION WHERE DD_FSP_CODIGO = '''||V_TMP_TIPO_DATA(2)||'''),
			(SELECT DD_SFP_ID FROM '||V_ESQUEMA||'.DD_SFP_SUBFASE_PUBLICACION WHERE DD_SFP_CODIGO = '''||V_TMP_TIPO_DATA(3)||'''),
			'||V_USU_ID||',
			SYSDATE,
			'''||V_TMP_TIPO_DATA(4)||''',
			'''||V_USU||''',
			SYSDATE)';
			EXECUTE IMMEDIATE V_MSQL;

			DBMS_OUTPUT.PUT_LINE('[INFO]: FASE INSERTADA PARA EL ACTIVO: '||V_TMP_TIPO_DATA(1)||'');
		
		ELSE

			DBMS_OUTPUT.PUT_LINE('[INFO]: EL ACTIVO: '||V_TMP_TIPO_DATA(1)||' NO EXISTE');

		END IF;

	END LOOP;

	COMMIT;

	DBMS_OUTPUT.PUT_LINE('[FIN]');


EXCEPTION
		WHEN OTHERS THEN
			err_num := SQLCODE;
			err_msg := SQLERRM;

			DBMS_OUTPUT.put_line('[ERROR] Se ha producido un error en la ejecución:'||TO_CHAR(err_num));
			DBMS_OUTPUT.put_line('-----------------------------------------------------------'); 
			DBMS_OUTPUT.put_line(err_msg);

			ROLLBACK;
			RAISE;          

END;

/

EXIT