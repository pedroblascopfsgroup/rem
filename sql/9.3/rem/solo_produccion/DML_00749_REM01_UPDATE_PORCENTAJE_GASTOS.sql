--/*
--#########################################
--## AUTOR=Juan Bautista Alfonso
--## FECHA_CREACION=20210310
--## ARTEFACTO=online
--## VERSION_ARTEFACTO=9.3
--## INCIDENCIA_LINK=REMVIP-9182
--## PRODUCTO=NO
--## 
--## Finalidad: Cambiar porcentajes gasto
--##			
--## INSTRUCCIONES:  
--## VERSIONES:
--##        0.1 Versi√≥n inicial
--#########################################
--*/

ALTER SESSION SET NLS_NUMERIC_CHARACTERS = ',.';
WHENEVER SQLERROR EXIT SQL.SQLCODE;
SET SERVEROUTPUT ON; 
SET DEFINE OFF; 


DECLARE


    V_MSQL VARCHAR2(32000 CHAR); -- Sentencia a ejecutar   
    V_ESQUEMA VARCHAR2(25 CHAR):= '#ESQUEMA#'; -- Configuracion Esquemas
    V_ESQUEMA_M VARCHAR2(25 CHAR):= '#ESQUEMA_MASTER#'; -- Configuracion Esquema Master 
    ERR_NUM NUMBER(25);  -- Vble. auxiliar para registrar errores en el script.
    ERR_MSG VARCHAR2(1024 CHAR); -- Vble. auxiliar para registrar errores en el script.
    V_USUARIO VARCHAR2(50 CHAR) := 'REMVIP-9182'; --Vble USUARIOMODIFICAR/USUARIOCREAR

    V_ID NUMBER(16); -- Vble. para el id del activo

    V_ID_PROVEEDOR NUMBER(16); -- Vble. para el id del proveedor

    V_TABLA_GASTO VARCHAR2(50 CHAR):= 'GPV_GASTOS_PROVEEDOR'; 
    V_TABLA_LINEA VARCHAR2(100 CHAR):='GLD_GASTOS_LINEA_DETALLE'; 
    V_TABLA_ENTIDAD VARCHAR2(100 CHAR):='GLD_ENT'; 

	V_COUNT NUMBER(16); -- Vble. para comprobar

    
    --ACT_NUM_ACTIVO        GPV_NUM_GASTO_HAYA      GLD_PARTICIPACION_GASTO
	TYPE T_TIPO_DATA IS TABLE OF VARCHAR2(32000 CHAR);
    	TYPE T_ARRAY_DATA IS TABLE OF T_TIPO_DATA;
    	V_TIPO_DATA T_ARRAY_DATA := T_ARRAY_DATA(
            T_TIPO_DATA('6853646','13601777','0,5444'),
            T_TIPO_DATA('6874822','13601777','0,5444'),
            T_TIPO_DATA('6854829','13601777','0,5444'),
            T_TIPO_DATA('6854869','13601777','0,5444'),
            T_TIPO_DATA('6854870','13601777','0,5444'),
            T_TIPO_DATA('6854912','13601777','0,5444'),
            T_TIPO_DATA('6885479','13601777','0,5444'),
            T_TIPO_DATA('6882819','13601777','0,5444'),
            T_TIPO_DATA('6883886','13601777','0,5444'),
            T_TIPO_DATA('6825633','13601777','0,5444'),
            T_TIPO_DATA('6957220','13601777','0,5444'),
            T_TIPO_DATA('6868570','13601777','0,5444'),
            T_TIPO_DATA('6868572','13601777','0,5444'),
            T_TIPO_DATA('6884937','13601777','0,5444'),
            T_TIPO_DATA('6872987','13601777','0,5444'),
            T_TIPO_DATA('6874096','13601777','0,5444'),
            T_TIPO_DATA('6883722','13601777','0,5444'),
            T_TIPO_DATA('6874798','13601777','0,5444'),
            T_TIPO_DATA('6875263','13601777','0,5444'),
            T_TIPO_DATA('6871477','13601777','0,5444'),
            T_TIPO_DATA('6850614','13601777','0,5444'),
            T_TIPO_DATA('6855288','13601777','0,5444'),
            T_TIPO_DATA('6853800','13601777','0,5444'),
            T_TIPO_DATA('6948882','13601777','0,5444'),
            T_TIPO_DATA('6855364','13601777','0,5444'),
            T_TIPO_DATA('6855372','13601777','0,5444'),
            T_TIPO_DATA('6874439','13601777','0,5444'),
            T_TIPO_DATA('6882867','13601777','0,5444'),
            T_TIPO_DATA('6883334','13601777','0,5444'),
            T_TIPO_DATA('6883640','13601777','0,5444'),
            T_TIPO_DATA('6974063','13601777','0,5444'),
            T_TIPO_DATA('6855373','13601777','0,5444'),
            T_TIPO_DATA('6855699','13601777','0,5444'),
            T_TIPO_DATA('6855701','13601777','0,5444'),
            T_TIPO_DATA('6856406','13601777','0,5444'),
            T_TIPO_DATA('6856414','13601777','0,5444'),
            T_TIPO_DATA('6856415','13601777','0,5444'),
            T_TIPO_DATA('6856505','13601777','0,5444'),
            T_TIPO_DATA('6862295','13601777','0,5444'),
            T_TIPO_DATA('6862952','13601777','0,5444'),
            T_TIPO_DATA('6862954','13601777','0,5444'),
            T_TIPO_DATA('6863038','13601777','0,5444'),
            T_TIPO_DATA('6863040','13601777','0,5444'),
            T_TIPO_DATA('6863229','13601777','0,5444'),
            T_TIPO_DATA('6863231','13601777','0,5444'),
            T_TIPO_DATA('6863344','13601777','0,5444'),
            T_TIPO_DATA('6863345','13601777','0,5444'),
            T_TIPO_DATA('6863997','13601777','0,5444'),
            T_TIPO_DATA('6864159','13601777','0,5444'),
            T_TIPO_DATA('6864160','13601777','0,5444'),
            T_TIPO_DATA('6856570','13601777','0,5444'),
            T_TIPO_DATA('6856572','13601777','0,5444'),
            T_TIPO_DATA('6856573','13601777','0,5444'),
            T_TIPO_DATA('7008713','13601777','0,5444'),
            T_TIPO_DATA('6856576','13601777','0,5444'),
            T_TIPO_DATA('6856578','13601777','0,5444'),
            T_TIPO_DATA('6856637','13601777','0,5444'),
            T_TIPO_DATA('6857081','13601777','0,5444'),
            T_TIPO_DATA('6872851','13601777','0,5444'),
            T_TIPO_DATA('6873358','13601777','0,5444'),
            T_TIPO_DATA('6872073','13601777','0,5444'),
            T_TIPO_DATA('6872620','13601777','0,5444'),
            T_TIPO_DATA('6857469','13601777','0,5444'),
            T_TIPO_DATA('6857470','13601777','0,5444'),
            T_TIPO_DATA('6875572','13601777','0,5444'),
            T_TIPO_DATA('6858194','13601777','0,5444'),
            T_TIPO_DATA('6858671','13601777','0,5444'),
            T_TIPO_DATA('6859760','13601777','0,5444'),
            T_TIPO_DATA('6938739','13601777','0,5444'),
            T_TIPO_DATA('6874085','13601777','0,5444'),
            T_TIPO_DATA('6875143','13601777','0,5444'),
            T_TIPO_DATA('6876342','13601777','0,5444'),
            T_TIPO_DATA('7101059','13601777','0,5444'),
            T_TIPO_DATA('7068216','13601777','0,5444'),
            T_TIPO_DATA('6948560','13601777','0,5444'),
            T_TIPO_DATA('6853207','13601777','0,5444'),
            T_TIPO_DATA('6935186','13601777','0,5444'),
            T_TIPO_DATA('7015819','13601777','0,5444'),
            T_TIPO_DATA('7015826','13601777','0,5444'),
            T_TIPO_DATA('6856606','13601777','0,5444'),
            T_TIPO_DATA('6858847','13601777','0,5444'),
            T_TIPO_DATA('7005249','13601777','0,5444'),
            T_TIPO_DATA('7009734','13601777','0,5444'),
            T_TIPO_DATA('6876733','13601777','0,5444'),
            T_TIPO_DATA('7225971','13601777','0,5444'),
            T_TIPO_DATA('6850981','13601777','0,5444'),
            T_TIPO_DATA('6935238','13601777','0,5444'),
            T_TIPO_DATA('7100299','13601777','0,5444'),
            T_TIPO_DATA('7019785','13601777','0,5444'),
            T_TIPO_DATA('6850656','13601777','0,5444'),
            T_TIPO_DATA('7030208','13601777','0,5444'),
            T_TIPO_DATA('6872757','13601777','0,5444'),
            T_TIPO_DATA('7068360','13601777','0,5444'),
            T_TIPO_DATA('7069078','13601777','0,5444'),
            T_TIPO_DATA('7015823','13601777','0,5444'),
            T_TIPO_DATA('7071681','13601777','0,5444'),
            T_TIPO_DATA('7074668','13601777','0,5444'),
            T_TIPO_DATA('7075289','13601777','0,5444'),
            T_TIPO_DATA('7100320','13601777','0,5444'),
            T_TIPO_DATA('6873760','13601777','0,5444'),
            T_TIPO_DATA('7030080','13601777','0,5444'),
            T_TIPO_DATA('7030315','13601777','0,5444'),
            T_TIPO_DATA('6873702','13601777','0,5444'),
            T_TIPO_DATA('7030478','13601777','0,5444'),
            T_TIPO_DATA('7100319','13601777','0,5444'),
            T_TIPO_DATA('7229284','13601777','0,5444'),
            T_TIPO_DATA('6935851','13601777','0,5444'),
            T_TIPO_DATA('6935771','13601777','0,5444'),
            T_TIPO_DATA('6938634','13601777','0,5444'),
            T_TIPO_DATA('6973836','13601777','0,5444'),
            T_TIPO_DATA('7008331','13601777','0,4560'),
            T_TIPO_DATA('6948244','13601777','0,5444'),
            T_TIPO_DATA('7075981','13601777','0,5444'),
            T_TIPO_DATA('7072342','13601777','0,5444'),
            T_TIPO_DATA('7072304','13601777','0,5444'),
            T_TIPO_DATA('6850949','13601777','0,5444'),
            T_TIPO_DATA('7100341','13601777','0,5444'),
            T_TIPO_DATA('6948009','13601777','0,5444'),
            T_TIPO_DATA('6961945','13601777','0,5444'),
            T_TIPO_DATA('6853380','13601777','0,5444'),
            T_TIPO_DATA('6859669','13601777','0,5444'),
            T_TIPO_DATA('6860342','13601777','0,5444'),
            T_TIPO_DATA('6860738','13601777','0,5444'),
            T_TIPO_DATA('6861359','13601777','0,5444'),
            T_TIPO_DATA('6861360','13601777','0,5444'),
            T_TIPO_DATA('6861361','13601777','0,5444'),
            T_TIPO_DATA('6862166','13601777','0,5444'),
            T_TIPO_DATA('6862945','13601777','0,5444'),
            T_TIPO_DATA('6862946','13601777','0,5444'),
            T_TIPO_DATA('6862949','13601777','0,5444'),
            T_TIPO_DATA('6862953','13601777','0,5444'),
            T_TIPO_DATA('6863033','13601777','0,5444'),
            T_TIPO_DATA('6863035','13601777','0,5444'),
            T_TIPO_DATA('6863037','13601777','0,5444'),
            T_TIPO_DATA('6863225','13601777','0,5444'),
            T_TIPO_DATA('6863226','13601777','0,5444'),
            T_TIPO_DATA('6863446','13601777','0,5444'),
            T_TIPO_DATA('6863995','13601777','0,5444'),
            T_TIPO_DATA('6863996','13601777','0,5444'),
            T_TIPO_DATA('7030578','13601777','0,5444'),
            T_TIPO_DATA('6883577','13601777','0,5444'),
            T_TIPO_DATA('6849316','13601777','0,5444'),
            T_TIPO_DATA('7292483','13601777','0,5444'),
            T_TIPO_DATA('6935548','13601777','0,5444'),
            T_TIPO_DATA('7007792','13601777','0,5444'),
            T_TIPO_DATA('6876799','13601777','0,5444'),
            T_TIPO_DATA('6875474','13601777','0,5444'),
            T_TIPO_DATA('6883351','13601777','0,5444'),
            T_TIPO_DATA('6962343','13601777','0,5444'),
            T_TIPO_DATA('7224398','13601777','0,5444'),
            T_TIPO_DATA('6966659','13601777','0,5444'),
            T_TIPO_DATA('7014372','13601777','0,5444'),
            T_TIPO_DATA('7072484','13601777','0,5444'),
            T_TIPO_DATA('6962243','13601777','0,5444'),
            T_TIPO_DATA('7004370','13601777','0,5444'),
            T_TIPO_DATA('7292437','13601777','0,5444'),
            T_TIPO_DATA('6851366','13601777','0,5444'),
            T_TIPO_DATA('7076187','13601777','0,5444'),
            T_TIPO_DATA('6856216','13601777','0,5444'),
            T_TIPO_DATA('7010023','13601777','0,5444'),
            T_TIPO_DATA('6967248','13601777','0,5444'),
            T_TIPO_DATA('6850971','13601777','0,4560'),
            T_TIPO_DATA('7088753','13601777','0,5444'),
            T_TIPO_DATA('7101234','13601777','0,5444'),
            T_TIPO_DATA('6853213','13601777','0,5444'),
            T_TIPO_DATA('6852871','13601777','0,5444'),
            T_TIPO_DATA('6935611','13601777','0,5444'),
            T_TIPO_DATA('6955786','13601777','0,5444'),
            T_TIPO_DATA('6873383','13601777','0,5444'),
            T_TIPO_DATA('7292648','13601777','0,5444'),
            T_TIPO_DATA('7101053','13601777','0,5444'),
            T_TIPO_DATA('7294350','13601777','0,5444'),
            T_TIPO_DATA('6877459','13601777','0,5444'),
            T_TIPO_DATA('6875478','13601777','0,5444'),
            T_TIPO_DATA('6874882','13601777','0,5444'),
            T_TIPO_DATA('6874883','13601777','0,5444'),
            T_TIPO_DATA('6874995','13601777','0,5444'),
            T_TIPO_DATA('7225321','13601777','0,5444'),
            T_TIPO_DATA('6876128','13601777','0,5444'),
            T_TIPO_DATA('6881717','13601777','0,5444'),
            T_TIPO_DATA('6872326','13601777','0,5444'),
            T_TIPO_DATA('6857038','13601777','0,5444'),
            T_TIPO_DATA('7030328','13601777','0,5444'),
            T_TIPO_DATA('6865540','13601777','0,5444'),
            T_TIPO_DATA('6882436','13601778','5,8824'),
            T_TIPO_DATA('6849332','13601778','5,8824'),
            T_TIPO_DATA('6849051','13601778','5,8824'),
            T_TIPO_DATA('6849693','13601778','5,8824'),
            T_TIPO_DATA('6851412','13601778','5,8824'),
            T_TIPO_DATA('6857009','13601778','5,8824'),
            T_TIPO_DATA('6935772','13601778','5,8824'),
            T_TIPO_DATA('6962364','13601778','5,8824'),
            T_TIPO_DATA('6878133','13601778','5,8824'),
            T_TIPO_DATA('7016644','13601778','5,8824'),
            T_TIPO_DATA('6850827','13601778','5,8824'),
            T_TIPO_DATA('6854252','13601778','5,8824'),
            T_TIPO_DATA('6854268','13601778','5,8824'),
            T_TIPO_DATA('6849060','13601778','5,8824'),
            T_TIPO_DATA('6878443','13601778','5,8824'),
            T_TIPO_DATA('7226571','13601778','5,8824'),
            T_TIPO_DATA('6851017','13601778','5,8824'),
            T_TIPO_DATA('6973414','13619736','33,3333'),
            T_TIPO_DATA('6848897','13619736','33,3333'),
            T_TIPO_DATA('6877388','13619736','33,3333'),
            T_TIPO_DATA('6878133','13619741','10,0000'),
            T_TIPO_DATA('7226571','13619741','10,0000'),
            T_TIPO_DATA('6851412','13619741','10,0000'),
            T_TIPO_DATA('6857009','13619741','10,0000'),
            T_TIPO_DATA('6935772','13619741','10,0000'),
            T_TIPO_DATA('7016644','13619741','10,0000'),
            T_TIPO_DATA('6962364','13619741','10,0000'),
            T_TIPO_DATA('6849332','13619741','10,0000'),
            T_TIPO_DATA('6849693','13619741','10,0000'),
            T_TIPO_DATA('6882436','13619741','10,0000'),
            T_TIPO_DATA('6875369','13619743','11,1173'),
            T_TIPO_DATA('6938651','13619743','11,1173'),
            T_TIPO_DATA('6938634','13619743','11,1173'),
            T_TIPO_DATA('6938633','13619743','11,1173'),
            T_TIPO_DATA('6966678','13619743','11,1173'),
            T_TIPO_DATA('7075689','13619743','11,1173'),
            T_TIPO_DATA('7009996','13619743','11,1173'),
            T_TIPO_DATA('7031393','13619743','11,1173'),
            T_TIPO_DATA('7030397','13619743','11,1173'),
            T_TIPO_DATA('6853646','13619746','3,0303'),
            T_TIPO_DATA('6854829','13619746','3,0303'),
            T_TIPO_DATA('6855364','13619746','3,0303'),
            T_TIPO_DATA('6856570','13619746','3,0303'),
            T_TIPO_DATA('6856572','13619746','3,0303'),
            T_TIPO_DATA('6856637','13619746','3,0303'),
            T_TIPO_DATA('6875263','13619746','3,0303'),
            T_TIPO_DATA('6872851','13619746','3,0303'),
            T_TIPO_DATA('6873358','13619746','3,0303'),
            T_TIPO_DATA('6938634','13619746','3,0303'),
            T_TIPO_DATA('7069078','13619746','3,0303'),
            T_TIPO_DATA('7088753','13619746','3,0303'),
            T_TIPO_DATA('7100319','13619746','3,0303'),
            T_TIPO_DATA('7100320','13619746','3,0303'),
            T_TIPO_DATA('7015823','13619746','3,0303'),
            T_TIPO_DATA('7292648','13619746','3,0303'),
            T_TIPO_DATA('7030578','13619746','3,0303'),
            T_TIPO_DATA('6873702','13619746','3,0303'),
            T_TIPO_DATA('6883334','13619746','3,0303'),
            T_TIPO_DATA('7030080','13619746','3,0303'),
            T_TIPO_DATA('7074668','13619746','3,0303'),
            T_TIPO_DATA('6883722','13619746','3,0303'),
            T_TIPO_DATA('6882867','13619746','3,0303'),
            T_TIPO_DATA('6938739','13619746','3,0303'),
            T_TIPO_DATA('7030315','13619746','3,0303'),
            T_TIPO_DATA('7030478','13619746','3,0303'),
            T_TIPO_DATA('7229284','13619746','3,0303'),
            T_TIPO_DATA('7292437','13619746','3,0303'),
            T_TIPO_DATA('7101234','13619746','3,0303'),
            T_TIPO_DATA('7076187','13619746','3,0303'),
            T_TIPO_DATA('6851366','13619746','3,0303'),
            T_TIPO_DATA('7010023','13619746','3,0303'),
            T_TIPO_DATA('7009734','13619746','3,0303'),
            T_TIPO_DATA('6865540','13619750','1,5625'),
            T_TIPO_DATA('7030328','13619750','1,5625'),
            T_TIPO_DATA('6853800','13619750','1,5625'),
            T_TIPO_DATA('7294350','13619750','1,5625'),
            T_TIPO_DATA('6857038','13619750','1,5625'),
            T_TIPO_DATA('6825633','13619750','1,5625'),
            T_TIPO_DATA('6874822','13619750','1,5625'),
            T_TIPO_DATA('7101053','13619750','1,5625'),
            T_TIPO_DATA('6854869','13619750','1,5625'),
            T_TIPO_DATA('6854870','13619750','1,5625'),
            T_TIPO_DATA('6854912','13619750','1,5625'),
            T_TIPO_DATA('6855288','13619750','1,5625'),
            T_TIPO_DATA('6855372','13619750','1,5625'),
            T_TIPO_DATA('6855373','13619750','1,5625'),
            T_TIPO_DATA('6855699','13619750','1,5625'),
            T_TIPO_DATA('6855701','13619750','1,5625'),
            T_TIPO_DATA('6856406','13619750','1,5625'),
            T_TIPO_DATA('6856414','13619750','1,5625'),
            T_TIPO_DATA('6856415','13619750','1,5625'),
            T_TIPO_DATA('6856505','13619750','1,5625'),
            T_TIPO_DATA('6856573','13619750','1,5625'),
            T_TIPO_DATA('6856576','13619750','1,5625'),
            T_TIPO_DATA('6856578','13619750','1,5625'),
            T_TIPO_DATA('6857081','13619750','1,5625'),
            T_TIPO_DATA('6857469','13619750','1,5625'),
            T_TIPO_DATA('6857470','13619750','1,5625'),
            T_TIPO_DATA('6875572','13619750','1,5625'),
            T_TIPO_DATA('6858194','13619750','1,5625'),
            T_TIPO_DATA('6858671','13619750','1,5625'),
            T_TIPO_DATA('6875143','13619750','1,5625'),
            T_TIPO_DATA('6876342','13619750','1,5625'),
            T_TIPO_DATA('7101059','13619750','1,5625'),
            T_TIPO_DATA('7068216','13619750','1,5625'),
            T_TIPO_DATA('6853207','13619750','1,5625'),
            T_TIPO_DATA('6856606','13619750','1,5625'),
            T_TIPO_DATA('6885479','13619750','1,5625'),
            T_TIPO_DATA('6876733','13619750','1,5625'),
            T_TIPO_DATA('6868570','13619750','1,5625'),
            T_TIPO_DATA('6868572','13619750','1,5625'),
            T_TIPO_DATA('6871477','13619750','1,5625'),
            T_TIPO_DATA('6873760','13619750','1,5625'),
            T_TIPO_DATA('6935851','13619750','1,5625'),
            T_TIPO_DATA('6935771','13619750','1,5625'),
            T_TIPO_DATA('7030208','13619750','1,5625'),
            T_TIPO_DATA('7075981','13619750','1,5625'),
            T_TIPO_DATA('7072342','13619750','1,5625'),
            T_TIPO_DATA('7072304','13619750','1,5625'),
            T_TIPO_DATA('6872987','13619750','1,5625'),
            T_TIPO_DATA('6955786','13619750','1,5625'),
            T_TIPO_DATA('7068360','13619750','1,5625'),
            T_TIPO_DATA('7005249','13619750','1,5625'),
            T_TIPO_DATA('6850614','13619750','1,5625'),
            T_TIPO_DATA('6850949','13619750','1,5625'),
            T_TIPO_DATA('7100299','13619750','1,5625'),
            T_TIPO_DATA('6948009','13619750','1,5625'),
            T_TIPO_DATA('6961945','13619750','1,5625'),
            T_TIPO_DATA('6974063','13619750','1,5625'),
            T_TIPO_DATA('7292483','13619750','1,5625'),
            T_TIPO_DATA('6875474','13619750','1,5625'),
            T_TIPO_DATA('6874798','13619750','1,5625'),
            T_TIPO_DATA('6884937','13619750','1,5625'),
            T_TIPO_DATA('6948882','13619750','1,5625'),
            T_TIPO_DATA('6935611','13619750','1,5625'),
            T_TIPO_DATA('7071681','13619750','1,5625'),
            T_TIPO_DATA('6872613','13619790','2,1277'),
            T_TIPO_DATA('6871525','13619790','2,1277'),
            T_TIPO_DATA('6871627','13619790','2,1277'),
            T_TIPO_DATA('6871984','13619790','2,1277'),
            T_TIPO_DATA('6871988','13619790','2,1277'),
            T_TIPO_DATA('6871686','13619790','2,1277'),
            T_TIPO_DATA('6872885','13619790','2,1277'),
            T_TIPO_DATA('6871626','13619790','2,1277'),
            T_TIPO_DATA('6873126','13619790','2,1277'),
            T_TIPO_DATA('6872916','13619790','2,1277'),
            T_TIPO_DATA('6872021','13619790','2,1277'),
            T_TIPO_DATA('6872884','13619790','2,1277'),
            T_TIPO_DATA('6872026','13619790','2,1277'),
            T_TIPO_DATA('6872496','13619790','2,1277'),
            T_TIPO_DATA('6873768','13619790','2,1277'),
            T_TIPO_DATA('6873929','13619790','2,1277'),
            T_TIPO_DATA('6871524','13619790','2,1277'),
            T_TIPO_DATA('6872487','13619790','2,1277'),
            T_TIPO_DATA('6871687','13619790','2,1277'),
            T_TIPO_DATA('6872615','13619790','2,1277'),
            T_TIPO_DATA('6871683','13619790','2,1277'),
            T_TIPO_DATA('6872660','13619790','2,1277'),
            T_TIPO_DATA('6872284','13619790','2,1277'),
            T_TIPO_DATA('6872943','13619790','2,1277'),
            T_TIPO_DATA('6871689','13619790','2,1277'),
            T_TIPO_DATA('6872618','13619790','2,1277'),
            T_TIPO_DATA('6872493','13619790','2,1277'),
            T_TIPO_DATA('6871983','13619790','2,1277'),
            T_TIPO_DATA('6872942','13619790','2,1277'),
            T_TIPO_DATA('6872024','13619790','2,1277'),
            T_TIPO_DATA('6873761','13619790','2,1277'),
            T_TIPO_DATA('6873928','13619790','2,1277'),
            T_TIPO_DATA('6872617','13619790','2,1277'),
            T_TIPO_DATA('6872488','13619790','2,1277'),
            T_TIPO_DATA('6872020','13619790','2,1277'),
            T_TIPO_DATA('6871986','13619790','2,1277'),
            T_TIPO_DATA('6873618','13619790','2,1277'),
            T_TIPO_DATA('6871632','13619790','2,1277'),
            T_TIPO_DATA('6873121','13619790','2,1277'),
            T_TIPO_DATA('6873124','13619790','2,1277'),
            T_TIPO_DATA('6873122','13619790','2,1277'),
            T_TIPO_DATA('6873763','13619790','2,1277'),
            T_TIPO_DATA('6872917','13619790','2,1277'),
            T_TIPO_DATA('6872610','13619790','2,1277'),
            T_TIPO_DATA('6873926','13619790','2,1277'),
            T_TIPO_DATA('6873765','13619790','2,1277'),
            T_TIPO_DATA('6872023','13619790','2,1277'),
            T_TIPO_DATA('7015137','13619791','100,0000'),
            T_TIPO_DATA('7075835','13619792','20,0000'),
            T_TIPO_DATA('7031575','13619792','20,0000'),
            T_TIPO_DATA('6935873','13619792','20,0000'),
            T_TIPO_DATA('7075437','13619792','20,0000'),
            T_TIPO_DATA('6851370','13619792','20,0000'),
            T_TIPO_DATA('6849051','13619794','100,0000')


    	); 
    	V_TMP_TIPO_DATA T_TIPO_DATA;

BEGIN
	DBMS_OUTPUT.PUT_LINE('[INICIO]');
    DBMS_OUTPUT.PUT_LINE('[INFO]: MODIFICAMOS PORCENTAJE PARTICIPACION ACTIVO GASTO');

    FOR I IN V_TIPO_DATA.FIRST .. V_TIPO_DATA.LAST
        LOOP
    V_TMP_TIPO_DATA := V_TIPO_DATA(I);

        --Comprobamos que existe el activo, el gasto y que esten asociados a traves de la linea de detalle
        V_MSQL := 'SELECT COUNT(1) FROM '||V_ESQUEMA||'.'||V_TABLA_GASTO||' GPV
                    JOIN '||V_ESQUEMA||'.'||V_TABLA_LINEA||' GLD ON GPV.GPV_ID=GLD.GPV_ID
                    JOIN '||V_ESQUEMA||'.'||V_TABLA_ENTIDAD||' GLENT ON GLENT.GLD_ID=GLD.GLD_ID
                    JOIN '||V_ESQUEMA||'.ACT_ACTIVO ACT ON ACT.ACT_ID=GLENT.ENT_ID
                    WHERE GPV.GPV_NUM_GASTO_HAYA='''||V_TMP_TIPO_DATA(2)||''' AND ACT.ACT_NUM_ACTIVO='''||V_TMP_TIPO_DATA(1)||'''
                    AND GPV.BORRADO=0 AND ACT.BORRADO=0 AND GLD.BORRADO=0 AND GLENT.BORRADO=0 ';
        EXECUTE IMMEDIATE V_MSQL INTO V_COUNT;

        IF V_COUNT = 1 THEN

            --Obtenemos el id de la entidad

             V_MSQL := 'SELECT GLENT.GLD_ENT_ID FROM '||V_ESQUEMA||'.'||V_TABLA_GASTO||' GPV
                    JOIN '||V_ESQUEMA||'.'||V_TABLA_LINEA||' GLD ON GPV.GPV_ID=GLD.GPV_ID
                    JOIN '||V_ESQUEMA||'.'||V_TABLA_ENTIDAD||' GLENT ON GLENT.GLD_ID=GLD.GLD_ID
                    JOIN '||V_ESQUEMA||'.ACT_ACTIVO ACT ON ACT.ACT_ID=GLENT.ENT_ID
                    WHERE GPV.GPV_NUM_GASTO_HAYA='''||V_TMP_TIPO_DATA(2)||''' AND ACT.ACT_NUM_ACTIVO='''||V_TMP_TIPO_DATA(1)||'''
                    AND GPV.BORRADO=0 AND ACT.BORRADO=0 AND GLD.BORRADO=0 AND GLENT.BORRADO=0 ';
            EXECUTE IMMEDIATE V_MSQL INTO V_ID;


            --Actualizamos el porcentaje de participacion del activo en el gasto
            V_MSQL:= 'UPDATE '||V_ESQUEMA||'.'||V_TABLA_ENTIDAD||' SET
                    GLD_PARTICIPACION_GASTO='''||V_TMP_TIPO_DATA(3)||''',
                    USUARIOMODIFICAR = '''|| V_USUARIO ||''',
                    FECHAMODIFICAR = SYSDATE
                    WHERE GLD_ENT_ID = '||V_ID||'';

            EXECUTE IMMEDIATE V_MSQL;

            DBMS_OUTPUT.PUT_LINE('[INFO]: ACTIVO '''||V_TMP_TIPO_DATA(1)||''' GASTO '''||V_TMP_TIPO_DATA(2)||'''   ACTUALIZADO CON PORCENTAJE '''||V_TMP_TIPO_DATA(3)||'''');

            
        ELSE 
            DBMS_OUTPUT.PUT_LINE('[INFO] NO EXISTE LA RELACION ACTIVO:'''||V_TMP_TIPO_DATA(1)||''' GASTO: '''||V_TMP_TIPO_DATA(2)||''' PARTICIPACION: '''||V_TMP_TIPO_DATA(3)||'''');
        END IF;

    END LOOP;
     

    COMMIT;

    DBMS_OUTPUT.PUT_LINE('[FIN]');
 
EXCEPTION
     WHEN OTHERS THEN
          ERR_NUM := SQLCODE;
          ERR_MSG := SQLERRM;
          DBMS_OUTPUT.put_line('[ERROR] Se ha producido un error en la ejecuci√≥n:'||TO_CHAR(ERR_NUM));
          DBMS_OUTPUT.put_line('-----------------------------------------------------------'); 
          DBMS_OUTPUT.put_line(ERR_MSG);
          ROLLBACK;
          RAISE;   
END;
/
EXIT;