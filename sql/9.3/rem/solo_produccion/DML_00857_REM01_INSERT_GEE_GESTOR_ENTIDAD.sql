--/*
--##########################################
--## AUTOR=Carlos Santos Vílchez
--## FECHA_CREACION=20210517
--## ARTEFACTO=online
--## VERSION_ARTEFACTO=9.3
--## INCIDENCIA_LINK=REMVIP-9717
--## PRODUCTO=NO
--##
--## Finalidad: Script añade gestores a expedientes
--## INSTRUCCIONES:
--## VERSIONES:
--##        0.1 Versión inicial
--##########################################
--*/

WHENEVER SQLERROR EXIT SQL.SQLCODE;
SET SERVEROUTPUT ON; 
SET DEFINE OFF;

DECLARE

    V_MSQL VARCHAR2(32000 CHAR); -- Sentencia a ejecutar.
    V_ESQUEMA VARCHAR2(25 CHAR):= '#ESQUEMA#'; -- Configuracion Esquema.
    V_ESQUEMA_M VARCHAR2(25 CHAR):= '#ESQUEMA_MASTER#'; -- Configuracion Esquema Master.
    ERR_NUM NUMBER(25);  -- Vble. auxiliar para registrar errores en el script.
    ERR_MSG VARCHAR2(1024 CHAR); -- Vble. auxiliar para registrar errores en el script.
    V_USU VARCHAR2(30 CHAR) := 'REMVIP-9717'; -- Vble. auxiliar para almacenar el nombre de usuario que modifica los registros.
	V_COUNT NUMBER(16);
	V_ECO_ID NUMBER(16);
	V_GEE_ID NUMBER(16);
	V_GEH_ID NUMBER(16);
	V_USU_ID NUMBER(16);
	V_TGE_ID NUMBER(16);

	TYPE T_TIPO_DATA IS TABLE OF VARCHAR2(150);
    TYPE T_ARRAY_DATA IS TABLE OF T_TIPO_DATA;
    V_TIPO_DATA T_ARRAY_DATA := T_ARRAY_DATA(
		T_TIPO_DATA('247636'),
		T_TIPO_DATA('257294'),
		T_TIPO_DATA('247633'),
		T_TIPO_DATA('248319'),
		T_TIPO_DATA('233881'),
		T_TIPO_DATA('253031'),
		T_TIPO_DATA('256547'),
		T_TIPO_DATA('257985'),
		T_TIPO_DATA('255602'),
		T_TIPO_DATA('259436'),
		T_TIPO_DATA('258727'),
		T_TIPO_DATA('218747'),
		T_TIPO_DATA('248202'),
		T_TIPO_DATA('250715'),
		T_TIPO_DATA('255592'),
		T_TIPO_DATA('259147'),
		T_TIPO_DATA('252002'),
		T_TIPO_DATA('252997'),
		T_TIPO_DATA('248722'),
		T_TIPO_DATA('259970'),
		T_TIPO_DATA('253728'),
		T_TIPO_DATA('249345'),
		T_TIPO_DATA('256119'),
		T_TIPO_DATA('250818'),
		T_TIPO_DATA('252912'),
		T_TIPO_DATA('258552'),
		T_TIPO_DATA('259448'),
		T_TIPO_DATA('237385'),
		T_TIPO_DATA('246324'),
		T_TIPO_DATA('259052'),
		T_TIPO_DATA('249801'),
		T_TIPO_DATA('253034'),
		T_TIPO_DATA('237226'),
		T_TIPO_DATA('246886'),
		T_TIPO_DATA('227753'),
		T_TIPO_DATA('257870'),
		T_TIPO_DATA('259999'),
		T_TIPO_DATA('233310'),
		T_TIPO_DATA('248743'),
		T_TIPO_DATA('252999'),
		T_TIPO_DATA('257908'),
		T_TIPO_DATA('215639'),
		T_TIPO_DATA('229849'),
		T_TIPO_DATA('254287'),
		T_TIPO_DATA('259404'),
		T_TIPO_DATA('245832'),
		T_TIPO_DATA('255617'),
		T_TIPO_DATA('251052'),
		T_TIPO_DATA('220411'),
		T_TIPO_DATA('252781'),
		T_TIPO_DATA('249110'),
		T_TIPO_DATA('252211'),
		T_TIPO_DATA('251964'),
		T_TIPO_DATA('249540'),
		T_TIPO_DATA('246698'),
		T_TIPO_DATA('248258'),
		T_TIPO_DATA('255095'),
		T_TIPO_DATA('252672'),
		T_TIPO_DATA('259218'),
		T_TIPO_DATA('255391'),
		T_TIPO_DATA('244953'),
		T_TIPO_DATA('222483'),
		T_TIPO_DATA('252809'),
		T_TIPO_DATA('235628'),
		T_TIPO_DATA('252436'),
		T_TIPO_DATA('222916'),
		T_TIPO_DATA('231073'),
		T_TIPO_DATA('253747'),
		T_TIPO_DATA('233166'),
		T_TIPO_DATA('255542'),
		T_TIPO_DATA('253705'),
		T_TIPO_DATA('234098'),
		T_TIPO_DATA('258827'),
		T_TIPO_DATA('235513'),
		T_TIPO_DATA('246409'),
		T_TIPO_DATA('258426'),
		T_TIPO_DATA('251356'),
		T_TIPO_DATA('259507'),
		T_TIPO_DATA('226365'),
		T_TIPO_DATA('257560'),
		T_TIPO_DATA('258981'),
		T_TIPO_DATA('259227'),
		T_TIPO_DATA('259967'),
		T_TIPO_DATA('256422'),
		T_TIPO_DATA('258735'),
		T_TIPO_DATA('245727'),
		T_TIPO_DATA('235487'),
		T_TIPO_DATA('235140'),
		T_TIPO_DATA('245904'),
		T_TIPO_DATA('259130'),
		T_TIPO_DATA('259450'),
		T_TIPO_DATA('259873'),
		T_TIPO_DATA('259630'),
		T_TIPO_DATA('258178'),
		T_TIPO_DATA('259683'),
		T_TIPO_DATA('258796'),
		T_TIPO_DATA('258553'),
		T_TIPO_DATA('250385'),
		T_TIPO_DATA('257703'),
		T_TIPO_DATA('259152'),
		T_TIPO_DATA('248732'),
		T_TIPO_DATA('251759'),
		T_TIPO_DATA('256131'),
		T_TIPO_DATA('257512'),
		T_TIPO_DATA('222766'),
		T_TIPO_DATA('251518'),
		T_TIPO_DATA('247580'),
		T_TIPO_DATA('259048'),
		T_TIPO_DATA('254926'),
		T_TIPO_DATA('255429'),
		T_TIPO_DATA('256544'),
		T_TIPO_DATA('246517'),
		T_TIPO_DATA('250783'),
		T_TIPO_DATA('234954'),
		T_TIPO_DATA('245339'),
		T_TIPO_DATA('255324'),
		T_TIPO_DATA('256562'),
		T_TIPO_DATA('247322'),
		T_TIPO_DATA('223541'),
		T_TIPO_DATA('249480'),
		T_TIPO_DATA('223201'),
		T_TIPO_DATA('226554'),
		T_TIPO_DATA('254745'),
		T_TIPO_DATA('239161'),
		T_TIPO_DATA('250771'),
		T_TIPO_DATA('247755'),
		T_TIPO_DATA('257827'),
		T_TIPO_DATA('251849'),
		T_TIPO_DATA('259212'),
		T_TIPO_DATA('231061'),
		T_TIPO_DATA('256745'),
		T_TIPO_DATA('254873'),
		T_TIPO_DATA('259086'),
		T_TIPO_DATA('253742'),
		T_TIPO_DATA('217407'),
		T_TIPO_DATA('259665'),
		T_TIPO_DATA('258963'),
		T_TIPO_DATA('256284'),
		T_TIPO_DATA('251537'),
		T_TIPO_DATA('238027'),
		T_TIPO_DATA('249838'),
		T_TIPO_DATA('254529'),
		T_TIPO_DATA('229156'),
		T_TIPO_DATA('228644'),
		T_TIPO_DATA('256997'),
		T_TIPO_DATA('258586'),
		T_TIPO_DATA('257699'),
		T_TIPO_DATA('216189'),
		T_TIPO_DATA('253375'),
		T_TIPO_DATA('235419'),
		T_TIPO_DATA('246364'),
		T_TIPO_DATA('253295'),
		T_TIPO_DATA('234103'),
		T_TIPO_DATA('251169'),
		T_TIPO_DATA('250543'),
		T_TIPO_DATA('255559'),
		T_TIPO_DATA('249579'),
		T_TIPO_DATA('249254'),
		T_TIPO_DATA('222913'),
		T_TIPO_DATA('258069'),
		T_TIPO_DATA('253433'),
		T_TIPO_DATA('234764'),
		T_TIPO_DATA('258212'),
		T_TIPO_DATA('251323'),
		T_TIPO_DATA('238099'),
		T_TIPO_DATA('256196'),
		T_TIPO_DATA('251336'),
		T_TIPO_DATA('236474'),
		T_TIPO_DATA('258539'),
		T_TIPO_DATA('249011'),
		T_TIPO_DATA('239095'),
		T_TIPO_DATA('253435'),
		T_TIPO_DATA('247942'),
		T_TIPO_DATA('250342'),
		T_TIPO_DATA('259875'),
		T_TIPO_DATA('237586'),
		T_TIPO_DATA('251806'),
		T_TIPO_DATA('257042'),
		T_TIPO_DATA('258680'),
		T_TIPO_DATA('258819'),
		T_TIPO_DATA('256744'),
		T_TIPO_DATA('249114'),
		T_TIPO_DATA('258753'),
		T_TIPO_DATA('252198'),
		T_TIPO_DATA('219751'),
		T_TIPO_DATA('249695'),
		T_TIPO_DATA('244674'),
		T_TIPO_DATA('251622'),
		T_TIPO_DATA('238858'),
		T_TIPO_DATA('252213'),
		T_TIPO_DATA('252679'),
		T_TIPO_DATA('247527'),
		T_TIPO_DATA('246437'),
		T_TIPO_DATA('251725'),
		T_TIPO_DATA('258245'),
		T_TIPO_DATA('248549'),
		T_TIPO_DATA('258987'),
		T_TIPO_DATA('257568'),
		T_TIPO_DATA('224890'),
		T_TIPO_DATA('245852'),
		T_TIPO_DATA('238495'),
		T_TIPO_DATA('254567'),
		T_TIPO_DATA('248453'),
		T_TIPO_DATA('251756'),
		T_TIPO_DATA('235903'),
		T_TIPO_DATA('258729'),
		T_TIPO_DATA('257477'),
		T_TIPO_DATA('258924'),
		T_TIPO_DATA('236748'),
		T_TIPO_DATA('239402'),
		T_TIPO_DATA('238367'),
		T_TIPO_DATA('250634'),
		T_TIPO_DATA('259390'),
		T_TIPO_DATA('255554'),
		T_TIPO_DATA('236432'),
		T_TIPO_DATA('255883'),
		T_TIPO_DATA('259428'),
		T_TIPO_DATA('245495'),
		T_TIPO_DATA('258917'),
		T_TIPO_DATA('259084'),
		T_TIPO_DATA('237233'),
		T_TIPO_DATA('247896'),
		T_TIPO_DATA('252756'),
		T_TIPO_DATA('251576'),
		T_TIPO_DATA('257216'),
		T_TIPO_DATA('231271'),
		T_TIPO_DATA('234786'),
		T_TIPO_DATA('247830'),
		T_TIPO_DATA('232254'),
		T_TIPO_DATA('257443'),
		T_TIPO_DATA('257659'),
		T_TIPO_DATA('253478'),
		T_TIPO_DATA('235175'),
		T_TIPO_DATA('235176'),
		T_TIPO_DATA('259748'),
		T_TIPO_DATA('256534'),
		T_TIPO_DATA('257553'),
		T_TIPO_DATA('250380'),
		T_TIPO_DATA('256118'),
		T_TIPO_DATA('256810'),
		T_TIPO_DATA('220974'),
		T_TIPO_DATA('245194'),
		T_TIPO_DATA('246286'),
		T_TIPO_DATA('252886'),
		T_TIPO_DATA('238746'),
		T_TIPO_DATA('253017'),
		T_TIPO_DATA('248015'),
		T_TIPO_DATA('258853'),
		T_TIPO_DATA('246390'),
		T_TIPO_DATA('259640'),
		T_TIPO_DATA('256831'),
		T_TIPO_DATA('252187'),
		T_TIPO_DATA('258811'),
		T_TIPO_DATA('255816'),
		T_TIPO_DATA('252243'),
		T_TIPO_DATA('256557'),
		T_TIPO_DATA('250291'),
		T_TIPO_DATA('257224'),
		T_TIPO_DATA('254606'),
		T_TIPO_DATA('256162'),
		T_TIPO_DATA('257468'),
		T_TIPO_DATA('218811'),
		T_TIPO_DATA('250339'),
		T_TIPO_DATA('256259'),
		T_TIPO_DATA('252084'),
		T_TIPO_DATA('239294'),
		T_TIPO_DATA('253398'),
		T_TIPO_DATA('247144'),
		T_TIPO_DATA('245539'),
		T_TIPO_DATA('252435'),
		T_TIPO_DATA('254559'),
		T_TIPO_DATA('245311'),
		T_TIPO_DATA('250475'),
		T_TIPO_DATA('248707'),
		T_TIPO_DATA('259206'),
		T_TIPO_DATA('249935'),
		T_TIPO_DATA('249268'),
		T_TIPO_DATA('238519'),
		T_TIPO_DATA('251933'),
		T_TIPO_DATA('249952'),
		T_TIPO_DATA('258235'),
		T_TIPO_DATA('252987'),
		T_TIPO_DATA('255235'),
		T_TIPO_DATA('223567'),
		T_TIPO_DATA('256731'),
		T_TIPO_DATA('249548'),
		T_TIPO_DATA('245920'),
		T_TIPO_DATA('251719'),
		T_TIPO_DATA('239083'),
		T_TIPO_DATA('250938'),
		T_TIPO_DATA('250495'),
		T_TIPO_DATA('259032'),
		T_TIPO_DATA('247014'),
		T_TIPO_DATA('256019'),
		T_TIPO_DATA('248653'),
		T_TIPO_DATA('255245'),
		T_TIPO_DATA('238464'),
		T_TIPO_DATA('248471'),
		T_TIPO_DATA('259467'),
		T_TIPO_DATA('238370'),
		T_TIPO_DATA('257516'),
		T_TIPO_DATA('252000'),
		T_TIPO_DATA('250803'),
		T_TIPO_DATA('258790'),
		T_TIPO_DATA('251157'),
		T_TIPO_DATA('251187'),
		T_TIPO_DATA('253039'),
		T_TIPO_DATA('233209'),
		T_TIPO_DATA('255106'),
		T_TIPO_DATA('250346'),
		T_TIPO_DATA('257229'),
		T_TIPO_DATA('249571'),
		T_TIPO_DATA('235650'),
		T_TIPO_DATA('238196'),
		T_TIPO_DATA('255861'),
		T_TIPO_DATA('250582'),
		T_TIPO_DATA('259732'),
		T_TIPO_DATA('252242'),
		T_TIPO_DATA('238013'),
		T_TIPO_DATA('252005'),
		T_TIPO_DATA('249563'),
		T_TIPO_DATA('251536'),
		T_TIPO_DATA('250596'),
		T_TIPO_DATA('251791'),
		T_TIPO_DATA('246303'),
		T_TIPO_DATA('237546'),
		T_TIPO_DATA('253483'),
		T_TIPO_DATA('234102'),
		T_TIPO_DATA('258127'),
		T_TIPO_DATA('252463'),
		T_TIPO_DATA('255414'),
		T_TIPO_DATA('214059'),
		T_TIPO_DATA('250823'),
		T_TIPO_DATA('253841'),
		T_TIPO_DATA('247562'),
		T_TIPO_DATA('238863'),
		T_TIPO_DATA('252834'),
		T_TIPO_DATA('249355'),
		T_TIPO_DATA('259812'),
		T_TIPO_DATA('250668'),
		T_TIPO_DATA('253871'),
		T_TIPO_DATA('228466'),
		T_TIPO_DATA('257866'),
		T_TIPO_DATA('233096'),
		T_TIPO_DATA('252895'),
		T_TIPO_DATA('253349'),
		T_TIPO_DATA('259518'),
		T_TIPO_DATA('256691'),
		T_TIPO_DATA('249920'),
		T_TIPO_DATA('251807'),
		T_TIPO_DATA('256292'),
		T_TIPO_DATA('256813'),
		T_TIPO_DATA('247842'),
		T_TIPO_DATA('258845'),
		T_TIPO_DATA('256564'),
		T_TIPO_DATA('255792'),
		T_TIPO_DATA('228143'),
		T_TIPO_DATA('259690'),
		T_TIPO_DATA('226582'),
		T_TIPO_DATA('211525'),
		T_TIPO_DATA('237255'),
		T_TIPO_DATA('251016'),
		T_TIPO_DATA('259221'),
		T_TIPO_DATA('259924'),
		T_TIPO_DATA('236066'),
		T_TIPO_DATA('252998'),
		T_TIPO_DATA('256773'),
		T_TIPO_DATA('258844'),
		T_TIPO_DATA('258629'),
		T_TIPO_DATA('255789'),
		T_TIPO_DATA('259791'),
		T_TIPO_DATA('254202'),
		T_TIPO_DATA('255183'),
		T_TIPO_DATA('238819'),
		T_TIPO_DATA('245313'),
		T_TIPO_DATA('253947'),
		T_TIPO_DATA('226152'),
		T_TIPO_DATA('220421'),
		T_TIPO_DATA('250626'),
		T_TIPO_DATA('259504'),
		T_TIPO_DATA('258431'),
		T_TIPO_DATA('246887'),
		T_TIPO_DATA('245818'),
		T_TIPO_DATA('220399'),
		T_TIPO_DATA('234106'),
		T_TIPO_DATA('259977'),
		T_TIPO_DATA('247403'),
		T_TIPO_DATA('251158'),
		T_TIPO_DATA('259688'),
		T_TIPO_DATA('256470'),
		T_TIPO_DATA('228400'),
		T_TIPO_DATA('253829'),
		T_TIPO_DATA('259172'),
		T_TIPO_DATA('258858'),
		T_TIPO_DATA('252664'),
		T_TIPO_DATA('258951'),
		T_TIPO_DATA('251360'),
		T_TIPO_DATA('253865'),
		T_TIPO_DATA('250506'),
		T_TIPO_DATA('244995'),
		T_TIPO_DATA('259943'),
		T_TIPO_DATA('259639'),
		T_TIPO_DATA('258887'),
		T_TIPO_DATA('237106'),
		T_TIPO_DATA('253695'),
		T_TIPO_DATA('259488'),
		T_TIPO_DATA('252318'),
		T_TIPO_DATA('251024'),
		T_TIPO_DATA('259241'),
		T_TIPO_DATA('259077'),
		T_TIPO_DATA('252840'),
		T_TIPO_DATA('254802'),
		T_TIPO_DATA('244754'),
		T_TIPO_DATA('229818'),
		T_TIPO_DATA('259389'),
		T_TIPO_DATA('254433'),
		T_TIPO_DATA('232953'),
		T_TIPO_DATA('259217'),
		T_TIPO_DATA('254629'),
		T_TIPO_DATA('247771'),
		T_TIPO_DATA('245169'),
		T_TIPO_DATA('253329'),
		T_TIPO_DATA('251197'),
		T_TIPO_DATA('252325'),
		T_TIPO_DATA('259694'),
		T_TIPO_DATA('259179'),
		T_TIPO_DATA('248702'),
		T_TIPO_DATA('239104'),
		T_TIPO_DATA('252199'),
		T_TIPO_DATA('237775'),
		T_TIPO_DATA('255239'),
		T_TIPO_DATA('255426'),
		T_TIPO_DATA('250975'),
		T_TIPO_DATA('258821'),
		T_TIPO_DATA('246641'),
		T_TIPO_DATA('253659'),
		T_TIPO_DATA('228646'),
		T_TIPO_DATA('255709'),
		T_TIPO_DATA('257611'),
		T_TIPO_DATA('229466'),
		T_TIPO_DATA('245155'),
		T_TIPO_DATA('259776'),
		T_TIPO_DATA('256567'),
		T_TIPO_DATA('258444'),
		T_TIPO_DATA('239162'),
		T_TIPO_DATA('249888'),
		T_TIPO_DATA('254787'),
		T_TIPO_DATA('254724'),
		T_TIPO_DATA('255206'),
		T_TIPO_DATA('239417'),
		T_TIPO_DATA('238019'),
		T_TIPO_DATA('236855'),
		T_TIPO_DATA('258625'),
		T_TIPO_DATA('232930'),
		T_TIPO_DATA('244982'),
		T_TIPO_DATA('228914'),
		T_TIPO_DATA('249128'),
		T_TIPO_DATA('256766'),
		T_TIPO_DATA('244968'),
		T_TIPO_DATA('255007'),
		T_TIPO_DATA('248280'),
		T_TIPO_DATA('222356'),
		T_TIPO_DATA('253054'),
		T_TIPO_DATA('251284'),
		T_TIPO_DATA('247509'),
		T_TIPO_DATA('259282'),
		T_TIPO_DATA('256308'),
		T_TIPO_DATA('217592'),
		T_TIPO_DATA('257744'),
		T_TIPO_DATA('256630'),
		T_TIPO_DATA('224887'),
		T_TIPO_DATA('237995'),
		T_TIPO_DATA('235488'),
		T_TIPO_DATA('247590'),
		T_TIPO_DATA('252933'),
		T_TIPO_DATA('252797'),
		T_TIPO_DATA('245151'),
		T_TIPO_DATA('258061'),
		T_TIPO_DATA('255446'),
		T_TIPO_DATA('249965'),
		T_TIPO_DATA('233386'),
		T_TIPO_DATA('251782'),
		T_TIPO_DATA('254284'),
		T_TIPO_DATA('246802'),
		T_TIPO_DATA('223661'),
		T_TIPO_DATA('256905'),
		T_TIPO_DATA('254551'),
		T_TIPO_DATA('250379'),
		T_TIPO_DATA('237949'),
		T_TIPO_DATA('256155'),
		T_TIPO_DATA('259438'),
		T_TIPO_DATA('219394'),
		T_TIPO_DATA('239133'),
		T_TIPO_DATA('256755'),
		T_TIPO_DATA('251041'),
		T_TIPO_DATA('257736'),
		T_TIPO_DATA('255926'),
		T_TIPO_DATA('256026'),
		T_TIPO_DATA('250537'),
		T_TIPO_DATA('249243'),
		T_TIPO_DATA('258077'),
		T_TIPO_DATA('232938'),
		T_TIPO_DATA('237326'),
		T_TIPO_DATA('251304'),
		T_TIPO_DATA('259493'),
		T_TIPO_DATA('235586'),
		T_TIPO_DATA('236728'),
		T_TIPO_DATA('226148'),
		T_TIPO_DATA('245334'),
		T_TIPO_DATA('252330'),
		T_TIPO_DATA('253040'),
		T_TIPO_DATA('258822'),
		T_TIPO_DATA('253402'),
		T_TIPO_DATA('254652'),
		T_TIPO_DATA('256761'),
		T_TIPO_DATA('247359'),
		T_TIPO_DATA('245160'),
		T_TIPO_DATA('252241'),
		T_TIPO_DATA('251349'),
		T_TIPO_DATA('255422'),
		T_TIPO_DATA('248370'),
		T_TIPO_DATA('247386'),
		T_TIPO_DATA('258222'),
		T_TIPO_DATA('255399'),
		T_TIPO_DATA('253642'),
		T_TIPO_DATA('253364'),
		T_TIPO_DATA('258659'),
		T_TIPO_DATA('254721'),
		T_TIPO_DATA('250861'),
		T_TIPO_DATA('238954'),
		T_TIPO_DATA('259233'),
		T_TIPO_DATA('256739'),
		T_TIPO_DATA('239065'),
		T_TIPO_DATA('226292'),
		T_TIPO_DATA('257284'),
		T_TIPO_DATA('248399'),
		T_TIPO_DATA('239071'),
		T_TIPO_DATA('253154'),
		T_TIPO_DATA('254100'),
		T_TIPO_DATA('259081'),
		T_TIPO_DATA('259050'),
		T_TIPO_DATA('259132'),
		T_TIPO_DATA('253883'),
		T_TIPO_DATA('249180'),
		T_TIPO_DATA('254089'),
		T_TIPO_DATA('258921'),
		T_TIPO_DATA('247535'),
		T_TIPO_DATA('259183'),
		T_TIPO_DATA('249288'),
		T_TIPO_DATA('233905'),
		T_TIPO_DATA('259284'),
		T_TIPO_DATA('211000'),
		T_TIPO_DATA('246606'),
		T_TIPO_DATA('227231'),
		T_TIPO_DATA('259871'),
		T_TIPO_DATA('245145'),
		T_TIPO_DATA('258989'),
		T_TIPO_DATA('251018'),
		T_TIPO_DATA('249846'),
		T_TIPO_DATA('251778'),
		T_TIPO_DATA('259750'),
		T_TIPO_DATA('246151'),
		T_TIPO_DATA('255125'),
		T_TIPO_DATA('259085'),
		T_TIPO_DATA('251494'),
		T_TIPO_DATA('245371'),
		T_TIPO_DATA('252568'),
		T_TIPO_DATA('249970'),
		T_TIPO_DATA('245171'),
		T_TIPO_DATA('255947'),
		T_TIPO_DATA('233410'),
		T_TIPO_DATA('256781'),
		T_TIPO_DATA('251163'),
		T_TIPO_DATA('253908'),
		T_TIPO_DATA('258961'),
		T_TIPO_DATA('248626'),
		T_TIPO_DATA('247863'),
		T_TIPO_DATA('253523'),
		T_TIPO_DATA('259917'),
		T_TIPO_DATA('250313'),
		T_TIPO_DATA('257889'),
		T_TIPO_DATA('259915'),
		T_TIPO_DATA('259930'),
		T_TIPO_DATA('251484'),
		T_TIPO_DATA('258943'),
		T_TIPO_DATA('251139'),
		T_TIPO_DATA('259101'),
		T_TIPO_DATA('249062'),
		T_TIPO_DATA('257754'),
		T_TIPO_DATA('256174'),
		T_TIPO_DATA('252188'),
		T_TIPO_DATA('253984'),
		T_TIPO_DATA('258724'),
		T_TIPO_DATA('234212'),
		T_TIPO_DATA('253000'),
		T_TIPO_DATA('254622'),
		T_TIPO_DATA('259954'),
		T_TIPO_DATA('255897'),
		T_TIPO_DATA('259693'),
		T_TIPO_DATA('252146'),
		T_TIPO_DATA('258825'),
		T_TIPO_DATA('234195'),
		T_TIPO_DATA('251233'),
		T_TIPO_DATA('247721'),
		T_TIPO_DATA('251997'),
		T_TIPO_DATA('254706'),
		T_TIPO_DATA('246974'),
		T_TIPO_DATA('224064'),
		T_TIPO_DATA('258935'),
		T_TIPO_DATA('258570'),
		T_TIPO_DATA('249112'),
		T_TIPO_DATA('259256'),
		T_TIPO_DATA('252585'),
		T_TIPO_DATA('252767'),
		T_TIPO_DATA('255689'),
		T_TIPO_DATA('251326'),
		T_TIPO_DATA('248740'),
		T_TIPO_DATA('256324'),
		T_TIPO_DATA('246924'),
		T_TIPO_DATA('255443'),
		T_TIPO_DATA('256294'),
		T_TIPO_DATA('252730'),
		T_TIPO_DATA('253067'),
		T_TIPO_DATA('259073'),
		T_TIPO_DATA('257638'),
		T_TIPO_DATA('237568'),
		T_TIPO_DATA('247481'),
		T_TIPO_DATA('258558'),
		T_TIPO_DATA('225843'),
		T_TIPO_DATA('225845'),
		T_TIPO_DATA('259024'),
		T_TIPO_DATA('249576'),
		T_TIPO_DATA('252427'),
		T_TIPO_DATA('249701'),
		T_TIPO_DATA('256520'),
		T_TIPO_DATA('251295'),
		T_TIPO_DATA('254648'),
		T_TIPO_DATA('253443'),
		T_TIPO_DATA('256283'),
		T_TIPO_DATA('253325'),
		T_TIPO_DATA('249108'),
		T_TIPO_DATA('252264'),
		T_TIPO_DATA('249510'),
		T_TIPO_DATA('247850'),
		T_TIPO_DATA('255122'),
		T_TIPO_DATA('255881'),
		T_TIPO_DATA('217971'),
		T_TIPO_DATA('259277'),
		T_TIPO_DATA('236050'),
		T_TIPO_DATA('249652'),
		T_TIPO_DATA('254784'),
		T_TIPO_DATA('251818'),
		T_TIPO_DATA('254919'),
		T_TIPO_DATA('259447'),
		T_TIPO_DATA('250989'),
		T_TIPO_DATA('258993'),
		T_TIPO_DATA('227091'),
		T_TIPO_DATA('235331'),
		T_TIPO_DATA('252909'),
		T_TIPO_DATA('259911'),
		T_TIPO_DATA('256522'),
		T_TIPO_DATA('249351'),
		T_TIPO_DATA('259882'),
		T_TIPO_DATA('245483'),
		T_TIPO_DATA('248349'),
		T_TIPO_DATA('250370'),
		T_TIPO_DATA('246267'),
		T_TIPO_DATA('254139'),
		T_TIPO_DATA('259208'),
		T_TIPO_DATA('222973'),
		T_TIPO_DATA('259681'),
		T_TIPO_DATA('256340')

		); 
    V_TMP_TIPO_DATA T_TIPO_DATA;

    
BEGIN		

	DBMS_OUTPUT.PUT_LINE('[INICIO]');

	V_MSQL:= 'SELECT USU_ID FROM '||V_ESQUEMA_M||'.USU_USUARIOS WHERE USU_USERNAME = ''diagonal01''';
	EXECUTE IMMEDIATE V_MSQL INTO V_USU_ID;

	V_MSQL:= 'SELECT DD_TGE_ID FROM '||V_ESQUEMA_M||'.DD_TGE_TIPO_GESTOR WHERE DD_TGE_CODIGO = ''GTOADM''';
	EXECUTE IMMEDIATE V_MSQL INTO V_TGE_ID;
	
	FOR I IN V_TIPO_DATA.FIRST .. V_TIPO_DATA.LAST
	LOOP
	V_TMP_TIPO_DATA := V_TIPO_DATA(I);

		V_MSQL:= 'SELECT COUNT(1) FROM '||V_ESQUEMA||'.ECO_EXPEDIENTE_COMERCIAL WHERE ECO_NUM_EXPEDIENTE = '||V_TMP_TIPO_DATA(1)||' AND BORRADO = 0';
		EXECUTE IMMEDIATE V_MSQL INTO V_COUNT;

		IF V_COUNT = 1 THEN

			V_MSQL:= 'SELECT ECO_ID FROM '||V_ESQUEMA||'.ECO_EXPEDIENTE_COMERCIAL WHERE ECO_NUM_EXPEDIENTE = '||V_TMP_TIPO_DATA(1)||'';
			EXECUTE IMMEDIATE V_MSQL INTO V_ECO_ID;

			V_MSQL:= 'INSERT INTO '||V_ESQUEMA||'.GEE_GESTOR_ENTIDAD (GEE_ID, USU_ID, DD_TGE_ID, USUARIOCREAR, FECHACREAR) VALUES (
				'||V_ESQUEMA||'.S_GEE_GESTOR_ENTIDAD.NEXTVAL,
				'||V_USU_ID||',
				'||V_TGE_ID||',
				'''||V_USU||''',
				SYSDATE
			)';
			EXECUTE IMMEDIATE V_MSQL;

			V_MSQL:= 'SELECT '||V_ESQUEMA||'.S_GEE_GESTOR_ENTIDAD.CURRVAL FROM DUAL';
			EXECUTE IMMEDIATE V_MSQL INTO V_GEE_ID;

			V_MSQL:= 'INSERT INTO '||V_ESQUEMA||'.GCO_GESTOR_ADD_ECO (GEE_ID, ECO_ID) VALUES (
				'||V_GEE_ID||',
				'||V_ECO_ID||'
			)';
			EXECUTE IMMEDIATE V_MSQL;

			V_MSQL:= 'INSERT INTO '||V_ESQUEMA||'.GEH_GESTOR_ENTIDAD_HIST (GEH_ID, USU_ID, DD_TGE_ID, GEH_FECHA_DESDE, USUARIOCREAR, FECHACREAR) VALUES (
				'||V_ESQUEMA||'.S_GEH_GESTOR_ENTIDAD_HIST.NEXTVAL,
				'||V_USU_ID||',
				'||V_TGE_ID||',
				TO_DATE(SYSDATE, ''DD/MM/YYYY''),
				'''||V_USU||''',
				SYSDATE
			)';
			EXECUTE IMMEDIATE V_MSQL;

			V_MSQL:= 'SELECT '||V_ESQUEMA||'.S_GEH_GESTOR_ENTIDAD_HIST.CURRVAL FROM DUAL';
			EXECUTE IMMEDIATE V_MSQL INTO V_GEH_ID;

			V_MSQL:= 'INSERT INTO '||V_ESQUEMA||'.GCH_GESTOR_ECO_HISTORICO (GEH_ID, ECO_ID) VALUES (
				'||V_GEH_ID||',
				'||V_ECO_ID||'
			)';
			EXECUTE IMMEDIATE V_MSQL;

			DBMS_OUTPUT.PUT_LINE('[INFO]: GESTOR INSERTADO EN EXPEDIENTE: '||V_TMP_TIPO_DATA(1)||'');

		ELSE

			DBMS_OUTPUT.PUT_LINE('[INFO]: NO EXISTE EL EXPEDIENTE: '||V_TMP_TIPO_DATA(1)||'');

		END IF;

	END LOOP;

	COMMIT;

	DBMS_OUTPUT.PUT_LINE('[FIN]');


EXCEPTION
		WHEN OTHERS THEN
			err_num := SQLCODE;
			err_msg := SQLERRM;

			DBMS_OUTPUT.put_line('[ERROR] Se ha producido un error en la ejecución:'||TO_CHAR(err_num));
			DBMS_OUTPUT.put_line('-----------------------------------------------------------'); 
			DBMS_OUTPUT.put_line(err_msg);

			ROLLBACK;
			RAISE;          

END;

/

EXIT