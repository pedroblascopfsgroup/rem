--/*
--######################################### 
--## AUTOR=Juan Bautista Alfonso
--## FECHA_CREACION=20210525
--## ARTEFACTO=batch
--## VERSION_ARTEFACTO=9.3
--## INCIDENCIA_LINK=REMVIP-9800
--## PRODUCTO=NO
--##            
--## INSTRUCCIONES:  Actualizar Fecha proxima revision publicaciones
--## VERSIONES:
--##        0.1 Versión inicial
--#########################################
--*/

--Para permitir la visualización de texto en un bloque PL/SQL utilizando DBMS_OUTPUT.PUT_LINE

WHENEVER SQLERROR EXIT SQL.SQLCODE;
SET SERVEROUTPUT ON; 
SET DEFINE OFF;

DECLARE
    V_MSQL VARCHAR2(32000 CHAR); -- Sentencia a ejecutar     
    V_ESQUEMA VARCHAR2(25 CHAR):= '#ESQUEMA#'; -- Configuracion Esquema
    V_ESQUEMA_M VARCHAR2(25 CHAR):= '#ESQUEMA_MASTER#'; -- Configuracion Esquema Master
    V_NUM_TABLAS NUMBER(16); -- Vble. para validar la existencia de una tabla.
    ERR_NUM NUMBER(25);  -- Vble. auxiliar para registrar errores en el script.
    ERR_MSG VARCHAR2(1024 CHAR); -- Vble. auxiliar para registrar errores en el script.
    V_USUARIO VARCHAR2(100 CHAR):='REMVIP-9800'; --Vble. auxiliar para almacenar el usuario
    V_TABLA VARCHAR2(100 CHAR) :='ACT_APU_ACTIVO_PUBLICACION'; --Vble. auxiliar para almacenar la tabla a insertar
    V_ID VARCHAR2(100 CHAR); --Vble para almacenar el id
    V_COUNT NUMBER(16):=0; --Vble. para contar registros correctos
    V_COUNT_TOTAL NUMBER(16):=0; --Vble para contar registros totales
    
    	TYPE T_TIPO_DATA IS TABLE OF VARCHAR2(32000 CHAR);
    	TYPE T_ARRAY_DATA IS TABLE OF T_TIPO_DATA;
    	V_TIPO_DATA T_ARRAY_DATA := T_ARRAY_DATA(
            --PVE_COD_REM   PVE_COD_REM->"pve_id_mediador_rel"
    		T_TIPO_DATA('5924934','10/06/2021'),
            T_TIPO_DATA('5925024','10/06/2021'),
            T_TIPO_DATA('5925666','10/06/2021'),
            T_TIPO_DATA('5926079','10/06/2021'),
            T_TIPO_DATA('5926118','10/06/2021'),
            T_TIPO_DATA('5927180','10/06/2021'),
            T_TIPO_DATA('5927395','10/06/2021'),
            T_TIPO_DATA('5927613','10/06/2021'),
            T_TIPO_DATA('5927949','10/06/2021'),
            T_TIPO_DATA('5928557','10/06/2021'),
            T_TIPO_DATA('5929320','10/06/2021'),
            T_TIPO_DATA('5929563','10/06/2021'),
            T_TIPO_DATA('5930081','10/06/2021'),
            T_TIPO_DATA('5930098','10/06/2021'),
            T_TIPO_DATA('5930388','10/06/2021'),
            T_TIPO_DATA('5930756','10/06/2021'),
            T_TIPO_DATA('5930892','10/06/2021'),
            T_TIPO_DATA('5931281','10/06/2021'),
            T_TIPO_DATA('5931364','10/06/2021'),
            T_TIPO_DATA('5931451','10/06/2021'),
            T_TIPO_DATA('5931574','10/06/2021'),
            T_TIPO_DATA('5931584','10/06/2021'),
            T_TIPO_DATA('5932578','10/06/2021'),
            T_TIPO_DATA('5932858','10/06/2021'),
            T_TIPO_DATA('5932907','10/06/2021'),
            T_TIPO_DATA('5933022','10/06/2021'),
            T_TIPO_DATA('5933149','10/06/2021'),
            T_TIPO_DATA('5934030','10/06/2021'),
            T_TIPO_DATA('5934083','10/06/2021'),
            T_TIPO_DATA('5934256','10/06/2021'),
            T_TIPO_DATA('5934355','10/06/2021'),
            T_TIPO_DATA('5934416','10/06/2021'),
            T_TIPO_DATA('5934920','10/06/2021'),
            T_TIPO_DATA('5935338','10/06/2021'),
            T_TIPO_DATA('5935644','10/06/2021'),
            T_TIPO_DATA('5935877','10/06/2021'),
            T_TIPO_DATA('5935893','10/06/2021'),
            T_TIPO_DATA('5936876','10/06/2021'),
            T_TIPO_DATA('5937036','10/06/2021'),
            T_TIPO_DATA('5937140','10/06/2021'),
            T_TIPO_DATA('5937553','10/06/2021'),
            T_TIPO_DATA('5937804','10/06/2021'),
            T_TIPO_DATA('5938028','10/06/2021'),
            T_TIPO_DATA('5938246','10/06/2021'),
            T_TIPO_DATA('5938298','10/06/2021'),
            T_TIPO_DATA('5938559','10/06/2021'),
            T_TIPO_DATA('5939343','10/06/2021'),
            T_TIPO_DATA('5939438','10/06/2021'),
            T_TIPO_DATA('5939821','10/06/2021'),
            T_TIPO_DATA('5940213','10/06/2021'),
            T_TIPO_DATA('5940237','10/06/2021'),
            T_TIPO_DATA('5940405','10/06/2021'),
            T_TIPO_DATA('5940726','10/06/2021'),
            T_TIPO_DATA('5940879','10/06/2021'),
            T_TIPO_DATA('5941333','10/06/2021'),
            T_TIPO_DATA('5941463','10/06/2021'),
            T_TIPO_DATA('5941850','10/06/2021'),
            T_TIPO_DATA('5942379','10/06/2021'),
            T_TIPO_DATA('5942611','10/06/2021'),
            T_TIPO_DATA('5942665','10/06/2021'),
            T_TIPO_DATA('5943002','10/06/2021'),
            T_TIPO_DATA('5943222','10/06/2021'),
            T_TIPO_DATA('5943425','10/06/2021'),
            T_TIPO_DATA('5944146','10/06/2021'),
            T_TIPO_DATA('5944249','10/06/2021'),
            T_TIPO_DATA('5944724','10/06/2021'),
            T_TIPO_DATA('5944993','10/06/2021'),
            T_TIPO_DATA('5946281','10/06/2021'),
            T_TIPO_DATA('5946673','10/06/2021'),
            T_TIPO_DATA('5946687','10/06/2021'),
            T_TIPO_DATA('5946953','10/06/2021'),
            T_TIPO_DATA('5947450','10/06/2021'),
            T_TIPO_DATA('5947570','10/06/2021'),
            T_TIPO_DATA('5947597','10/06/2021'),
            T_TIPO_DATA('5947836','10/06/2021'),
            T_TIPO_DATA('5948458','10/06/2021'),
            T_TIPO_DATA('5948555','10/06/2021'),
            T_TIPO_DATA('5948629','10/06/2021'),
            T_TIPO_DATA('5948982','10/06/2021'),
            T_TIPO_DATA('5949367','10/06/2021'),
            T_TIPO_DATA('5949925','10/06/2021'),
            T_TIPO_DATA('5950044','10/06/2021'),
            T_TIPO_DATA('5950079','10/06/2021'),
            T_TIPO_DATA('5950253','10/06/2021'),
            T_TIPO_DATA('5950324','10/06/2021'),
            T_TIPO_DATA('5950376','10/06/2021'),
            T_TIPO_DATA('5950476','10/06/2021'),
            T_TIPO_DATA('5950809','10/06/2021'),
            T_TIPO_DATA('5951278','10/06/2021'),
            T_TIPO_DATA('5951522','10/06/2021'),
            T_TIPO_DATA('5951530','10/06/2021'),
            T_TIPO_DATA('5951770','10/06/2021'),
            T_TIPO_DATA('5951915','10/06/2021'),
            T_TIPO_DATA('5952435','15/06/2021'),
            T_TIPO_DATA('5953765','15/06/2021'),
            T_TIPO_DATA('5953918','15/06/2021'),
            T_TIPO_DATA('5954674','15/06/2021'),
            T_TIPO_DATA('5954783','15/06/2021'),
            T_TIPO_DATA('5955807','15/06/2021'),
            T_TIPO_DATA('5956367','15/06/2021'),
            T_TIPO_DATA('5956703','15/06/2021'),
            T_TIPO_DATA('5956704','15/06/2021'),
            T_TIPO_DATA('5957466','15/06/2021'),
            T_TIPO_DATA('5958166','15/06/2021'),
            T_TIPO_DATA('5958292','15/06/2021'),
            T_TIPO_DATA('5958489','15/06/2021'),
            T_TIPO_DATA('5958553','15/06/2021'),
            T_TIPO_DATA('5958921','15/06/2021'),
            T_TIPO_DATA('5959132','15/06/2021'),
            T_TIPO_DATA('5959184','15/06/2021'),
            T_TIPO_DATA('5959520','15/06/2021'),
            T_TIPO_DATA('5959644','15/06/2021'),
            T_TIPO_DATA('5960109','15/06/2021'),
            T_TIPO_DATA('5960965','15/06/2021'),
            T_TIPO_DATA('5961232','15/06/2021'),
            T_TIPO_DATA('5961599','15/06/2021'),
            T_TIPO_DATA('5963361','15/06/2021'),
            T_TIPO_DATA('5963456','15/06/2021'),
            T_TIPO_DATA('5963490','15/06/2021'),
            T_TIPO_DATA('5963641','15/06/2021'),
            T_TIPO_DATA('5963773','15/06/2021'),
            T_TIPO_DATA('5963855','15/06/2021'),
            T_TIPO_DATA('5963860','15/06/2021'),
            T_TIPO_DATA('5964004','15/06/2021'),
            T_TIPO_DATA('5964256','15/06/2021'),
            T_TIPO_DATA('5964848','15/06/2021'),
            T_TIPO_DATA('5965103','15/06/2021'),
            T_TIPO_DATA('5965120','15/06/2021'),
            T_TIPO_DATA('5965267','15/06/2021'),
            T_TIPO_DATA('5965447','15/06/2021'),
            T_TIPO_DATA('5965459','15/06/2021'),
            T_TIPO_DATA('5965569','15/06/2021'),
            T_TIPO_DATA('5966632','15/06/2021'),
            T_TIPO_DATA('5967420','15/06/2021'),
            T_TIPO_DATA('5967507','15/06/2021'),
            T_TIPO_DATA('5967681','15/06/2021'),
            T_TIPO_DATA('5967827','15/06/2021'),
            T_TIPO_DATA('5967982','15/06/2021'),
            T_TIPO_DATA('5968113','15/06/2021'),
            T_TIPO_DATA('5968148','15/06/2021'),
            T_TIPO_DATA('5968265','15/06/2021'),
            T_TIPO_DATA('5969556','15/06/2021'),
            T_TIPO_DATA('5969790','15/06/2021'),
            T_TIPO_DATA('5969800','15/06/2021'),
            T_TIPO_DATA('5970001','15/06/2021'),
            T_TIPO_DATA('5970361','15/06/2021'),
            T_TIPO_DATA('5971445','15/06/2021'),
            T_TIPO_DATA('5971501','15/06/2021'),
            T_TIPO_DATA('5971675','15/06/2021'),
            T_TIPO_DATA('6044649','15/06/2021'),
            T_TIPO_DATA('6044974','15/06/2021'),
            T_TIPO_DATA('6045609','15/06/2021'),
            T_TIPO_DATA('6048623','15/06/2021'),
            T_TIPO_DATA('6048893','15/06/2021'),
            T_TIPO_DATA('6052726','15/06/2021'),
            T_TIPO_DATA('6052818','15/06/2021'),
            T_TIPO_DATA('6053229','15/06/2021'),
            T_TIPO_DATA('6053906','15/06/2021'),
            T_TIPO_DATA('6055430','15/06/2021'),
            T_TIPO_DATA('6055431','15/06/2021'),
            T_TIPO_DATA('6056946','15/06/2021'),
            T_TIPO_DATA('6057626','15/06/2021'),
            T_TIPO_DATA('6058327','15/06/2021'),
            T_TIPO_DATA('6058734','15/06/2021'),
            T_TIPO_DATA('6059897','15/06/2021'),
            T_TIPO_DATA('6059927','15/06/2021'),
            T_TIPO_DATA('6060189','15/06/2021'),
            T_TIPO_DATA('6061108','15/06/2021'),
            T_TIPO_DATA('6061664','15/06/2021'),
            T_TIPO_DATA('6061888','15/06/2021'),
            T_TIPO_DATA('6061903','15/06/2021'),
            T_TIPO_DATA('6062501','15/06/2021'),
            T_TIPO_DATA('6062604','15/06/2021'),
            T_TIPO_DATA('6063211','15/06/2021'),
            T_TIPO_DATA('6063228','15/06/2021'),
            T_TIPO_DATA('6063230','15/06/2021'),
            T_TIPO_DATA('6063483','15/06/2021'),
            T_TIPO_DATA('6064118','15/06/2021'),
            T_TIPO_DATA('6344554','15/06/2021'),
            T_TIPO_DATA('6351166','15/06/2021'),
            T_TIPO_DATA('6351844','15/06/2021'),
            T_TIPO_DATA('6523182','15/06/2021'),
            T_TIPO_DATA('6523251','15/06/2021'),
            T_TIPO_DATA('6707445','15/06/2021'),
            T_TIPO_DATA('6720682','15/06/2021'),
            T_TIPO_DATA('6756931','15/06/2021'),
            T_TIPO_DATA('6762948','15/06/2021'),
            T_TIPO_DATA('6764187','15/06/2021'),
            T_TIPO_DATA('6774262','15/06/2021'),
            T_TIPO_DATA('6786928','15/06/2021'),
            T_TIPO_DATA('6787741','15/06/2021'),
            T_TIPO_DATA('6788933','15/06/2021'),
            T_TIPO_DATA('6796986','15/06/2021'),
            T_TIPO_DATA('6803402','15/06/2021'),
            T_TIPO_DATA('6803446','15/06/2021'),
            T_TIPO_DATA('6809759','15/06/2021'),
            T_TIPO_DATA('6809760','15/06/2021'),
            T_TIPO_DATA('6809765','15/06/2021'),
            T_TIPO_DATA('6810515','15/06/2021'),
            T_TIPO_DATA('6813162','15/06/2021'),
            T_TIPO_DATA('6814528','15/06/2021'),
            T_TIPO_DATA('6814663','15/06/2021'),
            T_TIPO_DATA('6815812','15/06/2021'),
            T_TIPO_DATA('6824940','15/06/2021'),
            T_TIPO_DATA('6824941','15/06/2021'),
            T_TIPO_DATA('6830186','15/06/2021'),
            T_TIPO_DATA('6832613','15/06/2021'),
            T_TIPO_DATA('6832616','15/06/2021'),
            T_TIPO_DATA('6833609','15/06/2021'),
            T_TIPO_DATA('6837256','15/06/2021'),
            T_TIPO_DATA('6886216','15/06/2021'),
            T_TIPO_DATA('6886223','15/06/2021'),
            T_TIPO_DATA('6888731','15/06/2021'),
            T_TIPO_DATA('6889880','15/06/2021'),
            T_TIPO_DATA('6890991','15/06/2021'),
            T_TIPO_DATA('6934270','15/06/2021'),
            T_TIPO_DATA('6938913','15/06/2021'),
            T_TIPO_DATA('6938923','15/06/2021'),
            T_TIPO_DATA('6938977','15/06/2021'),
            T_TIPO_DATA('6938982','15/06/2021'),
            T_TIPO_DATA('6940100','15/06/2021'),
            T_TIPO_DATA('6940507','15/06/2021'),
            T_TIPO_DATA('6943718','15/06/2021'),
            T_TIPO_DATA('6943742','15/06/2021'),
            T_TIPO_DATA('6944464','15/06/2021'),
            T_TIPO_DATA('6950105','15/06/2021'),
            T_TIPO_DATA('6950321','15/06/2021'),
            T_TIPO_DATA('6950325','15/06/2021'),
            T_TIPO_DATA('6960218','15/06/2021'),
            T_TIPO_DATA('6961830','15/06/2021'),
            T_TIPO_DATA('6962283','15/06/2021'),
            T_TIPO_DATA('6965250','15/06/2021'),
            T_TIPO_DATA('6965679','15/06/2021'),
            T_TIPO_DATA('6965722','15/06/2021'),
            T_TIPO_DATA('6965735','15/06/2021'),
            T_TIPO_DATA('6965747','15/06/2021'),
            T_TIPO_DATA('6965774','15/06/2021'),
            T_TIPO_DATA('6965777','15/06/2021'),
            T_TIPO_DATA('6965801','15/06/2021'),
            T_TIPO_DATA('6965850','15/06/2021'),
            T_TIPO_DATA('6965922','15/06/2021'),
            T_TIPO_DATA('6965928','15/06/2021'),
            T_TIPO_DATA('6966764','15/06/2021'),
            T_TIPO_DATA('6966768','15/06/2021'),
            T_TIPO_DATA('6966776','15/06/2021'),
            T_TIPO_DATA('6966782','15/06/2021'),
            T_TIPO_DATA('6966796','15/06/2021'),
            T_TIPO_DATA('6966834','15/06/2021'),
            T_TIPO_DATA('6966863','15/06/2021'),
            T_TIPO_DATA('6966968','15/06/2021'),
            T_TIPO_DATA('6966985','15/06/2021'),
            T_TIPO_DATA('6967337','15/06/2021'),
            T_TIPO_DATA('6967343','15/06/2021'),
            T_TIPO_DATA('6967348','15/06/2021'),
            T_TIPO_DATA('6971933','15/06/2021'),
            T_TIPO_DATA('6972208','15/06/2021'),
            T_TIPO_DATA('6972465','15/06/2021'),
            T_TIPO_DATA('6972911','15/06/2021'),
            T_TIPO_DATA('6973280','15/06/2021'),
            T_TIPO_DATA('6973853','15/06/2021'),
            T_TIPO_DATA('6978788','15/06/2021'),
            T_TIPO_DATA('6978791','15/06/2021'),
            T_TIPO_DATA('6979369','15/06/2021'),
            T_TIPO_DATA('6979831','15/06/2021'),
            T_TIPO_DATA('6979843','15/06/2021'),
            T_TIPO_DATA('6979873','15/06/2021'),
            T_TIPO_DATA('6980095','15/06/2021'),
            T_TIPO_DATA('6980418','15/06/2021'),
            T_TIPO_DATA('6980521','15/06/2021'),
            T_TIPO_DATA('6980630','15/06/2021'),
            T_TIPO_DATA('6980693','15/06/2021'),
            T_TIPO_DATA('6980719','15/06/2021'),
            T_TIPO_DATA('6980891','15/06/2021'),
            T_TIPO_DATA('6981021','15/06/2021'),
            T_TIPO_DATA('6981040','15/06/2021'),
            T_TIPO_DATA('6981203','15/06/2021'),
            T_TIPO_DATA('6981206','15/06/2021'),
            T_TIPO_DATA('6981303','15/06/2021'),
            T_TIPO_DATA('6981387','15/06/2021'),
            T_TIPO_DATA('6981447','22/06/2021'),
            T_TIPO_DATA('6981529','22/06/2021'),
            T_TIPO_DATA('6981555','22/06/2021'),
            T_TIPO_DATA('6981581','22/06/2021'),
            T_TIPO_DATA('6981659','22/06/2021'),
            T_TIPO_DATA('6981686','22/06/2021'),
            T_TIPO_DATA('6981712','22/06/2021'),
            T_TIPO_DATA('6981942','22/06/2021'),
            T_TIPO_DATA('6982068','22/06/2021'),
            T_TIPO_DATA('6982144','22/06/2021'),
            T_TIPO_DATA('6982322','22/06/2021'),
            T_TIPO_DATA('6982323','22/06/2021'),
            T_TIPO_DATA('6982356','22/06/2021'),
            T_TIPO_DATA('6982548','22/06/2021'),
            T_TIPO_DATA('6982605','22/06/2021'),
            T_TIPO_DATA('6982738','22/06/2021'),
            T_TIPO_DATA('6982740','22/06/2021'),
            T_TIPO_DATA('6982911','22/06/2021'),
            T_TIPO_DATA('6982922','22/06/2021'),
            T_TIPO_DATA('6982951','22/06/2021'),
            T_TIPO_DATA('6982992','22/06/2021'),
            T_TIPO_DATA('6982993','22/06/2021'),
            T_TIPO_DATA('6983034','22/06/2021'),
            T_TIPO_DATA('6983081','22/06/2021'),
            T_TIPO_DATA('6983099','22/06/2021'),
            T_TIPO_DATA('6983490','22/06/2021'),
            T_TIPO_DATA('6983715','22/06/2021'),
            T_TIPO_DATA('6983776','22/06/2021'),
            T_TIPO_DATA('6983785','22/06/2021'),
            T_TIPO_DATA('6983802','22/06/2021'),
            T_TIPO_DATA('6983803','22/06/2021'),
            T_TIPO_DATA('6983804','22/06/2021'),
            T_TIPO_DATA('6983879','22/06/2021'),
            T_TIPO_DATA('6983886','22/06/2021'),
            T_TIPO_DATA('6983950','22/06/2021'),
            T_TIPO_DATA('6984195','22/06/2021'),
            T_TIPO_DATA('6984622','22/06/2021'),
            T_TIPO_DATA('6985037','22/06/2021'),
            T_TIPO_DATA('6985076','22/06/2021'),
            T_TIPO_DATA('6985232','22/06/2021'),
            T_TIPO_DATA('6985308','22/06/2021'),
            T_TIPO_DATA('6985324','22/06/2021'),
            T_TIPO_DATA('6985524','22/06/2021'),
            T_TIPO_DATA('6985705','22/06/2021'),
            T_TIPO_DATA('6986429','22/06/2021'),
            T_TIPO_DATA('6986430','22/06/2021'),
            T_TIPO_DATA('6986433','22/06/2021'),
            T_TIPO_DATA('6986508','22/06/2021'),
            T_TIPO_DATA('6986526','22/06/2021'),
            T_TIPO_DATA('6986742','22/06/2021'),
            T_TIPO_DATA('6986763','22/06/2021'),
            T_TIPO_DATA('6986924','22/06/2021'),
            T_TIPO_DATA('6986991','22/06/2021'),
            T_TIPO_DATA('6987409','22/06/2021'),
            T_TIPO_DATA('6987473','22/06/2021'),
            T_TIPO_DATA('6988182','22/06/2021'),
            T_TIPO_DATA('6988334','22/06/2021'),
            T_TIPO_DATA('6988496','22/06/2021'),
            T_TIPO_DATA('6988537','22/06/2021'),
            T_TIPO_DATA('6988775','22/06/2021'),
            T_TIPO_DATA('6988834','22/06/2021'),
            T_TIPO_DATA('6989058','22/06/2021'),
            T_TIPO_DATA('6989100','22/06/2021'),
            T_TIPO_DATA('6989281','22/06/2021'),
            T_TIPO_DATA('6989353','22/06/2021'),
            T_TIPO_DATA('6989668','22/06/2021'),
            T_TIPO_DATA('6989669','22/06/2021'),
            T_TIPO_DATA('6989751','22/06/2021'),
            T_TIPO_DATA('6989978','22/06/2021'),
            T_TIPO_DATA('6990048','22/06/2021'),
            T_TIPO_DATA('6990406','22/06/2021'),
            T_TIPO_DATA('6990407','22/06/2021'),
            T_TIPO_DATA('6991419','22/06/2021'),
            T_TIPO_DATA('6992073','22/06/2021'),
            T_TIPO_DATA('6992109','22/06/2021'),
            T_TIPO_DATA('6992365','22/06/2021'),
            T_TIPO_DATA('6992366','22/06/2021'),
            T_TIPO_DATA('6992390','22/06/2021'),
            T_TIPO_DATA('6992392','22/06/2021'),
            T_TIPO_DATA('6992518','22/06/2021'),
            T_TIPO_DATA('6992741','22/06/2021'),
            T_TIPO_DATA('6992959','22/06/2021'),
            T_TIPO_DATA('6993092','22/06/2021'),
            T_TIPO_DATA('6993346','22/06/2021'),
            T_TIPO_DATA('6993439','22/06/2021'),
            T_TIPO_DATA('6993440','22/06/2021'),
            T_TIPO_DATA('6993441','22/06/2021'),
            T_TIPO_DATA('6993534','22/06/2021'),
            T_TIPO_DATA('6993640','22/06/2021'),
            T_TIPO_DATA('6993673','01/07/2021'),
            T_TIPO_DATA('6993790','01/07/2021'),
            T_TIPO_DATA('6993858','01/07/2021'),
            T_TIPO_DATA('6994036','01/07/2021'),
            T_TIPO_DATA('6994958','01/07/2021'),
            T_TIPO_DATA('6995042','01/07/2021'),
            T_TIPO_DATA('6995074','01/07/2021'),
            T_TIPO_DATA('6995080','01/07/2021'),
            T_TIPO_DATA('6995181','01/07/2021'),
            T_TIPO_DATA('6995216','01/07/2021'),
            T_TIPO_DATA('6995665','01/07/2021'),
            T_TIPO_DATA('6995811','01/07/2021'),
            T_TIPO_DATA('6996287','01/07/2021'),
            T_TIPO_DATA('6996506','01/07/2021'),
            T_TIPO_DATA('6996562','01/07/2021'),
            T_TIPO_DATA('6996840','01/07/2021'),
            T_TIPO_DATA('6997137','01/07/2021'),
            T_TIPO_DATA('6997138','01/07/2021'),
            T_TIPO_DATA('6997139','01/07/2021'),
            T_TIPO_DATA('6997140','01/07/2021'),
            T_TIPO_DATA('6997141','01/07/2021'),
            T_TIPO_DATA('6997142','01/07/2021'),
            T_TIPO_DATA('6997143','01/07/2021'),
            T_TIPO_DATA('6997161','01/07/2021'),
            T_TIPO_DATA('6997168','01/07/2021'),
            T_TIPO_DATA('6997254','01/07/2021'),
            T_TIPO_DATA('6997856','01/07/2021'),
            T_TIPO_DATA('6998114','01/07/2021'),
            T_TIPO_DATA('6998585','01/07/2021'),
            T_TIPO_DATA('6998615','01/07/2021'),
            T_TIPO_DATA('6998651','01/07/2021'),
            T_TIPO_DATA('6998652','01/07/2021'),
            T_TIPO_DATA('6999195','01/07/2021'),
            T_TIPO_DATA('7000283','01/07/2021'),
            T_TIPO_DATA('7000867','01/07/2021'),
            T_TIPO_DATA('7000915','01/07/2021'),
            T_TIPO_DATA('7001336','01/07/2021'),
            T_TIPO_DATA('7001733','01/07/2021'),
            T_TIPO_DATA('7001876','01/07/2021'),
            T_TIPO_DATA('7002145','01/07/2021'),
            T_TIPO_DATA('7002279','01/07/2021'),
            T_TIPO_DATA('7002347','01/07/2021'),
            T_TIPO_DATA('7002384','01/07/2021'),
            T_TIPO_DATA('7002771','01/07/2021'),
            T_TIPO_DATA('7004068','01/07/2021'),
            T_TIPO_DATA('7004076','01/07/2021'),
            T_TIPO_DATA('7004803','01/07/2021'),
            T_TIPO_DATA('7004805','01/07/2021'),
            T_TIPO_DATA('7005349','01/07/2021'),
            T_TIPO_DATA('7005849','01/07/2021'),
            T_TIPO_DATA('7007920','01/07/2021'),
            T_TIPO_DATA('7030045','01/07/2021'),
            T_TIPO_DATA('7030676','01/07/2021'),
            T_TIPO_DATA('7030684','01/07/2021'),
            T_TIPO_DATA('7031585','01/07/2021'),
            T_TIPO_DATA('7032199','01/07/2021'),
            T_TIPO_DATA('7069196','01/07/2021'),
            T_TIPO_DATA('7070943','01/07/2021'),
            T_TIPO_DATA('7070958','01/07/2021'),
            T_TIPO_DATA('7071446','01/07/2021'),
            T_TIPO_DATA('7072661','01/07/2021'),
            T_TIPO_DATA('7073174','01/07/2021'),
            T_TIPO_DATA('7074209','01/07/2021'),
            T_TIPO_DATA('7074210','01/07/2021'),
            T_TIPO_DATA('7074287','01/07/2021'),
            T_TIPO_DATA('7074342','01/07/2021'),
            T_TIPO_DATA('7074343','01/07/2021'),
            T_TIPO_DATA('7074351','01/07/2021'),
            T_TIPO_DATA('7074352','01/07/2021'),
            T_TIPO_DATA('7074353','01/07/2021'),
            T_TIPO_DATA('7074391','01/07/2021'),
            T_TIPO_DATA('7074448','01/07/2021'),
            T_TIPO_DATA('7075367','01/07/2021'),
            T_TIPO_DATA('7075373','01/07/2021'),
            T_TIPO_DATA('7075376','01/07/2021'),
            T_TIPO_DATA('7075378','01/07/2021'),
            T_TIPO_DATA('7075386','01/07/2021'),
            T_TIPO_DATA('7075488','01/07/2021'),
            T_TIPO_DATA('7075508','01/07/2021'),
            T_TIPO_DATA('7075936','01/07/2021'),
            T_TIPO_DATA('7076066','01/07/2021'),
            T_TIPO_DATA('7088784','01/07/2021'),
            T_TIPO_DATA('7089470','01/07/2021'),
            T_TIPO_DATA('7089472','01/07/2021'),
            T_TIPO_DATA('7089473','01/07/2021'),
            T_TIPO_DATA('7090517','01/07/2021'),
            T_TIPO_DATA('7090524','01/07/2021'),
            T_TIPO_DATA('7091123','01/07/2021'),
            T_TIPO_DATA('7092291','01/07/2021'),
            T_TIPO_DATA('7092334','01/07/2021'),
            T_TIPO_DATA('7092559','01/07/2021'),
            T_TIPO_DATA('7093416','01/07/2021'),
            T_TIPO_DATA('7094452','01/07/2021'),
            T_TIPO_DATA('7094499','01/07/2021'),
            T_TIPO_DATA('7095160','01/07/2021'),
            T_TIPO_DATA('7095507','01/07/2021'),
            T_TIPO_DATA('7095574','01/07/2021'),
            T_TIPO_DATA('7096212','01/07/2021'),
            T_TIPO_DATA('7096355','01/07/2021'),
            T_TIPO_DATA('7096491','01/07/2021'),
            T_TIPO_DATA('7097513','01/07/2021'),
            T_TIPO_DATA('7098319','01/07/2021'),
            T_TIPO_DATA('7098447','01/07/2021'),
            T_TIPO_DATA('7098539','01/07/2021'),
            T_TIPO_DATA('7099233','01/07/2021'),
            T_TIPO_DATA('7099353','01/07/2021'),
            T_TIPO_DATA('7099426','01/07/2021'),
            T_TIPO_DATA('7099429','01/07/2021'),
            T_TIPO_DATA('7099457','01/07/2021'),
            T_TIPO_DATA('7099461','01/07/2021'),
            T_TIPO_DATA('7099466','01/07/2021'),
            T_TIPO_DATA('7099505','01/07/2021'),
            T_TIPO_DATA('7099535','01/07/2021'),
            T_TIPO_DATA('7099663','01/07/2021'),
            T_TIPO_DATA('7099683','01/07/2021'),
            T_TIPO_DATA('7099776','01/07/2021'),
            T_TIPO_DATA('7099778','01/07/2021'),
            T_TIPO_DATA('7099804','01/07/2021'),
            T_TIPO_DATA('7099846','01/07/2021'),
            T_TIPO_DATA('7099927','01/07/2021'),
            T_TIPO_DATA('7099928','01/07/2021'),
            T_TIPO_DATA('7099934','01/07/2021'),
            T_TIPO_DATA('7101253','01/07/2021'),
            T_TIPO_DATA('7101261','01/07/2021'),
            T_TIPO_DATA('7101308','01/07/2021'),
            T_TIPO_DATA('7101385','01/07/2021'),
            T_TIPO_DATA('7101386','01/07/2021'),
            T_TIPO_DATA('7101388','01/07/2021'),
            T_TIPO_DATA('7101391','01/07/2021'),
            T_TIPO_DATA('7101398','01/07/2021'),
            T_TIPO_DATA('7101549','01/07/2021'),
            T_TIPO_DATA('7101588','01/07/2021'),
            T_TIPO_DATA('7101606','01/07/2021'),
            T_TIPO_DATA('7101608','01/07/2021'),
            T_TIPO_DATA('7225483','01/07/2021'),
            T_TIPO_DATA('7225817','01/07/2021'),
            T_TIPO_DATA('7226025','01/07/2021'),
            T_TIPO_DATA('7226027','01/07/2021'),
            T_TIPO_DATA('7226033','01/07/2021'),
            T_TIPO_DATA('7226040','01/07/2021'),
            T_TIPO_DATA('7226049','01/07/2021'),
            T_TIPO_DATA('7226170','01/07/2021'),
            T_TIPO_DATA('7226171','01/07/2021'),
            T_TIPO_DATA('7226904','01/07/2021'),
            T_TIPO_DATA('7226919','11/07/2021'),
            T_TIPO_DATA('7226980','11/07/2021'),
            T_TIPO_DATA('7228967','11/07/2021'),
            T_TIPO_DATA('7229261','11/07/2021'),
            T_TIPO_DATA('7229290','11/07/2021'),
            T_TIPO_DATA('7229351','11/07/2021'),
            T_TIPO_DATA('7229673','11/07/2021'),
            T_TIPO_DATA('7229674','11/07/2021'),
            T_TIPO_DATA('7229678','11/07/2021'),
            T_TIPO_DATA('7229680','11/07/2021'),
            T_TIPO_DATA('7292650','11/07/2021'),
            T_TIPO_DATA('7292769','11/07/2021'),
            T_TIPO_DATA('7292770','11/07/2021'),
            T_TIPO_DATA('7292825','11/07/2021'),
            T_TIPO_DATA('7294202','11/07/2021'),
            T_TIPO_DATA('7294276','11/07/2021'),
            T_TIPO_DATA('7294369','11/07/2021'),
            T_TIPO_DATA('7294375','11/07/2021'),
            T_TIPO_DATA('7294384','11/07/2021'),
            T_TIPO_DATA('7294394','11/07/2021'),
            T_TIPO_DATA('7294395','11/07/2021'),
            T_TIPO_DATA('7294397','11/07/2021'),
            T_TIPO_DATA('7294402','11/07/2021'),
            T_TIPO_DATA('7294404','11/07/2021'),
            T_TIPO_DATA('7294406','11/07/2021'),
            T_TIPO_DATA('7294422','11/07/2021'),
            T_TIPO_DATA('7294439','11/07/2021'),
            T_TIPO_DATA('7294440','11/07/2021'),
            T_TIPO_DATA('7294641','11/07/2021'),
            T_TIPO_DATA('7294644','11/07/2021'),
            T_TIPO_DATA('7294799','11/07/2021'),
            T_TIPO_DATA('7294801','11/07/2021'),
            T_TIPO_DATA('7294803','11/07/2021'),
            T_TIPO_DATA('7294878','11/07/2021'),
            T_TIPO_DATA('7295089','11/07/2021'),
            T_TIPO_DATA('7295147','11/07/2021'),
            T_TIPO_DATA('7295508','11/07/2021'),
            T_TIPO_DATA('7295532','11/07/2021'),
            T_TIPO_DATA('7295540','11/07/2021'),
            T_TIPO_DATA('7295735','11/07/2021'),
            T_TIPO_DATA('7295795','11/07/2021'),
            T_TIPO_DATA('7295821','11/07/2021'),
            T_TIPO_DATA('7295860','11/07/2021'),
            T_TIPO_DATA('7295865','11/07/2021'),
            T_TIPO_DATA('7295945','11/07/2021'),
            T_TIPO_DATA('7295979','11/07/2021'),
            T_TIPO_DATA('7296115','11/07/2021'),
            T_TIPO_DATA('7296248','11/07/2021'),
            T_TIPO_DATA('7296364','11/07/2021'),
            T_TIPO_DATA('7296366','11/07/2021'),
            T_TIPO_DATA('7296514','11/07/2021'),
            T_TIPO_DATA('7296529','11/07/2021'),
            T_TIPO_DATA('7296535','11/07/2021'),
            T_TIPO_DATA('7296580','11/07/2021'),
            T_TIPO_DATA('7296620','11/07/2021'),
            T_TIPO_DATA('7296796','11/07/2021'),
            T_TIPO_DATA('7296866','11/07/2021'),
            T_TIPO_DATA('7296983','11/07/2021'),
            T_TIPO_DATA('7296984','11/07/2021'),
            T_TIPO_DATA('7297004','11/07/2021'),
            T_TIPO_DATA('7297031','11/07/2021'),
            T_TIPO_DATA('7297060','11/07/2021'),
            T_TIPO_DATA('7297137','11/07/2021'),
            T_TIPO_DATA('7297145','11/07/2021'),
            T_TIPO_DATA('7297167','11/07/2021'),
            T_TIPO_DATA('7297374','11/07/2021'),
            T_TIPO_DATA('7297451','11/07/2021'),
            T_TIPO_DATA('7297890','11/07/2021'),
            T_TIPO_DATA('7298452','11/07/2021'),
            T_TIPO_DATA('7298753','11/07/2021'),
            T_TIPO_DATA('7298863','11/07/2021'),
            T_TIPO_DATA('7298864','11/07/2021'),
            T_TIPO_DATA('7299071','11/07/2021'),
            T_TIPO_DATA('7299216','11/07/2021'),
            T_TIPO_DATA('7299371','11/07/2021'),
            T_TIPO_DATA('7299640','11/07/2021'),
            T_TIPO_DATA('7299655','11/07/2021'),
            T_TIPO_DATA('7299657','11/07/2021'),
            T_TIPO_DATA('7299682','11/07/2021'),
            T_TIPO_DATA('7300348','11/07/2021'),
            T_TIPO_DATA('7300349','11/07/2021'),
            T_TIPO_DATA('7300538','11/07/2021'),
            T_TIPO_DATA('7300585','11/07/2021'),
            T_TIPO_DATA('7302058','11/07/2021'),
            T_TIPO_DATA('7302182','11/07/2021'),
            T_TIPO_DATA('7302222','11/07/2021'),
            T_TIPO_DATA('7303342','11/07/2021'),
            T_TIPO_DATA('7303352','11/07/2021'),
            T_TIPO_DATA('7303576','11/07/2021'),
            T_TIPO_DATA('7327707','11/07/2021'),
            T_TIPO_DATA('7328463','11/07/2021'),
            T_TIPO_DATA('7328479','11/07/2021'),
            T_TIPO_DATA('7386539','11/07/2021'),
            T_TIPO_DATA('7386632','11/07/2021'),
            T_TIPO_DATA('7386646','11/07/2021'),
            T_TIPO_DATA('7387125','11/07/2021'),
            T_TIPO_DATA('7387131','11/07/2021'),
            T_TIPO_DATA('7397403','11/07/2021'),
            T_TIPO_DATA('7397418','11/07/2021'),
            T_TIPO_DATA('7403029','11/07/2021'),
            T_TIPO_DATA('7403038','11/07/2021'),
            T_TIPO_DATA('7403040','11/07/2021'),
            T_TIPO_DATA('7403126','11/07/2021'),
            T_TIPO_DATA('7403134','11/07/2021'),
            T_TIPO_DATA('7403141','11/07/2021'),
            T_TIPO_DATA('7403145','11/07/2021'),
            T_TIPO_DATA('7403146','11/07/2021'),
            T_TIPO_DATA('7403196','11/07/2021'),
            T_TIPO_DATA('7403445','11/07/2021'),
            T_TIPO_DATA('7423204','11/07/2021'),
            T_TIPO_DATA('7423209','11/07/2021'),
            T_TIPO_DATA('7423556','11/07/2021'),
            T_TIPO_DATA('7423570','11/07/2021'),
            T_TIPO_DATA('7423732','11/07/2021'),
            T_TIPO_DATA('7424180','11/07/2021'),
            T_TIPO_DATA('7424266','11/07/2021'),
            T_TIPO_DATA('7431668','11/07/2021'),
            T_TIPO_DATA('7431674','11/07/2021'),
            T_TIPO_DATA('7431906','19/07/2021'),
            T_TIPO_DATA('7432053','19/07/2021'),
            T_TIPO_DATA('7432086','19/07/2021'),
            T_TIPO_DATA('7432237','19/07/2021'),
            T_TIPO_DATA('7432244','19/07/2021'),
            T_TIPO_DATA('7432246','19/07/2021'),
            T_TIPO_DATA('7432625','19/07/2021'),
            T_TIPO_DATA('7433691','19/07/2021'),
            T_TIPO_DATA('7434885','19/07/2021')

    	); 
    	V_TMP_TIPO_DATA T_TIPO_DATA;


BEGIN	
	
    DBMS_OUTPUT.PUT_LINE('[INICIO] ');

    DBMS_OUTPUT.PUT_LINE('[INFO]: ACTUALIZAR EN '||V_TABLA);

    FOR I IN V_TIPO_DATA.FIRST .. V_TIPO_DATA.LAST
	    LOOP
		V_TMP_TIPO_DATA := V_TIPO_DATA(I);

        V_COUNT_TOTAL:=V_COUNT_TOTAL+1;
        
        --Comprobamos si existe el proveedor relacionado "API" con el cod rem indicado:
        V_MSQL := 'SELECT COUNT(1) FROM '||V_ESQUEMA||'.ACT_ACTIVO ACT
                    JOIN '||V_ESQUEMA||'.'||V_TABLA||' APU ON APU.ACT_ID = ACT.ACT_ID AND APU.BORRADO = 0
                    WHERE ACT.BORRADO = 0 AND ACT.ACT_NUM_ACTIVO ='||V_TMP_TIPO_DATA(1)||' ';
        EXECUTE IMMEDIATE V_MSQL INTO V_NUM_TABLAS;


        IF V_NUM_TABLAS > 0 THEN
        
            --Obtenemos el id del proveedor a relacionar "API"
            V_MSQL := 'SELECT APU.APU_ID FROM '||V_ESQUEMA||'.ACT_ACTIVO ACT
                        JOIN '||V_ESQUEMA||'.'||V_TABLA||' APU ON APU.ACT_ID = ACT.ACT_ID AND APU.BORRADO = 0
                        WHERE ACT.BORRADO = 0 AND ACT.ACT_NUM_ACTIVO ='||V_TMP_TIPO_DATA(1)||' ';
            EXECUTE IMMEDIATE V_MSQL INTO V_ID;

            --Actualizamos proveedor "OFICINA"
            V_MSQL :='UPDATE '||V_ESQUEMA||'.'||V_TABLA||' SET 
                        APU_FECHA_REVISION_PUB_VENTA=TO_DATE('''||V_TMP_TIPO_DATA(2)||''',''DD/MM/YYYY''),
                        USUARIOMODIFICAR = '''||V_USUARIO||''',
                        FECHAMODIFICAR = SYSDATE                            
                        WHERE APU_ID='||V_ID||'';
            EXECUTE IMMEDIATE V_MSQL;
            V_COUNT:=V_COUNT+1;    

            DBMS_OUTPUT.PUT_LINE('[INFO]: Se ha modificado el ACTIVO: '''||V_TMP_TIPO_DATA(1)||''' ');

        ELSE
            --Si no existe el proveedor "API"
            DBMS_OUTPUT.PUT_LINE('[INFO]: NO EXISTE EL ACTIVO CON ACT_NUM_ACTIVO: '''||V_TMP_TIPO_DATA(1)||''' ');
        END IF;      	
    END LOOP;

    
    COMMIT;


    DBMS_OUTPUT.PUT_LINE('[FIN]: '''||V_COUNT||''' ACTIVOS MODIFICADOS CORRECTAMENTE DE '''||V_COUNT_TOTAL||''' ');
    
EXCEPTION
     WHEN OTHERS THEN
          ERR_NUM := SQLCODE;
          ERR_MSG := SQLERRM;

          DBMS_OUTPUT.put_line('[ERROR] Se ha producido un error en la ejecución:'||TO_CHAR(ERR_NUM));
          DBMS_OUTPUT.put_line('-----------------------------------------------------------'); 
          DBMS_OUTPUT.put_line(ERR_MSG);

          ROLLBACK;
          RAISE;          

END;
/
EXIT