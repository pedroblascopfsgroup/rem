--/*
--##########################################
--## AUTOR=Juan Bautista Alfonso
--## FECHA_CREACION=20210712
--## ARTEFACTO=online
--## VERSION_ARTEFACTO=9.3
--## INCIDENCIA_LINK=REMVIP-10143
--## PRODUCTO=NO
--##
--## Finalidad: Script cambia el subtipo de las líneas de detalle
--## INSTRUCCIONES:
--## VERSIONES:
--##        0.1 Versión inicial
--##########################################
--*/

WHENEVER SQLERROR EXIT SQL.SQLCODE;
SET SERVEROUTPUT ON; 
SET DEFINE OFF;


DECLARE

    V_MSQL VARCHAR2(32000 CHAR); -- Sentencia a ejecutar.
    V_ESQUEMA VARCHAR2(25 CHAR):= '#ESQUEMA#'; -- Configuracion Esquema.
    V_ESQUEMA_M VARCHAR2(25 CHAR):= '#ESQUEMA_MASTER#'; -- Configuracion Esquema Master.
    V_SQL VARCHAR2(4000 CHAR); -- Vble. para consulta que valida la existencia de una tabla.
    V_NUM_TABLAS NUMBER(16); -- Vble. para validar la existencia de una tabla.
    ERR_NUM NUMBER(25);  -- Vble. auxiliar para registrar errores en el script.
    ERR_MSG VARCHAR2(1024 CHAR); -- Vble. auxiliar para registrar errores en el script.
    V_NUM_SEQUENCE NUMBER(16); -- Vble. auxiliar para almacenar el número de secuencia actual.
    V_NUM NUMBER(16); -- Vble. auxiliar para almacenar el número de registros
    V_COUNT NUMBER(16):= 0; -- Vble. para contar inserts
    V_TEXT_TABLA VARCHAR2(27 CHAR) := 'GLD_GASTOS_LINEA_DETALLE'; -- Vble. auxiliar para almacenar el nombre de la tabla de ref.
    V_USU VARCHAR2(30 CHAR) := 'REMVIP-10143'; -- Vble. auxiliar para almacenar el nombre de usuario que modifica los registros.
	V_GPV_ID NUMBER(16);
	V_COUNT_REGISTRO NUMBER(16):=0;
    V_COUNT_TOTAL NUMBER(16):=0;

    TYPE T_TIPO_DATA IS TABLE OF VARCHAR2(1024);
    TYPE T_ARRAY_DATA IS TABLE OF T_TIPO_DATA;

    V_TIPO_DATA T_ARRAY_DATA := T_ARRAY_DATA(
    --	gpv_num_gasto_haya  CONCEPTO_CONTABLE   CUENTA_CONTABLE_RECARGO     CUENTA_CONTABLE_INTERESES   CUENTA_CONTABLE_TASAS
	T_TIPO_DATA('14027279','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14027280','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14027281','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14027282','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14027283','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14027284','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14027285','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14027286','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14027287','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14027288','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14027289','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14027290','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14027291','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14027292','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14027293','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14054011','Z39','Z46','Z48','NULL'),
    T_TIPO_DATA('14054012','Z39','Z46','Z48','NULL'),
    T_TIPO_DATA('14054013','Z39','Z46','Z48','NULL'),
    T_TIPO_DATA('14054014','Z39','Z46','Z48','NULL'),
    T_TIPO_DATA('14054015','Z39','Z46','Z48','NULL'),
    T_TIPO_DATA('14054016','Z39','Z46','Z48','NULL'),
    T_TIPO_DATA('14054017','Z39','Z46','Z48','NULL'),
    T_TIPO_DATA('14054018','Z39','Z46','Z48','NULL'),
    T_TIPO_DATA('14054019','Z39','Z46','Z48','NULL'),
    T_TIPO_DATA('14054020','Z39','Z46','Z48','NULL'),
    T_TIPO_DATA('14054021','Z39','Z46','Z48','NULL'),
    T_TIPO_DATA('14054022','Z39','Z46','Z48','NULL'),
    T_TIPO_DATA('14054023','Z39','Z46','Z48','NULL'),
    T_TIPO_DATA('14054024','Z39','Z46','Z48','NULL'),
    T_TIPO_DATA('14055316','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14055319','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14056906','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14056907','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14056908','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14056909','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14068079','Z39','Z46','Z48','Z52'),
    T_TIPO_DATA('14079220','Z39','Z46','Z48','Z52'),
    T_TIPO_DATA('14079221','Z39','Z46','Z48','Z52'),
    T_TIPO_DATA('14079383','Z39','Z46','Z48','Z52'),
    T_TIPO_DATA('14082987','Z36','NULL','NULL','NULL'),
    T_TIPO_DATA('14093155','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14095873','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14095878','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14095882','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14095883','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14095884','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14095891','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14095892','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14095893','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14095894','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14095895','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14095896','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14095897','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14095898','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14095899','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14095900','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14095901','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14095902','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14095903','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14095904','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14095905','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14095906','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14095907','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14095908','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14095909','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14095910','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14095911','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14095912','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14095996','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14095997','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14095998','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14096005','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14096008','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14096009','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14096010','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14096011','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14096012','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14096013','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14096014','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14096016','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14096017','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14096020','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14096021','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14096022','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14096023','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14096024','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14096025','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14096049','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14096050','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14096052','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14096053','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14096055','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14096056','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14096058','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14096059','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14096061','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14096062','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14096064','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14096065','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14096067','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14096068','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14096070','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096071','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096072','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096073','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096074','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096075','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096087','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14096091','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14096092','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14096093','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14096096','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14096097','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14096098','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14096099','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14096100','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14096101','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14096102','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14096103','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14096104','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14096105','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14096106','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14096107','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14096109','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096110','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096111','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096112','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096113','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096114','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096115','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096116','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096117','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096118','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096119','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096120','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096121','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096122','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096123','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096124','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096125','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096126','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096127','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096128','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096129','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096130','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096131','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096132','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096133','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096134','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096135','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096136','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096137','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096138','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096139','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096140','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096141','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096142','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096143','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096144','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096145','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096146','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096147','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096148','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096149','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096150','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096151','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096152','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096153','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096154','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096155','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096156','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096157','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096158','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096159','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096160','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096161','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096162','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096163','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096164','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096165','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096166','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096167','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096168','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096169','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096170','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096171','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096172','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096173','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096174','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096175','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096176','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096177','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096178','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096179','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096180','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096206','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096210','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096211','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096212','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096213','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096214','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096215','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096216','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096222','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096223','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096224','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096225','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096226','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14096227','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14096228','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14096237','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14096238','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14096239','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14096240','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14096241','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14096242','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14096243','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14096244','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14096247','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14096248','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14096249','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14096250','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14096251','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14096252','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14096253','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14096254','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14096260','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14096261','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14096262','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14096268','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14096269','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14096270','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14096271','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14096276','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14096277','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14096278','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14096279','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14096280','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14096281','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14096284','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14096285','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14096286','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14096287','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14096288','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14096289','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14096290','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14096291','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14096292','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14096293','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14096294','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14096295','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14096296','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14096297','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14096298','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14096299','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14096300','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096301','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096302','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096303','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096304','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096305','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096306','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096307','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096308','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096309','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096310','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096311','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096312','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096313','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096314','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096315','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096316','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096317','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096321','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096322','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096323','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096324','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096325','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096326','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096327','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096328','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096331','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096332','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096333','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096334','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096340','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096341','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096342','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096343','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096344','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096345','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14096346','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14097303','Z39','Z46','Z48','Z52'),
    T_TIPO_DATA('14097348','Z39','Z46','Z48','Z52'),
    T_TIPO_DATA('14099521','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14099522','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14099523','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14106077','Z39','Z46','Z48','NULL'),
    T_TIPO_DATA('14110350','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14110351','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14110352','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14110353','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14110354','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14113660','Z39','Z46','Z48','NULL'),
    T_TIPO_DATA('14113661','Z39','Z46','Z48','NULL'),
    T_TIPO_DATA('14113662','Z39','Z46','Z48','NULL'),
    T_TIPO_DATA('14115738','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14115884','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14115939','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14115953','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14116483','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14117184','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14117185','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14117186','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14117194','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14117213','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14149321','Z39','Z46','Z48','NULL'),
    T_TIPO_DATA('14149322','Z39','Z46','Z48','NULL'),
    T_TIPO_DATA('14149324','Z39','Z46','Z48','NULL'),
    T_TIPO_DATA('14149325','Z39','Z46','Z48','NULL'),
    T_TIPO_DATA('14149326','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14149327','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14149328','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14149329','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14149330','Z39','Z46','Z48','NULL'),
    T_TIPO_DATA('14149331','Z39','Z46','Z48','NULL'),
    T_TIPO_DATA('14149332','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14149333','Z39','Z46','Z48','NULL'),
    T_TIPO_DATA('14149334','Z39','Z46','Z48','NULL'),
    T_TIPO_DATA('14149337','Z39','Z46','Z48','NULL'),
    T_TIPO_DATA('14149339','Z39','Z46','Z48','NULL'),
    T_TIPO_DATA('14149340','Z39','Z46','Z48','NULL'),
    T_TIPO_DATA('14149341','Z39','Z46','Z48','NULL'),
    T_TIPO_DATA('14149342','Z39','Z46','Z48','NULL'),
    T_TIPO_DATA('14149343','Z39','Z46','Z48','NULL'),
    T_TIPO_DATA('14149344','Z39','Z46','Z48','NULL'),
    T_TIPO_DATA('14149348','Z39','Z46','Z48','NULL'),
    T_TIPO_DATA('14149349','Z39','Z46','Z48','NULL'),
    T_TIPO_DATA('14149350','Z39','Z46','Z48','NULL'),
    T_TIPO_DATA('14149351','Z39','Z46','Z48','NULL'),
    T_TIPO_DATA('14149354','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14149355','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14149356','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14149357','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14149358','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14149359','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14149360','Z39','Z46','Z48','NULL'),
    T_TIPO_DATA('14149361','Z39','Z46','Z48','NULL'),
    T_TIPO_DATA('14149366','Z39','Z46','Z48','NULL'),
    T_TIPO_DATA('14149367','Z39','Z46','Z48','NULL'),
    T_TIPO_DATA('14149369','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14149370','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14149371','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14149372','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14149373','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14149374','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14149375','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14149376','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14149377','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14149378','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14149379','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14149380','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14149381','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14149382','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14149383','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14149384','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14149385','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14149386','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14149387','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14149388','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14149389','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14149390','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14149391','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14149392','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14149393','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14149394','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14149395','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14149396','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14149397','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14149398','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14149399','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14149400','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14149401','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14149402','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14149403','Z39','Z46','NULL','NULL'),
    T_TIPO_DATA('14149404','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14149405','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14149406','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14149407','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14149408','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14149538','Z39','Z46','Z48','NULL'),
    T_TIPO_DATA('14149539','Z39','Z46','Z48','NULL'),
    T_TIPO_DATA('14184633','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14184634','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14184635','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14184636','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14184637','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14189242','Z39','Z46','Z48','NULL'),
    T_TIPO_DATA('14189243','Z39','Z46','Z48','NULL'),
    T_TIPO_DATA('14189244','Z39','Z46','Z48','NULL'),
    T_TIPO_DATA('14189245','Z39','Z46','Z48','Z52'),
    T_TIPO_DATA('14189246','Z39','Z46','Z48','Z52'),
    T_TIPO_DATA('14189247','Z39','Z46','Z48','Z52'),
    T_TIPO_DATA('14189248','Z39','Z46','Z48','Z52'),
    T_TIPO_DATA('14195497','Z39','NULL','NULL','NULL'),
    T_TIPO_DATA('14015519','Z36','NULL','NULL','NULL'),
    T_TIPO_DATA('14015522','Z36','NULL','NULL','NULL'),
    T_TIPO_DATA('14015587','Z36','NULL','NULL','NULL'),
    T_TIPO_DATA('14015588','Z36','NULL','NULL','NULL'),
    T_TIPO_DATA('14116484','Z36','NULL','NULL','NULL'),
    T_TIPO_DATA('14189538','Z36','Z46','Z48','NULL'),
    T_TIPO_DATA('14189539','Z36','Z46','Z48','NULL'),
    T_TIPO_DATA('14189540','Z36','Z46','Z48','NULL'),
    T_TIPO_DATA('14189541','Z36','Z46','Z48','NULL'),
    T_TIPO_DATA('14189542','Z36','Z46','Z48','NULL'),
    T_TIPO_DATA('14189543','Z36','Z46','Z48','NULL'),
    T_TIPO_DATA('14195496','Z36','Z46','NULL','NULL')

    ); 
    V_TMP_TIPO_DATA T_TIPO_DATA;

BEGIN	

	DBMS_OUTPUT.PUT_LINE('[INICIO]');

	DBMS_OUTPUT.PUT_LINE('[INFO]: AÑADIR CUENTAS A GASTOS EN '||V_TEXT_TABLA);
	FOR I IN V_TIPO_DATA.FIRST .. V_TIPO_DATA.LAST
	LOOP
		V_TMP_TIPO_DATA := V_TIPO_DATA(I);

        V_COUNT_TOTAL:=V_COUNT_TOTAL+1;

		V_MSQL:='SELECT COUNT(*) FROM '||V_ESQUEMA||'.GPV_GASTOS_PROVEEDOR WHERE GPV_NUM_GASTO_HAYA = '||V_TMP_TIPO_DATA(1)||'';
		EXECUTE IMMEDIATE V_MSQL INTO V_COUNT;

		IF V_COUNT > 0 THEN

			V_MSQL:='SELECT GPV_ID FROM '||V_ESQUEMA||'.GPV_GASTOS_PROVEEDOR WHERE GPV_NUM_GASTO_HAYA = '||V_TMP_TIPO_DATA(1)||'';
			EXECUTE IMMEDIATE V_MSQL INTO V_GPV_ID;

            IF V_TMP_TIPO_DATA(3) != 'NULL' THEN
                 V_MSQL := 'UPDATE '||V_ESQUEMA||'.'||V_TEXT_TABLA||' SET			
			GLD_CCC_RECARGO = '''||V_TMP_TIPO_DATA(3)||''',            
			USUARIOMODIFICAR = '''||V_USU||''',
			FECHAMODIFICAR = SYSDATE
			WHERE GPV_ID = '||V_GPV_ID||'';
			EXECUTE IMMEDIATE V_MSQL;
            
            END IF;

            IF V_TMP_TIPO_DATA(4) != 'NULL' THEN
                V_MSQL := 'UPDATE '||V_ESQUEMA||'.'||V_TEXT_TABLA||' SET			
			GLD_CCC_INTERESES = '''||V_TMP_TIPO_DATA(4)||''',            
			USUARIOMODIFICAR = '''||V_USU||''',
			FECHAMODIFICAR = SYSDATE
			WHERE GPV_ID = '||V_GPV_ID||'';
			EXECUTE IMMEDIATE V_MSQL;
                
            END IF;

            IF V_TMP_TIPO_DATA(5) != 'NULL' THEN
                V_MSQL := 'UPDATE '||V_ESQUEMA||'.'||V_TEXT_TABLA||' SET			
			GLD_CCC_TASAS = '''||V_TMP_TIPO_DATA(5)||''',            
			USUARIOMODIFICAR = '''||V_USU||''',
			FECHAMODIFICAR = SYSDATE
			WHERE GPV_ID = '||V_GPV_ID||'';
			EXECUTE IMMEDIATE V_MSQL;
                
            END IF;

			V_MSQL := 'UPDATE '||V_ESQUEMA||'.'||V_TEXT_TABLA||' SET			
			GLD_CCC_BASE = '''||V_TMP_TIPO_DATA(2)||''',            
			USUARIOMODIFICAR = '''||V_USU||''',
			FECHAMODIFICAR = SYSDATE
			WHERE GPV_ID = '||V_GPV_ID||'';
			EXECUTE IMMEDIATE V_MSQL;

			DBMS_OUTPUT.PUT_LINE('[INFO]: MODIFICADAS CUENTAS DE LÍNEAS DEL GASTO '||V_TMP_TIPO_DATA(1)||'');

            V_COUNT_REGISTRO:=V_COUNT_REGISTRO+1;
		
		ELSE

			DBMS_OUTPUT.PUT_LINE('[INFO]: EL GASTO: '||V_TMP_TIPO_DATA(1)||' NO EXISTE');

		END IF;

	END LOOP;
    DBMS_OUTPUT.PUT_LINE('[INFO]:'||V_COUNT_REGISTRO||' - '||V_COUNT_TOTAL||' ');


	COMMIT;

	DBMS_OUTPUT.PUT_LINE('[FIN]');


EXCEPTION
		WHEN OTHERS THEN
			err_num := SQLCODE;
			err_msg := SQLERRM;

			DBMS_OUTPUT.put_line('[ERROR] Se ha producido un error en la ejecución:'||TO_CHAR(err_num));
			DBMS_OUTPUT.put_line('-----------------------------------------------------------'); 
			DBMS_OUTPUT.put_line(err_msg);

			ROLLBACK;
			RAISE;          

END;

/

EXIT