--/*
--#########################################
--## AUTOR=Carlos Santos Vílchez
--## FECHA_CREACION=20210726
--## ARTEFACTO=online
--## VERSION_ARTEFACTO=9.3
--## INCIDENCIA_LINK=REMVIP-10223
--## PRODUCTO=NO
--## 
--## Finalidad: Cambiar publicación de activos
--##			
--## INSTRUCCIONES:  
--## VERSIONES:
--##        0.1 Versión inicial
--#########################################
--*/

WHENEVER SQLERROR EXIT SQL.SQLCODE;
SET SERVEROUTPUT ON; 
SET DEFINE OFF; 

DECLARE


    V_MSQL VARCHAR2(32000 CHAR); -- Sentencia a ejecutar   
    V_ESQUEMA VARCHAR2(25 CHAR):= '#ESQUEMA#'; -- Configuracion Esquemas
    V_ESQUEMA_M VARCHAR2(25 CHAR):= '#ESQUEMA_MASTER#'; -- Configuracion Esquema Master 
    ERR_NUM NUMBER(25);  -- Vble. auxiliar para registrar errores en el script.
    ERR_MSG VARCHAR2(1024 CHAR); -- Vble. auxiliar para registrar errores en el script.
    V_USUARIO VARCHAR2(50 CHAR) := 'REMVIP-10223';

    V_ID NUMBER(16); -- Vble. para el id del activo
    V_ESTA_PUBLICADO NUMBER(16);
    V_TABLA VARCHAR2(50 CHAR):= 'ACT_APU_ACTIVO_PUBLICACION';

	V_COUNT NUMBER(16); -- Vble. para comprobar
    
	TYPE T_TIPO_DATA IS TABLE OF VARCHAR2(32000 CHAR);
    	TYPE T_ARRAY_DATA IS TABLE OF T_TIPO_DATA;
    	V_TIPO_DATA T_ARRAY_DATA := T_ARRAY_DATA(
             T_TIPO_DATA('71735','04','02'),
            T_TIPO_DATA('120875','04','01'),
            T_TIPO_DATA('143589','04','01'),
            T_TIPO_DATA('143999','04','01'),
            T_TIPO_DATA('183697','04','01'),
            T_TIPO_DATA('154032','04','01'),
            T_TIPO_DATA('154033','04','01'),
            T_TIPO_DATA('154761','04','01'),
            T_TIPO_DATA('157001','04','01'),
            T_TIPO_DATA('144000','04','01'),
            T_TIPO_DATA('6130779','03','01'),
            T_TIPO_DATA('6130780','03','01'),
            T_TIPO_DATA('6130781','03','01'),
            T_TIPO_DATA('6130783','03','01'),
            T_TIPO_DATA('6130784','03','01'),
            T_TIPO_DATA('6130785','03','01'),
            T_TIPO_DATA('6130786','03','01'),
            T_TIPO_DATA('6130787','03','01'),
            T_TIPO_DATA('6130788','03','01'),
            T_TIPO_DATA('6130789','03','01'),
            T_TIPO_DATA('6130790','03','01'),
            T_TIPO_DATA('6130791','03','01'),
            T_TIPO_DATA('6130792','03','01'),
            T_TIPO_DATA('6130805','03','01'),
            T_TIPO_DATA('6130806','03','01'),
            T_TIPO_DATA('6130807','03','01'),
            T_TIPO_DATA('6130808','03','01'),
            T_TIPO_DATA('6130809','03','01'),
            T_TIPO_DATA('6130810','03','01'),
            T_TIPO_DATA('6130811','03','01'),
            T_TIPO_DATA('6130812','03','01'),
            T_TIPO_DATA('6130813','03','01'),
            T_TIPO_DATA('6130814','03','01'),
            T_TIPO_DATA('6130815','03','01'),
            T_TIPO_DATA('6130816','03','01'),
            T_TIPO_DATA('6130817','03','01'),
            T_TIPO_DATA('6130818','03','01'),
            T_TIPO_DATA('6130819','03','01'),
            T_TIPO_DATA('68777','03','01'),
            T_TIPO_DATA('78448','03','01'),
            T_TIPO_DATA('6705454','03','01'),
            T_TIPO_DATA('137307','03','01'),
            T_TIPO_DATA('137381','03','01'),
            T_TIPO_DATA('137637','03','01'),
            T_TIPO_DATA('143588','03','01'),
            T_TIPO_DATA('143657','03','01'),
            T_TIPO_DATA('143661','03','01'),
            T_TIPO_DATA('143915','03','01'),
            T_TIPO_DATA('143997','03','01'),
            T_TIPO_DATA('154035','03','01'),
            T_TIPO_DATA('67046','03','01'),
            T_TIPO_DATA('6130666','03','01'),
            T_TIPO_DATA('6130667','03','01'),
            T_TIPO_DATA('6130668','03','01'),
            T_TIPO_DATA('6130669','03','01'),
            T_TIPO_DATA('6130670','03','01'),
            T_TIPO_DATA('6130671','03','01'),
            T_TIPO_DATA('6130672','03','01'),
            T_TIPO_DATA('6130673','03','01'),
            T_TIPO_DATA('6130674','03','01'),
            T_TIPO_DATA('6130675','03','01'),
            T_TIPO_DATA('6130676','03','01'),
            T_TIPO_DATA('6130678','03','01'),
            T_TIPO_DATA('6130679','03','01'),
            T_TIPO_DATA('6130680','03','01'),
            T_TIPO_DATA('6130681','03','01'),
            T_TIPO_DATA('6130682','03','01'),
            T_TIPO_DATA('6130683','03','01'),
            T_TIPO_DATA('6130684','03','01'),
            T_TIPO_DATA('6130685','03','01'),
            T_TIPO_DATA('6130686','03','01'),
            T_TIPO_DATA('6130712','03','01'),
            T_TIPO_DATA('6130713','03','01'),
            T_TIPO_DATA('6130714','03','01'),
            T_TIPO_DATA('6130715','03','01'),
            T_TIPO_DATA('6130716','03','01'),
            T_TIPO_DATA('6130717','03','01'),
            T_TIPO_DATA('6130718','03','01'),
            T_TIPO_DATA('6130719','03','01'),
            T_TIPO_DATA('6130720','03','01'),
            T_TIPO_DATA('6130721','03','01'),
            T_TIPO_DATA('6130722','03','01'),
            T_TIPO_DATA('6130723','03','01'),
            T_TIPO_DATA('6130724','03','01'),
            T_TIPO_DATA('6130725','03','01'),
            T_TIPO_DATA('6130726','03','01'),
            T_TIPO_DATA('6130727','03','01'),
            T_TIPO_DATA('6130729','03','01'),
            T_TIPO_DATA('6130730','03','01'),
            T_TIPO_DATA('6130737','03','01'),
            T_TIPO_DATA('6130738','03','01'),
            T_TIPO_DATA('6130739','03','01'),
            T_TIPO_DATA('6130740','03','01'),
            T_TIPO_DATA('6130741','03','01'),
            T_TIPO_DATA('6130742','03','01'),
            T_TIPO_DATA('6130743','03','01'),
            T_TIPO_DATA('6130744','03','01'),
            T_TIPO_DATA('6130745','03','01'),
            T_TIPO_DATA('6130746','03','01'),
            T_TIPO_DATA('6130747','03','01'),
            T_TIPO_DATA('6130748','03','01'),
            T_TIPO_DATA('6130749','03','01'),
            T_TIPO_DATA('6130750','03','01'),
            T_TIPO_DATA('6130751','03','01'),
            T_TIPO_DATA('6130752','03','01'),
            T_TIPO_DATA('6130753','03','01'),
            T_TIPO_DATA('6130754','03','01'),
            T_TIPO_DATA('6130755','03','01'),
            T_TIPO_DATA('6130756','03','01'),
            T_TIPO_DATA('6130757','03','01'),
            T_TIPO_DATA('6130774','03','01'),
            T_TIPO_DATA('6130775','03','01'),
            T_TIPO_DATA('6130776','03','01'),
            T_TIPO_DATA('6130777','03','01'),
            T_TIPO_DATA('6130778','03','01'),
            T_TIPO_DATA('150815','03','01'),
            T_TIPO_DATA('161161','03','01'),
            T_TIPO_DATA('6130550','03','01'),
            T_TIPO_DATA('6130551','03','01'),
            T_TIPO_DATA('6130552','03','01'),
            T_TIPO_DATA('6130553','03','01'),
            T_TIPO_DATA('6130554','03','01'),
            T_TIPO_DATA('6130555','03','01'),
            T_TIPO_DATA('6130556','03','01'),
            T_TIPO_DATA('6130557','03','01'),
            T_TIPO_DATA('6130558','03','01'),
            T_TIPO_DATA('6130559','03','01'),
            T_TIPO_DATA('6130568','03','01'),
            T_TIPO_DATA('6130569','03','01'),
            T_TIPO_DATA('6130570','03','01'),
            T_TIPO_DATA('6130571','03','01'),
            T_TIPO_DATA('6130572','03','01'),
            T_TIPO_DATA('6130573','03','01'),
            T_TIPO_DATA('6130574','03','01'),
            T_TIPO_DATA('6130575','03','01'),
            T_TIPO_DATA('6130576','03','01'),
            T_TIPO_DATA('6130577','03','01'),
            T_TIPO_DATA('6130578','03','01'),
            T_TIPO_DATA('6130579','03','01'),
            T_TIPO_DATA('6130580','03','01'),
            T_TIPO_DATA('6130581','03','01'),
            T_TIPO_DATA('6130582','03','01'),
            T_TIPO_DATA('6130583','03','01'),
            T_TIPO_DATA('6130584','03','01'),
            T_TIPO_DATA('6130585','03','01'),
            T_TIPO_DATA('6130586','03','01'),
            T_TIPO_DATA('6130587','03','01'),
            T_TIPO_DATA('6130588','03','01'),
            T_TIPO_DATA('6130589','03','01'),
            T_TIPO_DATA('6130590','03','01'),
            T_TIPO_DATA('6130591','03','01'),
            T_TIPO_DATA('6130592','03','01'),
            T_TIPO_DATA('6130593','03','01'),
            T_TIPO_DATA('6130594','03','01'),
            T_TIPO_DATA('6130595','03','01'),
            T_TIPO_DATA('6130613','03','01'),
            T_TIPO_DATA('6130614','03','01'),
            T_TIPO_DATA('6130615','03','01'),
            T_TIPO_DATA('6130616','03','01'),
            T_TIPO_DATA('6130617','03','01'),
            T_TIPO_DATA('6130618','03','01'),
            T_TIPO_DATA('6130619','03','01'),
            T_TIPO_DATA('6130620','03','01'),
            T_TIPO_DATA('6130621','03','01'),
            T_TIPO_DATA('6130622','03','01'),
            T_TIPO_DATA('6130623','03','01'),
            T_TIPO_DATA('6130638','03','01'),
            T_TIPO_DATA('6130639','03','01'),
            T_TIPO_DATA('6130640','03','01'),
            T_TIPO_DATA('6130641','03','01'),
            T_TIPO_DATA('6130642','03','01'),
            T_TIPO_DATA('6130643','03','01'),
            T_TIPO_DATA('6130644','03','01'),
            T_TIPO_DATA('6130659','03','01'),
            T_TIPO_DATA('6130660','03','01'),
            T_TIPO_DATA('6130661','03','01'),
            T_TIPO_DATA('6130662','03','01'),
            T_TIPO_DATA('6130664','03','01'),
            T_TIPO_DATA('6130665','03','01'),
            T_TIPO_DATA('62598','01','01'),
            T_TIPO_DATA('62920','01','01'),
            T_TIPO_DATA('64985','01','01'),
            T_TIPO_DATA('65174','01','01'),
            T_TIPO_DATA('65197','01','01'),
            T_TIPO_DATA('65482','01','01'),
            T_TIPO_DATA('67500','01','01'),
            T_TIPO_DATA('70228','01','01'),
            T_TIPO_DATA('70850','01','01'),
            T_TIPO_DATA('134855','01','01'),
            T_TIPO_DATA('138250','01','01'),
            T_TIPO_DATA('142526','01','01'),
            T_TIPO_DATA('146025','01','01'),
            T_TIPO_DATA('146197','01','01'),
            T_TIPO_DATA('146198','01','01'),
            T_TIPO_DATA('146280','01','01'),
            T_TIPO_DATA('146512','01','01'),
            T_TIPO_DATA('146670','01','01'),
            T_TIPO_DATA('146671','01','01'),
            T_TIPO_DATA('147899','01','01'),
            T_TIPO_DATA('154709','01','01'),
            T_TIPO_DATA('158872','01','01'),
            T_TIPO_DATA('159377','01','01'),
            T_TIPO_DATA('162310','01','01'),
            T_TIPO_DATA('162673','01','01'),
            T_TIPO_DATA('164445','01','01'),
            T_TIPO_DATA('177572','01','01'),
            T_TIPO_DATA('178887','01','01'),
            T_TIPO_DATA('179231','01','01'),
            T_TIPO_DATA('179435','01','01'),
            T_TIPO_DATA('198547','01','01'),
            T_TIPO_DATA('199296','01','01'),
            T_TIPO_DATA('200796','01','01'),
            T_TIPO_DATA('200818','01','01'),
            T_TIPO_DATA('201924','01','02'),
            T_TIPO_DATA('201961','01','01'),
            T_TIPO_DATA('203228','01','01'),
            T_TIPO_DATA('204483','01','01'),
            T_TIPO_DATA('890353','01','01'),
            T_TIPO_DATA('951961','01','01'),
            T_TIPO_DATA('952128','01','01'),
            T_TIPO_DATA('5876719','01','01'),
            T_TIPO_DATA('6351586','01','01'),
            T_TIPO_DATA('6351591','01','01'),
            T_TIPO_DATA('6351585','01','01'),
            T_TIPO_DATA('6351594','01','01'),
            T_TIPO_DATA('6351598','01','01'),
            T_TIPO_DATA('6351599','01','01'),
            T_TIPO_DATA('6351597','01','01'),
            T_TIPO_DATA('6351600','01','01'),
            T_TIPO_DATA('6351590','01','01'),
            T_TIPO_DATA('6520526','01','01'),
            T_TIPO_DATA('65742','01','01'),
            T_TIPO_DATA('6524756','01','01'),
            T_TIPO_DATA('162689','01','01'),
            T_TIPO_DATA('175961','01','01'),
            T_TIPO_DATA('197041','01','02'),
            T_TIPO_DATA('174541','01','01'),
            T_TIPO_DATA('161361','01','01'),
            T_TIPO_DATA('161360','01','01'),
            T_TIPO_DATA('174604','01','01'),
            T_TIPO_DATA('68907','01','01'),
            T_TIPO_DATA('68847','01','01'),
            T_TIPO_DATA('5877033','01','01'),
            T_TIPO_DATA('156275','01','01'),
            T_TIPO_DATA('69096','01','01'),
            T_TIPO_DATA('6756916','01','01'),
            T_TIPO_DATA('74094','01','01'),
            T_TIPO_DATA('165350','01','01'),
            T_TIPO_DATA('183442','01','01'),
            T_TIPO_DATA('176295','01','01'),
            T_TIPO_DATA('6793553','01','01'),
            T_TIPO_DATA('158219','01','01'),
            T_TIPO_DATA('148064','01','01'),
            T_TIPO_DATA('175228','01','02'),
            T_TIPO_DATA('170188','01','02'),
            T_TIPO_DATA('174459','01','01'),
            T_TIPO_DATA('141642','01','01'),
            T_TIPO_DATA('156357','01','01'),
            T_TIPO_DATA('5971369','01','01'),
            T_TIPO_DATA('140905','01','01'),
            T_TIPO_DATA('137233','01','01'),
            T_TIPO_DATA('71112','01','01'),
            T_TIPO_DATA('78233','01','01'),
            T_TIPO_DATA('118949','01','01'),
            T_TIPO_DATA('62927','01','01'),
            T_TIPO_DATA('66564','01','01'),
            T_TIPO_DATA('6744851','01','01'),
            T_TIPO_DATA('6744856','01','01'),
            T_TIPO_DATA('6744858','01','01'),
            T_TIPO_DATA('6744853','01','01'),
            T_TIPO_DATA('166608','01','01'),
            T_TIPO_DATA('171800','01','01'),
            T_TIPO_DATA('6744860','01','01'),
            T_TIPO_DATA('171548','01','01'),
            T_TIPO_DATA('6744859','01','01'),
            T_TIPO_DATA('6744857','01','01'),
            T_TIPO_DATA('164857','01','01'),
            T_TIPO_DATA('6846857','01','01'),
            T_TIPO_DATA('77609','01','01'),
            T_TIPO_DATA('6846992','01','01'),
            T_TIPO_DATA('6846697','01','01'),
            T_TIPO_DATA('86440','01','01'),
            T_TIPO_DATA('6846841','01','01'),
            T_TIPO_DATA('6846681','01','01'),
            T_TIPO_DATA('6846971','01','01'),
            T_TIPO_DATA('124165','01','01'),
            T_TIPO_DATA('148538','01','01'),
            T_TIPO_DATA('124190','01','01'),
            T_TIPO_DATA('66991','01','01'),
            T_TIPO_DATA('6839981','01','02'),
            T_TIPO_DATA('6839957','01','02'),
            T_TIPO_DATA('6839972','01','02'),
            T_TIPO_DATA('6839963','01','02'),
            T_TIPO_DATA('6839955','01','02'),
            T_TIPO_DATA('6839956','01','02'),
            T_TIPO_DATA('6839951','01','02'),
            T_TIPO_DATA('6839984','01','02'),
            T_TIPO_DATA('6839948','01','02'),
            T_TIPO_DATA('6839952','01','02'),
            T_TIPO_DATA('6839964','01','02'),
            T_TIPO_DATA('6839980','01','02'),
            T_TIPO_DATA('6839985','01','02'),
            T_TIPO_DATA('6839954','01','02'),
            T_TIPO_DATA('6839988','01','02'),
            T_TIPO_DATA('6839961','01','02'),
            T_TIPO_DATA('6839953','01','02'),
            T_TIPO_DATA('6839940','01','02'),
            T_TIPO_DATA('6839949','01','02'),
            T_TIPO_DATA('6839986','01','02'),
            T_TIPO_DATA('6839973','01','02'),
            T_TIPO_DATA('6839979','01','02'),
            T_TIPO_DATA('6839971','01','02'),
            T_TIPO_DATA('6839960','01','02'),
            T_TIPO_DATA('6839970','01','02'),
            T_TIPO_DATA('6839950','01','02'),
            T_TIPO_DATA('6839959','01','02'),
            T_TIPO_DATA('6839937','01','02'),
            T_TIPO_DATA('6839976','01','02'),
            T_TIPO_DATA('6839989','01','02'),
            T_TIPO_DATA('65168','01','01'),
            T_TIPO_DATA('199604','01','01'),
            T_TIPO_DATA('67805','01','01'),
            T_TIPO_DATA('178881','01','01'),
            T_TIPO_DATA('199605','01','01'),
            T_TIPO_DATA('199887','01','01'),
            T_TIPO_DATA('179586','01','01'),
            T_TIPO_DATA('6351762','01','01'),
            T_TIPO_DATA('6351750','01','01'),
            T_TIPO_DATA('6351643','01','01'),
            T_TIPO_DATA('6351678','01','01'),
            T_TIPO_DATA('6351738','01','01'),
            T_TIPO_DATA('6351685','01','01'),
            T_TIPO_DATA('6351647','01','01'),
            T_TIPO_DATA('6351670','01','01'),
            T_TIPO_DATA('6351640','01','01'),
            T_TIPO_DATA('6351687','01','01'),
            T_TIPO_DATA('6351752','01','01'),
            T_TIPO_DATA('6351667','01','01'),
            T_TIPO_DATA('6351735','01','01'),
            T_TIPO_DATA('6351642','01','01'),
            T_TIPO_DATA('6351751','01','01'),
            T_TIPO_DATA('6351761','01','01'),
            T_TIPO_DATA('6351766','01','01'),
            T_TIPO_DATA('6351730','01','01'),
            T_TIPO_DATA('6351672','01','01'),
            T_TIPO_DATA('6351742','01','01'),
            T_TIPO_DATA('6351683','01','01'),
            T_TIPO_DATA('6351741','01','01'),
            T_TIPO_DATA('6351732','01','01'),
            T_TIPO_DATA('6351677','01','01'),
            T_TIPO_DATA('6351649','01','01'),
            T_TIPO_DATA('6351756','01','01'),
            T_TIPO_DATA('6351757','01','01'),
            T_TIPO_DATA('6351635','01','01'),
            T_TIPO_DATA('6351753','01','01'),
            T_TIPO_DATA('6351767','01','01'),
            T_TIPO_DATA('6351737','01','01'),
            T_TIPO_DATA('6351638','01','01'),
            T_TIPO_DATA('6351671','01','01'),
            T_TIPO_DATA('6351734','01','01'),
            T_TIPO_DATA('6351651','01','01'),
            T_TIPO_DATA('6351668','01','01'),
            T_TIPO_DATA('6351754','01','01'),
            T_TIPO_DATA('6351733','01','01'),
            T_TIPO_DATA('6351645','01','01'),
            T_TIPO_DATA('6351743','01','01'),
            T_TIPO_DATA('6351639','01','01'),
            T_TIPO_DATA('6351770','01','01'),
            T_TIPO_DATA('6351681','01','01'),
            T_TIPO_DATA('6351633','01','01'),
            T_TIPO_DATA('6351736','01','01'),
            T_TIPO_DATA('6351664','01','01'),
            T_TIPO_DATA('6351669','01','01'),
            T_TIPO_DATA('6351747','01','01'),
            T_TIPO_DATA('6351740','01','01'),
            T_TIPO_DATA('6351657','01','01'),
            T_TIPO_DATA('6351744','01','01'),
            T_TIPO_DATA('6351682','01','01'),
            T_TIPO_DATA('6351674','01','01'),
            T_TIPO_DATA('6351652','01','01'),
            T_TIPO_DATA('6351636','01','01'),
            T_TIPO_DATA('6351758','01','01'),
            T_TIPO_DATA('6351769','01','01'),
            T_TIPO_DATA('6351637','01','01'),
            T_TIPO_DATA('6351748','01','01'),
            T_TIPO_DATA('6351660','01','01'),
            T_TIPO_DATA('6351684','01','01'),
            T_TIPO_DATA('6351659','01','01'),
            T_TIPO_DATA('6351662','01','01'),
            T_TIPO_DATA('6351663','01','01'),
            T_TIPO_DATA('6351648','01','01'),
            T_TIPO_DATA('6351763','01','01'),
            T_TIPO_DATA('6351661','01','01'),
            T_TIPO_DATA('6351745','01','01'),
            T_TIPO_DATA('6351655','01','01'),
            T_TIPO_DATA('6351731','01','01'),
            T_TIPO_DATA('6351768','01','01'),
            T_TIPO_DATA('6351690','01','01'),
            T_TIPO_DATA('6351653','01','01'),
            T_TIPO_DATA('6351650','01','01'),
            T_TIPO_DATA('6351759','01','01'),
            T_TIPO_DATA('6351646','01','01'),
            T_TIPO_DATA('6351686','01','01'),
            T_TIPO_DATA('6351765','01','01'),
            T_TIPO_DATA('6351665','01','01'),
            T_TIPO_DATA('6351755','01','01'),
            T_TIPO_DATA('6351644','01','01'),
            T_TIPO_DATA('6351658','01','01'),
            T_TIPO_DATA('6351632','01','01'),
            T_TIPO_DATA('6351656','01','01'),
            T_TIPO_DATA('6351675','01','01'),
            T_TIPO_DATA('6351676','01','01'),
            T_TIPO_DATA('6351729','01','01'),
            T_TIPO_DATA('6351739','01','01'),
            T_TIPO_DATA('6351641','01','01'),
            T_TIPO_DATA('6351634','01','01'),
            T_TIPO_DATA('6351679','01','01'),
            T_TIPO_DATA('6351654','01','01'),
            T_TIPO_DATA('6351749','01','01'),
            T_TIPO_DATA('6351691','01','01'),
            T_TIPO_DATA('6351764','01','01'),
            T_TIPO_DATA('6351760','01','01'),
            T_TIPO_DATA('6351673','01','01'),
            T_TIPO_DATA('6351688','01','01'),
            T_TIPO_DATA('6351666','01','01'),
            T_TIPO_DATA('6351746','01','01'),
            T_TIPO_DATA('6351689','01','01'),
            T_TIPO_DATA('6351680','01','01'),
            T_TIPO_DATA('69409','01','01'),
            T_TIPO_DATA('154350','01','01'),
            T_TIPO_DATA('147298','01','01'),
            T_TIPO_DATA('74401','01','01'),
            T_TIPO_DATA('150778','01','01'),
            T_TIPO_DATA('168244','01','01'),
            T_TIPO_DATA('166284','01','02'),
            T_TIPO_DATA('140454','01','02'),
            T_TIPO_DATA('134004','01','01'),
            T_TIPO_DATA('153629','01','01'),
            T_TIPO_DATA('65127','01','01'),
            T_TIPO_DATA('64775','01','02'),
            T_TIPO_DATA('163449','01','01'),
            T_TIPO_DATA('184448','01','01'),
            T_TIPO_DATA('169760','01','01'),
            T_TIPO_DATA('73056','01','01'),
            T_TIPO_DATA('163885','01','01'),
            T_TIPO_DATA('201478','01','01'),
            T_TIPO_DATA('66078','01','01'),
            T_TIPO_DATA('131258','01','02'),
            T_TIPO_DATA('151262','01','01'),
            T_TIPO_DATA('62865','01','01'),
            T_TIPO_DATA('6946549','01','01'),
            T_TIPO_DATA('6946552','01','01'),
            T_TIPO_DATA('6946565','01','01'),
            T_TIPO_DATA('6946506','01','01'),
            T_TIPO_DATA('6946532','01','01'),
            T_TIPO_DATA('6946563','01','01'),
            T_TIPO_DATA('6946539','01','01'),
            T_TIPO_DATA('168886','01','02'),
            T_TIPO_DATA('6946543','01','01'),
            T_TIPO_DATA('6946587','01','01'),
            T_TIPO_DATA('6946542','01','01'),
            T_TIPO_DATA('6946566','01','01'),
            T_TIPO_DATA('6946535','01','01'),
            T_TIPO_DATA('6946557','01','01'),
            T_TIPO_DATA('6946509','01','01'),
            T_TIPO_DATA('6946527','01','01'),
            T_TIPO_DATA('6946508','01','01'),
            T_TIPO_DATA('6946504','01','01'),
            T_TIPO_DATA('6946512','01','01'),
            T_TIPO_DATA('6946515','01','01'),
            T_TIPO_DATA('6946513','01','01'),
            T_TIPO_DATA('6946560','01','01'),
            T_TIPO_DATA('6946531','01','01'),
            T_TIPO_DATA('6946517','01','01'),
            T_TIPO_DATA('6946520','01','01'),
            T_TIPO_DATA('6946545','01','01'),
            T_TIPO_DATA('6946550','01','01'),
            T_TIPO_DATA('6946536','01','01'),
            T_TIPO_DATA('6946551','01','01'),
            T_TIPO_DATA('6946554','01','01'),
            T_TIPO_DATA('6946558','01','01'),
            T_TIPO_DATA('6946585','01','01'),
            T_TIPO_DATA('6946510','01','01'),
            T_TIPO_DATA('6946546','01','01'),
            T_TIPO_DATA('6946505','01','01'),
            T_TIPO_DATA('6946526','01','01'),
            T_TIPO_DATA('6946507','01','01'),
            T_TIPO_DATA('6946514','01','01'),
            T_TIPO_DATA('6946556','01','01'),
            T_TIPO_DATA('6946523','01','01'),
            T_TIPO_DATA('6946538','01','01'),
            T_TIPO_DATA('6946524','01','01'),
            T_TIPO_DATA('6946544','01','01'),
            T_TIPO_DATA('6946540','01','01'),
            T_TIPO_DATA('6946516','01','01'),
            T_TIPO_DATA('6946553','01','01'),
            T_TIPO_DATA('6946564','01','01'),
            T_TIPO_DATA('6946522','01','01'),
            T_TIPO_DATA('6946533','01','01'),
            T_TIPO_DATA('6946555','01','01'),
            T_TIPO_DATA('6946541','01','01'),
            T_TIPO_DATA('6946525','01','01'),
            T_TIPO_DATA('6946548','01','01'),
            T_TIPO_DATA('168868','01','01'),
            T_TIPO_DATA('6946530','01','01'),
            T_TIPO_DATA('6946534','01','01'),
            T_TIPO_DATA('6946528','01','01'),
            T_TIPO_DATA('6946519','01','01'),
            T_TIPO_DATA('6946537','01','01'),
            T_TIPO_DATA('6946559','01','01'),
            T_TIPO_DATA('6946511','01','01'),
            T_TIPO_DATA('6946521','01','01'),
            T_TIPO_DATA('140954','01','01'),
            T_TIPO_DATA('170158','01','01'),
            T_TIPO_DATA('141773','01','01'),
            T_TIPO_DATA('6846777','01','01'),
            T_TIPO_DATA('6847162','01','01'),
            T_TIPO_DATA('6847045','01','01'),
            T_TIPO_DATA('6846942','01','01'),
            T_TIPO_DATA('6846713','01','01'),
            T_TIPO_DATA('6846929','01','01'),
            T_TIPO_DATA('6846744','01','01'),
            T_TIPO_DATA('6846685','01','01'),
            T_TIPO_DATA('6846775','01','01'),
            T_TIPO_DATA('6846803','01','01'),
            T_TIPO_DATA('6847160','01','01'),
            T_TIPO_DATA('6846623','01','01'),
            T_TIPO_DATA('6846952','01','01'),
            T_TIPO_DATA('6846830','01','01'),
            T_TIPO_DATA('6846653','01','01'),
            T_TIPO_DATA('6847153','01','01'),
            T_TIPO_DATA('6846613','01','01'),
            T_TIPO_DATA('6846802','01','01'),
            T_TIPO_DATA('6847073','01','01'),
            T_TIPO_DATA('6846941','01','01'),
            T_TIPO_DATA('6846818','01','01'),
            T_TIPO_DATA('165487','01','02'),
            T_TIPO_DATA('169132','01','02'),
            T_TIPO_DATA('62910','01','01'),
            T_TIPO_DATA('70739','01','01'),
            T_TIPO_DATA('155248','01','01'),
            T_TIPO_DATA('188344','01','02'),
            T_TIPO_DATA('186637','01','02'),
            T_TIPO_DATA('158978','01','02'),
            T_TIPO_DATA('151982','01','01'),
            T_TIPO_DATA('70887','01','01'),
            T_TIPO_DATA('70031','01','01'),
            T_TIPO_DATA('134863','01','01'),
            T_TIPO_DATA('146634','01','01'),
            T_TIPO_DATA('149555','01','01'),
            T_TIPO_DATA('170284','01','02'),
            T_TIPO_DATA('177378','01','02'),
            T_TIPO_DATA('70837','01','02'),
            T_TIPO_DATA('198777','01','01'),
            T_TIPO_DATA('194614','01','01'),
            T_TIPO_DATA('198720','01','01'),
            T_TIPO_DATA('194867','01','01'),
            T_TIPO_DATA('198719','01','01'),
            T_TIPO_DATA('194868','01','01'),
            T_TIPO_DATA('136637','01','01'),
            T_TIPO_DATA('167832','01','01'),
            T_TIPO_DATA('170933','01','02'),
            T_TIPO_DATA('6044493','01','01'),
            T_TIPO_DATA('6044497','01','01'),
            T_TIPO_DATA('157782','01','01'),
            T_TIPO_DATA('151373','01','02'),
            T_TIPO_DATA('136934','01','02'),
            T_TIPO_DATA('160419','01','02'),
            T_TIPO_DATA('151462','01','02'),
            T_TIPO_DATA('148889','01','02'),
            T_TIPO_DATA('148815','01','02'),
            T_TIPO_DATA('151372','01','02'),
            T_TIPO_DATA('148673','01','02'),
            T_TIPO_DATA('161105','01','02'),
            T_TIPO_DATA('137240','01','02'),
            T_TIPO_DATA('151460','01','02'),
            T_TIPO_DATA('151677','01','02'),
            T_TIPO_DATA('148816','01','02'),
            T_TIPO_DATA('160415','01','02'),
            T_TIPO_DATA('200584','01','01'),
            T_TIPO_DATA('159309','01','01'),
            T_TIPO_DATA('158482','01','01'),
            T_TIPO_DATA('119650','01','02'),
            T_TIPO_DATA('153043','01','01'),
            T_TIPO_DATA('6965610','01','01'),
            T_TIPO_DATA('65397','01','01'),
            T_TIPO_DATA('169163','01','01'),
            T_TIPO_DATA('73112','01','01'),
            T_TIPO_DATA('69118','01','01'),
            T_TIPO_DATA('151349','01','01'),
            T_TIPO_DATA('73491','01','01'),
            T_TIPO_DATA('73490','01','01'),
            T_TIPO_DATA('6965611','01','01'),
            T_TIPO_DATA('71618','01','01'),
            T_TIPO_DATA('73203','01','01'),
            T_TIPO_DATA('65852','01','01'),
            T_TIPO_DATA('65935','01','01'),
            T_TIPO_DATA('65934','01','01'),
            T_TIPO_DATA('73202','01','01'),
            T_TIPO_DATA('74856','01','01'),
            T_TIPO_DATA('6847102','01','01'),
            T_TIPO_DATA('6846848','01','01'),
            T_TIPO_DATA('6846965','01','01'),
            T_TIPO_DATA('6847121','01','01'),
            T_TIPO_DATA('6846974','01','01'),
            T_TIPO_DATA('6846712','01','01'),
            T_TIPO_DATA('6846938','01','01'),
            T_TIPO_DATA('6847163','01','01'),
            T_TIPO_DATA('6846968','01','01'),
            T_TIPO_DATA('147502','01','01'),
            T_TIPO_DATA('159452','01','01'),
            T_TIPO_DATA('153972','01','01'),
            T_TIPO_DATA('138941','01','01'),
            T_TIPO_DATA('137480','01','01'),
            T_TIPO_DATA('143157','01','01'),
            T_TIPO_DATA('156449','01','01'),
            T_TIPO_DATA('156098','01','01'),
            T_TIPO_DATA('151624','01','01'),
            T_TIPO_DATA('153750','01','01'),
            T_TIPO_DATA('142510','01','01'),
            T_TIPO_DATA('156085','01','01'),
            T_TIPO_DATA('135064','01','01'),
            T_TIPO_DATA('137341','01','01'),
            T_TIPO_DATA('152958','01','01'),
            T_TIPO_DATA('150660','01','01'),
            T_TIPO_DATA('154294','01','01'),
            T_TIPO_DATA('145162','01','01'),
            T_TIPO_DATA('157886','01','01'),
            T_TIPO_DATA('139401','01','01'),
            T_TIPO_DATA('150456','01','01'),
            T_TIPO_DATA('145636','01','01'),
            T_TIPO_DATA('6775781','01','01'),
            T_TIPO_DATA('6775776','01','01'),
            T_TIPO_DATA('150083','01','01'),
            T_TIPO_DATA('198893','01','02'),
            T_TIPO_DATA('165861','01','02'),
            T_TIPO_DATA('153255','01','01'),
            T_TIPO_DATA('175741','01','01'),
            T_TIPO_DATA('169920','01','02'),
            T_TIPO_DATA('178652','01','02'),
            T_TIPO_DATA('166492','01','01'),
            T_TIPO_DATA('111981','01','01'),
            T_TIPO_DATA('72598','01','01'),
            T_TIPO_DATA('6781272','01','01'),
            T_TIPO_DATA('175850','01','01'),
            T_TIPO_DATA('149950','01','01'),
            T_TIPO_DATA('147489','01','01'),
            T_TIPO_DATA('159154','01','01'),
            T_TIPO_DATA('159624','01','01'),
            T_TIPO_DATA('147292','01','01'),
            T_TIPO_DATA('135361','01','01'),
            T_TIPO_DATA('135475','01','01'),
            T_TIPO_DATA('159060','01','01'),
            T_TIPO_DATA('71450','01','01'),
            T_TIPO_DATA('172660','01','02'),
            T_TIPO_DATA('68613','01','02'),
            T_TIPO_DATA('68710','01','02'),
            T_TIPO_DATA('173026','01','02'),
            T_TIPO_DATA('68372','01','02'),
            T_TIPO_DATA('165794','01','02'),
            T_TIPO_DATA('199152','01','02'),
            T_TIPO_DATA('165959','01','01'),
            T_TIPO_DATA('199103','01','02'),
            T_TIPO_DATA('165958','01','01'),
            T_TIPO_DATA('173027','01','01'),
            T_TIPO_DATA('165795','01','02'),
            T_TIPO_DATA('7228986','01','02'),
            T_TIPO_DATA('199704','01','02'),
            T_TIPO_DATA('172661','01','02'),
            T_TIPO_DATA('68371','01','02'),
            T_TIPO_DATA('7327473','01','02'),
            T_TIPO_DATA('166035','01','02'),
            T_TIPO_DATA('68655','01','02'),
            T_TIPO_DATA('172662','01','02'),
            T_TIPO_DATA('7327469','01','02'),
            T_TIPO_DATA('7327542','01','02'),
            T_TIPO_DATA('175620','01','02'),
            T_TIPO_DATA('170939','01','01'),
            T_TIPO_DATA('162491','01','01'),
            T_TIPO_DATA('72112','01','01'),
            T_TIPO_DATA('177114','01','01'),
            T_TIPO_DATA('70712','01','01'),
            T_TIPO_DATA('167618','01','01'),
            T_TIPO_DATA('150140','01','02'),
            T_TIPO_DATA('68373','01','02'),
            T_TIPO_DATA('66177','01','02'),
            T_TIPO_DATA('167358','01','02'),
            T_TIPO_DATA('136723','01','01'),
            T_TIPO_DATA('169983','01','02'),
            T_TIPO_DATA('158923','01','01'),
            T_TIPO_DATA('6802991','01','01')

    	); 
    	V_TMP_TIPO_DATA T_TIPO_DATA;

BEGIN
	DBMS_OUTPUT.PUT_LINE('[INICIO]');
    DBMS_OUTPUT.PUT_LINE('[INFO]: DESOCULTAR ACTIVOS');

    FOR I IN V_TIPO_DATA.FIRST .. V_TIPO_DATA.LAST
        LOOP
    V_TMP_TIPO_DATA := V_TIPO_DATA(I);

        --Comprobamos la existencia del activo
        V_MSQL := 'SELECT COUNT(1) FROM '||V_ESQUEMA||'.ACT_ACTIVO WHERE ACT_NUM_ACTIVO = '''||V_TMP_TIPO_DATA(1)||'''';
        EXECUTE IMMEDIATE V_MSQL INTO V_COUNT;	

        IF V_COUNT = 1 THEN

            --Obtenemos el ID del activo
            V_MSQL := 'SELECT ACT_ID FROM '||V_ESQUEMA||'.ACT_ACTIVO WHERE ACT_NUM_ACTIVO = '''||V_TMP_TIPO_DATA(1)||'''';
            EXECUTE IMMEDIATE V_MSQL INTO V_ID;

            --Comprobamos si el activo está oculto
            V_MSQL := 'SELECT DD_EPV_ID FROM '||V_ESQUEMA||'.'||V_TABLA||' WHERE ACT_ID = '||V_ID||'';
            EXECUTE IMMEDIATE V_MSQL INTO V_ESTA_PUBLICADO;

            IF V_ESTA_PUBLICADO = 4 THEN

                --Actualizamos el estado de publicación
                V_MSQL:= 'UPDATE '||V_ESQUEMA||'.'||V_TABLA||' SET
                DD_EPV_ID = (SELECT DD_EPV_ID FROM '||V_ESQUEMA||'.DD_EPV_ESTADO_PUB_VENTA WHERE DD_EPV_CODIGO = ''03''),
                APU_CHECK_PUBLICAR_V = 1,
                APU_CHECK_OCULTAR_V = 0,
                APU_CHECK_PUB_SIN_PRECIO_V = 1,
                DD_MTO_V_ID = NULL,
                APU_MOT_OCULTACION_MANUAL_V = NULL,
                USUARIOMODIFICAR = '''|| V_USUARIO ||''',
                FECHAMODIFICAR = SYSDATE ,
                APU_FECHA_CAMB_PUBL_VENTA = TO_DATE(''26/07/2021'',''DD/MM/YYYY'')
                WHERE ACT_ID = '||V_ID||'';

                EXECUTE IMMEDIATE V_MSQL;

                --Actualizamos el histórico estado de publicación
                V_MSQL:= 'UPDATE '||V_ESQUEMA||'.ACT_AHP_HIST_PUBLICACION SET
                AHP_FECHA_FIN_VENTA = TO_DATE(''26/07/2021'',''DD/MM/YYYY''),
                USUARIOMODIFICAR = '''|| V_USUARIO ||''',
                FECHAMODIFICAR = SYSDATE 
                WHERE ACT_ID = '||V_ID||' AND AHP_FECHA_INI_VENTA IS NOT NULL AND AHP_FECHA_FIN_VENTA IS NULL';

                EXECUTE IMMEDIATE V_MSQL;

                V_MSQL:= 'INSERT INTO '||V_ESQUEMA||'.ACT_AHP_HIST_PUBLICACION (AHP_ID, ACT_ID, DD_EPV_ID, DD_EPA_ID, DD_TCO_ID, 
                            AHP_CHECK_PUBLICAR_V, AHP_CHECK_OCULTAR_V, AHP_CHECK_OCULTAR_PRECIO_V, AHP_CHECK_PUB_SIN_PRECIO_V,
                            AHP_CHECK_PUBLICAR_A, AHP_CHECK_OCULTAR_A, AHP_CHECK_OCULTAR_PRECIO_A, AHP_CHECK_PUB_SIN_PRECIO_A,
                            AHP_FECHA_INI_VENTA, USUARIOCREAR, FECHACREAR, ES_CONDICONADO_ANTERIOR, DD_TPU_V_ID, DD_POR_ID)
                VALUES(
                    '||V_ESQUEMA||'.S_ACT_AHP_HIST_PUBLICACION.NEXTVAL,
                    '||V_ID||',
                    (SELECT DD_EPV_ID FROM '||V_ESQUEMA||'.DD_EPV_ESTADO_PUB_VENTA WHERE DD_EPV_CODIGO = ''03''),
                    (SELECT DD_EPA_ID FROM '||V_ESQUEMA||'.DD_EPA_ESTADO_PUB_ALQUILER WHERE DD_EPA_CODIGO = '''||V_TMP_TIPO_DATA(2)||'''),
                    (SELECT DD_TCO_ID FROM '||V_ESQUEMA||'.DD_TCO_TIPO_COMERCIALIZACION WHERE DD_TCO_CODIGO = ''01''),
                    1,
                    0,
                    0,
                    1,
                    0,
                    0,
                    0,
                    0,
                    TO_DATE(''26/07/2021'',''DD/MM/YYYY''),
                    '''|| V_USUARIO ||''',
                    SYSDATE,
                    0,
                    2,
                    (SELECT DD_POR_ID FROM '||V_ESQUEMA||'.DD_POR_PORTAL WHERE DD_POR_CODIGO = '''||V_TMP_TIPO_DATA(3)||'''))';
    
                EXECUTE IMMEDIATE V_MSQL;

                DBMS_OUTPUT.PUT_LINE('[INFO]: ACTIVO '''||V_TMP_TIPO_DATA(1)||''' ACTUALIZADO');

            ELSE

                DBMS_OUTPUT.PUT_LINE('[INFO] EL ACTIVO '''||V_TMP_TIPO_DATA(1)||''' NO SE ENCUENTRA OCULTO');

            END IF;
            
        ELSE 

            DBMS_OUTPUT.PUT_LINE('[INFO] NO EXISTE EL ACTIVO '''||V_TMP_TIPO_DATA(1)||'''');

        END IF;

    END LOOP;

    COMMIT;

    DBMS_OUTPUT.PUT_LINE('[FIN]');
 
EXCEPTION
     WHEN OTHERS THEN
          ERR_NUM := SQLCODE;
          ERR_MSG := SQLERRM;
          DBMS_OUTPUT.put_line('[ERROR] Se ha producido un error en la ejecución:'||TO_CHAR(ERR_NUM));
          DBMS_OUTPUT.put_line('-----------------------------------------------------------'); 
          DBMS_OUTPUT.put_line(ERR_MSG);
          ROLLBACK;
          RAISE;   
END;
/
EXIT;