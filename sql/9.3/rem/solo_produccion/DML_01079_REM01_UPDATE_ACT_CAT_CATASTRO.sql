--/*
--#########################################
--## AUTOR=Juan Bautista Alfonso
--## FECHA_CREACION=20211022
--## ARTEFACTO=online
--## VERSION_ARTEFACTO=9.3
--## INCIDENCIA_LINK=REMVIP-10553
--## PRODUCTO=NO
--## 
--## Finalidad: Actualizar catastro
--##			
--## INSTRUCCIONES:  
--## VERSIONES:
--##        0.1 Versión inicial
--#########################################
--*/

WHENEVER SQLERROR EXIT SQL.SQLCODE;
SET SERVEROUTPUT ON; 
SET DEFINE OFF; 
ALTER SESSION SET NLS_NUMERIC_CHARACTERS = ',.';

DECLARE


    V_MSQL VARCHAR2(32000 CHAR); -- Sentencia a ejecutar   
    V_ESQUEMA VARCHAR2(25 CHAR):= '#ESQUEMA#'; -- Configuracion Esquemas
    V_ESQUEMA_M VARCHAR2(25 CHAR):= '#ESQUEMA_MASTER#'; -- Configuracion Esquema Master 
    ERR_NUM NUMBER(25);  -- Vble. auxiliar para registrar errores en el script.
    ERR_MSG VARCHAR2(1024 CHAR); -- Vble. auxiliar para registrar errores en el script.
    V_USUARIO VARCHAR2(50 CHAR) := 'REMVIP-10553';

    V_ID NUMBER(16); -- Vble. para el id del activo
	V_COUNT NUMBER(16); -- Vble. para comprobar
    V_COUNT2 NUMBER(16):=0;
    V_COUNT_TOTAL NUMBER(16):=0;
    
	TYPE T_TIPO_DATA IS TABLE OF VARCHAR2(32000 CHAR);
    	TYPE T_ARRAY_DATA IS TABLE OF T_TIPO_DATA;
    	V_TIPO_DATA T_ARRAY_DATA := T_ARRAY_DATA(
            T_TIPO_DATA('5928026','6277005YJ3467N0001BO','0','3562,94'),
            T_TIPO_DATA('5930153','0433915FS1503S0004YY','30624,52','11611,79'),
            T_TIPO_DATA('5930886','6877015YJ3467N0001SO','0','1571,22'),
            T_TIPO_DATA('5931102','1174602CF4517C0012XH','10254,89','6616,66'),
            T_TIPO_DATA('5931194','7207401DR5870N0057HS','24137,82','2959,73'),
            T_TIPO_DATA('5934591','9019801UL8791N0001OK','130935,06','5102,76'),
            T_TIPO_DATA('5938036','6048201UH4564N0007YF','9462,92','1037,96'),
            T_TIPO_DATA('5938600','4809201VK4740H0004IK','12248,63','30911,58'),
            T_TIPO_DATA('5940817','6778821YJ3467N0001GO','17850,32','5898,62'),
            T_TIPO_DATA('5941593','9588801VK5798N0045AH','16704,68','20950,28'),
            T_TIPO_DATA('5944032','8597401DG9789N0010OB','19748,49','11180,41'),
            T_TIPO_DATA('5944115','2985201CF5528F0014AO','12779,8','1837,6'),
            T_TIPO_DATA('5944729','3626704VK4732F0007QP','28703,33','36786,61'),
            T_TIPO_DATA('5944924','9019801UL8791N0001OK','130935,06','5102,76'),
            T_TIPO_DATA('5945263','7583305TN8178S0002FP','7630,9','2975,58'),
            T_TIPO_DATA('5945587','6720605DG1062B0002WJ','21591,36','19674,9'),
            T_TIPO_DATA('5946153','9914608VK3791D0008BA','6703,2','37745,4'),
            T_TIPO_DATA('5951384','0433915FS1503S0005UU','30624,52','11611,79'),
            T_TIPO_DATA('5953586','9949306VK3794B0007RB','335448,57','881474,06'),
            T_TIPO_DATA('5953631','9063118DF2896C0002MT','18123,81','25448,58'),
            T_TIPO_DATA('5955267','1198928DF3819G0002ZE','24992,7','20785,7'),
            T_TIPO_DATA('5959010','7305905CG7570N0008BQ','5923,94','10254,99'),
            T_TIPO_DATA('5963121','9692303VK5799S0011RH','13218,86','19213,95'),
            T_TIPO_DATA('5963992','9170302DS5097S0350FO','22336,7','3151,56'),
            T_TIPO_DATA('5964766','3632611XG9933S0010WT','21631,92','13171,72'),
            T_TIPO_DATA('5966272','46180A022001510000RH','112775,33','8896,45'),
            T_TIPO_DATA('5966586','8243001YK3084S0010YZ','10034,39','5814,81'),
            T_TIPO_DATA('5967139','1993125DF5919S0028II','26243,77','39558,62'),
            T_TIPO_DATA('5968861','8716211BF8381F0005FD','4442,58','263,36'),
            T_TIPO_DATA('6049584','9949306VK3794B0002XG','335448,57','881474,06'),
            T_TIPO_DATA('6049687','9565702FT3096N0048EH','24622,36','17293,29'),
            T_TIPO_DATA('6058189','0394113FS1709S0002HQ','31579,77','42812,07'),
            T_TIPO_DATA('6060201','0812513DS6801S0008UW','25140,17','17788,56'),
            T_TIPO_DATA('6763526','2105403VK3620S0001KY','21418,38','36456,35'),
            T_TIPO_DATA('6824727','2684902UN9428S0001AY','1793,41','1140,44'),
            T_TIPO_DATA('6889247','9228713XG8892E0181ZT','32042,02','35573,11'),
            T_TIPO_DATA('6938298','8841901DF1784D0110PD','4890,57','3309,06'),
            T_TIPO_DATA('6938301','8841901DF1784D0100EY','4890,57','3309,06'),
            T_TIPO_DATA('6938322','8841901DF1784D0053GK','4890,57','3309,06'),
            T_TIPO_DATA('6938325','8841901DF1784D0057LX','4890,57','3309,06'),
            T_TIPO_DATA('6938328','8841901DF1784D0056KZ','4890,57','3309,06'),
            T_TIPO_DATA('6938329','8841901DF1784D0055JB','4890,57','3309,06'),
            T_TIPO_DATA('6938330','8841901DF1784D0054HL','4890,57','3309,06'),
            T_TIPO_DATA('6938331','8841901DF1784D0059ZQ','4890,57','3309,06'),
            T_TIPO_DATA('6938332','8841901DF1784D0060LX','4890,57','3309,06'),
            T_TIPO_DATA('6938333','8841901DF1784D0058BM','4890,57','3309,06'),
            T_TIPO_DATA('6938745','10065A018000360000AI','0','50,86'),
            T_TIPO_DATA('6938752','10065A018000370000AJ','0','236,72'),
            T_TIPO_DATA('6938756','10065A018000390000AS','0','288,51'),
            T_TIPO_DATA('6938774','10065A018000440000AU','0','145,68'),
            T_TIPO_DATA('6938967','8485505YJ1688N0011DR','6940,88','10351,48'),
            T_TIPO_DATA('6946495','8782432UL9388S0001PK','36105,83','17000,97'),
            T_TIPO_DATA('6963787','17056A001000020000MP','0','30868,3'),
            T_TIPO_DATA('6965872','8136301XG7683N0001MK','12853,69','7065,93'),
            T_TIPO_DATA('6965903','6721202VG4162B0003AU','30289,89','20026,87'),
            T_TIPO_DATA('6966885','0668705DF3806H0024JL','106966,64','82923,98'),
            T_TIPO_DATA('6966960','7561818FE0176S0004MS','50005,47','39292,17'),
            T_TIPO_DATA('6967358','4002001DG3040S0059ML','48570,2','14664,94'),
            T_TIPO_DATA('6971937','3985501DD7738F0077SY','72116,73','30739,5'),
            T_TIPO_DATA('6979841','8935101XG7683N0038BM','12654,36','2998,05'),
            T_TIPO_DATA('6980158','2815303XH3121N0005BZ','3417,8','14358,62'),
            T_TIPO_DATA('6980679','5418902XG2451G0014SP','7112,99','8217,55'),
            T_TIPO_DATA('6980716','1711301XH7111S0001LM','62033,96','20628'),
            T_TIPO_DATA('6980840','3084712XH5138C0001SL','0','32826,8'),
            T_TIPO_DATA('6981586','1056621XH7005N0006GP','9208,59','1342,79'),
            T_TIPO_DATA('6981587','1056621XH7005N0009KD','9208,59','1342,79'),
            T_TIPO_DATA('6981588','1056621XH7005N0017MK','9208,59','1342,79'),
            T_TIPO_DATA('6981613','1056621XH7005N0023EZ','9208,59','1342,79'),
            T_TIPO_DATA('6981680','1056621XH7005N0024RX','9208,59','1342,79'),
            T_TIPO_DATA('6981683','1056621XH7005N0022WB','9208,59','1342,79'),
            T_TIPO_DATA('6981991','2390002XG6829S0012XK','44888,88','8031,95'),
            T_TIPO_DATA('6982101','3734103XH5133S0001WK','16592,75','4075,97'),
            T_TIPO_DATA('6982344','4421901XG1742A0034RO','787,65','205,77'),
            T_TIPO_DATA('6982461','0271501YG0607S0024TI','5845,39','453,99'),
            T_TIPO_DATA('6982624','9455502XH6095S0016FE','22127,63','8788,75'),
            T_TIPO_DATA('6982698','8707111XH4280N0042TQ','29824,24','17665,75'),
            T_TIPO_DATA('6982719','8631603XG2483S0014ZS','37012,35','23056,61'),
            T_TIPO_DATA('6983072','8631603XG2483S0039JI','37012,35','23056,61'),
            T_TIPO_DATA('6985446','3567104XG8736N0001OB','47123,37','5534,96'),
            T_TIPO_DATA('6988046','2696412WF2929N0007DY','13938','4669,23'),
            T_TIPO_DATA('6989024','3318414DF2931G0003QU','29392,37','53720,17'),
            T_TIPO_DATA('6990369','0154814ED1805S0001BY','6919,73','4433,48'),
            T_TIPO_DATA('6990581','1614937FE0311N0001PJ','0','34289,97'),
            T_TIPO_DATA('6990606','002101700FE11C0001KI','21753,21','15894,07'),
            T_TIPO_DATA('6992392','8476701DD6887E0123DE','41284,11','5163,29'),
            T_TIPO_DATA('6993506','8576060VG2187N0030WK','27383,56','1993,46'),
            T_TIPO_DATA('6993635','0099113VG3099H0001KS','68843,8','8652,09'),
            T_TIPO_DATA('6994082','0955102VF5805F0001DI','58909,32','150852,98'),
            T_TIPO_DATA('6994659','1469502WG3016N0006RQ','12277,51','1344,66'),
            T_TIPO_DATA('6995433','7382907QB1378S0000LF','0','271029,05'),
            T_TIPO_DATA('6995575','3254105UF7635S0019UQ','23975,24','18397,11'),
            T_TIPO_DATA('6996493','8576605VG2187N0001KZ','10660,32','4489,12'),
            T_TIPO_DATA('6996495','7874211VG2177S0007AI','37905,11','9442,77'),
            T_TIPO_DATA('6996551','2696412WF2929N0004PE','13938','4669,23'),
            T_TIPO_DATA('6997326','3470003VF5637A0001RX','4924,42','11927,65'),
            T_TIPO_DATA('6998380','1103901XH6010S0230MG','34014,24','5906,4'),
            T_TIPO_DATA('6999296','9882019WG9298B0013FX','5544,65','2696,14'),
            T_TIPO_DATA('6999297','9882019WG9298B0014GM','5544,65','2696,14'),
            T_TIPO_DATA('6999419','9703719DG4190S0028JA','101727,94','33110,94'),
            T_TIPO_DATA('6999421','9703719DG4190S0029KS','101727,94','33110,94'),
            T_TIPO_DATA('6999753','1417102DF0911N0000RS','0','10257,36'),
            T_TIPO_DATA('6999863','6040403VG4164A0122RW','3511,56','633,12'),
            T_TIPO_DATA('6999864','6040403VG4164A0123TE','3511,56','633,12'),
            T_TIPO_DATA('6999865','6040403VG4164A0124YR','3511,56','633,12'),
            T_TIPO_DATA('6999866','6040403VG4164A0125UT','3511,56','633,12'),
            T_TIPO_DATA('6999869','6040403VG4164A0128PI','3511,56','633,12'),
            T_TIPO_DATA('6999870','6040403VG4164A0129AO','3511,56','633,12'),
            T_TIPO_DATA('7000143','6040403VG4164A0003AO','3511,56','633,12'),
            T_TIPO_DATA('7000144','6040403VG4164A0012JG','3511,56','633,12'),
            T_TIPO_DATA('7000146','6040403VG4164A0016ZL','3511,56','633,12'),
            T_TIPO_DATA('7000147','6040403VG4164A0017XB','3511,56','633,12'),
            T_TIPO_DATA('7000148','6040403VG4164A0018MZ','3511,56','633,12'),
            T_TIPO_DATA('7000149','6040403VG4164A0022QX','3511,56','633,12'),
            T_TIPO_DATA('7000151','6040403VG4164A0130OU','3511,56','633,12'),
            T_TIPO_DATA('7000153','6040403VG4164A0132AO','3511,56','633,12'),
            T_TIPO_DATA('7000155','6040403VG4164A0134DA','3511,56','633,12'),
            T_TIPO_DATA('7000156','6040403VG4164A0135FS','3511,56','633,12'),
            T_TIPO_DATA('7000157','6040403VG4164A0136GD','3511,56','633,12'),
            T_TIPO_DATA('7000175','6040403VG4164A0026TE','3511,56','633,12'),
            T_TIPO_DATA('7000176','6040403VG4164A0027YR','3511,56','633,12'),
            T_TIPO_DATA('7000177','6040403VG4164A0028UT','3511,56','633,12'),
            T_TIPO_DATA('7000178','6040403VG4164A0029IY','3511,56','633,12'),
            T_TIPO_DATA('7000181','6040403VG4164A0033OU','3511,56','633,12'),
            T_TIPO_DATA('7000182','6040403VG4164A0034PI','3511,56','633,12'),
            T_TIPO_DATA('7000184','6040403VG4164A0139KH','3511,56','633,12'),
            T_TIPO_DATA('7000185','6040403VG4164A0140HF','3511,56','633,12'),
            T_TIPO_DATA('7000186','6040403VG4164A0141JG','3511,56','633,12'),
            T_TIPO_DATA('7000187','6040403VG4164A0142KH','3511,56','633,12'),
            T_TIPO_DATA('7000188','6040403VG4164A0143LJ','3511,56','633,12'),
            T_TIPO_DATA('7000189','6040403VG4164A0144BK','3511,56','633,12'),
            T_TIPO_DATA('7000190','6040403VG4164A0145ZL','3511,56','633,12'),
            T_TIPO_DATA('7000207','6040403VG4164A0035AO','3511,56','633,12'),
            T_TIPO_DATA('7000208','6040403VG4164A0036SP','3511,56','633,12'),
            T_TIPO_DATA('7000210','6040403VG4164A0038FS','3511,56','633,12'),
            T_TIPO_DATA('7000211','6040403VG4164A0040DA','3511,56','633,12'),
            T_TIPO_DATA('7000212','6040403VG4164A0046LJ','3511,56','633,12'),
            T_TIPO_DATA('7000215','6040403VG4164A0147MZ','3511,56','633,12'),
            T_TIPO_DATA('7000240','6040403VG4164A0054QX','3511,56','633,12'),
            T_TIPO_DATA('7000242','6040403VG4164A0056EQ','3511,56','633,12'),
            T_TIPO_DATA('7000243','6040403VG4164A0057RW','3511,56','633,12'),
            T_TIPO_DATA('7000244','6040403VG4164A0059YR','3511,56','633,12'),
            T_TIPO_DATA('7000245','6040403VG4164A0064IY','3511,56','633,12'),
            T_TIPO_DATA('7000272','6040403VG4164A0080KH','3511,56','633,12'),
            T_TIPO_DATA('7000273','6040403VG4164A0081LJ','3511,56','633,12'),
            T_TIPO_DATA('7000274','6040403VG4164A0082BK','3511,56','633,12'),
            T_TIPO_DATA('7000275','6040403VG4164A0083ZL','3511,56','633,12'),
            T_TIPO_DATA('7000276','6040403VG4164A0085MZ','3511,56','633,12'),
            T_TIPO_DATA('7000277','6040403VG4164A0086QX','3511,56','633,12'),
            T_TIPO_DATA('7000278','6040403VG4164A0089RW','3511,56','633,12'),
            T_TIPO_DATA('7000303','6040403VG4164A0091EQ','3511,56','633,12'),
            T_TIPO_DATA('7000305','6040403VG4164A0094YR','3511,56','633,12'),
            T_TIPO_DATA('7000307','6040403VG4164A0099AO','3511,56','633,12'),
            T_TIPO_DATA('7000309','6040403VG4164A0102DA','3511,56','633,12'),
            T_TIPO_DATA('7000336','6040403VG4164A0105HF','3511,56','633,12'),
            T_TIPO_DATA('7000338','6040403VG4164A0107KH','3511,56','633,12'),
            T_TIPO_DATA('7000339','6040403VG4164A0108LJ','3511,56','633,12'),
            T_TIPO_DATA('7000342','6040403VG4164A0113ZL','3511,56','633,12'),
            T_TIPO_DATA('7000370','6040403VG4164A0117WM','3511,56','633,12'),
            T_TIPO_DATA('7009113','5461801DG8156S0200LF','61554,62','24615,97'),
            T_TIPO_DATA('7020502','6305501VK2860S0010ME','90574,53','460177,91'),
            T_TIPO_DATA('7030005','6427004VP3162E0007PG','36012,87','160763,64'),
            T_TIPO_DATA('7030006','6427004VP3162E0012SJ','36012,87','160763,64'),
            T_TIPO_DATA('7030017','6427004VP3162E0011AH','36012,87','160763,64'),
            T_TIPO_DATA('7030022','6427004VP3162E0006OF','36012,87','160763,64'),
            T_TIPO_DATA('7032397','7348402XH5074G0046HI','41113,51','28315,26'),
            T_TIPO_DATA('7071360','12071A014001470000UQ','0','633,53'),
            T_TIPO_DATA('7090281','9766006YH1896N0008KM','2036,65','798,98'),
            T_TIPO_DATA('7090295','9766006YH1896N0003DK','2036,65','798,98'),
            T_TIPO_DATA('7090301','9766006YH1896N0011KM','2036,65','798,98'),
            T_TIPO_DATA('7092361','0115002CG9001N0050DH','37478,62','15164,41'),
            T_TIPO_DATA('7096355','6504217WF1760S0003AS','30869,19','22761,85'),
            T_TIPO_DATA('7098470','0581415DG7208S0001WH','15707,51','15649,41'),
            T_TIPO_DATA('7099357','3650408BG9035S0031MO','18192,85','12834,21'),
            T_TIPO_DATA('7099499','9574507CF8897S0001SE','62299,46','34712,46'),
            T_TIPO_DATA('7099934','7462506ES8376S0007GA','39367,18','8380,04'),
            T_TIPO_DATA('7101391','1770263BE8717S0010QD','18138,39','6094,48'),
            T_TIPO_DATA('7101401','8286911VG5888N0001QJ','77771,75','17520,52'),
            T_TIPO_DATA('7101417','4757001VG6045D0076JQ','28087,05','36249,82'),
            T_TIPO_DATA('7101418','0393506DF2909G0043BZ','18935,28','10670,4'),
            T_TIPO_DATA('7101433','2854221VL1325S0001WZ','65606','22909,84'),
            T_TIPO_DATA('7101439','2432108UM7523S0018HH','13647,42','8811,98'),
            T_TIPO_DATA('7101486','0625601YH5802S0001SF','7053,23','22360,57'),
            T_TIPO_DATA('7101488','9549202YJ2894N0001DQ','74984,13','23095,11'),
            T_TIPO_DATA('7101492','6392405XG0569C0005IB','37870,67','22818,83'),
            T_TIPO_DATA('7101497','0520101BF7002B0022DG','24192,44','1749,74'),
            T_TIPO_DATA('7101527','3456905WF3635N0001KW','0','38605,66'),
            T_TIPO_DATA('7101531','7446103DG0574N0029UD','27612,33','4449,9'),
            T_TIPO_DATA('7101542','9549205YJ2894N0001JQ','232919,15','56491,3'),
            T_TIPO_DATA('7101545','9468053TG4396N0003DK','19456,82','32057,09'),
            T_TIPO_DATA('7101550','6667801XG7666N0002LH','48884,35','10422,95'),
            T_TIPO_DATA('7101568','0090202XH0109A0001BG','34019,11','8124,81'),
            T_TIPO_DATA('7101573','1054720XH7015S0012EW','39039,76','10265,44'),
            T_TIPO_DATA('7101576','2680017CF9928S0001JO','94828,66','11705,69'),
            T_TIPO_DATA('7101588','4485222VG9848N0001KE','104681,27','8133,38'),
            T_TIPO_DATA('7101597','3809620XH5130N0002AY','28152','6783'),
            T_TIPO_DATA('7101602','3809620XH5130N0037FO','28152','6783'),
            T_TIPO_DATA('7101608','0392814DS5009S0001LP','22555,8','69325,31'),
            T_TIPO_DATA('7101615','4246333YJ2744E0164MS','47430,01','11049,94'),
            T_TIPO_DATA('7101619','7968316VH6076N0001IS','49279,65','20700,42'),
            T_TIPO_DATA('7101623','3331707XJ6733A0007HJ','5877,28','1383,78'),
            T_TIPO_DATA('7101626','7691533CG1279S0007IT','28692,34','1294,05'),
            T_TIPO_DATA('7101642','6422102XH4362A0009LO','14651,6','4894,99'),
            T_TIPO_DATA('7101648','1054720XH7015S0003BL','39039,76','10265,44'),
            T_TIPO_DATA('7101653','8603405TN8280S0010QE','11727,45','7950,67'),
            T_TIPO_DATA('7101654','3331707XJ6733A0024RT','5877,28','1383,78'),
            T_TIPO_DATA('7101764','7848002DG0474N0043EH','5595,54','9792,55'),
            T_TIPO_DATA('7101766','1293329XG6819S0005XP','34908,64','8850,82'),
            T_TIPO_DATA('7101767','3660301DG5036S0001HY','85310,32','17686,51'),
            T_TIPO_DATA('7101777','4788807DF3848H0002XU','45584,43','57612,59'),
            T_TIPO_DATA('7101784','0393504DF2909G0029JD','18935,28','10670,4'),
            T_TIPO_DATA('7293111','3970113BE8937B0014KA','11819,34','528,77'),
            T_TIPO_DATA('7299517','3104906PB7230S0047GB','24946,12','40113,65'),
            T_TIPO_DATA('7299576','23090A012004490000KQ','0','68,55')


    	); 
    	V_TMP_TIPO_DATA T_TIPO_DATA;

BEGIN
	DBMS_OUTPUT.PUT_LINE('[INICIO]');
    DBMS_OUTPUT.PUT_LINE('[INFO]: ACTUALIZAR ACTIVOS A PUBLICADOS VENTA');

    FOR I IN V_TIPO_DATA.FIRST .. V_TIPO_DATA.LAST
        LOOP
    V_TMP_TIPO_DATA := V_TIPO_DATA(I);
    V_COUNT_TOTAL:=V_COUNT_TOTAL+1;

        --Comprobamos la existencia del activo
        V_MSQL := 'SELECT COUNT(1) FROM '||V_ESQUEMA||'.ACT_ACTIVO ACT
                    JOIN '||V_ESQUEMA||'.ACT_CAT_CATASTRO CAT ON CAT.ACT_ID=ACT.ACT_ID AND CAT.BORRADO = 0
                    WHERE ACT.ACT_NUM_ACTIVO = '''||V_TMP_TIPO_DATA(1)||''' AND CAT.CAT_REF_CATASTRAL= '''||V_TMP_TIPO_DATA(2)||''' ';
        EXECUTE IMMEDIATE V_MSQL INTO V_COUNT;	

        IF V_COUNT = 1 THEN

            --Obtenemos el ID del activo
        V_MSQL := 'SELECT CAT.CAT_ID FROM '||V_ESQUEMA||'.ACT_ACTIVO ACT
                    JOIN '||V_ESQUEMA||'.ACT_CAT_CATASTRO CAT ON CAT.ACT_ID=ACT.ACT_ID AND CAT.BORRADO = 0
                    WHERE ACT.ACT_NUM_ACTIVO = '''||V_TMP_TIPO_DATA(1)||''' AND CAT.CAT_REF_CATASTRAL= '''||V_TMP_TIPO_DATA(2)||''' ';
        EXECUTE IMMEDIATE V_MSQL INTO V_ID;

            --Actualizamos el estado de publicación
            V_MSQL:= 'UPDATE '||V_ESQUEMA||'.ACT_CAT_CATASTRO SET
            CAT_VALOR_CATASTRAL_CONST = '''||V_TMP_TIPO_DATA(3)||''',
            CAT_VALOR_CATASTRAL_SUELO = '''||V_TMP_TIPO_DATA(4)||''',
            USUARIOMODIFICAR = '''|| V_USUARIO ||''',
            FECHAMODIFICAR = SYSDATE
            WHERE CAT_ID = '||V_ID||'';
            EXECUTE IMMEDIATE V_MSQL;

            DBMS_OUTPUT.PUT_LINE('[INFO] CATASTRO ACTUALIZADO PARA EL ACTIVO '''||V_TMP_TIPO_DATA(1)||'''');

            V_COUNT2:=V_COUNT2+1;

        ELSE 

            DBMS_OUTPUT.PUT_LINE('[INFO] NO EXISTE EL ACTIVO '''||V_TMP_TIPO_DATA(1)||'''');

        END IF;

    END LOOP;

    DBMS_OUTPUT.PUT_LINE('[INFO] MODIFICADOS CORRECTAMENTE '''||V_COUNT2||''' DE '''||V_COUNT_TOTAL||''' ');

    COMMIT;

    DBMS_OUTPUT.PUT_LINE('[FIN]');
EXCEPTION
     WHEN OTHERS THEN
          ERR_NUM := SQLCODE;
          ERR_MSG := SQLERRM;
          DBMS_OUTPUT.put_line('[ERROR] Se ha producido un error en la ejecución:'||TO_CHAR(ERR_NUM));
          DBMS_OUTPUT.put_line('-----------------------------------------------------------'); 
          DBMS_OUTPUT.put_line(ERR_MSG);
          ROLLBACK;
          RAISE;   
END;
/
EXIT;