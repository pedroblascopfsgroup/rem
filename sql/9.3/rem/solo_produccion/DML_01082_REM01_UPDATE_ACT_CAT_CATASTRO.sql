--/*
--#########################################
--## AUTOR=Juan Bautista Alfonso
--## FECHA_CREACION=20211029
--## ARTEFACTO=online
--## VERSION_ARTEFACTO=9.3
--## INCIDENCIA_LINK=REMVIP-10553
--## PRODUCTO=NO
--## 
--## Finalidad: Actualizar catastro
--##			
--## INSTRUCCIONES:  
--## VERSIONES:
--##        0.1 Versión inicial
--#########################################
--*/

WHENEVER SQLERROR EXIT SQL.SQLCODE;
SET SERVEROUTPUT ON; 
SET DEFINE OFF; 
ALTER SESSION SET NLS_NUMERIC_CHARACTERS = ',.';

DECLARE


    V_MSQL VARCHAR2(32000 CHAR); -- Sentencia a ejecutar   
    V_ESQUEMA VARCHAR2(25 CHAR):= '#ESQUEMA#'; -- Configuracion Esquemas
    V_ESQUEMA_M VARCHAR2(25 CHAR):= '#ESQUEMA_MASTER#'; -- Configuracion Esquema Master 
    ERR_NUM NUMBER(25);  -- Vble. auxiliar para registrar errores en el script.
    ERR_MSG VARCHAR2(1024 CHAR); -- Vble. auxiliar para registrar errores en el script.
    V_USUARIO VARCHAR2(50 CHAR) := 'REMVIP-10553';

    V_ID NUMBER(16); -- Vble. para el id del activo
	V_COUNT NUMBER(16); -- Vble. para comprobar
    V_COUNT2 NUMBER(16):=0;
    V_COUNT_TOTAL NUMBER(16):=0;
    
	TYPE T_TIPO_DATA IS TABLE OF VARCHAR2(32000 CHAR);
    	TYPE T_ARRAY_DATA IS TABLE OF T_TIPO_DATA;
    	V_TIPO_DATA T_ARRAY_DATA := T_ARRAY_DATA(
           T_TIPO_DATA('5925249','0139404VK4703G0002SL','68385,88','442700,88'),
T_TIPO_DATA('5925363','9890501VL0399S0001UD','0','52009,99'),
T_TIPO_DATA('5925677','9890501VL0399S0001UD','0','52009,99'),
T_TIPO_DATA('5926411','44012A007000040000RE','0','2355,45'),
T_TIPO_DATA('5926457','5443903XH9454S0001XF','247733,55','87406,41'),
T_TIPO_DATA('5926508','6957620VK4765H0016AT','6654,49','30284,74'),
T_TIPO_DATA('5926622','5008829VK3750G0002QX','17010,28','35811,11'),
T_TIPO_DATA('5926628','8708711DG1080B0059WP','22420,13','14381,25'),
T_TIPO_DATA('5926764','4590308DF5949S0003MQ','46322,64','135602,6'),
T_TIPO_DATA('5926913','9890501VL0399S0001UD','0','52009,99'),
T_TIPO_DATA('5927118','4305905DR5840N0032LR','2737,45','277,95'),
T_TIPO_DATA('5927368','0288601TE8908N0003KK','26391,95','21922,73'),
T_TIPO_DATA('5927413','4388817DF3848G0003EX','9988,16','32905,6'),
T_TIPO_DATA('5927615','9890501VL0399S0001UD','0','52009,99'),
T_TIPO_DATA('5927717','8767521FT2186N0001SH','0','105532,2'),
T_TIPO_DATA('5927949','5954306QC2855S0001WI','18553,99','17395,87'),
T_TIPO_DATA('5928068','0488204XH9608N0001AK','80321,06','43637,69'),
T_TIPO_DATA('5928333','1715702VK5511N0011WF','20619,84','7473,52'),
T_TIPO_DATA('5928363','7305104WN4070N0008WL','17202,2','4094,46'),
T_TIPO_DATA('5928405','2670501DG8427B0029XR','23052,42','3927,97'),
T_TIPO_DATA('5928521','9890501VL0399S0001UD','0','52009,99'),
T_TIPO_DATA('5928667','6232024TG3563S0001KT','58378,85','18467,94'),
T_TIPO_DATA('5928727','7057005XG7675N0023KK','10111,17','4765,62'),
T_TIPO_DATA('5928969','4075005CS7447N0010YZ','23623,95','4503,99'),
T_TIPO_DATA('5928989','4569102DG8446H0002GT','11838,18','2323,55'),
T_TIPO_DATA('5929563','5851013YH5755S0006QH','332872,27','92434,44'),
T_TIPO_DATA('5929625','5426008CS2152N0196QX','25558,65','22070,01'),
T_TIPO_DATA('5929816','2870111DG8427B0003PU','23636,88','6113,88'),
T_TIPO_DATA('5929907','6209011VK8060N0028JL','34221,04','2454,22'),
T_TIPO_DATA('5929970','1607008NG2810N0012SU','33924,52','20434,54'),
T_TIPO_DATA('5929977','9597917YJ2699H0001GX','597,55','3878'),
T_TIPO_DATA('5930098','5851013YH5755S0005MG','332872,27','92434,44'),
T_TIPO_DATA('5930138','7618802VN0671N0020ZA','4706,68','546,91'),
T_TIPO_DATA('5930282','8006303VK6870N0009ZE','15196,42','43336,57'),
T_TIPO_DATA('5930470','4010220EG1441S0011XO','65953,85','6898,69'),
T_TIPO_DATA('5932161','50900A005002530000YA','0','10549,88'),
T_TIPO_DATA('5933022','6300713YJ4260S0024YO','24501,53','5210,55'),
T_TIPO_DATA('5933206','5587201BF9058H0027PD','26604,74','20394,05'),
T_TIPO_DATA('5933443','7219019DG3571N0001QX','212474,74','114029,37'),
T_TIPO_DATA('5933659','9890501VL0399S0001UD','0','52009,99'),
T_TIPO_DATA('5934088','9890501VL0399S0001UD','0','52009,99'),
T_TIPO_DATA('5934244','6291517DF3869A0001MF','7303,63','9362,7'),
T_TIPO_DATA('5934258','4366904DG8446E0041QT','19508,66','3864,91'),
T_TIPO_DATA('5934292','3970602DG8437B0007IG','11641,98','970,38'),
T_TIPO_DATA('5934344','3010113EG1431S0001IZ','30499,87','9150,13'),
T_TIPO_DATA('5934631','3159910EG0435N0026WL','23429,82','6954,47'),
T_TIPO_DATA('5934734','7158001VL0375N0023WF','0','52009,99'),
T_TIPO_DATA('5934995','9890501VL0399S0001UD','0','52009,99'),
T_TIPO_DATA('5935360','6541402TG3464S0007JM','5990,92','9134,64'),
T_TIPO_DATA('5935388','9890501VL0399S0001UD','0','52009,99'),
T_TIPO_DATA('5935453','8419321VK3781G0012OS','8605,2','21567,57'),
T_TIPO_DATA('5935516','4476722DF3847E0007FF','10201,81','12152,45'),
T_TIPO_DATA('5935643','7572014VJ6177S0001GE','13344,19','3701,53'),
T_TIPO_DATA('5935992','5860912DF2956S0020BZ','20854,26','10217,72'),
T_TIPO_DATA('5936682','6232024TG3563S0002LY','58378,85','18467,94'),
T_TIPO_DATA('5936694','6705607VK7960N0072QS','28182,22','28366,24'),
T_TIPO_DATA('5936728','4799301XG9849H0006GB','26259,19','28856,25'),
T_TIPO_DATA('5936769','6690801VK4869S0005MJ','15567,69','50072,92'),
T_TIPO_DATA('5936939','6538207VK2663N0016FL','20968,61','48178,81'),
T_TIPO_DATA('5937420','3457725PB8235N0007OS','12592,56','9444,34'),
T_TIPO_DATA('5937788','35020A020000560000ER','0','7242,07'),
T_TIPO_DATA('5938361','9890501VL0399S0001UD','0','52009,99'),
T_TIPO_DATA('5938384','8863504DS5986S0001MD','8834,86','16714,62'),
T_TIPO_DATA('5938520','0541503DF3904B0027SI','12994,95','34101,66'),
T_TIPO_DATA('5938547','9205605YH1590E0018EH','19227,87','1977,99'),
T_TIPO_DATA('5938968','9890501VL0399S0001UD','0','52009,99'),
T_TIPO_DATA('5939058','8787101EG0788N0067AL','23274,88','6202,65'),
T_TIPO_DATA('5939075','7536206QA4573F0217GG','23523,97','17799,94'),
T_TIPO_DATA('5939429','5597802BF9059E0014XH','15679,61','6646,18'),
T_TIPO_DATA('5939683','8473001VJ6187S0037QA','24129,56','15610,38'),
T_TIPO_DATA('5939707','9890501VL0399S0001UD','0','52009,99'),
T_TIPO_DATA('5939760','2744505XH1624D0001SW','2912,76','4528,32'),
T_TIPO_DATA('5939847','2917601VK6621N0023TZ','13615,77','48855,12'),
T_TIPO_DATA('5941423','7658001WF7875N0001GU','39188,02','5286,76'),
T_TIPO_DATA('5941661','8497203VK3689G0584EW','5593,78','1798,28'),
T_TIPO_DATA('5941768','9890501VL0399S0001UD','0','52009,99'),
T_TIPO_DATA('5941854','002533800DG71H0001QJ','47557,47','5882,15'),
T_TIPO_DATA('5942080','0723102DG6002A0003IX','32771,69','22048,15'),
T_TIPO_DATA('5942992','9454006VK7395S0001DF','18767,95','8567,98'),
T_TIPO_DATA('5943230','5152206CF9655S0004OR','40047,68','17935,75'),
T_TIPO_DATA('5944697','3050906YJ2635S0008DX','35923,74','13956,39'),
T_TIPO_DATA('5945372','9367105YH1696N0001BY','127870,44','24342,52'),
T_TIPO_DATA('5945596','5894206DF3859D0169GZ','45339,71','6754,53'),
T_TIPO_DATA('5946059','2894304XH7029S0003EX','5658,41','960,75'),
T_TIPO_DATA('5946275','9890501VL0399S0001UD','0','52009,99'),
T_TIPO_DATA('5946276','55248H0VK4752D0008GQ','14854,85','45370,64'),
T_TIPO_DATA('5946347','7488309CS7478N0005JW','20700,92','30036,14'),
T_TIPO_DATA('5946651','8104105DF2880C0009DZ','9474,23','22273,28'),
T_TIPO_DATA('5947092','7033901DS3173S0031WU','25458,09','12590,69'),
T_TIPO_DATA('5947201','46241A006006630000MD','0','411,32'),
T_TIPO_DATA('5948276','1305001XH6010N0062ZQ','18895,5','6650'),
T_TIPO_DATA('5948477','1542303VL0614S0001WE','84296','7682,46'),
T_TIPO_DATA('5948645','5426008CS2152N0639MZ','25558,65','22070,01'),
T_TIPO_DATA('5948689','1682001DF5918S0030OD','2916,68','1842,31'),
T_TIPO_DATA('5949240','8611705VK6881S0040DT','124215,7','184231,75'),
T_TIPO_DATA('5949368','06014A050001910000DQ','0','847,8'),
T_TIPO_DATA('5949727','4164601YH0046S0250EG','28814,45','33350,88'),
T_TIPO_DATA('5949837','6156826DF2965N0019BW','18609,27','9117,77'),
T_TIPO_DATA('5949870','0433915FS1503S0003TT','30624,52','11611,79'),
T_TIPO_DATA('5949968','8497203VK3689G0584EW','5593,78','1798,28'),
T_TIPO_DATA('5949988','4650501YJ2745B0011OU','26185,28','7917'),
T_TIPO_DATA('5950860','0723102DG6002A0005PQ','32771,69','22048,15'),
T_TIPO_DATA('5951010','7093504DG5679S0030GI','15391,31','20662,27'),
T_TIPO_DATA('5951580','0015001YH8900S0001QZ','0','128,95'),
T_TIPO_DATA('5951689','1716015DD7811F0009QZ','21246,63','16062,16'),
T_TIPO_DATA('5951915','5368413YH0056N0037AZ','30476,34','39781,29'),
T_TIPO_DATA('5951973','4545101DF0944N0017BB','91385,88','83324,12'),
T_TIPO_DATA('5952169','46165A002000780000FF','0','23889,16'),
T_TIPO_DATA('5952640','001029200DG30D0001IJ','76420,68','13814,61'),
T_TIPO_DATA('5952701','0896610CG0009F0037TA','10969,64','8384,88'),
T_TIPO_DATA('5952864','9013083TF7091S0011HZ','17985,36','15501,27'),
T_TIPO_DATA('5952939','8637102YJ1783N0020WX','9636,32','7145,56'),
T_TIPO_DATA('5952940','6376402YJ3467N0001LO','0','137,44'),
T_TIPO_DATA('5953020','9970414VK7597S0001GS','31954,29','14438,11'),
T_TIPO_DATA('5953355','1115153VL1311N0027KU','46087,57','3606,08'),
T_TIPO_DATA('5953709','4340411XH8144N0003YM','17098,58','8775,88'),
T_TIPO_DATA('5954128','3766104QB5336N0025YM','42683,34','19035,81'),
T_TIPO_DATA('5954309','2429044YJ3422N0001UM','0','189,55'),
T_TIPO_DATA('5954863','6581607VG4168B0003XJ','6107,44','1474,89'),
T_TIPO_DATA('5955031','8787101EG0788N0040DZ','23274,88','6202,65'),
T_TIPO_DATA('5955219','9185911PG7998N0010MQ','12363,6','390,41'),
T_TIPO_DATA('5955259','9890501VL0399S0001UD','0','52009,99'),
T_TIPO_DATA('5955279','9890501VL0399S0001UD','0','52009,99'),
T_TIPO_DATA('5955477','6988501UK8668N0040GJ','23276,36','7104,26'),
T_TIPO_DATA('5955529','9890501VL0399S0001UD','0','52009,99'),
T_TIPO_DATA('5955632','5968109VG2156H0004PP','38140,94','4233,11'),
T_TIPO_DATA('5956534','0920822VK4702B0004JT','14865,67','79214,13'),
T_TIPO_DATA('5956823','4687008DG7048N0011IZ','7164,46','13110,94'),
T_TIPO_DATA('5956963','4202302DG5040S0012HI','22844,19','30176,21'),
T_TIPO_DATA('5957002','1320903YJ2712S0009HG','33470,7','10710,9'),
T_TIPO_DATA('5957052','6214901VK4761C0253XG','24982,42','37268,32'),
T_TIPO_DATA('5957171','9890501VL0399S0001UD','0','52009,99'),
T_TIPO_DATA('5957969','9619808VG2891N0014AF','13311,63','8300,31'),
T_TIPO_DATA('5959250','8855358VJ9385N0003ZD','11974,89','3563,93'),
T_TIPO_DATA('5959487','5864104VK4756D0079UR','7317,88','38787,2'),
T_TIPO_DATA('5959688','5184516VK1958S0005HA','7139,66','2213,09'),
T_TIPO_DATA('5959862','8123418DG7382S0001AB','15812,01','9739,16'),
T_TIPO_DATA('5960142','6343717DF4964S0003ZR','15205,81','4009,5'),
T_TIPO_DATA('5960174','2934008QH0123S0001FQ','503197,1','104181,15'),
T_TIPO_DATA('5960343','5609704XH9550N0010KK','21100,86','5202,29'),
T_TIPO_DATA('5960408','9890501VL0399S0001UD','0','52009,99'),
T_TIPO_DATA('5960827','8172617DG8187S0021PY','32107,17','2726,63'),
T_TIPO_DATA('5961254','6975032YJ3467N0000MI','0','2184,35'),
T_TIPO_DATA('5961564','9919818DF0991N0008QY','25946,24','8097,95'),
T_TIPO_DATA('5962973','0243612UG4904S0004KM','26952,27','13999,89'),
T_TIPO_DATA('5963576','1002202BF9210C0070YG','13547,81','5237,46'),
T_TIPO_DATA('5963663','0761110VJ7806S0001BT','75159,97','60212,64'),
T_TIPO_DATA('5963674','8375701XG8787N0019SE','83393,41','35400,04'),
T_TIPO_DATA('5963908','9304802TF7090S0004YM','6859,2','8171,2'),
T_TIPO_DATA('5964029','5126601XH7152E0005AJ','10611,31','9533,16'),
T_TIPO_DATA('5964827','4366903DG8446E0033PM','10145,65','3341,19'),
T_TIPO_DATA('5964935','2191215DF5929S0002LG','49652,19','26927,78'),
T_TIPO_DATA('5965091','4590307DF5949S0002DM','45634,68','133588,7'),
T_TIPO_DATA('5965585','8209502DG5080N0006HD','8631,71','29640,77'),
T_TIPO_DATA('5965703','2275701YJ2327N0031JB','13560,74','6914,7'),
T_TIPO_DATA('5966172','2591401CS7429S0014BD','15311,32','16028,15'),
T_TIPO_DATA('5966233','4162401YH0046S0004JQ','5430,4','7022,26'),
T_TIPO_DATA('5966281','5426008CS2152N0197WM','25558,65','22070,01'),
T_TIPO_DATA('5966312','7201615PB8770S0001YH','19280,67','10350,96'),
T_TIPO_DATA('5966464','8767521FT2186N0001SH','0','105532,2'),
T_TIPO_DATA('5966951','0014001BC3855S0001LL','63250,34','3699,81'),
T_TIPO_DATA('5967203','9431111DG7193S0002BO','60887,79','8943,96'),
T_TIPO_DATA('5967415','6300413DR5860S0072RW','8025,45','7253,65'),
T_TIPO_DATA('5967522','0690503CS6409S0001HY','108063,65','53323,18'),
T_TIPO_DATA('5967676','43072A025000390000LE','0','2,19'),
T_TIPO_DATA('5967716','6140119VK2664S0017RX','18865,05','55397,66'),
T_TIPO_DATA('5967786','7366202XG7676N0004GX','47934,95','11377,2'),
T_TIPO_DATA('5967942','2001601CG0120H0101XE','4676,1','3777,42'),
T_TIPO_DATA('5968086','9890501VL0399S0001UD','0','52009,99'),
T_TIPO_DATA('5968148','0166212EG1706N0176AB','9850,87','20961,18'),
T_TIPO_DATA('5968359','9962501VK3696D0102ML','14934,02','35298,6'),
T_TIPO_DATA('5968696','4076801CS7437N0002WS','17332,68','13209,41'),
T_TIPO_DATA('5968947','2306305XH9620N0008TS','8967','7243,75'),
T_TIPO_DATA('5968960','3574608DG8437D0002JT','46201,46','13621,68'),
T_TIPO_DATA('5969024','9890501VL0399S0001UD','0','52009,99'),
T_TIPO_DATA('5969088','9890501VL0399S0001UD','0','52009,99'),
T_TIPO_DATA('5969337','6927101UF4462N0117EQ','67530,2','48807,01'),
T_TIPO_DATA('5969526','9263501FT3096S0014ZX','46752,82','13471,71'),
T_TIPO_DATA('5969625','1878801PB8217N0028ZU','32846,38','8593,82'),
T_TIPO_DATA('5969875','6498414CR3969N0009LR','17572,39','7235,67'),
T_TIPO_DATA('5970146','8932101XH3383B0014PP','8207,61','4389,07'),
T_TIPO_DATA('5970237','4560003UK4246S0041WI','16777,12','21642,54'),
T_TIPO_DATA('5971538','43008A019000140000IJ','0','323,73'),
T_TIPO_DATA('5971573','6056801ES7165N0089ZK','22631,52','21244,79'),
T_TIPO_DATA('6045061','5700805EG0650S0001KP','176427,57','8555,23'),
T_TIPO_DATA('6046391','6593111DR5769S0002OO','3809,45','405,15'),
T_TIPO_DATA('6050788','0609904VK5500N0016DZ','21250,35','32242,56'),
T_TIPO_DATA('6051060','1789702VK4618H0295AM','49581,58','46809,85'),
T_TIPO_DATA('6051610','2667701VK4626H0033IS','43836,9','31502,6'),
T_TIPO_DATA('6051828','3841001VH0834S0018YZ','15342,77','5958,08'),
T_TIPO_DATA('6058016','6326902UF0362N0063MX','23209,87','37131,82'),
T_TIPO_DATA('6058506','0825102DG8602N0033IU','17467,22','10417,4'),
T_TIPO_DATA('6061585','7426622CG4172N0001YK','2187,97','1945,52'),
T_TIPO_DATA('6061690','6709991UK9760N0001DO','82017,49','20220,39'),
T_TIPO_DATA('6063280','30048F6VK4730C0001KS','17349,26','45792'),
T_TIPO_DATA('6063322','1844301DG8114S0020YK','6525,12','548,28'),
T_TIPO_DATA('6063361','9042211UN9494S0001ES','39442,89','7608,25'),
T_TIPO_DATA('6063750','6579001TG3367N0097HO','20026,83','12715,46'),
T_TIPO_DATA('6064351','7900402XH5070S0002OW','62148,92','19592,97'),
T_TIPO_DATA('6064468','0892401VK6709S0117RQ','31169,85','17163,86'),
T_TIPO_DATA('6073483','2692707QB6329S0006OI','4747,19','4303,68'),
T_TIPO_DATA('6074974','1224301XG0212S0018IY','39289,94','12518,4'),
T_TIPO_DATA('6075225','0148303TF5804G0001TB','33953,78','9953,11'),
T_TIPO_DATA('6343947','3398103DS4639N1141JG','10425,88','33190,75'),
T_TIPO_DATA('6343953','3398103DS4639N1139KH','10425,88','33190,75'),
T_TIPO_DATA('6344570','6972801XH6067S0064ES','4329,14','783,73'),
T_TIPO_DATA('6521576','D78D01300XG78D0001LU','134993,4','24695,46'),
T_TIPO_DATA('6524707','5183502VG4158C0016SO','24807,44','3708,77'),
T_TIPO_DATA('6526887','2334034VG5123C0101AU','15896,67','4551,48'),
T_TIPO_DATA('6529591','9863609VK3696E0005BT','14106,02','39083,18'),
T_TIPO_DATA('6704295','3068601PB8236N0009OI','6626,07','3897,65'),
T_TIPO_DATA('6706200','8926301XG4682N0119AY','2276,41','1496,54'),
T_TIPO_DATA('6763225','1873203BE8717S0004KP','13823,33','8348,19'),
T_TIPO_DATA('6763519','3118958VK4731G0013PT','1444,74','11086,92'),
T_TIPO_DATA('6763565','9620908VK6892S0005XE','66163,12','128049,47'),
T_TIPO_DATA('6780522','2607303XH9620N0019XB','46318,69','7035,94'),
T_TIPO_DATA('6787748','0740104CF5504B0004DT','9608,43','8792,48'),
T_TIPO_DATA('6803419','6134507VL0363S0074OB','235879,99','310776,23'),
T_TIPO_DATA('6809745','40075A015200070000OF','0','407,26'),
T_TIPO_DATA('6818296','03132A001001980000TF','0','8948,93'),
T_TIPO_DATA('6819288','2888006QB6328N0002HW','9468,37','7712,94'),
T_TIPO_DATA('6824829','4016301VK4741E0002WY','11620','47295,17'),
T_TIPO_DATA('6825018','7886017VK1378N0019LG','12376,32','1707,19'),
T_TIPO_DATA('6827666','3990819DF5939S0001XK','37260,09','202179,6'),
T_TIPO_DATA('6828898','6826001DG1062D0001OA','33813,11','22868,18'),
T_TIPO_DATA('6830236','12084A053000550000QP','0','678,48'),
T_TIPO_DATA('6833254','07033A018002000000AE','0','1025,27'),
T_TIPO_DATA('6833609','5910502XM7151B0001ZZ','22425,03','30820,03'),
T_TIPO_DATA('6936201','9937605DG5793N0001WY','16182,96','1012,05'),
T_TIPO_DATA('6939928','6040868WM8864S0005GM','5193,59','2961,04'),
T_TIPO_DATA('6940735','0868202WM6906N0001YW','113130,18','84847,62'),
T_TIPO_DATA('6945270','9997401VL5699N0001UA','22542,07','12925,72'),
T_TIPO_DATA('6964221','0772644YK5206N0015JI','21041,44','3174,05'),
T_TIPO_DATA('6965684','7154101XG7675S0156DU','24159,37','11634,56'),
T_TIPO_DATA('6965688','4954004XH6745D0029RX','22337,74','25449,89'),
T_TIPO_DATA('6965703','9471411WJ9197A0001PR','167587,89','283214,25'),
T_TIPO_DATA('6965732','3848717CG8034N0001AP','74843,86','16875,6'),
T_TIPO_DATA('6965734','1085614YH0308D0033TW','44008','26200,25'),
T_TIPO_DATA('6965742','3940809CG8034S0002GL','13301,31','19324,35'),
T_TIPO_DATA('6965783','3221709VK4732A0005TO','16255,46','192041,78'),
T_TIPO_DATA('6965787','2770605DF3827B0112BU','24812,34','34219,31'),
T_TIPO_DATA('6965788','6239101VG4163G0042WR','204665,81','136305,17'),
T_TIPO_DATA('6965810','1211508DD7811A0039ZB','56002,59','25945,18'),
T_TIPO_DATA('6965826','0170305VK3606N0004XE','20234,97','63460,32'),
T_TIPO_DATA('6965827','2159431VK5725N0809WY','36098,66','62910,73'),
T_TIPO_DATA('6965834','2442405CF9624S0001XK','30732,82','30180,6'),
T_TIPO_DATA('6965835','6547918EE9364N0002KM','17537,14','20928,24'),
T_TIPO_DATA('6965844','6513301VK6861S0054PI','54191,85','48485,68'),
T_TIPO_DATA('6965849','8542802VK3784B0002DA','39708,13','33276,6'),
T_TIPO_DATA('6965850','5086002VK1958N0013SI','20563,47','37662'),
T_TIPO_DATA('6965855','6198601DR5769N0061KL','19896,58','1991,54'),
T_TIPO_DATA('6965858','3278601CD6037N0019SU','26525,71','41367,93'),
T_TIPO_DATA('6965873','2968801DD5726N0010XD','1609,27','941,74'),
T_TIPO_DATA('6965882','8822404DD6882B0001SP','37648,24','19076,45'),
T_TIPO_DATA('6965911','8989404DF1789B0274IF','14261,28','17687,76'),
T_TIPO_DATA('6965919','8247105YJ1784N0001FE','54105,59','89921,86'),
T_TIPO_DATA('6965923','8013402DG1081B0408QE','20471,4','10725,5'),
T_TIPO_DATA('6965924','2608503YK5320N0001BM','62497,16','73175,96'),
T_TIPO_DATA('6966760','9571010WJ9197B0004EH','19052,79','174381,46'),
T_TIPO_DATA('6966779','0896801YH2409F0094ZJ','53099,89','11220,98'),
T_TIPO_DATA('6966793','1268608YJ2316N0001XQ','24253,27','83020,22'),
T_TIPO_DATA('6966822','3561502PB8236S0002QO','18907,35','4587,22'),
T_TIPO_DATA('6966833','4553201XG7645S0004HQ','27924,72','12887,43'),
T_TIPO_DATA('6966835','2024627VK6622S0405QM','185538,54','248541,87'),
T_TIPO_DATA('6966864','0692901YH2409B0143AJ','42761,87','1750,38'),
T_TIPO_DATA('6966865','0291893WG2409S0003DG','170022,99','86866,29'),
T_TIPO_DATA('6966874','1325216DG8612N0029WP','46692,82','6007,29'),
T_TIPO_DATA('6966891','5028401XM7152G0003LH','48893,36','40852,68'),
T_TIPO_DATA('6966894','0816410DF2801F0069HY','18866,69','26709'),
T_TIPO_DATA('6966901','8192608DF2789C0009BI','36810,39','40773,13'),
T_TIPO_DATA('6966911','2599608DF2729H0003IM','29721,21','45602,52'),
T_TIPO_DATA('6966919','2859704DF3925N0091AM','40313,91','7706,26'),
T_TIPO_DATA('6966921','7495203YK5279N0027KR','126733,46','25996,6'),
T_TIPO_DATA('6967318','0330701DD7803A0071UQ','91681,7','33088,92'),
T_TIPO_DATA('6967349','2588703EE7228N0015TP','58803,48','9292,75'),
T_TIPO_DATA('6969530','6907708XH4660H0001RX','0','34781,04'),
T_TIPO_DATA('6971939','1516603DD7811F0060HI','98987,54','47458,29'),
T_TIPO_DATA('6971944','2716501DD7821F0001LJ','61065,8','23478,91'),
T_TIPO_DATA('6979321','7318308XG2471N0003XR','13273045,89','6581705,47'),
T_TIPO_DATA('6980717','5231405XH7153A0003HL','13533,68','5362,4'),
T_TIPO_DATA('6980790','30023A009008190000OS','0','4995,7'),
T_TIPO_DATA('6981375','6608011XH4660H0061QK','5556,36','662,1'),
T_TIPO_DATA('6981651','7492115XG5979S0001FM','46680,12','26276,25'),
T_TIPO_DATA('6981678','7495107XG5979N0009GM','2270,01','509,6'),
T_TIPO_DATA('6981702','2390002XG6829S0004JD','44888,88','8031,95'),
T_TIPO_DATA('6981703','2390002XG6829S0005KF','44888,88','8031,95'),
T_TIPO_DATA('6982555','2169505YG0626N0001JB','41718,83','13523,31'),
T_TIPO_DATA('6982672','8987501XG8788F0016ZF','11951,62','1574,05'),
T_TIPO_DATA('6983299','4671004XH6047S0002HY','3263,14','732,55'),
T_TIPO_DATA('6984474','1010306XH6010N0004EU','67102,26','18271,58'),
T_TIPO_DATA('6984482','9678302WH9197H0036BJ','6631,71','1134,14'),
T_TIPO_DATA('6985524','8808409XG8980N0001JJ','0','19850,43'),
T_TIPO_DATA('6987279','7399201XH4576G0377EJ','38339,98','7425,81'),
T_TIPO_DATA('6988591','9849608DF1994N0012ZQ','7673,91','7230,55'),
T_TIPO_DATA('6988786','2421906CF8622S0001XK','73737,03','32833,53'),
T_TIPO_DATA('6989096','2807026DG0220A0091AK','1608,39','963,37'),
T_TIPO_DATA('6989161','39052A604000120000WE','0','1850,77'),
T_TIPO_DATA('6990333','07033A023004900000AP','0','672,15'),
T_TIPO_DATA('6990826','7142901EE9174C0061XT','16553,58','34104,64'),
T_TIPO_DATA('6990830','7144904EE9174C0007MG','15121,39','24410,45'),
T_TIPO_DATA('6991228','7142901EE9174C0070TA','16553,58','34104,64'),
T_TIPO_DATA('6991230','7142901EE9174C0074OG','16553,58','34104,64'),
T_TIPO_DATA('6991645','1881422EE7218S0003YT','17392,18','16915,81'),
T_TIPO_DATA('6992781','8358110YJ1885N0094GX','57000,22','39830,88'),
T_TIPO_DATA('6993060','8314829YJ1781S0001UY','0','183696,77'),
T_TIPO_DATA('6993061','8314829YJ1781S0001UY','0','183696,77'),
T_TIPO_DATA('6993062','8314829YJ1781S0001UY','0','183696,77'),
T_TIPO_DATA('6993063','8314829YJ1781S0001UY','0','183696,77'),
T_TIPO_DATA('6993064','8314829YJ1781S0001UY','0','183696,77'),
T_TIPO_DATA('6993080','8314829YJ1781S0001UY','0','183696,77'),
T_TIPO_DATA('6993081','8314829YJ1781S0001UY','0','183696,77'),
T_TIPO_DATA('6993082','8314829YJ1781S0001UY','0','183696,77'),
T_TIPO_DATA('6993083','8314829YJ1781S0001UY','0','183696,77'),
T_TIPO_DATA('6993084','8314829YJ1781S0001UY','0','183696,77'),
T_TIPO_DATA('6993085','8314829YJ1781S0001UY','0','183696,77'),
T_TIPO_DATA('6993086','8314829YJ1781S0001UY','0','183696,77'),
T_TIPO_DATA('6993087','8314829YJ1781S0001UY','0','183696,77'),
T_TIPO_DATA('6994305','6524933WG2662D0014MQ','3095,39','463,53'),
T_TIPO_DATA('6999559','8620030CG1082S0003LF','3100,73','2422,16'),
T_TIPO_DATA('7000665','7306701DG2070B0021AS','15235,8','12347,81'),
T_TIPO_DATA('7001625','5890802DF0959S0006RJ','6773,2','1696,61'),
T_TIPO_DATA('7001805','0821035DF1902S0001HM','68940,87','26944,12'),
T_TIPO_DATA('7008833','1072801VK6717S0018WG','44609,84','19295,11'),
T_TIPO_DATA('7010096','5483301DF2758C0001TJ','8501,61','19397,16'),
T_TIPO_DATA('7012957','6916502DS5161N0087AE','9337,22','8758,14'),
T_TIPO_DATA('7030028','2830016VP3123B0001QY','0','209228,41'),
T_TIPO_DATA('7073213','3095601CF7529N0070QX','3870,61','0'),
T_TIPO_DATA('7075780','4510706XH6141S0018YF','47023,63','28451,89'),
T_TIPO_DATA('7089346','30019A026000270000TY','0','19814,4'),
T_TIPO_DATA('7089352','0153805WF1605S0028TK','23372,22','15990,19'),
T_TIPO_DATA('7089355','0153805WF1605S0025WG','23372,22','15990,19'),
T_TIPO_DATA('7091544','03089A001000340000MP','0','970,13'),
T_TIPO_DATA('7225579','3331501CF5533A0024AT','72727,67','74324,97'),
T_TIPO_DATA('7226831','5194502BF9059C0172QK','16238,73','7611,18'),
T_TIPO_DATA('7229645','3570301TL7337B0104LK','26511,45','8312,71'),
T_TIPO_DATA('7292532','8475601VG2187N0038DE','27383,56','1993,46'),
T_TIPO_DATA('7294178','9711502DD6891B0048FO','113882,27','59490,47'),
T_TIPO_DATA('7294387','4909704XG1740H0001ZF','2892,12','48761,45'),
T_TIPO_DATA('7296873','5615215XG1751F0004DB','36144,59','33731,19'),
T_TIPO_DATA('7299642','7357804UK8975N0015SG','3640,53','1654,75'),
T_TIPO_DATA('7300713','9709801WF1690N0765IU','24220,2','14791,7'),
T_TIPO_DATA('7300714','9709801WF1690N0771AP','24220,2','14791,7'),
T_TIPO_DATA('7300715','9709801WF1690N0779LK','24220,2','14791,7'),
T_TIPO_DATA('7300716','9709801WF1690N0756WQ','24220,2','14791,7'),
T_TIPO_DATA('7300718','9709801WF1690N0768AP','24220,2','14791,7'),
T_TIPO_DATA('7300719','9709801WF1690N0780JH','24220,2','14791,7'),
T_TIPO_DATA('7300720','9709801WF1690N0761RE','24220,2','14791,7'),
T_TIPO_DATA('7300721','9709801WF1690N0760EW','24220,2','14791,7'),
T_TIPO_DATA('7300722','9709801WF1690N0764UY','24220,2','14791,7'),
T_TIPO_DATA('7300723','9709801WF1690N0775GF','24220,2','14791,7'),
T_TIPO_DATA('7300724','9709801WF1690N0769SA','24220,2','14791,7'),
T_TIPO_DATA('7300725','9709801WF1690N0773DS','24220,2','14791,7'),
T_TIPO_DATA('7300726','9709801WF1690N0778KJ','24220,2','14791,7'),
T_TIPO_DATA('7300728','9709801WF1690N0772SA','24220,2','14791,7'),
T_TIPO_DATA('7300729','9709801WF1690N0776HG','24220,2','14791,7'),
T_TIPO_DATA('7300731','9709801WF1690N0770PO','24220,2','14791,7'),
T_TIPO_DATA('7300732','9709801WF1690N0767PO','24220,2','14791,7'),
T_TIPO_DATA('7300733','9709801WF1690N0759TR','24220,2','14791,7'),
T_TIPO_DATA('7300734','9709801WF1690N0762TR','24220,2','14791,7'),
T_TIPO_DATA('7300736','9709801WF1690N0777JH','24220,2','14791,7'),
T_TIPO_DATA('7300737','9709801WF1690N0816MX','24220,2','14791,7'),
T_TIPO_DATA('7300738','9709801WF1690N0795YT','24220,2','14791,7'),
T_TIPO_DATA('7300739','9709801WF1690N0789EW','24220,2','14791,7'),
T_TIPO_DATA('7300740','9709801WF1690N0814ZB','24220,2','14791,7'),
T_TIPO_DATA('7300741','9709801WF1690N0788WQ','24220,2','14791,7'),
T_TIPO_DATA('7300742','9709801WF1690N0784ZB','24220,2','14791,7'),
T_TIPO_DATA('7300743','9709801WF1690N0783BL','24220,2','14791,7'),
T_TIPO_DATA('7300744','9709801WF1690N0812LK','24220,2','14791,7'),
T_TIPO_DATA('7300745','9709801WF1690N0802SA','24220,2','14791,7'),
T_TIPO_DATA('7300746','9709801WF1690N0782LK','24220,2','14791,7'),
T_TIPO_DATA('7300747','9709801WF1690N0787QM','24220,2','14791,7'),
T_TIPO_DATA('7300748','9709801WF1690N0815XZ','24220,2','14791,7'),
T_TIPO_DATA('7300749','9709801WF1690N0803DS','24220,2','14791,7'),
T_TIPO_DATA('7300751','9709801WF1690N0808KJ','24220,2','14791,7'),
T_TIPO_DATA('7300752','9709801WF1690N0794TR','24220,2','14791,7'),
T_TIPO_DATA('7300754','9709801WF1690N0793RE','24220,2','14791,7'),
T_TIPO_DATA('7300756','9709801WF1690N0786MX','24220,2','14791,7'),
T_TIPO_DATA('7300757','9709801WF1690N0785XZ','24220,2','14791,7'),
T_TIPO_DATA('7300759','9709801WF1690N0805GF','24220,2','14791,7'),
T_TIPO_DATA('7300760','9709801WF1690N0790QM','24220,2','14791,7'),
T_TIPO_DATA('7300761','9709801WF1690N0804FD','24220,2','14791,7'),
T_TIPO_DATA('7300762','9709801WF1690N0845BL','24220,2','14791,7'),
T_TIPO_DATA('7300763','9709801WF1690N0847XZ','24220,2','14791,7'),
T_TIPO_DATA('7300764','9709801WF1690N0842JH','24220,2','14791,7'),
T_TIPO_DATA('7300769','9709801WF1690N0848MX','24220,2','14791,7'),
T_TIPO_DATA('7300770','9709801WF1690N0826UY','24220,2','14791,7'),
T_TIPO_DATA('7300772','9709801WF1690N0823RE','24220,2','14791,7'),
T_TIPO_DATA('7300773','9709801WF1690N0841HG','24220,2','14791,7'),
T_TIPO_DATA('7300774','9709801WF1690N0819EW','24220,2','14791,7'),
T_TIPO_DATA('7300775','9709801WF1690N0820QM','24220,2','14791,7'),
T_TIPO_DATA('7300776','9709801WF1690N0835DS','24220,2','14791,7'),
T_TIPO_DATA('7300777','9709801WF1690N0846ZB','24220,2','14791,7'),
T_TIPO_DATA('7300781','9709801WF1690N0840GF','24220,2','14791,7'),
T_TIPO_DATA('7300783','9709801WF1690N0839JH','24220,2','14791,7'),
T_TIPO_DATA('7300785','9709801WF1690N0831OI','24220,2','14791,7'),
T_TIPO_DATA('7300786','9709801WF1690N0844LK','24220,2','14791,7'),
T_TIPO_DATA('7300787','9709801WF1690N0851MX','24220,2','14791,7'),
T_TIPO_DATA('7300790','9709801WF1690N0849QM','24220,2','14791,7'),
T_TIPO_DATA('7300792','9709801WF1690N0850XZ','24220,2','14791,7'),
T_TIPO_DATA('7300793','9709801WF1690N0832PO','24220,2','14791,7'),
T_TIPO_DATA('7300794','9709801WF1690N0825YT','24220,2','14791,7'),
T_TIPO_DATA('7300795','9709801WF1690N0829PO','24220,2','14791,7'),
T_TIPO_DATA('7300796','9709801WF1690N0834SA','24220,2','14791,7'),
T_TIPO_DATA('7300797','9709801WF1690N0837GF','24220,2','14791,7'),
T_TIPO_DATA('7300798','9709801WF1690N0838HG','24220,2','14791,7'),
T_TIPO_DATA('7300799','9709801WF1690N0827IU','24220,2','14791,7'),
T_TIPO_DATA('7300800','9709801WF1690N0830IU','24220,2','14791,7'),
T_TIPO_DATA('7300801','9709801WF1690N0836FD','24220,2','14791,7'),
T_TIPO_DATA('7386556','6396314VK4769E0003UD','56636,32','102957,98'),
T_TIPO_DATA('7402874','8758601FE0185N0003MD','70387,59','32393,63')


    	); 
    	V_TMP_TIPO_DATA T_TIPO_DATA;

BEGIN
	DBMS_OUTPUT.PUT_LINE('[INICIO]');
    DBMS_OUTPUT.PUT_LINE('[INFO]: ACTUALIZAR ACTIVOS A PUBLICADOS VENTA');

    FOR I IN V_TIPO_DATA.FIRST .. V_TIPO_DATA.LAST
        LOOP
    V_TMP_TIPO_DATA := V_TIPO_DATA(I);
    V_COUNT_TOTAL:=V_COUNT_TOTAL+1;

        --Comprobamos la existencia del activo
        V_MSQL := 'SELECT COUNT(1) FROM '||V_ESQUEMA||'.ACT_ACTIVO ACT
                    JOIN '||V_ESQUEMA||'.ACT_CAT_CATASTRO CAT ON CAT.ACT_ID=ACT.ACT_ID AND CAT.BORRADO = 0
                    WHERE ACT.ACT_NUM_ACTIVO = '''||V_TMP_TIPO_DATA(1)||''' AND CAT.CAT_REF_CATASTRAL= '''||V_TMP_TIPO_DATA(2)||''' ';
        EXECUTE IMMEDIATE V_MSQL INTO V_COUNT;	

        IF V_COUNT > 0 THEN

            --Obtenemos el ID del activo
        V_MSQL := 'SELECT DISTINCT ACT.ACT_ID FROM '||V_ESQUEMA||'.ACT_ACTIVO ACT
                    JOIN '||V_ESQUEMA||'.ACT_CAT_CATASTRO CAT ON CAT.ACT_ID=ACT.ACT_ID AND CAT.BORRADO = 0
                    WHERE ACT.ACT_NUM_ACTIVO = '''||V_TMP_TIPO_DATA(1)||''' AND CAT.CAT_REF_CATASTRAL= '''||V_TMP_TIPO_DATA(2)||''' ';
        EXECUTE IMMEDIATE V_MSQL INTO V_ID;

            --Actualizamos el estado de publicación
            V_MSQL:= 'UPDATE '||V_ESQUEMA||'.ACT_CAT_CATASTRO SET
            CAT_VALOR_CATASTRAL_CONST = '''||V_TMP_TIPO_DATA(3)||''',
            CAT_VALOR_CATASTRAL_SUELO = '''||V_TMP_TIPO_DATA(4)||''',
            USUARIOMODIFICAR = '''|| V_USUARIO ||''',
            FECHAMODIFICAR = SYSDATE
            WHERE ACT_ID = '||V_ID||' AND CAT_REF_CATASTRAL= '''||V_TMP_TIPO_DATA(2)||''' ';
            EXECUTE IMMEDIATE V_MSQL;

            DBMS_OUTPUT.PUT_LINE('[INFO] CATASTRO ACTUALIZADO PARA EL ACTIVO '''||V_TMP_TIPO_DATA(1)||'''');

            V_COUNT2:=V_COUNT2+1;

        ELSE 

            DBMS_OUTPUT.PUT_LINE('[INFO] NO EXISTE EL ACTIVO '''||V_TMP_TIPO_DATA(1)||'''');

        END IF;

    END LOOP;

    DBMS_OUTPUT.PUT_LINE('[INFO] MODIFICADOS CORRECTAMENTE '''||V_COUNT2||''' DE '''||V_COUNT_TOTAL||''' ');

    COMMIT;

    DBMS_OUTPUT.PUT_LINE('[FIN]');
EXCEPTION
     WHEN OTHERS THEN
          ERR_NUM := SQLCODE;
          ERR_MSG := SQLERRM;
          DBMS_OUTPUT.put_line('[ERROR] Se ha producido un error en la ejecución:'||TO_CHAR(ERR_NUM));
          DBMS_OUTPUT.put_line('-----------------------------------------------------------'); 
          DBMS_OUTPUT.put_line(ERR_MSG);
          ROLLBACK;
          RAISE;   
END;
/
EXIT;