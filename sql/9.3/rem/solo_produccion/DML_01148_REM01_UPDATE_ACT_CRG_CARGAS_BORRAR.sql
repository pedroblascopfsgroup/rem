--/*
--######################################### 
--## AUTOR=Juan José Sanjuan
--## FECHA_CREACION=202200307
--## ARTEFACTO=online
--## VERSION_ARTEFACTO=9.3
--## INCIDENCIA_LINK=REMVIP-11299
--## PRODUCTO=NO
--##            
--## INSTRUCCIONES:  Actualizar fechas cédulas de habitabilidad
--## VERSIONES:
--##        0.1 Versión inicial
--#########################################
--*/

--Para permitir la visualización de texto en un bloque PL/SQL utilizando DBMS_OUTPUT.PUT_LINE

WHENEVER SQLERROR EXIT SQL.SQLCODE;
SET SERVEROUTPUT ON;
SET DEFINE OFF;


DECLARE
    V_MSQL VARCHAR2(32000 CHAR); -- Sentencia a ejecutar     
    V_ESQUEMA VARCHAR2(25 CHAR):= '#ESQUEMA#'; -- Configuracion Esquema
    V_ESQUEMA_M VARCHAR2(25 CHAR):= '#ESQUEMA_MASTER#'; -- Configuracion Esquema Master
    V_SQL VARCHAR2(4000 CHAR); -- Vble. para consulta que valida la existencia de una tabla.
    V_SQL_NORDEN VARCHAR2(4000 CHAR); -- Vble. para consulta del siguente ORDEN TFI para una tarea.
    V_NUM_NORDEN NUMBER(16); -- Vble. para indicar el siguiente orden en TFI para una tarea.
    V_NUM_ENLACES NUMBER(16); -- Vble. para indicar no. de enlaces en TFI
    V_NUM_TABLAS NUMBER(16); -- Vble. para validar la existencia de una tabla.   
    ERR_NUM NUMBER(25);  -- Vble. auxiliar para registrar errores en el script.
    ERR_MSG VARCHAR2(1024 CHAR); -- Vble. auxiliar para registrar errores en el script.
    table_count number(3); -- Vble. para validar la existencia de las Tablas.
	V_ID NUMBER(16); -- Vble. auxiliar para almacenar temporalmente el numero de la sequencia.
    V_TEXT1 VARCHAR2(2400 CHAR); -- Vble. auxiliar
    V_ENTIDAD_ID NUMBER(16);
	V_TEXT_TABLA VARCHAR2(2400 CHAR) := 'ACT_CRG_CARGAS'; -- Vble. auxiliar para almacenar el nombre de la tabla de ref.
	V_USUARIO VARCHAR2(32 CHAR) := 'REMVIP-11299';

    
    TYPE T_TIPO_DATA IS TABLE OF VARCHAR2(150);
    TYPE T_ARRAY_DATA IS TABLE OF T_TIPO_DATA;
    V_TIPO_DATA T_ARRAY_DATA := T_ARRAY_DATA(
                    --ID_CARGA          
        T_TIPO_DATA('9494384'),
        T_TIPO_DATA('9495221'),
        T_TIPO_DATA('9495184'),
        T_TIPO_DATA('9498248'),
        T_TIPO_DATA('9495219'),
        T_TIPO_DATA('9495224'),
        T_TIPO_DATA('9498370'),
        T_TIPO_DATA('18793859'),
        T_TIPO_DATA('9495217'),
        T_TIPO_DATA('9494910'),
        T_TIPO_DATA('9495187'),
        T_TIPO_DATA('9496882'),
        T_TIPO_DATA('9495223'),
        T_TIPO_DATA('9495186'),
        T_TIPO_DATA('9494906'),
        T_TIPO_DATA('9496892'),
        T_TIPO_DATA('9494920'),
        T_TIPO_DATA('9495194'),
        T_TIPO_DATA('9494905'),
        T_TIPO_DATA('9494907'),
        T_TIPO_DATA('9495220'),
        T_TIPO_DATA('9495192'),
        T_TIPO_DATA('9496881'),
        T_TIPO_DATA('9494909'),
        T_TIPO_DATA('9495189'),
        T_TIPO_DATA('9495234'),
        T_TIPO_DATA('9495193'),
        T_TIPO_DATA('9492774'),
        T_TIPO_DATA('9492563'),
        T_TIPO_DATA('9492566'),
        T_TIPO_DATA('9496197'),
        T_TIPO_DATA('9493281'),
        T_TIPO_DATA('9495191'),
        T_TIPO_DATA('9492379'),
        T_TIPO_DATA('9492731'),
        T_TIPO_DATA('9494040'),
        T_TIPO_DATA('9494045'),
        T_TIPO_DATA('9492746'),
        T_TIPO_DATA('9492985'),
        T_TIPO_DATA('9492747'),
        T_TIPO_DATA('9494560'),
        T_TIPO_DATA('9494561'),
        T_TIPO_DATA('9492990'),
        T_TIPO_DATA('9492750'),
        T_TIPO_DATA('9492074'),
        T_TIPO_DATA('9492081'),
        T_TIPO_DATA('9492735'),
        T_TIPO_DATA('9494032'),
        T_TIPO_DATA('9492973'),
        T_TIPO_DATA('9492976'),
        T_TIPO_DATA('9492744'),
        T_TIPO_DATA('9492984'),
        T_TIPO_DATA('9494554'),
        T_TIPO_DATA('9494035'),
        T_TIPO_DATA('9492736'),
        T_TIPO_DATA('9492738'),
        T_TIPO_DATA('9492739'),
        T_TIPO_DATA('9492972'),
        T_TIPO_DATA('9492742'),
        T_TIPO_DATA('9494041'),
        T_TIPO_DATA('9492745'),
        T_TIPO_DATA('9494559'),
        T_TIPO_DATA('9494048'),
        T_TIPO_DATA('9492661'),
        T_TIPO_DATA('9492732'),
        T_TIPO_DATA('9492969'),
        T_TIPO_DATA('9492737'),
        T_TIPO_DATA('9492971'),
        T_TIPO_DATA('9492740'),
        T_TIPO_DATA('9492978'),
        T_TIPO_DATA('9492981'),
        T_TIPO_DATA('9492988'),
        T_TIPO_DATA('9492989'),
        T_TIPO_DATA('9494047'),
        T_TIPO_DATA('9492748'),
        T_TIPO_DATA('9494564'),
        T_TIPO_DATA('9493464'),
        T_TIPO_DATA('9493287'),
        T_TIPO_DATA('9496196'),
        T_TIPO_DATA('9492965'),
        T_TIPO_DATA('9492970'),
        T_TIPO_DATA('9494553'),
        T_TIPO_DATA('9494034'),
        T_TIPO_DATA('9492741'),
        T_TIPO_DATA('9494556'),
        T_TIPO_DATA('9492743'),
        T_TIPO_DATA('9494043'),
        T_TIPO_DATA('9492980'),
        T_TIPO_DATA('9492982'),
        T_TIPO_DATA('9494046'),
        T_TIPO_DATA('9494563'),
        T_TIPO_DATA('9492092'),
        T_TIPO_DATA('9492907'),
        T_TIPO_DATA('9492992'),
        T_TIPO_DATA('9494033'),
        T_TIPO_DATA('9492974'),
        T_TIPO_DATA('9494037'),
        T_TIPO_DATA('9492977'),
        T_TIPO_DATA('9494042'),
        T_TIPO_DATA('9494044'),
        T_TIPO_DATA('9492987'),
        T_TIPO_DATA('9492749'),
        T_TIPO_DATA('9497027'),
        T_TIPO_DATA('9492894'),
        T_TIPO_DATA('9492895'),
        T_TIPO_DATA('9498633'),
        T_TIPO_DATA('9494622'),
        T_TIPO_DATA('9492176'),
        T_TIPO_DATA('9494623'),
        T_TIPO_DATA('9493057'),
        T_TIPO_DATA('9494254'),
        T_TIPO_DATA('9492691'),
        T_TIPO_DATA('9492082'),
        T_TIPO_DATA('9492395'),
        T_TIPO_DATA('9492211'),
        T_TIPO_DATA('9491811'),
        T_TIPO_DATA('9493986'),
        T_TIPO_DATA('9493983'),
        T_TIPO_DATA('9492645'),
        T_TIPO_DATA('9492918'),
        T_TIPO_DATA('9492380'),
        T_TIPO_DATA('9493990'),
        T_TIPO_DATA('9492891'),
        T_TIPO_DATA('9492885'),
        T_TIPO_DATA('9492880'),
        T_TIPO_DATA('9493071'),
        T_TIPO_DATA('9493019'),
        T_TIPO_DATA('9494552'),
        T_TIPO_DATA('9494555'),
        T_TIPO_DATA('9494036'),
        T_TIPO_DATA('9494038'),
        T_TIPO_DATA('9494039'),
        T_TIPO_DATA('9492110'),
        T_TIPO_DATA('9494558'),
        T_TIPO_DATA('9492979'),
        T_TIPO_DATA('9492983'),
        T_TIPO_DATA('9492986'),
        T_TIPO_DATA('9494562'),
        T_TIPO_DATA('9492991'),
        T_TIPO_DATA('9493882'),
        T_TIPO_DATA('9493118'),
        T_TIPO_DATA('9493466'),
        T_TIPO_DATA('9492909'),
        T_TIPO_DATA('9491899'),
        T_TIPO_DATA('9493058'),
        T_TIPO_DATA('9494515'),
        T_TIPO_DATA('9492254'),
        T_TIPO_DATA('9493427'),
        T_TIPO_DATA('9493428'),
        T_TIPO_DATA('9493164'),
        T_TIPO_DATA('9492255'),
        T_TIPO_DATA('9493438'),
        T_TIPO_DATA('9493173'),
        T_TIPO_DATA('9493442'),
        T_TIPO_DATA('9495325'),
        T_TIPO_DATA('9494273'),
        T_TIPO_DATA('9493981'),
        T_TIPO_DATA('9492258'),
        T_TIPO_DATA('9493434'),
        T_TIPO_DATA('9493169'),
        T_TIPO_DATA('9493174'),
        T_TIPO_DATA('9493441'),
        T_TIPO_DATA('9493008'),
        T_TIPO_DATA('9492260'),
        T_TIPO_DATA('9494126'),
        T_TIPO_DATA('9494004'),
        T_TIPO_DATA('9495180'),
        T_TIPO_DATA('9493433'),
        T_TIPO_DATA('9493176'),
        T_TIPO_DATA('9493431'),
        T_TIPO_DATA('9493165'),
        T_TIPO_DATA('9492259'),
        T_TIPO_DATA('9493171'),
        T_TIPO_DATA('9493439'),
        T_TIPO_DATA('9494125'),
        T_TIPO_DATA('9493443'),
        T_TIPO_DATA('9493167'),
        T_TIPO_DATA('9493168'),
        T_TIPO_DATA('9493979'),
        T_TIPO_DATA('9492257'),
        T_TIPO_DATA('9493170'),
        T_TIPO_DATA('9493436'),
        T_TIPO_DATA('9494345'),
        T_TIPO_DATA('9495181'),
        T_TIPO_DATA('9495584'),
        T_TIPO_DATA('9498085'),
        T_TIPO_DATA('9494205'),
        T_TIPO_DATA('9493163'),
        T_TIPO_DATA('9492256'),
        T_TIPO_DATA('9493175'),
        T_TIPO_DATA('9494362'),
        T_TIPO_DATA('9497618'),
        T_TIPO_DATA('9497620'),
        T_TIPO_DATA('9497621'),
        T_TIPO_DATA('9493553'),
        T_TIPO_DATA('9493172'),
        T_TIPO_DATA('9493440'),
        T_TIPO_DATA('9492461'),
        T_TIPO_DATA('9492486'),
        T_TIPO_DATA('9493963'),
        T_TIPO_DATA('9498653'),
        T_TIPO_DATA('9495606'),
        T_TIPO_DATA('9497964'),
        T_TIPO_DATA('9497966'),
        T_TIPO_DATA('9495610'),
        T_TIPO_DATA('9497968'),
        T_TIPO_DATA('9497969'),
        T_TIPO_DATA('9495509'),
        T_TIPO_DATA('9494325'),
        T_TIPO_DATA('9494833'),
        T_TIPO_DATA('9492457'),
        T_TIPO_DATA('9497965'),
        T_TIPO_DATA('9493435'),
        T_TIPO_DATA('9494123'),
        T_TIPO_DATA('9494124'),
        T_TIPO_DATA('9492261'),
        T_TIPO_DATA('9494829'),
        T_TIPO_DATA('9494449'),
        T_TIPO_DATA('9492525'),
        T_TIPO_DATA('9492455'),
        T_TIPO_DATA('9494959'),
        T_TIPO_DATA('9492526'),
        T_TIPO_DATA('9498654'),
        T_TIPO_DATA('9494438'),
        T_TIPO_DATA('9494441'),
        T_TIPO_DATA('9494337'),
        T_TIPO_DATA('9494452'),
        T_TIPO_DATA('9494455'),
        T_TIPO_DATA('9494442'),
        T_TIPO_DATA('9494825'),
        T_TIPO_DATA('9494929'),
        T_TIPO_DATA('9495510'),
        T_TIPO_DATA('9493632'),
        T_TIPO_DATA('9495607'),
        T_TIPO_DATA('9495612'),
        T_TIPO_DATA('9494835'),
        T_TIPO_DATA('9494439'),
        T_TIPO_DATA('9494989'),
        T_TIPO_DATA('9493737'),
        T_TIPO_DATA('9494838'),
        T_TIPO_DATA('9498647'),
        T_TIPO_DATA('9496208'),
        T_TIPO_DATA('9494980'),
        T_TIPO_DATA('9496520'),
        T_TIPO_DATA('9495609'),
        T_TIPO_DATA('9495611'),
        T_TIPO_DATA('9496522'),
        T_TIPO_DATA('9498664'),
        T_TIPO_DATA('9498665'),
        T_TIPO_DATA('9496530'),
        T_TIPO_DATA('9495615'),
        T_TIPO_DATA('9497967'),
        T_TIPO_DATA('9498663'),
        T_TIPO_DATA('9497963'),
        T_TIPO_DATA('9495605'),
        T_TIPO_DATA('9496519'),
        T_TIPO_DATA('9495608'),
        T_TIPO_DATA('9496521'),
        T_TIPO_DATA('9495147'),
        T_TIPO_DATA('9496763'),
        T_TIPO_DATA('9495151'),
        T_TIPO_DATA('9496761'),
        T_TIPO_DATA('9496762'),
        T_TIPO_DATA('9494900'),
        T_TIPO_DATA('9495211'),
        T_TIPO_DATA('9495209'),
        T_TIPO_DATA('9494897'),
        T_TIPO_DATA('9494896'),
        T_TIPO_DATA('9495245'),
        T_TIPO_DATA('9495212'),
        T_TIPO_DATA('9497568'),
        T_TIPO_DATA('9495044'),
        T_TIPO_DATA('9495897'),
        T_TIPO_DATA('9496085'),
        T_TIPO_DATA('9498624'),
        T_TIPO_DATA('9496189'),
        T_TIPO_DATA('9497181'),
        T_TIPO_DATA('9496229'),
        T_TIPO_DATA('9497481'),
        T_TIPO_DATA('9497182'),
        T_TIPO_DATA('9495023'),
        T_TIPO_DATA('9495565'),
        T_TIPO_DATA('9496228'),
        T_TIPO_DATA('9496230'),
        T_TIPO_DATA('9495899'),
        T_TIPO_DATA('9497160'),
        T_TIPO_DATA('9497180'),
        T_TIPO_DATA('9497142'),
        T_TIPO_DATA('9496853'),
        T_TIPO_DATA('9497387'),
        T_TIPO_DATA('9497388'),
        T_TIPO_DATA('9497382'),
        T_TIPO_DATA('9498136'),
        T_TIPO_DATA('9498442'),
        T_TIPO_DATA('9498443'),
        T_TIPO_DATA('9497386'),
        T_TIPO_DATA('9496855'),
        T_TIPO_DATA('9497391'),
        T_TIPO_DATA('9497953'),
        T_TIPO_DATA('9497954'),
        T_TIPO_DATA('9498452'),
        T_TIPO_DATA('9498440'),
        T_TIPO_DATA('9496852'),
        T_TIPO_DATA('9498444'),
        T_TIPO_DATA('9498441'),
        T_TIPO_DATA('9497384'),
        T_TIPO_DATA('9498445'),
        T_TIPO_DATA('9498137'),
        T_TIPO_DATA('9497389'),
        T_TIPO_DATA('9497390'),
        T_TIPO_DATA('9496858'),
        T_TIPO_DATA('9496990'),
        T_TIPO_DATA('9498145'),
        T_TIPO_DATA('9498456'),
        T_TIPO_DATA('9496994'),
        T_TIPO_DATA('9498138'),
        T_TIPO_DATA('9496856'),
        T_TIPO_DATA('9498142'),
        T_TIPO_DATA('9498453'),
        T_TIPO_DATA('9497396'),
        T_TIPO_DATA('9497399'),
        T_TIPO_DATA('9498148'),
        T_TIPO_DATA('9498460'),
        T_TIPO_DATA('9498149'),
        T_TIPO_DATA('9497385'),
        T_TIPO_DATA('9498446'),
        T_TIPO_DATA('9498447'),
        T_TIPO_DATA('9496854'),
        T_TIPO_DATA('9498449'),
        T_TIPO_DATA('9498451'),
        T_TIPO_DATA('9498140'),
        T_TIPO_DATA('9498459'),
        T_TIPO_DATA('9496996'),
        T_TIPO_DATA('9497404'),
        T_TIPO_DATA('9498450'),
        T_TIPO_DATA('9497392'),
        T_TIPO_DATA('9496859'),
        T_TIPO_DATA('9497394'),
        T_TIPO_DATA('9498454'),
        T_TIPO_DATA('9498146'),
        T_TIPO_DATA('9498147'),
        T_TIPO_DATA('9497398'),
        T_TIPO_DATA('9497393'),
        T_TIPO_DATA('9498141'),
        T_TIPO_DATA('9497395'),
        T_TIPO_DATA('9498144'),
        T_TIPO_DATA('9498455'),
        T_TIPO_DATA('9497400'),
        T_TIPO_DATA('9496995'),
        T_TIPO_DATA('9498150'),
        T_TIPO_DATA('9498448'),
        T_TIPO_DATA('9496992'),
        T_TIPO_DATA('9498457'),
        T_TIPO_DATA('9497383'),
        T_TIPO_DATA('9498139'),
        T_TIPO_DATA('9496993'),
        T_TIPO_DATA('9496857'),
        T_TIPO_DATA('9497401'),
        T_TIPO_DATA('9498458'),
        T_TIPO_DATA('9494996'),
        T_TIPO_DATA('9498143'),
        T_TIPO_DATA('9496989'),
        T_TIPO_DATA('9496991'),
        T_TIPO_DATA('9497397'),
        T_TIPO_DATA('9498461'),
        T_TIPO_DATA('9494582'),
        T_TIPO_DATA('9491793'),
        T_TIPO_DATA('9497402'),
        T_TIPO_DATA('9497403'),
        T_TIPO_DATA('9497405'),
        T_TIPO_DATA('9498151'),
        T_TIPO_DATA('9492152'),
        T_TIPO_DATA('9494505'),
        T_TIPO_DATA('9496832'),
        T_TIPO_DATA('9498121'),
        T_TIPO_DATA('9497369'),
        T_TIPO_DATA('9498418'),
        T_TIPO_DATA('9497371'),
        T_TIPO_DATA('9498414'),
        T_TIPO_DATA('9498123'),
        T_TIPO_DATA('9498419'),
        T_TIPO_DATA('9498432'),
        T_TIPO_DATA('9497372'),
        T_TIPO_DATA('9497373'),
        T_TIPO_DATA('9498434'),
        T_TIPO_DATA('9496844'),
        T_TIPO_DATA('9497376'),
        T_TIPO_DATA('9498439'),
        T_TIPO_DATA('9497378'),
        T_TIPO_DATA('9492546'),
        T_TIPO_DATA('9491806'),
        T_TIPO_DATA('9497368'),
        T_TIPO_DATA('9498422'),
        T_TIPO_DATA('9496841'),
        T_TIPO_DATA('9493635'),
        T_TIPO_DATA('9498415'),
        T_TIPO_DATA('9498417'),
        T_TIPO_DATA('9498126'),
        T_TIPO_DATA('9496840'),
        T_TIPO_DATA('9498431'),
        T_TIPO_DATA('9498433'),
        T_TIPO_DATA('9496842'),
        T_TIPO_DATA('9496843'),
        T_TIPO_DATA('9498435'),
        T_TIPO_DATA('9496848'),
        T_TIPO_DATA('9497370'),
        T_TIPO_DATA('9496839'),
        T_TIPO_DATA('9498423'),
        T_TIPO_DATA('9498413'),
        T_TIPO_DATA('9496833'),
        T_TIPO_DATA('9498124'),
        T_TIPO_DATA('9496838'),
        T_TIPO_DATA('9498425'),
        T_TIPO_DATA('9498426'),
        T_TIPO_DATA('9498427'),
        T_TIPO_DATA('9498428'),
        T_TIPO_DATA('9498120'),
        T_TIPO_DATA('9498122'),
        T_TIPO_DATA('9498127'),
        T_TIPO_DATA('9498429'),
        T_TIPO_DATA('9498128'),
        T_TIPO_DATA('9498430'),
        T_TIPO_DATA('9497374'),
        T_TIPO_DATA('9498438'),
        T_TIPO_DATA('9498133'),
        T_TIPO_DATA('9497380'),
        T_TIPO_DATA('9493771'),
        T_TIPO_DATA('9496834'),
        T_TIPO_DATA('9496835'),
        T_TIPO_DATA('9496836'),
        T_TIPO_DATA('9496837'),
        T_TIPO_DATA('9498125'),
        T_TIPO_DATA('9498497'),
        T_TIPO_DATA('9498420'),
        T_TIPO_DATA('9498129'),
        T_TIPO_DATA('9497375'),
        T_TIPO_DATA('9498135'),
        T_TIPO_DATA('9498119'),
        T_TIPO_DATA('9498416'),
        T_TIPO_DATA('9498130'),
        T_TIPO_DATA('9498436'),
        T_TIPO_DATA('9498421'),
        T_TIPO_DATA('9498424'),
        T_TIPO_DATA('9498131'),
        T_TIPO_DATA('9498132'),
        T_TIPO_DATA('9497377'),
        T_TIPO_DATA('9496851'),
        T_TIPO_DATA('9498134'),
        T_TIPO_DATA('9497381'),
        T_TIPO_DATA('9496845'),
        T_TIPO_DATA('9496846'),
        T_TIPO_DATA('9496847'),
        T_TIPO_DATA('9496850'),
        T_TIPO_DATA('9492390'),
        T_TIPO_DATA('9491978'),
        T_TIPO_DATA('9492713'),
        T_TIPO_DATA('9491917'),
        T_TIPO_DATA('9498632'),
        T_TIPO_DATA('9498437'),
        T_TIPO_DATA('9497379'),
        T_TIPO_DATA('9496849'),
        T_TIPO_DATA('9495887'),
        T_TIPO_DATA('9494930'),
        T_TIPO_DATA('9494931'),
        T_TIPO_DATA('9493773'),
        T_TIPO_DATA('9495888'),
        T_TIPO_DATA('9494381'),
        T_TIPO_DATA('9493761'),
        T_TIPO_DATA('9493897'),
        T_TIPO_DATA('18793860'),
        T_TIPO_DATA('9494338'),
        T_TIPO_DATA('9493056'),
        T_TIPO_DATA('9492363'),
        T_TIPO_DATA('9491802'),
        T_TIPO_DATA('9491878'),
        T_TIPO_DATA('9494385'),
        T_TIPO_DATA('9494487'),
        T_TIPO_DATA('9493587'),
        T_TIPO_DATA('9493584'),
        T_TIPO_DATA('9493586'),
        T_TIPO_DATA('9491844'),
        T_TIPO_DATA('9493591'),
        T_TIPO_DATA('9492507'),
        T_TIPO_DATA('9492324'),
        T_TIPO_DATA('9493265'),
        T_TIPO_DATA('9492424'),
        T_TIPO_DATA('9492031'),
        T_TIPO_DATA('9496781'),
        T_TIPO_DATA('9495501'),
        T_TIPO_DATA('9493589'),
        T_TIPO_DATA('9497425'),
        T_TIPO_DATA('9494382'),
        T_TIPO_DATA('9495022'),
        T_TIPO_DATA('9491794'),
        T_TIPO_DATA('9495898'),
        T_TIPO_DATA('9495464'),
        T_TIPO_DATA('9492503'),
        T_TIPO_DATA('9495024'),
        T_TIPO_DATA('9496086'),
        T_TIPO_DATA('9496084'),
        T_TIPO_DATA('9495465'),
        T_TIPO_DATA('9495896'),
        T_TIPO_DATA('9495025'),
        T_TIPO_DATA('9493828'),
        T_TIPO_DATA('9493757'),
        T_TIPO_DATA('9493709'),
        T_TIPO_DATA('9493637'),
        T_TIPO_DATA('9492157'),
        T_TIPO_DATA('9498554'),
        T_TIPO_DATA('9492636'),
        T_TIPO_DATA('9492299'),
        T_TIPO_DATA('9493474'),
        T_TIPO_DATA('9492694'),
        T_TIPO_DATA('9493288'),
        T_TIPO_DATA('9496125'),
        T_TIPO_DATA('9498265'),
        T_TIPO_DATA('9492352'),
        T_TIPO_DATA('9497958'),
        T_TIPO_DATA('9497957'),
        T_TIPO_DATA('9497955'),
        T_TIPO_DATA('9497854'),
        T_TIPO_DATA('9492695'),
        T_TIPO_DATA('9496122'),
        T_TIPO_DATA('9498264'),
        T_TIPO_DATA('9492310'),
        T_TIPO_DATA('9496123'),
        T_TIPO_DATA('9492197'),
        T_TIPO_DATA('9496627'),
        T_TIPO_DATA('9492300'),
        T_TIPO_DATA('9496124'),
        T_TIPO_DATA('9497853'),
        T_TIPO_DATA('9498262'),
        T_TIPO_DATA('9497851'),
        T_TIPO_DATA('9498267'),
        T_TIPO_DATA('9498263'),
        T_TIPO_DATA('9497959'),
        T_TIPO_DATA('9497956'),
        T_TIPO_DATA('9498266'),
        T_TIPO_DATA('9497852'),
        T_TIPO_DATA('9491960'),
        T_TIPO_DATA('9498195'),
        T_TIPO_DATA('9497426'),
        T_TIPO_DATA('9496901'),
        T_TIPO_DATA('9495167'),
        T_TIPO_DATA('9494233'),
        T_TIPO_DATA('9498339'),
        T_TIPO_DATA('9496943'),
        T_TIPO_DATA('9498354'),
        T_TIPO_DATA('9498356'),
        T_TIPO_DATA('9496904'),
        T_TIPO_DATA('9496949'),
        T_TIPO_DATA('9495170'),
        T_TIPO_DATA('9498355'),
        T_TIPO_DATA('9495169'),
        T_TIPO_DATA('9496907'),
        T_TIPO_DATA('9496944'),
        T_TIPO_DATA('9496947'),
        T_TIPO_DATA('9496948'),
        T_TIPO_DATA('9498353'),
        T_TIPO_DATA('9498351'),
        T_TIPO_DATA('9496903'),
        T_TIPO_DATA('9498349'),
        T_TIPO_DATA('9498352'),
        T_TIPO_DATA('9496905'),
        T_TIPO_DATA('9498348'),
        T_TIPO_DATA('9496910'),
        T_TIPO_DATA('9496909'),
        T_TIPO_DATA('9496908'),
        T_TIPO_DATA('9495171'),
        T_TIPO_DATA('9496945'),
        T_TIPO_DATA('9496946'),
        T_TIPO_DATA('9498350'),
        T_TIPO_DATA('9496942'),
        T_TIPO_DATA('9498357'),
        T_TIPO_DATA('9498358'),
        T_TIPO_DATA('9496906'),
        T_TIPO_DATA('20044443'),
        T_TIPO_DATA('18846088'),
        T_TIPO_DATA('12040268'),
        T_TIPO_DATA('11911922'),
        T_TIPO_DATA('29609084'),
        T_TIPO_DATA('18630679'),
        T_TIPO_DATA('22160522'),
        T_TIPO_DATA('12554562'),
        T_TIPO_DATA('12554564'),
        T_TIPO_DATA('12554563'),
        T_TIPO_DATA('23551443'),
        T_TIPO_DATA('26829183'),
        T_TIPO_DATA('20561856'),
        T_TIPO_DATA('20588847'),
        T_TIPO_DATA('19297023'),
        T_TIPO_DATA('20980233'),
        T_TIPO_DATA('20980250'),
        T_TIPO_DATA('19830433'),
        T_TIPO_DATA('20980240'),
        T_TIPO_DATA('9493308'),
        T_TIPO_DATA('20980244'),
        T_TIPO_DATA('20797848'),
        T_TIPO_DATA('23033633'),
        T_TIPO_DATA('21481306'),
        T_TIPO_DATA('21846206'),
        T_TIPO_DATA('22695702'),
        T_TIPO_DATA('22695644'),
        T_TIPO_DATA('22695679'),
        T_TIPO_DATA('22695685'),
        T_TIPO_DATA('22695669'),
        T_TIPO_DATA('22695711'),
        T_TIPO_DATA('22695704'),
        T_TIPO_DATA('22695708'),
        T_TIPO_DATA('22695721'),
        T_TIPO_DATA('22695674'),
        T_TIPO_DATA('22695689'),
        T_TIPO_DATA('22695714'),
        T_TIPO_DATA('22695693'),
        T_TIPO_DATA('22695646'),
        T_TIPO_DATA('22695719'),
        T_TIPO_DATA('22695636'),
        T_TIPO_DATA('22695648'),
        T_TIPO_DATA('22695625'),
        T_TIPO_DATA('22666282'),
        T_TIPO_DATA('17408546'),
        T_TIPO_DATA('22695682'),
        T_TIPO_DATA('22695633'),
        T_TIPO_DATA('22695699'),
        T_TIPO_DATA('22695697'),
        T_TIPO_DATA('22695631'),
        T_TIPO_DATA('22666295'),
        T_TIPO_DATA('22695692'),
        T_TIPO_DATA('22695639'),
        T_TIPO_DATA('22666299'),
        T_TIPO_DATA('22695627'),
        T_TIPO_DATA('22695623'),
        T_TIPO_DATA('22695666'),
        T_TIPO_DATA('22666290'),
        T_TIPO_DATA('22666287'),
        T_TIPO_DATA('22695713'),
        T_TIPO_DATA('22666285'),
        T_TIPO_DATA('22695676'),
        T_TIPO_DATA('22695642'),
        T_TIPO_DATA('22695629'),
        T_TIPO_DATA('22666294'),
        T_TIPO_DATA('20407043'),
        T_TIPO_DATA('21372053'),
        T_TIPO_DATA('18290678'),
        T_TIPO_DATA('22835618'),
        T_TIPO_DATA('21853178'),
        T_TIPO_DATA('21539451'),
        T_TIPO_DATA('21135746'),
        T_TIPO_DATA('22043775'),
        T_TIPO_DATA('21846216'),
        T_TIPO_DATA('21135711'),
        T_TIPO_DATA('22072978'),
        T_TIPO_DATA('22072979'),
        T_TIPO_DATA('21649005'),
        T_TIPO_DATA('21081585'),
        T_TIPO_DATA('21081593'),
        T_TIPO_DATA('21162826'),
        T_TIPO_DATA('21539405'),
        T_TIPO_DATA('19990832'),
        T_TIPO_DATA('20434099'),
        T_TIPO_DATA('21597681'),
        T_TIPO_DATA('21597693'),
        T_TIPO_DATA('23432372'),
        T_TIPO_DATA('21597655'),
        T_TIPO_DATA('21597669'),
        T_TIPO_DATA('21597691'),
        T_TIPO_DATA('23462428'),
        T_TIPO_DATA('20851857'),
        T_TIPO_DATA('21649052'),
        T_TIPO_DATA('21707510'),
        T_TIPO_DATA('23432519'),
        T_TIPO_DATA('23092450'),
        T_TIPO_DATA('23092449'),
        T_TIPO_DATA('23862618'),
        T_TIPO_DATA('22894178'),
        T_TIPO_DATA('24560804'),
        T_TIPO_DATA('24560802'),
        T_TIPO_DATA('20953041'),
        T_TIPO_DATA('22666253'),
        T_TIPO_DATA('22556119'),
        T_TIPO_DATA('23291977'),
        T_TIPO_DATA('23291976'),
        T_TIPO_DATA('24469640'),
        T_TIPO_DATA('24530308'),
        T_TIPO_DATA('22468143'),
        T_TIPO_DATA('22468147'),
        T_TIPO_DATA('22468127'),
        T_TIPO_DATA('22468151'),
        T_TIPO_DATA('22468145'),
        T_TIPO_DATA('22468149'),
        T_TIPO_DATA('22468141'),
        T_TIPO_DATA('21081686'),
        T_TIPO_DATA('21081624'),
        T_TIPO_DATA('21081696'),
        T_TIPO_DATA('21081675'),
        T_TIPO_DATA('21081587'),
        T_TIPO_DATA('21081598'),
        T_TIPO_DATA('21081706'),
        T_TIPO_DATA('21081711'),
        T_TIPO_DATA('21081603'),
        T_TIPO_DATA('21081641'),
        T_TIPO_DATA('21081645'),
        T_TIPO_DATA('21081703'),
        T_TIPO_DATA('21081576'),
        T_TIPO_DATA('21081592'),
        T_TIPO_DATA('21081679'),
        T_TIPO_DATA('21081668'),
        T_TIPO_DATA('21081671'),
        T_TIPO_DATA('21081606'),
        T_TIPO_DATA('21081614'),
        T_TIPO_DATA('21081659'),
        T_TIPO_DATA('21081580'),
        T_TIPO_DATA('21081583'),
        T_TIPO_DATA('21081628'),
        T_TIPO_DATA('21081700'),
        T_TIPO_DATA('21081663'),
        T_TIPO_DATA('21081690'),
        T_TIPO_DATA('21081634'),
        T_TIPO_DATA('21081638'),
        T_TIPO_DATA('21081610'),
        T_TIPO_DATA('21081651'),
        T_TIPO_DATA('21081656'),
        T_TIPO_DATA('22666240'),
        T_TIPO_DATA('20797863'),
        T_TIPO_DATA('22556077')
    ); 
    V_TMP_TIPO_DATA T_TIPO_DATA;
    
BEGIN
DBMS_OUTPUT.PUT_LINE('[INICIO]');


    DBMS_OUTPUT.PUT_LINE('[INFO]: UPDATE EN '||V_TEXT_TABLA);
    FOR I IN V_TIPO_DATA.FIRST .. V_TIPO_DATA.LAST
      LOOP

        V_TMP_TIPO_DATA := V_TIPO_DATA(I);

        --Comprobar el dato a updatear.
        V_MSQL := 'SELECT COUNT(1) FROM '||V_ESQUEMA||'.'||V_TEXT_TABLA||' acc
                         WHERE acc.CRG_ID = '||TRIM(V_TMP_TIPO_DATA(1))||'
                         AND acc.BORRADO= 0';
        EXECUTE IMMEDIATE V_MSQL INTO V_NUM_TABLAS; 
        -- Si existe se modifica.
        IF V_NUM_TABLAS > 0 THEN
            DBMS_OUTPUT.PUT_LINE('[INFO]: BORRAR EL REGISTRO  CRG_ID '''|| TRIM(V_TMP_TIPO_DATA(1)) ||'''');
            V_MSQL := 'UPDATE '|| V_ESQUEMA ||'.'||V_TEXT_TABLA||' 
                        SET BORRADO = 1
                            , USUARIOBORRAR = '''||V_USUARIO||''' 
                            , FECHABORRAR = SYSDATE '||
                        'WHERE CRG_ID = '||TRIM(V_TMP_TIPO_DATA(1))||'
                            AND BORRADO = 0';
            EXECUTE IMMEDIATE V_MSQL;
            DBMS_OUTPUT.PUT_LINE('[INFO]: REGISTRO BORRADO CORRECTAMENTE EN ACT_CRG_CARGAS');
       ELSE
            DBMS_OUTPUT.PUT_LINE('[INFO]: NO EXISTE EL REGISTRO CON CRG_ID:  '''||TRIM(V_TMP_TIPO_DATA(1))||'''');
       END IF;
      END LOOP;
      
    COMMIT;
    DBMS_OUTPUT.PUT_LINE('[FIN]: TABLA '||V_TEXT_TABLA||' BORRADO CORRECTAMENTE ');

EXCEPTION
     WHEN OTHERS THEN
          ERR_NUM := SQLCODE;
          ERR_MSG := SQLERRM;
          DBMS_OUTPUT.put_line('[ERROR] Se ha producido un error en la ejecución:'||TO_CHAR(ERR_NUM));
          DBMS_OUTPUT.put_line('-----------------------------------------------------------'); 
          DBMS_OUTPUT.put_line(ERR_MSG);
          ROLLBACK;
          RAISE;   
END;
/
EXIT;
