--/*
--######################################### 
--## AUTOR=Juan José Sanjuan
--## FECHA_CREACION=202200307
--## ARTEFACTO=online
--## VERSION_ARTEFACTO=9.3
--## INCIDENCIA_LINK=REMVIP-11299
--## PRODUCTO=NO
--##            
--## INSTRUCCIONES:  Actualizar fechas cédulas de habitabilidad
--## VERSIONES:
--##        0.1 Versión inicial
--#########################################
--*/

--Para permitir la visualización de texto en un bloque PL/SQL utilizando DBMS_OUTPUT.PUT_LINE

WHENEVER SQLERROR EXIT SQL.SQLCODE;
SET SERVEROUTPUT ON;
SET DEFINE OFF;


DECLARE
    V_MSQL VARCHAR2(32000 CHAR); -- Sentencia a ejecutar     
    V_ESQUEMA VARCHAR2(25 CHAR):= '#ESQUEMA#'; -- Configuracion Esquema
    V_ESQUEMA_M VARCHAR2(25 CHAR):= '#ESQUEMA_MASTER#'; -- Configuracion Esquema Master
    V_SQL VARCHAR2(4000 CHAR); -- Vble. para consulta que valida la existencia de una tabla.
    V_SQL_NORDEN VARCHAR2(4000 CHAR); -- Vble. para consulta del siguente ORDEN TFI para una tarea.
    V_NUM_NORDEN NUMBER(16); -- Vble. para indicar el siguiente orden en TFI para una tarea.
    V_NUM_ENLACES NUMBER(16); -- Vble. para indicar no. de enlaces en TFI
    V_NUM_TABLAS NUMBER(16); -- Vble. para validar la existencia de una tabla.   
    ERR_NUM NUMBER(25);  -- Vble. auxiliar para registrar errores en el script.
    ERR_MSG VARCHAR2(1024 CHAR); -- Vble. auxiliar para registrar errores en el script.
    table_count number(3); -- Vble. para validar la existencia de las Tablas.
	V_ID NUMBER(16); -- Vble. auxiliar para almacenar temporalmente el numero de la sequencia.
    V_TEXT1 VARCHAR2(2400 CHAR); -- Vble. auxiliar
    V_ENTIDAD_ID NUMBER(16);
	V_TEXT_TABLA VARCHAR2(2400 CHAR) := 'ACT_CRG_CARGAS'; -- Vble. auxiliar para almacenar el nombre de la tabla de ref.
	V_USUARIO VARCHAR2(32 CHAR) := 'REMVIP-11299';

    
    TYPE T_TIPO_DATA IS TABLE OF VARCHAR2(150);
    TYPE T_ARRAY_DATA IS TABLE OF T_TIPO_DATA;
    V_TIPO_DATA T_ARRAY_DATA := T_ARRAY_DATA(
        --          ID_CARGA    subtipo carga//DD_SCG_DESCRIPCION      
        T_TIPO_DATA('31796087','19'),
        T_TIPO_DATA('31231639','19'),
        T_TIPO_DATA('22468142','19'),
        T_TIPO_DATA('22468146','19'),
        T_TIPO_DATA('22468126','19'),
        T_TIPO_DATA('22468150','19'),
        T_TIPO_DATA('22468144','19'),
        T_TIPO_DATA('22468148','19'),
        T_TIPO_DATA('22468137','19'),
        T_TIPO_DATA('21108702','19'),
        T_TIPO_DATA('25478357','19'),
        T_TIPO_DATA('20953019','19'),
        T_TIPO_DATA('30339228','19'),
        T_TIPO_DATA('24560812','19'),
        T_TIPO_DATA('9503058','19'),
        T_TIPO_DATA('9503059','19'),
        T_TIPO_DATA('24560811','19'),
        T_TIPO_DATA('9499596','19'),
        T_TIPO_DATA('16722008','19'),
        T_TIPO_DATA('16722007','19'),
        T_TIPO_DATA('9499209','19'),
        T_TIPO_DATA('31616779','19'),
        T_TIPO_DATA('31616787','19'),
        T_TIPO_DATA('31642636','19'),
        T_TIPO_DATA('23632874','19'),
        T_TIPO_DATA('23521824','19'),
        T_TIPO_DATA('23521825','19'),
        T_TIPO_DATA('31642655','19'),
        T_TIPO_DATA('31616791','19'),
        T_TIPO_DATA('31616794','19'),
        T_TIPO_DATA('31616795','19'),
        T_TIPO_DATA('24264704','19'),
        T_TIPO_DATA('24264710','19'),
        T_TIPO_DATA('24264709','19'),
        T_TIPO_DATA('31616781','19'),
        T_TIPO_DATA('31616784','19'),
        T_TIPO_DATA('31616778','19'),
        T_TIPO_DATA('31616783','19'),
        T_TIPO_DATA('31616788','19'),
        T_TIPO_DATA('31642643','19'),
        T_TIPO_DATA('31642645','19'),
        T_TIPO_DATA('31642652','19'),
        T_TIPO_DATA('31642653','19'),
        T_TIPO_DATA('31616802','19'),
        T_TIPO_DATA('31616803','19'),
        T_TIPO_DATA('31642634','19'),
        T_TIPO_DATA('31642638','19'),
        T_TIPO_DATA('31642640','19'),
        T_TIPO_DATA('31642646','19'),
        T_TIPO_DATA('31616792','19'),
        T_TIPO_DATA('31616797','19'),
        T_TIPO_DATA('31616800','19'),
        T_TIPO_DATA('31616804','19'),
        T_TIPO_DATA('24560814','19'),
        T_TIPO_DATA('31616777','19'),
        T_TIPO_DATA('31616789','19'),
        T_TIPO_DATA('31642637','19'),
        T_TIPO_DATA('31616793','19'),
        T_TIPO_DATA('31616798','19'),
        T_TIPO_DATA('19164654','19'),
        T_TIPO_DATA('19136188','19'),
        T_TIPO_DATA('32001626','19'),
        T_TIPO_DATA('31616780','19'),
        T_TIPO_DATA('31616785','19'),
        T_TIPO_DATA('31616786','19'),
        T_TIPO_DATA('31616790','19'),
        T_TIPO_DATA('9492888','19'),
        T_TIPO_DATA('20797856','19'),
        T_TIPO_DATA('31616782','19'),
        T_TIPO_DATA('31642648','19'),
        T_TIPO_DATA('31642649','19'),
        T_TIPO_DATA('31616805','19'),
        T_TIPO_DATA('31642641','19'),
        T_TIPO_DATA('31616796','19'),
        T_TIPO_DATA('31616801','19'),
        T_TIPO_DATA('31642677','19'),
        T_TIPO_DATA('9494524','19'),
        T_TIPO_DATA('32103351','19'),
        T_TIPO_DATA('32103355','19'),
        T_TIPO_DATA('30898879','19'),
        T_TIPO_DATA('19164400','19'),
        T_TIPO_DATA('19164409','19'),
        T_TIPO_DATA('30898888','19'),
        T_TIPO_DATA('30898889','19'),
        T_TIPO_DATA('26321232','19'),
        T_TIPO_DATA('26321233','19'),
        T_TIPO_DATA('26321231','19'),
        T_TIPO_DATA('9500180','19'),
        T_TIPO_DATA('9500181','19'),
        T_TIPO_DATA('9500184','19'),
        T_TIPO_DATA('9500173','19'),
        T_TIPO_DATA('9500178','19'),
        T_TIPO_DATA('21648953','19'),
        T_TIPO_DATA('9500175','19'),
        T_TIPO_DATA('9500176','19'),
        T_TIPO_DATA('29634492','19'),
        T_TIPO_DATA('9500174','19'),
        T_TIPO_DATA('19164423','19'),
        T_TIPO_DATA('19164426','19'),
        T_TIPO_DATA('19162804','19'),
        T_TIPO_DATA('9501878','19'),
        T_TIPO_DATA('9500179','19'),
        T_TIPO_DATA('9500182','19'),
        T_TIPO_DATA('9500183','19'),
        T_TIPO_DATA('19163002','19'),
        T_TIPO_DATA('19164447','19'),
        T_TIPO_DATA('19162816','19'),
        T_TIPO_DATA('29634491','19'),
        T_TIPO_DATA('19163792','19'),
        T_TIPO_DATA('19162812','19'),
        T_TIPO_DATA('19162811','19'),
        T_TIPO_DATA('19163812','19'),
        T_TIPO_DATA('19162814','19'),
        T_TIPO_DATA('11029195','19'),
        T_TIPO_DATA('9495738','19'),
        T_TIPO_DATA('9502737','19'),
        T_TIPO_DATA('9502971','19'),
        T_TIPO_DATA('9502982','19'),
        T_TIPO_DATA('9502744','19'),
        T_TIPO_DATA('9502729','19'),
        T_TIPO_DATA('9502743','19'),
        T_TIPO_DATA('9502745','19'),
        T_TIPO_DATA('9502734','19'),
        T_TIPO_DATA('15234416','19'),
        T_TIPO_DATA('9502748','19'),
        T_TIPO_DATA('9502741','19'),
        T_TIPO_DATA('9502966','19'),
        T_TIPO_DATA('9502967','19'),
        T_TIPO_DATA('9502975','19'),
        T_TIPO_DATA('9502984','19'),
        T_TIPO_DATA('22299452','19'),
        T_TIPO_DATA('22299451','19'),
        T_TIPO_DATA('22299455','19'),
        T_TIPO_DATA('22299453','19'),
        T_TIPO_DATA('22299454','19'),
        T_TIPO_DATA('22299464','19'),
        T_TIPO_DATA('22299463','19'),
        T_TIPO_DATA('9502746','19'),
        T_TIPO_DATA('9502732','19'),
        T_TIPO_DATA('9502728','19'),
        T_TIPO_DATA('9502723','19'),
        T_TIPO_DATA('9502976','19'),
        T_TIPO_DATA('9502979','19'),
        T_TIPO_DATA('9502980','19'),
        T_TIPO_DATA('15234460','19'),
        T_TIPO_DATA('9502983','19'),
        T_TIPO_DATA('9502988','19'),
        T_TIPO_DATA('15234546','19'),
        T_TIPO_DATA('9502731','19'),
        T_TIPO_DATA('9502730','19'),
        T_TIPO_DATA('9502962','19'),
        T_TIPO_DATA('9502986','19'),
        T_TIPO_DATA('9502964','19'),
        T_TIPO_DATA('9502747','19'),
        T_TIPO_DATA('9502987','19'),
        T_TIPO_DATA('9502981','19'),
        T_TIPO_DATA('22299449','19'),
        T_TIPO_DATA('22299450','19'),
        T_TIPO_DATA('14401316','19'),
        T_TIPO_DATA('22299460','19'),
        T_TIPO_DATA('22299461','19'),
        T_TIPO_DATA('22299456','19'),
        T_TIPO_DATA('22299457','19'),
        T_TIPO_DATA('9500510','19'),
        T_TIPO_DATA('9502733','19'),
        T_TIPO_DATA('9502742','19'),
        T_TIPO_DATA('9502735','19'),
        T_TIPO_DATA('9502978','19'),
        T_TIPO_DATA('9502985','19'),
        T_TIPO_DATA('9502961','19'),
        T_TIPO_DATA('9502963','19'),
        T_TIPO_DATA('22299458','19'),
        T_TIPO_DATA('22299459','19'),
        T_TIPO_DATA('22299465','19'),
        T_TIPO_DATA('22299472','19'),
        T_TIPO_DATA('22299466','19'),
        T_TIPO_DATA('9500511','19'),
        T_TIPO_DATA('9499455','19'),
        T_TIPO_DATA('9499459','19'),
        T_TIPO_DATA('9500494','19'),
        T_TIPO_DATA('9500489','19'),
        T_TIPO_DATA('9499457','19'),
        T_TIPO_DATA('9499451','19'),
        T_TIPO_DATA('9499453','19'),
        T_TIPO_DATA('19163869','19'),
        T_TIPO_DATA('21081673','19'),
        T_TIPO_DATA('9500495','19'),
        T_TIPO_DATA('9500492','19'),
        T_TIPO_DATA('9500490','19'),
        T_TIPO_DATA('9499458','19'),
        T_TIPO_DATA('9499456','19'),
        T_TIPO_DATA('9501619','19'),
        T_TIPO_DATA('9501621','19'),
        T_TIPO_DATA('9501617','19'),
        T_TIPO_DATA('9501615','19'),
        T_TIPO_DATA('9500512','19'),
        T_TIPO_DATA('9499439','19'),
        T_TIPO_DATA('9499441','19'),
        T_TIPO_DATA('9499445','19'),
        T_TIPO_DATA('9499449','19'),
        T_TIPO_DATA('19163844','19'),
        T_TIPO_DATA('19163851','19'),
        T_TIPO_DATA('19163852','19'),
        T_TIPO_DATA('19163856','19'),
        T_TIPO_DATA('19163857','19'),
        T_TIPO_DATA('19163843','19'),
        T_TIPO_DATA('19163850','19'),
        T_TIPO_DATA('32745014','19'),
        T_TIPO_DATA('19163854','19'),
        T_TIPO_DATA('19163858','19'),
        T_TIPO_DATA('9499437','19'),
        T_TIPO_DATA('9499448','19'),
        T_TIPO_DATA('19163848','19'),
        T_TIPO_DATA('9499443','19'),
        T_TIPO_DATA('26587062','19'),
        T_TIPO_DATA('26586986','19'),
        T_TIPO_DATA('9499442','19'),
        T_TIPO_DATA('26587021','19'),
        T_TIPO_DATA('26587052','19'),
        T_TIPO_DATA('32718963','19'),
        T_TIPO_DATA('9499446','19'),
        T_TIPO_DATA('9499444','19'),
        T_TIPO_DATA('9499447','19'),
        T_TIPO_DATA('19163868','19'),
        T_TIPO_DATA('26587002','19'),
        T_TIPO_DATA('26587005','19'),
        T_TIPO_DATA('26587012','19'),
        T_TIPO_DATA('26587028','19'),
        T_TIPO_DATA('26587048','19'),
        T_TIPO_DATA('26586978','19'),
        T_TIPO_DATA('26587074','19'),
        T_TIPO_DATA('26587111','19'),
        T_TIPO_DATA('31616755','19'),
        T_TIPO_DATA('26587060','19'),
        T_TIPO_DATA('26587064','19'),
        T_TIPO_DATA('26586991','19'),
        T_TIPO_DATA('26587003','19'),
        T_TIPO_DATA('26587027','19'),
        T_TIPO_DATA('26587030','19'),
        T_TIPO_DATA('9500129','19'),
        T_TIPO_DATA('9500130','19'),
        T_TIPO_DATA('22894182','19'),
        T_TIPO_DATA('22894184','19'),
        T_TIPO_DATA('22894185','19'),
        T_TIPO_DATA('26586980','19'),
        T_TIPO_DATA('26586993','19'),
        T_TIPO_DATA('26587047','19'),
        T_TIPO_DATA('26321228','19'),
        T_TIPO_DATA('26587020','19'),
        T_TIPO_DATA('26587113','19'),
        T_TIPO_DATA('26587083','19'),
        T_TIPO_DATA('26587097','19'),
        T_TIPO_DATA('26587105','19'),
        T_TIPO_DATA('26587108','19'),
        T_TIPO_DATA('26587071','19'),
        T_TIPO_DATA('26587091','19'),
        T_TIPO_DATA('26587125','19'),
        T_TIPO_DATA('26587103','19'),
        T_TIPO_DATA('26587014','19'),
        T_TIPO_DATA('26587023','19'),
        T_TIPO_DATA('26587031','19'),
        T_TIPO_DATA('26587049','19'),
        T_TIPO_DATA('26587058','19'),
        T_TIPO_DATA('26587078','19'),
        T_TIPO_DATA('26587110','19'),
        T_TIPO_DATA('26587086','19'),
        T_TIPO_DATA('26587089','19'),
        T_TIPO_DATA('26587094','19'),
        T_TIPO_DATA('26587101','19'),
        T_TIPO_DATA('26587116','19'),
        T_TIPO_DATA('26586982','19'),
        T_TIPO_DATA('26587016','19'),
        T_TIPO_DATA('26587018','19'),
        T_TIPO_DATA('26587090','19'),
        T_TIPO_DATA('26587104','19'),
        T_TIPO_DATA('26587043','19'),
        T_TIPO_DATA('26587051','19'),
        T_TIPO_DATA('26587066','19'),
        T_TIPO_DATA('26587076','19'),
        T_TIPO_DATA('26587114','19'),
        T_TIPO_DATA('26587084','19'),
        T_TIPO_DATA('26587106','19'),
        T_TIPO_DATA('26587122','19'),
        T_TIPO_DATA('26587124','19'),
        T_TIPO_DATA('22526843','19'),
        T_TIPO_DATA('22666237','19'),
        T_TIPO_DATA('22666236','19'),
        T_TIPO_DATA('22526842','19'),
        T_TIPO_DATA('32334675','19'),
        T_TIPO_DATA('26587073','19'),
        T_TIPO_DATA('26587075','19'),
        T_TIPO_DATA('26587119','19'),
        T_TIPO_DATA('26587143','19'),
        T_TIPO_DATA('26587068','19'),
        T_TIPO_DATA('26587088','19'),
        T_TIPO_DATA('26587115','19'),
        T_TIPO_DATA('9498374','19'),
        T_TIPO_DATA('29609075','19'),
        T_TIPO_DATA('29609076','19'),
        T_TIPO_DATA('26056090','19'),
        T_TIPO_DATA('26056091','19'),
        T_TIPO_DATA('26056092','19'),
        T_TIPO_DATA('23691886','19'),
        T_TIPO_DATA('9498776','19'),
        T_TIPO_DATA('31077872','19'),
        T_TIPO_DATA('26056088','19'),
        T_TIPO_DATA('26056089','19'),
        T_TIPO_DATA('31077873','19'),
        T_TIPO_DATA('22556079','19'),
        T_TIPO_DATA('22556078','19'),
        T_TIPO_DATA('22556081','19'),
        T_TIPO_DATA('26056093','19'),
        T_TIPO_DATA('26056095','19'),
        T_TIPO_DATA('26056094','19'),
        T_TIPO_DATA('27270068','19'),
        T_TIPO_DATA('22835619','19'),
        T_TIPO_DATA('22835616','19'),
        T_TIPO_DATA('26321202','19'),
        T_TIPO_DATA('26321201','19'),
        T_TIPO_DATA('22835614','19'),
        T_TIPO_DATA('22835615','19'),
        T_TIPO_DATA('22835620','19'),
        T_TIPO_DATA('27270075','19'),
        T_TIPO_DATA('16401910','19'),
        T_TIPO_DATA('23551443','19'),
        T_TIPO_DATA('22666361','19'),
        T_TIPO_DATA('9500411','19'),
        T_TIPO_DATA('9500410','19'),
        T_TIPO_DATA('9500412','19'),
        T_TIPO_DATA('9500413','19'),
        T_TIPO_DATA('21963174','19'),
        T_TIPO_DATA('20926001','19'),
        T_TIPO_DATA('26321160','19'),
        T_TIPO_DATA('26321158','19'),
        T_TIPO_DATA('26321159','19'),
        T_TIPO_DATA('26683650','19'),
        T_TIPO_DATA('26683651','19'),
        T_TIPO_DATA('21317993','19'),
        T_TIPO_DATA('26321180','19'),
        T_TIPO_DATA('26321181','19'),
        T_TIPO_DATA('26393768','19'),
        T_TIPO_DATA('26321183','19'),
        T_TIPO_DATA('26321182','19'),
        T_TIPO_DATA('26321184','19'),
        T_TIPO_DATA('26321185','19'),
        T_TIPO_DATA('26659027','19'),
        T_TIPO_DATA('22072989','19'),
        T_TIPO_DATA('26321188','19'),
        T_TIPO_DATA('26321187','19'),
        T_TIPO_DATA('26321189','19'),
        T_TIPO_DATA('26321186','19'),
        T_TIPO_DATA('9500311','19'),
        T_TIPO_DATA('22072984','19'),
        T_TIPO_DATA('22072985','19'),
        T_TIPO_DATA('22072983','19'),
        T_TIPO_DATA('9498732','19'),
        T_TIPO_DATA('19164321','19'),
        T_TIPO_DATA('22299485','19'),
        T_TIPO_DATA('22299486','19'),
        T_TIPO_DATA('24294558','19'),
        T_TIPO_DATA('31949733','19'),
        T_TIPO_DATA('26321211','19'),
        T_TIPO_DATA('26732696','19'),
        T_TIPO_DATA('26732697','19'),
        T_TIPO_DATA('23892898','19'),
        T_TIPO_DATA('24919027','19'),
        T_TIPO_DATA('24919026','19'),
        T_TIPO_DATA('22299482','19'),
        T_TIPO_DATA('22072946','19'),
        T_TIPO_DATA('20824817','19'),
        T_TIPO_DATA('20824818','19'),
        T_TIPO_DATA('20824821','19'),
        T_TIPO_DATA('20824822','19'),
        T_TIPO_DATA('23551474','19'),
        T_TIPO_DATA('27048282','19'),
        T_TIPO_DATA('29856571','19'),
        T_TIPO_DATA('15911450','19'),
        T_TIPO_DATA('20824820','19'),
        T_TIPO_DATA('20824819','19'),
        T_TIPO_DATA('22526828','19'),
        T_TIPO_DATA('22526827','19'),
        T_TIPO_DATA('10230840','19'),
        T_TIPO_DATA('14972400','19'),
        T_TIPO_DATA('29856565','19'),
        T_TIPO_DATA('22526822','19'),
        T_TIPO_DATA('22526823','19'),
        T_TIPO_DATA('23632902','19'),
        T_TIPO_DATA('23632900','19'),
        T_TIPO_DATA('23632901','19'),
        T_TIPO_DATA('23632899','19'),
        T_TIPO_DATA('23662375','19'),
        T_TIPO_DATA('23662374','19'),
        T_TIPO_DATA('23662376','19'),
        T_TIPO_DATA('23232988','19'),
        T_TIPO_DATA('23232982','19'),
        T_TIPO_DATA('23232979','19'),
        T_TIPO_DATA('23551469','19'),
        T_TIPO_DATA('23551470','19'),
        T_TIPO_DATA('20926040','19'),
        T_TIPO_DATA('12083089','19'),
        T_TIPO_DATA('21765850','19'),
        T_TIPO_DATA('26587100','19'),
        T_TIPO_DATA('32692863','19'),
        T_TIPO_DATA('24325234','19'),
        T_TIPO_DATA('20534889','19'),
        T_TIPO_DATA('23062989','19'),
        T_TIPO_DATA('23062988','19'),
        T_TIPO_DATA('23062998','19'),
        T_TIPO_DATA('23062993','19'),
        T_TIPO_DATA('23062996','19'),
        T_TIPO_DATA('23062992','19'),
        T_TIPO_DATA('23063009','19'),
        T_TIPO_DATA('23063016','19'),
        T_TIPO_DATA('23063017','19'),
        T_TIPO_DATA('23063006','19'),
        T_TIPO_DATA('23063012','19'),
        T_TIPO_DATA('23063014','19'),
        T_TIPO_DATA('23063048','19'),
        T_TIPO_DATA('23063044','19'),
        T_TIPO_DATA('23063047','19'),
        T_TIPO_DATA('23063049','19'),
        T_TIPO_DATA('23063042','19'),
        T_TIPO_DATA('20044534','19'),
        T_TIPO_DATA('26587044','19'),
        T_TIPO_DATA('26587040','19'),
        T_TIPO_DATA('12928446','19'),
        T_TIPO_DATA('20770846','19'),
        T_TIPO_DATA('20353133','19'),
        T_TIPO_DATA('23063159','19'),
        T_TIPO_DATA('19857189','19'),
        T_TIPO_DATA('17978837','19'),
        T_TIPO_DATA('22864900','19'),
        T_TIPO_DATA('22864902','19'),
        T_TIPO_DATA('22864901','19'),
        T_TIPO_DATA('22864903','19'),
        T_TIPO_DATA('32513638','19'),
        T_TIPO_DATA('19536563','19'),
        T_TIPO_DATA('18741458','19'),
        T_TIPO_DATA('18741619','19'),
        T_TIPO_DATA('22666384','19'),
        T_TIPO_DATA('22666363','19'),
        T_TIPO_DATA('22695796','19'),
        T_TIPO_DATA('22666390','19'),
        T_TIPO_DATA('22696054','19'),
        T_TIPO_DATA('22696112','19'),
        T_TIPO_DATA('22696075','19'),
        T_TIPO_DATA('22696103','19'),
        T_TIPO_DATA('22695785','19'),
        T_TIPO_DATA('36292326','19'),
        T_TIPO_DATA('18977656','19'),
        T_TIPO_DATA('27732380','19'),
        T_TIPO_DATA('23662398','19'),
        T_TIPO_DATA('23321532','19'),
        T_TIPO_DATA('23321533','19'),
        T_TIPO_DATA('23321531','19'),
        T_TIPO_DATA('21904629','19'),
        T_TIPO_DATA('21904626','19'),
        T_TIPO_DATA('24034370','19'),
        T_TIPO_DATA('24034371','19'),
        T_TIPO_DATA('23662391','19'),
        T_TIPO_DATA('23662390','19'),
        T_TIPO_DATA('20017603','19'),
        T_TIPO_DATA('22357909','19'),
        T_TIPO_DATA('22357908','19'),
        T_TIPO_DATA('22357910','19'),
        T_TIPO_DATA('21452258','19'),
        T_TIPO_DATA('21452246','19'),
        T_TIPO_DATA('21452254','19'),
        T_TIPO_DATA('18656916','19'),
        T_TIPO_DATA('18656917','19'),
        T_TIPO_DATA('26732719','19'),
        T_TIPO_DATA('26732718','19'),
        T_TIPO_DATA('26732717','19'),
        T_TIPO_DATA('26732716','19'),
        T_TIPO_DATA('37016340','19'),
        T_TIPO_DATA('37016337','19'),
        T_TIPO_DATA('37016339','19'),
        T_TIPO_DATA('26321226','19'),
        T_TIPO_DATA('26878124','19'),
        T_TIPO_DATA('26878125','19'),
        T_TIPO_DATA('26878122','19'),
        T_TIPO_DATA('26878123','19'),
        T_TIPO_DATA('22666244','19'),
        T_TIPO_DATA('20926073','19'),
        T_TIPO_DATA('23862748','19'),
        T_TIPO_DATA('23862746','19'),
        T_TIPO_DATA('20044439','19'),
        T_TIPO_DATA('23432565','19'),
        T_TIPO_DATA('23432570','19'),
        T_TIPO_DATA('21933852','19'),
        T_TIPO_DATA('21933863','19'),
        T_TIPO_DATA('21933840','19'),
        T_TIPO_DATA('21933850','19'),
        T_TIPO_DATA('21933855','19'),
        T_TIPO_DATA('21933860','19'),
        T_TIPO_DATA('26393759','19'),
        T_TIPO_DATA('27565791','19'),
        T_TIPO_DATA('27565792','19'),
        T_TIPO_DATA('27565795','19'),
        T_TIPO_DATA('27565793','19'),
        T_TIPO_DATA('27565794','19'),
        T_TIPO_DATA('22438660','19'),
        T_TIPO_DATA('25769845','19'),
        T_TIPO_DATA('31129824','19'),
        T_TIPO_DATA('20434101','19'),
        T_TIPO_DATA('26878128','19'),
        T_TIPO_DATA('26878129','19'),
        T_TIPO_DATA('26878127','19'),
        T_TIPO_DATA('26878126','19'),
        T_TIPO_DATA('21678200','19'),
        T_TIPO_DATA('21678201','19'),
        T_TIPO_DATA('26757184','19'),
        T_TIPO_DATA('26757144','19'),
        T_TIPO_DATA('26757147','19'),
        T_TIPO_DATA('18977627','19'),
        T_TIPO_DATA('26513628','19'),
        T_TIPO_DATA('26513618','19'),
        T_TIPO_DATA('26513623','19'),
        T_TIPO_DATA('26513626','19'),
        T_TIPO_DATA('26513627','19'),
        T_TIPO_DATA('26513650','19'),
        T_TIPO_DATA('26513646','19'),
        T_TIPO_DATA('26513648','19'),
        T_TIPO_DATA('26513645','19'),
        T_TIPO_DATA('26513642','19'),
        T_TIPO_DATA('26513637','19'),
        T_TIPO_DATA('26513635','19'),
        T_TIPO_DATA('26513639','19'),
        T_TIPO_DATA('26513641','19'),
        T_TIPO_DATA('26513631','19'),
        T_TIPO_DATA('26513660','19'),
        T_TIPO_DATA('26513659','19'),
        T_TIPO_DATA('26513656','19'),
        T_TIPO_DATA('26513654','19'),
        T_TIPO_DATA('26513652','19'),
        T_TIPO_DATA('24294515','19'),
        T_TIPO_DATA('24294514','19'),
        T_TIPO_DATA('20953012','19'),
        T_TIPO_DATA('31077871','19'),
        T_TIPO_DATA('23662378','19'),
        T_TIPO_DATA('23662379','19'),
        T_TIPO_DATA('23521830','19'),
        T_TIPO_DATA('20851860','19'),
        T_TIPO_DATA('21904676','19'),
        T_TIPO_DATA('24034343','19'),
        T_TIPO_DATA('24034344','19'),
        T_TIPO_DATA('21372042','19'),
        T_TIPO_DATA('20898977','19'),
        T_TIPO_DATA('20898980','19'),
        T_TIPO_DATA('20898979','19'),
        T_TIPO_DATA('25746639','19'),
        T_TIPO_DATA('25746636','19'),
        T_TIPO_DATA('23092455','19'),
        T_TIPO_DATA('23092453','19'),
        T_TIPO_DATA('23092454','19'),
        T_TIPO_DATA('22695811','19'),
        T_TIPO_DATA('22695816','19'),
        T_TIPO_DATA('21707532','19'),
        T_TIPO_DATA('21794922','19'),
        T_TIPO_DATA('21707568','19'),
        T_TIPO_DATA('23462185','19'),
        T_TIPO_DATA('22270245','19'),
        T_TIPO_DATA('22270244','19'),
        T_TIPO_DATA('22270243','19'),
        T_TIPO_DATA('22270246','19'),
        T_TIPO_DATA('21707592','19'),
        T_TIPO_DATA('21707590','19'),
        T_TIPO_DATA('21736731','19'),
        T_TIPO_DATA('21736695','19'),
        T_TIPO_DATA('23432317','19'),
        T_TIPO_DATA('23691882','19'),
        T_TIPO_DATA('23691881','19'),
        T_TIPO_DATA('23691880','19'),
        T_TIPO_DATA('23691883','19'),
        T_TIPO_DATA('22043770','19'),
        T_TIPO_DATA('22043768','19'),
        T_TIPO_DATA('22043771','19'),
        T_TIPO_DATA('22043769','19'),
        T_TIPO_DATA('20980200','19'),
        T_TIPO_DATA('20980142','19'),
        T_TIPO_DATA('23291949','19'),
        T_TIPO_DATA('23291950','19'),
        T_TIPO_DATA('23291952','19'),
        T_TIPO_DATA('21963132','19'),
        T_TIPO_DATA('26538271','19'),
        T_TIPO_DATA('26538266','19'),
        T_TIPO_DATA('22526839','19'),
        T_TIPO_DATA('22497563','19'),
        T_TIPO_DATA('22526836','19'),
        T_TIPO_DATA('22497581','19'),
        T_TIPO_DATA('22497572','19'),
        T_TIPO_DATA('22526833','19'),
        T_TIPO_DATA('22666251','19'),
        T_TIPO_DATA('22666258','19'),
        T_TIPO_DATA('22666252','19'),
        T_TIPO_DATA('22666256','19'),
        T_TIPO_DATA('22666259','19'),
        T_TIPO_DATA('22695731','19'),
        T_TIPO_DATA('22695732','19'),
        T_TIPO_DATA('22695739','19'),
        T_TIPO_DATA('22695734','19'),
        T_TIPO_DATA('28430579','19'),
        T_TIPO_DATA('27540922','19'),
        T_TIPO_DATA('24264843','19'),
        T_TIPO_DATA('24294520','19'),
        T_TIPO_DATA('24264844','19'),
        T_TIPO_DATA('26708147','19'),
        T_TIPO_DATA('26708145','19'),
        T_TIPO_DATA('25685428','19'),
        T_TIPO_DATA('25685431','19'),
        T_TIPO_DATA('29856630','19'),
        T_TIPO_DATA('29856632','19'),
        T_TIPO_DATA('29856631','19'),
        T_TIPO_DATA('29856633','19'),
        T_TIPO_DATA('29856634','19'),
        T_TIPO_DATA('29856636','19'),
        T_TIPO_DATA('29856637','19'),
        T_TIPO_DATA('37166122','19'),
        T_TIPO_DATA('37166120','19'),
        T_TIPO_DATA('31590902','19'),
        T_TIPO_DATA('31590907','19'),
        T_TIPO_DATA('31385962','19'),
        T_TIPO_DATA('37316634','19'),
        T_TIPO_DATA('37368319','19'),
        T_TIPO_DATA('37368329','19'),
        T_TIPO_DATA('37368330','19'),
        T_TIPO_DATA('37342413','19'),
        T_TIPO_DATA('37342412','19'),
        T_TIPO_DATA('37342416','19'),
        T_TIPO_DATA('37342415','19'),
        T_TIPO_DATA('37342414','19'),
        T_TIPO_DATA('37316625','19'),
        T_TIPO_DATA('37316624','19'),
        T_TIPO_DATA('37316616','19'),
        T_TIPO_DATA('37394074','19'),
        T_TIPO_DATA('34450664','19'),
        T_TIPO_DATA('34450663','19'),
        T_TIPO_DATA('37469679','19'),
        T_TIPO_DATA('37469684','19'),
        T_TIPO_DATA('37673978','19'),
        T_TIPO_DATA('35064490','19'),
        T_TIPO_DATA('35064489','19'),
        T_TIPO_DATA('36416613','19'),
        T_TIPO_DATA('36242590','19')
    ); 
    V_TMP_TIPO_DATA T_TIPO_DATA;
    
BEGIN
DBMS_OUTPUT.PUT_LINE('[INICIO]');


    DBMS_OUTPUT.PUT_LINE('[INFO]: UPDATE EN '||V_TEXT_TABLA);
    FOR I IN V_TIPO_DATA.FIRST .. V_TIPO_DATA.LAST
      LOOP

        V_TMP_TIPO_DATA := V_TIPO_DATA(I);

        --Comprobar el dato a updatear.
        V_MSQL := 'SELECT COUNT(1) FROM '||V_ESQUEMA||'.'||V_TEXT_TABLA||' acc
                         WHERE acc.CRG_ID = '||TRIM(V_TMP_TIPO_DATA(1))||'
                         AND acc.BORRADO= 0';
        EXECUTE IMMEDIATE V_MSQL INTO V_NUM_TABLAS; 
        -- Si existe se modifica.
        IF V_NUM_TABLAS > 0 THEN
            DBMS_OUTPUT.PUT_LINE('[INFO]: ACTUALIZAD EL REGISTRO  CRG_ID '''|| TRIM(V_TMP_TIPO_DATA(1)) ||''' CON SUBESTADO '''|| TRIM(V_TMP_TIPO_DATA(2)) ||'');
            V_MSQL := 'UPDATE '|| V_ESQUEMA ||'.'||V_TEXT_TABLA||' 
                        SET USUARIOMODIFICAR = '''||V_USUARIO||''' 
                            , FECHAMODIFICAR = SYSDATE '||
                           ', DD_SCG_ID = (SELECT scg.DD_SCG_ID
                                            FROM '||V_ESQUEMA||'.DD_SCG_SUBESTADO_CARGA scg
                                    WHERE scg.DD_SCG_CODIGO = '||TRIM(V_TMP_TIPO_DATA(2))||'
                                    AND scg.BORRADO= 0) 
                        WHERE CRG_ID = '||TRIM(V_TMP_TIPO_DATA(1))||'
                            AND BORRADO = 0';
            EXECUTE IMMEDIATE V_MSQL;
            DBMS_OUTPUT.PUT_LINE('[INFO]: REGISTRO ACTUALIZADO CORRECTAMENTE EN ACT_CRG_CARGAS');
       ELSE
            DBMS_OUTPUT.PUT_LINE('[INFO]: NO EXISTE EL REGISTRO CON CRG_ID:  '''||TRIM(V_TMP_TIPO_DATA(1))||'''');
       END IF;
      END LOOP;
      
    COMMIT;
    DBMS_OUTPUT.PUT_LINE('[FIN]: TABLA '||V_TEXT_TABLA||' ACTUALIZADA CORRECTAMENTE ');

EXCEPTION
     WHEN OTHERS THEN
          ERR_NUM := SQLCODE;
          ERR_MSG := SQLERRM;
          DBMS_OUTPUT.put_line('[ERROR] Se ha producido un error en la ejecución:'||TO_CHAR(ERR_NUM));
          DBMS_OUTPUT.put_line('-----------------------------------------------------------'); 
          DBMS_OUTPUT.put_line(ERR_MSG);
          ROLLBACK;
          RAISE;   
END;
/
EXIT;
