--/*
--######################################### 
--## AUTOR=Juan José Sanjuan
--## FECHA_CREACION=202200307
--## ARTEFACTO=online
--## VERSION_ARTEFACTO=9.3
--## INCIDENCIA_LINK=REMVIP-11299
--## PRODUCTO=NO
--##            
--## INSTRUCCIONES:  Actualizar fechas cédulas de habitabilidad
--## VERSIONES:
--##        0.1 Versión inicial
--#########################################
--*/

--Para permitir la visualización de texto en un bloque PL/SQL utilizando DBMS_OUTPUT.PUT_LINE

WHENEVER SQLERROR EXIT SQL.SQLCODE;
SET SERVEROUTPUT ON;
SET DEFINE OFF;


DECLARE
    V_MSQL VARCHAR2(32000 CHAR); -- Sentencia a ejecutar     
    V_ESQUEMA VARCHAR2(25 CHAR):= '#ESQUEMA#'; -- Configuracion Esquema
    V_ESQUEMA_M VARCHAR2(25 CHAR):= '#ESQUEMA_MASTER#'; -- Configuracion Esquema Master
    V_SQL VARCHAR2(4000 CHAR); -- Vble. para consulta que valida la existencia de una tabla.
    V_SQL_NORDEN VARCHAR2(4000 CHAR); -- Vble. para consulta del siguente ORDEN TFI para una tarea.
    V_NUM_NORDEN NUMBER(16); -- Vble. para indicar el siguiente orden en TFI para una tarea.
    V_NUM_ENLACES NUMBER(16); -- Vble. para indicar no. de enlaces en TFI
    V_NUM_TABLAS NUMBER(16); -- Vble. para validar la existencia de una tabla.   
    ERR_NUM NUMBER(25);  -- Vble. auxiliar para registrar errores en el script.
    ERR_MSG VARCHAR2(1024 CHAR); -- Vble. auxiliar para registrar errores en el script.
    table_count number(3); -- Vble. para validar la existencia de las Tablas.
	V_ID NUMBER(16); -- Vble. auxiliar para almacenar temporalmente el numero de la sequencia.
    V_TEXT1 VARCHAR2(2400 CHAR); -- Vble. auxiliar
    V_ENTIDAD_ID NUMBER(16);
	V_TEXT_TABLA VARCHAR2(2400 CHAR) := 'ACT_CRG_CARGAS'; -- Vble. auxiliar para almacenar el nombre de la tabla de ref.
	V_USUARIO VARCHAR2(32 CHAR) := 'REMVIP-11299';

    
    TYPE T_TIPO_DATA IS TABLE OF VARCHAR2(150);
    TYPE T_ARRAY_DATA IS TABLE OF T_TIPO_DATA;
    V_TIPO_DATA T_ARRAY_DATA := T_ARRAY_DATA(
                   --ID_CARGA    Estado Carga/DD_ECG_DESCRIPCION   
        T_TIPO_DATA('20353116','01','01'),
        T_TIPO_DATA('19803692','01','01'),
        T_TIPO_DATA('21108696','01','01'),
        T_TIPO_DATA('21108706','01','01'),
        T_TIPO_DATA('21108716','01','01'),
        T_TIPO_DATA('21108724','01','01'),
        T_TIPO_DATA('21135788','01','01'),
        T_TIPO_DATA('21135790','01','01'),
        T_TIPO_DATA('21135807','01','01'),
        T_TIPO_DATA('21189813','01','01'),
        T_TIPO_DATA('21189842','01','01'),
        T_TIPO_DATA('23492197','01','01'),
        T_TIPO_DATA('23492192','01','01'),
        T_TIPO_DATA('21135794','01','01'),
        T_TIPO_DATA('21135811','01','01'),
        T_TIPO_DATA('21189797','01','01'),
        T_TIPO_DATA('21189820','01','01'),
        T_TIPO_DATA('21189836','01','01'),
        T_TIPO_DATA('21108710','01','01'),
        T_TIPO_DATA('21108718','01','01'),
        T_TIPO_DATA('21108720','01','01'),
        T_TIPO_DATA('24064084','01','01'),
        T_TIPO_DATA('21108701','01','01'),
        T_TIPO_DATA('21135805','01','01'),
        T_TIPO_DATA('21189792','01','01'),
        T_TIPO_DATA('21189809','01','01'),
        T_TIPO_DATA('21189825','01','01'),
        T_TIPO_DATA('21189828','01','01'),
        T_TIPO_DATA('18977655','01','01'),
        T_TIPO_DATA('21108704','01','01'),
        T_TIPO_DATA('21108712','01','01'),
        T_TIPO_DATA('21135796','01','01'),
        T_TIPO_DATA('21108722','01','01'),
        T_TIPO_DATA('21189795','01','01'),
        T_TIPO_DATA('21189830','01','01'),
        T_TIPO_DATA('21135813','01','01'),
        T_TIPO_DATA('21189789','01','01'),
        T_TIPO_DATA('21189802','01','01'),
        T_TIPO_DATA('21189806','01','01'),
        T_TIPO_DATA('21189823','01','01'),
        T_TIPO_DATA('21189840','01','01'),
        T_TIPO_DATA('9495633','01','01'),
        T_TIPO_DATA('21678450','01','01'),
        T_TIPO_DATA('22241099','01','01'),
        T_TIPO_DATA('15813867','01','01'),
        T_TIPO_DATA('19990877','01','01'),
        T_TIPO_DATA('18846105','01','01'),
        T_TIPO_DATA('9497192','01','01'),
        T_TIPO_DATA('20407159','01','01'),
        T_TIPO_DATA('9492213','01','01'),
        T_TIPO_DATA('20380013','01','01'),
        T_TIPO_DATA('20380017','01','01'),
        T_TIPO_DATA('20380021','01','01'),
        T_TIPO_DATA('20380027','01','01'),
        T_TIPO_DATA('20380031','01','01'),
        T_TIPO_DATA('20380043','01','01'),
        T_TIPO_DATA('20380044','01','01'),
        T_TIPO_DATA('19803691','01','01'),
        T_TIPO_DATA('9492075','01','01'),
        T_TIPO_DATA('14710836','01','01'),
        T_TIPO_DATA('14667290','01','01'),
        T_TIPO_DATA('20380015','01','01'),
        T_TIPO_DATA('20380018','01','01'),
        T_TIPO_DATA('20380030','01','01'),
        T_TIPO_DATA('20380033','01','01'),
        T_TIPO_DATA('20380034','01','01'),
        T_TIPO_DATA('20380035','01','01'),
        T_TIPO_DATA('19803688','01','01'),
        T_TIPO_DATA('9492870','01','01'),
        T_TIPO_DATA('20380011','01','01'),
        T_TIPO_DATA('20380016','01','01'),
        T_TIPO_DATA('20380024','01','01'),
        T_TIPO_DATA('20380038','01','01'),
        T_TIPO_DATA('20380042','01','01'),
        T_TIPO_DATA('20279348','01','01'),
        T_TIPO_DATA('20380009','01','01'),
        T_TIPO_DATA('20380023','01','01'),
        T_TIPO_DATA('20380041','01','01'),
        T_TIPO_DATA('21135786','01','01'),
        T_TIPO_DATA('21189846','01','01'),
        T_TIPO_DATA('20380026','01','01'),
        T_TIPO_DATA('20380029','01','01'),
        T_TIPO_DATA('9493468','01','01'),
        T_TIPO_DATA('9494271','01','01'),
        T_TIPO_DATA('20380019','01','01'),
        T_TIPO_DATA('20380020','01','01'),
        T_TIPO_DATA('20225699','01','01'),
        T_TIPO_DATA('20380028','01','01'),
        T_TIPO_DATA('9494272','01','01'),
        T_TIPO_DATA('20380012','01','01'),
        T_TIPO_DATA('9493070','01','01'),
        T_TIPO_DATA('18793858','01','01'),
        T_TIPO_DATA('9493114','01','01'),
        T_TIPO_DATA('20380014','01','01'),
        T_TIPO_DATA('20380032','01','01'),
        T_TIPO_DATA('20380036','01','01'),
        T_TIPO_DATA('20380037','01','01'),
        T_TIPO_DATA('20380039','01','01'),
        T_TIPO_DATA('20380040','01','01'),
        T_TIPO_DATA('9493009','01','01'),
        T_TIPO_DATA('18819956','01','01'),
        T_TIPO_DATA('9494631','01','01'),
        T_TIPO_DATA('23122386','01','01'),
        T_TIPO_DATA('16267658','01','01'),
        T_TIPO_DATA('16267657','01','01'),
        T_TIPO_DATA('9492793','01','01'),
        T_TIPO_DATA('9494215','01','01'),
        T_TIPO_DATA('16267659','01','01'),
        T_TIPO_DATA('16267660','01','01'),
        T_TIPO_DATA('16267665','01','01'),
        T_TIPO_DATA('16267667','01','01'),
        T_TIPO_DATA('16267666','01','01'),
        T_TIPO_DATA('9494138','01','01'),
        T_TIPO_DATA('16267662','01','01'),
        T_TIPO_DATA('16267661','01','01'),
        T_TIPO_DATA('9494821','01','01'),
        T_TIPO_DATA('9493735','01','01'),
        T_TIPO_DATA('9494832','01','01'),
        T_TIPO_DATA('9494836','01','01'),
        T_TIPO_DATA('9494926','01','01'),
        T_TIPO_DATA('22923422','01','01'),
        T_TIPO_DATA('9494220','01','01'),
        T_TIPO_DATA('9494818','01','01'),
        T_TIPO_DATA('21648964','01','01'),
        T_TIPO_DATA('9494828','01','01'),
        T_TIPO_DATA('9493741','01','01'),
        T_TIPO_DATA('9494991','01','01'),
        T_TIPO_DATA('9495761','01','01'),
        T_TIPO_DATA('9498689','01','01'),
        T_TIPO_DATA('9495762','01','01'),
        T_TIPO_DATA('9497122','01','01'),
        T_TIPO_DATA('9494837','01','01'),
        T_TIPO_DATA('9497120','01','01'),
        T_TIPO_DATA('9498103','01','01'),
        T_TIPO_DATA('9497124','01','01'),
        T_TIPO_DATA('9497128','01','01'),
        T_TIPO_DATA('9497129','01','01'),
        T_TIPO_DATA('9495764','01','01'),
        T_TIPO_DATA('9498697','01','01'),
        T_TIPO_DATA('9497256','01','01'),
        T_TIPO_DATA('9497123','01','01'),
        T_TIPO_DATA('9497130','01','01'),
        T_TIPO_DATA('9497131','01','01'),
        T_TIPO_DATA('9498696','01','01'),
        T_TIPO_DATA('9498692','01','01'),
        T_TIPO_DATA('9498695','01','01'),
        T_TIPO_DATA('9498106','01','01'),
        T_TIPO_DATA('9497257','01','01'),
        T_TIPO_DATA('9498687','01','01'),
        T_TIPO_DATA('9498691','01','01'),
        T_TIPO_DATA('9498104','01','01'),
        T_TIPO_DATA('9497126','01','01'),
        T_TIPO_DATA('9498107','01','01'),
        T_TIPO_DATA('9498109','01','01'),
        T_TIPO_DATA('9495766','01','01'),
        T_TIPO_DATA('9498688','01','01'),
        T_TIPO_DATA('9498101','01','01'),
        T_TIPO_DATA('9498105','01','01'),
        T_TIPO_DATA('9497254','01','01'),
        T_TIPO_DATA('9497121','01','01'),
        T_TIPO_DATA('9497132','01','01'),
        T_TIPO_DATA('9498699','01','01'),
        T_TIPO_DATA('9497133','01','01'),
        T_TIPO_DATA('9495765','01','01'),
        T_TIPO_DATA('9498700','01','01'),
        T_TIPO_DATA('9498102','01','01'),
        T_TIPO_DATA('9497125','01','01'),
        T_TIPO_DATA('9497127','01','01'),
        T_TIPO_DATA('9495763','01','01'),
        T_TIPO_DATA('9498100','01','01'),
        T_TIPO_DATA('9498690','01','01'),
        T_TIPO_DATA('9498693','01','01'),
        T_TIPO_DATA('9498694','01','01'),
        T_TIPO_DATA('9498698','01','01'),
        T_TIPO_DATA('9497255','01','01'),
        T_TIPO_DATA('9498110','01','01'),
        T_TIPO_DATA('9498108','01','01'),
        T_TIPO_DATA('9495745','01','01'),
        T_TIPO_DATA('9495749','01','01'),
        T_TIPO_DATA('9498087','01','01'),
        T_TIPO_DATA('9495751','01','01'),
        T_TIPO_DATA('9495753','01','01'),
        T_TIPO_DATA('9498675','01','01'),
        T_TIPO_DATA('9498230','01','01'),
        T_TIPO_DATA('9498229','01','01'),
        T_TIPO_DATA('20353172','01','01'),
        T_TIPO_DATA('9495748','01','01'),
        T_TIPO_DATA('9495758','01','01'),
        T_TIPO_DATA('9495362','01','01'),
        T_TIPO_DATA('9495746','01','01'),
        T_TIPO_DATA('9498089','01','01'),
        T_TIPO_DATA('9497111','01','01'),
        T_TIPO_DATA('20353171','01','01'),
        T_TIPO_DATA('9498677','01','01'),
        T_TIPO_DATA('9497112','01','01'),
        T_TIPO_DATA('9497113','01','01'),
        T_TIPO_DATA('9498682','01','01'),
        T_TIPO_DATA('9498684','01','01'),
        T_TIPO_DATA('9495756','01','01'),
        T_TIPO_DATA('9495759','01','01'),
        T_TIPO_DATA('9498097','01','01'),
        T_TIPO_DATA('9497110','01','01'),
        T_TIPO_DATA('9498678','01','01'),
        T_TIPO_DATA('9497115','01','01'),
        T_TIPO_DATA('9498683','01','01'),
        T_TIPO_DATA('9498669','01','01'),
        T_TIPO_DATA('9498088','01','01'),
        T_TIPO_DATA('9495755','01','01'),
        T_TIPO_DATA('9498093','01','01'),
        T_TIPO_DATA('9498680','01','01'),
        T_TIPO_DATA('9498096','01','01'),
        T_TIPO_DATA('9498098','01','01'),
        T_TIPO_DATA('9498099','01','01'),
        T_TIPO_DATA('9495747','01','01'),
        T_TIPO_DATA('9498091','01','01'),
        T_TIPO_DATA('9498668','01','01'),
        T_TIPO_DATA('9498671','01','01'),
        T_TIPO_DATA('9498672','01','01'),
        T_TIPO_DATA('9495750','01','01'),
        T_TIPO_DATA('9498673','01','01'),
        T_TIPO_DATA('9495752','01','01'),
        T_TIPO_DATA('9498090','01','01'),
        T_TIPO_DATA('9498676','01','01'),
        T_TIPO_DATA('9497116','01','01'),
        T_TIPO_DATA('9497118','01','01'),
        T_TIPO_DATA('9498686','01','01'),
        T_TIPO_DATA('9497119','01','01'),
        T_TIPO_DATA('9498670','01','01'),
        T_TIPO_DATA('9498674','01','01'),
        T_TIPO_DATA('9495754','01','01'),
        T_TIPO_DATA('9495757','01','01'),
        T_TIPO_DATA('9498094','01','01'),
        T_TIPO_DATA('9498681','01','01'),
        T_TIPO_DATA('9498095','01','01'),
        T_TIPO_DATA('9495760','01','01'),
        T_TIPO_DATA('9498679','01','01'),
        T_TIPO_DATA('9497114','01','01'),
        T_TIPO_DATA('9498092','01','01'),
        T_TIPO_DATA('9497117','01','01'),
        T_TIPO_DATA('9498685','01','01'),
        T_TIPO_DATA('19803683','01','01'),
        T_TIPO_DATA('15366041','01','01'),
        T_TIPO_DATA('9498490','01','01'),
        T_TIPO_DATA('9496239','01','01'),
        T_TIPO_DATA('9498625','01','01'),
        T_TIPO_DATA('18977617','01','01'),
        T_TIPO_DATA('18977618','01','01'),
        T_TIPO_DATA('18977629','01','01'),
        T_TIPO_DATA('18977631','01','01'),
        T_TIPO_DATA('18977615','01','01'),
        T_TIPO_DATA('9496240','01','01'),
        T_TIPO_DATA('18264636','01','01'),
        T_TIPO_DATA('21081684','01','01'),
        T_TIPO_DATA('21081622','01','01'),
        T_TIPO_DATA('18977616','01','01'),
        T_TIPO_DATA('18977622','01','01'),
        T_TIPO_DATA('18977625','01','01'),
        T_TIPO_DATA('18977623','01','01'),
        T_TIPO_DATA('21081692','01','01'),
        T_TIPO_DATA('21081694','01','01'),
        T_TIPO_DATA('18977634','01','01'),
        T_TIPO_DATA('18977641','01','01'),
        T_TIPO_DATA('18977613','01','01'),
        T_TIPO_DATA('18264637','01','01'),
        T_TIPO_DATA('18977644','01','01'),
        T_TIPO_DATA('18977647','01','01'),
        T_TIPO_DATA('21081584','01','01'),
        T_TIPO_DATA('21081596','01','01'),
        T_TIPO_DATA('21081704','01','01'),
        T_TIPO_DATA('21081708','01','01'),
        T_TIPO_DATA('21081600','01','01'),
        T_TIPO_DATA('21081639','01','01'),
        T_TIPO_DATA('21081642','01','01'),
        T_TIPO_DATA('18977632','01','01'),
        T_TIPO_DATA('18977639','01','01'),
        T_TIPO_DATA('18977649','01','01'),
        T_TIPO_DATA('21081701','01','01'),
        T_TIPO_DATA('21081574','01','01'),
        T_TIPO_DATA('21081590','01','01'),
        T_TIPO_DATA('18977620','01','01'),
        T_TIPO_DATA('18977643','01','01'),
        T_TIPO_DATA('18977614','01','01'),
        T_TIPO_DATA('18977624','01','01'),
        T_TIPO_DATA('18977630','01','01'),
        T_TIPO_DATA('18977611','01','01'),
        T_TIPO_DATA('18977612','01','01'),
        T_TIPO_DATA('21081676','01','01'),
        T_TIPO_DATA('21081666','01','01'),
        T_TIPO_DATA('21081669','01','01'),
        T_TIPO_DATA('21081604','01','01'),
        T_TIPO_DATA('21081612','01','01'),
        T_TIPO_DATA('21081657','01','01'),
        T_TIPO_DATA('21081578','01','01'),
        T_TIPO_DATA('21081581','01','01'),
        T_TIPO_DATA('21081625','01','01'),
        T_TIPO_DATA('18977636','01','01'),
        T_TIPO_DATA('18977650','01','01'),
        T_TIPO_DATA('21081698','01','01'),
        T_TIPO_DATA('21081661','01','01'),
        T_TIPO_DATA('21081688','01','01'),
        T_TIPO_DATA('21081631','01','01'),
        T_TIPO_DATA('21081635','01','01'),
        T_TIPO_DATA('23291991','01','01'),
        T_TIPO_DATA('21081607','01','01'),
        T_TIPO_DATA('21081648','01','01'),
        T_TIPO_DATA('21081653','01','01'),
        T_TIPO_DATA('12040268','01','01'),
        T_TIPO_DATA('15366065','01','01'),
        T_TIPO_DATA('9493636','01','01'),
        T_TIPO_DATA('18819961','01','01'),
        T_TIPO_DATA('22923430','01','01'),
        T_TIPO_DATA('22923431','01','01'),
        T_TIPO_DATA('22923432','01','01'),
        T_TIPO_DATA('9494226','01','01'),
        T_TIPO_DATA('23691888','01','01'),
        T_TIPO_DATA('23432466','01','01'),
        T_TIPO_DATA('23432465','01','01'),
        T_TIPO_DATA('23432467','01','01'),
        T_TIPO_DATA('23691885','01','01'),
        T_TIPO_DATA('23691884','01','01'),
        T_TIPO_DATA('12554562','01','01'),
        T_TIPO_DATA('24034350','01','01'),
        T_TIPO_DATA('24064085','01','01'),
        T_TIPO_DATA('22864899','01','01'),
        T_TIPO_DATA('20434121','01','01'),
        T_TIPO_DATA('23432491','01','01'),
        T_TIPO_DATA('23432472','01','01'),
        T_TIPO_DATA('23432489','01','01'),
        T_TIPO_DATA('23291987','01','01'),
        T_TIPO_DATA('23291986','01','01'),
        T_TIPO_DATA('12798929','01','01'),
        T_TIPO_DATA('20743911','01','01'),
        T_TIPO_DATA('9491863','01','01'),
        T_TIPO_DATA('20098184','01','01'),
        T_TIPO_DATA('12297235','01','01'),
        T_TIPO_DATA('21007380','01','01'),
        T_TIPO_DATA('20561893','01','01'),
        T_TIPO_DATA('20980233','01','01'),
        T_TIPO_DATA('20561889','01','01'),
        T_TIPO_DATA('20980250','01','01'),
        T_TIPO_DATA('20098169','01','01'),
        T_TIPO_DATA('19830433','01','01'),
        T_TIPO_DATA('9496476','01','01'),
        T_TIPO_DATA('20980240','01','01'),
        T_TIPO_DATA('9491824','01','01'),
        T_TIPO_DATA('9493817','01','01'),
        T_TIPO_DATA('20561888','01','01'),
        T_TIPO_DATA('20561896','01','01'),
        T_TIPO_DATA('23063157','01','01'),
        T_TIPO_DATA('23063156','01','01'),
        T_TIPO_DATA('20561894','01','01'),
        T_TIPO_DATA('21568577','01','01'),
        T_TIPO_DATA('20980244','01','01'),
        T_TIPO_DATA('20225691','01','01'),
        T_TIPO_DATA('21372079','01','01'),
        T_TIPO_DATA('21372095','01','01'),
        T_TIPO_DATA('21372085','01','01'),
        T_TIPO_DATA('21372099','01','01'),
        T_TIPO_DATA('21372096','01','01'),
        T_TIPO_DATA('21372088','01','01'),
        T_TIPO_DATA('21372094','01','01'),
        T_TIPO_DATA('21372077','01','01'),
        T_TIPO_DATA('21372089','01','01'),
        T_TIPO_DATA('21372083','01','01'),
        T_TIPO_DATA('9494490','01','01'),
        T_TIPO_DATA('18819958','01','01'),
        T_TIPO_DATA('20198694','01','01'),
        T_TIPO_DATA('20198732','01','01'),
        T_TIPO_DATA('20198702','01','01'),
        T_TIPO_DATA('20198739','01','01'),
        T_TIPO_DATA('20198727','01','01'),
        T_TIPO_DATA('20198707','01','01'),
        T_TIPO_DATA('20198729','01','01'),
        T_TIPO_DATA('20198693','01','01'),
        T_TIPO_DATA('20198740','01','01'),
        T_TIPO_DATA('20198715','01','01'),
        T_TIPO_DATA('20198737','01','01'),
        T_TIPO_DATA('20198725','01','01'),
        T_TIPO_DATA('20198735','01','01'),
        T_TIPO_DATA('20198698','01','01'),
        T_TIPO_DATA('20198731','01','01'),
        T_TIPO_DATA('20198695','01','01'),
        T_TIPO_DATA('20198750','01','01'),
        T_TIPO_DATA('20198699','01','01'),
        T_TIPO_DATA('20198752','01','01'),
        T_TIPO_DATA('20198753','01','01'),
        T_TIPO_DATA('20198742','01','01'),
        T_TIPO_DATA('20797848','01','01'),
        T_TIPO_DATA('13526765','01','01'),
        T_TIPO_DATA('14928795','01','01'),
        T_TIPO_DATA('14928794','01','01'),
        T_TIPO_DATA('12597501','01','01'),
        T_TIPO_DATA('23033630','01','01'),
        T_TIPO_DATA('18846093','01','01'),
        T_TIPO_DATA('22923427','01','01'),
        T_TIPO_DATA('9497840','01','01'),
        T_TIPO_DATA('9497839','01','01'),
        T_TIPO_DATA('9497841','01','01'),
        T_TIPO_DATA('21846206','01','01'),
        T_TIPO_DATA('20353075','01','01'),
        T_TIPO_DATA('23151731','01','01'),
        T_TIPO_DATA('9497612','01','01'),
        T_TIPO_DATA('21765861','01','01'),
        T_TIPO_DATA('19030460','01','01'),
        T_TIPO_DATA('20279369','01','01'),
        T_TIPO_DATA('19803680','01','01'),
        T_TIPO_DATA('18951137','01','01'),
        T_TIPO_DATA('9492358','01','01'),
        T_TIPO_DATA('22952761','01','01'),
        T_TIPO_DATA('20380116','01','01'),
        T_TIPO_DATA('18846087','01','01'),
        T_TIPO_DATA('18924886','01','01'),
        T_TIPO_DATA('22952760','01','01'),
        T_TIPO_DATA('22952762','01','01'),
        T_TIPO_DATA('14928803','01','01'),
        T_TIPO_DATA('20380101','01','01'),
        T_TIPO_DATA('20380099','01','01'),
        T_TIPO_DATA('23521747','01','01'),
        T_TIPO_DATA('18951138','01','01'),
        T_TIPO_DATA('20380110','01','01'),
        T_TIPO_DATA('22725533','01','01'),
        T_TIPO_DATA('20225624','01','01'),
        T_TIPO_DATA('18793855','01','01'),
        T_TIPO_DATA('20225627','01','01'),
        T_TIPO_DATA('20926048','01','01'),
        T_TIPO_DATA('20926070','01','01'),
        T_TIPO_DATA('20926043','01','01'),
        T_TIPO_DATA('22357941','01','01'),
        T_TIPO_DATA('22357940','01','01'),
        T_TIPO_DATA('20926054','01','01'),
        T_TIPO_DATA('22072953','01','01'),
        T_TIPO_DATA('20926046','01','01'),
        T_TIPO_DATA('20926052','01','01'),
        T_TIPO_DATA('20926066','01','01'),
        T_TIPO_DATA('18924839','01','01'),
        T_TIPO_DATA('18924838','01','01'),
        T_TIPO_DATA('18924840','01','01'),
        T_TIPO_DATA('20926063','01','01'),
        T_TIPO_DATA('20926062','01','01'),
        T_TIPO_DATA('20926060','01','01'),
        T_TIPO_DATA('20926057','01','01'),
        T_TIPO_DATA('20926068','01','01'),
        T_TIPO_DATA('18924830','01','01'),
        T_TIPO_DATA('20980096','01','01'),
        T_TIPO_DATA('19803693','01','01'),
        T_TIPO_DATA('21539323','01','01'),
        T_TIPO_DATA('9498333','01','01'),
        T_TIPO_DATA('9495131','01','01'),
        T_TIPO_DATA('9496824','01','01'),
        T_TIPO_DATA('9496767','01','01'),
        T_TIPO_DATA('9498334','01','01'),
        T_TIPO_DATA('9496766','01','01'),
        T_TIPO_DATA('9498332','01','01'),
        T_TIPO_DATA('9492865','01','01'),
        T_TIPO_DATA('20380089','01','01'),
        T_TIPO_DATA('42041853','01','01'),
        T_TIPO_DATA('18924885','01','01'),
        T_TIPO_DATA('19990875','01','01'),
        T_TIPO_DATA('18924884','01','01'),
        T_TIPO_DATA('18924858','01','01'),
        T_TIPO_DATA('18924857','01','01'),
        T_TIPO_DATA('18924856','01','01'),
        T_TIPO_DATA('18846107','01','01'),
        T_TIPO_DATA('19990866','01','01'),
        T_TIPO_DATA('19990869','01','01'),
        T_TIPO_DATA('20279346','01','01'),
        T_TIPO_DATA('20279341','01','01'),
        T_TIPO_DATA('19990868','01','01'),
        T_TIPO_DATA('20279344','01','01'),
        T_TIPO_DATA('20279343','01','01'),
        T_TIPO_DATA('19990871','01','01'),
        T_TIPO_DATA('19990872','01','01'),
        T_TIPO_DATA('20279335','01','01'),
        T_TIPO_DATA('18924883','01','01'),
        T_TIPO_DATA('19990873','01','01'),
        T_TIPO_DATA('20279342','01','01'),
        T_TIPO_DATA('20279345','01','01'),
        T_TIPO_DATA('20252507','01','01'),
        T_TIPO_DATA('21933962','01','01'),
        T_TIPO_DATA('21846232','01','01'),
        T_TIPO_DATA('20279384','01','01'),
        T_TIPO_DATA('20353103','01','01'),
        T_TIPO_DATA('20716940','01','01'),
        T_TIPO_DATA('22835618','01','01'),
        T_TIPO_DATA('22864893','01','01'),
        T_TIPO_DATA('19803667','01','01'),
        T_TIPO_DATA('21345010','01','01'),
        T_TIPO_DATA('19990879','01','01'),
        T_TIPO_DATA('20353098','01','01'),
        T_TIPO_DATA('19990880','01','01'),
        T_TIPO_DATA('21933822','01','01'),
        T_TIPO_DATA('21933817','01','01'),
        T_TIPO_DATA('20407029','01','01'),
        T_TIPO_DATA('20279385','01','01'),
        T_TIPO_DATA('21539451','01','01'),
        T_TIPO_DATA('21875402','01','01'),
        T_TIPO_DATA('21875405','01','01'),
        T_TIPO_DATA('18924749','01','01'),
        T_TIPO_DATA('22328690','01','01'),
        T_TIPO_DATA('22043778','01','01'),
        T_TIPO_DATA('18951089','01','01'),
        T_TIPO_DATA('22043775','01','01'),
        T_TIPO_DATA('18951088','01','01'),
        T_TIPO_DATA('20198710','01','01'),
        T_TIPO_DATA('20407080','01','01'),
        T_TIPO_DATA('18977608','01','01'),
        T_TIPO_DATA('22636993','01','01'),
        T_TIPO_DATA('24469662','01','01'),
        T_TIPO_DATA('24469664','01','01'),
        T_TIPO_DATA('24469666','01','01'),
        T_TIPO_DATA('24469663','01','01'),
        T_TIPO_DATA('20353082','01','01'),
        T_TIPO_DATA('20353083','01','01'),
        T_TIPO_DATA('20279387','01','01'),
        T_TIPO_DATA('22241087','01','01'),
        T_TIPO_DATA('22241088','01','01'),
        T_TIPO_DATA('20407036','01','01'),
        T_TIPO_DATA('19990881','01','01'),
        T_TIPO_DATA('21846216','01','01'),
        T_TIPO_DATA('20380096','01','01'),
        T_TIPO_DATA('18977654','01','01'),
        T_TIPO_DATA('20407087','01','01'),
        T_TIPO_DATA('17874836','01','01'),
        T_TIPO_DATA('17874837','01','01'),
        T_TIPO_DATA('22072979','01','01'),
        T_TIPO_DATA('20743910','01','01'),
        T_TIPO_DATA('20279395','01','01'),
        T_TIPO_DATA('20407166','01','01'),
        T_TIPO_DATA('20098208','01','01'),
        T_TIPO_DATA('19723300','01','01'),
        T_TIPO_DATA('22497410','01','01'),
        T_TIPO_DATA('22497409','01','01'),
        T_TIPO_DATA('18951133','01','01'),
        T_TIPO_DATA('20926019','01','01'),
        T_TIPO_DATA('20926021','01','01'),
        T_TIPO_DATA('20926020','01','01'),
        T_TIPO_DATA('19830381','01','01'),
        T_TIPO_DATA('20407176','01','01'),
        T_TIPO_DATA('23291997','01','01'),
        T_TIPO_DATA('22923424','01','01'),
        T_TIPO_DATA('23291998','01','01'),
        T_TIPO_DATA('23292000','01','01'),
        T_TIPO_DATA('23291999','01','01'),
        T_TIPO_DATA('20434099','01','01'),
        T_TIPO_DATA('21736748','01','01'),
        T_TIPO_DATA('24294512','01','01'),
        T_TIPO_DATA('23432372','01','01'),
        T_TIPO_DATA('16766986','01','01'),
        T_TIPO_DATA('21649052','01','01'),
        T_TIPO_DATA('23122382','01','01'),
        T_TIPO_DATA('24469642','01','01'),
        T_TIPO_DATA('24469638','01','01'),
        T_TIPO_DATA('21707510','01','01'),
        T_TIPO_DATA('21707509','01','01'),
        T_TIPO_DATA('17693084','01','01'),
        T_TIPO_DATA('22725534','01','01'),
        T_TIPO_DATA('23092684','01','01'),
        T_TIPO_DATA('22695763','01','01'),
        T_TIPO_DATA('24560793','01','01'),
        T_TIPO_DATA('24560800','01','01'),
        T_TIPO_DATA('23892663','01','01'),
        T_TIPO_DATA('23892669','01','01'),
        T_TIPO_DATA('20071340','01','01'),
        T_TIPO_DATA('20071333','01','01'),
        T_TIPO_DATA('20071339','01','01'),
        T_TIPO_DATA('20071335','01','01'),
        T_TIPO_DATA('20071334','01','01'),
        T_TIPO_DATA('20071337','01','01'),
        T_TIPO_DATA('20071338','01','01'),
        T_TIPO_DATA('20071336','01','01'),
        T_TIPO_DATA('23092663','01','01'),
        T_TIPO_DATA('23462251','01','01'),
        T_TIPO_DATA('23462228','01','01'),
        T_TIPO_DATA('23092848','01','01'),
        T_TIPO_DATA('23462402','01','01'),
        T_TIPO_DATA('23092879','01','01'),
        T_TIPO_DATA('24560806','01','01'),
        T_TIPO_DATA('24560807','01','01'),
        T_TIPO_DATA('24034351','01','01'),
        T_TIPO_DATA('23662387','01','01'),
        T_TIPO_DATA('23662385','01','01'),
        T_TIPO_DATA('23662386','01','01'),
        T_TIPO_DATA('23662388','01','01'),
        T_TIPO_DATA('23662389','01','01'),
        T_TIPO_DATA('22695927','01','01'),
        T_TIPO_DATA('22725553','01','01'),
        T_TIPO_DATA('24560823','01','01'),
        T_TIPO_DATA('24560817','01','01'),
        T_TIPO_DATA('22725567','01','01'),
        T_TIPO_DATA('24093731','01','01'),
        T_TIPO_DATA('24093730','01','01'),
        T_TIPO_DATA('24093729','01','01'),
        T_TIPO_DATA('24235012','01','01')
    ); 
    V_TMP_TIPO_DATA T_TIPO_DATA;
    
BEGIN
DBMS_OUTPUT.PUT_LINE('[INICIO]');


    DBMS_OUTPUT.PUT_LINE('[INFO]: UPDATE EN '||V_TEXT_TABLA);
    FOR I IN V_TIPO_DATA.FIRST .. V_TIPO_DATA.LAST
      LOOP

        V_TMP_TIPO_DATA := V_TIPO_DATA(I);

        --Comprobar el dato a updatear.
        V_MSQL := 'SELECT COUNT(1) FROM '||V_ESQUEMA||'.'||V_TEXT_TABLA||' acc
                         WHERE acc.CRG_ID = '||TRIM(V_TMP_TIPO_DATA(1))||'
                         AND acc.BORRADO= 0';
        EXECUTE IMMEDIATE V_MSQL INTO V_NUM_TABLAS; 
        -- Si existe se modifica.
        IF V_NUM_TABLAS > 0 THEN
            DBMS_OUTPUT.PUT_LINE('[INFO]: ACTUALIZAD EL REGISTRO  CRG_ID '''|| TRIM(V_TMP_TIPO_DATA(1)) ||''' CON ESTADO DE CARGA '''|| TRIM(V_TMP_TIPO_DATA(2)) ||''' Y SUBESTADO '''|| TRIM(V_TMP_TIPO_DATA(3)) ||'');
            V_MSQL := 'UPDATE '|| V_ESQUEMA ||'.'||V_TEXT_TABLA||' 
                        SET USUARIOMODIFICAR = '''||V_USUARIO||''' 
                            , FECHAMODIFICAR = SYSDATE '||
                           ', DD_ECG_ID = (SELECT ecg.DD_ECG_ID
                                            FROM '||V_ESQUEMA||'.DD_ECG_ESTADO_CARGA ecg
                                    WHERE ecg.DD_ECG_CODIGO = '||TRIM(V_TMP_TIPO_DATA(2))||'
                                    AND ecg.BORRADO= 0) 
                            , DD_SCG_ID = (SELECT scg.DD_SCG_ID
                                            FROM '||V_ESQUEMA||'.DD_SCG_SUBESTADO_CARGA scg
                                    WHERE scg.DD_SCG_CODIGO = '||TRIM(V_TMP_TIPO_DATA(3))||'
                                    AND scg.BORRADO= 0) 
                        WHERE CRG_ID = '||TRIM(V_TMP_TIPO_DATA(1))||'
                            AND BORRADO = 0';
            EXECUTE IMMEDIATE V_MSQL;
            DBMS_OUTPUT.PUT_LINE('[INFO]: REGISTRO ACTUALIZADO CORRECTAMENTE EN ACT_CRG_CARGAS');
       ELSE
            DBMS_OUTPUT.PUT_LINE('[INFO]: NO EXISTE EL REGISTRO CON CRG_ID:  '''||TRIM(V_TMP_TIPO_DATA(1))||'''');
       END IF;
      END LOOP;
      
    COMMIT;
    DBMS_OUTPUT.PUT_LINE('[FIN]: TABLA '||V_TEXT_TABLA||' ACTUALIZADA CORRECTAMENTE ');

EXCEPTION
     WHEN OTHERS THEN
          ERR_NUM := SQLCODE;
          ERR_MSG := SQLERRM;
          DBMS_OUTPUT.put_line('[ERROR] Se ha producido un error en la ejecución:'||TO_CHAR(ERR_NUM));
          DBMS_OUTPUT.put_line('-----------------------------------------------------------'); 
          DBMS_OUTPUT.put_line(ERR_MSG);
          ROLLBACK;
          RAISE;   
END;
/
EXIT;
