--/*
--##########################################
--## AUTOR=IVAN REPISO
--## FECHA_CREACION=20230116
--## ARTEFACTO=online
--## VERSION_ARTEFACTO=9.3
--## INCIDENCIA_LINK=REMVIP-12753
--## PRODUCTO=NO
--##
--## Finalidad: MODIFICAR CONFIG PROVEEDORES
--## INSTRUCCIONES: 
--## VERSIONES:
--##        0.1 Version inicial
--##########################################
--*/

--Para permitir la visualización de texto en un bloque PL/SQL utilizando DBMS_OUTPUT.PUT_LINE

WHENEVER SQLERROR EXIT SQL.SQLCODE;
SET SERVEROUTPUT ON;
SET DEFINE OFF;


DECLARE
    V_MSQL VARCHAR2(32000 CHAR); -- Sentencia a ejecutar     
    V_ESQUEMA VARCHAR2(25 CHAR):= '#ESQUEMA#'; -- Configuracion Esquema
    V_ESQUEMA_M VARCHAR2(25 CHAR):= '#ESQUEMA_MASTER#'; -- Configuracion Esquema Master
    V_NUM_TABLAS NUMBER(16); -- Vble. para validar la existencia de una tabla.   
    ERR_NUM NUMBER(25);  -- Vble. auxiliar para registrar errores en el script.
    ERR_MSG VARCHAR2(1024 CHAR); -- Vble. auxiliar para registrar errores en el script.
	V_TEXT_TABLA VARCHAR2(2400 CHAR) := 'CFG_PVE_PREDETERMINADO'; -- Vble. auxiliar para almacenar el nombre de la tabla de ref.
    V_USUARIO VARCHAR2(50 CHAR) := 'REMVIP-12753';

    TYPE T_TIPO_DATA IS TABLE OF VARCHAR2(1000);
    TYPE T_ARRAY_DATA IS TABLE OF T_TIPO_DATA;
    V_TIPO_DATA T_ARRAY_DATA := T_ARRAY_DATA(
            --          1.SUBCARTERAS         2.PVE_COD_REM         3.PROVINCIAS          4.TIPO_TRABAJO        5.SUBTIPO_TRABAJO
    	T_TIPO_DATA('(''154'',''153'',''155'',''157'',''156'',''158'')','10007348','(''10'',''11'',''14'',''18'',''21'',''23'',''25'',''29'',''4'',''41'',''43'',''51'',''52'',''6'')','03','120'),
        T_TIPO_DATA('(''154'',''153'',''155'',''157'',''156'',''158'')','10007550','(''12'',''17'',''3'',''30'',''46'',''7'')','03','120'),
        T_TIPO_DATA('(''154'',''153'',''155'',''157'',''156'',''158'')','110165264','(''8'',''28'')','03','120'),
        T_TIPO_DATA('(''154'',''153'',''155'',''157'',''156'',''158'')','110186397','(''35'',''38'')','03','120'),
        T_TIPO_DATA('(''154'',''153'',''155'',''157'',''156'',''158'')','10007348','(''10'',''11'',''14'',''18'',''21'',''23'',''25'',''29'',''4'',''41'',''43'',''51'',''52'',''6'')','03','128'),
        T_TIPO_DATA('(''154'',''153'',''155'',''157'',''156'',''158'')','10007550','(''12'',''17'',''3'',''30'',''46'',''7'')','03','128'),
        T_TIPO_DATA('(''154'',''153'',''155'',''157'',''156'',''158'')','110165264','(''8'',''28'')','03','128'),
        T_TIPO_DATA('(''154'',''153'',''155'',''157'',''156'',''158'')','110186397','(''35'',''38'')','03','128'),
        T_TIPO_DATA('(''138'')','110187030','(''15'',''1'',''2'',''3'',''4'',''33'',''5'',''6'',''7'',''8'',''9'',''10'',''11'',''39'',''12'',''51'',''13'',''14'',''16'',''17'',''18'',''19'',''20'',''21'',''22'',''23'',''26'',''35'',''24'',''25'',''27'',''28'',''29'',''52'',''30'',''31'',''32'',''34'',''36'',''37'',''38'',''40'',''41'',''42'',''43'',''44'',''45'',''46'',''47'',''48'',''49'',''50'')','03','128'),
        T_TIPO_DATA('(''151'',''152'')','110187030','(''15'',''1'',''2'',''3'',''4'',''33'',''5'',''6'',''7'',''8'',''9'',''10'',''11'',''39'',''12'',''51'',''13'',''14'',''16'',''17'',''18'',''19'',''20'',''21'',''22'',''23'',''26'',''35'',''24'',''25'',''27'',''28'',''29'',''52'',''30'',''31'',''32'',''34'',''36'',''37'',''38'',''40'',''41'',''42'',''43'',''44'',''45'',''46'',''47'',''48'',''49'',''50'')','03','128'),
        T_TIPO_DATA('(''71'')','110187030','(''15'',''1'',''2'',''3'',''4'',''33'',''5'',''6'',''7'',''8'',''9'',''10'',''11'',''39'',''12'',''51'',''13'',''14'',''16'',''17'',''18'',''19'',''20'',''21'',''22'',''23'',''26'',''35'',''24'',''25'',''27'',''28'',''29'',''52'',''30'',''31'',''32'',''34'',''36'',''37'',''38'',''40'',''41'',''42'',''43'',''44'',''45'',''46'',''47'',''48'',''49'',''50'')','03','128'),
        T_TIPO_DATA('(''138'',''151'',''152'',''70'',''71'')','10004633','(''15'',''1'',''2'',''3'',''4'',''33'',''5'',''6'',''7'',''8'',''9'',''10'',''11'',''39'',''12'',''51'',''13'',''14'',''16'',''17'',''18'',''19'',''20'',''21'',''22'',''23'',''26'',''35'',''24'',''25'',''27'',''28'',''29'',''52'',''30'',''31'',''32'',''34'',''36'',''37'',''38'',''40'',''41'',''42'',''43'',''44'',''45'',''46'',''47'',''48'',''49'',''50'')','09','147'),
        T_TIPO_DATA('(''08'',''06'',''160'',''05'',''161'',''15'',''19'',''14'',''09'')','10005745','(''15'',''1'',''2'',''3'',''4'',''33'',''5'',''6'',''7'',''8'',''9'',''10'',''11'',''39'',''12'',''51'',''13'',''14'',''16'',''17'',''18'',''19'',''20'',''21'',''22'',''23'',''26'',''35'',''24'',''25'',''27'',''28'',''29'',''52'',''30'',''31'',''32'',''34'',''36'',''37'',''38'',''40'',''41'',''42'',''43'',''44'',''45'',''46'',''47'',''48'',''49'',''50'')','09','147'),
        T_TIPO_DATA('(''01'',''02'')','10005745','(''15'',''1'',''2'',''3'',''4'',''33'',''5'',''6'',''7'',''8'',''9'',''10'',''11'',''39'',''12'',''51'',''13'',''14'',''16'',''17'',''18'',''19'',''20'',''21'',''22'',''23'',''26'',''35'',''24'',''25'',''27'',''28'',''29'',''52'',''30'',''31'',''32'',''34'',''36'',''37'',''38'',''40'',''41'',''42'',''43'',''44'',''45'',''46'',''47'',''48'',''49'',''50'')','09','147'),
        T_TIPO_DATA('(''154'',''153'',''155'',''157'',''156'',''158'',''151'',''152'')','10010449','(''17'',''25'',''43'',''15'',''33'',''5'',''9'',''24'',''27'',''32'',''34'',''36'',''37'',''40'',''42'',''47'',''49'',''1'',''39'',''20'',''22'',''26'',''31'',''44'',''48'',''50'',''4'',''6'',''10'',''11'',''14'',''18'',''21'',''23'',''29'',''41'')','09','147'),
        T_TIPO_DATA('(''138'',''151'',''152'',''70'',''71'')','110165264','(''8'',''28'')','09','147'),
        T_TIPO_DATA('(''154'',''153'',''155'',''157'',''156'',''158'',''151'',''152'')','110165264','(''8'',''28'')','09','147'),
        T_TIPO_DATA('(''154'',''153'',''155'',''157'',''156'',''158'',''151'',''152'')','110184638','(''3'',''7'',''12'',''30'',''46'',''35'',''38'')','09','147'),
        T_TIPO_DATA('(''138'',''151'',''152'',''70'',''71'')','110184638','(''15'',''1'',''2'',''3'',''4'',''33'',''5'',''6'',''7'',''8'',''9'',''10'',''11'',''39'',''12'',''51'',''13'',''14'',''16'',''17'',''18'',''19'',''20'',''21'',''22'',''23'',''26'',''35'',''24'',''25'',''27'',''28'',''29'',''52'',''30'',''31'',''32'',''34'',''36'',''37'',''38'',''40'',''41'',''42'',''43'',''44'',''45'',''46'',''47'',''48'',''49'',''50'')','09','147'),
        T_TIPO_DATA('(''138'',''151'',''152'',''70'',''71'')','10004633','(''15'',''1'',''2'',''3'',''4'',''33'',''5'',''6'',''7'',''8'',''9'',''10'',''11'',''39'',''12'',''51'',''13'',''14'',''16'',''17'',''18'',''19'',''20'',''21'',''22'',''23'',''26'',''35'',''24'',''25'',''27'',''28'',''29'',''52'',''30'',''31'',''32'',''34'',''36'',''37'',''38'',''40'',''41'',''42'',''43'',''44'',''45'',''46'',''47'',''48'',''49'',''50'')','09','148'),
        T_TIPO_DATA('(''01'',''02'')','10005745','(''15'',''1'',''2'',''3'',''4'',''33'',''5'',''6'',''7'',''8'',''9'',''10'',''11'',''39'',''12'',''51'',''13'',''14'',''16'',''17'',''18'',''19'',''20'',''21'',''22'',''23'',''26'',''35'',''24'',''25'',''27'',''28'',''29'',''52'',''30'',''31'',''32'',''34'',''36'',''37'',''38'',''40'',''41'',''42'',''43'',''44'',''45'',''46'',''47'',''48'',''49'',''50'')','09','148'),
        T_TIPO_DATA('(''08'',''06'',''160'',''05'',''161'',''15'',''19'',''14'',''09'')','10005745','(''15'',''1'',''2'',''3'',''4'',''33'',''5'',''6'',''7'',''8'',''9'',''10'',''11'',''39'',''12'',''51'',''13'',''14'',''16'',''17'',''18'',''19'',''20'',''21'',''22'',''23'',''26'',''35'',''24'',''25'',''27'',''28'',''29'',''52'',''30'',''31'',''32'',''34'',''36'',''37'',''38'',''40'',''41'',''42'',''43'',''44'',''45'',''46'',''47'',''48'',''49'',''50'')','09','148'),
        T_TIPO_DATA('(''154'',''153'',''155'',''157'',''156'',''158'',''151'',''152'')','10010449','(''17'',''25'',''43'',''15'',''33'',''5'',''9'',''24'',''27'',''32'',''34'',''36'',''37'',''40'',''42'',''47'',''49'',''1'',''39'',''20'',''22'',''26'',''31'',''44'',''48'',''50'',''4'',''6'',''10'',''11'',''14'',''18'',''21'',''23'',''29'',''41'')','09','148'),
        T_TIPO_DATA('(''138'',''151'',''152'',''70'',''71'')','110165264','(''8'',''28'')','09','148'),
        T_TIPO_DATA('(''154'',''153'',''155'',''157'',''156'',''158'',''151'',''152'')','110165264','(''8'',''28'')','09','148'),
        T_TIPO_DATA('(''154'',''153'',''155'',''157'',''156'',''158'',''151'',''152'')','110184638','(''3'',''7'',''12'',''30'',''46'',''35'',''38'')','09','148'),
        T_TIPO_DATA('(''138'',''151'',''152'',''70'',''71'')','110184638','(''15'',''1'',''2'',''3'',''4'',''33'',''5'',''6'',''7'',''8'',''9'',''10'',''11'',''39'',''12'',''51'',''13'',''14'',''16'',''17'',''18'',''19'',''20'',''21'',''22'',''23'',''26'',''35'',''24'',''25'',''27'',''28'',''29'',''52'',''30'',''31'',''32'',''34'',''36'',''37'',''38'',''40'',''41'',''42'',''43'',''44'',''45'',''46'',''47'',''48'',''49'',''50'')','09','148'),
        T_TIPO_DATA('(''138'',''151'',''152'',''70'',''71'')','10004633','(''15'',''1'',''2'',''3'',''4'',''33'',''5'',''6'',''7'',''8'',''9'',''10'',''11'',''39'',''12'',''51'',''13'',''14'',''16'',''17'',''18'',''19'',''20'',''21'',''22'',''23'',''26'',''35'',''24'',''25'',''27'',''28'',''29'',''52'',''30'',''31'',''32'',''34'',''36'',''37'',''38'',''40'',''41'',''42'',''43'',''44'',''45'',''46'',''47'',''48'',''49'',''50'')','09','149'),
        T_TIPO_DATA('(''08'',''06'',''160'',''05'',''161'',''15'',''19'',''14'',''09'')','10004633','(''15'',''1'',''2'',''3'',''4'',''33'',''5'',''6'',''7'',''8'',''9'',''10'',''11'',''39'',''12'',''51'',''13'',''14'',''16'',''17'',''18'',''19'',''20'',''21'',''22'',''23'',''26'',''35'',''24'',''25'',''27'',''28'',''29'',''52'',''30'',''31'',''32'',''34'',''36'',''37'',''38'',''40'',''41'',''42'',''43'',''44'',''45'',''46'',''47'',''48'',''49'',''50'')','09','149'),
        T_TIPO_DATA('(''154'',''153'',''155'',''157'',''156'',''158'')','10010495','(''17'',''25'',''43'',''8'',''35'',''38'',''3'',''7'',''13'',''16'',''19'',''2'',''45'',''12'',''30'',''46'',''15'',''33'',''5'',''9'',''24'',''27'',''32'',''34'',''36'',''37'',''40'',''42'',''47'',''49'',''1'',''39'',''20'',''22'',''26'',''31'',''44'',''48'',''50'',''4'',''6'',''10'',''11'',''14'',''18'',''21'',''23'',''29'',''41'')','09','149'),
        T_TIPO_DATA('(''151'',''152'')','10010495','(''17'',''25'',''43'',''8'',''13'',''3'',''7'',''12'',''30'',''46'',''16'',''19'',''2'',''45'',''35'',''38'',''15'',''33'',''5'',''9'',''24'',''27'',''32'',''34'',''36'',''37'',''40'',''42'',''47'',''49'',''1'',''39'',''20'',''22'',''26'',''31'',''44'',''48'',''50'',''4'',''6'',''10'',''11'',''14'',''18'',''21'',''23'',''29'',''41'')','09','149'),
        T_TIPO_DATA('(''138'',''151'',''152'',''70'',''71'')','110190181','(''15'',''1'',''2'',''3'',''4'',''33'',''5'',''6'',''7'',''8'',''9'',''10'',''11'',''39'',''12'',''51'',''13'',''14'',''16'',''17'',''18'',''19'',''20'',''21'',''22'',''23'',''26'',''35'',''24'',''25'',''27'',''28'',''29'',''52'',''30'',''31'',''32'',''34'',''36'',''37'',''38'',''40'',''41'',''42'',''43'',''44'',''45'',''46'',''47'',''48'',''49'',''50'')','09','149'),
        T_TIPO_DATA('(''154'',''153'',''155'',''157'',''156'',''158'')','39','(''15'',''33'',''5'',''9'',''24'',''27'',''32'',''34'',''36'',''37'',''40'',''42'',''47'',''49'',''4'',''6'',''10'',''11'',''14'',''18'',''21'',''23'',''29'',''41'',''2'',''13'',''16'',''19'',''28'',''45'')','09','149'),
        T_TIPO_DATA('(''151'',''152'')','39','(''15'',''33'',''5'',''9'',''24'',''27'',''32'',''34'',''36'',''37'',''40'',''42'',''47'',''49'',''4'',''6'',''10'',''11'',''14'',''18'',''21'',''23'',''29'',''41'',''2'',''13'',''16'',''19'',''28'',''45'')','09','149'),
        T_TIPO_DATA('(''154'',''153'',''155'',''157'',''156'',''158'')','10007348','(''10'',''11'',''14'',''18'',''21'',''23'',''25'',''29'',''4'',''41'',''43'',''51'',''52'',''6'')','09','150'),
        T_TIPO_DATA('(''154'',''153'',''155'',''157'',''156'',''158'')','10007550','(''12'',''17'',''3'',''30'',''46'',''7'')','09','150'),
        T_TIPO_DATA('(''154'',''153'',''155'',''157'',''156'',''158'')','110165264','(''8'',''28'')','09','150'),
        T_TIPO_DATA('(''154'',''153'',''155'',''157'',''156'',''158'')','110186397','(''35'',''38'')','09','150'),
        T_TIPO_DATA('(''151'',''152'')','110187030','(''15'',''1'',''2'',''3'',''4'',''33'',''5'',''6'',''7'',''8'',''9'',''10'',''11'',''39'',''12'',''51'',''13'',''14'',''16'',''17'',''18'',''19'',''20'',''21'',''22'',''23'',''26'',''35'',''24'',''25'',''27'',''28'',''29'',''52'',''30'',''31'',''32'',''34'',''36'',''37'',''38'',''40'',''41'',''42'',''43'',''44'',''45'',''46'',''47'',''48'',''49'',''50'')','09','150'),
        T_TIPO_DATA('(''71'')','110187030','(''15'',''1'',''2'',''3'',''4'',''33'',''5'',''6'',''7'',''8'',''9'',''10'',''11'',''39'',''12'',''51'',''13'',''14'',''16'',''17'',''18'',''19'',''20'',''21'',''22'',''23'',''26'',''35'',''24'',''25'',''27'',''28'',''29'',''52'',''30'',''31'',''32'',''34'',''36'',''37'',''38'',''40'',''41'',''42'',''43'',''44'',''45'',''46'',''47'',''48'',''49'',''50'')','09','150'),
        T_TIPO_DATA('(''08'',''06'',''160'',''05'',''161'',''15'',''19'',''14'',''09'')','10010725','(''15'',''1'',''2'',''3'',''4'',''33'',''5'',''6'',''7'',''8'',''9'',''10'',''11'',''39'',''12'',''51'',''13'',''14'',''16'',''17'',''18'',''19'',''20'',''21'',''22'',''23'',''26'',''35'',''24'',''25'',''27'',''28'',''29'',''52'',''30'',''31'',''32'',''34'',''36'',''37'',''38'',''40'',''41'',''42'',''43'',''44'',''45'',''46'',''47'',''48'',''49'',''50'')','09','153'),
        T_TIPO_DATA('(''138'')','110187030','(''15'',''1'',''2'',''3'',''4'',''33'',''5'',''6'',''7'',''8'',''9'',''10'',''11'',''39'',''12'',''51'',''13'',''14'',''16'',''17'',''18'',''19'',''20'',''21'',''22'',''23'',''26'',''35'',''24'',''25'',''27'',''28'',''29'',''52'',''30'',''31'',''32'',''34'',''36'',''37'',''38'',''40'',''41'',''42'',''43'',''44'',''45'',''46'',''47'',''48'',''49'',''50'')','09','153'),
        T_TIPO_DATA('(''151'',''152'')','110187030','(''15'',''1'',''2'',''3'',''4'',''33'',''5'',''6'',''7'',''8'',''9'',''10'',''11'',''39'',''12'',''51'',''13'',''14'',''16'',''17'',''18'',''19'',''20'',''21'',''22'',''23'',''26'',''35'',''24'',''25'',''27'',''28'',''29'',''52'',''30'',''31'',''32'',''34'',''36'',''37'',''38'',''40'',''41'',''42'',''43'',''44'',''45'',''46'',''47'',''48'',''49'',''50'')','09','153'),
        T_TIPO_DATA('(''71'')','110187030','(''15'',''1'',''2'',''3'',''4'',''33'',''5'',''6'',''7'',''8'',''9'',''10'',''11'',''39'',''12'',''51'',''13'',''14'',''16'',''17'',''18'',''19'',''20'',''21'',''22'',''23'',''26'',''35'',''24'',''25'',''27'',''28'',''29'',''52'',''30'',''31'',''32'',''34'',''36'',''37'',''38'',''40'',''41'',''42'',''43'',''44'',''45'',''46'',''47'',''48'',''49'',''50'')','09','153'),
        T_TIPO_DATA('(''08'',''06'',''160'',''05'',''161'',''15'',''19'',''14'',''09'')','10005745','(''15'',''1'',''2'',''3'',''4'',''33'',''5'',''6'',''7'',''8'',''9'',''10'',''11'',''39'',''12'',''51'',''13'',''14'',''16'',''17'',''18'',''19'',''20'',''21'',''22'',''23'',''26'',''35'',''24'',''25'',''27'',''28'',''29'',''52'',''30'',''31'',''32'',''34'',''36'',''37'',''38'',''40'',''41'',''42'',''43'',''44'',''45'',''46'',''47'',''48'',''49'',''50'')','09','154'),
        T_TIPO_DATA('(''154'',''153'',''155'',''157'',''156'',''158'')','10007348','(''10'',''11'',''14'',''18'',''21'',''23'',''25'',''29'',''4'',''41'',''43'',''51'',''52'',''6'')','03','26'),
        T_TIPO_DATA('(''154'',''153'',''155'',''157'',''156'',''158'')','10007550','(''12'',''17'',''3'',''30'',''46'',''7'')','03','26'),
        T_TIPO_DATA('(''154'',''153'',''155'',''157'',''156'',''158'')','110165264','(''8'',''28'')','03','26'),
        T_TIPO_DATA('(''154'',''153'',''155'',''157'',''156'',''158'')','110186397','(''35'',''38'')','03','26'),
        T_TIPO_DATA('(''138'')','110187030','(''15'',''1'',''2'',''3'',''4'',''33'',''5'',''6'',''7'',''8'',''9'',''10'',''11'',''39'',''12'',''51'',''13'',''14'',''16'',''17'',''18'',''19'',''20'',''21'',''22'',''23'',''26'',''35'',''24'',''25'',''27'',''28'',''29'',''52'',''30'',''31'',''32'',''34'',''36'',''37'',''38'',''40'',''41'',''42'',''43'',''44'',''45'',''46'',''47'',''48'',''49'',''50'')','03','26'),
        T_TIPO_DATA('(''151'',''152'')','110187030','(''15'',''1'',''2'',''3'',''4'',''33'',''5'',''6'',''7'',''8'',''9'',''10'',''11'',''39'',''12'',''51'',''13'',''14'',''16'',''17'',''18'',''19'',''20'',''21'',''22'',''23'',''26'',''35'',''24'',''25'',''27'',''28'',''29'',''52'',''30'',''31'',''32'',''34'',''36'',''37'',''38'',''40'',''41'',''42'',''43'',''44'',''45'',''46'',''47'',''48'',''49'',''50'')','03','26'),
        T_TIPO_DATA('(''71'')','110187030','(''15'',''1'',''2'',''3'',''4'',''33'',''5'',''6'',''7'',''8'',''9'',''10'',''11'',''39'',''12'',''51'',''13'',''14'',''16'',''17'',''18'',''19'',''20'',''21'',''22'',''23'',''26'',''35'',''24'',''25'',''27'',''28'',''29'',''52'',''30'',''31'',''32'',''34'',''36'',''37'',''38'',''40'',''41'',''42'',''43'',''44'',''45'',''46'',''47'',''48'',''49'',''50'')','03','26'),
        T_TIPO_DATA('(''154'',''153'',''155'',''157'',''156'',''158'')','10007348','(''10'',''11'',''14'',''18'',''21'',''23'',''25'',''29'',''4'',''41'',''43'',''51'',''52'',''6'')','03','62'),
        T_TIPO_DATA('(''154'',''153'',''155'',''157'',''156'',''158'')','10007550','(''12'',''17'',''3'',''30'',''46'',''7'')','03','62'),
        T_TIPO_DATA('(''154'',''153'',''155'',''157'',''156'',''158'')','110165264','(''8'',''28'')','03','62'),
        T_TIPO_DATA('(''154'',''153'',''155'',''157'',''156'',''158'')','110186397','(''35'',''38'')','03','62'),
        T_TIPO_DATA('(''01'',''02'')','10010725','(''15'',''1'',''2'',''3'',''4'',''33'',''5'',''6'',''7'',''8'',''9'',''10'',''11'',''39'',''12'',''51'',''13'',''14'',''16'',''17'',''18'',''19'',''20'',''21'',''22'',''23'',''26'',''35'',''24'',''25'',''27'',''28'',''29'',''52'',''30'',''31'',''32'',''34'',''36'',''37'',''38'',''40'',''41'',''42'',''43'',''44'',''45'',''46'',''47'',''48'',''49'',''50'')','03',''),
        T_TIPO_DATA('(''01'',''02'')','110161735','(''17'',''25'',''43'',''8'',''15'',''1'',''39'',''20'',''22'',''26'',''27'',''32'',''36'',''44'',''48'',''50'')','03',''),
        T_TIPO_DATA('(''01'',''02'')','24','(''3'',''5'',''9'',''12'',''24'',''30'',''34'',''37'',''40'',''42'',''46'',''47'',''49'',''13'',''16'',''19'',''2'',''45'',''28'')','03',''),
        T_TIPO_DATA('(''08'',''06'',''160'',''05'',''161'',''15'',''19'',''14'',''09'')','10010725','(''15'',''1'',''2'',''3'',''4'',''33'',''5'',''6'',''7'',''8'',''9'',''10'',''11'',''39'',''12'',''51'',''13'',''14'',''16'',''17'',''18'',''19'',''20'',''21'',''22'',''23'',''26'',''35'',''24'',''25'',''27'',''28'',''29'',''52'',''30'',''31'',''32'',''34'',''36'',''37'',''38'',''40'',''41'',''42'',''43'',''44'',''45'',''46'',''47'',''48'',''49'',''50'')','09',''),
        T_TIPO_DATA('(''01'',''02'')','10010725','(''15'',''1'',''2'',''3'',''4'',''33'',''5'',''6'',''7'',''8'',''9'',''10'',''11'',''39'',''12'',''51'',''13'',''14'',''16'',''17'',''18'',''19'',''20'',''21'',''22'',''23'',''26'',''35'',''24'',''25'',''27'',''28'',''29'',''52'',''30'',''31'',''32'',''34'',''36'',''37'',''38'',''40'',''41'',''42'',''43'',''44'',''45'',''46'',''47'',''48'',''49'',''50'')','09',''),
        T_TIPO_DATA('(''01'',''02'')','110161735','(''17'',''25'',''43'',''8'',''15'',''1'',''39'',''20'',''22'',''26'',''27'',''32'',''36'',''44'',''48'',''50'')','09',''),
        T_TIPO_DATA('(''01'',''02'')','24','(''3'',''5'',''9'',''12'',''24'',''30'',''34'',''37'',''40'',''42'',''46'',''47'',''49'',''13'',''16'',''19'',''2'',''45'',''28'')','09',''),
        T_TIPO_DATA('(''154'',''153'',''155'',''157'',''156'',''158'')','110169721','(''15'',''1'',''2'',''33'',''5'',''9'',''39'',''13'',''16'',''19'',''20'',''22'',''26'',''24'',''27'',''31'',''32'',''34'',''36'',''37'',''40'',''42'',''44'',''45'',''47'',''48'',''49'',''50'')','03','120'),
        T_TIPO_DATA('(''154'',''153'',''155'',''157'',''156'',''158'')','110169721','(''15'',''1'',''2'',''33'',''5'',''9'',''39'',''13'',''16'',''19'',''20'',''22'',''26'',''24'',''27'',''31'',''32'',''34'',''36'',''37'',''40'',''42'',''44'',''45'',''47'',''48'',''49'',''50'')','03','128'),
        T_TIPO_DATA('(''154'',''153'',''155'',''157'',''156'',''158'')','110169721','(''15'',''1'',''2'',''33'',''5'',''9'',''39'',''13'',''16'',''19'',''20'',''22'',''26'',''24'',''27'',''31'',''32'',''34'',''36'',''37'',''40'',''42'',''44'',''45'',''47'',''48'',''49'',''50'')','09','150'),
        T_TIPO_DATA('(''154'',''153'',''155'',''157'',''156'',''158'')','110169721','(''15'',''1'',''2'',''33'',''5'',''9'',''39'',''13'',''16'',''19'',''20'',''22'',''26'',''24'',''27'',''31'',''32'',''34'',''36'',''37'',''40'',''42'',''44'',''45'',''47'',''48'',''49'',''50'')','03','26'),
        T_TIPO_DATA('(''154'',''153'',''155'',''157'',''156'',''158'')','110169721','(''15'',''1'',''2'',''33'',''5'',''9'',''39'',''13'',''16'',''19'',''20'',''22'',''26'',''24'',''27'',''31'',''32'',''34'',''36'',''37'',''40'',''42'',''44'',''45'',''47'',''48'',''49'',''50'')','03','62')
    ); 
    V_TMP_TIPO_DATA T_TIPO_DATA;

BEGIN

DBMS_OUTPUT.PUT_LINE('[INICIO]');

    DBMS_OUTPUT.PUT_LINE('[INFO]: MODIFICACION EN '||V_TEXT_TABLA);

    FOR I IN V_TIPO_DATA.FIRST .. V_TIPO_DATA.LAST
    LOOP
    V_TMP_TIPO_DATA := V_TIPO_DATA(I);

         DBMS_OUTPUT.PUT_LINE('[INFO]: MODIFICAR TABLA PARA SUBCARTERA '||V_TMP_TIPO_DATA(1)||', TIPO TRABAJO '||V_TMP_TIPO_DATA(4)||', SUBTIPO TRABAJO '||V_TMP_TIPO_DATA(5)||'
                PROVINCIA '||V_TMP_TIPO_DATA(3)||' / PVE_COD_REM '||V_TMP_TIPO_DATA(2)||'');

         V_MSQL := 'MERGE INTO '||V_ESQUEMA||'.'||V_TEXT_TABLA||' T1 USING (
                            SELECT DISTINCT SCR.DD_CRA_ID,SCR.DD_SCR_ID, PVE.PVE_ID, TTR.DD_TTR_ID, STR.DD_STR_ID, PRV.DD_PRV_ID
                            FROM '||V_ESQUEMA||'.ACT_PVE_PROVEEDOR PVE
                            JOIN '||V_ESQUEMA||'.DD_SCR_SUBCARTERA SCR ON DD_SCR_CODIGO IN '||V_TMP_TIPO_DATA(1)||'
                            JOIN '||V_ESQUEMA||'.DD_TTR_TIPO_TRABAJO TTR ON DD_TTR_CODIGO = '''||V_TMP_TIPO_DATA(4)||'''
                            LEFT JOIN '||V_ESQUEMA||'.DD_STR_SUBTIPO_TRABAJO STR ON DD_STR_CODIGO = '''||V_TMP_TIPO_DATA(5)||'''
                            JOIN '||V_ESQUEMA_M||'.DD_PRV_PROVINCIA PRV ON DD_PRV_CODIGO IN '||V_TMP_TIPO_DATA(3)||'
                            WHERE PVE_COD_REM = '||V_TMP_TIPO_DATA(2)||' AND PVE.BORRADO = 0 AND PVE_FECHA_BAJA IS NULL) T2
                            ON (T1.DD_CRA_ID = T2.DD_CRA_ID AND T1.DD_SCR_ID = T2.DD_SCR_ID AND T1.DD_TTR_ID = T2.DD_TTR_ID
                                    AND T1.DD_STR_ID = T2.DD_STR_ID AND T1.DD_PRV_ID = T2.DD_PRV_ID AND T1.BORRADO = 0)

                            WHEN MATCHED THEN UPDATE SET
                            T1.PVE_ID = T2.PVE_ID,
                            T1.USUARIOMODIFICAR = '''||V_USUARIO||''',
                            T1.FECHAMODIFICAR = SYSDATE

                            WHEN NOT MATCHED THEN INSERT (CPP_ID,DD_CRA_ID,DD_SCR_ID,DD_TTR_ID,DD_STR_ID,PVE_ID,USUARIOCREAR,FECHACREAR,DD_PRV_ID)
                            VALUES ('||V_ESQUEMA||'.S_'||V_TEXT_TABLA||'.NEXTVAL,T2.DD_CRA_ID,T2.DD_SCR_ID,T2.DD_TTR_ID,T2.DD_STR_ID,T2.PVE_ID,
                            '''||V_USUARIO||''',SYSDATE,T2.DD_PRV_ID)';
         EXECUTE IMMEDIATE V_MSQL;

         DBMS_OUTPUT.PUT_LINE('[INFO]: '||SQL%ROWCOUNT||' REGISTROS MODIFICADOS/INSERTADOS CORRECTAMENTE EN '||V_TEXT_TABLA||'');

    END LOOP;

    COMMIT;

    DBMS_OUTPUT.PUT_LINE('[FIN]: TABLA '||V_TEXT_TABLA||' ACTUALIZADO CORRECTAMENTE ');

EXCEPTION
     WHEN OTHERS THEN
          ERR_NUM := SQLCODE;
          ERR_MSG := SQLERRM;
          DBMS_OUTPUT.put_line('[ERROR] Se ha producido un error en la ejecución:'||TO_CHAR(ERR_NUM));
          DBMS_OUTPUT.put_line('-----------------------------------------------------------');
          DBMS_OUTPUT.put_line(ERR_MSG);
          DBMS_OUTPUT.put_line(V_MSQL);
          ROLLBACK;
          RAISE;   
END;
/
EXIT;
