--/*
--###########################################
--## AUTOR=Viorel Remus Ovidiu
--## FECHA_CREACION=20190924
--## ARTEFACTO=online
--## VERSION_ARTEFACTO=9.3
--## INCIDENCIA_LINK=REMVIP-5289 
--## PRODUCTO=NO
--## 
--## Finalidad:
--##			
--## INSTRUCCIONES:  
--## VERSIONES:
--##        0.1 Versión inicial
--###########################################
----*/


WHENEVER SQLERROR EXIT SQL.SQLCODE;
SET SERVEROUTPUT ON; 
SET DEFINE OFF;


DECLARE
  V_MSQL VARCHAR2(32000 CHAR); -- Sentencia a ejecutar     
  V_ESQUEMA VARCHAR2(25 CHAR):= '#ESQUEMA#'; -- Configuracion Esquema
  V_ESQUEMA_M VARCHAR2(25 CHAR):= '#ESQUEMA_MASTER#'; -- Configuracion Esquema Master
  V_SQL VARCHAR2(4000 CHAR); -- Vble. para consulta que valida la existencia de una tabla.
  V_NUM_ACT NUMBER(16); -- Vble. para validar la existencia de una tabla.   
  V_COUNT1 NUMBER(16);
  V_COUNT2 NUMBER(16);
  ERR_NUM NUMBER(25);  -- Vble. auxiliar para registrar errores en el script.
  ERR_MSG VARCHAR2(1024 CHAR); -- Vble. auxiliar para registrar errores en el script.
  V_USUARIOMODIFICAR VARCHAR2(100 CHAR) := 'REMVIP-5289';
  
    
BEGIN	
	
    DBMS_OUTPUT.PUT_LINE('[INICIO] ');
	 
    DBMS_OUTPUT.PUT_LINE('[INFO]: ACTUALIZAR ACT_SPS_SIT_POSESORIA ' );


		V_MSQL := ' 
		UPDATE '||V_ESQUEMA||'.ACT_SPS_SIT_POSESORIA SET SPS_FECHA_TOMA_POSESION = TO_DATE(''02/01/19'',''DD/MM/RR''), 
		USUARIOMODIFICAR = ''REMVIP-5289'', 
		FECHAMODIFICAR = SYSDATE 
		WHERE ACT_ID IN (SELECT ACT_ID FROM '||V_ESQUEMA||'.ACT_ACTIVO WHERE ACT_NUM_ACTIVO IN (7226180,
		7226181,
		7226182,
		7226183,
		7226184,
		7226185,
		7226186,
		7226187,
		7226188,
		7226189,
		7226190,
		7226191,
		7226192,
		7226193,
		7226194,
		7226195,
		7226196,
		7226197,
		7226198,
		7226199,
		7226200,
		7226201,
		7226202,
		7226203,
		7226204,
		7226205,
		7226206,
		7226207,
		7226208,
		7226209,
		7226210,
		7226211,
		7226212,
		7226213,
		7226214,
		7226215,
		7226216,
		7226217,
		7226218,
		7226219,
		7226220,
		7226221,
		7226222,
		7226223,
		7226224,
		7226225,
		7226226,
		7226227,
		7226228,
		7226229,
		7226230,
		7226231,
		7226232,
		7226233,
		7226234,
		7226235,
		7226236,
		7226237,
		7226238,
		7226239,
		7226240,
		7226241,
		7226243,
		7226244,
		7226245,
		7226246,
		7226247,
		7226248,
		7226249,
		7226250,
		7226251,
		7226252,
		7226253,
		7226254,
		7226255,
		7226256,
		7226257,
		7226258,
		7226259,
		7226260,
		7226261,
		7226262,
		7226263,
		7226264,
		7226265,
		7226266,
		7226267,
		7226268,
		7226269,
		7226270,
		7226271,
		7226272,
		7226273,
		7226274,
		7226275,
		7226276,
		7226277,
		7226278,
		7226279,
		7226280,
		7226281,
		7226282,
		7226283,
		7226284,
		7226285,
		7226286,
		7226287,
		7226288,
		7226289,
		7226290,
		7226291,
		7226292,
		7226293,
		7226294,
		7226295,
		7226296,
		7226297,
		7226298,
		7226299,
		7226300,
		7226301,
		7226302,
		7226303,
		7226304,
		7226305,
		7226306,
		7226307,
		7226308,
		7226309,
		7226310,
		7226311,
		7226312,
		7226313,
		7226314,
		7226315,
		7226316,
		7226317,
		7226318,
		7226319,
		7226320,
		7226321,
		7226322,
		7226323,
		7226324,
		7226325,
		7226326,
		7226327,
		7226328,
		7226329,
		7226330,
		7226331,
		7226332,
		7226333,
		7226334,
		7226335,
		7226336,
		7226337,
		7226338,
		7226339,
		7226340,
		7226341,
		7226342,
		7226343,
		7226344,
		7226345,
		7226346,
		7226347,
		7226348,
		7226349,
		7226350,
		7226351,
		7226352,
		7226353,
		7226354,
		7226355,
		7226356,
		7226357,
		7226358,
		7226359,
		7226360,
		7226361,
		7226362,
		7226363,
		7226364,
		7226365,
		7226366,
		7226367,
		7226368,
		7226369,
		7226370,
		7226371,
		7226372,
		7226373,
		7226374,
		7226375,
		7226376,
		7226377,
		7226378,
		7226379,
		7226380,
		7226381,
		7226382,
		7226383,
		7226384,
		7226385,
		7226386,
		7226387,
		7226388,
		7226389,
		7226390,
		7226391,
		7226392,
		7226393,
		7226394,
		7226395,
		7226396,
		7226397,
		7226398,
		7226399,
		7226400,
		7226401,
		7226402,
		7226403,
		7226404,
		7226405,
		7226406,
		7226407,
		7226408,
		7226409,
		7226410,
		7226411,
		7226412,
		7226413,
		7226414,
		7226415,
		7226416,
		7226417,
		7226418,
		7226419,
		7226420,
		7226421,
		7226422,
		7226423,
		7226424,
		7226425,
		7226426,
		7226427,
		7226428,
		7226429,
		7226430,
		7226431,
		7226432,
		7226433,
		7226434,
		7226435,
		7226436,
		7226437,
		7226438,
		7226439,
		7226440,
		7226441,
		7226442,
		7226443,
		7226444,
		7226445,
		7226446,
		7226447,
		7226448,
		7226449,
		7226450,
		7226451,
		7226452,
		7226453,
		7226454,
		7226455,
		7226456,
		7226851,
		7228150))';

       EXECUTE IMMEDIATE V_MSQL;	

    DBMS_OUTPUT.PUT_LINE('[INFO] Actualizados '||SQL%ROWCOUNT||' registros en ACT_SPS_SIT_POSESORIA');  


    DBMS_OUTPUT.PUT_LINE('[INFO]: ACTUALIZAR ACT_PAC_PROPIETARIO_ACTIVO ' );


V_MSQL := ' 
UPDATE '||V_ESQUEMA||'.ACT_PAC_PROPIETARIO_ACTIVO SET DD_TGP_ID = (SELECT DD_TGP_ID FROM '||V_ESQUEMA||'.DD_TGP_TIPO_GRADO_PROPIEDAD WHERE DD_TGP_CODIGO = ''01''), 
PAC_PORC_PROPIEDAD = 100, 
USUARIOMODIFICAR =  ''REMVIP-5289'', 
FECHAMODIFICAR = SYSDATE 
WHERE ACT_ID IN (SELECT ACT_ID FROM '||V_ESQUEMA||'.ACT_ACTIVO WHERE ACT_NUM_ACTIVO IN (7226180,
7226181,
7226182,
7226183,
7226184,
7226185,
7226186,
7226187,
7226188,
7226189,
7226190,
7226191,
7226192,
7226193,
7226194,
7226195,
7226196,
7226197,
7226198,
7226199,
7226200,
7226201,
7226202,
7226203,
7226204,
7226205,
7226206,
7226207,
7226208,
7226209,
7226210,
7226211,
7226212,
7226213,
7226214,
7226215,
7226216,
7226217,
7226218,
7226219,
7226220,
7226221,
7226222,
7226223,
7226224,
7226225,
7226226,
7226227,
7226228,
7226229,
7226230,
7226231,
7226232,
7226233,
7226234,
7226235,
7226236,
7226237,
7226238,
7226239,
7226240,
7226241,
7226243,
7226244,
7226245,
7226246,
7226247,
7226248,
7226249,
7226250,
7226251,
7226252,
7226253,
7226254,
7226255,
7226256,
7226257,
7226258,
7226259,
7226260,
7226261,
7226262,
7226263,
7226264,
7226265,
7226266,
7226267,
7226268,
7226269,
7226270,
7226271,
7226272,
7226273,
7226274,
7226275,
7226276,
7226277,
7226278,
7226279,
7226280,
7226281,
7226282,
7226283,
7226284,
7226285,
7226286,
7226287,
7226288,
7226289,
7226290,
7226291,
7226292,
7226293,
7226294,
7226295,
7226296,
7226297,
7226298,
7226299,
7226300,
7226301,
7226302,
7226303,
7226304,
7226305,
7226306,
7226307,
7226308,
7226309,
7226310,
7226311,
7226312,
7226313,
7226314,
7226315,
7226316,
7226317,
7226318,
7226319,
7226320,
7226321,
7226322,
7226323,
7226324,
7226325,
7226326,
7226327,
7226328,
7226329,
7226330,
7226331,
7226332,
7226333,
7226334,
7226335,
7226336,
7226337,
7226338,
7226339,
7226340,
7226341,
7226342,
7226343,
7226344,
7226345,
7226346,
7226347,
7226348,
7226349,
7226350,
7226351,
7226352,
7226353,
7226354,
7226355,
7226356,
7226357,
7226358,
7226359,
7226360,
7226361,
7226362,
7226363,
7226364,
7226365,
7226366,
7226367,
7226368,
7226369,
7226370,
7226371,
7226372,
7226373,
7226374,
7226375,
7226376,
7226377,
7226378,
7226379,
7226380,
7226381,
7226382,
7226383,
7226384,
7226385,
7226386,
7226387,
7226388,
7226389,
7226390,
7226391,
7226392,
7226393,
7226394,
7226395,
7226396,
7226397,
7226398,
7226399,
7226400,
7226401,
7226402,
7226403,
7226404,
7226405,
7226406,
7226407,
7226408,
7226409,
7226410,
7226411,
7226412,
7226413,
7226414,
7226415,
7226416,
7226417,
7226418,
7226419,
7226420,
7226421,
7226422,
7226423,
7226424,
7226425,
7226426,
7226427,
7226428,
7226429,
7226430,
7226431,
7226432,
7226433,
7226434,
7226435,
7226436,
7226437,
7226438,
7226439,
7226440,
7226441,
7226442,
7226443,
7226444,
7226445,
7226446,
7226447,
7226448,
7226449,
7226450,
7226451,
7226452,
7226453,
7226454,
7226455,
7226456,
7226851,
7228150))';

    EXECUTE IMMEDIATE V_MSQL;	

    DBMS_OUTPUT.PUT_LINE('[INFO] Actualizados '||SQL%ROWCOUNT||' registros en ACT_PAC_PROPIETARIO_ACTIVO');  


    DBMS_OUTPUT.PUT_LINE('[INFO]: ACTUALIZAR ACT_ADN_ADJNOJUDICIAL ' );


V_MSQL := ' 
UPDATE '||V_ESQUEMA||'.ACT_ADN_ADJNOJUDICIAL SET ADN_FECHA_TITULO = TO_DATE(''01/01/19'',''DD/MM/RR''), 
ADN_FECHA_FIRMA_TITULO = TO_DATE(''01/01/19'',''DD/MM/RR''), 
USUARIOMODIFICAR =  ''REMVIP-5289'', 
FECHAMODIFICAR = SYSDATE 
WHERE ACT_ID IN (SELECT ACT_ID FROM '||V_ESQUEMA||'.ACT_ACTIVO WHERE ACT_NUM_ACTIVO IN (7226180,
7226181,
7226182,
7226183,
7226184,
7226185,
7226186,
7226187,
7226188,
7226189,
7226190,
7226191,
7226192,
7226193,
7226194,
7226195,
7226196,
7226197,
7226198,
7226199,
7226200,
7226201,
7226202,
7226203,
7226204,
7226205,
7226206,
7226207,
7226208,
7226209,
7226210,
7226211,
7226212,
7226213,
7226214,
7226215,
7226216,
7226217,
7226218,
7226219,
7226220,
7226221,
7226222,
7226223,
7226224,
7226225,
7226226,
7226227,
7226228,
7226229,
7226230,
7226231,
7226232,
7226233,
7226234,
7226235,
7226236,
7226237,
7226238,
7226239,
7226240,
7226241,
7226243,
7226244,
7226245,
7226246,
7226247,
7226248,
7226249,
7226250,
7226251,
7226252,
7226253,
7226254,
7226255,
7226256,
7226257,
7226258,
7226259,
7226260,
7226261,
7226262,
7226263,
7226264,
7226265,
7226266,
7226267,
7226268,
7226269,
7226270,
7226271,
7226272,
7226273,
7226274,
7226275,
7226276,
7226277,
7226278,
7226279,
7226280,
7226281,
7226282,
7226283,
7226284,
7226285,
7226286,
7226287,
7226288,
7226289,
7226290,
7226291,
7226292,
7226293,
7226294,
7226295,
7226296,
7226297,
7226298,
7226299,
7226300,
7226301,
7226302,
7226303,
7226304,
7226305,
7226306,
7226307,
7226308,
7226309,
7226310,
7226311,
7226312,
7226313,
7226314,
7226315,
7226316,
7226317,
7226318,
7226319,
7226320,
7226321,
7226322,
7226323,
7226324,
7226325,
7226326,
7226327,
7226328,
7226329,
7226330,
7226331,
7226332,
7226333,
7226334,
7226335,
7226336,
7226337,
7226338,
7226339,
7226340,
7226341,
7226342,
7226343,
7226344,
7226345,
7226346,
7226347,
7226348,
7226349,
7226350,
7226351,
7226352,
7226353,
7226354,
7226355,
7226356,
7226357,
7226358,
7226359,
7226360,
7226361,
7226362,
7226363,
7226364,
7226365,
7226366,
7226367,
7226368,
7226369,
7226370,
7226371,
7226372,
7226373,
7226374,
7226375,
7226376,
7226377,
7226378,
7226379,
7226380,
7226381,
7226382,
7226383,
7226384,
7226385,
7226386,
7226387,
7226388,
7226389,
7226390,
7226391,
7226392,
7226393,
7226394,
7226395,
7226396,
7226397,
7226398,
7226399,
7226400,
7226401,
7226402,
7226403,
7226404,
7226405,
7226406,
7226407,
7226408,
7226409,
7226410,
7226411,
7226412,
7226413,
7226414,
7226415,
7226416,
7226417,
7226418,
7226419,
7226420,
7226421,
7226422,
7226423,
7226424,
7226425,
7226426,
7226427,
7226428,
7226429,
7226430,
7226431,
7226432,
7226433,
7226434,
7226435,
7226436,
7226437,
7226438,
7226439,
7226440,
7226441,
7226442,
7226443,
7226444,
7226445,
7226446,
7226447,
7226448,
7226449,
7226450,
7226451,
7226452,
7226453,
7226454,
7226455,
7226456,
7226851,
7228150))';

 EXECUTE IMMEDIATE V_MSQL;	

    DBMS_OUTPUT.PUT_LINE('[INFO] Actualizados '||SQL%ROWCOUNT||' registros en ACT_ADN_ADJNOJUDICIAL');  



    COMMIT;
    DBMS_OUTPUT.PUT_LINE('[FIN] ');

EXCEPTION

   WHEN OTHERS THEN
        err_num := SQLCODE;
        err_msg := SQLERRM;

        DBMS_OUTPUT.put_line('[ERROR] Se ha producido un error en la ejecución:'||TO_CHAR(err_num));
        DBMS_OUTPUT.put_line('-----------------------------------------------------------'); 
        DBMS_OUTPUT.put_line(err_msg);

        ROLLBACK;
        RAISE;          

END;

/

EXIT
