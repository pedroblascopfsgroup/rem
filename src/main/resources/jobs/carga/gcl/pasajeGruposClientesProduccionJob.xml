<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans" xmlns:p="http://www.springframework.org/schema/p"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.5.xsd"
  default-autowire="byName" default-merge="true">

  <bean id="pasajeGruposClientesProduccionJob" parent="batch.simpleJob" scope="prototype">
    <property name="transactional" value="true"/>
    <property name="transactionManager" ref="entityTransactionManager"/>
    <property name="steps">
      <list>
        <!-- FIN VALIDACIONES // COMIENZO PASAJE DATOS -->

        <bean id="pasaje.gcl.borrarRelacionesAnteriores" parent="batch.taskletStep" scope="prototype">
          <property name="tasklet">
            <bean parent="batch.task.MultipleSqlScript" p:dataSource-ref="entityDataSource">
              <property name="scripts">
              	<list>
              		<map>
              			<entry key="sql">
              				<bean parent="sql" p:key="gcl.borrarRelacionesAnteriores" />
              			</entry>
              			<entry key="message" value="gcl.borrarRelacionesAnteriores"/>
              			<entry key="severidad" value="error"/>
              		</map>
             	</list>
              </property>
            </bean>
          </property>
        </bean>

		<bean id="pasaje.gcl.borrarGruposAnteriores" parent="batch.taskletStep" scope="prototype">
          <property name="tasklet">
            <bean parent="batch.task.MultipleSqlScript" p:dataSource-ref="entityDataSource">
              <property name="scripts">
              	<list>
              		<map>
              			<entry key="sql">
              				<bean parent="sql" p:key="gcl.borrarGruposAnteriores" />
              			</entry>
              			<entry key="message" value="gcl.borrarGruposAnteriores"/>
              			<entry key="severidad" value="error"/>
              		</map>
             	</list>
              </property>
            </bean>
          </property>
        </bean>

		<bean id="pasaje.gcl.GruposProduccion" parent="batch.taskletStep" scope="prototype">
          <property name="tasklet">
            <bean parent="batch.task.MultipleSqlScript" p:dataSource-ref="entityDataSource">
              <property name="scripts">
              	<list>
              		<map>
              			<entry key="sql">
              				<bean parent="sql" p:key="gcl.pasajeGruposProduccion" />
              			</entry>
              			<entry key="message" value="gcl.pasajeGruposProduccion"/>
              			<entry key="severidad" value="error"/>
              		</map>
             	</list>
              </property>
            </bean>
          </property>
        </bean>

        <bean id="pasaje.gcl.RelacionesProduccion" parent="batch.taskletStep" scope="prototype">
          <property name="tasklet">
            <bean parent="batch.task.MultipleSqlScript" p:dataSource-ref="entityDataSource">
              <property name="scripts">
              	<list>
              		<map>
              			<entry key="sql">
              				<bean parent="sql" p:key="gcl.pasajeRelacionesProduccion" />
              			</entry>
              			<entry key="message" value="gcl.pasajeRelacionesProduccion"/>
              			<entry key="severidad" value="error"/>
              		</map>
             	</list>
              </property>
            </bean>
          </property>
        </bean>

        <bean id="pasaje.registrarCargaFicheroGCL" parent="batch.taskletStep" scope="prototype">
            <property name="tasklet">
                <bean parent="batch.task.actualizarFicheroCargado" p:dataSource-ref="entityDataSource">
                    <property name="codigoFichero" value="GCL" />
                </bean>
            </property>
        </bean>

      </list>
    </property>
  </bean>

</beans>